{"ast":null,"code":"var _jsxFileName = \"/Users/emilessung/dev/psy-website/src/components/article/write/WriteArticle.tsx\";\nimport * as React from 'react';\nimport 'tinymce/tinymce';\nimport contentManager from '../../../ContentManager';\nimport DropDown from '../../common/DropDown';\nimport Loading from '../../common/Loading';\nimport './writeArticle.scss'; // import 'react-draft-wysiwyg/dist/react-draft-wysiwyg.css';\n// import {EditorState} from 'draft-js';\n\nimport SunEditor from 'suneditor-react';\n// import 'suneditor/dist/css/suneditor.min.css'; // Import Sun Editor's CSS File\nimport '../../../suneditor.scss';\nimport { align, font, fontColor, fontSize, formatBlock, hiliteColor, horizontalRule, lineHeight, list, paragraphStyle, table, template, textStyle, image, link } from 'suneditor/src/plugins';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nclass WriteArticle extends React.Component {\n  constructor(props) {\n    super(props);\n    this.editorRef = /*#__PURE__*/React.createRef();\n\n    this.getSunEditorInstance = sunEditor => {\n      // TODO: Fix this for real.\n      this.editorRef.current = sunEditor;\n    };\n\n    this.componentDidMount = this.componentDidMount.bind(this);\n    this.handleContent = this.handleContent.bind(this);\n    this.saveArticle = this.saveArticle.bind(this);\n    this.changeDescription = this.changeDescription.bind(this);\n    this.changeTitle = this.changeTitle.bind(this);\n    this.state = {\n      articleTitles: [],\n      currentArticle: {}\n    };\n  } // static getDerivedStateFromProps(nextProps: WriteArticleProps, prevState: WriteArticleState): WriteArticleState {\n  //     return {\n  //         ...prevState,\n  //         articleTitles: contentManager.articles.map(article => article.title),\n  //         currentArticle: contentManager.articles.find(article => article.id === nextProps.match.params.id) || {}\n  //     };\n  // }\n\n\n  handleChange(content) {\n    console.log('OnChange: ', content);\n  }\n\n  handleContent() {\n    var _this$editorRef$curre;\n\n    console.log(this.props.match.params.id);\n    this.setState({\n      articleTitles: contentManager.articles.map(article => {\n        var _article$draft;\n\n        return ((_article$draft = article.draft) === null || _article$draft === void 0 ? void 0 : _article$draft.title) || article.title;\n      }),\n      currentArticle: contentManager.articles.find(article => article.id === this.props.match.params.id) || {}\n    });\n    (_this$editorRef$curre = this.editorRef.current) === null || _this$editorRef$curre === void 0 ? void 0 : _this$editorRef$curre.setContents(this.state.currentArticle.data || '');\n  }\n\n  updatePublish() {}\n\n  saveArticle(e) {\n    var _this$editorRef$curre2;\n\n    e.preventDefault();\n    let currentArticle = this.state.currentArticle;\n    let content = ((_this$editorRef$curre2 = this.editorRef.current) === null || _this$editorRef$curre2 === void 0 ? void 0 : _this$editorRef$curre2.getContents(true)) || '';\n\n    if (currentArticle) {\n      if (currentArticle.id) {\n        contentManager.saveArticle(currentArticle.id, currentArticle.description || '', currentArticle.title || '', content);\n      } else {\n        contentManager.createArticle(currentArticle.description || '', currentArticle.title || '', content);\n      }\n    }\n  }\n\n  changeTitle(e) {\n    if (this.state.currentArticle) {\n      this.setState({\n        currentArticle: { ...this.state.currentArticle,\n          title: e.target.value\n        }\n      });\n    }\n  }\n\n  changeDescription(e) {\n    if (this.state.currentArticle) {\n      this.setState({\n        currentArticle: { ...this.state.currentArticle,\n          description: e.target.value\n        }\n      });\n    }\n  }\n\n  componentDidMount() {\n    contentManager.addListener('article', this.handleContent);\n  }\n\n  componentWillUnmount() {\n    contentManager.removeListener('article', this.handleContent);\n  }\n\n  render() {\n    var _this$state$currentAr;\n\n    let showEditor = (!!this.state.currentArticle || !this.props.match.params.id) && contentManager.authenticated;\n\n    if (!contentManager.isAdmin && showEditor) {\n      return /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Access denied\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Only admins can write new articles\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true);\n    }\n\n    let dropDownItems = contentManager.articles.map(article => ({\n      text: article.title,\n      callback: async () => {\n        await this.props.history.push('/write/' + article.id);\n        this.handleContent();\n      }\n    }));\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sunEditor-container\",\n        children: showEditor ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(SunEditor, {\n            autoFocus: true,\n            lang: \"en\",\n            setOptions: {\n              showPathLabel: false,\n              minHeight: '50vh',\n              maxHeight: '50vh',\n              placeholder: 'Your text here',\n              plugins: [align, font, fontColor, fontSize, formatBlock, hiliteColor, horizontalRule, lineHeight, list, paragraphStyle, table, template, textStyle, image, link],\n              buttonList: [['undo', 'redo'], ['font', 'fontSize', 'formatBlock'], ['paragraphStyle'], ['bold', 'underline', 'italic', 'strike', 'subscript', 'superscript'], ['fontColor', 'hiliteColor'], ['removeFormat'], '/', // Line break\n              ['outdent', 'indent'], ['align', 'horizontalRule', 'list', 'lineHeight'], ['table', 'link', 'image']],\n              formats: ['p', 'div', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'],\n              font: ['Arial', 'Calibri', 'Comic Sans', 'Courier', 'Garamond', 'Georgia', 'Impact', 'Lucida Console', 'Palatino Linotype', 'Segoe UI', 'Tahoma', 'Times New Roman', 'Trebuchet MS']\n            },\n            onChange: this.handleChange,\n            getSunEditorInstance: this.getSunEditorInstance //                    defaultValue= {this.currentArticle ? this.currentArticle.data : \"<p>Your text here...</p>\"}\n            ,\n            defaultValue: (_this$state$currentAr = this.state.currentArticle) === null || _this$state$currentAr === void 0 ? void 0 : _this$state$currentAr.data\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 156,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"info-container\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                id: \"new-article-button\",\n                onClick: async () => {\n                  await this.props.history.push('/write');\n                  this.handleContent();\n                },\n                children: \"+\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 217,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(DropDown, {\n                options: dropDownItems,\n                children: \"Modify existing\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 225,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 216,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                placeholder: \"Title\",\n                defaultValue: this.state.currentArticle.title,\n                onChange: this.changeTitle\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 228,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                name: \"text\",\n                rows: 10,\n                cols: 23,\n                placeholder: \"Description\",\n                defaultValue: this.state.currentArticle.description,\n                onChange: this.changeDescription\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 234,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 227,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: this.saveArticle,\n                children: \"Save draft\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 244,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: e => {\n                  e.preventDefault();\n                  contentManager.publishArticle(this.state.currentArticle.id || '');\n                },\n                children: \"Publish\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 245,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 243,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 17\n      }, this)\n    }, void 0, false);\n  }\n\n}\n\nexport default WriteArticle;","map":{"version":3,"sources":["/Users/emilessung/dev/psy-website/src/components/article/write/WriteArticle.tsx"],"names":["React","contentManager","DropDown","Loading","SunEditor","align","font","fontColor","fontSize","formatBlock","hiliteColor","horizontalRule","lineHeight","list","paragraphStyle","table","template","textStyle","image","link","WriteArticle","Component","constructor","props","editorRef","createRef","getSunEditorInstance","sunEditor","current","componentDidMount","bind","handleContent","saveArticle","changeDescription","changeTitle","state","articleTitles","currentArticle","handleChange","content","console","log","match","params","id","setState","articles","map","article","draft","title","find","setContents","data","updatePublish","e","preventDefault","getContents","description","createArticle","target","value","addListener","componentWillUnmount","removeListener","render","showEditor","authenticated","isAdmin","dropDownItems","text","callback","history","push","showPathLabel","minHeight","maxHeight","placeholder","plugins","buttonList","formats","publishArticle"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport 'tinymce/tinymce';\nimport contentManager from '../../../ContentManager';\nimport DropDown, {DropDownItem} from '../../common/DropDown';\nimport {Article} from '../../../interfaces';\nimport Loading from '../../common/Loading';\nimport {RouteComponentProps} from 'react-router-dom';\nimport './writeArticle.scss';\n// import 'react-draft-wysiwyg/dist/react-draft-wysiwyg.css';\n// import {EditorState} from 'draft-js';\n\nimport SunEditor from 'suneditor-react';\nimport SunEditorCore from 'suneditor/src/lib/core';\n// import 'suneditor/dist/css/suneditor.min.css'; // Import Sun Editor's CSS File\nimport '../../../suneditor.scss';\nimport {\n    align,\n    font,\n    fontColor,\n    fontSize,\n    formatBlock,\n    hiliteColor,\n    horizontalRule,\n    lineHeight,\n    list,\n    paragraphStyle,\n    table,\n    template,\n    textStyle,\n    image,\n    link\n} from 'suneditor/src/plugins';\nimport { ContentBlock } from 'draft-js';\n\nexport interface WriteArticlePropsMatchParams {\n    id?: string;\n}\n\nexport interface WriteArticleProps extends RouteComponentProps<WriteArticlePropsMatchParams> {}\n\nexport interface WriteArticleState {\n    articleTitles: string[];\n    currentArticle: Partial<Article>;\n}\n\nclass WriteArticle extends React.Component<WriteArticleProps, WriteArticleState> {\n    editorRef: React.RefObject<SunEditorCore | null> = React.createRef();\n\n    constructor(props: WriteArticleProps) {\n        super(props);\n        this.componentDidMount = this.componentDidMount.bind(this);\n        this.handleContent = this.handleContent.bind(this);\n        this.saveArticle = this.saveArticle.bind(this);\n        this.changeDescription = this.changeDescription.bind(this);\n        this.changeTitle = this.changeTitle.bind(this);\n        this.state = {\n            articleTitles: [],\n            currentArticle: {}\n        };\n    }\n\n    // static getDerivedStateFromProps(nextProps: WriteArticleProps, prevState: WriteArticleState): WriteArticleState {\n    //     return {\n    //         ...prevState,\n    //         articleTitles: contentManager.articles.map(article => article.title),\n    //         currentArticle: contentManager.articles.find(article => article.id === nextProps.match.params.id) || {}\n    //     };\n    // }\n\n    getSunEditorInstance = (sunEditor: SunEditorCore) => {\n        // TODO: Fix this for real.\n        (this.editorRef.current as any) = sunEditor;\n    };\n\n    handleChange(content: string) {\n        console.log('OnChange: ', content);\n    }\n\n    handleContent() {\n        console.log(this.props.match.params.id);\n        \n        this.setState({\n            articleTitles: contentManager.articles.map(article => article.draft?.title || article.title),\n            currentArticle: contentManager.articles.find(article => article.id === this.props.match.params.id) || {}\n        });\n\n        this.editorRef.current?.setContents(this.state.currentArticle.data || '');\n    }\n\n    updatePublish() {}\n\n    saveArticle(e: React.FormEvent) {\n        e.preventDefault();\n\n        let currentArticle = this.state.currentArticle;\n        let content = this.editorRef.current?.getContents(true) || '';\n        if (currentArticle) {\n            if (currentArticle.id) {\n                contentManager.saveArticle(\n                    currentArticle.id,\n                    currentArticle.description || '',\n                    currentArticle.title || '',\n                    content\n                );\n            } else {\n                contentManager.createArticle(currentArticle.description || '', currentArticle.title || '', content);\n            }\n        }\n    }\n\n    changeTitle(e: React.ChangeEvent<HTMLInputElement>) {\n        if (this.state.currentArticle) {\n            this.setState({currentArticle: {...this.state.currentArticle, title: e.target.value}});\n        }\n    }\n\n    changeDescription(e: React.ChangeEvent<HTMLTextAreaElement>) {\n        if (this.state.currentArticle) {\n            this.setState({currentArticle: {...this.state.currentArticle, description: e.target.value}});\n        }\n    }\n\n    componentDidMount() {\n        contentManager.addListener('article', this.handleContent);\n    }\n\n    componentWillUnmount() {\n        contentManager.removeListener('article', this.handleContent);\n    }\n    render() {\n        let showEditor: boolean =\n            (!!this.state.currentArticle || !this.props.match.params.id) && contentManager.authenticated;\n\n        if (!contentManager.isAdmin && showEditor) {\n            return (\n                <>\n                    <h1>Access denied</h1>\n                    <p>Only admins can write new articles</p>\n                </>\n            );\n        }\n\n        let dropDownItems: DropDownItem[] = contentManager.articles.map(article => ({\n            text: article.title,\n            callback: async () => {\n                await this.props.history.push('/write/' + article.id);\n                this.handleContent();\n            }\n        }));\n\n        return (\n            <>\n                <div className='sunEditor-container'>\n                    {showEditor ? (\n                        <>\n                            <SunEditor\n                                autoFocus={true}\n                                lang='en'\n                                setOptions={{\n                                    showPathLabel: false,\n                                    minHeight: '50vh',\n                                    maxHeight: '50vh',\n                                    placeholder: 'Your text here',\n                                    plugins: [\n                                        align,\n                                        font,\n                                        fontColor,\n                                        fontSize,\n                                        formatBlock,\n                                        hiliteColor,\n                                        horizontalRule,\n                                        lineHeight,\n                                        list,\n                                        paragraphStyle,\n                                        table,\n                                        template,\n                                        textStyle,\n                                        image,\n                                        link\n                                    ],\n                                    buttonList: [\n                                        ['undo', 'redo'],\n                                        ['font', 'fontSize', 'formatBlock'],\n                                        ['paragraphStyle'],\n                                        ['bold', 'underline', 'italic', 'strike', 'subscript', 'superscript'],\n                                        ['fontColor', 'hiliteColor'],\n                                        ['removeFormat'],\n                                        '/', // Line break\n                                        ['outdent', 'indent'],\n                                        ['align', 'horizontalRule', 'list', 'lineHeight'],\n                                        ['table', 'link', 'image']\n                                    ],\n                                    formats: ['p', 'div', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'],\n                                    font: [\n                                        'Arial',\n                                        'Calibri',\n                                        'Comic Sans',\n                                        'Courier',\n                                        'Garamond',\n                                        'Georgia',\n                                        'Impact',\n                                        'Lucida Console',\n                                        'Palatino Linotype',\n                                        'Segoe UI',\n                                        'Tahoma',\n                                        'Times New Roman',\n                                        'Trebuchet MS'\n                                    ]\n                                }}\n                                onChange={this.handleChange}\n                                getSunEditorInstance={this.getSunEditorInstance}\n                                //                    defaultValue= {this.currentArticle ? this.currentArticle.data : \"<p>Your text here...</p>\"}\n                                defaultValue={this.state.currentArticle?.data}\n                            />\n                            <div className='info-container'>\n                                <div>\n                                <button\n                                    id=\"new-article-button\"\n                                    onClick={async () => {\n                                        await this.props.history.push('/write');\n                                        this.handleContent();\n                                    }}>\n                                    +\n                                </button>\n                                <DropDown options={dropDownItems}>Modify existing</DropDown>\n                                </div>\n                                <form>\n                                    <input\n                                        type='text'\n                                        placeholder='Title'\n                                        defaultValue={this.state.currentArticle.title}\n                                        onChange={this.changeTitle}\n                                    />\n                                    <textarea\n                                        name='text'\n                                        rows={10}\n                                        cols={23}\n                                        placeholder='Description'\n                                        defaultValue={this.state.currentArticle.description}\n                                        onChange={this.changeDescription}\n                                    />\n                                </form>\n                                <div>\n                                    <button onClick={this.saveArticle}>Save draft</button>\n                                    <button\n                                        onClick={e => {\n                                            e.preventDefault();\n                                            contentManager.publishArticle(this.state.currentArticle.id || '');\n                                        }}>\n                                        Publish\n                                    </button>\n                                </div>\n                            </div>\n                        </>\n                    ) : (\n                        <Loading />\n                    )}\n                </div>\n            </>\n        );\n    }\n}\n\nexport default WriteArticle;\n"]},"metadata":{},"sourceType":"module"}
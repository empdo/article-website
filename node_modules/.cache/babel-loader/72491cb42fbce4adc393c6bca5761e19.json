{"ast":null,"code":"/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.8.2 (2021-06-23)\n */\n(function () {\n  'use strict';\n\n  var typeOf = function (x) {\n    if (x === null) {\n      return 'null';\n    }\n\n    if (x === undefined) {\n      return 'undefined';\n    }\n\n    var t = typeof x;\n\n    if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n      return 'array';\n    }\n\n    if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n      return 'string';\n    }\n\n    return t;\n  };\n\n  var isEquatableType = function (x) {\n    return ['undefined', 'boolean', 'number', 'string', 'function', 'xml', 'null'].indexOf(x) !== -1;\n  };\n\n  var sort = function (xs, compareFn) {\n    var clone = Array.prototype.slice.call(xs);\n    return clone.sort(compareFn);\n  };\n\n  var contramap = function (eqa, f) {\n    return eq(function (x, y) {\n      return eqa.eq(f(x), f(y));\n    });\n  };\n\n  var eq = function (f) {\n    return {\n      eq: f\n    };\n  };\n\n  var tripleEq = eq(function (x, y) {\n    return x === y;\n  });\n  var eqString = tripleEq;\n\n  var eqArray = function (eqa) {\n    return eq(function (x, y) {\n      if (x.length !== y.length) {\n        return false;\n      }\n\n      var len = x.length;\n\n      for (var i = 0; i < len; i++) {\n        if (!eqa.eq(x[i], y[i])) {\n          return false;\n        }\n      }\n\n      return true;\n    });\n  };\n\n  var eqSortedArray = function (eqa, compareFn) {\n    return contramap(eqArray(eqa), function (xs) {\n      return sort(xs, compareFn);\n    });\n  };\n\n  var eqRecord = function (eqa) {\n    return eq(function (x, y) {\n      var kx = Object.keys(x);\n      var ky = Object.keys(y);\n\n      if (!eqSortedArray(eqString).eq(kx, ky)) {\n        return false;\n      }\n\n      var len = kx.length;\n\n      for (var i = 0; i < len; i++) {\n        var q = kx[i];\n\n        if (!eqa.eq(x[q], y[q])) {\n          return false;\n        }\n      }\n\n      return true;\n    });\n  };\n\n  var eqAny = eq(function (x, y) {\n    if (x === y) {\n      return true;\n    }\n\n    var tx = typeOf(x);\n    var ty = typeOf(y);\n\n    if (tx !== ty) {\n      return false;\n    }\n\n    if (isEquatableType(tx)) {\n      return x === y;\n    } else if (tx === 'array') {\n      return eqArray(eqAny).eq(x, y);\n    } else if (tx === 'object') {\n      return eqRecord(eqAny).eq(x, y);\n    }\n\n    return false;\n  });\n\n  var typeOf$1 = function (x) {\n    var t = typeof x;\n\n    if (x === null) {\n      return 'null';\n    } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n      return 'array';\n    } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n      return 'string';\n    } else {\n      return t;\n    }\n  };\n\n  var isType = function (type) {\n    return function (value) {\n      return typeOf$1(value) === type;\n    };\n  };\n\n  var isSimpleType = function (type) {\n    return function (value) {\n      return typeof value === type;\n    };\n  };\n\n  var eq$1 = function (t) {\n    return function (a) {\n      return t === a;\n    };\n  };\n\n  var isString = isType('string');\n  var isObject = isType('object');\n  var isArray = isType('array');\n  var isNull = eq$1(null);\n  var isBoolean = isSimpleType('boolean');\n  var isUndefined = eq$1(undefined);\n\n  var isNullable = function (a) {\n    return a === null || a === undefined;\n  };\n\n  var isNonNullable = function (a) {\n    return !isNullable(a);\n  };\n\n  var isFunction = isSimpleType('function');\n  var isNumber = isSimpleType('number');\n\n  var noop = function () {};\n\n  var compose = function (fa, fb) {\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return fa(fb.apply(null, args));\n    };\n  };\n\n  var compose1 = function (fbc, fab) {\n    return function (a) {\n      return fbc(fab(a));\n    };\n  };\n\n  var constant = function (value) {\n    return function () {\n      return value;\n    };\n  };\n\n  var identity = function (x) {\n    return x;\n  };\n\n  function curry(fn) {\n    var initialArgs = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      initialArgs[_i - 1] = arguments[_i];\n    }\n\n    return function () {\n      var restArgs = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        restArgs[_i] = arguments[_i];\n      }\n\n      var all = initialArgs.concat(restArgs);\n      return fn.apply(null, all);\n    };\n  }\n\n  var not = function (f) {\n    return function (t) {\n      return !f(t);\n    };\n  };\n\n  var die = function (msg) {\n    return function () {\n      throw new Error(msg);\n    };\n  };\n\n  var apply = function (f) {\n    return f();\n  };\n\n  var call = function (f) {\n    f();\n  };\n\n  var never = constant(false);\n  var always = constant(true);\n\n  var none = function () {\n    return NONE;\n  };\n\n  var NONE = function () {\n    var eq = function (o) {\n      return o.isNone();\n    };\n\n    var call = function (thunk) {\n      return thunk();\n    };\n\n    var id = function (n) {\n      return n;\n    };\n\n    var me = {\n      fold: function (n, _s) {\n        return n();\n      },\n      is: never,\n      isSome: never,\n      isNone: always,\n      getOr: id,\n      getOrThunk: call,\n      getOrDie: function (msg) {\n        throw new Error(msg || 'error: getOrDie called on none.');\n      },\n      getOrNull: constant(null),\n      getOrUndefined: constant(undefined),\n      or: id,\n      orThunk: call,\n      map: none,\n      each: noop,\n      bind: none,\n      exists: never,\n      forall: always,\n      filter: none,\n      equals: eq,\n      equals_: eq,\n      toArray: function () {\n        return [];\n      },\n      toString: constant('none()')\n    };\n    return me;\n  }();\n\n  var some = function (a) {\n    var constant_a = constant(a);\n\n    var self = function () {\n      return me;\n    };\n\n    var bind = function (f) {\n      return f(a);\n    };\n\n    var me = {\n      fold: function (n, s) {\n        return s(a);\n      },\n      is: function (v) {\n        return a === v;\n      },\n      isSome: always,\n      isNone: never,\n      getOr: constant_a,\n      getOrThunk: constant_a,\n      getOrDie: constant_a,\n      getOrNull: constant_a,\n      getOrUndefined: constant_a,\n      or: self,\n      orThunk: self,\n      map: function (f) {\n        return some(f(a));\n      },\n      each: function (f) {\n        f(a);\n      },\n      bind: bind,\n      exists: bind,\n      forall: bind,\n      filter: function (f) {\n        return f(a) ? me : NONE;\n      },\n      toArray: function () {\n        return [a];\n      },\n      toString: function () {\n        return 'some(' + a + ')';\n      },\n      equals: function (o) {\n        return o.is(a);\n      },\n      equals_: function (o, elementEq) {\n        return o.fold(never, function (b) {\n          return elementEq(a, b);\n        });\n      }\n    };\n    return me;\n  };\n\n  var from = function (value) {\n    return value === null || value === undefined ? NONE : some(value);\n  };\n\n  var Optional = {\n    some: some,\n    none: none,\n    from: from\n  };\n  var nativeSlice = Array.prototype.slice;\n  var nativeIndexOf = Array.prototype.indexOf;\n  var nativePush = Array.prototype.push;\n\n  var rawIndexOf = function (ts, t) {\n    return nativeIndexOf.call(ts, t);\n  };\n\n  var indexOf = function (xs, x) {\n    var r = rawIndexOf(xs, x);\n    return r === -1 ? Optional.none() : Optional.some(r);\n  };\n\n  var contains = function (xs, x) {\n    return rawIndexOf(xs, x) > -1;\n  };\n\n  var exists = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var map = function (xs, f) {\n    var len = xs.length;\n    var r = new Array(len);\n\n    for (var i = 0; i < len; i++) {\n      var x = xs[i];\n      r[i] = f(x, i);\n    }\n\n    return r;\n  };\n\n  var each = function (xs, f) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      f(x, i);\n    }\n  };\n\n  var eachr = function (xs, f) {\n    for (var i = xs.length - 1; i >= 0; i--) {\n      var x = xs[i];\n      f(x, i);\n    }\n  };\n\n  var partition = function (xs, pred) {\n    var pass = [];\n    var fail = [];\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      var arr = pred(x, i) ? pass : fail;\n      arr.push(x);\n    }\n\n    return {\n      pass: pass,\n      fail: fail\n    };\n  };\n\n  var filter = function (xs, pred) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        r.push(x);\n      }\n    }\n\n    return r;\n  };\n\n  var foldr = function (xs, f, acc) {\n    eachr(xs, function (x) {\n      acc = f(acc, x);\n    });\n    return acc;\n  };\n\n  var foldl = function (xs, f, acc) {\n    each(xs, function (x) {\n      acc = f(acc, x);\n    });\n    return acc;\n  };\n\n  var findUntil = function (xs, pred, until) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return Optional.some(x);\n      } else if (until(x, i)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var find = function (xs, pred) {\n    return findUntil(xs, pred, never);\n  };\n\n  var findIndex = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return Optional.some(i);\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var flatten = function (xs) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      if (!isArray(xs[i])) {\n        throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n      }\n\n      nativePush.apply(r, xs[i]);\n    }\n\n    return r;\n  };\n\n  var bind = function (xs, f) {\n    return flatten(map(xs, f));\n  };\n\n  var forall = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      var x = xs[i];\n\n      if (pred(x, i) !== true) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  var reverse = function (xs) {\n    var r = nativeSlice.call(xs, 0);\n    r.reverse();\n    return r;\n  };\n\n  var difference = function (a1, a2) {\n    return filter(a1, function (x) {\n      return !contains(a2, x);\n    });\n  };\n\n  var mapToObject = function (xs, f) {\n    var r = {};\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      r[String(x)] = f(x, i);\n    }\n\n    return r;\n  };\n\n  var sort$1 = function (xs, comparator) {\n    var copy = nativeSlice.call(xs, 0);\n    copy.sort(comparator);\n    return copy;\n  };\n\n  var get = function (xs, i) {\n    return i >= 0 && i < xs.length ? Optional.some(xs[i]) : Optional.none();\n  };\n\n  var head = function (xs) {\n    return get(xs, 0);\n  };\n\n  var last = function (xs) {\n    return get(xs, xs.length - 1);\n  };\n\n  var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n    return nativeSlice.call(x);\n  };\n\n  var findMap = function (arr, f) {\n    for (var i = 0; i < arr.length; i++) {\n      var r = f(arr[i], i);\n\n      if (r.isSome()) {\n        return r;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var keys = Object.keys;\n  var hasOwnProperty = Object.hasOwnProperty;\n\n  var each$1 = function (obj, f) {\n    var props = keys(obj);\n\n    for (var k = 0, len = props.length; k < len; k++) {\n      var i = props[k];\n      var x = obj[i];\n      f(x, i);\n    }\n  };\n\n  var map$1 = function (obj, f) {\n    return tupleMap(obj, function (x, i) {\n      return {\n        k: i,\n        v: f(x, i)\n      };\n    });\n  };\n\n  var tupleMap = function (obj, f) {\n    var r = {};\n    each$1(obj, function (x, i) {\n      var tuple = f(x, i);\n      r[tuple.k] = tuple.v;\n    });\n    return r;\n  };\n\n  var objAcc = function (r) {\n    return function (x, i) {\n      r[i] = x;\n    };\n  };\n\n  var internalFilter = function (obj, pred, onTrue, onFalse) {\n    var r = {};\n    each$1(obj, function (x, i) {\n      (pred(x, i) ? onTrue : onFalse)(x, i);\n    });\n    return r;\n  };\n\n  var bifilter = function (obj, pred) {\n    var t = {};\n    var f = {};\n    internalFilter(obj, pred, objAcc(t), objAcc(f));\n    return {\n      t: t,\n      f: f\n    };\n  };\n\n  var filter$1 = function (obj, pred) {\n    var t = {};\n    internalFilter(obj, pred, objAcc(t), noop);\n    return t;\n  };\n\n  var mapToArray = function (obj, f) {\n    var r = [];\n    each$1(obj, function (value, name) {\n      r.push(f(value, name));\n    });\n    return r;\n  };\n\n  var values = function (obj) {\n    return mapToArray(obj, function (v) {\n      return v;\n    });\n  };\n\n  var get$1 = function (obj, key) {\n    return has(obj, key) ? Optional.from(obj[key]) : Optional.none();\n  };\n\n  var has = function (obj, key) {\n    return hasOwnProperty.call(obj, key);\n  };\n\n  var hasNonNullableKey = function (obj, key) {\n    return has(obj, key) && obj[key] !== undefined && obj[key] !== null;\n  };\n\n  var equal = function (a1, a2, eq) {\n    if (eq === void 0) {\n      eq = eqAny;\n    }\n\n    return eqRecord(eq).eq(a1, a2);\n  };\n\n  var isArray$1 = Array.isArray;\n\n  var toArray = function (obj) {\n    if (!isArray$1(obj)) {\n      var array = [];\n\n      for (var i = 0, l = obj.length; i < l; i++) {\n        array[i] = obj[i];\n      }\n\n      return array;\n    } else {\n      return obj;\n    }\n  };\n\n  var each$2 = function (o, cb, s) {\n    var n, l;\n\n    if (!o) {\n      return false;\n    }\n\n    s = s || o;\n\n    if (o.length !== undefined) {\n      for (n = 0, l = o.length; n < l; n++) {\n        if (cb.call(s, o[n], n, o) === false) {\n          return false;\n        }\n      }\n    } else {\n      for (n in o) {\n        if (o.hasOwnProperty(n)) {\n          if (cb.call(s, o[n], n, o) === false) {\n            return false;\n          }\n        }\n      }\n    }\n\n    return true;\n  };\n\n  var map$2 = function (array, callback) {\n    var out = [];\n    each$2(array, function (item, index) {\n      out.push(callback(item, index, array));\n    });\n    return out;\n  };\n\n  var filter$2 = function (a, f) {\n    var o = [];\n    each$2(a, function (v, index) {\n      if (!f || f(v, index, a)) {\n        o.push(v);\n      }\n    });\n    return o;\n  };\n\n  var indexOf$1 = function (a, v) {\n    if (a) {\n      for (var i = 0, l = a.length; i < l; i++) {\n        if (a[i] === v) {\n          return i;\n        }\n      }\n    }\n\n    return -1;\n  };\n\n  var reduce = function (collection, iteratee, accumulator, thisArg) {\n    var acc = isUndefined(accumulator) ? collection[0] : accumulator;\n\n    for (var i = 0; i < collection.length; i++) {\n      acc = iteratee.call(thisArg, acc, collection[i], i);\n    }\n\n    return acc;\n  };\n\n  var findIndex$1 = function (array, predicate, thisArg) {\n    var i, l;\n\n    for (i = 0, l = array.length; i < l; i++) {\n      if (predicate.call(thisArg, array[i], i, array)) {\n        return i;\n      }\n    }\n\n    return -1;\n  };\n\n  var last$1 = function (collection) {\n    return collection[collection.length - 1];\n  };\n\n  var __assign = function () {\n    __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n\n      return t;\n    };\n\n    return __assign.apply(this, arguments);\n  };\n\n  function __rest(s, e) {\n    var t = {};\n\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n    if (s != null && typeof Object.getOwnPropertySymbols === 'function') for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n      if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n    }\n    return t;\n  }\n\n  function __spreadArrays() {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n    for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n    return r;\n  }\n\n  var cached = function (f) {\n    var called = false;\n    var r;\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (!called) {\n        called = true;\n        r = f.apply(null, args);\n      }\n\n      return r;\n    };\n  };\n\n  var DeviceType = function (os, browser, userAgent, mediaMatch) {\n    var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n    var isiPhone = os.isiOS() && !isiPad;\n    var isMobile = os.isiOS() || os.isAndroid();\n    var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n    var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n    var isPhone = isiPhone || isMobile && !isTablet;\n    var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n    var isDesktop = !isPhone && !isTablet && !iOSwebview;\n    return {\n      isiPad: constant(isiPad),\n      isiPhone: constant(isiPhone),\n      isTablet: constant(isTablet),\n      isPhone: constant(isPhone),\n      isTouch: constant(isTouch),\n      isAndroid: os.isAndroid,\n      isiOS: os.isiOS,\n      isWebView: constant(iOSwebview),\n      isDesktop: constant(isDesktop)\n    };\n  };\n\n  var firstMatch = function (regexes, s) {\n    for (var i = 0; i < regexes.length; i++) {\n      var x = regexes[i];\n\n      if (x.test(s)) {\n        return x;\n      }\n    }\n\n    return undefined;\n  };\n\n  var find$1 = function (regexes, agent) {\n    var r = firstMatch(regexes, agent);\n\n    if (!r) {\n      return {\n        major: 0,\n        minor: 0\n      };\n    }\n\n    var group = function (i) {\n      return Number(agent.replace(r, '$' + i));\n    };\n\n    return nu(group(1), group(2));\n  };\n\n  var detect = function (versionRegexes, agent) {\n    var cleanedAgent = String(agent).toLowerCase();\n\n    if (versionRegexes.length === 0) {\n      return unknown();\n    }\n\n    return find$1(versionRegexes, cleanedAgent);\n  };\n\n  var unknown = function () {\n    return nu(0, 0);\n  };\n\n  var nu = function (major, minor) {\n    return {\n      major: major,\n      minor: minor\n    };\n  };\n\n  var Version = {\n    nu: nu,\n    detect: detect,\n    unknown: unknown\n  };\n\n  var detect$1 = function (candidates, userAgent) {\n    var agent = String(userAgent).toLowerCase();\n    return find(candidates, function (candidate) {\n      return candidate.search(agent);\n    });\n  };\n\n  var detectBrowser = function (browsers, userAgent) {\n    return detect$1(browsers, userAgent).map(function (browser) {\n      var version = Version.detect(browser.versionRegexes, userAgent);\n      return {\n        current: browser.name,\n        version: version\n      };\n    });\n  };\n\n  var detectOs = function (oses, userAgent) {\n    return detect$1(oses, userAgent).map(function (os) {\n      var version = Version.detect(os.versionRegexes, userAgent);\n      return {\n        current: os.name,\n        version: version\n      };\n    });\n  };\n\n  var UaString = {\n    detectBrowser: detectBrowser,\n    detectOs: detectOs\n  };\n\n  var removeFromStart = function (str, numChars) {\n    return str.substring(numChars);\n  };\n\n  var checkRange = function (str, substr, start) {\n    return substr === '' || str.length >= substr.length && str.substr(start, start + substr.length) === substr;\n  };\n\n  var removeLeading = function (str, prefix) {\n    return startsWith(str, prefix) ? removeFromStart(str, prefix.length) : str;\n  };\n\n  var contains$1 = function (str, substr) {\n    return str.indexOf(substr) !== -1;\n  };\n\n  var startsWith = function (str, prefix) {\n    return checkRange(str, prefix, 0);\n  };\n\n  var blank = function (r) {\n    return function (s) {\n      return s.replace(r, '');\n    };\n  };\n\n  var trim = blank(/^\\s+|\\s+$/g);\n  var lTrim = blank(/^\\s+/g);\n  var rTrim = blank(/\\s+$/g);\n\n  var isNotEmpty = function (s) {\n    return s.length > 0;\n  };\n\n  var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n\n  var checkContains = function (target) {\n    return function (uastring) {\n      return contains$1(uastring, target);\n    };\n  };\n\n  var browsers = [{\n    name: 'Edge',\n    versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n    search: function (uastring) {\n      return contains$1(uastring, 'edge/') && contains$1(uastring, 'chrome') && contains$1(uastring, 'safari') && contains$1(uastring, 'applewebkit');\n    }\n  }, {\n    name: 'Chrome',\n    versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/, normalVersionRegex],\n    search: function (uastring) {\n      return contains$1(uastring, 'chrome') && !contains$1(uastring, 'chromeframe');\n    }\n  }, {\n    name: 'IE',\n    versionRegexes: [/.*?msie\\ ?([0-9]+)\\.([0-9]+).*/, /.*?rv:([0-9]+)\\.([0-9]+).*/],\n    search: function (uastring) {\n      return contains$1(uastring, 'msie') || contains$1(uastring, 'trident');\n    }\n  }, {\n    name: 'Opera',\n    versionRegexes: [normalVersionRegex, /.*?opera\\/([0-9]+)\\.([0-9]+).*/],\n    search: checkContains('opera')\n  }, {\n    name: 'Firefox',\n    versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n    search: checkContains('firefox')\n  }, {\n    name: 'Safari',\n    versionRegexes: [normalVersionRegex, /.*?cpu os ([0-9]+)_([0-9]+).*/],\n    search: function (uastring) {\n      return (contains$1(uastring, 'safari') || contains$1(uastring, 'mobile/')) && contains$1(uastring, 'applewebkit');\n    }\n  }];\n  var oses = [{\n    name: 'Windows',\n    search: checkContains('win'),\n    versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n  }, {\n    name: 'iOS',\n    search: function (uastring) {\n      return contains$1(uastring, 'iphone') || contains$1(uastring, 'ipad');\n    },\n    versionRegexes: [/.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/, /.*cpu os ([0-9]+)_([0-9]+).*/, /.*cpu iphone os ([0-9]+)_([0-9]+).*/]\n  }, {\n    name: 'Android',\n    search: checkContains('android'),\n    versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n  }, {\n    name: 'OSX',\n    search: checkContains('mac os x'),\n    versionRegexes: [/.*?mac\\ os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n  }, {\n    name: 'Linux',\n    search: checkContains('linux'),\n    versionRegexes: []\n  }, {\n    name: 'Solaris',\n    search: checkContains('sunos'),\n    versionRegexes: []\n  }, {\n    name: 'FreeBSD',\n    search: checkContains('freebsd'),\n    versionRegexes: []\n  }, {\n    name: 'ChromeOS',\n    search: checkContains('cros'),\n    versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/]\n  }];\n  var PlatformInfo = {\n    browsers: constant(browsers),\n    oses: constant(oses)\n  };\n  var edge = 'Edge';\n  var chrome = 'Chrome';\n  var ie = 'IE';\n  var opera = 'Opera';\n  var firefox = 'Firefox';\n  var safari = 'Safari';\n\n  var unknown$1 = function () {\n    return nu$1({\n      current: undefined,\n      version: Version.unknown()\n    });\n  };\n\n  var nu$1 = function (info) {\n    var current = info.current;\n    var version = info.version;\n\n    var isBrowser = function (name) {\n      return function () {\n        return current === name;\n      };\n    };\n\n    return {\n      current: current,\n      version: version,\n      isEdge: isBrowser(edge),\n      isChrome: isBrowser(chrome),\n      isIE: isBrowser(ie),\n      isOpera: isBrowser(opera),\n      isFirefox: isBrowser(firefox),\n      isSafari: isBrowser(safari)\n    };\n  };\n\n  var Browser = {\n    unknown: unknown$1,\n    nu: nu$1,\n    edge: constant(edge),\n    chrome: constant(chrome),\n    ie: constant(ie),\n    opera: constant(opera),\n    firefox: constant(firefox),\n    safari: constant(safari)\n  };\n  var windows = 'Windows';\n  var ios = 'iOS';\n  var android = 'Android';\n  var linux = 'Linux';\n  var osx = 'OSX';\n  var solaris = 'Solaris';\n  var freebsd = 'FreeBSD';\n  var chromeos = 'ChromeOS';\n\n  var unknown$2 = function () {\n    return nu$2({\n      current: undefined,\n      version: Version.unknown()\n    });\n  };\n\n  var nu$2 = function (info) {\n    var current = info.current;\n    var version = info.version;\n\n    var isOS = function (name) {\n      return function () {\n        return current === name;\n      };\n    };\n\n    return {\n      current: current,\n      version: version,\n      isWindows: isOS(windows),\n      isiOS: isOS(ios),\n      isAndroid: isOS(android),\n      isOSX: isOS(osx),\n      isLinux: isOS(linux),\n      isSolaris: isOS(solaris),\n      isFreeBSD: isOS(freebsd),\n      isChromeOS: isOS(chromeos)\n    };\n  };\n\n  var OperatingSystem = {\n    unknown: unknown$2,\n    nu: nu$2,\n    windows: constant(windows),\n    ios: constant(ios),\n    android: constant(android),\n    linux: constant(linux),\n    osx: constant(osx),\n    solaris: constant(solaris),\n    freebsd: constant(freebsd),\n    chromeos: constant(chromeos)\n  };\n\n  var detect$2 = function (userAgent, mediaMatch) {\n    var browsers = PlatformInfo.browsers();\n    var oses = PlatformInfo.oses();\n    var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n    var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n    var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n    return {\n      browser: browser,\n      os: os,\n      deviceType: deviceType\n    };\n  };\n\n  var PlatformDetection = {\n    detect: detect$2\n  };\n\n  var mediaMatch = function (query) {\n    return window.matchMedia(query).matches;\n  };\n\n  var platform = cached(function () {\n    return PlatformDetection.detect(navigator.userAgent, mediaMatch);\n  });\n\n  var detect$3 = function () {\n    return platform();\n  };\n\n  var userAgent = navigator.userAgent;\n  var platform$1 = detect$3();\n  var browser = platform$1.browser;\n  var os = platform$1.os;\n  var deviceType = platform$1.deviceType;\n  var webkit = /WebKit/.test(userAgent) && !browser.isEdge();\n  var fileApi = 'FormData' in window && 'FileReader' in window && 'URL' in window && !!URL.createObjectURL;\n  var windowsPhone = userAgent.indexOf('Windows Phone') !== -1;\n  var Env = {\n    opera: browser.isOpera(),\n    webkit: webkit,\n    ie: browser.isIE() || browser.isEdge() ? browser.version.major : false,\n    gecko: browser.isFirefox(),\n    mac: os.isOSX() || os.isiOS(),\n    iOS: deviceType.isiPad() || deviceType.isiPhone(),\n    android: os.isAndroid(),\n    contentEditable: true,\n    transparentSrc: 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7',\n    caretAfter: true,\n    range: window.getSelection && 'Range' in window,\n    documentMode: browser.isIE() ? document.documentMode || 7 : 10,\n    fileApi: fileApi,\n    ceFalse: true,\n    cacheSuffix: null,\n    container: null,\n    experimentalShadowDom: false,\n    canHaveCSP: !browser.isIE(),\n    desktop: deviceType.isDesktop(),\n    windowsPhone: windowsPhone,\n    browser: {\n      current: browser.current,\n      version: browser.version,\n      isChrome: browser.isChrome,\n      isEdge: browser.isEdge,\n      isFirefox: browser.isFirefox,\n      isIE: browser.isIE,\n      isOpera: browser.isOpera,\n      isSafari: browser.isSafari\n    },\n    os: {\n      current: os.current,\n      version: os.version,\n      isAndroid: os.isAndroid,\n      isChromeOS: os.isChromeOS,\n      isFreeBSD: os.isFreeBSD,\n      isiOS: os.isiOS,\n      isLinux: os.isLinux,\n      isOSX: os.isOSX,\n      isSolaris: os.isSolaris,\n      isWindows: os.isWindows\n    },\n    deviceType: {\n      isDesktop: deviceType.isDesktop,\n      isiPad: deviceType.isiPad,\n      isiPhone: deviceType.isiPhone,\n      isPhone: deviceType.isPhone,\n      isTablet: deviceType.isTablet,\n      isTouch: deviceType.isTouch,\n      isWebView: deviceType.isWebView\n    }\n  };\n  var whiteSpaceRegExp = /^\\s*|\\s*$/g;\n\n  var trim$1 = function (str) {\n    return str === null || str === undefined ? '' : ('' + str).replace(whiteSpaceRegExp, '');\n  };\n\n  var is = function (obj, type) {\n    if (!type) {\n      return obj !== undefined;\n    }\n\n    if (type === 'array' && isArray$1(obj)) {\n      return true;\n    }\n\n    return typeof obj === type;\n  };\n\n  var makeMap = function (items, delim, map) {\n    var i;\n    items = items || [];\n    delim = delim || ',';\n\n    if (typeof items === 'string') {\n      items = items.split(delim);\n    }\n\n    map = map || {};\n    i = items.length;\n\n    while (i--) {\n      map[items[i]] = {};\n    }\n\n    return map;\n  };\n\n  var hasOwnProperty$1 = function (obj, prop) {\n    return Object.prototype.hasOwnProperty.call(obj, prop);\n  };\n\n  var create = function (s, p, root) {\n    var self = this;\n    var sp,\n        scn,\n        c,\n        de = 0;\n    s = /^((static) )?([\\w.]+)(:([\\w.]+))?/.exec(s);\n    var cn = s[3].match(/(^|\\.)(\\w+)$/i)[2];\n    var ns = self.createNS(s[3].replace(/\\.\\w+$/, ''), root);\n\n    if (ns[cn]) {\n      return;\n    }\n\n    if (s[2] === 'static') {\n      ns[cn] = p;\n\n      if (this.onCreate) {\n        this.onCreate(s[2], s[3], ns[cn]);\n      }\n\n      return;\n    }\n\n    if (!p[cn]) {\n      p[cn] = function () {};\n\n      de = 1;\n    }\n\n    ns[cn] = p[cn];\n    self.extend(ns[cn].prototype, p);\n\n    if (s[5]) {\n      sp = self.resolve(s[5]).prototype;\n      scn = s[5].match(/\\.(\\w+)$/i)[1];\n      c = ns[cn];\n\n      if (de) {\n        ns[cn] = function () {\n          return sp[scn].apply(this, arguments);\n        };\n      } else {\n        ns[cn] = function () {\n          this.parent = sp[scn];\n          return c.apply(this, arguments);\n        };\n      }\n\n      ns[cn].prototype[cn] = ns[cn];\n      self.each(sp, function (f, n) {\n        ns[cn].prototype[n] = sp[n];\n      });\n      self.each(p, function (f, n) {\n        if (sp[n]) {\n          ns[cn].prototype[n] = function () {\n            this.parent = sp[n];\n            return f.apply(this, arguments);\n          };\n        } else {\n          if (n !== cn) {\n            ns[cn].prototype[n] = f;\n          }\n        }\n      });\n    }\n\n    self.each(p.static, function (f, n) {\n      ns[cn][n] = f;\n    });\n  };\n\n  var extend = function (obj) {\n    var exts = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      exts[_i - 1] = arguments[_i];\n    }\n\n    for (var i = 0; i < exts.length; i++) {\n      var ext = exts[i];\n\n      for (var name_1 in ext) {\n        if (ext.hasOwnProperty(name_1)) {\n          var value = ext[name_1];\n\n          if (value !== undefined) {\n            obj[name_1] = value;\n          }\n        }\n      }\n    }\n\n    return obj;\n  };\n\n  var walk = function (o, f, n, s) {\n    s = s || this;\n\n    if (o) {\n      if (n) {\n        o = o[n];\n      }\n\n      each$2(o, function (o, i) {\n        if (f.call(s, o, i, n) === false) {\n          return false;\n        }\n\n        walk(o, f, n, s);\n      });\n    }\n  };\n\n  var createNS = function (n, o) {\n    var i, v;\n    o = o || window;\n    n = n.split('.');\n\n    for (i = 0; i < n.length; i++) {\n      v = n[i];\n\n      if (!o[v]) {\n        o[v] = {};\n      }\n\n      o = o[v];\n    }\n\n    return o;\n  };\n\n  var resolve = function (n, o) {\n    var i, l;\n    o = o || window;\n    n = n.split('.');\n\n    for (i = 0, l = n.length; i < l; i++) {\n      o = o[n[i]];\n\n      if (!o) {\n        break;\n      }\n    }\n\n    return o;\n  };\n\n  var explode = function (s, d) {\n    if (!s || is(s, 'array')) {\n      return s;\n    }\n\n    return map$2(s.split(d || ','), trim$1);\n  };\n\n  var _addCacheSuffix = function (url) {\n    var cacheSuffix = Env.cacheSuffix;\n\n    if (cacheSuffix) {\n      url += (url.indexOf('?') === -1 ? '?' : '&') + cacheSuffix;\n    }\n\n    return url;\n  };\n\n  var Tools = {\n    trim: trim$1,\n    isArray: isArray$1,\n    is: is,\n    toArray: toArray,\n    makeMap: makeMap,\n    each: each$2,\n    map: map$2,\n    grep: filter$2,\n    inArray: indexOf$1,\n    hasOwn: hasOwnProperty$1,\n    extend: extend,\n    create: create,\n    walk: walk,\n    createNS: createNS,\n    resolve: resolve,\n    explode: explode,\n    _addCacheSuffix: _addCacheSuffix\n  };\n\n  var fromHtml = function (html, scope) {\n    var doc = scope || document;\n    var div = doc.createElement('div');\n    div.innerHTML = html;\n\n    if (!div.hasChildNodes() || div.childNodes.length > 1) {\n      console.error('HTML does not have a single root node', html);\n      throw new Error('HTML must have a single root node');\n    }\n\n    return fromDom(div.childNodes[0]);\n  };\n\n  var fromTag = function (tag, scope) {\n    var doc = scope || document;\n    var node = doc.createElement(tag);\n    return fromDom(node);\n  };\n\n  var fromText = function (text, scope) {\n    var doc = scope || document;\n    var node = doc.createTextNode(text);\n    return fromDom(node);\n  };\n\n  var fromDom = function (node) {\n    if (node === null || node === undefined) {\n      throw new Error('Node cannot be null or undefined');\n    }\n\n    return {\n      dom: node\n    };\n  };\n\n  var fromPoint = function (docElm, x, y) {\n    return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom);\n  };\n\n  var SugarElement = {\n    fromHtml: fromHtml,\n    fromTag: fromTag,\n    fromText: fromText,\n    fromDom: fromDom,\n    fromPoint: fromPoint\n  };\n\n  var toArray$1 = function (target, f) {\n    var r = [];\n\n    var recurse = function (e) {\n      r.push(e);\n      return f(e);\n    };\n\n    var cur = f(target);\n\n    do {\n      cur = cur.bind(recurse);\n    } while (cur.isSome());\n\n    return r;\n  };\n\n  var compareDocumentPosition = function (a, b, match) {\n    return (a.compareDocumentPosition(b) & match) !== 0;\n  };\n\n  var documentPositionContainedBy = function (a, b) {\n    return compareDocumentPosition(a, b, Node.DOCUMENT_POSITION_CONTAINED_BY);\n  };\n\n  var COMMENT = 8;\n  var DOCUMENT = 9;\n  var DOCUMENT_FRAGMENT = 11;\n  var ELEMENT = 1;\n  var TEXT = 3;\n\n  var is$1 = function (element, selector) {\n    var dom = element.dom;\n\n    if (dom.nodeType !== ELEMENT) {\n      return false;\n    } else {\n      var elem = dom;\n\n      if (elem.matches !== undefined) {\n        return elem.matches(selector);\n      } else if (elem.msMatchesSelector !== undefined) {\n        return elem.msMatchesSelector(selector);\n      } else if (elem.webkitMatchesSelector !== undefined) {\n        return elem.webkitMatchesSelector(selector);\n      } else if (elem.mozMatchesSelector !== undefined) {\n        return elem.mozMatchesSelector(selector);\n      } else {\n        throw new Error('Browser lacks native selectors');\n      }\n    }\n  };\n\n  var bypassSelector = function (dom) {\n    return dom.nodeType !== ELEMENT && dom.nodeType !== DOCUMENT && dom.nodeType !== DOCUMENT_FRAGMENT || dom.childElementCount === 0;\n  };\n\n  var all = function (selector, scope) {\n    var base = scope === undefined ? document : scope.dom;\n    return bypassSelector(base) ? [] : map(base.querySelectorAll(selector), SugarElement.fromDom);\n  };\n\n  var one = function (selector, scope) {\n    var base = scope === undefined ? document : scope.dom;\n    return bypassSelector(base) ? Optional.none() : Optional.from(base.querySelector(selector)).map(SugarElement.fromDom);\n  };\n\n  var eq$2 = function (e1, e2) {\n    return e1.dom === e2.dom;\n  };\n\n  var regularContains = function (e1, e2) {\n    var d1 = e1.dom;\n    var d2 = e2.dom;\n    return d1 === d2 ? false : d1.contains(d2);\n  };\n\n  var ieContains = function (e1, e2) {\n    return documentPositionContainedBy(e1.dom, e2.dom);\n  };\n\n  var contains$2 = function (e1, e2) {\n    return detect$3().browser.isIE() ? ieContains(e1, e2) : regularContains(e1, e2);\n  };\n\n  var Global = typeof window !== 'undefined' ? window : Function('return this;')();\n\n  var name = function (element) {\n    var r = element.dom.nodeName;\n    return r.toLowerCase();\n  };\n\n  var type = function (element) {\n    return element.dom.nodeType;\n  };\n\n  var isType$1 = function (t) {\n    return function (element) {\n      return type(element) === t;\n    };\n  };\n\n  var isComment = function (element) {\n    return type(element) === COMMENT || name(element) === '#comment';\n  };\n\n  var isElement = isType$1(ELEMENT);\n  var isText = isType$1(TEXT);\n  var isDocument = isType$1(DOCUMENT);\n  var isDocumentFragment = isType$1(DOCUMENT_FRAGMENT);\n\n  var owner = function (element) {\n    return SugarElement.fromDom(element.dom.ownerDocument);\n  };\n\n  var documentOrOwner = function (dos) {\n    return isDocument(dos) ? dos : owner(dos);\n  };\n\n  var documentElement = function (element) {\n    return SugarElement.fromDom(documentOrOwner(element).dom.documentElement);\n  };\n\n  var defaultView = function (element) {\n    return SugarElement.fromDom(documentOrOwner(element).dom.defaultView);\n  };\n\n  var parent = function (element) {\n    return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);\n  };\n\n  var parents = function (element, isRoot) {\n    var stop = isFunction(isRoot) ? isRoot : never;\n    var dom = element.dom;\n    var ret = [];\n\n    while (dom.parentNode !== null && dom.parentNode !== undefined) {\n      var rawParent = dom.parentNode;\n      var p = SugarElement.fromDom(rawParent);\n      ret.push(p);\n\n      if (stop(p) === true) {\n        break;\n      } else {\n        dom = rawParent;\n      }\n    }\n\n    return ret;\n  };\n\n  var siblings = function (element) {\n    var filterSelf = function (elements) {\n      return filter(elements, function (x) {\n        return !eq$2(element, x);\n      });\n    };\n\n    return parent(element).map(children).map(filterSelf).getOr([]);\n  };\n\n  var prevSibling = function (element) {\n    return Optional.from(element.dom.previousSibling).map(SugarElement.fromDom);\n  };\n\n  var nextSibling = function (element) {\n    return Optional.from(element.dom.nextSibling).map(SugarElement.fromDom);\n  };\n\n  var prevSiblings = function (element) {\n    return reverse(toArray$1(element, prevSibling));\n  };\n\n  var nextSiblings = function (element) {\n    return toArray$1(element, nextSibling);\n  };\n\n  var children = function (element) {\n    return map(element.dom.childNodes, SugarElement.fromDom);\n  };\n\n  var child = function (element, index) {\n    var cs = element.dom.childNodes;\n    return Optional.from(cs[index]).map(SugarElement.fromDom);\n  };\n\n  var firstChild = function (element) {\n    return child(element, 0);\n  };\n\n  var lastChild = function (element) {\n    return child(element, element.dom.childNodes.length - 1);\n  };\n\n  var childNodesCount = function (element) {\n    return element.dom.childNodes.length;\n  };\n\n  var getHead = function (doc) {\n    var b = doc.dom.head;\n\n    if (b === null || b === undefined) {\n      throw new Error('Head is not available yet');\n    }\n\n    return SugarElement.fromDom(b);\n  };\n\n  var isShadowRoot = function (dos) {\n    return isDocumentFragment(dos) && isNonNullable(dos.dom.host);\n  };\n\n  var supported = isFunction(Element.prototype.attachShadow) && isFunction(Node.prototype.getRootNode);\n  var isSupported = constant(supported);\n  var getRootNode = supported ? function (e) {\n    return SugarElement.fromDom(e.dom.getRootNode());\n  } : documentOrOwner;\n\n  var getStyleContainer = function (dos) {\n    return isShadowRoot(dos) ? dos : getHead(documentOrOwner(dos));\n  };\n\n  var getShadowRoot = function (e) {\n    var r = getRootNode(e);\n    return isShadowRoot(r) ? Optional.some(r) : Optional.none();\n  };\n\n  var getShadowHost = function (e) {\n    return SugarElement.fromDom(e.dom.host);\n  };\n\n  var getOriginalEventTarget = function (event) {\n    if (isSupported() && isNonNullable(event.target)) {\n      var el = SugarElement.fromDom(event.target);\n\n      if (isElement(el) && isOpenShadowHost(el)) {\n        if (event.composed && event.composedPath) {\n          var composedPath = event.composedPath();\n\n          if (composedPath) {\n            return head(composedPath);\n          }\n        }\n      }\n    }\n\n    return Optional.from(event.target);\n  };\n\n  var isOpenShadowHost = function (element) {\n    return isNonNullable(element.dom.shadowRoot);\n  };\n\n  var before = function (marker, element) {\n    var parent$1 = parent(marker);\n    parent$1.each(function (v) {\n      v.dom.insertBefore(element.dom, marker.dom);\n    });\n  };\n\n  var after = function (marker, element) {\n    var sibling = nextSibling(marker);\n    sibling.fold(function () {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        append(v, element);\n      });\n    }, function (v) {\n      before(v, element);\n    });\n  };\n\n  var prepend = function (parent, element) {\n    var firstChild$1 = firstChild(parent);\n    firstChild$1.fold(function () {\n      append(parent, element);\n    }, function (v) {\n      parent.dom.insertBefore(element.dom, v.dom);\n    });\n  };\n\n  var append = function (parent, element) {\n    parent.dom.appendChild(element.dom);\n  };\n\n  var wrap = function (element, wrapper) {\n    before(element, wrapper);\n    append(wrapper, element);\n  };\n\n  var before$1 = function (marker, elements) {\n    each(elements, function (x) {\n      before(marker, x);\n    });\n  };\n\n  var append$1 = function (parent, elements) {\n    each(elements, function (x) {\n      append(parent, x);\n    });\n  };\n\n  var empty = function (element) {\n    element.dom.textContent = '';\n    each(children(element), function (rogue) {\n      remove(rogue);\n    });\n  };\n\n  var remove = function (element) {\n    var dom = element.dom;\n\n    if (dom.parentNode !== null) {\n      dom.parentNode.removeChild(dom);\n    }\n  };\n\n  var unwrap = function (wrapper) {\n    var children$1 = children(wrapper);\n\n    if (children$1.length > 0) {\n      before$1(wrapper, children$1);\n    }\n\n    remove(wrapper);\n  };\n\n  var inBody = function (element) {\n    var dom = isText(element) ? element.dom.parentNode : element.dom;\n\n    if (dom === undefined || dom === null || dom.ownerDocument === null) {\n      return false;\n    }\n\n    var doc = dom.ownerDocument;\n    return getShadowRoot(SugarElement.fromDom(dom)).fold(function () {\n      return doc.body.contains(dom);\n    }, compose1(inBody, getShadowHost));\n  };\n\n  var r = function (left, top) {\n    var translate = function (x, y) {\n      return r(left + x, top + y);\n    };\n\n    return {\n      left: left,\n      top: top,\n      translate: translate\n    };\n  };\n\n  var SugarPosition = r;\n\n  var boxPosition = function (dom) {\n    var box = dom.getBoundingClientRect();\n    return SugarPosition(box.left, box.top);\n  };\n\n  var firstDefinedOrZero = function (a, b) {\n    if (a !== undefined) {\n      return a;\n    } else {\n      return b !== undefined ? b : 0;\n    }\n  };\n\n  var absolute = function (element) {\n    var doc = element.dom.ownerDocument;\n    var body = doc.body;\n    var win = doc.defaultView;\n    var html = doc.documentElement;\n\n    if (body === element.dom) {\n      return SugarPosition(body.offsetLeft, body.offsetTop);\n    }\n\n    var scrollTop = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageYOffset, html.scrollTop);\n    var scrollLeft = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageXOffset, html.scrollLeft);\n    var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n    var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n    return viewport(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n  };\n\n  var viewport = function (element) {\n    var dom = element.dom;\n    var doc = dom.ownerDocument;\n    var body = doc.body;\n\n    if (body === dom) {\n      return SugarPosition(body.offsetLeft, body.offsetTop);\n    }\n\n    if (!inBody(element)) {\n      return SugarPosition(0, 0);\n    }\n\n    return boxPosition(dom);\n  };\n\n  var get$2 = function (_DOC) {\n    var doc = _DOC !== undefined ? _DOC.dom : document;\n    var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n    var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n    return SugarPosition(x, y);\n  };\n\n  var to = function (x, y, _DOC) {\n    var doc = _DOC !== undefined ? _DOC.dom : document;\n    var win = doc.defaultView;\n\n    if (win) {\n      win.scrollTo(x, y);\n    }\n  };\n\n  var intoView = function (element, alignToTop) {\n    var isSafari = detect$3().browser.isSafari();\n\n    if (isSafari && isFunction(element.dom.scrollIntoViewIfNeeded)) {\n      element.dom.scrollIntoViewIfNeeded(false);\n    } else {\n      element.dom.scrollIntoView(alignToTop);\n    }\n  };\n\n  var get$3 = function (_win) {\n    var win = _win === undefined ? window : _win;\n    return Optional.from(win['visualViewport']);\n  };\n\n  var bounds = function (x, y, width, height) {\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height,\n      right: x + width,\n      bottom: y + height\n    };\n  };\n\n  var getBounds = function (_win) {\n    var win = _win === undefined ? window : _win;\n    var doc = win.document;\n    var scroll = get$2(SugarElement.fromDom(doc));\n    return get$3(win).fold(function () {\n      var html = win.document.documentElement;\n      var width = html.clientWidth;\n      var height = html.clientHeight;\n      return bounds(scroll.left, scroll.top, width, height);\n    }, function (visualViewport) {\n      return bounds(Math.max(visualViewport.pageLeft, scroll.left), Math.max(visualViewport.pageTop, scroll.top), visualViewport.width, visualViewport.height);\n    });\n  };\n\n  var isNodeType = function (type) {\n    return function (node) {\n      return !!node && node.nodeType === type;\n    };\n  };\n\n  var isRestrictedNode = function (node) {\n    return !!node && !Object.getPrototypeOf(node);\n  };\n\n  var isElement$1 = isNodeType(1);\n\n  var matchNodeNames = function (names) {\n    var lowercasedNames = names.map(function (s) {\n      return s.toLowerCase();\n    });\n    return function (node) {\n      if (node && node.nodeName) {\n        var nodeName = node.nodeName.toLowerCase();\n        return contains(lowercasedNames, nodeName);\n      }\n\n      return false;\n    };\n  };\n\n  var matchStyleValues = function (name, values) {\n    var items = values.toLowerCase().split(' ');\n    return function (node) {\n      var i, cssValue;\n\n      if (isElement$1(node)) {\n        for (i = 0; i < items.length; i++) {\n          var computed = node.ownerDocument.defaultView.getComputedStyle(node, null);\n          cssValue = computed ? computed.getPropertyValue(name) : null;\n\n          if (cssValue === items[i]) {\n            return true;\n          }\n        }\n      }\n\n      return false;\n    };\n  };\n\n  var hasAttribute = function (attrName) {\n    return function (node) {\n      return isElement$1(node) && node.hasAttribute(attrName);\n    };\n  };\n\n  var hasAttributeValue = function (attrName, attrValue) {\n    return function (node) {\n      return isElement$1(node) && node.getAttribute(attrName) === attrValue;\n    };\n  };\n\n  var isBogus = function (node) {\n    return isElement$1(node) && node.hasAttribute('data-mce-bogus');\n  };\n\n  var isBogusAll = function (node) {\n    return isElement$1(node) && node.getAttribute('data-mce-bogus') === 'all';\n  };\n\n  var isTable = function (node) {\n    return isElement$1(node) && node.tagName === 'TABLE';\n  };\n\n  var hasContentEditableState = function (value) {\n    return function (node) {\n      if (isElement$1(node)) {\n        if (node.contentEditable === value) {\n          return true;\n        }\n\n        if (node.getAttribute('data-mce-contenteditable') === value) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n  };\n\n  var isTextareaOrInput = matchNodeNames(['textarea', 'input']);\n  var isText$1 = isNodeType(3);\n  var isComment$1 = isNodeType(8);\n  var isDocument$1 = isNodeType(9);\n  var isDocumentFragment$1 = isNodeType(11);\n  var isBr = matchNodeNames(['br']);\n  var isImg = matchNodeNames(['img']);\n  var isContentEditableTrue = hasContentEditableState('true');\n  var isContentEditableFalse = hasContentEditableState('false');\n  var isTableCell = matchNodeNames(['td', 'th']);\n  var isMedia = matchNodeNames(['video', 'audio', 'object', 'embed']);\n\n  var isSupported$1 = function (dom) {\n    return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n  };\n\n  var rawSet = function (dom, key, value) {\n    if (isString(value) || isBoolean(value) || isNumber(value)) {\n      dom.setAttribute(key, value + '');\n    } else {\n      console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n      throw new Error('Attribute value was not simple');\n    }\n  };\n\n  var set = function (element, key, value) {\n    rawSet(element.dom, key, value);\n  };\n\n  var setAll = function (element, attrs) {\n    var dom = element.dom;\n    each$1(attrs, function (v, k) {\n      rawSet(dom, k, v);\n    });\n  };\n\n  var get$4 = function (element, key) {\n    var v = element.dom.getAttribute(key);\n    return v === null ? undefined : v;\n  };\n\n  var getOpt = function (element, key) {\n    return Optional.from(get$4(element, key));\n  };\n\n  var has$1 = function (element, key) {\n    var dom = element.dom;\n    return dom && dom.hasAttribute ? dom.hasAttribute(key) : false;\n  };\n\n  var remove$1 = function (element, key) {\n    element.dom.removeAttribute(key);\n  };\n\n  var clone = function (element) {\n    return foldl(element.dom.attributes, function (acc, attr) {\n      acc[attr.name] = attr.value;\n      return acc;\n    }, {});\n  };\n\n  var internalSet = function (dom, property, value) {\n    if (!isString(value)) {\n      console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n      throw new Error('CSS value must be a string: ' + value);\n    }\n\n    if (isSupported$1(dom)) {\n      dom.style.setProperty(property, value);\n    }\n  };\n\n  var setAll$1 = function (element, css) {\n    var dom = element.dom;\n    each$1(css, function (v, k) {\n      internalSet(dom, k, v);\n    });\n  };\n\n  var get$5 = function (element, property) {\n    var dom = element.dom;\n    var styles = window.getComputedStyle(dom);\n    var r = styles.getPropertyValue(property);\n    return r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n  };\n\n  var getUnsafeProperty = function (dom, property) {\n    return isSupported$1(dom) ? dom.style.getPropertyValue(property) : '';\n  };\n\n  var getRaw = function (element, property) {\n    var dom = element.dom;\n    var raw = getUnsafeProperty(dom, property);\n    return Optional.from(raw).filter(function (r) {\n      return r.length > 0;\n    });\n  };\n\n  var getAllRaw = function (element) {\n    var css = {};\n    var dom = element.dom;\n\n    if (isSupported$1(dom)) {\n      for (var i = 0; i < dom.style.length; i++) {\n        var ruleName = dom.style.item(i);\n        css[ruleName] = dom.style[ruleName];\n      }\n    }\n\n    return css;\n  };\n\n  var reflow = function (e) {\n    return e.dom.offsetWidth;\n  };\n\n  var browser$1 = detect$3().browser;\n\n  var firstElement = function (nodes) {\n    return find(nodes, isElement);\n  };\n\n  var getTableCaptionDeltaY = function (elm) {\n    if (browser$1.isFirefox() && name(elm) === 'table') {\n      return firstElement(children(elm)).filter(function (elm) {\n        return name(elm) === 'caption';\n      }).bind(function (caption) {\n        return firstElement(nextSiblings(caption)).map(function (body) {\n          var bodyTop = body.dom.offsetTop;\n          var captionTop = caption.dom.offsetTop;\n          var captionHeight = caption.dom.offsetHeight;\n          return bodyTop <= captionTop ? -captionHeight : 0;\n        });\n      }).getOr(0);\n    } else {\n      return 0;\n    }\n  };\n\n  var hasChild = function (elm, child) {\n    return elm.children && contains(elm.children, child);\n  };\n\n  var getPos = function (body, elm, rootElm) {\n    var x = 0,\n        y = 0,\n        offsetParent;\n    var doc = body.ownerDocument;\n    var pos;\n    rootElm = rootElm ? rootElm : body;\n\n    if (elm) {\n      if (rootElm === body && elm.getBoundingClientRect && get$5(SugarElement.fromDom(body), 'position') === 'static') {\n        pos = elm.getBoundingClientRect();\n        x = pos.left + (doc.documentElement.scrollLeft || body.scrollLeft) - doc.documentElement.clientLeft;\n        y = pos.top + (doc.documentElement.scrollTop || body.scrollTop) - doc.documentElement.clientTop;\n        return {\n          x: x,\n          y: y\n        };\n      }\n\n      offsetParent = elm;\n\n      while (offsetParent && offsetParent !== rootElm && offsetParent.nodeType && !hasChild(offsetParent, rootElm)) {\n        x += offsetParent.offsetLeft || 0;\n        y += offsetParent.offsetTop || 0;\n        offsetParent = offsetParent.offsetParent;\n      }\n\n      offsetParent = elm.parentNode;\n\n      while (offsetParent && offsetParent !== rootElm && offsetParent.nodeType && !hasChild(offsetParent, rootElm)) {\n        x -= offsetParent.scrollLeft || 0;\n        y -= offsetParent.scrollTop || 0;\n        offsetParent = offsetParent.parentNode;\n      }\n\n      y += getTableCaptionDeltaY(SugarElement.fromDom(elm));\n    }\n\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  var exports$1 = {},\n      module$1 = {\n    exports: exports$1\n  };\n\n  (function (define, exports, module, require) {\n    (function (f) {\n      if (typeof exports === 'object' && typeof module !== 'undefined') {\n        module.exports = f();\n      } else if (typeof define === 'function' && define.amd) {\n        define([], f);\n      } else {\n        var g;\n\n        if (typeof window !== 'undefined') {\n          g = window;\n        } else if (typeof global !== 'undefined') {\n          g = global;\n        } else if (typeof self !== 'undefined') {\n          g = self;\n        } else {\n          g = this;\n        }\n\n        g.EphoxContactWrapper = f();\n      }\n    })(function () {\n      return function () {\n        function r(e, n, t) {\n          function o(i, f) {\n            if (!n[i]) {\n              if (!e[i]) {\n                var c = 'function' == typeof require && require;\n                if (!f && c) return c(i, !0);\n                if (u) return u(i, !0);\n                var a = new Error('Cannot find module \\'' + i + '\\'');\n                throw a.code = 'MODULE_NOT_FOUND', a;\n              }\n\n              var p = n[i] = {\n                exports: {}\n              };\n              e[i][0].call(p.exports, function (r) {\n                var n = e[i][1][r];\n                return o(n || r);\n              }, p, p.exports, r, e, n, t);\n            }\n\n            return n[i].exports;\n          }\n\n          for (var u = 'function' == typeof require && require, i = 0; i < t.length; i++) o(t[i]);\n\n          return o;\n        }\n\n        return r;\n      }()({\n        1: [function (require, module, exports) {\n          var process = module.exports = {};\n          var cachedSetTimeout;\n          var cachedClearTimeout;\n\n          function defaultSetTimout() {\n            throw new Error('setTimeout has not been defined');\n          }\n\n          function defaultClearTimeout() {\n            throw new Error('clearTimeout has not been defined');\n          }\n\n          (function () {\n            try {\n              if (typeof setTimeout === 'function') {\n                cachedSetTimeout = setTimeout;\n              } else {\n                cachedSetTimeout = defaultSetTimout;\n              }\n            } catch (e) {\n              cachedSetTimeout = defaultSetTimout;\n            }\n\n            try {\n              if (typeof clearTimeout === 'function') {\n                cachedClearTimeout = clearTimeout;\n              } else {\n                cachedClearTimeout = defaultClearTimeout;\n              }\n            } catch (e) {\n              cachedClearTimeout = defaultClearTimeout;\n            }\n          })();\n\n          function runTimeout(fun) {\n            if (cachedSetTimeout === setTimeout) {\n              return setTimeout(fun, 0);\n            }\n\n            if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n              cachedSetTimeout = setTimeout;\n              return setTimeout(fun, 0);\n            }\n\n            try {\n              return cachedSetTimeout(fun, 0);\n            } catch (e) {\n              try {\n                return cachedSetTimeout.call(null, fun, 0);\n              } catch (e) {\n                return cachedSetTimeout.call(this, fun, 0);\n              }\n            }\n          }\n\n          function runClearTimeout(marker) {\n            if (cachedClearTimeout === clearTimeout) {\n              return clearTimeout(marker);\n            }\n\n            if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n              cachedClearTimeout = clearTimeout;\n              return clearTimeout(marker);\n            }\n\n            try {\n              return cachedClearTimeout(marker);\n            } catch (e) {\n              try {\n                return cachedClearTimeout.call(null, marker);\n              } catch (e) {\n                return cachedClearTimeout.call(this, marker);\n              }\n            }\n          }\n\n          var queue = [];\n          var draining = false;\n          var currentQueue;\n          var queueIndex = -1;\n\n          function cleanUpNextTick() {\n            if (!draining || !currentQueue) {\n              return;\n            }\n\n            draining = false;\n\n            if (currentQueue.length) {\n              queue = currentQueue.concat(queue);\n            } else {\n              queueIndex = -1;\n            }\n\n            if (queue.length) {\n              drainQueue();\n            }\n          }\n\n          function drainQueue() {\n            if (draining) {\n              return;\n            }\n\n            var timeout = runTimeout(cleanUpNextTick);\n            draining = true;\n            var len = queue.length;\n\n            while (len) {\n              currentQueue = queue;\n              queue = [];\n\n              while (++queueIndex < len) {\n                if (currentQueue) {\n                  currentQueue[queueIndex].run();\n                }\n              }\n\n              queueIndex = -1;\n              len = queue.length;\n            }\n\n            currentQueue = null;\n            draining = false;\n            runClearTimeout(timeout);\n          }\n\n          process.nextTick = function (fun) {\n            var args = new Array(arguments.length - 1);\n\n            if (arguments.length > 1) {\n              for (var i = 1; i < arguments.length; i++) {\n                args[i - 1] = arguments[i];\n              }\n            }\n\n            queue.push(new Item(fun, args));\n\n            if (queue.length === 1 && !draining) {\n              runTimeout(drainQueue);\n            }\n          };\n\n          function Item(fun, array) {\n            this.fun = fun;\n            this.array = array;\n          }\n\n          Item.prototype.run = function () {\n            this.fun.apply(null, this.array);\n          };\n\n          process.title = 'browser';\n          process.browser = true;\n          process.env = {};\n          process.argv = [];\n          process.version = '';\n          process.versions = {};\n\n          function noop() {}\n\n          process.on = noop;\n          process.addListener = noop;\n          process.once = noop;\n          process.off = noop;\n          process.removeListener = noop;\n          process.removeAllListeners = noop;\n          process.emit = noop;\n          process.prependListener = noop;\n          process.prependOnceListener = noop;\n\n          process.listeners = function (name) {\n            return [];\n          };\n\n          process.binding = function (name) {\n            throw new Error('process.binding is not supported');\n          };\n\n          process.cwd = function () {\n            return '/';\n          };\n\n          process.chdir = function (dir) {\n            throw new Error('process.chdir is not supported');\n          };\n\n          process.umask = function () {\n            return 0;\n          };\n        }, {}],\n        2: [function (require, module, exports) {\n          (function (setImmediate) {\n            (function (root) {\n              var setTimeoutFunc = setTimeout;\n\n              function noop() {}\n\n              function bind(fn, thisArg) {\n                return function () {\n                  fn.apply(thisArg, arguments);\n                };\n              }\n\n              function Promise(fn) {\n                if (typeof this !== 'object') throw new TypeError('Promises must be constructed via new');\n                if (typeof fn !== 'function') throw new TypeError('not a function');\n                this._state = 0;\n                this._handled = false;\n                this._value = undefined;\n                this._deferreds = [];\n                doResolve(fn, this);\n              }\n\n              function handle(self, deferred) {\n                while (self._state === 3) {\n                  self = self._value;\n                }\n\n                if (self._state === 0) {\n                  self._deferreds.push(deferred);\n\n                  return;\n                }\n\n                self._handled = true;\n\n                Promise._immediateFn(function () {\n                  var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n\n                  if (cb === null) {\n                    (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                    return;\n                  }\n\n                  var ret;\n\n                  try {\n                    ret = cb(self._value);\n                  } catch (e) {\n                    reject(deferred.promise, e);\n                    return;\n                  }\n\n                  resolve(deferred.promise, ret);\n                });\n              }\n\n              function resolve(self, newValue) {\n                try {\n                  if (newValue === self) throw new TypeError('A promise cannot be resolved with itself.');\n\n                  if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                    var then = newValue.then;\n\n                    if (newValue instanceof Promise) {\n                      self._state = 3;\n                      self._value = newValue;\n                      finale(self);\n                      return;\n                    } else if (typeof then === 'function') {\n                      doResolve(bind(then, newValue), self);\n                      return;\n                    }\n                  }\n\n                  self._state = 1;\n                  self._value = newValue;\n                  finale(self);\n                } catch (e) {\n                  reject(self, e);\n                }\n              }\n\n              function reject(self, newValue) {\n                self._state = 2;\n                self._value = newValue;\n                finale(self);\n              }\n\n              function finale(self) {\n                if (self._state === 2 && self._deferreds.length === 0) {\n                  Promise._immediateFn(function () {\n                    if (!self._handled) {\n                      Promise._unhandledRejectionFn(self._value);\n                    }\n                  });\n                }\n\n                for (var i = 0, len = self._deferreds.length; i < len; i++) {\n                  handle(self, self._deferreds[i]);\n                }\n\n                self._deferreds = null;\n              }\n\n              function Handler(onFulfilled, onRejected, promise) {\n                this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n                this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n                this.promise = promise;\n              }\n\n              function doResolve(fn, self) {\n                var done = false;\n\n                try {\n                  fn(function (value) {\n                    if (done) return;\n                    done = true;\n                    resolve(self, value);\n                  }, function (reason) {\n                    if (done) return;\n                    done = true;\n                    reject(self, reason);\n                  });\n                } catch (ex) {\n                  if (done) return;\n                  done = true;\n                  reject(self, ex);\n                }\n              }\n\n              Promise.prototype['catch'] = function (onRejected) {\n                return this.then(null, onRejected);\n              };\n\n              Promise.prototype.then = function (onFulfilled, onRejected) {\n                var prom = new this.constructor(noop);\n                handle(this, new Handler(onFulfilled, onRejected, prom));\n                return prom;\n              };\n\n              Promise.all = function (arr) {\n                var args = Array.prototype.slice.call(arr);\n                return new Promise(function (resolve, reject) {\n                  if (args.length === 0) return resolve([]);\n                  var remaining = args.length;\n\n                  function res(i, val) {\n                    try {\n                      if (val && (typeof val === 'object' || typeof val === 'function')) {\n                        var then = val.then;\n\n                        if (typeof then === 'function') {\n                          then.call(val, function (val) {\n                            res(i, val);\n                          }, reject);\n                          return;\n                        }\n                      }\n\n                      args[i] = val;\n\n                      if (--remaining === 0) {\n                        resolve(args);\n                      }\n                    } catch (ex) {\n                      reject(ex);\n                    }\n                  }\n\n                  for (var i = 0; i < args.length; i++) {\n                    res(i, args[i]);\n                  }\n                });\n              };\n\n              Promise.resolve = function (value) {\n                if (value && typeof value === 'object' && value.constructor === Promise) {\n                  return value;\n                }\n\n                return new Promise(function (resolve) {\n                  resolve(value);\n                });\n              };\n\n              Promise.reject = function (value) {\n                return new Promise(function (resolve, reject) {\n                  reject(value);\n                });\n              };\n\n              Promise.race = function (values) {\n                return new Promise(function (resolve, reject) {\n                  for (var i = 0, len = values.length; i < len; i++) {\n                    values[i].then(resolve, reject);\n                  }\n                });\n              };\n\n              Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n                setImmediate(fn);\n              } : function (fn) {\n                setTimeoutFunc(fn, 0);\n              };\n\n              Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n                if (typeof console !== 'undefined' && console) {\n                  console.warn('Possible Unhandled Promise Rejection:', err);\n                }\n              };\n\n              Promise._setImmediateFn = function _setImmediateFn(fn) {\n                Promise._immediateFn = fn;\n              };\n\n              Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n                Promise._unhandledRejectionFn = fn;\n              };\n\n              if (typeof module !== 'undefined' && module.exports) {\n                module.exports = Promise;\n              } else if (!root.Promise) {\n                root.Promise = Promise;\n              }\n            })(this);\n          }).call(this, require('timers').setImmediate);\n        }, {\n          'timers': 3\n        }],\n        3: [function (require, module, exports) {\n          (function (setImmediate, clearImmediate) {\n            var nextTick = require('process/browser.js').nextTick;\n\n            var apply = Function.prototype.apply;\n            var slice = Array.prototype.slice;\n            var immediateIds = {};\n            var nextImmediateId = 0;\n\n            exports.setTimeout = function () {\n              return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n            };\n\n            exports.setInterval = function () {\n              return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n            };\n\n            exports.clearTimeout = exports.clearInterval = function (timeout) {\n              timeout.close();\n            };\n\n            function Timeout(id, clearFn) {\n              this._id = id;\n              this._clearFn = clearFn;\n            }\n\n            Timeout.prototype.unref = Timeout.prototype.ref = function () {};\n\n            Timeout.prototype.close = function () {\n              this._clearFn.call(window, this._id);\n            };\n\n            exports.enroll = function (item, msecs) {\n              clearTimeout(item._idleTimeoutId);\n              item._idleTimeout = msecs;\n            };\n\n            exports.unenroll = function (item) {\n              clearTimeout(item._idleTimeoutId);\n              item._idleTimeout = -1;\n            };\n\n            exports._unrefActive = exports.active = function (item) {\n              clearTimeout(item._idleTimeoutId);\n              var msecs = item._idleTimeout;\n\n              if (msecs >= 0) {\n                item._idleTimeoutId = setTimeout(function onTimeout() {\n                  if (item._onTimeout) item._onTimeout();\n                }, msecs);\n              }\n            };\n\n            exports.setImmediate = typeof setImmediate === 'function' ? setImmediate : function (fn) {\n              var id = nextImmediateId++;\n              var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n              immediateIds[id] = true;\n              nextTick(function onNextTick() {\n                if (immediateIds[id]) {\n                  if (args) {\n                    fn.apply(null, args);\n                  } else {\n                    fn.call(null);\n                  }\n\n                  exports.clearImmediate(id);\n                }\n              });\n              return id;\n            };\n            exports.clearImmediate = typeof clearImmediate === 'function' ? clearImmediate : function (id) {\n              delete immediateIds[id];\n            };\n          }).call(this, require('timers').setImmediate, require('timers').clearImmediate);\n        }, {\n          'process/browser.js': 1,\n          'timers': 3\n        }],\n        4: [function (require, module, exports) {\n          var promisePolyfill = require('promise-polyfill');\n\n          var Global = function () {\n            if (typeof window !== 'undefined') {\n              return window;\n            } else {\n              return Function('return this;')();\n            }\n          }();\n\n          module.exports = {\n            boltExport: Global.Promise || promisePolyfill\n          };\n        }, {\n          'promise-polyfill': 2\n        }]\n      }, {}, [4])(4);\n    });\n  })(undefined, exports$1, module$1, undefined);\n\n  var Promise = module$1.exports.boltExport;\n\n  var nu$3 = function (baseFn) {\n    var data = Optional.none();\n    var callbacks = [];\n\n    var map = function (f) {\n      return nu$3(function (nCallback) {\n        get(function (data) {\n          nCallback(f(data));\n        });\n      });\n    };\n\n    var get = function (nCallback) {\n      if (isReady()) {\n        call(nCallback);\n      } else {\n        callbacks.push(nCallback);\n      }\n    };\n\n    var set = function (x) {\n      if (!isReady()) {\n        data = Optional.some(x);\n        run(callbacks);\n        callbacks = [];\n      }\n    };\n\n    var isReady = function () {\n      return data.isSome();\n    };\n\n    var run = function (cbs) {\n      each(cbs, call);\n    };\n\n    var call = function (cb) {\n      data.each(function (x) {\n        setTimeout(function () {\n          cb(x);\n        }, 0);\n      });\n    };\n\n    baseFn(set);\n    return {\n      get: get,\n      map: map,\n      isReady: isReady\n    };\n  };\n\n  var pure = function (a) {\n    return nu$3(function (callback) {\n      callback(a);\n    });\n  };\n\n  var LazyValue = {\n    nu: nu$3,\n    pure: pure\n  };\n\n  var errorReporter = function (err) {\n    setTimeout(function () {\n      throw err;\n    }, 0);\n  };\n\n  var make = function (run) {\n    var get = function (callback) {\n      run().then(callback, errorReporter);\n    };\n\n    var map = function (fab) {\n      return make(function () {\n        return run().then(fab);\n      });\n    };\n\n    var bind = function (aFutureB) {\n      return make(function () {\n        return run().then(function (v) {\n          return aFutureB(v).toPromise();\n        });\n      });\n    };\n\n    var anonBind = function (futureB) {\n      return make(function () {\n        return run().then(function () {\n          return futureB.toPromise();\n        });\n      });\n    };\n\n    var toLazy = function () {\n      return LazyValue.nu(get);\n    };\n\n    var toCached = function () {\n      var cache = null;\n      return make(function () {\n        if (cache === null) {\n          cache = run();\n        }\n\n        return cache;\n      });\n    };\n\n    var toPromise = run;\n    return {\n      map: map,\n      bind: bind,\n      anonBind: anonBind,\n      toLazy: toLazy,\n      toCached: toCached,\n      toPromise: toPromise,\n      get: get\n    };\n  };\n\n  var nu$4 = function (baseFn) {\n    return make(function () {\n      return new Promise(baseFn);\n    });\n  };\n\n  var pure$1 = function (a) {\n    return make(function () {\n      return Promise.resolve(a);\n    });\n  };\n\n  var Future = {\n    nu: nu$4,\n    pure: pure$1\n  };\n\n  var par = function (asyncValues, nu) {\n    return nu(function (callback) {\n      var r = [];\n      var count = 0;\n\n      var cb = function (i) {\n        return function (value) {\n          r[i] = value;\n          count++;\n\n          if (count >= asyncValues.length) {\n            callback(r);\n          }\n        };\n      };\n\n      if (asyncValues.length === 0) {\n        callback([]);\n      } else {\n        each(asyncValues, function (asyncValue, i) {\n          asyncValue.get(cb(i));\n        });\n      }\n    });\n  };\n\n  var par$1 = function (futures) {\n    return par(futures, Future.nu);\n  };\n\n  var value = function (o) {\n    var is = function (v) {\n      return o === v;\n    };\n\n    var or = function (_opt) {\n      return value(o);\n    };\n\n    var orThunk = function (_f) {\n      return value(o);\n    };\n\n    var map = function (f) {\n      return value(f(o));\n    };\n\n    var mapError = function (_f) {\n      return value(o);\n    };\n\n    var each = function (f) {\n      f(o);\n    };\n\n    var bind = function (f) {\n      return f(o);\n    };\n\n    var fold = function (_, onValue) {\n      return onValue(o);\n    };\n\n    var exists = function (f) {\n      return f(o);\n    };\n\n    var forall = function (f) {\n      return f(o);\n    };\n\n    var toOptional = function () {\n      return Optional.some(o);\n    };\n\n    return {\n      is: is,\n      isValue: always,\n      isError: never,\n      getOr: constant(o),\n      getOrThunk: constant(o),\n      getOrDie: constant(o),\n      or: or,\n      orThunk: orThunk,\n      fold: fold,\n      map: map,\n      mapError: mapError,\n      each: each,\n      bind: bind,\n      exists: exists,\n      forall: forall,\n      toOptional: toOptional\n    };\n  };\n\n  var error = function (message) {\n    var getOrThunk = function (f) {\n      return f();\n    };\n\n    var getOrDie = function () {\n      return die(String(message))();\n    };\n\n    var or = function (opt) {\n      return opt;\n    };\n\n    var orThunk = function (f) {\n      return f();\n    };\n\n    var map = function (_f) {\n      return error(message);\n    };\n\n    var mapError = function (f) {\n      return error(f(message));\n    };\n\n    var bind = function (_f) {\n      return error(message);\n    };\n\n    var fold = function (onError, _) {\n      return onError(message);\n    };\n\n    return {\n      is: never,\n      isValue: never,\n      isError: always,\n      getOr: identity,\n      getOrThunk: getOrThunk,\n      getOrDie: getOrDie,\n      or: or,\n      orThunk: orThunk,\n      fold: fold,\n      map: map,\n      mapError: mapError,\n      each: noop,\n      bind: bind,\n      exists: never,\n      forall: always,\n      toOptional: Optional.none\n    };\n  };\n\n  var fromOption = function (opt, err) {\n    return opt.fold(function () {\n      return error(err);\n    }, value);\n  };\n\n  var Result = {\n    value: value,\n    error: error,\n    fromOption: fromOption\n  };\n\n  var generate = function (cases) {\n    if (!isArray(cases)) {\n      throw new Error('cases must be an array');\n    }\n\n    if (cases.length === 0) {\n      throw new Error('there must be at least one case');\n    }\n\n    var constructors = [];\n    var adt = {};\n    each(cases, function (acase, count) {\n      var keys$1 = keys(acase);\n\n      if (keys$1.length !== 1) {\n        throw new Error('one and only one name per case');\n      }\n\n      var key = keys$1[0];\n      var value = acase[key];\n\n      if (adt[key] !== undefined) {\n        throw new Error('duplicate key detected:' + key);\n      } else if (key === 'cata') {\n        throw new Error('cannot have a case named cata (sorry)');\n      } else if (!isArray(value)) {\n        throw new Error('case arguments must be an array');\n      }\n\n      constructors.push(key);\n\n      adt[key] = function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        var argLength = args.length;\n\n        if (argLength !== value.length) {\n          throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n        }\n\n        var match = function (branches) {\n          var branchKeys = keys(branches);\n\n          if (constructors.length !== branchKeys.length) {\n            throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n          }\n\n          var allReqd = forall(constructors, function (reqKey) {\n            return contains(branchKeys, reqKey);\n          });\n\n          if (!allReqd) {\n            throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n          }\n\n          return branches[key].apply(null, args);\n        };\n\n        return {\n          fold: function () {\n            var foldArgs = [];\n\n            for (var _i = 0; _i < arguments.length; _i++) {\n              foldArgs[_i] = arguments[_i];\n            }\n\n            if (foldArgs.length !== cases.length) {\n              throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + foldArgs.length);\n            }\n\n            var target = foldArgs[count];\n            return target.apply(null, args);\n          },\n          match: match,\n          log: function (label) {\n            console.log(label, {\n              constructors: constructors,\n              constructor: key,\n              params: args\n            });\n          }\n        };\n      };\n    });\n    return adt;\n  };\n\n  var Adt = {\n    generate: generate\n  };\n  var comparison = Adt.generate([{\n    bothErrors: ['error1', 'error2']\n  }, {\n    firstError: ['error1', 'value2']\n  }, {\n    secondError: ['value1', 'error2']\n  }, {\n    bothValues: ['value1', 'value2']\n  }]);\n\n  var unite = function (result) {\n    return result.fold(identity, identity);\n  };\n\n  function ClosestOrAncestor(is, ancestor, scope, a, isRoot) {\n    if (is(scope, a)) {\n      return Optional.some(scope);\n    } else if (isFunction(isRoot) && isRoot(scope)) {\n      return Optional.none();\n    } else {\n      return ancestor(scope, a, isRoot);\n    }\n  }\n\n  var ancestor = function (scope, predicate, isRoot) {\n    var element = scope.dom;\n    var stop = isFunction(isRoot) ? isRoot : never;\n\n    while (element.parentNode) {\n      element = element.parentNode;\n      var el = SugarElement.fromDom(element);\n\n      if (predicate(el)) {\n        return Optional.some(el);\n      } else if (stop(el)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var closest = function (scope, predicate, isRoot) {\n    var is = function (s, test) {\n      return test(s);\n    };\n\n    return ClosestOrAncestor(is, ancestor, scope, predicate, isRoot);\n  };\n\n  var sibling = function (scope, predicate) {\n    var element = scope.dom;\n\n    if (!element.parentNode) {\n      return Optional.none();\n    }\n\n    return child$1(SugarElement.fromDom(element.parentNode), function (x) {\n      return !eq$2(scope, x) && predicate(x);\n    });\n  };\n\n  var child$1 = function (scope, predicate) {\n    var pred = function (node) {\n      return predicate(SugarElement.fromDom(node));\n    };\n\n    var result = find(scope.dom.childNodes, pred);\n    return result.map(SugarElement.fromDom);\n  };\n\n  var ancestor$1 = function (scope, selector, isRoot) {\n    return ancestor(scope, function (e) {\n      return is$1(e, selector);\n    }, isRoot);\n  };\n\n  var descendant = function (scope, selector) {\n    return one(selector, scope);\n  };\n\n  var closest$1 = function (scope, selector, isRoot) {\n    var is = function (element, selector) {\n      return is$1(element, selector);\n    };\n\n    return ClosestOrAncestor(is, ancestor$1, scope, selector, isRoot);\n  };\n\n  var promise = function () {\n    var bind = function (fn, thisArg) {\n      return function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        fn.apply(thisArg, args);\n      };\n    };\n\n    var isArray = Array.isArray || function (value) {\n      return Object.prototype.toString.call(value) === '[object Array]';\n    };\n\n    var Promise = function (fn) {\n      if (typeof this !== 'object') {\n        throw new TypeError('Promises must be constructed via new');\n      }\n\n      if (typeof fn !== 'function') {\n        throw new TypeError('not a function');\n      }\n\n      this._state = null;\n      this._value = null;\n      this._deferreds = [];\n      doResolve(fn, bind(resolve, this), bind(reject, this));\n    };\n\n    var asap = Promise.immediateFn || typeof setImmediate === 'function' && setImmediate || function (fn) {\n      return setTimeout(fn, 1);\n    };\n\n    function handle(deferred) {\n      var me = this;\n\n      if (this._state === null) {\n        this._deferreds.push(deferred);\n\n        return;\n      }\n\n      asap(function () {\n        var cb = me._state ? deferred.onFulfilled : deferred.onRejected;\n\n        if (cb === null) {\n          (me._state ? deferred.resolve : deferred.reject)(me._value);\n          return;\n        }\n\n        var ret;\n\n        try {\n          ret = cb(me._value);\n        } catch (e) {\n          deferred.reject(e);\n          return;\n        }\n\n        deferred.resolve(ret);\n      });\n    }\n\n    function resolve(newValue) {\n      try {\n        if (newValue === this) {\n          throw new TypeError('A promise cannot be resolved with itself.');\n        }\n\n        if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n          var then = newValue.then;\n\n          if (typeof then === 'function') {\n            doResolve(bind(then, newValue), bind(resolve, this), bind(reject, this));\n            return;\n          }\n        }\n\n        this._state = true;\n        this._value = newValue;\n        finale.call(this);\n      } catch (e) {\n        reject.call(this, e);\n      }\n    }\n\n    function reject(newValue) {\n      this._state = false;\n      this._value = newValue;\n      finale.call(this);\n    }\n\n    function finale() {\n      for (var i = 0, len = this._deferreds.length; i < len; i++) {\n        handle.call(this, this._deferreds[i]);\n      }\n\n      this._deferreds = null;\n    }\n\n    function Handler(onFulfilled, onRejected, resolve, reject) {\n      this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n      this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n      this.resolve = resolve;\n      this.reject = reject;\n    }\n\n    var doResolve = function (fn, onFulfilled, onRejected) {\n      var done = false;\n\n      try {\n        fn(function (value) {\n          if (done) {\n            return;\n          }\n\n          done = true;\n          onFulfilled(value);\n        }, function (reason) {\n          if (done) {\n            return;\n          }\n\n          done = true;\n          onRejected(reason);\n        });\n      } catch (ex) {\n        if (done) {\n          return;\n        }\n\n        done = true;\n        onRejected(ex);\n      }\n    };\n\n    Promise.prototype.catch = function (onRejected) {\n      return this.then(null, onRejected);\n    };\n\n    Promise.prototype.then = function (onFulfilled, onRejected) {\n      var me = this;\n      return new Promise(function (resolve, reject) {\n        handle.call(me, new Handler(onFulfilled, onRejected, resolve, reject));\n      });\n    };\n\n    Promise.all = function () {\n      var values = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        values[_i] = arguments[_i];\n      }\n\n      var args = Array.prototype.slice.call(values.length === 1 && isArray(values[0]) ? values[0] : values);\n      return new Promise(function (resolve, reject) {\n        if (args.length === 0) {\n          return resolve([]);\n        }\n\n        var remaining = args.length;\n\n        var res = function (i, val) {\n          try {\n            if (val && (typeof val === 'object' || typeof val === 'function')) {\n              var then = val.then;\n\n              if (typeof then === 'function') {\n                then.call(val, function (val) {\n                  res(i, val);\n                }, reject);\n                return;\n              }\n            }\n\n            args[i] = val;\n\n            if (--remaining === 0) {\n              resolve(args);\n            }\n          } catch (ex) {\n            reject(ex);\n          }\n        };\n\n        for (var i = 0; i < args.length; i++) {\n          res(i, args[i]);\n        }\n      });\n    };\n\n    Promise.resolve = function (value) {\n      if (value && typeof value === 'object' && value.constructor === Promise) {\n        return value;\n      }\n\n      return new Promise(function (resolve) {\n        resolve(value);\n      });\n    };\n\n    Promise.reject = function (value) {\n      return new Promise(function (resolve, reject) {\n        reject(value);\n      });\n    };\n\n    Promise.race = function (values) {\n      return new Promise(function (resolve, reject) {\n        for (var i = 0, len = values.length; i < len; i++) {\n          values[i].then(resolve, reject);\n        }\n      });\n    };\n\n    return Promise;\n  };\n\n  var promiseObj = window.Promise ? window.Promise : promise();\n  var requestAnimationFramePromise;\n\n  var requestAnimationFrame = function (callback, element) {\n    var requestAnimationFrameFunc = window.requestAnimationFrame;\n    var vendors = ['ms', 'moz', 'webkit'];\n\n    var featurefill = function (cb) {\n      window.setTimeout(cb, 0);\n    };\n\n    for (var i = 0; i < vendors.length && !requestAnimationFrameFunc; i++) {\n      requestAnimationFrameFunc = window[vendors[i] + 'RequestAnimationFrame'];\n    }\n\n    if (!requestAnimationFrameFunc) {\n      requestAnimationFrameFunc = featurefill;\n    }\n\n    requestAnimationFrameFunc(callback, element);\n  };\n\n  var wrappedSetTimeout = function (callback, time) {\n    if (typeof time !== 'number') {\n      time = 0;\n    }\n\n    return setTimeout(callback, time);\n  };\n\n  var wrappedSetInterval = function (callback, time) {\n    if (typeof time !== 'number') {\n      time = 1;\n    }\n\n    return setInterval(callback, time);\n  };\n\n  var wrappedClearTimeout = function (id) {\n    return clearTimeout(id);\n  };\n\n  var wrappedClearInterval = function (id) {\n    return clearInterval(id);\n  };\n\n  var debounce = function (callback, time) {\n    var timer;\n\n    var func = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      clearTimeout(timer);\n      timer = wrappedSetTimeout(function () {\n        callback.apply(this, args);\n      }, time);\n    };\n\n    func.stop = function () {\n      clearTimeout(timer);\n    };\n\n    return func;\n  };\n\n  var Delay = {\n    requestAnimationFrame: function (callback, element) {\n      if (requestAnimationFramePromise) {\n        requestAnimationFramePromise.then(callback);\n        return;\n      }\n\n      requestAnimationFramePromise = new promiseObj(function (resolve) {\n        if (!element) {\n          element = document.body;\n        }\n\n        requestAnimationFrame(resolve, element);\n      }).then(callback);\n    },\n    setTimeout: wrappedSetTimeout,\n    setInterval: wrappedSetInterval,\n    setEditorTimeout: function (editor, callback, time) {\n      return wrappedSetTimeout(function () {\n        if (!editor.removed) {\n          callback();\n        }\n      }, time);\n    },\n    setEditorInterval: function (editor, callback, time) {\n      var timer = wrappedSetInterval(function () {\n        if (!editor.removed) {\n          callback();\n        } else {\n          clearInterval(timer);\n        }\n      }, time);\n      return timer;\n    },\n    debounce: debounce,\n    throttle: debounce,\n    clearInterval: wrappedClearInterval,\n    clearTimeout: wrappedClearTimeout\n  };\n\n  var StyleSheetLoader = function (documentOrShadowRoot, settings) {\n    if (settings === void 0) {\n      settings = {};\n    }\n\n    var idCount = 0;\n    var loadedStates = {};\n    var edos = SugarElement.fromDom(documentOrShadowRoot);\n    var doc = documentOrOwner(edos);\n    var maxLoadTime = settings.maxLoadTime || 5000;\n\n    var _setReferrerPolicy = function (referrerPolicy) {\n      settings.referrerPolicy = referrerPolicy;\n    };\n\n    var addStyle = function (element) {\n      append(getStyleContainer(edos), element);\n    };\n\n    var removeStyle = function (id) {\n      var styleContainer = getStyleContainer(edos);\n      descendant(styleContainer, '#' + id).each(remove);\n    };\n\n    var getOrCreateState = function (url) {\n      return get$1(loadedStates, url).getOrThunk(function () {\n        return {\n          id: 'mce-u' + idCount++,\n          passed: [],\n          failed: [],\n          count: 0\n        };\n      });\n    };\n\n    var load = function (url, success, failure) {\n      var link;\n\n      var urlWithSuffix = Tools._addCacheSuffix(url);\n\n      var state = getOrCreateState(urlWithSuffix);\n      loadedStates[urlWithSuffix] = state;\n      state.count++;\n\n      var resolve = function (callbacks, status) {\n        var i = callbacks.length;\n\n        while (i--) {\n          callbacks[i]();\n        }\n\n        state.status = status;\n        state.passed = [];\n        state.failed = [];\n\n        if (link) {\n          link.onload = null;\n          link.onerror = null;\n          link = null;\n        }\n      };\n\n      var passed = function () {\n        return resolve(state.passed, 2);\n      };\n\n      var failed = function () {\n        return resolve(state.failed, 3);\n      };\n\n      var wait = function (testCallback, waitCallback) {\n        if (!testCallback()) {\n          if (Date.now() - startTime < maxLoadTime) {\n            Delay.setTimeout(waitCallback);\n          } else {\n            failed();\n          }\n        }\n      };\n\n      var waitForWebKitLinkLoaded = function () {\n        wait(function () {\n          var styleSheets = documentOrShadowRoot.styleSheets;\n          var i = styleSheets.length;\n\n          while (i--) {\n            var styleSheet = styleSheets[i];\n            var owner = styleSheet.ownerNode;\n\n            if (owner && owner.id === link.id) {\n              passed();\n              return true;\n            }\n          }\n\n          return false;\n        }, waitForWebKitLinkLoaded);\n      };\n\n      if (success) {\n        state.passed.push(success);\n      }\n\n      if (failure) {\n        state.failed.push(failure);\n      }\n\n      if (state.status === 1) {\n        return;\n      }\n\n      if (state.status === 2) {\n        passed();\n        return;\n      }\n\n      if (state.status === 3) {\n        failed();\n        return;\n      }\n\n      state.status = 1;\n      var linkElem = SugarElement.fromTag('link', doc.dom);\n      setAll(linkElem, {\n        rel: 'stylesheet',\n        type: 'text/css',\n        id: state.id\n      });\n      var startTime = Date.now();\n\n      if (settings.contentCssCors) {\n        set(linkElem, 'crossOrigin', 'anonymous');\n      }\n\n      if (settings.referrerPolicy) {\n        set(linkElem, 'referrerpolicy', settings.referrerPolicy);\n      }\n\n      link = linkElem.dom;\n      link.onload = waitForWebKitLinkLoaded;\n      link.onerror = failed;\n      addStyle(linkElem);\n      set(linkElem, 'href', urlWithSuffix);\n    };\n\n    var loadF = function (url) {\n      return Future.nu(function (resolve) {\n        load(url, compose(resolve, constant(Result.value(url))), compose(resolve, constant(Result.error(url))));\n      });\n    };\n\n    var loadAll = function (urls, success, failure) {\n      par$1(map(urls, loadF)).get(function (result) {\n        var parts = partition(result, function (r) {\n          return r.isValue();\n        });\n\n        if (parts.fail.length > 0) {\n          failure(parts.fail.map(unite));\n        } else {\n          success(parts.pass.map(unite));\n        }\n      });\n    };\n\n    var unload = function (url) {\n      var urlWithSuffix = Tools._addCacheSuffix(url);\n\n      get$1(loadedStates, urlWithSuffix).each(function (state) {\n        var count = --state.count;\n\n        if (count === 0) {\n          delete loadedStates[urlWithSuffix];\n          removeStyle(state.id);\n        }\n      });\n    };\n\n    var unloadAll = function (urls) {\n      each(urls, function (url) {\n        unload(url);\n      });\n    };\n\n    return {\n      load: load,\n      loadAll: loadAll,\n      unload: unload,\n      unloadAll: unloadAll,\n      _setReferrerPolicy: _setReferrerPolicy\n    };\n  };\n\n  var create$1 = function () {\n    var map = new WeakMap();\n\n    var forElement = function (referenceElement, settings) {\n      var root = getRootNode(referenceElement);\n      var rootDom = root.dom;\n      return Optional.from(map.get(rootDom)).getOrThunk(function () {\n        var sl = StyleSheetLoader(rootDom, settings);\n        map.set(rootDom, sl);\n        return sl;\n      });\n    };\n\n    return {\n      forElement: forElement\n    };\n  };\n\n  var instance = create$1();\n\n  var DomTreeWalker = function () {\n    function DomTreeWalker(startNode, rootNode) {\n      this.node = startNode;\n      this.rootNode = rootNode;\n      this.current = this.current.bind(this);\n      this.next = this.next.bind(this);\n      this.prev = this.prev.bind(this);\n      this.prev2 = this.prev2.bind(this);\n    }\n\n    DomTreeWalker.prototype.current = function () {\n      return this.node;\n    };\n\n    DomTreeWalker.prototype.next = function (shallow) {\n      this.node = this.findSibling(this.node, 'firstChild', 'nextSibling', shallow);\n      return this.node;\n    };\n\n    DomTreeWalker.prototype.prev = function (shallow) {\n      this.node = this.findSibling(this.node, 'lastChild', 'previousSibling', shallow);\n      return this.node;\n    };\n\n    DomTreeWalker.prototype.prev2 = function (shallow) {\n      this.node = this.findPreviousNode(this.node, 'lastChild', 'previousSibling', shallow);\n      return this.node;\n    };\n\n    DomTreeWalker.prototype.findSibling = function (node, startName, siblingName, shallow) {\n      var sibling, parent;\n\n      if (node) {\n        if (!shallow && node[startName]) {\n          return node[startName];\n        }\n\n        if (node !== this.rootNode) {\n          sibling = node[siblingName];\n\n          if (sibling) {\n            return sibling;\n          }\n\n          for (parent = node.parentNode; parent && parent !== this.rootNode; parent = parent.parentNode) {\n            sibling = parent[siblingName];\n\n            if (sibling) {\n              return sibling;\n            }\n          }\n        }\n      }\n    };\n\n    DomTreeWalker.prototype.findPreviousNode = function (node, startName, siblingName, shallow) {\n      var sibling, parent, child;\n\n      if (node) {\n        sibling = node[siblingName];\n\n        if (this.rootNode && sibling === this.rootNode) {\n          return;\n        }\n\n        if (sibling) {\n          if (!shallow) {\n            for (child = sibling[startName]; child; child = child[startName]) {\n              if (!child[startName]) {\n                return child;\n              }\n            }\n          }\n\n          return sibling;\n        }\n\n        parent = node.parentNode;\n\n        if (parent && parent !== this.rootNode) {\n          return parent;\n        }\n      }\n    };\n\n    return DomTreeWalker;\n  }();\n\n  var blocks = ['article', 'aside', 'details', 'div', 'dt', 'figcaption', 'footer', 'form', 'fieldset', 'header', 'hgroup', 'html', 'main', 'nav', 'section', 'summary', 'body', 'p', 'dl', 'multicol', 'dd', 'figure', 'address', 'center', 'blockquote', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'listing', 'xmp', 'pre', 'plaintext', 'menu', 'dir', 'ul', 'ol', 'li', 'hr', 'table', 'tbody', 'thead', 'tfoot', 'th', 'tr', 'td', 'caption'];\n  var tableCells = ['td', 'th'];\n  var tableSections = ['thead', 'tbody', 'tfoot'];\n  var textBlocks = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'p', 'div', 'address', 'pre', 'form', 'blockquote', 'center', 'dir', 'fieldset', 'header', 'footer', 'article', 'section', 'hgroup', 'aside', 'nav', 'figure'];\n  var headings = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\n  var listItems = ['li', 'dd', 'dt'];\n  var lists = ['ul', 'ol', 'dl'];\n  var wsElements = ['pre', 'script', 'textarea', 'style'];\n\n  var lazyLookup = function (items) {\n    var lookup;\n    return function (node) {\n      lookup = lookup ? lookup : mapToObject(items, always);\n      return lookup.hasOwnProperty(name(node));\n    };\n  };\n\n  var isHeading = lazyLookup(headings);\n  var isBlock = lazyLookup(blocks);\n\n  var isTable$1 = function (node) {\n    return name(node) === 'table';\n  };\n\n  var isInline = function (node) {\n    return isElement(node) && !isBlock(node);\n  };\n\n  var isBr$1 = function (node) {\n    return isElement(node) && name(node) === 'br';\n  };\n\n  var isTextBlock = lazyLookup(textBlocks);\n  var isList = lazyLookup(lists);\n  var isListItem = lazyLookup(listItems);\n  var isTableSection = lazyLookup(tableSections);\n  var isTableCell$1 = lazyLookup(tableCells);\n  var isWsPreserveElement = lazyLookup(wsElements);\n\n  var ancestor$2 = function (scope, selector, isRoot) {\n    return ancestor$1(scope, selector, isRoot).isSome();\n  };\n\n  var zeroWidth = '\\uFEFF';\n  var nbsp = '\\xA0';\n\n  var isZwsp = function (char) {\n    return char === zeroWidth;\n  };\n\n  var removeZwsp = function (s) {\n    return s.replace(/\\uFEFF/g, '');\n  };\n\n  var ZWSP = zeroWidth;\n  var isZwsp$1 = isZwsp;\n  var trim$2 = removeZwsp;\n  var isElement$2 = isElement$1;\n  var isText$2 = isText$1;\n\n  var isCaretContainerBlock = function (node) {\n    if (isText$2(node)) {\n      node = node.parentNode;\n    }\n\n    return isElement$2(node) && node.hasAttribute('data-mce-caret');\n  };\n\n  var isCaretContainerInline = function (node) {\n    return isText$2(node) && isZwsp$1(node.data);\n  };\n\n  var isCaretContainer = function (node) {\n    return isCaretContainerBlock(node) || isCaretContainerInline(node);\n  };\n\n  var hasContent = function (node) {\n    return node.firstChild !== node.lastChild || !isBr(node.firstChild);\n  };\n\n  var insertInline = function (node, before) {\n    var sibling;\n    var doc = node.ownerDocument;\n    var textNode = doc.createTextNode(ZWSP);\n    var parentNode = node.parentNode;\n\n    if (!before) {\n      sibling = node.nextSibling;\n\n      if (isText$2(sibling)) {\n        if (isCaretContainer(sibling)) {\n          return sibling;\n        }\n\n        if (startsWithCaretContainer(sibling)) {\n          sibling.splitText(1);\n          return sibling;\n        }\n      }\n\n      if (node.nextSibling) {\n        parentNode.insertBefore(textNode, node.nextSibling);\n      } else {\n        parentNode.appendChild(textNode);\n      }\n    } else {\n      sibling = node.previousSibling;\n\n      if (isText$2(sibling)) {\n        if (isCaretContainer(sibling)) {\n          return sibling;\n        }\n\n        if (endsWithCaretContainer(sibling)) {\n          return sibling.splitText(sibling.data.length - 1);\n        }\n      }\n\n      parentNode.insertBefore(textNode, node);\n    }\n\n    return textNode;\n  };\n\n  var isBeforeInline = function (pos) {\n    var container = pos.container();\n\n    if (!isText$1(container)) {\n      return false;\n    }\n\n    return container.data.charAt(pos.offset()) === ZWSP || pos.isAtStart() && isCaretContainerInline(container.previousSibling);\n  };\n\n  var isAfterInline = function (pos) {\n    var container = pos.container();\n\n    if (!isText$1(container)) {\n      return false;\n    }\n\n    return container.data.charAt(pos.offset() - 1) === ZWSP || pos.isAtEnd() && isCaretContainerInline(container.nextSibling);\n  };\n\n  var createBogusBr = function () {\n    var br = document.createElement('br');\n    br.setAttribute('data-mce-bogus', '1');\n    return br;\n  };\n\n  var insertBlock = function (blockName, node, before) {\n    var doc = node.ownerDocument;\n    var blockNode = doc.createElement(blockName);\n    blockNode.setAttribute('data-mce-caret', before ? 'before' : 'after');\n    blockNode.setAttribute('data-mce-bogus', 'all');\n    blockNode.appendChild(createBogusBr());\n    var parentNode = node.parentNode;\n\n    if (!before) {\n      if (node.nextSibling) {\n        parentNode.insertBefore(blockNode, node.nextSibling);\n      } else {\n        parentNode.appendChild(blockNode);\n      }\n    } else {\n      parentNode.insertBefore(blockNode, node);\n    }\n\n    return blockNode;\n  };\n\n  var startsWithCaretContainer = function (node) {\n    return isText$2(node) && node.data[0] === ZWSP;\n  };\n\n  var endsWithCaretContainer = function (node) {\n    return isText$2(node) && node.data[node.data.length - 1] === ZWSP;\n  };\n\n  var trimBogusBr = function (elm) {\n    var brs = elm.getElementsByTagName('br');\n    var lastBr = brs[brs.length - 1];\n\n    if (isBogus(lastBr)) {\n      lastBr.parentNode.removeChild(lastBr);\n    }\n  };\n\n  var showCaretContainerBlock = function (caretContainer) {\n    if (caretContainer && caretContainer.hasAttribute('data-mce-caret')) {\n      trimBogusBr(caretContainer);\n      caretContainer.removeAttribute('data-mce-caret');\n      caretContainer.removeAttribute('data-mce-bogus');\n      caretContainer.removeAttribute('style');\n      caretContainer.removeAttribute('_moz_abspos');\n      return caretContainer;\n    }\n\n    return null;\n  };\n\n  var isRangeInCaretContainerBlock = function (range) {\n    return isCaretContainerBlock(range.startContainer);\n  };\n\n  var isContentEditableTrue$1 = isContentEditableTrue;\n  var isContentEditableFalse$1 = isContentEditableFalse;\n  var isBr$2 = isBr;\n  var isText$3 = isText$1;\n  var isInvalidTextElement = matchNodeNames(['script', 'style', 'textarea']);\n  var isAtomicInline = matchNodeNames(['img', 'input', 'textarea', 'hr', 'iframe', 'video', 'audio', 'object', 'embed']);\n  var isTable$2 = matchNodeNames(['table']);\n  var isCaretContainer$1 = isCaretContainer;\n\n  var isCaretCandidate = function (node) {\n    if (isCaretContainer$1(node)) {\n      return false;\n    }\n\n    if (isText$3(node)) {\n      return !isInvalidTextElement(node.parentNode);\n    }\n\n    return isAtomicInline(node) || isBr$2(node) || isTable$2(node) || isNonUiContentEditableFalse(node);\n  };\n\n  var isUnselectable = function (node) {\n    return isElement$1(node) && node.getAttribute('unselectable') === 'true';\n  };\n\n  var isNonUiContentEditableFalse = function (node) {\n    return isUnselectable(node) === false && isContentEditableFalse$1(node);\n  };\n\n  var isInEditable = function (node, root) {\n    for (node = node.parentNode; node && node !== root; node = node.parentNode) {\n      if (isNonUiContentEditableFalse(node)) {\n        return false;\n      }\n\n      if (isContentEditableTrue$1(node)) {\n        return true;\n      }\n    }\n\n    return true;\n  };\n\n  var isAtomicContentEditableFalse = function (node) {\n    if (!isNonUiContentEditableFalse(node)) {\n      return false;\n    }\n\n    return foldl(from$1(node.getElementsByTagName('*')), function (result, elm) {\n      return result || isContentEditableTrue$1(elm);\n    }, false) !== true;\n  };\n\n  var isAtomic = function (node) {\n    return isAtomicInline(node) || isAtomicContentEditableFalse(node);\n  };\n\n  var isEditableCaretCandidate = function (node, root) {\n    return isCaretCandidate(node) && isInEditable(node, root);\n  };\n\n  var whiteSpaceRegExp$1 = /^[ \\t\\r\\n]*$/;\n\n  var isWhitespaceText = function (text) {\n    return whiteSpaceRegExp$1.test(text);\n  };\n\n  var hasWhitespacePreserveParent = function (node, rootNode) {\n    var rootElement = SugarElement.fromDom(rootNode);\n    var startNode = SugarElement.fromDom(node);\n    return ancestor$2(startNode, 'pre,code', curry(eq$2, rootElement));\n  };\n\n  var isWhitespace = function (node, rootNode) {\n    return isText$1(node) && isWhitespaceText(node.data) && hasWhitespacePreserveParent(node, rootNode) === false;\n  };\n\n  var isNamedAnchor = function (node) {\n    return isElement$1(node) && node.nodeName === 'A' && !node.hasAttribute('href') && (node.hasAttribute('name') || node.hasAttribute('id'));\n  };\n\n  var isContent = function (node, rootNode) {\n    return isCaretCandidate(node) && isWhitespace(node, rootNode) === false || isNamedAnchor(node) || isBookmark(node);\n  };\n\n  var isBookmark = hasAttribute('data-mce-bookmark');\n  var isBogus$1 = hasAttribute('data-mce-bogus');\n  var isBogusAll$1 = hasAttributeValue('data-mce-bogus', 'all');\n\n  var isEmptyNode = function (targetNode, skipBogus) {\n    var node,\n        brCount = 0;\n\n    if (isContent(targetNode, targetNode)) {\n      return false;\n    } else {\n      node = targetNode.firstChild;\n\n      if (!node) {\n        return true;\n      }\n\n      var walker = new DomTreeWalker(node, targetNode);\n\n      do {\n        if (skipBogus) {\n          if (isBogusAll$1(node)) {\n            node = walker.next(true);\n            continue;\n          }\n\n          if (isBogus$1(node)) {\n            node = walker.next();\n            continue;\n          }\n        }\n\n        if (isBr(node)) {\n          brCount++;\n          node = walker.next();\n          continue;\n        }\n\n        if (isContent(node, targetNode)) {\n          return false;\n        }\n\n        node = walker.next();\n      } while (node);\n\n      return brCount <= 1;\n    }\n  };\n\n  var isEmpty = function (elm, skipBogus) {\n    if (skipBogus === void 0) {\n      skipBogus = true;\n    }\n\n    return isEmptyNode(elm.dom, skipBogus);\n  };\n\n  var isSpan = function (node) {\n    return node.nodeName.toLowerCase() === 'span';\n  };\n\n  var isInlineContent = function (node, root) {\n    return isNonNullable(node) && (isContent(node, root) || isInline(SugarElement.fromDom(node)));\n  };\n\n  var surroundedByInlineContent = function (node, root) {\n    var prev = new DomTreeWalker(node, root).prev(false);\n    var next = new DomTreeWalker(node, root).next(false);\n    var prevIsInline = isUndefined(prev) || isInlineContent(prev, root);\n    var nextIsInline = isUndefined(next) || isInlineContent(next, root);\n    return prevIsInline && nextIsInline;\n  };\n\n  var isBookmarkNode = function (node) {\n    return isSpan(node) && node.getAttribute('data-mce-type') === 'bookmark';\n  };\n\n  var isKeepTextNode = function (node, root) {\n    return isText$1(node) && node.data.length > 0 && surroundedByInlineContent(node, root);\n  };\n\n  var isKeepElement = function (node) {\n    return isElement$1(node) ? node.childNodes.length > 0 : false;\n  };\n\n  var isDocument$2 = function (node) {\n    return isDocumentFragment$1(node) || isDocument$1(node);\n  };\n\n  var trimNode = function (dom, node, root) {\n    var rootNode = root || node;\n\n    if (isElement$1(node) && isBookmarkNode(node)) {\n      return node;\n    }\n\n    var children = node.childNodes;\n\n    for (var i = children.length - 1; i >= 0; i--) {\n      trimNode(dom, children[i], rootNode);\n    }\n\n    if (isElement$1(node)) {\n      var currentChildren = node.childNodes;\n\n      if (currentChildren.length === 1 && isBookmarkNode(currentChildren[0])) {\n        node.parentNode.insertBefore(currentChildren[0], node);\n      }\n    }\n\n    if (!isDocument$2(node) && !isContent(node, rootNode) && !isKeepElement(node) && !isKeepTextNode(node, rootNode)) {\n      dom.remove(node);\n    }\n\n    return node;\n  };\n\n  var makeMap$1 = Tools.makeMap;\n  var attrsCharsRegExp = /[&<>\\\"\\u0060\\u007E-\\uD7FF\\uE000-\\uFFEF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g;\n  var textCharsRegExp = /[<>&\\u007E-\\uD7FF\\uE000-\\uFFEF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g;\n  var rawCharsRegExp = /[<>&\\\"\\']/g;\n  var entityRegExp = /&#([a-z0-9]+);?|&([a-z0-9]+);/gi;\n  var asciiMap = {\n    128: '\\u20AC',\n    130: '\\u201A',\n    131: '\\u0192',\n    132: '\\u201E',\n    133: '\\u2026',\n    134: '\\u2020',\n    135: '\\u2021',\n    136: '\\u02c6',\n    137: '\\u2030',\n    138: '\\u0160',\n    139: '\\u2039',\n    140: '\\u0152',\n    142: '\\u017d',\n    145: '\\u2018',\n    146: '\\u2019',\n    147: '\\u201C',\n    148: '\\u201D',\n    149: '\\u2022',\n    150: '\\u2013',\n    151: '\\u2014',\n    152: '\\u02DC',\n    153: '\\u2122',\n    154: '\\u0161',\n    155: '\\u203A',\n    156: '\\u0153',\n    158: '\\u017e',\n    159: '\\u0178'\n  };\n  var baseEntities = {\n    '\"': '&quot;',\n    '\\'': '&#39;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '&': '&amp;',\n    '`': '&#96;'\n  };\n  var reverseEntities = {\n    '&lt;': '<',\n    '&gt;': '>',\n    '&amp;': '&',\n    '&quot;': '\"',\n    '&apos;': '\\''\n  };\n\n  var nativeDecode = function (text) {\n    var elm = SugarElement.fromTag('div').dom;\n    elm.innerHTML = text;\n    return elm.textContent || elm.innerText || text;\n  };\n\n  var buildEntitiesLookup = function (items, radix) {\n    var i, chr, entity;\n    var lookup = {};\n\n    if (items) {\n      items = items.split(',');\n      radix = radix || 10;\n\n      for (i = 0; i < items.length; i += 2) {\n        chr = String.fromCharCode(parseInt(items[i], radix));\n\n        if (!baseEntities[chr]) {\n          entity = '&' + items[i + 1] + ';';\n          lookup[chr] = entity;\n          lookup[entity] = chr;\n        }\n      }\n\n      return lookup;\n    }\n  };\n\n  var namedEntities = buildEntitiesLookup('50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,' + '5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,' + '5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,' + '5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,' + '68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,' + '6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,' + '6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,' + '75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,' + '7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,' + '7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,' + 'sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,' + 'st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,' + 't9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,' + 'tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,' + 'u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,' + '81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,' + '8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,' + '8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,' + '8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,' + '8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,' + 'nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,' + 'rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,' + 'Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,' + '80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,' + '811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro', 32);\n\n  var encodeRaw = function (text, attr) {\n    return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n      return baseEntities[chr] || chr;\n    });\n  };\n\n  var encodeAllRaw = function (text) {\n    return ('' + text).replace(rawCharsRegExp, function (chr) {\n      return baseEntities[chr] || chr;\n    });\n  };\n\n  var encodeNumeric = function (text, attr) {\n    return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n      if (chr.length > 1) {\n        return '&#' + ((chr.charCodeAt(0) - 55296) * 1024 + (chr.charCodeAt(1) - 56320) + 65536) + ';';\n      }\n\n      return baseEntities[chr] || '&#' + chr.charCodeAt(0) + ';';\n    });\n  };\n\n  var encodeNamed = function (text, attr, entities) {\n    entities = entities || namedEntities;\n    return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n      return baseEntities[chr] || entities[chr] || chr;\n    });\n  };\n\n  var getEncodeFunc = function (name, entities) {\n    var entitiesMap = buildEntitiesLookup(entities) || namedEntities;\n\n    var encodeNamedAndNumeric = function (text, attr) {\n      return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n        if (baseEntities[chr] !== undefined) {\n          return baseEntities[chr];\n        }\n\n        if (entitiesMap[chr] !== undefined) {\n          return entitiesMap[chr];\n        }\n\n        if (chr.length > 1) {\n          return '&#' + ((chr.charCodeAt(0) - 55296) * 1024 + (chr.charCodeAt(1) - 56320) + 65536) + ';';\n        }\n\n        return '&#' + chr.charCodeAt(0) + ';';\n      });\n    };\n\n    var encodeCustomNamed = function (text, attr) {\n      return encodeNamed(text, attr, entitiesMap);\n    };\n\n    var nameMap = makeMap$1(name.replace(/\\+/g, ','));\n\n    if (nameMap.named && nameMap.numeric) {\n      return encodeNamedAndNumeric;\n    }\n\n    if (nameMap.named) {\n      if (entities) {\n        return encodeCustomNamed;\n      }\n\n      return encodeNamed;\n    }\n\n    if (nameMap.numeric) {\n      return encodeNumeric;\n    }\n\n    return encodeRaw;\n  };\n\n  var decode = function (text) {\n    return text.replace(entityRegExp, function (all, numeric) {\n      if (numeric) {\n        if (numeric.charAt(0).toLowerCase() === 'x') {\n          numeric = parseInt(numeric.substr(1), 16);\n        } else {\n          numeric = parseInt(numeric, 10);\n        }\n\n        if (numeric > 65535) {\n          numeric -= 65536;\n          return String.fromCharCode(55296 + (numeric >> 10), 56320 + (numeric & 1023));\n        }\n\n        return asciiMap[numeric] || String.fromCharCode(numeric);\n      }\n\n      return reverseEntities[all] || namedEntities[all] || nativeDecode(all);\n    });\n  };\n\n  var Entities = {\n    encodeRaw: encodeRaw,\n    encodeAllRaw: encodeAllRaw,\n    encodeNumeric: encodeNumeric,\n    encodeNamed: encodeNamed,\n    getEncodeFunc: getEncodeFunc,\n    decode: decode\n  };\n  var mapCache = {},\n      dummyObj = {};\n  var makeMap$2 = Tools.makeMap,\n      each$3 = Tools.each,\n      extend$1 = Tools.extend,\n      explode$1 = Tools.explode,\n      inArray = Tools.inArray;\n\n  var split = function (items, delim) {\n    items = Tools.trim(items);\n    return items ? items.split(delim || ' ') : [];\n  };\n\n  var compileSchema = function (type) {\n    var schema = {};\n    var globalAttributes, blockContent;\n    var phrasingContent, flowContent, html4BlockContent, html4PhrasingContent;\n\n    var add = function (name, attributes, children) {\n      var ni, attributesOrder, element;\n\n      var arrayToMap = function (array, obj) {\n        var map = {};\n        var i, l;\n\n        for (i = 0, l = array.length; i < l; i++) {\n          map[array[i]] = obj || {};\n        }\n\n        return map;\n      };\n\n      children = children || [];\n      attributes = attributes || '';\n\n      if (typeof children === 'string') {\n        children = split(children);\n      }\n\n      var names = split(name);\n      ni = names.length;\n\n      while (ni--) {\n        attributesOrder = split([globalAttributes, attributes].join(' '));\n        element = {\n          attributes: arrayToMap(attributesOrder),\n          attributesOrder: attributesOrder,\n          children: arrayToMap(children, dummyObj)\n        };\n        schema[names[ni]] = element;\n      }\n    };\n\n    var addAttrs = function (name, attributes) {\n      var ni, schemaItem, i, l;\n      var names = split(name);\n      ni = names.length;\n      var attrs = split(attributes);\n\n      while (ni--) {\n        schemaItem = schema[names[ni]];\n\n        for (i = 0, l = attrs.length; i < l; i++) {\n          schemaItem.attributes[attrs[i]] = {};\n          schemaItem.attributesOrder.push(attrs[i]);\n        }\n      }\n    };\n\n    if (mapCache[type]) {\n      return mapCache[type];\n    }\n\n    globalAttributes = 'id accesskey class dir lang style tabindex title role';\n    blockContent = 'address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul';\n    phrasingContent = 'a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd ' + 'label map noscript object q s samp script select small span strong sub sup ' + 'textarea u var #text #comment';\n\n    if (type !== 'html4') {\n      globalAttributes += ' contenteditable contextmenu draggable dropzone ' + 'hidden spellcheck translate';\n      blockContent += ' article aside details dialog figure main header footer hgroup section nav';\n      phrasingContent += ' audio canvas command datalist mark meter output picture ' + 'progress time wbr video ruby bdi keygen';\n    }\n\n    if (type !== 'html5-strict') {\n      globalAttributes += ' xml:lang';\n      html4PhrasingContent = 'acronym applet basefont big font strike tt';\n      phrasingContent = [phrasingContent, html4PhrasingContent].join(' ');\n      each$3(split(html4PhrasingContent), function (name) {\n        add(name, '', phrasingContent);\n      });\n      html4BlockContent = 'center dir isindex noframes';\n      blockContent = [blockContent, html4BlockContent].join(' ');\n      flowContent = [blockContent, phrasingContent].join(' ');\n      each$3(split(html4BlockContent), function (name) {\n        add(name, '', flowContent);\n      });\n    }\n\n    flowContent = flowContent || [blockContent, phrasingContent].join(' ');\n    add('html', 'manifest', 'head body');\n    add('head', '', 'base command link meta noscript script style title');\n    add('title hr noscript br');\n    add('base', 'href target');\n    add('link', 'href rel media hreflang type sizes hreflang');\n    add('meta', 'name http-equiv content charset');\n    add('style', 'media type scoped');\n    add('script', 'src async defer type charset');\n    add('body', 'onafterprint onbeforeprint onbeforeunload onblur onerror onfocus ' + 'onhashchange onload onmessage onoffline ononline onpagehide onpageshow ' + 'onpopstate onresize onscroll onstorage onunload', flowContent);\n    add('address dt dd div caption', '', flowContent);\n    add('h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn', '', phrasingContent);\n    add('blockquote', 'cite', flowContent);\n    add('ol', 'reversed start type', 'li');\n    add('ul', '', 'li');\n    add('li', 'value', flowContent);\n    add('dl', '', 'dt dd');\n    add('a', 'href target rel media hreflang type', phrasingContent);\n    add('q', 'cite', phrasingContent);\n    add('ins del', 'cite datetime', flowContent);\n    add('img', 'src sizes srcset alt usemap ismap width height');\n    add('iframe', 'src name width height', flowContent);\n    add('embed', 'src type width height');\n    add('object', 'data type typemustmatch name usemap form width height', [flowContent, 'param'].join(' '));\n    add('param', 'name value');\n    add('map', 'name', [flowContent, 'area'].join(' '));\n    add('area', 'alt coords shape href target rel media hreflang type');\n    add('table', 'border', 'caption colgroup thead tfoot tbody tr' + (type === 'html4' ? ' col' : ''));\n    add('colgroup', 'span', 'col');\n    add('col', 'span');\n    add('tbody thead tfoot', '', 'tr');\n    add('tr', '', 'td th');\n    add('td', 'colspan rowspan headers', flowContent);\n    add('th', 'colspan rowspan headers scope abbr', flowContent);\n    add('form', 'accept-charset action autocomplete enctype method name novalidate target', flowContent);\n    add('fieldset', 'disabled form name', [flowContent, 'legend'].join(' '));\n    add('label', 'form for', phrasingContent);\n    add('input', 'accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate ' + 'formtarget height list max maxlength min multiple name pattern readonly required size src step type value width');\n    add('button', 'disabled form formaction formenctype formmethod formnovalidate formtarget name type value', type === 'html4' ? flowContent : phrasingContent);\n    add('select', 'disabled form multiple name required size', 'option optgroup');\n    add('optgroup', 'disabled label', 'option');\n    add('option', 'disabled label selected value');\n    add('textarea', 'cols dirname disabled form maxlength name readonly required rows wrap');\n    add('menu', 'type label', [flowContent, 'li'].join(' '));\n    add('noscript', '', flowContent);\n\n    if (type !== 'html4') {\n      add('wbr');\n      add('ruby', '', [phrasingContent, 'rt rp'].join(' '));\n      add('figcaption', '', flowContent);\n      add('mark rt rp summary bdi', '', phrasingContent);\n      add('canvas', 'width height', flowContent);\n      add('video', 'src crossorigin poster preload autoplay mediagroup loop ' + 'muted controls width height buffered', [flowContent, 'track source'].join(' '));\n      add('audio', 'src crossorigin preload autoplay mediagroup loop muted controls ' + 'buffered volume', [flowContent, 'track source'].join(' '));\n      add('picture', '', 'img source');\n      add('source', 'src srcset type media sizes');\n      add('track', 'kind src srclang label default');\n      add('datalist', '', [phrasingContent, 'option'].join(' '));\n      add('article section nav aside main header footer', '', flowContent);\n      add('hgroup', '', 'h1 h2 h3 h4 h5 h6');\n      add('figure', '', [flowContent, 'figcaption'].join(' '));\n      add('time', 'datetime', phrasingContent);\n      add('dialog', 'open', flowContent);\n      add('command', 'type label icon disabled checked radiogroup command');\n      add('output', 'for form name', phrasingContent);\n      add('progress', 'value max', phrasingContent);\n      add('meter', 'value min max low high optimum', phrasingContent);\n      add('details', 'open', [flowContent, 'summary'].join(' '));\n      add('keygen', 'autofocus challenge disabled form keytype name');\n    }\n\n    if (type !== 'html5-strict') {\n      addAttrs('script', 'language xml:space');\n      addAttrs('style', 'xml:space');\n      addAttrs('object', 'declare classid code codebase codetype archive standby align border hspace vspace');\n      addAttrs('embed', 'align name hspace vspace');\n      addAttrs('param', 'valuetype type');\n      addAttrs('a', 'charset name rev shape coords');\n      addAttrs('br', 'clear');\n      addAttrs('applet', 'codebase archive code object alt name width height align hspace vspace');\n      addAttrs('img', 'name longdesc align border hspace vspace');\n      addAttrs('iframe', 'longdesc frameborder marginwidth marginheight scrolling align');\n      addAttrs('font basefont', 'size color face');\n      addAttrs('input', 'usemap align');\n      addAttrs('select');\n      addAttrs('textarea');\n      addAttrs('h1 h2 h3 h4 h5 h6 div p legend caption', 'align');\n      addAttrs('ul', 'type compact');\n      addAttrs('li', 'type');\n      addAttrs('ol dl menu dir', 'compact');\n      addAttrs('pre', 'width xml:space');\n      addAttrs('hr', 'align noshade size width');\n      addAttrs('isindex', 'prompt');\n      addAttrs('table', 'summary width frame rules cellspacing cellpadding align bgcolor');\n      addAttrs('col', 'width align char charoff valign');\n      addAttrs('colgroup', 'width align char charoff valign');\n      addAttrs('thead', 'align char charoff valign');\n      addAttrs('tr', 'align char charoff valign bgcolor');\n      addAttrs('th', 'axis align char charoff valign nowrap bgcolor width height');\n      addAttrs('form', 'accept');\n      addAttrs('td', 'abbr axis scope align char charoff valign nowrap bgcolor width height');\n      addAttrs('tfoot', 'align char charoff valign');\n      addAttrs('tbody', 'align char charoff valign');\n      addAttrs('area', 'nohref');\n      addAttrs('body', 'background bgcolor text link vlink alink');\n    }\n\n    if (type !== 'html4') {\n      addAttrs('input button select textarea', 'autofocus');\n      addAttrs('input textarea', 'placeholder');\n      addAttrs('a', 'download');\n      addAttrs('link script img', 'crossorigin');\n      addAttrs('img', 'loading');\n      addAttrs('iframe', 'sandbox seamless allowfullscreen loading');\n    }\n\n    each$3(split('a form meter progress dfn'), function (name) {\n      if (schema[name]) {\n        delete schema[name].children[name];\n      }\n    });\n    delete schema.caption.children.table;\n    delete schema.script;\n    mapCache[type] = schema;\n    return schema;\n  };\n\n  var compileElementMap = function (value, mode) {\n    var styles;\n\n    if (value) {\n      styles = {};\n\n      if (typeof value === 'string') {\n        value = {\n          '*': value\n        };\n      }\n\n      each$3(value, function (value, key) {\n        styles[key] = styles[key.toUpperCase()] = mode === 'map' ? makeMap$2(value, /[, ]/) : explode$1(value, /[, ]/);\n      });\n    }\n\n    return styles;\n  };\n\n  var Schema = function (settings) {\n    var elements = {};\n    var children = {};\n    var patternElements = [];\n    var customElementsMap = {},\n        specialElements = {};\n\n    var createLookupTable = function (option, defaultValue, extendWith) {\n      var value = settings[option];\n\n      if (!value) {\n        value = mapCache[option];\n\n        if (!value) {\n          value = makeMap$2(defaultValue, ' ', makeMap$2(defaultValue.toUpperCase(), ' '));\n          value = extend$1(value, extendWith);\n          mapCache[option] = value;\n        }\n      } else {\n        value = makeMap$2(value, /[, ]/, makeMap$2(value.toUpperCase(), /[, ]/));\n      }\n\n      return value;\n    };\n\n    settings = settings || {};\n    var schemaItems = compileSchema(settings.schema);\n\n    if (settings.verify_html === false) {\n      settings.valid_elements = '*[*]';\n    }\n\n    var validStyles = compileElementMap(settings.valid_styles);\n    var invalidStyles = compileElementMap(settings.invalid_styles, 'map');\n    var validClasses = compileElementMap(settings.valid_classes, 'map');\n    var whiteSpaceElementsMap = createLookupTable('whitespace_elements', 'pre script noscript style textarea video audio iframe object code');\n    var selfClosingElementsMap = createLookupTable('self_closing_elements', 'colgroup dd dt li option p td tfoot th thead tr');\n    var shortEndedElementsMap = createLookupTable('short_ended_elements', 'area base basefont br col frame hr img input isindex link ' + 'meta param embed source wbr track');\n    var boolAttrMap = createLookupTable('boolean_attributes', 'checked compact declare defer disabled ismap multiple nohref noresize ' + 'noshade nowrap readonly selected autoplay loop controls');\n    var nonEmptyOrMoveCaretBeforeOnEnter = 'td th iframe video audio object script code';\n    var nonEmptyElementsMap = createLookupTable('non_empty_elements', nonEmptyOrMoveCaretBeforeOnEnter + ' pre', shortEndedElementsMap);\n    var moveCaretBeforeOnEnterElementsMap = createLookupTable('move_caret_before_on_enter_elements', nonEmptyOrMoveCaretBeforeOnEnter + ' table', shortEndedElementsMap);\n    var textBlockElementsMap = createLookupTable('text_block_elements', 'h1 h2 h3 h4 h5 h6 p div address pre form ' + 'blockquote center dir fieldset header footer article section hgroup aside main nav figure');\n    var blockElementsMap = createLookupTable('block_elements', 'hr table tbody thead tfoot ' + 'th tr td li ol ul caption dl dt dd noscript menu isindex option ' + 'datalist select optgroup figcaption details summary', textBlockElementsMap);\n    var textInlineElementsMap = createLookupTable('text_inline_elements', 'span strong b em i font strike u var cite ' + 'dfn code mark q sup sub samp');\n    each$3((settings.special || 'script noscript iframe noframes noembed title style textarea xmp').split(' '), function (name) {\n      specialElements[name] = new RegExp('</' + name + '[^>]*>', 'gi');\n    });\n\n    var patternToRegExp = function (str) {\n      return new RegExp('^' + str.replace(/([?+*])/g, '.$1') + '$');\n    };\n\n    var addValidElements = function (validElements) {\n      var ei, el, ai, al, matches, element, attr, attrData, elementName, attrName, attrType, attributes, attributesOrder, prefix, outputName, globalAttributes, globalAttributesOrder, value;\n      var elementRuleRegExp = /^([#+\\-])?([^\\[!\\/]+)(?:\\/([^\\[!]+))?(?:(!?)\\[([^\\]]+)])?$/,\n          attrRuleRegExp = /^([!\\-])?(\\w+[\\\\:]:\\w+|[^=:<]+)?(?:([=:<])(.*))?$/,\n          hasPatternsRegExp = /[*?+]/;\n\n      if (validElements) {\n        var validElementsArr = split(validElements, ',');\n\n        if (elements['@']) {\n          globalAttributes = elements['@'].attributes;\n          globalAttributesOrder = elements['@'].attributesOrder;\n        }\n\n        for (ei = 0, el = validElementsArr.length; ei < el; ei++) {\n          matches = elementRuleRegExp.exec(validElementsArr[ei]);\n\n          if (matches) {\n            prefix = matches[1];\n            elementName = matches[2];\n            outputName = matches[3];\n            attrData = matches[5];\n            attributes = {};\n            attributesOrder = [];\n            element = {\n              attributes: attributes,\n              attributesOrder: attributesOrder\n            };\n\n            if (prefix === '#') {\n              element.paddEmpty = true;\n            }\n\n            if (prefix === '-') {\n              element.removeEmpty = true;\n            }\n\n            if (matches[4] === '!') {\n              element.removeEmptyAttrs = true;\n            }\n\n            if (globalAttributes) {\n              each$1(globalAttributes, function (value, key) {\n                attributes[key] = value;\n              });\n              attributesOrder.push.apply(attributesOrder, globalAttributesOrder);\n            }\n\n            if (attrData) {\n              attrData = split(attrData, '|');\n\n              for (ai = 0, al = attrData.length; ai < al; ai++) {\n                matches = attrRuleRegExp.exec(attrData[ai]);\n\n                if (matches) {\n                  attr = {};\n                  attrType = matches[1];\n                  attrName = matches[2].replace(/[\\\\:]:/g, ':');\n                  prefix = matches[3];\n                  value = matches[4];\n\n                  if (attrType === '!') {\n                    element.attributesRequired = element.attributesRequired || [];\n                    element.attributesRequired.push(attrName);\n                    attr.required = true;\n                  }\n\n                  if (attrType === '-') {\n                    delete attributes[attrName];\n                    attributesOrder.splice(inArray(attributesOrder, attrName), 1);\n                    continue;\n                  }\n\n                  if (prefix) {\n                    if (prefix === '=') {\n                      element.attributesDefault = element.attributesDefault || [];\n                      element.attributesDefault.push({\n                        name: attrName,\n                        value: value\n                      });\n                      attr.defaultValue = value;\n                    }\n\n                    if (prefix === ':') {\n                      element.attributesForced = element.attributesForced || [];\n                      element.attributesForced.push({\n                        name: attrName,\n                        value: value\n                      });\n                      attr.forcedValue = value;\n                    }\n\n                    if (prefix === '<') {\n                      attr.validValues = makeMap$2(value, '?');\n                    }\n                  }\n\n                  if (hasPatternsRegExp.test(attrName)) {\n                    element.attributePatterns = element.attributePatterns || [];\n                    attr.pattern = patternToRegExp(attrName);\n                    element.attributePatterns.push(attr);\n                  } else {\n                    if (!attributes[attrName]) {\n                      attributesOrder.push(attrName);\n                    }\n\n                    attributes[attrName] = attr;\n                  }\n                }\n              }\n            }\n\n            if (!globalAttributes && elementName === '@') {\n              globalAttributes = attributes;\n              globalAttributesOrder = attributesOrder;\n            }\n\n            if (outputName) {\n              element.outputName = elementName;\n              elements[outputName] = element;\n            }\n\n            if (hasPatternsRegExp.test(elementName)) {\n              element.pattern = patternToRegExp(elementName);\n              patternElements.push(element);\n            } else {\n              elements[elementName] = element;\n            }\n          }\n        }\n      }\n    };\n\n    var setValidElements = function (validElements) {\n      elements = {};\n      patternElements = [];\n      addValidElements(validElements);\n      each$3(schemaItems, function (element, name) {\n        children[name] = element.children;\n      });\n    };\n\n    var addCustomElements = function (customElements) {\n      var customElementRegExp = /^(~)?(.+)$/;\n\n      if (customElements) {\n        mapCache.text_block_elements = mapCache.block_elements = null;\n        each$3(split(customElements, ','), function (rule) {\n          var matches = customElementRegExp.exec(rule),\n              inline = matches[1] === '~',\n              cloneName = inline ? 'span' : 'div',\n              name = matches[2];\n          children[name] = children[cloneName];\n          customElementsMap[name] = cloneName;\n\n          if (!inline) {\n            blockElementsMap[name.toUpperCase()] = {};\n            blockElementsMap[name] = {};\n          }\n\n          if (!elements[name]) {\n            var customRule = elements[cloneName];\n            customRule = extend$1({}, customRule);\n            delete customRule.removeEmptyAttrs;\n            delete customRule.removeEmpty;\n            elements[name] = customRule;\n          }\n\n          each$3(children, function (element, elmName) {\n            if (element[cloneName]) {\n              children[elmName] = element = extend$1({}, children[elmName]);\n              element[name] = element[cloneName];\n            }\n          });\n        });\n      }\n    };\n\n    var addValidChildren = function (validChildren) {\n      var childRuleRegExp = /^([+\\-]?)([A-Za-z0-9_\\-.\\u00b7\\u00c0-\\u00d6\\u00d8-\\u00f6\\u00f8-\\u037d\\u037f-\\u1fff\\u200c-\\u200d\\u203f-\\u2040\\u2070-\\u218f\\u2c00-\\u2fef\\u3001-\\ud7ff\\uf900-\\ufdcf\\ufdf0-\\ufffd]+)\\[([^\\]]+)]$/;\n      mapCache[settings.schema] = null;\n\n      if (validChildren) {\n        each$3(split(validChildren, ','), function (rule) {\n          var matches = childRuleRegExp.exec(rule);\n          var parent, prefix;\n\n          if (matches) {\n            prefix = matches[1];\n\n            if (prefix) {\n              parent = children[matches[2]];\n            } else {\n              parent = children[matches[2]] = {\n                '#comment': {}\n              };\n            }\n\n            parent = children[matches[2]];\n            each$3(split(matches[3], '|'), function (child) {\n              if (prefix === '-') {\n                delete parent[child];\n              } else {\n                parent[child] = {};\n              }\n            });\n          }\n        });\n      }\n    };\n\n    var getElementRule = function (name) {\n      var element = elements[name],\n          i;\n\n      if (element) {\n        return element;\n      }\n\n      i = patternElements.length;\n\n      while (i--) {\n        element = patternElements[i];\n\n        if (element.pattern.test(name)) {\n          return element;\n        }\n      }\n    };\n\n    if (!settings.valid_elements) {\n      each$3(schemaItems, function (element, name) {\n        elements[name] = {\n          attributes: element.attributes,\n          attributesOrder: element.attributesOrder\n        };\n        children[name] = element.children;\n      });\n\n      if (settings.schema !== 'html5') {\n        each$3(split('strong/b em/i'), function (item) {\n          var items = split(item, '/');\n          elements[items[1]].outputName = items[0];\n        });\n      }\n\n      each$3(split('ol ul sub sup blockquote span font a table tbody strong em b i'), function (name) {\n        if (elements[name]) {\n          elements[name].removeEmpty = true;\n        }\n      });\n      each$3(split('p h1 h2 h3 h4 h5 h6 th td pre div address caption li'), function (name) {\n        elements[name].paddEmpty = true;\n      });\n      each$3(split('span'), function (name) {\n        elements[name].removeEmptyAttrs = true;\n      });\n    } else {\n      setValidElements(settings.valid_elements);\n    }\n\n    addCustomElements(settings.custom_elements);\n    addValidChildren(settings.valid_children);\n    addValidElements(settings.extended_valid_elements);\n    addValidChildren('+ol[ul|ol],+ul[ul|ol]');\n    each$3({\n      dd: 'dl',\n      dt: 'dl',\n      li: 'ul ol',\n      td: 'tr',\n      th: 'tr',\n      tr: 'tbody thead tfoot',\n      tbody: 'table',\n      thead: 'table',\n      tfoot: 'table',\n      legend: 'fieldset',\n      area: 'map',\n      param: 'video audio object'\n    }, function (parents, item) {\n      if (elements[item]) {\n        elements[item].parentsRequired = split(parents);\n      }\n    });\n\n    if (settings.invalid_elements) {\n      each$3(explode$1(settings.invalid_elements), function (item) {\n        if (elements[item]) {\n          delete elements[item];\n        }\n      });\n    }\n\n    if (!getElementRule('span')) {\n      addValidElements('span[!data-mce-type|*]');\n    }\n\n    var getValidStyles = function () {\n      return validStyles;\n    };\n\n    var getInvalidStyles = function () {\n      return invalidStyles;\n    };\n\n    var getValidClasses = function () {\n      return validClasses;\n    };\n\n    var getBoolAttrs = function () {\n      return boolAttrMap;\n    };\n\n    var getBlockElements = function () {\n      return blockElementsMap;\n    };\n\n    var getTextBlockElements = function () {\n      return textBlockElementsMap;\n    };\n\n    var getTextInlineElements = function () {\n      return textInlineElementsMap;\n    };\n\n    var getShortEndedElements = function () {\n      return shortEndedElementsMap;\n    };\n\n    var getSelfClosingElements = function () {\n      return selfClosingElementsMap;\n    };\n\n    var getNonEmptyElements = function () {\n      return nonEmptyElementsMap;\n    };\n\n    var getMoveCaretBeforeOnEnterElements = function () {\n      return moveCaretBeforeOnEnterElementsMap;\n    };\n\n    var getWhiteSpaceElements = function () {\n      return whiteSpaceElementsMap;\n    };\n\n    var getSpecialElements = function () {\n      return specialElements;\n    };\n\n    var isValidChild = function (name, child) {\n      var parent = children[name.toLowerCase()];\n      return !!(parent && parent[child.toLowerCase()]);\n    };\n\n    var isValid = function (name, attr) {\n      var attrPatterns, i;\n      var rule = getElementRule(name);\n\n      if (rule) {\n        if (attr) {\n          if (rule.attributes[attr]) {\n            return true;\n          }\n\n          attrPatterns = rule.attributePatterns;\n\n          if (attrPatterns) {\n            i = attrPatterns.length;\n\n            while (i--) {\n              if (attrPatterns[i].pattern.test(name)) {\n                return true;\n              }\n            }\n          }\n        } else {\n          return true;\n        }\n      }\n\n      return false;\n    };\n\n    var getCustomElements = function () {\n      return customElementsMap;\n    };\n\n    return {\n      children: children,\n      elements: elements,\n      getValidStyles: getValidStyles,\n      getValidClasses: getValidClasses,\n      getBlockElements: getBlockElements,\n      getInvalidStyles: getInvalidStyles,\n      getShortEndedElements: getShortEndedElements,\n      getTextBlockElements: getTextBlockElements,\n      getTextInlineElements: getTextInlineElements,\n      getBoolAttrs: getBoolAttrs,\n      getElementRule: getElementRule,\n      getSelfClosingElements: getSelfClosingElements,\n      getNonEmptyElements: getNonEmptyElements,\n      getMoveCaretBeforeOnEnterElements: getMoveCaretBeforeOnEnterElements,\n      getWhiteSpaceElements: getWhiteSpaceElements,\n      getSpecialElements: getSpecialElements,\n      isValidChild: isValidChild,\n      isValid: isValid,\n      getCustomElements: getCustomElements,\n      addValidElements: addValidElements,\n      setValidElements: setValidElements,\n      addCustomElements: addCustomElements,\n      addValidChildren: addValidChildren\n    };\n  };\n\n  var toHex = function (match, r, g, b) {\n    var hex = function (val) {\n      val = parseInt(val, 10).toString(16);\n      return val.length > 1 ? val : '0' + val;\n    };\n\n    return '#' + hex(r) + hex(g) + hex(b);\n  };\n\n  var Styles = function (settings, schema) {\n    var _this = this;\n\n    var rgbRegExp = /rgb\\s*\\(\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*\\)/gi;\n    var urlOrStrRegExp = /(?:url(?:(?:\\(\\s*\\\"([^\\\"]+)\\\"\\s*\\))|(?:\\(\\s*\\'([^\\']+)\\'\\s*\\))|(?:\\(\\s*([^)\\s]+)\\s*\\))))|(?:\\'([^\\']+)\\')|(?:\\\"([^\\\"]+)\\\")/gi;\n    var styleRegExp = /\\s*([^:]+):\\s*([^;]+);?/g;\n    var trimRightRegExp = /\\s+$/;\n    var i;\n    var encodingLookup = {};\n    var validStyles;\n    var invalidStyles;\n    var invisibleChar = zeroWidth;\n    settings = settings || {};\n\n    if (schema) {\n      validStyles = schema.getValidStyles();\n      invalidStyles = schema.getInvalidStyles();\n    }\n\n    var encodingItems = ('\\\\\" \\\\\\' \\\\; \\\\: ; : ' + invisibleChar).split(' ');\n\n    for (i = 0; i < encodingItems.length; i++) {\n      encodingLookup[encodingItems[i]] = invisibleChar + i;\n      encodingLookup[invisibleChar + i] = encodingItems[i];\n    }\n\n    return {\n      toHex: function (color) {\n        return color.replace(rgbRegExp, toHex);\n      },\n      parse: function (css) {\n        var styles = {};\n        var matches, name, value, isEncoded;\n        var urlConverter = settings.url_converter;\n        var urlConverterScope = settings.url_converter_scope || _this;\n\n        var compress = function (prefix, suffix, noJoin) {\n          var top = styles[prefix + '-top' + suffix];\n\n          if (!top) {\n            return;\n          }\n\n          var right = styles[prefix + '-right' + suffix];\n\n          if (!right) {\n            return;\n          }\n\n          var bottom = styles[prefix + '-bottom' + suffix];\n\n          if (!bottom) {\n            return;\n          }\n\n          var left = styles[prefix + '-left' + suffix];\n\n          if (!left) {\n            return;\n          }\n\n          var box = [top, right, bottom, left];\n          i = box.length - 1;\n\n          while (i--) {\n            if (box[i] !== box[i + 1]) {\n              break;\n            }\n          }\n\n          if (i > -1 && noJoin) {\n            return;\n          }\n\n          styles[prefix + suffix] = i === -1 ? box[0] : box.join(' ');\n          delete styles[prefix + '-top' + suffix];\n          delete styles[prefix + '-right' + suffix];\n          delete styles[prefix + '-bottom' + suffix];\n          delete styles[prefix + '-left' + suffix];\n        };\n\n        var canCompress = function (key) {\n          var value = styles[key],\n              i;\n\n          if (!value) {\n            return;\n          }\n\n          value = value.split(' ');\n          i = value.length;\n\n          while (i--) {\n            if (value[i] !== value[0]) {\n              return false;\n            }\n          }\n\n          styles[key] = value[0];\n          return true;\n        };\n\n        var compress2 = function (target, a, b, c) {\n          if (!canCompress(a)) {\n            return;\n          }\n\n          if (!canCompress(b)) {\n            return;\n          }\n\n          if (!canCompress(c)) {\n            return;\n          }\n\n          styles[target] = styles[a] + ' ' + styles[b] + ' ' + styles[c];\n          delete styles[a];\n          delete styles[b];\n          delete styles[c];\n        };\n\n        var encode = function (str) {\n          isEncoded = true;\n          return encodingLookup[str];\n        };\n\n        var decode = function (str, keepSlashes) {\n          if (isEncoded) {\n            str = str.replace(/\\uFEFF[0-9]/g, function (str) {\n              return encodingLookup[str];\n            });\n          }\n\n          if (!keepSlashes) {\n            str = str.replace(/\\\\([\\'\\\";:])/g, '$1');\n          }\n\n          return str;\n        };\n\n        var decodeSingleHexSequence = function (escSeq) {\n          return String.fromCharCode(parseInt(escSeq.slice(1), 16));\n        };\n\n        var decodeHexSequences = function (value) {\n          return value.replace(/\\\\[0-9a-f]+/gi, decodeSingleHexSequence);\n        };\n\n        var processUrl = function (match, url, url2, url3, str, str2) {\n          str = str || str2;\n\n          if (str) {\n            str = decode(str);\n            return '\\'' + str.replace(/\\'/g, '\\\\\\'') + '\\'';\n          }\n\n          url = decode(url || url2 || url3);\n\n          if (!settings.allow_script_urls) {\n            var scriptUrl = url.replace(/[\\s\\r\\n]+/g, '');\n\n            if (/(java|vb)script:/i.test(scriptUrl)) {\n              return '';\n            }\n\n            if (!settings.allow_svg_data_urls && /^data:image\\/svg/i.test(scriptUrl)) {\n              return '';\n            }\n          }\n\n          if (urlConverter) {\n            url = urlConverter.call(urlConverterScope, url, 'style');\n          }\n\n          return 'url(\\'' + url.replace(/\\'/g, '\\\\\\'') + '\\')';\n        };\n\n        if (css) {\n          css = css.replace(/[\\u0000-\\u001F]/g, '');\n          css = css.replace(/\\\\[\\\"\\';:\\uFEFF]/g, encode).replace(/\\\"[^\\\"]+\\\"|\\'[^\\']+\\'/g, function (str) {\n            return str.replace(/[;:]/g, encode);\n          });\n\n          while (matches = styleRegExp.exec(css)) {\n            styleRegExp.lastIndex = matches.index + matches[0].length;\n            name = matches[1].replace(trimRightRegExp, '').toLowerCase();\n            value = matches[2].replace(trimRightRegExp, '');\n\n            if (name && value) {\n              name = decodeHexSequences(name);\n              value = decodeHexSequences(value);\n\n              if (name.indexOf(invisibleChar) !== -1 || name.indexOf('\"') !== -1) {\n                continue;\n              }\n\n              if (!settings.allow_script_urls && (name === 'behavior' || /expression\\s*\\(|\\/\\*|\\*\\//.test(value))) {\n                continue;\n              }\n\n              if (name === 'font-weight' && value === '700') {\n                value = 'bold';\n              } else if (name === 'color' || name === 'background-color') {\n                value = value.toLowerCase();\n              }\n\n              value = value.replace(rgbRegExp, toHex);\n              value = value.replace(urlOrStrRegExp, processUrl);\n              styles[name] = isEncoded ? decode(value, true) : value;\n            }\n          }\n\n          compress('border', '', true);\n          compress('border', '-width');\n          compress('border', '-color');\n          compress('border', '-style');\n          compress('padding', '');\n          compress('margin', '');\n          compress2('border', 'border-width', 'border-style', 'border-color');\n\n          if (styles.border === 'medium none') {\n            delete styles.border;\n          }\n\n          if (styles['border-image'] === 'none') {\n            delete styles['border-image'];\n          }\n        }\n\n        return styles;\n      },\n      serialize: function (styles, elementName) {\n        var css = '';\n\n        var serializeStyles = function (name) {\n          var value;\n          var styleList = validStyles[name];\n\n          if (styleList) {\n            for (var i_1 = 0, l = styleList.length; i_1 < l; i_1++) {\n              name = styleList[i_1];\n              value = styles[name];\n\n              if (value) {\n                css += (css.length > 0 ? ' ' : '') + name + ': ' + value + ';';\n              }\n            }\n          }\n        };\n\n        var isValid = function (name, elementName) {\n          var styleMap = invalidStyles['*'];\n\n          if (styleMap && styleMap[name]) {\n            return false;\n          }\n\n          styleMap = invalidStyles[elementName];\n          return !(styleMap && styleMap[name]);\n        };\n\n        if (elementName && validStyles) {\n          serializeStyles('*');\n          serializeStyles(elementName);\n        } else {\n          each$1(styles, function (value, name) {\n            if (value && (!invalidStyles || isValid(name, elementName))) {\n              css += (css.length > 0 ? ' ' : '') + name + ': ' + value + ';';\n            }\n          });\n        }\n\n        return css;\n      }\n    };\n  };\n\n  var eventExpandoPrefix = 'mce-data-';\n  var mouseEventRe = /^(?:mouse|contextmenu)|click/;\n  var deprecated = {\n    keyLocation: 1,\n    layerX: 1,\n    layerY: 1,\n    returnValue: 1,\n    webkitMovementX: 1,\n    webkitMovementY: 1,\n    keyIdentifier: 1,\n    mozPressure: 1\n  };\n\n  var hasIsDefaultPrevented = function (event) {\n    return event.isDefaultPrevented === returnTrue || event.isDefaultPrevented === returnFalse;\n  };\n\n  var returnFalse = never;\n  var returnTrue = always;\n\n  var addEvent = function (target, name, callback, capture) {\n    if (target.addEventListener) {\n      target.addEventListener(name, callback, capture || false);\n    } else if (target.attachEvent) {\n      target.attachEvent('on' + name, callback);\n    }\n  };\n\n  var removeEvent = function (target, name, callback, capture) {\n    if (target.removeEventListener) {\n      target.removeEventListener(name, callback, capture || false);\n    } else if (target.detachEvent) {\n      target.detachEvent('on' + name, callback);\n    }\n  };\n\n  var isMouseEvent = function (event) {\n    return mouseEventRe.test(event.type);\n  };\n\n  var fix = function (originalEvent, data) {\n    var name;\n    var event = data || {};\n\n    for (name in originalEvent) {\n      if (!deprecated[name]) {\n        event[name] = originalEvent[name];\n      }\n    }\n\n    if (!event.target) {\n      event.target = event.srcElement || document;\n    }\n\n    if (event.composedPath) {\n      event.composedPath = function () {\n        return originalEvent.composedPath();\n      };\n    }\n\n    if (originalEvent && isMouseEvent(originalEvent) && originalEvent.pageX === undefined && originalEvent.clientX !== undefined) {\n      var eventDoc = event.target.ownerDocument || document;\n      var doc = eventDoc.documentElement;\n      var body = eventDoc.body;\n      event.pageX = originalEvent.clientX + (doc && doc.scrollLeft || body && body.scrollLeft || 0) - (doc && doc.clientLeft || body && body.clientLeft || 0);\n      event.pageY = originalEvent.clientY + (doc && doc.scrollTop || body && body.scrollTop || 0) - (doc && doc.clientTop || body && body.clientTop || 0);\n    }\n\n    event.preventDefault = function () {\n      event.defaultPrevented = true;\n      event.isDefaultPrevented = returnTrue;\n\n      if (originalEvent) {\n        if (originalEvent.preventDefault) {\n          originalEvent.preventDefault();\n        } else {\n          originalEvent.returnValue = false;\n        }\n      }\n    };\n\n    event.stopPropagation = function () {\n      event.cancelBubble = true;\n      event.isPropagationStopped = returnTrue;\n\n      if (originalEvent) {\n        if (originalEvent.stopPropagation) {\n          originalEvent.stopPropagation();\n        } else {\n          originalEvent.cancelBubble = true;\n        }\n      }\n    };\n\n    event.stopImmediatePropagation = function () {\n      event.isImmediatePropagationStopped = returnTrue;\n      event.stopPropagation();\n    };\n\n    if (hasIsDefaultPrevented(event) === false) {\n      event.isDefaultPrevented = event.defaultPrevented === true ? returnTrue : returnFalse;\n      event.isPropagationStopped = event.cancelBubble === true ? returnTrue : returnFalse;\n      event.isImmediatePropagationStopped = returnFalse;\n    }\n\n    if (typeof event.metaKey === 'undefined') {\n      event.metaKey = false;\n    }\n\n    return event;\n  };\n\n  var bindOnReady = function (win, callback, eventUtils) {\n    var doc = win.document,\n        event = {\n      type: 'ready'\n    };\n\n    if (eventUtils.domLoaded) {\n      callback(event);\n      return;\n    }\n\n    var isDocReady = function () {\n      return doc.readyState === 'complete' || doc.readyState === 'interactive' && doc.body;\n    };\n\n    var readyHandler = function () {\n      removeEvent(win, 'DOMContentLoaded', readyHandler);\n      removeEvent(win, 'load', readyHandler);\n\n      if (!eventUtils.domLoaded) {\n        eventUtils.domLoaded = true;\n        callback(event);\n      }\n\n      win = null;\n    };\n\n    if (isDocReady()) {\n      readyHandler();\n    } else {\n      addEvent(win, 'DOMContentLoaded', readyHandler);\n    }\n\n    if (!eventUtils.domLoaded) {\n      addEvent(win, 'load', readyHandler);\n    }\n  };\n\n  var EventUtils = function () {\n    function EventUtils() {\n      this.domLoaded = false;\n      this.events = {};\n      this.count = 1;\n      this.expando = eventExpandoPrefix + (+new Date()).toString(32);\n      this.hasMouseEnterLeave = 'onmouseenter' in document.documentElement;\n      this.hasFocusIn = 'onfocusin' in document.documentElement;\n      this.count = 1;\n    }\n\n    EventUtils.prototype.bind = function (target, names, callback, scope) {\n      var self = this;\n      var id, callbackList, i, name, fakeName, nativeHandler, capture;\n      var win = window;\n\n      var defaultNativeHandler = function (evt) {\n        self.executeHandlers(fix(evt || win.event), id);\n      };\n\n      if (!target || target.nodeType === 3 || target.nodeType === 8) {\n        return;\n      }\n\n      if (!target[self.expando]) {\n        id = self.count++;\n        target[self.expando] = id;\n        self.events[id] = {};\n      } else {\n        id = target[self.expando];\n      }\n\n      scope = scope || target;\n      var namesList = names.split(' ');\n      i = namesList.length;\n\n      while (i--) {\n        name = namesList[i];\n        nativeHandler = defaultNativeHandler;\n        fakeName = capture = false;\n\n        if (name === 'DOMContentLoaded') {\n          name = 'ready';\n        }\n\n        if (self.domLoaded && name === 'ready' && target.readyState === 'complete') {\n          callback.call(scope, fix({\n            type: name\n          }));\n          continue;\n        }\n\n        if (!self.hasMouseEnterLeave) {\n          fakeName = self.mouseEnterLeave[name];\n\n          if (fakeName) {\n            nativeHandler = function (evt) {\n              var current = evt.currentTarget;\n              var related = evt.relatedTarget;\n\n              if (related && current.contains) {\n                related = current.contains(related);\n              } else {\n                while (related && related !== current) {\n                  related = related.parentNode;\n                }\n              }\n\n              if (!related) {\n                evt = fix(evt || win.event);\n                evt.type = evt.type === 'mouseout' ? 'mouseleave' : 'mouseenter';\n                evt.target = current;\n                self.executeHandlers(evt, id);\n              }\n            };\n          }\n        }\n\n        if (!self.hasFocusIn && (name === 'focusin' || name === 'focusout')) {\n          capture = true;\n          fakeName = name === 'focusin' ? 'focus' : 'blur';\n\n          nativeHandler = function (evt) {\n            evt = fix(evt || win.event);\n            evt.type = evt.type === 'focus' ? 'focusin' : 'focusout';\n            self.executeHandlers(evt, id);\n          };\n        }\n\n        callbackList = self.events[id][name];\n\n        if (!callbackList) {\n          self.events[id][name] = callbackList = [{\n            func: callback,\n            scope: scope\n          }];\n          callbackList.fakeName = fakeName;\n          callbackList.capture = capture;\n          callbackList.nativeHandler = nativeHandler;\n\n          if (name === 'ready') {\n            bindOnReady(target, nativeHandler, self);\n          } else {\n            addEvent(target, fakeName || name, nativeHandler, capture);\n          }\n        } else {\n          if (name === 'ready' && self.domLoaded) {\n            callback(fix({\n              type: name\n            }));\n          } else {\n            callbackList.push({\n              func: callback,\n              scope: scope\n            });\n          }\n        }\n      }\n\n      target = callbackList = null;\n      return callback;\n    };\n\n    EventUtils.prototype.unbind = function (target, names, callback) {\n      var callbackList, i, ci, name, eventMap;\n\n      if (!target || target.nodeType === 3 || target.nodeType === 8) {\n        return this;\n      }\n\n      var id = target[this.expando];\n\n      if (id) {\n        eventMap = this.events[id];\n\n        if (names) {\n          var namesList = names.split(' ');\n          i = namesList.length;\n\n          while (i--) {\n            name = namesList[i];\n            callbackList = eventMap[name];\n\n            if (callbackList) {\n              if (callback) {\n                ci = callbackList.length;\n\n                while (ci--) {\n                  if (callbackList[ci].func === callback) {\n                    var nativeHandler = callbackList.nativeHandler;\n                    var fakeName = callbackList.fakeName,\n                        capture = callbackList.capture;\n                    callbackList = callbackList.slice(0, ci).concat(callbackList.slice(ci + 1));\n                    callbackList.nativeHandler = nativeHandler;\n                    callbackList.fakeName = fakeName;\n                    callbackList.capture = capture;\n                    eventMap[name] = callbackList;\n                  }\n                }\n              }\n\n              if (!callback || callbackList.length === 0) {\n                delete eventMap[name];\n                removeEvent(target, callbackList.fakeName || name, callbackList.nativeHandler, callbackList.capture);\n              }\n            }\n          }\n        } else {\n          each$1(eventMap, function (callbackList, name) {\n            removeEvent(target, callbackList.fakeName || name, callbackList.nativeHandler, callbackList.capture);\n          });\n          eventMap = {};\n        }\n\n        for (name in eventMap) {\n          if (has(eventMap, name)) {\n            return this;\n          }\n        }\n\n        delete this.events[id];\n\n        try {\n          delete target[this.expando];\n        } catch (ex) {\n          target[this.expando] = null;\n        }\n      }\n\n      return this;\n    };\n\n    EventUtils.prototype.fire = function (target, name, args) {\n      var id;\n\n      if (!target || target.nodeType === 3 || target.nodeType === 8) {\n        return this;\n      }\n\n      var event = fix(null, args);\n      event.type = name;\n      event.target = target;\n\n      do {\n        id = target[this.expando];\n\n        if (id) {\n          this.executeHandlers(event, id);\n        }\n\n        target = target.parentNode || target.ownerDocument || target.defaultView || target.parentWindow;\n      } while (target && !event.isPropagationStopped());\n\n      return this;\n    };\n\n    EventUtils.prototype.clean = function (target) {\n      var i, children;\n\n      if (!target || target.nodeType === 3 || target.nodeType === 8) {\n        return this;\n      }\n\n      if (target[this.expando]) {\n        this.unbind(target);\n      }\n\n      if (!target.getElementsByTagName) {\n        target = target.document;\n      }\n\n      if (target && target.getElementsByTagName) {\n        this.unbind(target);\n        children = target.getElementsByTagName('*');\n        i = children.length;\n\n        while (i--) {\n          target = children[i];\n\n          if (target[this.expando]) {\n            this.unbind(target);\n          }\n        }\n      }\n\n      return this;\n    };\n\n    EventUtils.prototype.destroy = function () {\n      this.events = {};\n    };\n\n    EventUtils.prototype.cancel = function (e) {\n      if (e) {\n        e.preventDefault();\n        e.stopImmediatePropagation();\n      }\n\n      return false;\n    };\n\n    EventUtils.prototype.executeHandlers = function (evt, id) {\n      var container = this.events[id];\n      var callbackList = container && container[evt.type];\n\n      if (callbackList) {\n        for (var i = 0, l = callbackList.length; i < l; i++) {\n          var callback = callbackList[i];\n\n          if (callback && callback.func.call(callback.scope, evt) === false) {\n            evt.preventDefault();\n          }\n\n          if (evt.isImmediatePropagationStopped()) {\n            return;\n          }\n        }\n      }\n    };\n\n    EventUtils.Event = new EventUtils();\n    return EventUtils;\n  }();\n\n  var support,\n      Expr,\n      getText,\n      isXML,\n      tokenize,\n      compile,\n      select,\n      outermostContext,\n      sortInput,\n      hasDuplicate,\n      setDocument,\n      document$1,\n      docElem,\n      documentIsHTML,\n      rbuggyQSA,\n      rbuggyMatches,\n      matches,\n      contains$3,\n      expando = 'sizzle' + -new Date(),\n      preferredDoc = window.document,\n      dirruns = 0,\n      done = 0,\n      classCache = createCache(),\n      tokenCache = createCache(),\n      compilerCache = createCache(),\n      sortOrder = function (a, b) {\n    if (a === b) {\n      hasDuplicate = true;\n    }\n\n    return 0;\n  },\n      strundefined = typeof undefined,\n      MAX_NEGATIVE = 1 << 31,\n      hasOwn = {}.hasOwnProperty,\n      arr = [],\n      pop = arr.pop,\n      push_native = arr.push,\n      push = arr.push,\n      slice = arr.slice,\n      indexOf$2 = arr.indexOf || function (elem) {\n    var i = 0,\n        len = this.length;\n\n    for (; i < len; i++) {\n      if (this[i] === elem) {\n        return i;\n      }\n    }\n\n    return -1;\n  },\n      booleans = 'checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped',\n      whitespace = '[\\\\x20\\\\t\\\\r\\\\n\\\\f]',\n      identifier = '(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+',\n      attributes = '\\\\[' + whitespace + '*(' + identifier + ')(?:' + whitespace + '*([*^$|!~]?=)' + whitespace + '*(?:\\'((?:\\\\\\\\.|[^\\\\\\\\\\'])*)\\'|\"((?:\\\\\\\\.|[^\\\\\\\\\"])*)\"|(' + identifier + '))|)' + whitespace + '*\\\\]',\n      pseudos = ':(' + identifier + ')(?:\\\\((' + '(\\'((?:\\\\\\\\.|[^\\\\\\\\\\'])*)\\'|\"((?:\\\\\\\\.|[^\\\\\\\\\"])*)\")|' + '((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|' + attributes + ')*)|' + '.*' + ')\\\\)|)',\n      rtrim = new RegExp('^' + whitespace + '+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)' + whitespace + '+$', 'g'),\n      rcomma = new RegExp('^' + whitespace + '*,' + whitespace + '*'),\n      rcombinators = new RegExp('^' + whitespace + '*([>+~]|' + whitespace + ')' + whitespace + '*'),\n      rattributeQuotes = new RegExp('=' + whitespace + '*([^\\\\]\\'\"]*?)' + whitespace + '*\\\\]', 'g'),\n      rpseudo = new RegExp(pseudos),\n      ridentifier = new RegExp('^' + identifier + '$'),\n      matchExpr = {\n    ID: new RegExp('^#(' + identifier + ')'),\n    CLASS: new RegExp('^\\\\.(' + identifier + ')'),\n    TAG: new RegExp('^(' + identifier + '|[*])'),\n    ATTR: new RegExp('^' + attributes),\n    PSEUDO: new RegExp('^' + pseudos),\n    CHILD: new RegExp('^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(' + whitespace + '*(even|odd|(([+-]|)(\\\\d*)n|)' + whitespace + '*(?:([+-]|)' + whitespace + '*(\\\\d+)|))' + whitespace + '*\\\\)|)', 'i'),\n    bool: new RegExp('^(?:' + booleans + ')$', 'i'),\n    needsContext: new RegExp('^' + whitespace + '*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(' + whitespace + '*((?:-\\\\d)?\\\\d*)' + whitespace + '*\\\\)|)(?=[^-]|$)', 'i')\n  },\n      rinputs = /^(?:input|select|textarea|button)$/i,\n      rheader = /^h\\d$/i,\n      rnative = /^[^{]+\\{\\s*\\[native \\w/,\n      rquickExpr = /^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,\n      rsibling = /[+~]/,\n      rescape = /'|\\\\/g,\n      runescape = new RegExp('\\\\\\\\([\\\\da-f]{1,6}' + whitespace + '?|(' + whitespace + ')|.)', 'ig'),\n      funescape = function (_, escaped, escapedWhitespace) {\n    var high = '0x' + escaped - 65536;\n    return high !== high || escapedWhitespace ? escaped : high < 0 ? String.fromCharCode(high + 65536) : String.fromCharCode(high >> 10 | 55296, high & 1023 | 56320);\n  };\n\n  try {\n    push.apply(arr = slice.call(preferredDoc.childNodes), preferredDoc.childNodes);\n    arr[preferredDoc.childNodes.length].nodeType;\n  } catch (e) {\n    push = {\n      apply: arr.length ? function (target, els) {\n        push_native.apply(target, slice.call(els));\n      } : function (target, els) {\n        var j = target.length,\n            i = 0;\n\n        while (target[j++] = els[i++]) {}\n\n        target.length = j - 1;\n      }\n    };\n  }\n\n  var Sizzle = function (selector, context, results, seed) {\n    var match, elem, m, nodeType, i, groups, old, nid, newContext, newSelector;\n\n    if ((context ? context.ownerDocument || context : preferredDoc) !== document$1) {\n      setDocument(context);\n    }\n\n    context = context || document$1;\n    results = results || [];\n\n    if (!selector || typeof selector !== 'string') {\n      return results;\n    }\n\n    if ((nodeType = context.nodeType) !== 1 && nodeType !== 9) {\n      return [];\n    }\n\n    if (documentIsHTML && !seed) {\n      if (match = rquickExpr.exec(selector)) {\n        if (m = match[1]) {\n          if (nodeType === 9) {\n            elem = context.getElementById(m);\n\n            if (elem && elem.parentNode) {\n              if (elem.id === m) {\n                results.push(elem);\n                return results;\n              }\n            } else {\n              return results;\n            }\n          } else {\n            if (context.ownerDocument && (elem = context.ownerDocument.getElementById(m)) && contains$3(context, elem) && elem.id === m) {\n              results.push(elem);\n              return results;\n            }\n          }\n        } else if (match[2]) {\n          push.apply(results, context.getElementsByTagName(selector));\n          return results;\n        } else if ((m = match[3]) && support.getElementsByClassName) {\n          push.apply(results, context.getElementsByClassName(m));\n          return results;\n        }\n      }\n\n      if (support.qsa && (!rbuggyQSA || !rbuggyQSA.test(selector))) {\n        nid = old = expando;\n        newContext = context;\n        newSelector = nodeType === 9 && selector;\n\n        if (nodeType === 1 && context.nodeName.toLowerCase() !== 'object') {\n          groups = tokenize(selector);\n\n          if (old = context.getAttribute('id')) {\n            nid = old.replace(rescape, '\\\\$&');\n          } else {\n            context.setAttribute('id', nid);\n          }\n\n          nid = '[id=\\'' + nid + '\\'] ';\n          i = groups.length;\n\n          while (i--) {\n            groups[i] = nid + toSelector(groups[i]);\n          }\n\n          newContext = rsibling.test(selector) && testContext(context.parentNode) || context;\n          newSelector = groups.join(',');\n        }\n\n        if (newSelector) {\n          try {\n            push.apply(results, newContext.querySelectorAll(newSelector));\n            return results;\n          } catch (qsaError) {} finally {\n            if (!old) {\n              context.removeAttribute('id');\n            }\n          }\n        }\n      }\n    }\n\n    return select(selector.replace(rtrim, '$1'), context, results, seed);\n  };\n\n  function createCache() {\n    var keys = [];\n\n    function cache(key, value) {\n      if (keys.push(key + ' ') > Expr.cacheLength) {\n        delete cache[keys.shift()];\n      }\n\n      return cache[key + ' '] = value;\n    }\n\n    return cache;\n  }\n\n  function markFunction(fn) {\n    fn[expando] = true;\n    return fn;\n  }\n\n  function siblingCheck(a, b) {\n    var cur = b && a,\n        diff = cur && a.nodeType === 1 && b.nodeType === 1 && (~b.sourceIndex || MAX_NEGATIVE) - (~a.sourceIndex || MAX_NEGATIVE);\n\n    if (diff) {\n      return diff;\n    }\n\n    if (cur) {\n      while (cur = cur.nextSibling) {\n        if (cur === b) {\n          return -1;\n        }\n      }\n    }\n\n    return a ? 1 : -1;\n  }\n\n  function createInputPseudo(type) {\n    return function (elem) {\n      var name = elem.nodeName.toLowerCase();\n      return name === 'input' && elem.type === type;\n    };\n  }\n\n  function createButtonPseudo(type) {\n    return function (elem) {\n      var name = elem.nodeName.toLowerCase();\n      return (name === 'input' || name === 'button') && elem.type === type;\n    };\n  }\n\n  function createPositionalPseudo(fn) {\n    return markFunction(function (argument) {\n      argument = +argument;\n      return markFunction(function (seed, matches) {\n        var j,\n            matchIndexes = fn([], seed.length, argument),\n            i = matchIndexes.length;\n\n        while (i--) {\n          if (seed[j = matchIndexes[i]]) {\n            seed[j] = !(matches[j] = seed[j]);\n          }\n        }\n      });\n    });\n  }\n\n  function testContext(context) {\n    return context && typeof context.getElementsByTagName !== strundefined && context;\n  }\n\n  support = Sizzle.support = {};\n\n  isXML = Sizzle.isXML = function (elem) {\n    var documentElement = elem && (elem.ownerDocument || elem).documentElement;\n    return documentElement ? documentElement.nodeName !== 'HTML' : false;\n  };\n\n  setDocument = Sizzle.setDocument = function (node) {\n    var hasCompare,\n        doc = node ? node.ownerDocument || node : preferredDoc,\n        parent = doc.defaultView;\n\n    function getTop(win) {\n      try {\n        return win.top;\n      } catch (ex) {}\n\n      return null;\n    }\n\n    if (doc === document$1 || doc.nodeType !== 9 || !doc.documentElement) {\n      return document$1;\n    }\n\n    document$1 = doc;\n    docElem = doc.documentElement;\n    documentIsHTML = !isXML(doc);\n\n    if (parent && parent !== getTop(parent)) {\n      if (parent.addEventListener) {\n        parent.addEventListener('unload', function () {\n          setDocument();\n        }, false);\n      } else if (parent.attachEvent) {\n        parent.attachEvent('onunload', function () {\n          setDocument();\n        });\n      }\n    }\n\n    support.attributes = true;\n    support.getElementsByTagName = true;\n    support.getElementsByClassName = rnative.test(doc.getElementsByClassName);\n    support.getById = true;\n\n    Expr.find.ID = function (id, context) {\n      if (typeof context.getElementById !== strundefined && documentIsHTML) {\n        var m = context.getElementById(id);\n        return m && m.parentNode ? [m] : [];\n      }\n    };\n\n    Expr.filter.ID = function (id) {\n      var attrId = id.replace(runescape, funescape);\n      return function (elem) {\n        return elem.getAttribute('id') === attrId;\n      };\n    };\n\n    Expr.find.TAG = support.getElementsByTagName ? function (tag, context) {\n      if (typeof context.getElementsByTagName !== strundefined) {\n        return context.getElementsByTagName(tag);\n      }\n    } : function (tag, context) {\n      var elem,\n          tmp = [],\n          i = 0,\n          results = context.getElementsByTagName(tag);\n\n      if (tag === '*') {\n        while (elem = results[i++]) {\n          if (elem.nodeType === 1) {\n            tmp.push(elem);\n          }\n        }\n\n        return tmp;\n      }\n\n      return results;\n    };\n\n    Expr.find.CLASS = support.getElementsByClassName && function (className, context) {\n      if (documentIsHTML) {\n        return context.getElementsByClassName(className);\n      }\n    };\n\n    rbuggyMatches = [];\n    rbuggyQSA = [];\n    support.disconnectedMatch = true;\n    rbuggyQSA = rbuggyQSA.length && new RegExp(rbuggyQSA.join('|'));\n    rbuggyMatches = rbuggyMatches.length && new RegExp(rbuggyMatches.join('|'));\n    hasCompare = rnative.test(docElem.compareDocumentPosition);\n    contains$3 = hasCompare || rnative.test(docElem.contains) ? function (a, b) {\n      var adown = a.nodeType === 9 ? a.documentElement : a,\n          bup = b && b.parentNode;\n      return a === bup || !!(bup && bup.nodeType === 1 && (adown.contains ? adown.contains(bup) : a.compareDocumentPosition && a.compareDocumentPosition(bup) & 16));\n    } : function (a, b) {\n      if (b) {\n        while (b = b.parentNode) {\n          if (b === a) {\n            return true;\n          }\n        }\n      }\n\n      return false;\n    };\n    sortOrder = hasCompare ? function (a, b) {\n      if (a === b) {\n        hasDuplicate = true;\n        return 0;\n      }\n\n      var compare = !a.compareDocumentPosition - !b.compareDocumentPosition;\n\n      if (compare) {\n        return compare;\n      }\n\n      compare = (a.ownerDocument || a) === (b.ownerDocument || b) ? a.compareDocumentPosition(b) : 1;\n\n      if (compare & 1 || !support.sortDetached && b.compareDocumentPosition(a) === compare) {\n        if (a === doc || a.ownerDocument === preferredDoc && contains$3(preferredDoc, a)) {\n          return -1;\n        }\n\n        if (b === doc || b.ownerDocument === preferredDoc && contains$3(preferredDoc, b)) {\n          return 1;\n        }\n\n        return sortInput ? indexOf$2.call(sortInput, a) - indexOf$2.call(sortInput, b) : 0;\n      }\n\n      return compare & 4 ? -1 : 1;\n    } : function (a, b) {\n      if (a === b) {\n        hasDuplicate = true;\n        return 0;\n      }\n\n      var cur,\n          i = 0,\n          aup = a.parentNode,\n          bup = b.parentNode,\n          ap = [a],\n          bp = [b];\n\n      if (!aup || !bup) {\n        return a === doc ? -1 : b === doc ? 1 : aup ? -1 : bup ? 1 : sortInput ? indexOf$2.call(sortInput, a) - indexOf$2.call(sortInput, b) : 0;\n      } else if (aup === bup) {\n        return siblingCheck(a, b);\n      }\n\n      cur = a;\n\n      while (cur = cur.parentNode) {\n        ap.unshift(cur);\n      }\n\n      cur = b;\n\n      while (cur = cur.parentNode) {\n        bp.unshift(cur);\n      }\n\n      while (ap[i] === bp[i]) {\n        i++;\n      }\n\n      return i ? siblingCheck(ap[i], bp[i]) : ap[i] === preferredDoc ? -1 : bp[i] === preferredDoc ? 1 : 0;\n    };\n    return doc;\n  };\n\n  Sizzle.matches = function (expr, elements) {\n    return Sizzle(expr, null, null, elements);\n  };\n\n  Sizzle.matchesSelector = function (elem, expr) {\n    if ((elem.ownerDocument || elem) !== document$1) {\n      setDocument(elem);\n    }\n\n    expr = expr.replace(rattributeQuotes, '=\\'$1\\']');\n\n    if (support.matchesSelector && documentIsHTML && (!rbuggyMatches || !rbuggyMatches.test(expr)) && (!rbuggyQSA || !rbuggyQSA.test(expr))) {\n      try {\n        var ret = matches.call(elem, expr);\n\n        if (ret || support.disconnectedMatch || elem.document && elem.document.nodeType !== 11) {\n          return ret;\n        }\n      } catch (e) {}\n    }\n\n    return Sizzle(expr, document$1, null, [elem]).length > 0;\n  };\n\n  Sizzle.contains = function (context, elem) {\n    if ((context.ownerDocument || context) !== document$1) {\n      setDocument(context);\n    }\n\n    return contains$3(context, elem);\n  };\n\n  Sizzle.attr = function (elem, name) {\n    if ((elem.ownerDocument || elem) !== document$1) {\n      setDocument(elem);\n    }\n\n    var fn = Expr.attrHandle[name.toLowerCase()],\n        val = fn && hasOwn.call(Expr.attrHandle, name.toLowerCase()) ? fn(elem, name, !documentIsHTML) : undefined;\n    return val !== undefined ? val : support.attributes || !documentIsHTML ? elem.getAttribute(name) : (val = elem.getAttributeNode(name)) && val.specified ? val.value : null;\n  };\n\n  Sizzle.error = function (msg) {\n    throw new Error('Syntax error, unrecognized expression: ' + msg);\n  };\n\n  Sizzle.uniqueSort = function (results) {\n    var elem,\n        duplicates = [],\n        j = 0,\n        i = 0;\n    hasDuplicate = !support.detectDuplicates;\n    sortInput = !support.sortStable && results.slice(0);\n    results.sort(sortOrder);\n\n    if (hasDuplicate) {\n      while (elem = results[i++]) {\n        if (elem === results[i]) {\n          j = duplicates.push(i);\n        }\n      }\n\n      while (j--) {\n        results.splice(duplicates[j], 1);\n      }\n    }\n\n    sortInput = null;\n    return results;\n  };\n\n  getText = Sizzle.getText = function (elem) {\n    var node,\n        ret = '',\n        i = 0,\n        nodeType = elem.nodeType;\n\n    if (!nodeType) {\n      while (node = elem[i++]) {\n        ret += getText(node);\n      }\n    } else if (nodeType === 1 || nodeType === 9 || nodeType === 11) {\n      if (typeof elem.textContent === 'string') {\n        return elem.textContent;\n      } else {\n        for (elem = elem.firstChild; elem; elem = elem.nextSibling) {\n          ret += getText(elem);\n        }\n      }\n    } else if (nodeType === 3 || nodeType === 4) {\n      return elem.nodeValue;\n    }\n\n    return ret;\n  };\n\n  Expr = Sizzle.selectors = {\n    cacheLength: 50,\n    createPseudo: markFunction,\n    match: matchExpr,\n    attrHandle: {},\n    find: {},\n    relative: {\n      '>': {\n        dir: 'parentNode',\n        first: true\n      },\n      ' ': {\n        dir: 'parentNode'\n      },\n      '+': {\n        dir: 'previousSibling',\n        first: true\n      },\n      '~': {\n        dir: 'previousSibling'\n      }\n    },\n    preFilter: {\n      ATTR: function (match) {\n        match[1] = match[1].replace(runescape, funescape);\n        match[3] = (match[3] || match[4] || match[5] || '').replace(runescape, funescape);\n\n        if (match[2] === '~=') {\n          match[3] = ' ' + match[3] + ' ';\n        }\n\n        return match.slice(0, 4);\n      },\n      CHILD: function (match) {\n        match[1] = match[1].toLowerCase();\n\n        if (match[1].slice(0, 3) === 'nth') {\n          if (!match[3]) {\n            Sizzle.error(match[0]);\n          }\n\n          match[4] = +(match[4] ? match[5] + (match[6] || 1) : 2 * (match[3] === 'even' || match[3] === 'odd'));\n          match[5] = +(match[7] + match[8] || match[3] === 'odd');\n        } else if (match[3]) {\n          Sizzle.error(match[0]);\n        }\n\n        return match;\n      },\n      PSEUDO: function (match) {\n        var excess,\n            unquoted = !match[6] && match[2];\n\n        if (matchExpr.CHILD.test(match[0])) {\n          return null;\n        }\n\n        if (match[3]) {\n          match[2] = match[4] || match[5] || '';\n        } else if (unquoted && rpseudo.test(unquoted) && (excess = tokenize(unquoted, true)) && (excess = unquoted.indexOf(')', unquoted.length - excess) - unquoted.length)) {\n          match[0] = match[0].slice(0, excess);\n          match[2] = unquoted.slice(0, excess);\n        }\n\n        return match.slice(0, 3);\n      }\n    },\n    filter: {\n      TAG: function (nodeNameSelector) {\n        var nodeName = nodeNameSelector.replace(runescape, funescape).toLowerCase();\n        return nodeNameSelector === '*' ? function () {\n          return true;\n        } : function (elem) {\n          return elem.nodeName && elem.nodeName.toLowerCase() === nodeName;\n        };\n      },\n      CLASS: function (className) {\n        var pattern = classCache[className + ' '];\n        return pattern || (pattern = new RegExp('(^|' + whitespace + ')' + className + '(' + whitespace + '|$)')) && classCache(className, function (elem) {\n          return pattern.test(typeof elem.className === 'string' && elem.className || typeof elem.getAttribute !== strundefined && elem.getAttribute('class') || '');\n        });\n      },\n      ATTR: function (name, operator, check) {\n        return function (elem) {\n          var result = Sizzle.attr(elem, name);\n\n          if (result == null) {\n            return operator === '!=';\n          }\n\n          if (!operator) {\n            return true;\n          }\n\n          result += '';\n          return operator === '=' ? result === check : operator === '!=' ? result !== check : operator === '^=' ? check && result.indexOf(check) === 0 : operator === '*=' ? check && result.indexOf(check) > -1 : operator === '$=' ? check && result.slice(-check.length) === check : operator === '~=' ? (' ' + result + ' ').indexOf(check) > -1 : operator === '|=' ? result === check || result.slice(0, check.length + 1) === check + '-' : false;\n        };\n      },\n      CHILD: function (type, what, argument, first, last) {\n        var simple = type.slice(0, 3) !== 'nth',\n            forward = type.slice(-4) !== 'last',\n            ofType = what === 'of-type';\n        return first === 1 && last === 0 ? function (elem) {\n          return !!elem.parentNode;\n        } : function (elem, context, xml) {\n          var cache,\n              outerCache,\n              node,\n              diff,\n              nodeIndex,\n              start,\n              dir = simple !== forward ? 'nextSibling' : 'previousSibling',\n              parent = elem.parentNode,\n              name = ofType && elem.nodeName.toLowerCase(),\n              useCache = !xml && !ofType;\n\n          if (parent) {\n            if (simple) {\n              while (dir) {\n                node = elem;\n\n                while (node = node[dir]) {\n                  if (ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1) {\n                    return false;\n                  }\n                }\n\n                start = dir = type === 'only' && !start && 'nextSibling';\n              }\n\n              return true;\n            }\n\n            start = [forward ? parent.firstChild : parent.lastChild];\n\n            if (forward && useCache) {\n              outerCache = parent[expando] || (parent[expando] = {});\n              cache = outerCache[type] || [];\n              nodeIndex = cache[0] === dirruns && cache[1];\n              diff = cache[0] === dirruns && cache[2];\n              node = nodeIndex && parent.childNodes[nodeIndex];\n\n              while (node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop()) {\n                if (node.nodeType === 1 && ++diff && node === elem) {\n                  outerCache[type] = [dirruns, nodeIndex, diff];\n                  break;\n                }\n              }\n            } else if (useCache && (cache = (elem[expando] || (elem[expando] = {}))[type]) && cache[0] === dirruns) {\n              diff = cache[1];\n            } else {\n              while (node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop()) {\n                if ((ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1) && ++diff) {\n                  if (useCache) {\n                    (node[expando] || (node[expando] = {}))[type] = [dirruns, diff];\n                  }\n\n                  if (node === elem) {\n                    break;\n                  }\n                }\n              }\n            }\n\n            diff -= last;\n            return diff === first || diff % first === 0 && diff / first >= 0;\n          }\n        };\n      },\n      PSEUDO: function (pseudo, argument) {\n        var args,\n            fn = Expr.pseudos[pseudo] || Expr.setFilters[pseudo.toLowerCase()] || Sizzle.error('unsupported pseudo: ' + pseudo);\n\n        if (fn[expando]) {\n          return fn(argument);\n        }\n\n        if (fn.length > 1) {\n          args = [pseudo, pseudo, '', argument];\n          return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase()) ? markFunction(function (seed, matches) {\n            var idx,\n                matched = fn(seed, argument),\n                i = matched.length;\n\n            while (i--) {\n              idx = indexOf$2.call(seed, matched[i]);\n              seed[idx] = !(matches[idx] = matched[i]);\n            }\n          }) : function (elem) {\n            return fn(elem, 0, args);\n          };\n        }\n\n        return fn;\n      }\n    },\n    pseudos: {\n      not: markFunction(function (selector) {\n        var input = [],\n            results = [],\n            matcher = compile(selector.replace(rtrim, '$1'));\n        return matcher[expando] ? markFunction(function (seed, matches, context, xml) {\n          var elem,\n              unmatched = matcher(seed, null, xml, []),\n              i = seed.length;\n\n          while (i--) {\n            if (elem = unmatched[i]) {\n              seed[i] = !(matches[i] = elem);\n            }\n          }\n        }) : function (elem, context, xml) {\n          input[0] = elem;\n          matcher(input, null, xml, results);\n          input[0] = null;\n          return !results.pop();\n        };\n      }),\n      has: markFunction(function (selector) {\n        return function (elem) {\n          return Sizzle(selector, elem).length > 0;\n        };\n      }),\n      contains: markFunction(function (text) {\n        text = text.replace(runescape, funescape);\n        return function (elem) {\n          return (elem.textContent || elem.innerText || getText(elem)).indexOf(text) > -1;\n        };\n      }),\n      lang: markFunction(function (lang) {\n        if (!ridentifier.test(lang || '')) {\n          Sizzle.error('unsupported lang: ' + lang);\n        }\n\n        lang = lang.replace(runescape, funescape).toLowerCase();\n        return function (elem) {\n          var elemLang;\n\n          do {\n            if (elemLang = documentIsHTML ? elem.lang : elem.getAttribute('xml:lang') || elem.getAttribute('lang')) {\n              elemLang = elemLang.toLowerCase();\n              return elemLang === lang || elemLang.indexOf(lang + '-') === 0;\n            }\n          } while ((elem = elem.parentNode) && elem.nodeType === 1);\n\n          return false;\n        };\n      }),\n      target: function (elem) {\n        var hash = window.location && window.location.hash;\n        return hash && hash.slice(1) === elem.id;\n      },\n      root: function (elem) {\n        return elem === docElem;\n      },\n      focus: function (elem) {\n        return elem === document$1.activeElement && (!document$1.hasFocus || document$1.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);\n      },\n      enabled: function (elem) {\n        return elem.disabled === false;\n      },\n      disabled: function (elem) {\n        return elem.disabled === true;\n      },\n      checked: function (elem) {\n        var nodeName = elem.nodeName.toLowerCase();\n        return nodeName === 'input' && !!elem.checked || nodeName === 'option' && !!elem.selected;\n      },\n      selected: function (elem) {\n        if (elem.parentNode) {\n          elem.parentNode.selectedIndex;\n        }\n\n        return elem.selected === true;\n      },\n      empty: function (elem) {\n        for (elem = elem.firstChild; elem; elem = elem.nextSibling) {\n          if (elem.nodeType < 6) {\n            return false;\n          }\n        }\n\n        return true;\n      },\n      parent: function (elem) {\n        return !Expr.pseudos.empty(elem);\n      },\n      header: function (elem) {\n        return rheader.test(elem.nodeName);\n      },\n      input: function (elem) {\n        return rinputs.test(elem.nodeName);\n      },\n      button: function (elem) {\n        var name = elem.nodeName.toLowerCase();\n        return name === 'input' && elem.type === 'button' || name === 'button';\n      },\n      text: function (elem) {\n        var attr;\n        return elem.nodeName.toLowerCase() === 'input' && elem.type === 'text' && ((attr = elem.getAttribute('type')) == null || attr.toLowerCase() === 'text');\n      },\n      first: createPositionalPseudo(function () {\n        return [0];\n      }),\n      last: createPositionalPseudo(function (matchIndexes, length) {\n        return [length - 1];\n      }),\n      eq: createPositionalPseudo(function (matchIndexes, length, argument) {\n        return [argument < 0 ? argument + length : argument];\n      }),\n      even: createPositionalPseudo(function (matchIndexes, length) {\n        var i = 0;\n\n        for (; i < length; i += 2) {\n          matchIndexes.push(i);\n        }\n\n        return matchIndexes;\n      }),\n      odd: createPositionalPseudo(function (matchIndexes, length) {\n        var i = 1;\n\n        for (; i < length; i += 2) {\n          matchIndexes.push(i);\n        }\n\n        return matchIndexes;\n      }),\n      lt: createPositionalPseudo(function (matchIndexes, length, argument) {\n        var i = argument < 0 ? argument + length : argument;\n\n        for (; --i >= 0;) {\n          matchIndexes.push(i);\n        }\n\n        return matchIndexes;\n      }),\n      gt: createPositionalPseudo(function (matchIndexes, length, argument) {\n        var i = argument < 0 ? argument + length : argument;\n\n        for (; ++i < length;) {\n          matchIndexes.push(i);\n        }\n\n        return matchIndexes;\n      })\n    }\n  };\n  Expr.pseudos.nth = Expr.pseudos.eq;\n  each(['radio', 'checkbox', 'file', 'password', 'image'], function (i) {\n    Expr.pseudos[i] = createInputPseudo(i);\n  });\n  each(['submit', 'reset'], function (i) {\n    Expr.pseudos[i] = createButtonPseudo(i);\n  });\n\n  function setFilters() {}\n\n  setFilters.prototype = Expr.filters = Expr.pseudos;\n  Expr.setFilters = new setFilters();\n\n  tokenize = Sizzle.tokenize = function (selector, parseOnly) {\n    var matched,\n        match,\n        tokens,\n        type,\n        soFar,\n        groups,\n        preFilters,\n        cached = tokenCache[selector + ' '];\n\n    if (cached) {\n      return parseOnly ? 0 : cached.slice(0);\n    }\n\n    soFar = selector;\n    groups = [];\n    preFilters = Expr.preFilter;\n\n    while (soFar) {\n      if (!matched || (match = rcomma.exec(soFar))) {\n        if (match) {\n          soFar = soFar.slice(match[0].length) || soFar;\n        }\n\n        groups.push(tokens = []);\n      }\n\n      matched = false;\n\n      if (match = rcombinators.exec(soFar)) {\n        matched = match.shift();\n        tokens.push({\n          value: matched,\n          type: match[0].replace(rtrim, ' ')\n        });\n        soFar = soFar.slice(matched.length);\n      }\n\n      for (type in Expr.filter) {\n        if (!Expr.filter.hasOwnProperty(type)) {\n          continue;\n        }\n\n        if ((match = matchExpr[type].exec(soFar)) && (!preFilters[type] || (match = preFilters[type](match)))) {\n          matched = match.shift();\n          tokens.push({\n            value: matched,\n            type: type,\n            matches: match\n          });\n          soFar = soFar.slice(matched.length);\n        }\n      }\n\n      if (!matched) {\n        break;\n      }\n    }\n\n    return parseOnly ? soFar.length : soFar ? Sizzle.error(selector) : tokenCache(selector, groups).slice(0);\n  };\n\n  function toSelector(tokens) {\n    var i = 0,\n        len = tokens.length,\n        selector = '';\n\n    for (; i < len; i++) {\n      selector += tokens[i].value;\n    }\n\n    return selector;\n  }\n\n  function addCombinator(matcher, combinator, base) {\n    var dir = combinator.dir,\n        checkNonElements = base && dir === 'parentNode',\n        doneName = done++;\n    return combinator.first ? function (elem, context, xml) {\n      while (elem = elem[dir]) {\n        if (elem.nodeType === 1 || checkNonElements) {\n          return matcher(elem, context, xml);\n        }\n      }\n    } : function (elem, context, xml) {\n      var oldCache,\n          outerCache,\n          newCache = [dirruns, doneName];\n\n      if (xml) {\n        while (elem = elem[dir]) {\n          if (elem.nodeType === 1 || checkNonElements) {\n            if (matcher(elem, context, xml)) {\n              return true;\n            }\n          }\n        }\n      } else {\n        while (elem = elem[dir]) {\n          if (elem.nodeType === 1 || checkNonElements) {\n            outerCache = elem[expando] || (elem[expando] = {});\n\n            if ((oldCache = outerCache[dir]) && oldCache[0] === dirruns && oldCache[1] === doneName) {\n              return newCache[2] = oldCache[2];\n            } else {\n              outerCache[dir] = newCache;\n\n              if (newCache[2] = matcher(elem, context, xml)) {\n                return true;\n              }\n            }\n          }\n        }\n      }\n    };\n  }\n\n  function elementMatcher(matchers) {\n    return matchers.length > 1 ? function (elem, context, xml) {\n      var i = matchers.length;\n\n      while (i--) {\n        if (!matchers[i](elem, context, xml)) {\n          return false;\n        }\n      }\n\n      return true;\n    } : matchers[0];\n  }\n\n  function multipleContexts(selector, contexts, results) {\n    var i = 0,\n        len = contexts.length;\n\n    for (; i < len; i++) {\n      Sizzle(selector, contexts[i], results);\n    }\n\n    return results;\n  }\n\n  function condense(unmatched, map, filter, context, xml) {\n    var elem,\n        newUnmatched = [],\n        i = 0,\n        len = unmatched.length,\n        mapped = map != null;\n\n    for (; i < len; i++) {\n      if (elem = unmatched[i]) {\n        if (!filter || filter(elem, context, xml)) {\n          newUnmatched.push(elem);\n\n          if (mapped) {\n            map.push(i);\n          }\n        }\n      }\n    }\n\n    return newUnmatched;\n  }\n\n  function setMatcher(preFilter, selector, matcher, postFilter, postFinder, postSelector) {\n    if (postFilter && !postFilter[expando]) {\n      postFilter = setMatcher(postFilter);\n    }\n\n    if (postFinder && !postFinder[expando]) {\n      postFinder = setMatcher(postFinder, postSelector);\n    }\n\n    return markFunction(function (seed, results, context, xml) {\n      var temp,\n          i,\n          elem,\n          preMap = [],\n          postMap = [],\n          preexisting = results.length,\n          elems = seed || multipleContexts(selector || '*', context.nodeType ? [context] : context, []),\n          matcherIn = preFilter && (seed || !selector) ? condense(elems, preMap, preFilter, context, xml) : elems,\n          matcherOut = matcher ? postFinder || (seed ? preFilter : preexisting || postFilter) ? [] : results : matcherIn;\n\n      if (matcher) {\n        matcher(matcherIn, matcherOut, context, xml);\n      }\n\n      if (postFilter) {\n        temp = condense(matcherOut, postMap);\n        postFilter(temp, [], context, xml);\n        i = temp.length;\n\n        while (i--) {\n          if (elem = temp[i]) {\n            matcherOut[postMap[i]] = !(matcherIn[postMap[i]] = elem);\n          }\n        }\n      }\n\n      if (seed) {\n        if (postFinder || preFilter) {\n          if (postFinder) {\n            temp = [];\n            i = matcherOut.length;\n\n            while (i--) {\n              if (elem = matcherOut[i]) {\n                temp.push(matcherIn[i] = elem);\n              }\n            }\n\n            postFinder(null, matcherOut = [], temp, xml);\n          }\n\n          i = matcherOut.length;\n\n          while (i--) {\n            if ((elem = matcherOut[i]) && (temp = postFinder ? indexOf$2.call(seed, elem) : preMap[i]) > -1) {\n              seed[temp] = !(results[temp] = elem);\n            }\n          }\n        }\n      } else {\n        matcherOut = condense(matcherOut === results ? matcherOut.splice(preexisting, matcherOut.length) : matcherOut);\n\n        if (postFinder) {\n          postFinder(null, results, matcherOut, xml);\n        } else {\n          push.apply(results, matcherOut);\n        }\n      }\n    });\n  }\n\n  function matcherFromTokens(tokens) {\n    var checkContext,\n        matcher,\n        j,\n        len = tokens.length,\n        leadingRelative = Expr.relative[tokens[0].type],\n        implicitRelative = leadingRelative || Expr.relative[' '],\n        i = leadingRelative ? 1 : 0,\n        matchContext = addCombinator(function (elem) {\n      return elem === checkContext;\n    }, implicitRelative, true),\n        matchAnyContext = addCombinator(function (elem) {\n      return indexOf$2.call(checkContext, elem) > -1;\n    }, implicitRelative, true),\n        matchers = [function (elem, context, xml) {\n      var ret = !leadingRelative && (xml || context !== outermostContext) || ((checkContext = context).nodeType ? matchContext(elem, context, xml) : matchAnyContext(elem, context, xml));\n      checkContext = null;\n      return ret;\n    }];\n\n    for (; i < len; i++) {\n      if (matcher = Expr.relative[tokens[i].type]) {\n        matchers = [addCombinator(elementMatcher(matchers), matcher)];\n      } else {\n        matcher = Expr.filter[tokens[i].type].apply(null, tokens[i].matches);\n\n        if (matcher[expando]) {\n          j = ++i;\n\n          for (; j < len; j++) {\n            if (Expr.relative[tokens[j].type]) {\n              break;\n            }\n          }\n\n          return setMatcher(i > 1 && elementMatcher(matchers), i > 1 && toSelector(tokens.slice(0, i - 1).concat({\n            value: tokens[i - 2].type === ' ' ? '*' : ''\n          })).replace(rtrim, '$1'), matcher, i < j && matcherFromTokens(tokens.slice(i, j)), j < len && matcherFromTokens(tokens = tokens.slice(j)), j < len && toSelector(tokens));\n        }\n\n        matchers.push(matcher);\n      }\n    }\n\n    return elementMatcher(matchers);\n  }\n\n  function matcherFromGroupMatchers(elementMatchers, setMatchers) {\n    var bySet = setMatchers.length > 0,\n        byElement = elementMatchers.length > 0,\n        superMatcher = function (seed, context, xml, results, outermost) {\n      var elem,\n          j,\n          matcher,\n          matchedCount = 0,\n          i = '0',\n          unmatched = seed && [],\n          setMatched = [],\n          contextBackup = outermostContext,\n          elems = seed || byElement && Expr.find.TAG('*', outermost),\n          dirrunsUnique = dirruns += contextBackup == null ? 1 : Math.random() || 0.1,\n          len = elems.length;\n\n      if (outermost) {\n        outermostContext = context !== document$1 && context;\n      }\n\n      for (; i !== len && (elem = elems[i]) != null; i++) {\n        if (byElement && elem) {\n          j = 0;\n\n          while (matcher = elementMatchers[j++]) {\n            if (matcher(elem, context, xml)) {\n              results.push(elem);\n              break;\n            }\n          }\n\n          if (outermost) {\n            dirruns = dirrunsUnique;\n          }\n        }\n\n        if (bySet) {\n          if (elem = !matcher && elem) {\n            matchedCount--;\n          }\n\n          if (seed) {\n            unmatched.push(elem);\n          }\n        }\n      }\n\n      matchedCount += i;\n\n      if (bySet && i !== matchedCount) {\n        j = 0;\n\n        while (matcher = setMatchers[j++]) {\n          matcher(unmatched, setMatched, context, xml);\n        }\n\n        if (seed) {\n          if (matchedCount > 0) {\n            while (i--) {\n              if (!(unmatched[i] || setMatched[i])) {\n                setMatched[i] = pop.call(results);\n              }\n            }\n          }\n\n          setMatched = condense(setMatched);\n        }\n\n        push.apply(results, setMatched);\n\n        if (outermost && !seed && setMatched.length > 0 && matchedCount + setMatchers.length > 1) {\n          Sizzle.uniqueSort(results);\n        }\n      }\n\n      if (outermost) {\n        dirruns = dirrunsUnique;\n        outermostContext = contextBackup;\n      }\n\n      return unmatched;\n    };\n\n    return bySet ? markFunction(superMatcher) : superMatcher;\n  }\n\n  compile = Sizzle.compile = function (selector, match) {\n    var i,\n        setMatchers = [],\n        elementMatchers = [],\n        cached = compilerCache[selector + ' '];\n\n    if (!cached) {\n      if (!match) {\n        match = tokenize(selector);\n      }\n\n      i = match.length;\n\n      while (i--) {\n        cached = matcherFromTokens(match[i]);\n\n        if (cached[expando]) {\n          setMatchers.push(cached);\n        } else {\n          elementMatchers.push(cached);\n        }\n      }\n\n      cached = compilerCache(selector, matcherFromGroupMatchers(elementMatchers, setMatchers));\n      cached.selector = selector;\n    }\n\n    return cached;\n  };\n\n  select = Sizzle.select = function (selector, context, results, seed) {\n    var i,\n        tokens,\n        token,\n        type,\n        find,\n        compiled = typeof selector === 'function' && selector,\n        match = !seed && tokenize(selector = compiled.selector || selector);\n    results = results || [];\n\n    if (match.length === 1) {\n      tokens = match[0] = match[0].slice(0);\n\n      if (tokens.length > 2 && (token = tokens[0]).type === 'ID' && support.getById && context.nodeType === 9 && documentIsHTML && Expr.relative[tokens[1].type]) {\n        context = (Expr.find.ID(token.matches[0].replace(runescape, funescape), context) || [])[0];\n\n        if (!context) {\n          return results;\n        } else if (compiled) {\n          context = context.parentNode;\n        }\n\n        selector = selector.slice(tokens.shift().value.length);\n      }\n\n      i = matchExpr.needsContext.test(selector) ? 0 : tokens.length;\n\n      while (i--) {\n        token = tokens[i];\n\n        if (Expr.relative[type = token.type]) {\n          break;\n        }\n\n        if (find = Expr.find[type]) {\n          if (seed = find(token.matches[0].replace(runescape, funescape), rsibling.test(tokens[0].type) && testContext(context.parentNode) || context)) {\n            tokens.splice(i, 1);\n            selector = seed.length && toSelector(tokens);\n\n            if (!selector) {\n              push.apply(results, seed);\n              return results;\n            }\n\n            break;\n          }\n        }\n      }\n    }\n\n    (compiled || compile(selector, match))(seed, context, !documentIsHTML, results, rsibling.test(selector) && testContext(context.parentNode) || context);\n    return results;\n  };\n\n  support.sortStable = expando.split('').sort(sortOrder).join('') === expando;\n  support.detectDuplicates = !!hasDuplicate;\n  setDocument();\n  support.sortDetached = true;\n  var doc = document;\n  var push$1 = Array.prototype.push;\n  var slice$1 = Array.prototype.slice;\n  var rquickExpr$1 = /^(?:[^#<]*(<[\\w\\W]+>)[^>]*$|#([\\w\\-]*)$)/;\n  var Event = EventUtils.Event;\n  var skipUniques = Tools.makeMap('children,contents,next,prev');\n\n  var isDefined = function (obj) {\n    return typeof obj !== 'undefined';\n  };\n\n  var isString$1 = function (obj) {\n    return typeof obj === 'string';\n  };\n\n  var isWindow = function (obj) {\n    return obj && obj === obj.window;\n  };\n\n  var createFragment = function (html, fragDoc) {\n    fragDoc = fragDoc || doc;\n    var container = fragDoc.createElement('div');\n    var frag = fragDoc.createDocumentFragment();\n    container.innerHTML = html;\n    var node;\n\n    while (node = container.firstChild) {\n      frag.appendChild(node);\n    }\n\n    return frag;\n  };\n\n  var domManipulate = function (targetNodes, sourceItem, callback, reverse) {\n    var i;\n\n    if (isString$1(sourceItem)) {\n      sourceItem = createFragment(sourceItem, getElementDocument(targetNodes[0]));\n    } else if (sourceItem.length && !sourceItem.nodeType) {\n      sourceItem = DomQuery.makeArray(sourceItem);\n\n      if (reverse) {\n        for (i = sourceItem.length - 1; i >= 0; i--) {\n          domManipulate(targetNodes, sourceItem[i], callback, reverse);\n        }\n      } else {\n        for (i = 0; i < sourceItem.length; i++) {\n          domManipulate(targetNodes, sourceItem[i], callback, reverse);\n        }\n      }\n\n      return targetNodes;\n    }\n\n    if (sourceItem.nodeType) {\n      i = targetNodes.length;\n\n      while (i--) {\n        callback.call(targetNodes[i], sourceItem);\n      }\n    }\n\n    return targetNodes;\n  };\n\n  var hasClass = function (node, className) {\n    return node && className && (' ' + node.className + ' ').indexOf(' ' + className + ' ') !== -1;\n  };\n\n  var wrap$1 = function (elements, wrapper, all) {\n    var lastParent, newWrapper;\n    wrapper = DomQuery(wrapper)[0];\n    elements.each(function () {\n      var self = this;\n\n      if (!all || lastParent !== self.parentNode) {\n        lastParent = self.parentNode;\n        newWrapper = wrapper.cloneNode(false);\n        self.parentNode.insertBefore(newWrapper, self);\n        newWrapper.appendChild(self);\n      } else {\n        newWrapper.appendChild(self);\n      }\n    });\n    return elements;\n  };\n\n  var numericCssMap = Tools.makeMap('fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom', ' ');\n  var booleanMap = Tools.makeMap('checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected', ' ');\n  var propFix = {\n    for: 'htmlFor',\n    class: 'className',\n    readonly: 'readOnly'\n  };\n  var cssFix = {\n    float: 'cssFloat'\n  };\n  var attrHooks = {},\n      cssHooks = {};\n\n  var DomQueryConstructor = function (selector, context) {\n    return new DomQuery.fn.init(selector, context);\n  };\n\n  var inArray$1 = function (item, array) {\n    var i;\n\n    if (array.indexOf) {\n      return array.indexOf(item);\n    }\n\n    i = array.length;\n\n    while (i--) {\n      if (array[i] === item) {\n        return i;\n      }\n    }\n\n    return -1;\n  };\n\n  var whiteSpaceRegExp$2 = /^\\s*|\\s*$/g;\n\n  var trim$3 = function (str) {\n    return str === null || str === undefined ? '' : ('' + str).replace(whiteSpaceRegExp$2, '');\n  };\n\n  var each$4 = function (obj, callback) {\n    var length, key, i, value;\n\n    if (obj) {\n      length = obj.length;\n\n      if (length === undefined) {\n        for (key in obj) {\n          if (obj.hasOwnProperty(key)) {\n            value = obj[key];\n\n            if (callback.call(value, key, value) === false) {\n              break;\n            }\n          }\n        }\n      } else {\n        for (i = 0; i < length; i++) {\n          value = obj[i];\n\n          if (callback.call(value, i, value) === false) {\n            break;\n          }\n        }\n      }\n    }\n\n    return obj;\n  };\n\n  var grep = function (array, callback) {\n    var out = [];\n    each$4(array, function (i, item) {\n      if (callback(item, i)) {\n        out.push(item);\n      }\n    });\n    return out;\n  };\n\n  var getElementDocument = function (element) {\n    if (!element) {\n      return doc;\n    }\n\n    if (element.nodeType === 9) {\n      return element;\n    }\n\n    return element.ownerDocument;\n  };\n\n  DomQueryConstructor.fn = DomQueryConstructor.prototype = {\n    constructor: DomQueryConstructor,\n    selector: '',\n    context: null,\n    length: 0,\n    init: function (selector, context) {\n      var self = this;\n      var match, node;\n\n      if (!selector) {\n        return self;\n      }\n\n      if (selector.nodeType) {\n        self.context = self[0] = selector;\n        self.length = 1;\n        return self;\n      }\n\n      if (context && context.nodeType) {\n        self.context = context;\n      } else {\n        if (context) {\n          return DomQuery(selector).attr(context);\n        }\n\n        self.context = context = document;\n      }\n\n      if (isString$1(selector)) {\n        self.selector = selector;\n\n        if (selector.charAt(0) === '<' && selector.charAt(selector.length - 1) === '>' && selector.length >= 3) {\n          match = [null, selector, null];\n        } else {\n          match = rquickExpr$1.exec(selector);\n        }\n\n        if (match) {\n          if (match[1]) {\n            node = createFragment(selector, getElementDocument(context)).firstChild;\n\n            while (node) {\n              push$1.call(self, node);\n              node = node.nextSibling;\n            }\n          } else {\n            node = getElementDocument(context).getElementById(match[2]);\n\n            if (!node) {\n              return self;\n            }\n\n            if (node.id !== match[2]) {\n              return self.find(selector);\n            }\n\n            self.length = 1;\n            self[0] = node;\n          }\n        } else {\n          return DomQuery(context).find(selector);\n        }\n      } else {\n        this.add(selector, false);\n      }\n\n      return self;\n    },\n    toArray: function () {\n      return Tools.toArray(this);\n    },\n    add: function (items, sort) {\n      var self = this;\n      var nodes, i;\n\n      if (isString$1(items)) {\n        return self.add(DomQuery(items));\n      }\n\n      if (sort !== false) {\n        nodes = DomQuery.unique(self.toArray().concat(DomQuery.makeArray(items)));\n        self.length = nodes.length;\n\n        for (i = 0; i < nodes.length; i++) {\n          self[i] = nodes[i];\n        }\n      } else {\n        push$1.apply(self, DomQuery.makeArray(items));\n      }\n\n      return self;\n    },\n    attr: function (name, value) {\n      var self = this;\n      var hook;\n\n      if (typeof name === 'object') {\n        each$4(name, function (name, value) {\n          self.attr(name, value);\n        });\n      } else if (isDefined(value)) {\n        this.each(function () {\n          var hook;\n\n          if (this.nodeType === 1) {\n            hook = attrHooks[name];\n\n            if (hook && hook.set) {\n              hook.set(this, value);\n              return;\n            }\n\n            if (value === null) {\n              this.removeAttribute(name, 2);\n            } else {\n              this.setAttribute(name, value, 2);\n            }\n          }\n        });\n      } else {\n        if (self[0] && self[0].nodeType === 1) {\n          hook = attrHooks[name];\n\n          if (hook && hook.get) {\n            return hook.get(self[0], name);\n          }\n\n          if (booleanMap[name]) {\n            return self.prop(name) ? name : undefined;\n          }\n\n          value = self[0].getAttribute(name, 2);\n\n          if (value === null) {\n            value = undefined;\n          }\n        }\n\n        return value;\n      }\n\n      return self;\n    },\n    removeAttr: function (name) {\n      return this.attr(name, null);\n    },\n    prop: function (name, value) {\n      var self = this;\n      name = propFix[name] || name;\n\n      if (typeof name === 'object') {\n        each$4(name, function (name, value) {\n          self.prop(name, value);\n        });\n      } else if (isDefined(value)) {\n        this.each(function () {\n          if (this.nodeType === 1) {\n            this[name] = value;\n          }\n        });\n      } else {\n        if (self[0] && self[0].nodeType && name in self[0]) {\n          return self[0][name];\n        }\n\n        return value;\n      }\n\n      return self;\n    },\n    css: function (name, value) {\n      var self = this;\n      var elm, hook;\n\n      var camel = function (name) {\n        return name.replace(/-(\\D)/g, function (a, b) {\n          return b.toUpperCase();\n        });\n      };\n\n      var dashed = function (name) {\n        return name.replace(/[A-Z]/g, function (a) {\n          return '-' + a;\n        });\n      };\n\n      if (typeof name === 'object') {\n        each$4(name, function (name, value) {\n          self.css(name, value);\n        });\n      } else {\n        if (isDefined(value)) {\n          name = camel(name);\n\n          if (typeof value === 'number' && !numericCssMap[name]) {\n            value = value.toString() + 'px';\n          }\n\n          self.each(function () {\n            var style = this.style;\n            hook = cssHooks[name];\n\n            if (hook && hook.set) {\n              hook.set(this, value);\n              return;\n            }\n\n            try {\n              this.style[cssFix[name] || name] = value;\n            } catch (ex) {}\n\n            if (value === null || value === '') {\n              if (style.removeProperty) {\n                style.removeProperty(dashed(name));\n              } else {\n                style.removeAttribute(name);\n              }\n            }\n          });\n        } else {\n          elm = self[0];\n          hook = cssHooks[name];\n\n          if (hook && hook.get) {\n            return hook.get(elm);\n          }\n\n          if (elm.ownerDocument.defaultView) {\n            try {\n              return elm.ownerDocument.defaultView.getComputedStyle(elm, null).getPropertyValue(dashed(name));\n            } catch (ex) {\n              return undefined;\n            }\n          } else if (elm.currentStyle) {\n            return elm.currentStyle[camel(name)];\n          } else {\n            return '';\n          }\n        }\n      }\n\n      return self;\n    },\n    remove: function () {\n      var self = this;\n      var node,\n          i = this.length;\n\n      while (i--) {\n        node = self[i];\n        Event.clean(node);\n\n        if (node.parentNode) {\n          node.parentNode.removeChild(node);\n        }\n      }\n\n      return this;\n    },\n    empty: function () {\n      var self = this;\n      var node,\n          i = this.length;\n\n      while (i--) {\n        node = self[i];\n\n        while (node.firstChild) {\n          node.removeChild(node.firstChild);\n        }\n      }\n\n      return this;\n    },\n    html: function (value) {\n      var self = this;\n      var i;\n\n      if (isDefined(value)) {\n        i = self.length;\n\n        try {\n          while (i--) {\n            self[i].innerHTML = value;\n          }\n        } catch (ex) {\n          DomQuery(self[i]).empty().append(value);\n        }\n\n        return self;\n      }\n\n      return self[0] ? self[0].innerHTML : '';\n    },\n    text: function (value) {\n      var self = this;\n      var i;\n\n      if (isDefined(value)) {\n        i = self.length;\n\n        while (i--) {\n          if ('innerText' in self[i]) {\n            self[i].innerText = value;\n          } else {\n            self[0].textContent = value;\n          }\n        }\n\n        return self;\n      }\n\n      return self[0] ? self[0].innerText || self[0].textContent : '';\n    },\n    append: function () {\n      return domManipulate(this, arguments, function (node) {\n        if (this.nodeType === 1 || this.host && this.host.nodeType === 1) {\n          this.appendChild(node);\n        }\n      });\n    },\n    prepend: function () {\n      return domManipulate(this, arguments, function (node) {\n        if (this.nodeType === 1 || this.host && this.host.nodeType === 1) {\n          this.insertBefore(node, this.firstChild);\n        }\n      }, true);\n    },\n    before: function () {\n      var self = this;\n\n      if (self[0] && self[0].parentNode) {\n        return domManipulate(self, arguments, function (node) {\n          this.parentNode.insertBefore(node, this);\n        });\n      }\n\n      return self;\n    },\n    after: function () {\n      var self = this;\n\n      if (self[0] && self[0].parentNode) {\n        return domManipulate(self, arguments, function (node) {\n          this.parentNode.insertBefore(node, this.nextSibling);\n        }, true);\n      }\n\n      return self;\n    },\n    appendTo: function (val) {\n      DomQuery(val).append(this);\n      return this;\n    },\n    prependTo: function (val) {\n      DomQuery(val).prepend(this);\n      return this;\n    },\n    replaceWith: function (content) {\n      return this.before(content).remove();\n    },\n    wrap: function (content) {\n      return wrap$1(this, content);\n    },\n    wrapAll: function (content) {\n      return wrap$1(this, content, true);\n    },\n    wrapInner: function (content) {\n      this.each(function () {\n        DomQuery(this).contents().wrapAll(content);\n      });\n      return this;\n    },\n    unwrap: function () {\n      return this.parent().each(function () {\n        DomQuery(this).replaceWith(this.childNodes);\n      });\n    },\n    clone: function () {\n      var result = [];\n      this.each(function () {\n        result.push(this.cloneNode(true));\n      });\n      return DomQuery(result);\n    },\n    addClass: function (className) {\n      return this.toggleClass(className, true);\n    },\n    removeClass: function (className) {\n      return this.toggleClass(className, false);\n    },\n    toggleClass: function (className, state) {\n      var self = this;\n\n      if (typeof className !== 'string') {\n        return self;\n      }\n\n      if (className.indexOf(' ') !== -1) {\n        each$4(className.split(' '), function () {\n          self.toggleClass(this, state);\n        });\n      } else {\n        self.each(function (index, node) {\n          var classState = hasClass(node, className);\n\n          if (classState !== state) {\n            var existingClassName = node.className;\n\n            if (classState) {\n              node.className = trim$3((' ' + existingClassName + ' ').replace(' ' + className + ' ', ' '));\n            } else {\n              node.className += existingClassName ? ' ' + className : className;\n            }\n          }\n        });\n      }\n\n      return self;\n    },\n    hasClass: function (className) {\n      return hasClass(this[0], className);\n    },\n    each: function (callback) {\n      return each$4(this, callback);\n    },\n    on: function (name, callback) {\n      return this.each(function () {\n        Event.bind(this, name, callback);\n      });\n    },\n    off: function (name, callback) {\n      return this.each(function () {\n        Event.unbind(this, name, callback);\n      });\n    },\n    trigger: function (name) {\n      return this.each(function () {\n        if (typeof name === 'object') {\n          Event.fire(this, name.type, name);\n        } else {\n          Event.fire(this, name);\n        }\n      });\n    },\n    show: function () {\n      return this.css('display', '');\n    },\n    hide: function () {\n      return this.css('display', 'none');\n    },\n    slice: function () {\n      return DomQuery(slice$1.apply(this, arguments));\n    },\n    eq: function (index) {\n      return index === -1 ? this.slice(index) : this.slice(index, +index + 1);\n    },\n    first: function () {\n      return this.eq(0);\n    },\n    last: function () {\n      return this.eq(-1);\n    },\n    find: function (selector) {\n      var i, l;\n      var ret = [];\n\n      for (i = 0, l = this.length; i < l; i++) {\n        DomQuery.find(selector, this[i], ret);\n      }\n\n      return DomQuery(ret);\n    },\n    filter: function (selector) {\n      if (typeof selector === 'function') {\n        return DomQuery(grep(this.toArray(), function (item, i) {\n          return selector(i, item);\n        }));\n      }\n\n      return DomQuery(DomQuery.filter(selector, this.toArray()));\n    },\n    closest: function (selector) {\n      var result = [];\n\n      if (selector instanceof DomQuery) {\n        selector = selector[0];\n      }\n\n      this.each(function (i, node) {\n        while (node) {\n          if (typeof selector === 'string' && DomQuery(node).is(selector)) {\n            result.push(node);\n            break;\n          } else if (node === selector) {\n            result.push(node);\n            break;\n          }\n\n          node = node.parentNode;\n        }\n      });\n      return DomQuery(result);\n    },\n    offset: function (offset) {\n      var elm, doc, docElm;\n      var x = 0,\n          y = 0,\n          pos;\n\n      if (!offset) {\n        elm = this[0];\n\n        if (elm) {\n          doc = elm.ownerDocument;\n          docElm = doc.documentElement;\n\n          if (elm.getBoundingClientRect) {\n            pos = elm.getBoundingClientRect();\n            x = pos.left + (docElm.scrollLeft || doc.body.scrollLeft) - docElm.clientLeft;\n            y = pos.top + (docElm.scrollTop || doc.body.scrollTop) - docElm.clientTop;\n          }\n        }\n\n        return {\n          left: x,\n          top: y\n        };\n      }\n\n      return this.css(offset);\n    },\n    push: push$1,\n    sort: Array.prototype.sort,\n    splice: Array.prototype.splice\n  };\n  Tools.extend(DomQueryConstructor, {\n    extend: Tools.extend,\n    makeArray: function (object) {\n      if (isWindow(object) || object.nodeType) {\n        return [object];\n      }\n\n      return Tools.toArray(object);\n    },\n    inArray: inArray$1,\n    isArray: Tools.isArray,\n    each: each$4,\n    trim: trim$3,\n    grep: grep,\n    find: Sizzle,\n    expr: Sizzle.selectors,\n    unique: Sizzle.uniqueSort,\n    text: Sizzle.getText,\n    contains: Sizzle.contains,\n    filter: function (expr, elems, not) {\n      var i = elems.length;\n\n      if (not) {\n        expr = ':not(' + expr + ')';\n      }\n\n      while (i--) {\n        if (elems[i].nodeType !== 1) {\n          elems.splice(i, 1);\n        }\n      }\n\n      if (elems.length === 1) {\n        elems = DomQuery.find.matchesSelector(elems[0], expr) ? [elems[0]] : [];\n      } else {\n        elems = DomQuery.find.matches(expr, elems);\n      }\n\n      return elems;\n    }\n  });\n\n  var dir = function (el, prop, until) {\n    var matched = [];\n    var cur = el[prop];\n\n    if (typeof until !== 'string' && until instanceof DomQuery) {\n      until = until[0];\n    }\n\n    while (cur && cur.nodeType !== 9) {\n      if (until !== undefined) {\n        if (cur === until) {\n          break;\n        }\n\n        if (typeof until === 'string' && DomQuery(cur).is(until)) {\n          break;\n        }\n      }\n\n      if (cur.nodeType === 1) {\n        matched.push(cur);\n      }\n\n      cur = cur[prop];\n    }\n\n    return matched;\n  };\n\n  var sibling$1 = function (node, siblingName, nodeType, until) {\n    var result = [];\n\n    if (until instanceof DomQuery) {\n      until = until[0];\n    }\n\n    for (; node; node = node[siblingName]) {\n      if (nodeType && node.nodeType !== nodeType) {\n        continue;\n      }\n\n      if (until !== undefined) {\n        if (node === until) {\n          break;\n        }\n\n        if (typeof until === 'string' && DomQuery(node).is(until)) {\n          break;\n        }\n      }\n\n      result.push(node);\n    }\n\n    return result;\n  };\n\n  var firstSibling = function (node, siblingName, nodeType) {\n    for (node = node[siblingName]; node; node = node[siblingName]) {\n      if (node.nodeType === nodeType) {\n        return node;\n      }\n    }\n\n    return null;\n  };\n\n  each$4({\n    parent: function (node) {\n      var parent = node.parentNode;\n      return parent && parent.nodeType !== 11 ? parent : null;\n    },\n    parents: function (node) {\n      return dir(node, 'parentNode');\n    },\n    next: function (node) {\n      return firstSibling(node, 'nextSibling', 1);\n    },\n    prev: function (node) {\n      return firstSibling(node, 'previousSibling', 1);\n    },\n    children: function (node) {\n      return sibling$1(node.firstChild, 'nextSibling', 1);\n    },\n    contents: function (node) {\n      return Tools.toArray((node.nodeName === 'iframe' ? node.contentDocument || node.contentWindow.document : node).childNodes);\n    }\n  }, function (name, fn) {\n    DomQueryConstructor.fn[name] = function (selector) {\n      var self = this;\n      var result = [];\n      self.each(function () {\n        var nodes = fn.call(result, this, selector, result);\n\n        if (nodes) {\n          if (DomQuery.isArray(nodes)) {\n            result.push.apply(result, nodes);\n          } else {\n            result.push(nodes);\n          }\n        }\n      });\n\n      if (this.length > 1) {\n        if (!skipUniques[name]) {\n          result = DomQuery.unique(result);\n        }\n\n        if (name.indexOf('parents') === 0) {\n          result = result.reverse();\n        }\n      }\n\n      var wrappedResult = DomQuery(result);\n\n      if (selector) {\n        return wrappedResult.filter(selector);\n      }\n\n      return wrappedResult;\n    };\n  });\n  each$4({\n    parentsUntil: function (node, until) {\n      return dir(node, 'parentNode', until);\n    },\n    nextUntil: function (node, until) {\n      return sibling$1(node, 'nextSibling', 1, until).slice(1);\n    },\n    prevUntil: function (node, until) {\n      return sibling$1(node, 'previousSibling', 1, until).slice(1);\n    }\n  }, function (name, fn) {\n    DomQueryConstructor.fn[name] = function (selector, filter) {\n      var self = this;\n      var result = [];\n      self.each(function () {\n        var nodes = fn.call(result, this, selector, result);\n\n        if (nodes) {\n          if (DomQuery.isArray(nodes)) {\n            result.push.apply(result, nodes);\n          } else {\n            result.push(nodes);\n          }\n        }\n      });\n\n      if (this.length > 1) {\n        result = DomQuery.unique(result);\n\n        if (name.indexOf('parents') === 0 || name === 'prevUntil') {\n          result = result.reverse();\n        }\n      }\n\n      var wrappedResult = DomQuery(result);\n\n      if (filter) {\n        return wrappedResult.filter(filter);\n      }\n\n      return wrappedResult;\n    };\n  });\n\n  DomQueryConstructor.fn.is = function (selector) {\n    return !!selector && this.filter(selector).length > 0;\n  };\n\n  DomQueryConstructor.fn.init.prototype = DomQueryConstructor.fn;\n\n  DomQueryConstructor.overrideDefaults = function (callback) {\n    var defaults;\n\n    var sub = function (selector, context) {\n      defaults = defaults || callback();\n\n      if (arguments.length === 0) {\n        selector = defaults.element;\n      }\n\n      if (!context) {\n        context = defaults.context;\n      }\n\n      return new sub.fn.init(selector, context);\n    };\n\n    DomQuery.extend(sub, this);\n    return sub;\n  };\n\n  DomQueryConstructor.attrHooks = attrHooks;\n  DomQueryConstructor.cssHooks = cssHooks;\n  var DomQuery = DomQueryConstructor;\n  var each$5 = Tools.each;\n  var grep$1 = Tools.grep;\n  var isIE = Env.ie;\n  var simpleSelectorRe = /^([a-z0-9],?)+$/i;\n\n  var setupAttrHooks = function (styles, settings, getContext) {\n    var keepValues = settings.keep_values;\n    var keepUrlHook = {\n      set: function ($elm, value, name) {\n        if (settings.url_converter) {\n          value = settings.url_converter.call(settings.url_converter_scope || getContext(), value, name, $elm[0]);\n        }\n\n        $elm.attr('data-mce-' + name, value).attr(name, value);\n      },\n      get: function ($elm, name) {\n        return $elm.attr('data-mce-' + name) || $elm.attr(name);\n      }\n    };\n    var attrHooks = {\n      style: {\n        set: function ($elm, value) {\n          if (value !== null && typeof value === 'object') {\n            $elm.css(value);\n            return;\n          }\n\n          if (keepValues) {\n            $elm.attr('data-mce-style', value);\n          }\n\n          if (value !== null && typeof value === 'string') {\n            $elm.removeAttr('style');\n            $elm.css(styles.parse(value));\n          } else {\n            $elm.attr('style', value);\n          }\n        },\n        get: function ($elm) {\n          var value = $elm.attr('data-mce-style') || $elm.attr('style');\n          value = styles.serialize(styles.parse(value), $elm[0].nodeName);\n          return value;\n        }\n      }\n    };\n\n    if (keepValues) {\n      attrHooks.href = attrHooks.src = keepUrlHook;\n    }\n\n    return attrHooks;\n  };\n\n  var updateInternalStyleAttr = function (styles, $elm) {\n    var rawValue = $elm.attr('style');\n    var value = styles.serialize(styles.parse(rawValue), $elm[0].nodeName);\n\n    if (!value) {\n      value = null;\n    }\n\n    $elm.attr('data-mce-style', value);\n  };\n\n  var findNodeIndex = function (node, normalized) {\n    var idx = 0,\n        lastNodeType,\n        nodeType;\n\n    if (node) {\n      for (lastNodeType = node.nodeType, node = node.previousSibling; node; node = node.previousSibling) {\n        nodeType = node.nodeType;\n\n        if (normalized && nodeType === 3) {\n          if (nodeType === lastNodeType || !node.nodeValue.length) {\n            continue;\n          }\n        }\n\n        idx++;\n        lastNodeType = nodeType;\n      }\n    }\n\n    return idx;\n  };\n\n  var DOMUtils = function (doc, settings) {\n    if (settings === void 0) {\n      settings = {};\n    }\n\n    var addedStyles = {};\n    var win = window;\n    var files = {};\n    var counter = 0;\n    var stdMode = true;\n    var boxModel = true;\n    var styleSheetLoader = instance.forElement(SugarElement.fromDom(doc), {\n      contentCssCors: settings.contentCssCors,\n      referrerPolicy: settings.referrerPolicy\n    });\n    var boundEvents = [];\n    var schema = settings.schema ? settings.schema : Schema({});\n    var styles = Styles({\n      url_converter: settings.url_converter,\n      url_converter_scope: settings.url_converter_scope\n    }, settings.schema);\n    var events = settings.ownEvents ? new EventUtils() : EventUtils.Event;\n    var blockElementsMap = schema.getBlockElements();\n    var $ = DomQuery.overrideDefaults(function () {\n      return {\n        context: doc,\n        element: self.getRoot()\n      };\n    });\n\n    var isBlock = function (node) {\n      if (typeof node === 'string') {\n        return !!blockElementsMap[node];\n      } else if (node) {\n        var type = node.nodeType;\n\n        if (type) {\n          return !!(type === 1 && blockElementsMap[node.nodeName]);\n        }\n      }\n\n      return false;\n    };\n\n    var get = function (elm) {\n      return elm && doc && isString(elm) ? doc.getElementById(elm) : elm;\n    };\n\n    var $$ = function (elm) {\n      return $(typeof elm === 'string' ? get(elm) : elm);\n    };\n\n    var getAttrib = function (elm, name, defaultVal) {\n      var hook, value;\n      var $elm = $$(elm);\n\n      if ($elm.length) {\n        hook = attrHooks[name];\n\n        if (hook && hook.get) {\n          value = hook.get($elm, name);\n        } else {\n          value = $elm.attr(name);\n        }\n      }\n\n      if (typeof value === 'undefined') {\n        value = defaultVal || '';\n      }\n\n      return value;\n    };\n\n    var getAttribs = function (elm) {\n      var node = get(elm);\n\n      if (!node) {\n        return [];\n      }\n\n      return node.attributes;\n    };\n\n    var setAttrib = function (elm, name, value) {\n      if (value === '') {\n        value = null;\n      }\n\n      var $elm = $$(elm);\n      var originalValue = $elm.attr(name);\n\n      if (!$elm.length) {\n        return;\n      }\n\n      var hook = attrHooks[name];\n\n      if (hook && hook.set) {\n        hook.set($elm, value, name);\n      } else {\n        $elm.attr(name, value);\n      }\n\n      if (originalValue !== value && settings.onSetAttrib) {\n        settings.onSetAttrib({\n          attrElm: $elm,\n          attrName: name,\n          attrValue: value\n        });\n      }\n    };\n\n    var clone = function (node, deep) {\n      if (!isIE || node.nodeType !== 1 || deep) {\n        return node.cloneNode(deep);\n      } else {\n        var clone_1 = doc.createElement(node.nodeName);\n        each$5(getAttribs(node), function (attr) {\n          setAttrib(clone_1, attr.nodeName, getAttrib(node, attr.nodeName));\n        });\n        return clone_1;\n      }\n    };\n\n    var getRoot = function () {\n      return settings.root_element || doc.body;\n    };\n\n    var getViewPort = function (argWin) {\n      var vp = getBounds(argWin);\n      return {\n        x: vp.x,\n        y: vp.y,\n        w: vp.width,\n        h: vp.height\n      };\n    };\n\n    var getPos$1 = function (elm, rootElm) {\n      return getPos(doc.body, get(elm), rootElm);\n    };\n\n    var setStyle = function (elm, name, value) {\n      var $elm = isString(name) ? $$(elm).css(name, value) : $$(elm).css(name);\n\n      if (settings.update_styles) {\n        updateInternalStyleAttr(styles, $elm);\n      }\n    };\n\n    var setStyles = function (elm, stylesArg) {\n      var $elm = $$(elm).css(stylesArg);\n\n      if (settings.update_styles) {\n        updateInternalStyleAttr(styles, $elm);\n      }\n    };\n\n    var getStyle = function (elm, name, computed) {\n      var $elm = $$(elm);\n\n      if (computed) {\n        return $elm.css(name);\n      }\n\n      name = name.replace(/-(\\D)/g, function (a, b) {\n        return b.toUpperCase();\n      });\n\n      if (name === 'float') {\n        name = Env.browser.isIE() ? 'styleFloat' : 'cssFloat';\n      }\n\n      return $elm[0] && $elm[0].style ? $elm[0].style[name] : undefined;\n    };\n\n    var getSize = function (elm) {\n      var w, h;\n      elm = get(elm);\n      w = getStyle(elm, 'width');\n      h = getStyle(elm, 'height');\n\n      if (w.indexOf('px') === -1) {\n        w = 0;\n      }\n\n      if (h.indexOf('px') === -1) {\n        h = 0;\n      }\n\n      return {\n        w: parseInt(w, 10) || elm.offsetWidth || elm.clientWidth,\n        h: parseInt(h, 10) || elm.offsetHeight || elm.clientHeight\n      };\n    };\n\n    var getRect = function (elm) {\n      elm = get(elm);\n      var pos = getPos$1(elm);\n      var size = getSize(elm);\n      return {\n        x: pos.x,\n        y: pos.y,\n        w: size.w,\n        h: size.h\n      };\n    };\n\n    var is = function (elm, selector) {\n      var i;\n\n      if (!elm) {\n        return false;\n      }\n\n      if (!Array.isArray(elm)) {\n        if (selector === '*') {\n          return elm.nodeType === 1;\n        }\n\n        if (simpleSelectorRe.test(selector)) {\n          var selectors = selector.toLowerCase().split(/,/);\n          var elmName = elm.nodeName.toLowerCase();\n\n          for (i = selectors.length - 1; i >= 0; i--) {\n            if (selectors[i] === elmName) {\n              return true;\n            }\n          }\n\n          return false;\n        }\n\n        if (elm.nodeType && elm.nodeType !== 1) {\n          return false;\n        }\n      }\n\n      var elms = !Array.isArray(elm) ? [elm] : elm;\n      return Sizzle(selector, elms[0].ownerDocument || elms[0], null, elms).length > 0;\n    };\n\n    var getParents = function (elm, selector, root, collect) {\n      var result = [];\n      var selectorVal;\n      var node = get(elm);\n      collect = collect === undefined;\n      root = root || (getRoot().nodeName !== 'BODY' ? getRoot().parentNode : null);\n\n      if (Tools.is(selector, 'string')) {\n        selectorVal = selector;\n\n        if (selector === '*') {\n          selector = function (node) {\n            return node.nodeType === 1;\n          };\n        } else {\n          selector = function (node) {\n            return is(node, selectorVal);\n          };\n        }\n      }\n\n      while (node) {\n        if (node === root || isNullable(node.nodeType) || isDocument$1(node) || isDocumentFragment$1(node)) {\n          break;\n        }\n\n        if (!selector || typeof selector === 'function' && selector(node)) {\n          if (collect) {\n            result.push(node);\n          } else {\n            return [node];\n          }\n        }\n\n        node = node.parentNode;\n      }\n\n      return collect ? result : null;\n    };\n\n    var getParent = function (node, selector, root) {\n      var parents = getParents(node, selector, root, false);\n      return parents && parents.length > 0 ? parents[0] : null;\n    };\n\n    var _findSib = function (node, selector, name) {\n      var func = selector;\n\n      if (node) {\n        if (typeof selector === 'string') {\n          func = function (node) {\n            return is(node, selector);\n          };\n        }\n\n        for (node = node[name]; node; node = node[name]) {\n          if (typeof func === 'function' && func(node)) {\n            return node;\n          }\n        }\n      }\n\n      return null;\n    };\n\n    var getNext = function (node, selector) {\n      return _findSib(node, selector, 'nextSibling');\n    };\n\n    var getPrev = function (node, selector) {\n      return _findSib(node, selector, 'previousSibling');\n    };\n\n    var select = function (selector, scope) {\n      return Sizzle(selector, get(scope) || settings.root_element || doc, []);\n    };\n\n    var run = function (elm, func, scope) {\n      var result;\n      var node = typeof elm === 'string' ? get(elm) : elm;\n\n      if (!node) {\n        return false;\n      }\n\n      if (Tools.isArray(node) && (node.length || node.length === 0)) {\n        result = [];\n        each$5(node, function (elm, i) {\n          if (elm) {\n            result.push(func.call(scope, typeof elm === 'string' ? get(elm) : elm, i));\n          }\n        });\n        return result;\n      }\n\n      var context = scope ? scope : this;\n      return func.call(context, node);\n    };\n\n    var setAttribs = function (elm, attrs) {\n      $$(elm).each(function (i, node) {\n        each$5(attrs, function (value, name) {\n          setAttrib(node, name, value);\n        });\n      });\n    };\n\n    var setHTML = function (elm, html) {\n      var $elm = $$(elm);\n\n      if (isIE) {\n        $elm.each(function (i, target) {\n          if (target.canHaveHTML === false) {\n            return;\n          }\n\n          while (target.firstChild) {\n            target.removeChild(target.firstChild);\n          }\n\n          try {\n            target.innerHTML = '<br>' + html;\n            target.removeChild(target.firstChild);\n          } catch (ex) {\n            DomQuery('<div></div>').html('<br>' + html).contents().slice(1).appendTo(target);\n          }\n\n          return html;\n        });\n      } else {\n        $elm.html(html);\n      }\n    };\n\n    var add = function (parentElm, name, attrs, html, create) {\n      return run(parentElm, function (parentElm) {\n        var newElm = typeof name === 'string' ? doc.createElement(name) : name;\n        setAttribs(newElm, attrs);\n\n        if (html) {\n          if (typeof html !== 'string' && html.nodeType) {\n            newElm.appendChild(html);\n          } else if (typeof html === 'string') {\n            setHTML(newElm, html);\n          }\n        }\n\n        return !create ? parentElm.appendChild(newElm) : newElm;\n      });\n    };\n\n    var create = function (name, attrs, html) {\n      return add(doc.createElement(name), name, attrs, html, true);\n    };\n\n    var decode = Entities.decode;\n    var encode = Entities.encodeAllRaw;\n\n    var createHTML = function (name, attrs, html) {\n      var outHtml = '',\n          key;\n      outHtml += '<' + name;\n\n      for (key in attrs) {\n        if (attrs.hasOwnProperty(key) && attrs[key] !== null && typeof attrs[key] !== 'undefined') {\n          outHtml += ' ' + key + '=\"' + encode(attrs[key]) + '\"';\n        }\n      }\n\n      if (typeof html !== 'undefined') {\n        return outHtml + '>' + html + '</' + name + '>';\n      }\n\n      return outHtml + ' />';\n    };\n\n    var createFragment = function (html) {\n      var node;\n      var container = doc.createElement('div');\n      var frag = doc.createDocumentFragment();\n      frag.appendChild(container);\n\n      if (html) {\n        container.innerHTML = html;\n      }\n\n      while (node = container.firstChild) {\n        frag.appendChild(node);\n      }\n\n      frag.removeChild(container);\n      return frag;\n    };\n\n    var remove = function (node, keepChildren) {\n      var $node = $$(node);\n\n      if (keepChildren) {\n        $node.each(function () {\n          var child;\n\n          while (child = this.firstChild) {\n            if (child.nodeType === 3 && child.data.length === 0) {\n              this.removeChild(child);\n            } else {\n              this.parentNode.insertBefore(child, this);\n            }\n          }\n        }).remove();\n      } else {\n        $node.remove();\n      }\n\n      return $node.length > 1 ? $node.toArray() : $node[0];\n    };\n\n    var removeAllAttribs = function (e) {\n      return run(e, function (e) {\n        var i;\n        var attrs = e.attributes;\n\n        for (i = attrs.length - 1; i >= 0; i--) {\n          e.removeAttributeNode(attrs.item(i));\n        }\n      });\n    };\n\n    var parseStyle = function (cssText) {\n      return styles.parse(cssText);\n    };\n\n    var serializeStyle = function (stylesArg, name) {\n      return styles.serialize(stylesArg, name);\n    };\n\n    var addStyle = function (cssText) {\n      var head, styleElm;\n\n      if (self !== DOMUtils.DOM && doc === document) {\n        if (addedStyles[cssText]) {\n          return;\n        }\n\n        addedStyles[cssText] = true;\n      }\n\n      styleElm = doc.getElementById('mceDefaultStyles');\n\n      if (!styleElm) {\n        styleElm = doc.createElement('style');\n        styleElm.id = 'mceDefaultStyles';\n        styleElm.type = 'text/css';\n        head = doc.getElementsByTagName('head')[0];\n\n        if (head.firstChild) {\n          head.insertBefore(styleElm, head.firstChild);\n        } else {\n          head.appendChild(styleElm);\n        }\n      }\n\n      if (styleElm.styleSheet) {\n        styleElm.styleSheet.cssText += cssText;\n      } else {\n        styleElm.appendChild(doc.createTextNode(cssText));\n      }\n    };\n\n    var loadCSS = function (urls) {\n      if (!urls) {\n        urls = '';\n      }\n\n      each(urls.split(','), function (url) {\n        files[url] = true;\n        styleSheetLoader.load(url, noop);\n      });\n    };\n\n    var toggleClass = function (elm, cls, state) {\n      $$(elm).toggleClass(cls, state).each(function () {\n        if (this.className === '') {\n          DomQuery(this).attr('class', null);\n        }\n      });\n    };\n\n    var addClass = function (elm, cls) {\n      $$(elm).addClass(cls);\n    };\n\n    var removeClass = function (elm, cls) {\n      toggleClass(elm, cls, false);\n    };\n\n    var hasClass = function (elm, cls) {\n      return $$(elm).hasClass(cls);\n    };\n\n    var show = function (elm) {\n      $$(elm).show();\n    };\n\n    var hide = function (elm) {\n      $$(elm).hide();\n    };\n\n    var isHidden = function (elm) {\n      return $$(elm).css('display') === 'none';\n    };\n\n    var uniqueId = function (prefix) {\n      return (!prefix ? 'mce_' : prefix) + counter++;\n    };\n\n    var getOuterHTML = function (elm) {\n      var node = typeof elm === 'string' ? get(elm) : elm;\n      return isElement$1(node) ? node.outerHTML : DomQuery('<div></div>').append(DomQuery(node).clone()).html();\n    };\n\n    var setOuterHTML = function (elm, html) {\n      $$(elm).each(function () {\n        try {\n          if ('outerHTML' in this) {\n            this.outerHTML = html;\n            return;\n          }\n        } catch (ex) {}\n\n        remove(DomQuery(this).html(html), true);\n      });\n    };\n\n    var insertAfter = function (node, reference) {\n      var referenceNode = get(reference);\n      return run(node, function (node) {\n        var parent = referenceNode.parentNode;\n        var nextSibling = referenceNode.nextSibling;\n\n        if (nextSibling) {\n          parent.insertBefore(node, nextSibling);\n        } else {\n          parent.appendChild(node);\n        }\n\n        return node;\n      });\n    };\n\n    var replace = function (newElm, oldElm, keepChildren) {\n      return run(oldElm, function (oldElm) {\n        if (Tools.is(oldElm, 'array')) {\n          newElm = newElm.cloneNode(true);\n        }\n\n        if (keepChildren) {\n          each$5(grep$1(oldElm.childNodes), function (node) {\n            newElm.appendChild(node);\n          });\n        }\n\n        return oldElm.parentNode.replaceChild(newElm, oldElm);\n      });\n    };\n\n    var rename = function (elm, name) {\n      var newElm;\n\n      if (elm.nodeName !== name.toUpperCase()) {\n        newElm = create(name);\n        each$5(getAttribs(elm), function (attrNode) {\n          setAttrib(newElm, attrNode.nodeName, getAttrib(elm, attrNode.nodeName));\n        });\n        replace(newElm, elm, true);\n      }\n\n      return newElm || elm;\n    };\n\n    var findCommonAncestor = function (a, b) {\n      var ps = a,\n          pe;\n\n      while (ps) {\n        pe = b;\n\n        while (pe && ps !== pe) {\n          pe = pe.parentNode;\n        }\n\n        if (ps === pe) {\n          break;\n        }\n\n        ps = ps.parentNode;\n      }\n\n      if (!ps && a.ownerDocument) {\n        return a.ownerDocument.documentElement;\n      }\n\n      return ps;\n    };\n\n    var toHex = function (rgbVal) {\n      return styles.toHex(Tools.trim(rgbVal));\n    };\n\n    var isNonEmptyElement = function (node) {\n      if (isElement$1(node)) {\n        var isNamedAnchor = node.nodeName.toLowerCase() === 'a' && !getAttrib(node, 'href') && getAttrib(node, 'id');\n\n        if (getAttrib(node, 'name') || getAttrib(node, 'data-mce-bookmark') || isNamedAnchor) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n\n    var isEmpty = function (node, elements) {\n      var type,\n          name,\n          brCount = 0;\n\n      if (isNonEmptyElement(node)) {\n        return false;\n      }\n\n      node = node.firstChild;\n\n      if (node) {\n        var walker = new DomTreeWalker(node, node.parentNode);\n        var whitespace = schema ? schema.getWhiteSpaceElements() : {};\n        elements = elements || (schema ? schema.getNonEmptyElements() : null);\n\n        do {\n          type = node.nodeType;\n\n          if (isElement$1(node)) {\n            var bogusVal = node.getAttribute('data-mce-bogus');\n\n            if (bogusVal) {\n              node = walker.next(bogusVal === 'all');\n              continue;\n            }\n\n            name = node.nodeName.toLowerCase();\n\n            if (elements && elements[name]) {\n              if (name === 'br') {\n                brCount++;\n                node = walker.next();\n                continue;\n              }\n\n              return false;\n            }\n\n            if (isNonEmptyElement(node)) {\n              return false;\n            }\n          }\n\n          if (type === 8) {\n            return false;\n          }\n\n          if (type === 3 && !isWhitespaceText(node.nodeValue)) {\n            return false;\n          }\n\n          if (type === 3 && node.parentNode && whitespace[node.parentNode.nodeName] && isWhitespaceText(node.nodeValue)) {\n            return false;\n          }\n\n          node = walker.next();\n        } while (node);\n      }\n\n      return brCount <= 1;\n    };\n\n    var createRng = function () {\n      return doc.createRange();\n    };\n\n    var split = function (parentElm, splitElm, replacementElm) {\n      var range = createRng();\n      var beforeFragment;\n      var afterFragment;\n      var parentNode;\n\n      if (parentElm && splitElm) {\n        range.setStart(parentElm.parentNode, findNodeIndex(parentElm));\n        range.setEnd(splitElm.parentNode, findNodeIndex(splitElm));\n        beforeFragment = range.extractContents();\n        range = createRng();\n        range.setStart(splitElm.parentNode, findNodeIndex(splitElm) + 1);\n        range.setEnd(parentElm.parentNode, findNodeIndex(parentElm) + 1);\n        afterFragment = range.extractContents();\n        parentNode = parentElm.parentNode;\n        parentNode.insertBefore(trimNode(self, beforeFragment), parentElm);\n\n        if (replacementElm) {\n          parentNode.insertBefore(replacementElm, parentElm);\n        } else {\n          parentNode.insertBefore(splitElm, parentElm);\n        }\n\n        parentNode.insertBefore(trimNode(self, afterFragment), parentElm);\n        remove(parentElm);\n        return replacementElm || splitElm;\n      }\n    };\n\n    var bind = function (target, name, func, scope) {\n      if (Tools.isArray(target)) {\n        var i = target.length;\n        var rv = [];\n\n        while (i--) {\n          rv[i] = bind(target[i], name, func, scope);\n        }\n\n        return rv;\n      }\n\n      if (settings.collect && (target === doc || target === win)) {\n        boundEvents.push([target, name, func, scope]);\n      }\n\n      var output = events.bind(target, name, func, scope || self);\n      return output;\n    };\n\n    var unbind = function (target, name, func) {\n      if (Tools.isArray(target)) {\n        var i = target.length;\n        var rv = [];\n\n        while (i--) {\n          rv[i] = unbind(target[i], name, func);\n        }\n\n        return rv;\n      } else {\n        if (boundEvents.length > 0 && (target === doc || target === win)) {\n          var i = boundEvents.length;\n\n          while (i--) {\n            var item = boundEvents[i];\n\n            if (target === item[0] && (!name || name === item[1]) && (!func || func === item[2])) {\n              events.unbind(item[0], item[1], item[2]);\n            }\n          }\n        }\n\n        return events.unbind(target, name, func);\n      }\n    };\n\n    var fire = function (target, name, evt) {\n      return events.fire(target, name, evt);\n    };\n\n    var getContentEditable = function (node) {\n      if (node && isElement$1(node)) {\n        var contentEditable = node.getAttribute('data-mce-contenteditable');\n\n        if (contentEditable && contentEditable !== 'inherit') {\n          return contentEditable;\n        }\n\n        return node.contentEditable !== 'inherit' ? node.contentEditable : null;\n      } else {\n        return null;\n      }\n    };\n\n    var getContentEditableParent = function (node) {\n      var root = getRoot();\n      var state = null;\n\n      for (; node && node !== root; node = node.parentNode) {\n        state = getContentEditable(node);\n\n        if (state !== null) {\n          break;\n        }\n      }\n\n      return state;\n    };\n\n    var destroy = function () {\n      if (boundEvents.length > 0) {\n        var i = boundEvents.length;\n\n        while (i--) {\n          var item = boundEvents[i];\n          events.unbind(item[0], item[1], item[2]);\n        }\n      }\n\n      each$1(files, function (_, url) {\n        styleSheetLoader.unload(url);\n        delete files[url];\n      });\n\n      if (Sizzle.setDocument) {\n        Sizzle.setDocument();\n      }\n    };\n\n    var isChildOf = function (node, parent) {\n      while (node) {\n        if (parent === node) {\n          return true;\n        }\n\n        node = node.parentNode;\n      }\n\n      return false;\n    };\n\n    var dumpRng = function (r) {\n      return 'startContainer: ' + r.startContainer.nodeName + ', startOffset: ' + r.startOffset + ', endContainer: ' + r.endContainer.nodeName + ', endOffset: ' + r.endOffset;\n    };\n\n    var self = {\n      doc: doc,\n      settings: settings,\n      win: win,\n      files: files,\n      stdMode: stdMode,\n      boxModel: boxModel,\n      styleSheetLoader: styleSheetLoader,\n      boundEvents: boundEvents,\n      styles: styles,\n      schema: schema,\n      events: events,\n      isBlock: isBlock,\n      $: $,\n      $$: $$,\n      root: null,\n      clone: clone,\n      getRoot: getRoot,\n      getViewPort: getViewPort,\n      getRect: getRect,\n      getSize: getSize,\n      getParent: getParent,\n      getParents: getParents,\n      get: get,\n      getNext: getNext,\n      getPrev: getPrev,\n      select: select,\n      is: is,\n      add: add,\n      create: create,\n      createHTML: createHTML,\n      createFragment: createFragment,\n      remove: remove,\n      setStyle: setStyle,\n      getStyle: getStyle,\n      setStyles: setStyles,\n      removeAllAttribs: removeAllAttribs,\n      setAttrib: setAttrib,\n      setAttribs: setAttribs,\n      getAttrib: getAttrib,\n      getPos: getPos$1,\n      parseStyle: parseStyle,\n      serializeStyle: serializeStyle,\n      addStyle: addStyle,\n      loadCSS: loadCSS,\n      addClass: addClass,\n      removeClass: removeClass,\n      hasClass: hasClass,\n      toggleClass: toggleClass,\n      show: show,\n      hide: hide,\n      isHidden: isHidden,\n      uniqueId: uniqueId,\n      setHTML: setHTML,\n      getOuterHTML: getOuterHTML,\n      setOuterHTML: setOuterHTML,\n      decode: decode,\n      encode: encode,\n      insertAfter: insertAfter,\n      replace: replace,\n      rename: rename,\n      findCommonAncestor: findCommonAncestor,\n      toHex: toHex,\n      run: run,\n      getAttribs: getAttribs,\n      isEmpty: isEmpty,\n      createRng: createRng,\n      nodeIndex: findNodeIndex,\n      split: split,\n      bind: bind,\n      unbind: unbind,\n      fire: fire,\n      getContentEditable: getContentEditable,\n      getContentEditableParent: getContentEditableParent,\n      destroy: destroy,\n      isChildOf: isChildOf,\n      dumpRng: dumpRng\n    };\n    var attrHooks = setupAttrHooks(styles, settings, function () {\n      return self;\n    });\n    return self;\n  };\n\n  DOMUtils.DOM = DOMUtils(document);\n  DOMUtils.nodeIndex = findNodeIndex;\n  var DOM = DOMUtils.DOM;\n  var each$6 = Tools.each,\n      grep$2 = Tools.grep;\n  var QUEUED = 0;\n  var LOADING = 1;\n  var LOADED = 2;\n  var FAILED = 3;\n\n  var ScriptLoader = function () {\n    function ScriptLoader(settings) {\n      if (settings === void 0) {\n        settings = {};\n      }\n\n      this.states = {};\n      this.queue = [];\n      this.scriptLoadedCallbacks = {};\n      this.queueLoadedCallbacks = [];\n      this.loading = 0;\n      this.settings = settings;\n    }\n\n    ScriptLoader.prototype._setReferrerPolicy = function (referrerPolicy) {\n      this.settings.referrerPolicy = referrerPolicy;\n    };\n\n    ScriptLoader.prototype.loadScript = function (url, success, failure) {\n      var dom = DOM;\n      var elm;\n\n      var cleanup = function () {\n        dom.remove(id);\n\n        if (elm) {\n          elm.onerror = elm.onload = elm = null;\n        }\n      };\n\n      var done = function () {\n        cleanup();\n        success();\n      };\n\n      var error = function () {\n        cleanup();\n\n        if (isFunction(failure)) {\n          failure();\n        } else {\n          if (typeof console !== 'undefined' && console.log) {\n            console.log('Failed to load script: ' + url);\n          }\n        }\n      };\n\n      var id = dom.uniqueId();\n      elm = document.createElement('script');\n      elm.id = id;\n      elm.type = 'text/javascript';\n      elm.src = Tools._addCacheSuffix(url);\n\n      if (this.settings.referrerPolicy) {\n        dom.setAttrib(elm, 'referrerpolicy', this.settings.referrerPolicy);\n      }\n\n      elm.onload = done;\n      elm.onerror = error;\n      (document.getElementsByTagName('head')[0] || document.body).appendChild(elm);\n    };\n\n    ScriptLoader.prototype.isDone = function (url) {\n      return this.states[url] === LOADED;\n    };\n\n    ScriptLoader.prototype.markDone = function (url) {\n      this.states[url] = LOADED;\n    };\n\n    ScriptLoader.prototype.add = function (url, success, scope, failure) {\n      var state = this.states[url];\n      this.queue.push(url);\n\n      if (state === undefined) {\n        this.states[url] = QUEUED;\n      }\n\n      if (success) {\n        if (!this.scriptLoadedCallbacks[url]) {\n          this.scriptLoadedCallbacks[url] = [];\n        }\n\n        this.scriptLoadedCallbacks[url].push({\n          success: success,\n          failure: failure,\n          scope: scope || this\n        });\n      }\n    };\n\n    ScriptLoader.prototype.load = function (url, success, scope, failure) {\n      return this.add(url, success, scope, failure);\n    };\n\n    ScriptLoader.prototype.remove = function (url) {\n      delete this.states[url];\n      delete this.scriptLoadedCallbacks[url];\n    };\n\n    ScriptLoader.prototype.loadQueue = function (success, scope, failure) {\n      this.loadScripts(this.queue, success, scope, failure);\n    };\n\n    ScriptLoader.prototype.loadScripts = function (scripts, success, scope, failure) {\n      var self = this;\n      var failures = [];\n\n      var execCallbacks = function (name, url) {\n        each$6(self.scriptLoadedCallbacks[url], function (callback) {\n          if (isFunction(callback[name])) {\n            callback[name].call(callback.scope);\n          }\n        });\n        self.scriptLoadedCallbacks[url] = undefined;\n      };\n\n      self.queueLoadedCallbacks.push({\n        success: success,\n        failure: failure,\n        scope: scope || this\n      });\n\n      var loadScripts = function () {\n        var loadingScripts = grep$2(scripts);\n        scripts.length = 0;\n        each$6(loadingScripts, function (url) {\n          if (self.states[url] === LOADED) {\n            execCallbacks('success', url);\n            return;\n          }\n\n          if (self.states[url] === FAILED) {\n            execCallbacks('failure', url);\n            return;\n          }\n\n          if (self.states[url] !== LOADING) {\n            self.states[url] = LOADING;\n            self.loading++;\n            self.loadScript(url, function () {\n              self.states[url] = LOADED;\n              self.loading--;\n              execCallbacks('success', url);\n              loadScripts();\n            }, function () {\n              self.states[url] = FAILED;\n              self.loading--;\n              failures.push(url);\n              execCallbacks('failure', url);\n              loadScripts();\n            });\n          }\n        });\n\n        if (!self.loading) {\n          var notifyCallbacks = self.queueLoadedCallbacks.slice(0);\n          self.queueLoadedCallbacks.length = 0;\n          each$6(notifyCallbacks, function (callback) {\n            if (failures.length === 0) {\n              if (isFunction(callback.success)) {\n                callback.success.call(callback.scope);\n              }\n            } else {\n              if (isFunction(callback.failure)) {\n                callback.failure.call(callback.scope, failures);\n              }\n            }\n          });\n        }\n      };\n\n      loadScripts();\n    };\n\n    ScriptLoader.ScriptLoader = new ScriptLoader();\n    return ScriptLoader;\n  }();\n\n  var Cell = function (initial) {\n    var value = initial;\n\n    var get = function () {\n      return value;\n    };\n\n    var set = function (v) {\n      value = v;\n    };\n\n    return {\n      get: get,\n      set: set\n    };\n  };\n\n  var isRaw = function (str) {\n    return isObject(str) && has(str, 'raw');\n  };\n\n  var isTokenised = function (str) {\n    return isArray(str) && str.length > 1;\n  };\n\n  var data = {};\n  var currentCode = Cell('en');\n\n  var getLanguageData = function () {\n    return get$1(data, currentCode.get());\n  };\n\n  var getData = function () {\n    return map$1(data, function (value) {\n      return __assign({}, value);\n    });\n  };\n\n  var setCode = function (newCode) {\n    if (newCode) {\n      currentCode.set(newCode);\n    }\n  };\n\n  var getCode = function () {\n    return currentCode.get();\n  };\n\n  var add = function (code, items) {\n    var langData = data[code];\n\n    if (!langData) {\n      data[code] = langData = {};\n    }\n\n    each$1(items, function (translation, name) {\n      langData[name.toLowerCase()] = translation;\n    });\n  };\n\n  var translate = function (text) {\n    var langData = getLanguageData().getOr({});\n\n    var toString = function (obj) {\n      if (isFunction(obj)) {\n        return Object.prototype.toString.call(obj);\n      }\n\n      return !isEmpty(obj) ? '' + obj : '';\n    };\n\n    var isEmpty = function (text) {\n      return text === '' || text === null || text === undefined;\n    };\n\n    var getLangData = function (text) {\n      var textstr = toString(text);\n      return get$1(langData, textstr.toLowerCase()).map(toString).getOr(textstr);\n    };\n\n    var removeContext = function (str) {\n      return str.replace(/{context:\\w+}$/, '');\n    };\n\n    if (isEmpty(text)) {\n      return '';\n    }\n\n    if (isRaw(text)) {\n      return toString(text.raw);\n    }\n\n    if (isTokenised(text)) {\n      var values_1 = text.slice(1);\n      var substitued = getLangData(text[0]).replace(/\\{([0-9]+)\\}/g, function ($1, $2) {\n        return has(values_1, $2) ? toString(values_1[$2]) : $1;\n      });\n      return removeContext(substitued);\n    }\n\n    return removeContext(getLangData(text));\n  };\n\n  var isRtl = function () {\n    return getLanguageData().bind(function (items) {\n      return get$1(items, '_dir');\n    }).exists(function (dir) {\n      return dir === 'rtl';\n    });\n  };\n\n  var hasCode = function (code) {\n    return has(data, code);\n  };\n\n  var I18n = {\n    getData: getData,\n    setCode: setCode,\n    getCode: getCode,\n    add: add,\n    translate: translate,\n    isRtl: isRtl,\n    hasCode: hasCode\n  };\n\n  var AddOnManager = function () {\n    var items = [];\n    var urls = {};\n    var lookup = {};\n    var _listeners = [];\n\n    var runListeners = function (name, state) {\n      var matchedListeners = filter(_listeners, function (listener) {\n        return listener.name === name && listener.state === state;\n      });\n      each(matchedListeners, function (listener) {\n        return listener.callback();\n      });\n    };\n\n    var get = function (name) {\n      if (lookup[name]) {\n        return lookup[name].instance;\n      }\n\n      return undefined;\n    };\n\n    var dependencies = function (name) {\n      var result;\n\n      if (lookup[name]) {\n        result = lookup[name].dependencies;\n      }\n\n      return result || [];\n    };\n\n    var requireLangPack = function (name, languages) {\n      if (AddOnManager.languageLoad !== false) {\n        waitFor(name, function () {\n          var language = I18n.getCode();\n          var wrappedLanguages = ',' + (languages || '') + ',';\n\n          if (!language || languages && wrappedLanguages.indexOf(',' + language + ',') === -1) {\n            return;\n          }\n\n          ScriptLoader.ScriptLoader.add(urls[name] + '/langs/' + language + '.js');\n        }, 'loaded');\n      }\n    };\n\n    var add = function (id, addOn, dependencies) {\n      var addOnConstructor = addOn;\n      items.push(addOnConstructor);\n      lookup[id] = {\n        instance: addOnConstructor,\n        dependencies: dependencies\n      };\n      runListeners(id, 'added');\n      return addOnConstructor;\n    };\n\n    var remove = function (name) {\n      delete urls[name];\n      delete lookup[name];\n    };\n\n    var createUrl = function (baseUrl, dep) {\n      if (typeof dep === 'object') {\n        return dep;\n      }\n\n      return typeof baseUrl === 'string' ? {\n        prefix: '',\n        resource: dep,\n        suffix: ''\n      } : {\n        prefix: baseUrl.prefix,\n        resource: dep,\n        suffix: baseUrl.suffix\n      };\n    };\n\n    var addComponents = function (pluginName, scripts) {\n      var pluginUrl = urls[pluginName];\n      each(scripts, function (script) {\n        ScriptLoader.ScriptLoader.add(pluginUrl + '/' + script);\n      });\n    };\n\n    var loadDependencies = function (name, addOnUrl, success, scope) {\n      var deps = dependencies(name);\n      each(deps, function (dep) {\n        var newUrl = createUrl(addOnUrl, dep);\n        load(newUrl.resource, newUrl, undefined, undefined);\n      });\n\n      if (success) {\n        if (scope) {\n          success.call(scope);\n        } else {\n          success.call(ScriptLoader);\n        }\n      }\n    };\n\n    var load = function (name, addOnUrl, success, scope, failure) {\n      if (urls[name]) {\n        return;\n      }\n\n      var urlString = typeof addOnUrl === 'string' ? addOnUrl : addOnUrl.prefix + addOnUrl.resource + addOnUrl.suffix;\n\n      if (urlString.indexOf('/') !== 0 && urlString.indexOf('://') === -1) {\n        urlString = AddOnManager.baseURL + '/' + urlString;\n      }\n\n      urls[name] = urlString.substring(0, urlString.lastIndexOf('/'));\n\n      var done = function () {\n        runListeners(name, 'loaded');\n        loadDependencies(name, addOnUrl, success, scope);\n      };\n\n      if (lookup[name]) {\n        done();\n      } else {\n        ScriptLoader.ScriptLoader.add(urlString, done, scope, failure);\n      }\n    };\n\n    var waitFor = function (name, callback, state) {\n      if (state === void 0) {\n        state = 'added';\n      }\n\n      if (has(lookup, name) && state === 'added') {\n        callback();\n      } else if (has(urls, name) && state === 'loaded') {\n        callback();\n      } else {\n        _listeners.push({\n          name: name,\n          state: state,\n          callback: callback\n        });\n      }\n    };\n\n    return {\n      items: items,\n      urls: urls,\n      lookup: lookup,\n      _listeners: _listeners,\n      get: get,\n      dependencies: dependencies,\n      requireLangPack: requireLangPack,\n      add: add,\n      remove: remove,\n      createUrl: createUrl,\n      addComponents: addComponents,\n      load: load,\n      waitFor: waitFor\n    };\n  };\n\n  AddOnManager.languageLoad = true;\n  AddOnManager.baseURL = '';\n  AddOnManager.PluginManager = AddOnManager();\n  AddOnManager.ThemeManager = AddOnManager();\n\n  var first = function (fn, rate) {\n    var timer = null;\n\n    var cancel = function () {\n      if (timer !== null) {\n        clearTimeout(timer);\n        timer = null;\n      }\n    };\n\n    var throttle = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (timer === null) {\n        timer = setTimeout(function () {\n          fn.apply(null, args);\n          timer = null;\n        }, rate);\n      }\n    };\n\n    return {\n      cancel: cancel,\n      throttle: throttle\n    };\n  };\n\n  var last$2 = function (fn, rate) {\n    var timer = null;\n\n    var cancel = function () {\n      if (timer !== null) {\n        clearTimeout(timer);\n        timer = null;\n      }\n    };\n\n    var throttle = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (timer !== null) {\n        clearTimeout(timer);\n      }\n\n      timer = setTimeout(function () {\n        fn.apply(null, args);\n        timer = null;\n      }, rate);\n    };\n\n    return {\n      cancel: cancel,\n      throttle: throttle\n    };\n  };\n\n  var read = function (element, attr) {\n    var value = get$4(element, attr);\n    return value === undefined || value === '' ? [] : value.split(' ');\n  };\n\n  var add$1 = function (element, attr, id) {\n    var old = read(element, attr);\n    var nu = old.concat([id]);\n    set(element, attr, nu.join(' '));\n    return true;\n  };\n\n  var remove$2 = function (element, attr, id) {\n    var nu = filter(read(element, attr), function (v) {\n      return v !== id;\n    });\n\n    if (nu.length > 0) {\n      set(element, attr, nu.join(' '));\n    } else {\n      remove$1(element, attr);\n    }\n\n    return false;\n  };\n\n  var supports = function (element) {\n    return element.dom.classList !== undefined;\n  };\n\n  var get$6 = function (element) {\n    return read(element, 'class');\n  };\n\n  var add$2 = function (element, clazz) {\n    return add$1(element, 'class', clazz);\n  };\n\n  var remove$3 = function (element, clazz) {\n    return remove$2(element, 'class', clazz);\n  };\n\n  var add$3 = function (element, clazz) {\n    if (supports(element)) {\n      element.dom.classList.add(clazz);\n    } else {\n      add$2(element, clazz);\n    }\n  };\n\n  var cleanClass = function (element) {\n    var classList = supports(element) ? element.dom.classList : get$6(element);\n\n    if (classList.length === 0) {\n      remove$1(element, 'class');\n    }\n  };\n\n  var remove$4 = function (element, clazz) {\n    if (supports(element)) {\n      var classList = element.dom.classList;\n      classList.remove(clazz);\n    } else {\n      remove$3(element, clazz);\n    }\n\n    cleanClass(element);\n  };\n\n  var has$2 = function (element, clazz) {\n    return supports(element) && element.dom.classList.contains(clazz);\n  };\n\n  var descendants = function (scope, predicate) {\n    var result = [];\n    each(children(scope), function (x) {\n      if (predicate(x)) {\n        result = result.concat([x]);\n      }\n\n      result = result.concat(descendants(x, predicate));\n    });\n    return result;\n  };\n\n  var descendants$1 = function (scope, selector) {\n    return all(selector, scope);\n  };\n\n  var annotation = constant('mce-annotation');\n  var dataAnnotation = constant('data-mce-annotation');\n  var dataAnnotationId = constant('data-mce-annotation-uid');\n\n  var identify = function (editor, annotationName) {\n    var rng = editor.selection.getRng();\n    var start = SugarElement.fromDom(rng.startContainer);\n    var root = SugarElement.fromDom(editor.getBody());\n    var selector = annotationName.fold(function () {\n      return '.' + annotation();\n    }, function (an) {\n      return '[' + dataAnnotation() + '=\"' + an + '\"]';\n    });\n    var newStart = child(start, rng.startOffset).getOr(start);\n    var closest = closest$1(newStart, selector, function (n) {\n      return eq$2(n, root);\n    });\n\n    var getAttr = function (c, property) {\n      if (has$1(c, property)) {\n        return Optional.some(get$4(c, property));\n      } else {\n        return Optional.none();\n      }\n    };\n\n    return closest.bind(function (c) {\n      return getAttr(c, '' + dataAnnotationId()).bind(function (uid) {\n        return getAttr(c, '' + dataAnnotation()).map(function (name) {\n          var elements = findMarkers(editor, uid);\n          return {\n            uid: uid,\n            name: name,\n            elements: elements\n          };\n        });\n      });\n    });\n  };\n\n  var isAnnotation = function (elem) {\n    return isElement(elem) && has$2(elem, annotation());\n  };\n\n  var findMarkers = function (editor, uid) {\n    var body = SugarElement.fromDom(editor.getBody());\n    return descendants$1(body, '[' + dataAnnotationId() + '=\"' + uid + '\"]');\n  };\n\n  var findAll = function (editor, name) {\n    var body = SugarElement.fromDom(editor.getBody());\n    var markers = descendants$1(body, '[' + dataAnnotation() + '=\"' + name + '\"]');\n    var directory = {};\n    each(markers, function (m) {\n      var uid = get$4(m, dataAnnotationId());\n      var nodesAlready = directory.hasOwnProperty(uid) ? directory[uid] : [];\n      directory[uid] = nodesAlready.concat([m]);\n    });\n    return directory;\n  };\n\n  var setup = function (editor, _registry) {\n    var changeCallbacks = Cell({});\n\n    var initData = function () {\n      return {\n        listeners: [],\n        previous: Cell(Optional.none())\n      };\n    };\n\n    var withCallbacks = function (name, f) {\n      updateCallbacks(name, function (data) {\n        f(data);\n        return data;\n      });\n    };\n\n    var updateCallbacks = function (name, f) {\n      var callbackMap = changeCallbacks.get();\n      var data = callbackMap.hasOwnProperty(name) ? callbackMap[name] : initData();\n      var outputData = f(data);\n      callbackMap[name] = outputData;\n      changeCallbacks.set(callbackMap);\n    };\n\n    var fireCallbacks = function (name, uid, elements) {\n      withCallbacks(name, function (data) {\n        each(data.listeners, function (f) {\n          return f(true, name, {\n            uid: uid,\n            nodes: map(elements, function (elem) {\n              return elem.dom;\n            })\n          });\n        });\n      });\n    };\n\n    var fireNoAnnotation = function (name) {\n      withCallbacks(name, function (data) {\n        each(data.listeners, function (f) {\n          return f(false, name);\n        });\n      });\n    };\n\n    var onNodeChange = last$2(function () {\n      var callbackMap = changeCallbacks.get();\n      var annotations = sort$1(keys(callbackMap));\n      each(annotations, function (name) {\n        updateCallbacks(name, function (data) {\n          var prev = data.previous.get();\n          identify(editor, Optional.some(name)).fold(function () {\n            if (prev.isSome()) {\n              fireNoAnnotation(name);\n              data.previous.set(Optional.none());\n            }\n          }, function (_a) {\n            var uid = _a.uid,\n                name = _a.name,\n                elements = _a.elements;\n\n            if (!prev.is(uid)) {\n              fireCallbacks(name, uid, elements);\n              data.previous.set(Optional.some(uid));\n            }\n          });\n          return {\n            previous: data.previous,\n            listeners: data.listeners\n          };\n        });\n      });\n    }, 30);\n    editor.on('remove', function () {\n      onNodeChange.cancel();\n    });\n    editor.on('NodeChange', function () {\n      onNodeChange.throttle();\n    });\n\n    var addListener = function (name, f) {\n      updateCallbacks(name, function (data) {\n        return {\n          previous: data.previous,\n          listeners: data.listeners.concat([f])\n        };\n      });\n    };\n\n    return {\n      addListener: addListener\n    };\n  };\n\n  var setup$1 = function (editor, registry) {\n    var identifyParserNode = function (span) {\n      return Optional.from(span.attr(dataAnnotation())).bind(registry.lookup);\n    };\n\n    editor.on('init', function () {\n      editor.serializer.addNodeFilter('span', function (spans) {\n        each(spans, function (span) {\n          identifyParserNode(span).each(function (settings) {\n            if (settings.persistent === false) {\n              span.unwrap();\n            }\n          });\n        });\n      });\n    });\n  };\n\n  var create$2 = function () {\n    var annotations = {};\n\n    var register = function (name, settings) {\n      annotations[name] = {\n        name: name,\n        settings: settings\n      };\n    };\n\n    var lookup = function (name) {\n      return annotations.hasOwnProperty(name) ? Optional.from(annotations[name]).map(function (a) {\n        return a.settings;\n      }) : Optional.none();\n    };\n\n    return {\n      register: register,\n      lookup: lookup\n    };\n  };\n\n  var unique = 0;\n\n  var generate$1 = function (prefix) {\n    var date = new Date();\n    var time = date.getTime();\n    var random = Math.floor(Math.random() * 1000000000);\n    unique++;\n    return prefix + '_' + random + unique + String(time);\n  };\n\n  var add$4 = function (element, classes) {\n    each(classes, function (x) {\n      add$3(element, x);\n    });\n  };\n\n  var fromHtml$1 = function (html, scope) {\n    var doc = scope || document;\n    var div = doc.createElement('div');\n    div.innerHTML = html;\n    return children(SugarElement.fromDom(div));\n  };\n\n  var get$7 = function (element) {\n    return element.dom.innerHTML;\n  };\n\n  var set$1 = function (element, content) {\n    var owner$1 = owner(element);\n    var docDom = owner$1.dom;\n    var fragment = SugarElement.fromDom(docDom.createDocumentFragment());\n    var contentElements = fromHtml$1(content, docDom);\n    append$1(fragment, contentElements);\n    empty(element);\n    append(element, fragment);\n  };\n\n  var clone$1 = function (original, isDeep) {\n    return SugarElement.fromDom(original.dom.cloneNode(isDeep));\n  };\n\n  var shallow = function (original) {\n    return clone$1(original, false);\n  };\n\n  var deep = function (original) {\n    return clone$1(original, true);\n  };\n\n  var TextWalker = function (startNode, rootNode, isBoundary) {\n    if (isBoundary === void 0) {\n      isBoundary = never;\n    }\n\n    var walker = new DomTreeWalker(startNode, rootNode);\n\n    var walk = function (direction) {\n      var next;\n\n      do {\n        next = walker[direction]();\n      } while (next && !isText$1(next) && !isBoundary(next));\n\n      return Optional.from(next).filter(isText$1);\n    };\n\n    return {\n      current: function () {\n        return Optional.from(walker.current()).filter(isText$1);\n      },\n      next: function () {\n        return walk('next');\n      },\n      prev: function () {\n        return walk('prev');\n      },\n      prev2: function () {\n        return walk('prev2');\n      }\n    };\n  };\n\n  var TextSeeker = function (dom, isBoundary) {\n    var isBlockBoundary = isBoundary ? isBoundary : function (node) {\n      return dom.isBlock(node) || isBr(node) || isContentEditableFalse(node);\n    };\n\n    var walk = function (node, offset, walker, process) {\n      if (isText$1(node)) {\n        var newOffset = process(node, offset, node.data);\n\n        if (newOffset !== -1) {\n          return Optional.some({\n            container: node,\n            offset: newOffset\n          });\n        }\n      }\n\n      return walker().bind(function (next) {\n        return walk(next.container, next.offset, walker, process);\n      });\n    };\n\n    var backwards = function (node, offset, process, root) {\n      var walker = TextWalker(node, root, isBlockBoundary);\n      return walk(node, offset, function () {\n        return walker.prev().map(function (prev) {\n          return {\n            container: prev,\n            offset: prev.length\n          };\n        });\n      }, process).getOrNull();\n    };\n\n    var forwards = function (node, offset, process, root) {\n      var walker = TextWalker(node, root, isBlockBoundary);\n      return walk(node, offset, function () {\n        return walker.next().map(function (next) {\n          return {\n            container: next,\n            offset: 0\n          };\n        });\n      }, process).getOrNull();\n    };\n\n    return {\n      backwards: backwards,\n      forwards: forwards\n    };\n  };\n\n  var cat = function (arr) {\n    var r = [];\n\n    var push = function (x) {\n      r.push(x);\n    };\n\n    for (var i = 0; i < arr.length; i++) {\n      arr[i].each(push);\n    }\n\n    return r;\n  };\n\n  var lift2 = function (oa, ob, f) {\n    return oa.isSome() && ob.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie())) : Optional.none();\n  };\n\n  var lift3 = function (oa, ob, oc, f) {\n    return oa.isSome() && ob.isSome() && oc.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie(), oc.getOrDie())) : Optional.none();\n  };\n\n  var someIf = function (b, a) {\n    return b ? Optional.some(a) : Optional.none();\n  };\n\n  var round = Math.round;\n\n  var clone$2 = function (rect) {\n    if (!rect) {\n      return {\n        left: 0,\n        top: 0,\n        bottom: 0,\n        right: 0,\n        width: 0,\n        height: 0\n      };\n    }\n\n    return {\n      left: round(rect.left),\n      top: round(rect.top),\n      bottom: round(rect.bottom),\n      right: round(rect.right),\n      width: round(rect.width),\n      height: round(rect.height)\n    };\n  };\n\n  var collapse = function (rect, toStart) {\n    rect = clone$2(rect);\n\n    if (toStart) {\n      rect.right = rect.left;\n    } else {\n      rect.left = rect.left + rect.width;\n      rect.right = rect.left;\n    }\n\n    rect.width = 0;\n    return rect;\n  };\n\n  var isEqual = function (rect1, rect2) {\n    return rect1.left === rect2.left && rect1.top === rect2.top && rect1.bottom === rect2.bottom && rect1.right === rect2.right;\n  };\n\n  var isValidOverflow = function (overflowY, rect1, rect2) {\n    return overflowY >= 0 && overflowY <= Math.min(rect1.height, rect2.height) / 2;\n  };\n\n  var isAbove = function (rect1, rect2) {\n    var halfHeight = Math.min(rect2.height / 2, rect1.height / 2);\n\n    if (rect1.bottom - halfHeight < rect2.top) {\n      return true;\n    }\n\n    if (rect1.top > rect2.bottom) {\n      return false;\n    }\n\n    return isValidOverflow(rect2.top - rect1.bottom, rect1, rect2);\n  };\n\n  var isBelow = function (rect1, rect2) {\n    if (rect1.top > rect2.bottom) {\n      return true;\n    }\n\n    if (rect1.bottom < rect2.top) {\n      return false;\n    }\n\n    return isValidOverflow(rect2.bottom - rect1.top, rect1, rect2);\n  };\n\n  var containsXY = function (rect, clientX, clientY) {\n    return clientX >= rect.left && clientX <= rect.right && clientY >= rect.top && clientY <= rect.bottom;\n  };\n\n  var getSelectedNode = function (range) {\n    var startContainer = range.startContainer,\n        startOffset = range.startOffset;\n\n    if (startContainer.hasChildNodes() && range.endOffset === startOffset + 1) {\n      return startContainer.childNodes[startOffset];\n    }\n\n    return null;\n  };\n\n  var getNode = function (container, offset) {\n    if (container.nodeType === 1 && container.hasChildNodes()) {\n      if (offset >= container.childNodes.length) {\n        offset = container.childNodes.length - 1;\n      }\n\n      container = container.childNodes[offset];\n    }\n\n    return container;\n  };\n\n  var extendingChars = new RegExp('[\\u0300-\\u036f\\u0483-\\u0487\\u0488-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1-\\u05c2\\u05c4-\\u05c5\\u05c7\\u0610-\\u061a' + '\\u064b-\\u065f\\u0670\\u06d6-\\u06dc\\u06df-\\u06e4\\u06e7-\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0' + '\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0859-\\u085b\\u08e3-\\u0902\\u093a\\u093c' + '\\u0941-\\u0948\\u094d\\u0951-\\u0957\\u0962-\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2-\\u09e3' + '\\u0a01-\\u0a02\\u0a3c\\u0a41-\\u0a42\\u0a47-\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70-\\u0a71\\u0a75\\u0a81-\\u0a82\\u0abc' + '\\u0ac1-\\u0ac5\\u0ac7-\\u0ac8\\u0acd\\u0ae2-\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57' + '\\u0b62-\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c00\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55-\\u0c56' + '\\u0c62-\\u0c63\\u0c81\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc-\\u0ccd\\u0cd5-\\u0cd6\\u0ce2-\\u0ce3\\u0d01\\u0d3e\\u0d41-\\u0d44' + '\\u0d4d\\u0d57\\u0d62-\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9' + '\\u0ebb-\\u0ebc\\u0ec8-\\u0ecd\\u0f18-\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86-\\u0f87\\u0f8d-\\u0f97' + '\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039-\\u103a\\u103d-\\u103e\\u1058-\\u1059\\u105e-\\u1060\\u1071-\\u1074' + '\\u1082\\u1085-\\u1086\\u108d\\u109d\\u135d-\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752-\\u1753\\u1772-\\u1773\\u17b4-\\u17b5' + '\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927-\\u1928\\u1932\\u1939-\\u193b\\u1a17-\\u1a18' + '\\u1a1b\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1ab0-\\u1abd\\u1ABE\\u1b00-\\u1b03\\u1b34' + '\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80-\\u1b81\\u1ba2-\\u1ba5\\u1ba8-\\u1ba9\\u1bab-\\u1bad\\u1be6\\u1be8-\\u1be9' + '\\u1bed\\u1bef-\\u1bf1\\u1c2c-\\u1c33\\u1c36-\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1cf4\\u1cf8-\\u1cf9' + '\\u1dc0-\\u1df5\\u1dfc-\\u1dff\\u200c-\\u200d\\u20d0-\\u20dc\\u20DD-\\u20E0\\u20e1\\u20E2-\\u20E4\\u20e5-\\u20f0\\u2cef-\\u2cf1' + '\\u2d7f\\u2de0-\\u2dff\\u302a-\\u302d\\u302e-\\u302f\\u3099-\\u309a\\ua66f\\uA670-\\uA672\\ua674-\\ua67d\\ua69e-\\ua69f\\ua6f0-\\ua6f1' + '\\ua802\\ua806\\ua80b\\ua825-\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc' + '\\ua9e5\\uaa29-\\uaa2e\\uaa31-\\uaa32\\uaa35-\\uaa36\\uaa43\\uaa4c\\uaa7c\\uaab0\\uaab2-\\uaab4\\uaab7-\\uaab8\\uaabe-\\uaabf\\uaac1' + '\\uaaec-\\uaaed\\uaaf6\\uabe5\\uabe8\\uabed\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe2f\\uff9e-\\uff9f]');\n\n  var isExtendingChar = function (ch) {\n    return typeof ch === 'string' && ch.charCodeAt(0) >= 768 && extendingChars.test(ch);\n  };\n\n  var or = function () {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n\n    return function (x) {\n      for (var i = 0; i < args.length; i++) {\n        if (args[i](x)) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n  };\n\n  var and = function () {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n\n    return function (x) {\n      for (var i = 0; i < args.length; i++) {\n        if (!args[i](x)) {\n          return false;\n        }\n      }\n\n      return true;\n    };\n  };\n\n  var isElement$3 = isElement$1;\n  var isCaretCandidate$1 = isCaretCandidate;\n  var isBlock$1 = matchStyleValues('display', 'block table');\n  var isFloated = matchStyleValues('float', 'left right');\n  var isValidElementCaretCandidate = and(isElement$3, isCaretCandidate$1, not(isFloated));\n  var isNotPre = not(matchStyleValues('white-space', 'pre pre-line pre-wrap'));\n  var isText$4 = isText$1;\n  var isBr$3 = isBr;\n  var nodeIndex = DOMUtils.nodeIndex;\n  var resolveIndex = getNode;\n\n  var createRange = function (doc) {\n    return 'createRange' in doc ? doc.createRange() : DOMUtils.DOM.createRng();\n  };\n\n  var isWhiteSpace = function (chr) {\n    return chr && /[\\r\\n\\t ]/.test(chr);\n  };\n\n  var isRange = function (rng) {\n    return !!rng.setStart && !!rng.setEnd;\n  };\n\n  var isHiddenWhiteSpaceRange = function (range) {\n    var container = range.startContainer;\n    var offset = range.startOffset;\n    var text;\n\n    if (isWhiteSpace(range.toString()) && isNotPre(container.parentNode) && isText$1(container)) {\n      text = container.data;\n\n      if (isWhiteSpace(text[offset - 1]) || isWhiteSpace(text[offset + 1])) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var getBrClientRect = function (brNode) {\n    var doc = brNode.ownerDocument;\n    var rng = createRange(doc);\n    var nbsp$1 = doc.createTextNode(nbsp);\n    var parentNode = brNode.parentNode;\n    parentNode.insertBefore(nbsp$1, brNode);\n    rng.setStart(nbsp$1, 0);\n    rng.setEnd(nbsp$1, 1);\n    var clientRect = clone$2(rng.getBoundingClientRect());\n    parentNode.removeChild(nbsp$1);\n    return clientRect;\n  };\n\n  var getBoundingClientRectWebKitText = function (rng) {\n    var sc = rng.startContainer;\n    var ec = rng.endContainer;\n    var so = rng.startOffset;\n    var eo = rng.endOffset;\n\n    if (sc === ec && isText$1(ec) && so === 0 && eo === 1) {\n      var newRng = rng.cloneRange();\n      newRng.setEndAfter(ec);\n      return getBoundingClientRect(newRng);\n    } else {\n      return null;\n    }\n  };\n\n  var isZeroRect = function (r) {\n    return r.left === 0 && r.right === 0 && r.top === 0 && r.bottom === 0;\n  };\n\n  var getBoundingClientRect = function (item) {\n    var clientRect;\n    var clientRects = item.getClientRects();\n\n    if (clientRects.length > 0) {\n      clientRect = clone$2(clientRects[0]);\n    } else {\n      clientRect = clone$2(item.getBoundingClientRect());\n    }\n\n    if (!isRange(item) && isBr$3(item) && isZeroRect(clientRect)) {\n      return getBrClientRect(item);\n    }\n\n    if (isZeroRect(clientRect) && isRange(item)) {\n      return getBoundingClientRectWebKitText(item);\n    }\n\n    return clientRect;\n  };\n\n  var collapseAndInflateWidth = function (clientRect, toStart) {\n    var newClientRect = collapse(clientRect, toStart);\n    newClientRect.width = 1;\n    newClientRect.right = newClientRect.left + 1;\n    return newClientRect;\n  };\n\n  var getCaretPositionClientRects = function (caretPosition) {\n    var clientRects = [];\n    var beforeNode, node;\n\n    var addUniqueAndValidRect = function (clientRect) {\n      if (clientRect.height === 0) {\n        return;\n      }\n\n      if (clientRects.length > 0) {\n        if (isEqual(clientRect, clientRects[clientRects.length - 1])) {\n          return;\n        }\n      }\n\n      clientRects.push(clientRect);\n    };\n\n    var addCharacterOffset = function (container, offset) {\n      var range = createRange(container.ownerDocument);\n\n      if (offset < container.data.length) {\n        if (isExtendingChar(container.data[offset])) {\n          return clientRects;\n        }\n\n        if (isExtendingChar(container.data[offset - 1])) {\n          range.setStart(container, offset);\n          range.setEnd(container, offset + 1);\n\n          if (!isHiddenWhiteSpaceRange(range)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range), false));\n            return clientRects;\n          }\n        }\n      }\n\n      if (offset > 0) {\n        range.setStart(container, offset - 1);\n        range.setEnd(container, offset);\n\n        if (!isHiddenWhiteSpaceRange(range)) {\n          addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range), false));\n        }\n      }\n\n      if (offset < container.data.length) {\n        range.setStart(container, offset);\n        range.setEnd(container, offset + 1);\n\n        if (!isHiddenWhiteSpaceRange(range)) {\n          addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range), true));\n        }\n      }\n    };\n\n    if (isText$4(caretPosition.container())) {\n      addCharacterOffset(caretPosition.container(), caretPosition.offset());\n      return clientRects;\n    }\n\n    if (isElement$3(caretPosition.container())) {\n      if (caretPosition.isAtEnd()) {\n        node = resolveIndex(caretPosition.container(), caretPosition.offset());\n\n        if (isText$4(node)) {\n          addCharacterOffset(node, node.data.length);\n        }\n\n        if (isValidElementCaretCandidate(node) && !isBr$3(node)) {\n          addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node), false));\n        }\n      } else {\n        node = resolveIndex(caretPosition.container(), caretPosition.offset());\n\n        if (isText$4(node)) {\n          addCharacterOffset(node, 0);\n        }\n\n        if (isValidElementCaretCandidate(node) && caretPosition.isAtEnd()) {\n          addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node), false));\n          return clientRects;\n        }\n\n        beforeNode = resolveIndex(caretPosition.container(), caretPosition.offset() - 1);\n\n        if (isValidElementCaretCandidate(beforeNode) && !isBr$3(beforeNode)) {\n          if (isBlock$1(beforeNode) || isBlock$1(node) || !isValidElementCaretCandidate(node)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(beforeNode), false));\n          }\n        }\n\n        if (isValidElementCaretCandidate(node)) {\n          addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node), true));\n        }\n      }\n    }\n\n    return clientRects;\n  };\n\n  var CaretPosition = function (container, offset, clientRects) {\n    var isAtStart = function () {\n      if (isText$4(container)) {\n        return offset === 0;\n      }\n\n      return offset === 0;\n    };\n\n    var isAtEnd = function () {\n      if (isText$4(container)) {\n        return offset >= container.data.length;\n      }\n\n      return offset >= container.childNodes.length;\n    };\n\n    var toRange = function () {\n      var range = createRange(container.ownerDocument);\n      range.setStart(container, offset);\n      range.setEnd(container, offset);\n      return range;\n    };\n\n    var getClientRects = function () {\n      if (!clientRects) {\n        clientRects = getCaretPositionClientRects(CaretPosition(container, offset));\n      }\n\n      return clientRects;\n    };\n\n    var isVisible = function () {\n      return getClientRects().length > 0;\n    };\n\n    var isEqual = function (caretPosition) {\n      return caretPosition && container === caretPosition.container() && offset === caretPosition.offset();\n    };\n\n    var getNode = function (before) {\n      return resolveIndex(container, before ? offset - 1 : offset);\n    };\n\n    return {\n      container: constant(container),\n      offset: constant(offset),\n      toRange: toRange,\n      getClientRects: getClientRects,\n      isVisible: isVisible,\n      isAtStart: isAtStart,\n      isAtEnd: isAtEnd,\n      isEqual: isEqual,\n      getNode: getNode\n    };\n  };\n\n  CaretPosition.fromRangeStart = function (range) {\n    return CaretPosition(range.startContainer, range.startOffset);\n  };\n\n  CaretPosition.fromRangeEnd = function (range) {\n    return CaretPosition(range.endContainer, range.endOffset);\n  };\n\n  CaretPosition.after = function (node) {\n    return CaretPosition(node.parentNode, nodeIndex(node) + 1);\n  };\n\n  CaretPosition.before = function (node) {\n    return CaretPosition(node.parentNode, nodeIndex(node));\n  };\n\n  CaretPosition.isAbove = function (pos1, pos2) {\n    return lift2(head(pos2.getClientRects()), last(pos1.getClientRects()), isAbove).getOr(false);\n  };\n\n  CaretPosition.isBelow = function (pos1, pos2) {\n    return lift2(last(pos2.getClientRects()), head(pos1.getClientRects()), isBelow).getOr(false);\n  };\n\n  CaretPosition.isAtStart = function (pos) {\n    return pos ? pos.isAtStart() : false;\n  };\n\n  CaretPosition.isAtEnd = function (pos) {\n    return pos ? pos.isAtEnd() : false;\n  };\n\n  CaretPosition.isTextPosition = function (pos) {\n    return pos ? isText$1(pos.container()) : false;\n  };\n\n  CaretPosition.isElementPosition = function (pos) {\n    return CaretPosition.isTextPosition(pos) === false;\n  };\n\n  var trimEmptyTextNode = function (dom, node) {\n    if (isText$1(node) && node.data.length === 0) {\n      dom.remove(node);\n    }\n  };\n\n  var insertNode = function (dom, rng, node) {\n    rng.insertNode(node);\n    trimEmptyTextNode(dom, node.previousSibling);\n    trimEmptyTextNode(dom, node.nextSibling);\n  };\n\n  var insertFragment = function (dom, rng, frag) {\n    var firstChild = Optional.from(frag.firstChild);\n    var lastChild = Optional.from(frag.lastChild);\n    rng.insertNode(frag);\n    firstChild.each(function (child) {\n      return trimEmptyTextNode(dom, child.previousSibling);\n    });\n    lastChild.each(function (child) {\n      return trimEmptyTextNode(dom, child.nextSibling);\n    });\n  };\n\n  var rangeInsertNode = function (dom, rng, node) {\n    if (isDocumentFragment$1(node)) {\n      insertFragment(dom, rng, node);\n    } else {\n      insertNode(dom, rng, node);\n    }\n  };\n\n  var isText$5 = isText$1;\n  var isBogus$2 = isBogus;\n  var nodeIndex$1 = DOMUtils.nodeIndex;\n\n  var normalizedParent = function (node) {\n    var parentNode = node.parentNode;\n\n    if (isBogus$2(parentNode)) {\n      return normalizedParent(parentNode);\n    }\n\n    return parentNode;\n  };\n\n  var getChildNodes = function (node) {\n    if (!node) {\n      return [];\n    }\n\n    return reduce(node.childNodes, function (result, node) {\n      if (isBogus$2(node) && node.nodeName !== 'BR') {\n        result = result.concat(getChildNodes(node));\n      } else {\n        result.push(node);\n      }\n\n      return result;\n    }, []);\n  };\n\n  var normalizedTextOffset = function (node, offset) {\n    while (node = node.previousSibling) {\n      if (!isText$5(node)) {\n        break;\n      }\n\n      offset += node.data.length;\n    }\n\n    return offset;\n  };\n\n  var equal$1 = function (a) {\n    return function (b) {\n      return a === b;\n    };\n  };\n\n  var normalizedNodeIndex = function (node) {\n    var nodes, index;\n    nodes = getChildNodes(normalizedParent(node));\n    index = findIndex$1(nodes, equal$1(node), node);\n    nodes = nodes.slice(0, index + 1);\n    var numTextFragments = reduce(nodes, function (result, node, i) {\n      if (isText$5(node) && isText$5(nodes[i - 1])) {\n        result++;\n      }\n\n      return result;\n    }, 0);\n    nodes = filter$2(nodes, matchNodeNames([node.nodeName]));\n    index = findIndex$1(nodes, equal$1(node), node);\n    return index - numTextFragments;\n  };\n\n  var createPathItem = function (node) {\n    var name;\n\n    if (isText$5(node)) {\n      name = 'text()';\n    } else {\n      name = node.nodeName.toLowerCase();\n    }\n\n    return name + '[' + normalizedNodeIndex(node) + ']';\n  };\n\n  var parentsUntil = function (root, node, predicate) {\n    var parents = [];\n\n    for (node = node.parentNode; node !== root; node = node.parentNode) {\n      if (predicate && predicate(node)) {\n        break;\n      }\n\n      parents.push(node);\n    }\n\n    return parents;\n  };\n\n  var create$3 = function (root, caretPosition) {\n    var container,\n        offset,\n        path = [],\n        outputOffset,\n        childNodes,\n        parents;\n    container = caretPosition.container();\n    offset = caretPosition.offset();\n\n    if (isText$5(container)) {\n      outputOffset = normalizedTextOffset(container, offset);\n    } else {\n      childNodes = container.childNodes;\n\n      if (offset >= childNodes.length) {\n        outputOffset = 'after';\n        offset = childNodes.length - 1;\n      } else {\n        outputOffset = 'before';\n      }\n\n      container = childNodes[offset];\n    }\n\n    path.push(createPathItem(container));\n    parents = parentsUntil(root, container);\n    parents = filter$2(parents, not(isBogus));\n    path = path.concat(map$2(parents, function (node) {\n      return createPathItem(node);\n    }));\n    return path.reverse().join('/') + ',' + outputOffset;\n  };\n\n  var resolvePathItem = function (node, name, index) {\n    var nodes = getChildNodes(node);\n    nodes = filter$2(nodes, function (node, index) {\n      return !isText$5(node) || !isText$5(nodes[index - 1]);\n    });\n    nodes = filter$2(nodes, matchNodeNames([name]));\n    return nodes[index];\n  };\n\n  var findTextPosition = function (container, offset) {\n    var node = container,\n        targetOffset = 0,\n        dataLen;\n\n    while (isText$5(node)) {\n      dataLen = node.data.length;\n\n      if (offset >= targetOffset && offset <= targetOffset + dataLen) {\n        container = node;\n        offset = offset - targetOffset;\n        break;\n      }\n\n      if (!isText$5(node.nextSibling)) {\n        container = node;\n        offset = dataLen;\n        break;\n      }\n\n      targetOffset += dataLen;\n      node = node.nextSibling;\n    }\n\n    if (isText$5(container) && offset > container.data.length) {\n      offset = container.data.length;\n    }\n\n    return CaretPosition(container, offset);\n  };\n\n  var resolve$1 = function (root, path) {\n    var offset;\n\n    if (!path) {\n      return null;\n    }\n\n    var parts = path.split(',');\n    var paths = parts[0].split('/');\n    offset = parts.length > 1 ? parts[1] : 'before';\n    var container = reduce(paths, function (result, value) {\n      var match = /([\\w\\-\\(\\)]+)\\[([0-9]+)\\]/.exec(value);\n\n      if (!match) {\n        return null;\n      }\n\n      if (match[1] === 'text()') {\n        match[1] = '#text';\n      }\n\n      return resolvePathItem(result, match[1], parseInt(match[2], 10));\n    }, root);\n\n    if (!container) {\n      return null;\n    }\n\n    if (!isText$5(container)) {\n      if (offset === 'after') {\n        offset = nodeIndex$1(container) + 1;\n      } else {\n        offset = nodeIndex$1(container);\n      }\n\n      return CaretPosition(container.parentNode, offset);\n    }\n\n    return findTextPosition(container, parseInt(offset, 10));\n  };\n\n  var isContentEditableFalse$2 = isContentEditableFalse;\n\n  var getNormalizedTextOffset = function (trim, container, offset) {\n    var node, trimmedOffset;\n    trimmedOffset = trim(container.data.slice(0, offset)).length;\n\n    for (node = container.previousSibling; node && isText$1(node); node = node.previousSibling) {\n      trimmedOffset += trim(node.data).length;\n    }\n\n    return trimmedOffset;\n  };\n\n  var getPoint = function (dom, trim, normalized, rng, start) {\n    var container = rng[start ? 'startContainer' : 'endContainer'];\n    var offset = rng[start ? 'startOffset' : 'endOffset'];\n    var point = [];\n    var childNodes,\n        after = 0;\n    var root = dom.getRoot();\n\n    if (isText$1(container)) {\n      point.push(normalized ? getNormalizedTextOffset(trim, container, offset) : offset);\n    } else {\n      childNodes = container.childNodes;\n\n      if (offset >= childNodes.length && childNodes.length) {\n        after = 1;\n        offset = Math.max(0, childNodes.length - 1);\n      }\n\n      point.push(dom.nodeIndex(childNodes[offset], normalized) + after);\n    }\n\n    for (; container && container !== root; container = container.parentNode) {\n      point.push(dom.nodeIndex(container, normalized));\n    }\n\n    return point;\n  };\n\n  var getLocation = function (trim, selection, normalized, rng) {\n    var dom = selection.dom,\n        bookmark = {};\n    bookmark.start = getPoint(dom, trim, normalized, rng, true);\n\n    if (!selection.isCollapsed()) {\n      bookmark.end = getPoint(dom, trim, normalized, rng, false);\n    }\n\n    return bookmark;\n  };\n\n  var findIndex$2 = function (dom, name, element) {\n    var count = 0;\n    Tools.each(dom.select(name), function (node) {\n      if (node.getAttribute('data-mce-bogus') === 'all') {\n        return;\n      }\n\n      if (node === element) {\n        return false;\n      }\n\n      count++;\n    });\n    return count;\n  };\n\n  var moveEndPoint = function (rng, start) {\n    var container, offset, childNodes;\n    var prefix = start ? 'start' : 'end';\n    container = rng[prefix + 'Container'];\n    offset = rng[prefix + 'Offset'];\n\n    if (isElement$1(container) && container.nodeName === 'TR') {\n      childNodes = container.childNodes;\n      container = childNodes[Math.min(start ? offset : offset - 1, childNodes.length - 1)];\n\n      if (container) {\n        offset = start ? 0 : container.childNodes.length;\n        rng['set' + (start ? 'Start' : 'End')](container, offset);\n      }\n    }\n  };\n\n  var normalizeTableCellSelection = function (rng) {\n    moveEndPoint(rng, true);\n    moveEndPoint(rng, false);\n    return rng;\n  };\n\n  var findSibling = function (node, offset) {\n    var sibling;\n\n    if (isElement$1(node)) {\n      node = getNode(node, offset);\n\n      if (isContentEditableFalse$2(node)) {\n        return node;\n      }\n    }\n\n    if (isCaretContainer(node)) {\n      if (isText$1(node) && isCaretContainerBlock(node)) {\n        node = node.parentNode;\n      }\n\n      sibling = node.previousSibling;\n\n      if (isContentEditableFalse$2(sibling)) {\n        return sibling;\n      }\n\n      sibling = node.nextSibling;\n\n      if (isContentEditableFalse$2(sibling)) {\n        return sibling;\n      }\n    }\n  };\n\n  var findAdjacentContentEditableFalseElm = function (rng) {\n    return findSibling(rng.startContainer, rng.startOffset) || findSibling(rng.endContainer, rng.endOffset);\n  };\n\n  var getOffsetBookmark = function (trim, normalized, selection) {\n    var element = selection.getNode();\n    var name = element ? element.nodeName : null;\n    var rng = selection.getRng();\n\n    if (isContentEditableFalse$2(element) || name === 'IMG') {\n      return {\n        name: name,\n        index: findIndex$2(selection.dom, name, element)\n      };\n    }\n\n    var sibling = findAdjacentContentEditableFalseElm(rng);\n\n    if (sibling) {\n      name = sibling.tagName;\n      return {\n        name: name,\n        index: findIndex$2(selection.dom, name, sibling)\n      };\n    }\n\n    return getLocation(trim, selection, normalized, rng);\n  };\n\n  var getCaretBookmark = function (selection) {\n    var rng = selection.getRng();\n    return {\n      start: create$3(selection.dom.getRoot(), CaretPosition.fromRangeStart(rng)),\n      end: create$3(selection.dom.getRoot(), CaretPosition.fromRangeEnd(rng))\n    };\n  };\n\n  var getRangeBookmark = function (selection) {\n    return {\n      rng: selection.getRng()\n    };\n  };\n\n  var createBookmarkSpan = function (dom, id, filled) {\n    var args = {\n      'data-mce-type': 'bookmark',\n      id: id,\n      'style': 'overflow:hidden;line-height:0px'\n    };\n    return filled ? dom.create('span', args, '&#xFEFF;') : dom.create('span', args);\n  };\n\n  var getPersistentBookmark = function (selection, filled) {\n    var dom = selection.dom;\n    var rng = selection.getRng();\n    var id = dom.uniqueId();\n    var collapsed = selection.isCollapsed();\n    var element = selection.getNode();\n    var name = element.nodeName;\n\n    if (name === 'IMG') {\n      return {\n        name: name,\n        index: findIndex$2(dom, name, element)\n      };\n    }\n\n    var rng2 = normalizeTableCellSelection(rng.cloneRange());\n\n    if (!collapsed) {\n      rng2.collapse(false);\n      var endBookmarkNode = createBookmarkSpan(dom, id + '_end', filled);\n      rangeInsertNode(dom, rng2, endBookmarkNode);\n    }\n\n    rng = normalizeTableCellSelection(rng);\n    rng.collapse(true);\n    var startBookmarkNode = createBookmarkSpan(dom, id + '_start', filled);\n    rangeInsertNode(dom, rng, startBookmarkNode);\n    selection.moveToBookmark({\n      id: id,\n      keep: true\n    });\n    return {\n      id: id\n    };\n  };\n\n  var getBookmark = function (selection, type, normalized) {\n    if (type === 2) {\n      return getOffsetBookmark(trim$2, normalized, selection);\n    } else if (type === 3) {\n      return getCaretBookmark(selection);\n    } else if (type) {\n      return getRangeBookmark(selection);\n    } else {\n      return getPersistentBookmark(selection, false);\n    }\n  };\n\n  var getUndoBookmark = curry(getOffsetBookmark, identity, true);\n  var DOM$1 = DOMUtils.DOM;\n  var defaultPreviewStyles = 'font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow';\n\n  var getBodySetting = function (editor, name, defaultValue) {\n    var value = editor.getParam(name, defaultValue);\n\n    if (value.indexOf('=') !== -1) {\n      var bodyObj = editor.getParam(name, '', 'hash');\n      return bodyObj.hasOwnProperty(editor.id) ? bodyObj[editor.id] : defaultValue;\n    } else {\n      return value;\n    }\n  };\n\n  var getIframeAttrs = function (editor) {\n    return editor.getParam('iframe_attrs', {});\n  };\n\n  var getDocType = function (editor) {\n    return editor.getParam('doctype', '<!DOCTYPE html>');\n  };\n\n  var getDocumentBaseUrl = function (editor) {\n    return editor.getParam('document_base_url', '');\n  };\n\n  var getBodyId = function (editor) {\n    return getBodySetting(editor, 'body_id', 'tinymce');\n  };\n\n  var getBodyClass = function (editor) {\n    return getBodySetting(editor, 'body_class', '');\n  };\n\n  var getContentSecurityPolicy = function (editor) {\n    return editor.getParam('content_security_policy', '');\n  };\n\n  var shouldPutBrInPre = function (editor) {\n    return editor.getParam('br_in_pre', true);\n  };\n\n  var getForcedRootBlock = function (editor) {\n    if (editor.getParam('force_p_newlines', false)) {\n      return 'p';\n    }\n\n    var block = editor.getParam('forced_root_block', 'p');\n\n    if (block === false) {\n      return '';\n    } else if (block === true) {\n      return 'p';\n    } else {\n      return block;\n    }\n  };\n\n  var getForcedRootBlockAttrs = function (editor) {\n    return editor.getParam('forced_root_block_attrs', {});\n  };\n\n  var getBrNewLineSelector = function (editor) {\n    return editor.getParam('br_newline_selector', '.mce-toc h2,figcaption,caption');\n  };\n\n  var getNoNewLineSelector = function (editor) {\n    return editor.getParam('no_newline_selector', '');\n  };\n\n  var shouldKeepStyles = function (editor) {\n    return editor.getParam('keep_styles', true);\n  };\n\n  var shouldEndContainerOnEmptyBlock = function (editor) {\n    return editor.getParam('end_container_on_empty_block', false);\n  };\n\n  var getFontStyleValues = function (editor) {\n    return Tools.explode(editor.getParam('font_size_style_values', 'xx-small,x-small,small,medium,large,x-large,xx-large'));\n  };\n\n  var getFontSizeClasses = function (editor) {\n    return Tools.explode(editor.getParam('font_size_classes', ''));\n  };\n\n  var getImagesDataImgFilter = function (editor) {\n    return editor.getParam('images_dataimg_filter', always, 'function');\n  };\n\n  var isAutomaticUploadsEnabled = function (editor) {\n    return editor.getParam('automatic_uploads', true, 'boolean');\n  };\n\n  var shouldReuseFileName = function (editor) {\n    return editor.getParam('images_reuse_filename', false, 'boolean');\n  };\n\n  var shouldReplaceBlobUris = function (editor) {\n    return editor.getParam('images_replace_blob_uris', true, 'boolean');\n  };\n\n  var getIconPackName = function (editor) {\n    return editor.getParam('icons', '', 'string');\n  };\n\n  var getIconsUrl = function (editor) {\n    return editor.getParam('icons_url', '', 'string');\n  };\n\n  var getImageUploadUrl = function (editor) {\n    return editor.getParam('images_upload_url', '', 'string');\n  };\n\n  var getImageUploadBasePath = function (editor) {\n    return editor.getParam('images_upload_base_path', '', 'string');\n  };\n\n  var getImagesUploadCredentials = function (editor) {\n    return editor.getParam('images_upload_credentials', false, 'boolean');\n  };\n\n  var getImagesUploadHandler = function (editor) {\n    return editor.getParam('images_upload_handler', null, 'function');\n  };\n\n  var shouldUseContentCssCors = function (editor) {\n    return editor.getParam('content_css_cors', false, 'boolean');\n  };\n\n  var getReferrerPolicy = function (editor) {\n    return editor.getParam('referrer_policy', '', 'string');\n  };\n\n  var getLanguageCode = function (editor) {\n    return editor.getParam('language', 'en', 'string');\n  };\n\n  var getLanguageUrl = function (editor) {\n    return editor.getParam('language_url', '', 'string');\n  };\n\n  var shouldIndentUseMargin = function (editor) {\n    return editor.getParam('indent_use_margin', false);\n  };\n\n  var getIndentation = function (editor) {\n    return editor.getParam('indentation', '40px', 'string');\n  };\n\n  var getContentCss = function (editor) {\n    var contentCss = editor.getParam('content_css');\n\n    if (isString(contentCss)) {\n      return map(contentCss.split(','), trim);\n    } else if (isArray(contentCss)) {\n      return contentCss;\n    } else if (contentCss === false || editor.inline) {\n      return [];\n    } else {\n      return ['default'];\n    }\n  };\n\n  var getFontCss = function (editor) {\n    var fontCss = editor.getParam('font_css', []);\n    return isArray(fontCss) ? fontCss : map(fontCss.split(','), trim);\n  };\n\n  var getDirectionality = function (editor) {\n    return editor.getParam('directionality', I18n.isRtl() ? 'rtl' : undefined);\n  };\n\n  var getInlineBoundarySelector = function (editor) {\n    return editor.getParam('inline_boundaries_selector', 'a[href],code,.mce-annotation', 'string');\n  };\n\n  var getObjectResizing = function (editor) {\n    var selector = editor.getParam('object_resizing');\n\n    if (selector === false || Env.iOS) {\n      return false;\n    } else {\n      return isString(selector) ? selector : 'table,img,figure.image,div,video,iframe';\n    }\n  };\n\n  var getResizeImgProportional = function (editor) {\n    return editor.getParam('resize_img_proportional', true, 'boolean');\n  };\n\n  var getPlaceholder = function (editor) {\n    return editor.getParam('placeholder', DOM$1.getAttrib(editor.getElement(), 'placeholder'), 'string');\n  };\n\n  var getEventRoot = function (editor) {\n    return editor.getParam('event_root');\n  };\n\n  var getServiceMessage = function (editor) {\n    return editor.getParam('service_message');\n  };\n\n  var getTheme = function (editor) {\n    return editor.getParam('theme');\n  };\n\n  var shouldValidate = function (editor) {\n    return editor.getParam('validate');\n  };\n\n  var isInlineBoundariesEnabled = function (editor) {\n    return editor.getParam('inline_boundaries') !== false;\n  };\n\n  var getFormats = function (editor) {\n    return editor.getParam('formats');\n  };\n\n  var getPreviewStyles = function (editor) {\n    var style = editor.getParam('preview_styles', defaultPreviewStyles);\n\n    if (isString(style)) {\n      return style;\n    } else {\n      return '';\n    }\n  };\n\n  var canFormatEmptyLines = function (editor) {\n    return editor.getParam('format_empty_lines', false, 'boolean');\n  };\n\n  var getCustomUiSelector = function (editor) {\n    return editor.getParam('custom_ui_selector', '', 'string');\n  };\n\n  var getThemeUrl = function (editor) {\n    return editor.getParam('theme_url');\n  };\n\n  var isInline$1 = function (editor) {\n    return editor.getParam('inline');\n  };\n\n  var hasHiddenInput = function (editor) {\n    return editor.getParam('hidden_input');\n  };\n\n  var shouldPatchSubmit = function (editor) {\n    return editor.getParam('submit_patch');\n  };\n\n  var isEncodingXml = function (editor) {\n    return editor.getParam('encoding') === 'xml';\n  };\n\n  var shouldAddFormSubmitTrigger = function (editor) {\n    return editor.getParam('add_form_submit_trigger');\n  };\n\n  var shouldAddUnloadTrigger = function (editor) {\n    return editor.getParam('add_unload_trigger');\n  };\n\n  var hasForcedRootBlock = function (editor) {\n    return getForcedRootBlock(editor) !== '';\n  };\n\n  var getCustomUndoRedoLevels = function (editor) {\n    return editor.getParam('custom_undo_redo_levels', 0, 'number');\n  };\n\n  var shouldDisableNodeChange = function (editor) {\n    return editor.getParam('disable_nodechange');\n  };\n\n  var isReadOnly = function (editor) {\n    return editor.getParam('readonly');\n  };\n\n  var hasContentCssCors = function (editor) {\n    return editor.getParam('content_css_cors');\n  };\n\n  var getPlugins = function (editor) {\n    return editor.getParam('plugins', '', 'string');\n  };\n\n  var getExternalPlugins = function (editor) {\n    return editor.getParam('external_plugins');\n  };\n\n  var shouldBlockUnsupportedDrop = function (editor) {\n    return editor.getParam('block_unsupported_drop', true, 'boolean');\n  };\n\n  var isVisualAidsEnabled = function (editor) {\n    return editor.getParam('visual', true, 'boolean');\n  };\n\n  var getVisualAidsTableClass = function (editor) {\n    return editor.getParam('visual_table_class', 'mce-item-table', 'string');\n  };\n\n  var getVisualAidsAnchorClass = function (editor) {\n    return editor.getParam('visual_anchor_class', 'mce-item-anchor', 'string');\n  };\n\n  var isElement$4 = isElement$1;\n  var isText$6 = isText$1;\n\n  var removeNode = function (node) {\n    var parentNode = node.parentNode;\n\n    if (parentNode) {\n      parentNode.removeChild(node);\n    }\n  };\n\n  var trimCount = function (text) {\n    var trimmedText = trim$2(text);\n    return {\n      count: text.length - trimmedText.length,\n      text: trimmedText\n    };\n  };\n\n  var deleteZwspChars = function (caretContainer) {\n    var idx;\n\n    while ((idx = caretContainer.data.lastIndexOf(ZWSP)) !== -1) {\n      caretContainer.deleteData(idx, 1);\n    }\n  };\n\n  var removeUnchanged = function (caretContainer, pos) {\n    remove$5(caretContainer);\n    return pos;\n  };\n\n  var removeTextAndReposition = function (caretContainer, pos) {\n    var before = trimCount(caretContainer.data.substr(0, pos.offset()));\n    var after = trimCount(caretContainer.data.substr(pos.offset()));\n    var text = before.text + after.text;\n\n    if (text.length > 0) {\n      deleteZwspChars(caretContainer);\n      return CaretPosition(caretContainer, pos.offset() - before.count);\n    } else {\n      return pos;\n    }\n  };\n\n  var removeElementAndReposition = function (caretContainer, pos) {\n    var parentNode = pos.container();\n    var newPosition = indexOf(from$1(parentNode.childNodes), caretContainer).map(function (index) {\n      return index < pos.offset() ? CaretPosition(parentNode, pos.offset() - 1) : pos;\n    }).getOr(pos);\n    remove$5(caretContainer);\n    return newPosition;\n  };\n\n  var removeTextCaretContainer = function (caretContainer, pos) {\n    return isText$6(caretContainer) && pos.container() === caretContainer ? removeTextAndReposition(caretContainer, pos) : removeUnchanged(caretContainer, pos);\n  };\n\n  var removeElementCaretContainer = function (caretContainer, pos) {\n    return pos.container() === caretContainer.parentNode ? removeElementAndReposition(caretContainer, pos) : removeUnchanged(caretContainer, pos);\n  };\n\n  var removeAndReposition = function (container, pos) {\n    return CaretPosition.isTextPosition(pos) ? removeTextCaretContainer(container, pos) : removeElementCaretContainer(container, pos);\n  };\n\n  var remove$5 = function (caretContainerNode) {\n    if (isElement$4(caretContainerNode) && isCaretContainer(caretContainerNode)) {\n      if (hasContent(caretContainerNode)) {\n        caretContainerNode.removeAttribute('data-mce-caret');\n      } else {\n        removeNode(caretContainerNode);\n      }\n    }\n\n    if (isText$6(caretContainerNode)) {\n      deleteZwspChars(caretContainerNode);\n\n      if (caretContainerNode.data.length === 0) {\n        removeNode(caretContainerNode);\n      }\n    }\n  };\n\n  var browser$2 = detect$3().browser;\n  var isContentEditableFalse$3 = isContentEditableFalse;\n  var isMedia$1 = isMedia;\n  var isTableCell$2 = isTableCell;\n  var inlineFakeCaretSelector = '*[contentEditable=false],video,audio,embed,object';\n\n  var getAbsoluteClientRect = function (root, element, before) {\n    var clientRect = collapse(element.getBoundingClientRect(), before);\n    var docElm, scrollX, scrollY, margin, rootRect;\n\n    if (root.tagName === 'BODY') {\n      docElm = root.ownerDocument.documentElement;\n      scrollX = root.scrollLeft || docElm.scrollLeft;\n      scrollY = root.scrollTop || docElm.scrollTop;\n    } else {\n      rootRect = root.getBoundingClientRect();\n      scrollX = root.scrollLeft - rootRect.left;\n      scrollY = root.scrollTop - rootRect.top;\n    }\n\n    clientRect.left += scrollX;\n    clientRect.right += scrollX;\n    clientRect.top += scrollY;\n    clientRect.bottom += scrollY;\n    clientRect.width = 1;\n    margin = element.offsetWidth - element.clientWidth;\n\n    if (margin > 0) {\n      if (before) {\n        margin *= -1;\n      }\n\n      clientRect.left += margin;\n      clientRect.right += margin;\n    }\n\n    return clientRect;\n  };\n\n  var trimInlineCaretContainers = function (root) {\n    var fakeCaretTargetNodes = descendants$1(SugarElement.fromDom(root), inlineFakeCaretSelector);\n\n    for (var i = 0; i < fakeCaretTargetNodes.length; i++) {\n      var node = fakeCaretTargetNodes[i].dom;\n      var sibling = node.previousSibling;\n\n      if (endsWithCaretContainer(sibling)) {\n        var data = sibling.data;\n\n        if (data.length === 1) {\n          sibling.parentNode.removeChild(sibling);\n        } else {\n          sibling.deleteData(data.length - 1, 1);\n        }\n      }\n\n      sibling = node.nextSibling;\n\n      if (startsWithCaretContainer(sibling)) {\n        var data = sibling.data;\n\n        if (data.length === 1) {\n          sibling.parentNode.removeChild(sibling);\n        } else {\n          sibling.deleteData(0, 1);\n        }\n      }\n    }\n  };\n\n  var FakeCaret = function (editor, root, isBlock, hasFocus) {\n    var lastVisualCaret = Cell(Optional.none());\n    var cursorInterval, caretContainerNode;\n    var rootBlock = getForcedRootBlock(editor);\n    var caretBlock = rootBlock.length > 0 ? rootBlock : 'p';\n\n    var show = function (before, element) {\n      var clientRect, rng;\n      hide();\n\n      if (isTableCell$2(element)) {\n        return null;\n      }\n\n      if (isBlock(element)) {\n        caretContainerNode = insertBlock(caretBlock, element, before);\n        clientRect = getAbsoluteClientRect(root, element, before);\n        DomQuery(caretContainerNode).css('top', clientRect.top);\n        var caret = DomQuery('<div class=\"mce-visual-caret\" data-mce-bogus=\"all\"></div>').css(clientRect).appendTo(root)[0];\n        lastVisualCaret.set(Optional.some({\n          caret: caret,\n          element: element,\n          before: before\n        }));\n        lastVisualCaret.get().each(function (caretState) {\n          if (before) {\n            DomQuery(caretState.caret).addClass('mce-visual-caret-before');\n          }\n        });\n        startBlink();\n        rng = element.ownerDocument.createRange();\n        rng.setStart(caretContainerNode, 0);\n        rng.setEnd(caretContainerNode, 0);\n      } else {\n        caretContainerNode = insertInline(element, before);\n        rng = element.ownerDocument.createRange();\n\n        if (isInlineFakeCaretTarget(caretContainerNode.nextSibling)) {\n          rng.setStart(caretContainerNode, 0);\n          rng.setEnd(caretContainerNode, 0);\n        } else {\n          rng.setStart(caretContainerNode, 1);\n          rng.setEnd(caretContainerNode, 1);\n        }\n\n        return rng;\n      }\n\n      return rng;\n    };\n\n    var hide = function () {\n      trimInlineCaretContainers(root);\n\n      if (caretContainerNode) {\n        remove$5(caretContainerNode);\n        caretContainerNode = null;\n      }\n\n      lastVisualCaret.get().each(function (caretState) {\n        DomQuery(caretState.caret).remove();\n        lastVisualCaret.set(Optional.none());\n      });\n\n      if (cursorInterval) {\n        Delay.clearInterval(cursorInterval);\n        cursorInterval = null;\n      }\n    };\n\n    var startBlink = function () {\n      cursorInterval = Delay.setInterval(function () {\n        if (hasFocus()) {\n          DomQuery('div.mce-visual-caret', root).toggleClass('mce-visual-caret-hidden');\n        } else {\n          DomQuery('div.mce-visual-caret', root).addClass('mce-visual-caret-hidden');\n        }\n      }, 500);\n    };\n\n    var reposition = function () {\n      lastVisualCaret.get().each(function (caretState) {\n        var clientRect = getAbsoluteClientRect(root, caretState.element, caretState.before);\n        DomQuery(caretState.caret).css(__assign({}, clientRect));\n      });\n    };\n\n    var destroy = function () {\n      return Delay.clearInterval(cursorInterval);\n    };\n\n    var getCss = function () {\n      return '.mce-visual-caret {' + 'position: absolute;' + 'background-color: black;' + 'background-color: currentcolor;' + '}' + '.mce-visual-caret-hidden {' + 'display: none;' + '}' + '*[data-mce-caret] {' + 'position: absolute;' + 'left: -1000px;' + 'right: auto;' + 'top: 0;' + 'margin: 0;' + 'padding: 0;' + '}';\n    };\n\n    return {\n      show: show,\n      hide: hide,\n      getCss: getCss,\n      reposition: reposition,\n      destroy: destroy\n    };\n  };\n\n  var isFakeCaretTableBrowser = function () {\n    return browser$2.isIE() || browser$2.isEdge() || browser$2.isFirefox();\n  };\n\n  var isInlineFakeCaretTarget = function (node) {\n    return isContentEditableFalse$3(node) || isMedia$1(node);\n  };\n\n  var isFakeCaretTarget = function (node) {\n    return isInlineFakeCaretTarget(node) || isTable(node) && isFakeCaretTableBrowser();\n  };\n\n  var isContentEditableFalse$4 = isContentEditableFalse;\n  var isMedia$2 = isMedia;\n  var isBlockLike = matchStyleValues('display', 'block table table-cell table-caption list-item');\n  var isCaretContainer$2 = isCaretContainer;\n  var isCaretContainerBlock$1 = isCaretContainerBlock;\n  var isElement$5 = isElement$1;\n  var isCaretCandidate$2 = isCaretCandidate;\n\n  var isForwards = function (direction) {\n    return direction > 0;\n  };\n\n  var isBackwards = function (direction) {\n    return direction < 0;\n  };\n\n  var skipCaretContainers = function (walk, shallow) {\n    var node;\n\n    while (node = walk(shallow)) {\n      if (!isCaretContainerBlock$1(node)) {\n        return node;\n      }\n    }\n\n    return null;\n  };\n\n  var findNode = function (node, direction, predicateFn, rootNode, shallow) {\n    var walker = new DomTreeWalker(node, rootNode);\n    var isCefOrCaretContainer = isContentEditableFalse$4(node) || isCaretContainerBlock$1(node);\n\n    if (isBackwards(direction)) {\n      if (isCefOrCaretContainer) {\n        node = skipCaretContainers(walker.prev.bind(walker), true);\n\n        if (predicateFn(node)) {\n          return node;\n        }\n      }\n\n      while (node = skipCaretContainers(walker.prev.bind(walker), shallow)) {\n        if (predicateFn(node)) {\n          return node;\n        }\n      }\n    }\n\n    if (isForwards(direction)) {\n      if (isCefOrCaretContainer) {\n        node = skipCaretContainers(walker.next.bind(walker), true);\n\n        if (predicateFn(node)) {\n          return node;\n        }\n      }\n\n      while (node = skipCaretContainers(walker.next.bind(walker), shallow)) {\n        if (predicateFn(node)) {\n          return node;\n        }\n      }\n    }\n\n    return null;\n  };\n\n  var getParentBlock = function (node, rootNode) {\n    while (node && node !== rootNode) {\n      if (isBlockLike(node)) {\n        return node;\n      }\n\n      node = node.parentNode;\n    }\n\n    return null;\n  };\n\n  var isInSameBlock = function (caretPosition1, caretPosition2, rootNode) {\n    return getParentBlock(caretPosition1.container(), rootNode) === getParentBlock(caretPosition2.container(), rootNode);\n  };\n\n  var getChildNodeAtRelativeOffset = function (relativeOffset, caretPosition) {\n    if (!caretPosition) {\n      return null;\n    }\n\n    var container = caretPosition.container();\n    var offset = caretPosition.offset();\n\n    if (!isElement$5(container)) {\n      return null;\n    }\n\n    return container.childNodes[offset + relativeOffset];\n  };\n\n  var beforeAfter = function (before, node) {\n    var range = node.ownerDocument.createRange();\n\n    if (before) {\n      range.setStartBefore(node);\n      range.setEndBefore(node);\n    } else {\n      range.setStartAfter(node);\n      range.setEndAfter(node);\n    }\n\n    return range;\n  };\n\n  var isNodesInSameBlock = function (root, node1, node2) {\n    return getParentBlock(node1, root) === getParentBlock(node2, root);\n  };\n\n  var lean = function (left, root, node) {\n    var sibling, siblingName;\n\n    if (left) {\n      siblingName = 'previousSibling';\n    } else {\n      siblingName = 'nextSibling';\n    }\n\n    while (node && node !== root) {\n      sibling = node[siblingName];\n\n      if (isCaretContainer$2(sibling)) {\n        sibling = sibling[siblingName];\n      }\n\n      if (isContentEditableFalse$4(sibling) || isMedia$2(sibling)) {\n        if (isNodesInSameBlock(root, sibling, node)) {\n          return sibling;\n        }\n\n        break;\n      }\n\n      if (isCaretCandidate$2(sibling)) {\n        break;\n      }\n\n      node = node.parentNode;\n    }\n\n    return null;\n  };\n\n  var before$2 = curry(beforeAfter, true);\n  var after$1 = curry(beforeAfter, false);\n\n  var normalizeRange = function (direction, root, range) {\n    var node, container, location;\n    var leanLeft = curry(lean, true, root);\n    var leanRight = curry(lean, false, root);\n    container = range.startContainer;\n    var offset = range.startOffset;\n\n    if (isCaretContainerBlock(container)) {\n      if (!isElement$5(container)) {\n        container = container.parentNode;\n      }\n\n      location = container.getAttribute('data-mce-caret');\n\n      if (location === 'before') {\n        node = container.nextSibling;\n\n        if (isFakeCaretTarget(node)) {\n          return before$2(node);\n        }\n      }\n\n      if (location === 'after') {\n        node = container.previousSibling;\n\n        if (isFakeCaretTarget(node)) {\n          return after$1(node);\n        }\n      }\n    }\n\n    if (!range.collapsed) {\n      return range;\n    }\n\n    if (isText$1(container)) {\n      if (isCaretContainer$2(container)) {\n        if (direction === 1) {\n          node = leanRight(container);\n\n          if (node) {\n            return before$2(node);\n          }\n\n          node = leanLeft(container);\n\n          if (node) {\n            return after$1(node);\n          }\n        }\n\n        if (direction === -1) {\n          node = leanLeft(container);\n\n          if (node) {\n            return after$1(node);\n          }\n\n          node = leanRight(container);\n\n          if (node) {\n            return before$2(node);\n          }\n        }\n\n        return range;\n      }\n\n      if (endsWithCaretContainer(container) && offset >= container.data.length - 1) {\n        if (direction === 1) {\n          node = leanRight(container);\n\n          if (node) {\n            return before$2(node);\n          }\n        }\n\n        return range;\n      }\n\n      if (startsWithCaretContainer(container) && offset <= 1) {\n        if (direction === -1) {\n          node = leanLeft(container);\n\n          if (node) {\n            return after$1(node);\n          }\n        }\n\n        return range;\n      }\n\n      if (offset === container.data.length) {\n        node = leanRight(container);\n\n        if (node) {\n          return before$2(node);\n        }\n\n        return range;\n      }\n\n      if (offset === 0) {\n        node = leanLeft(container);\n\n        if (node) {\n          return after$1(node);\n        }\n\n        return range;\n      }\n    }\n\n    return range;\n  };\n\n  var getRelativeCefElm = function (forward, caretPosition) {\n    return Optional.from(getChildNodeAtRelativeOffset(forward ? 0 : -1, caretPosition)).filter(isContentEditableFalse$4);\n  };\n\n  var getNormalizedRangeEndPoint = function (direction, root, range) {\n    var normalizedRange = normalizeRange(direction, root, range);\n\n    if (direction === -1) {\n      return CaretPosition.fromRangeStart(normalizedRange);\n    }\n\n    return CaretPosition.fromRangeEnd(normalizedRange);\n  };\n\n  var getElementFromPosition = function (pos) {\n    return Optional.from(pos.getNode()).map(SugarElement.fromDom);\n  };\n\n  var getElementFromPrevPosition = function (pos) {\n    return Optional.from(pos.getNode(true)).map(SugarElement.fromDom);\n  };\n\n  var getVisualCaretPosition = function (walkFn, caretPosition) {\n    while (caretPosition = walkFn(caretPosition)) {\n      if (caretPosition.isVisible()) {\n        return caretPosition;\n      }\n    }\n\n    return caretPosition;\n  };\n\n  var isMoveInsideSameBlock = function (from, to) {\n    var inSameBlock = isInSameBlock(from, to);\n\n    if (!inSameBlock && isBr(from.getNode())) {\n      return true;\n    }\n\n    return inSameBlock;\n  };\n\n  var HDirection;\n\n  (function (HDirection) {\n    HDirection[HDirection['Backwards'] = -1] = 'Backwards';\n    HDirection[HDirection['Forwards'] = 1] = 'Forwards';\n  })(HDirection || (HDirection = {}));\n\n  var isContentEditableFalse$5 = isContentEditableFalse;\n  var isText$7 = isText$1;\n  var isElement$6 = isElement$1;\n  var isBr$4 = isBr;\n  var isCaretCandidate$3 = isCaretCandidate;\n  var isAtomic$1 = isAtomic;\n  var isEditableCaretCandidate$1 = isEditableCaretCandidate;\n\n  var getParents = function (node, root) {\n    var parents = [];\n\n    while (node && node !== root) {\n      parents.push(node);\n      node = node.parentNode;\n    }\n\n    return parents;\n  };\n\n  var nodeAtIndex = function (container, offset) {\n    if (container.hasChildNodes() && offset < container.childNodes.length) {\n      return container.childNodes[offset];\n    }\n\n    return null;\n  };\n\n  var getCaretCandidatePosition = function (direction, node) {\n    if (isForwards(direction)) {\n      if (isCaretCandidate$3(node.previousSibling) && !isText$7(node.previousSibling)) {\n        return CaretPosition.before(node);\n      }\n\n      if (isText$7(node)) {\n        return CaretPosition(node, 0);\n      }\n    }\n\n    if (isBackwards(direction)) {\n      if (isCaretCandidate$3(node.nextSibling) && !isText$7(node.nextSibling)) {\n        return CaretPosition.after(node);\n      }\n\n      if (isText$7(node)) {\n        return CaretPosition(node, node.data.length);\n      }\n    }\n\n    if (isBackwards(direction)) {\n      if (isBr$4(node)) {\n        return CaretPosition.before(node);\n      }\n\n      return CaretPosition.after(node);\n    }\n\n    return CaretPosition.before(node);\n  };\n\n  var moveForwardFromBr = function (root, nextNode) {\n    var nextSibling = nextNode.nextSibling;\n\n    if (nextSibling && isCaretCandidate$3(nextSibling)) {\n      if (isText$7(nextSibling)) {\n        return CaretPosition(nextSibling, 0);\n      } else {\n        return CaretPosition.before(nextSibling);\n      }\n    } else {\n      return findCaretPosition(HDirection.Forwards, CaretPosition.after(nextNode), root);\n    }\n  };\n\n  var findCaretPosition = function (direction, startPos, root) {\n    var node, nextNode, innerNode;\n    var caretPosition;\n\n    if (!isElement$6(root) || !startPos) {\n      return null;\n    }\n\n    if (startPos.isEqual(CaretPosition.after(root)) && root.lastChild) {\n      caretPosition = CaretPosition.after(root.lastChild);\n\n      if (isBackwards(direction) && isCaretCandidate$3(root.lastChild) && isElement$6(root.lastChild)) {\n        return isBr$4(root.lastChild) ? CaretPosition.before(root.lastChild) : caretPosition;\n      }\n    } else {\n      caretPosition = startPos;\n    }\n\n    var container = caretPosition.container();\n    var offset = caretPosition.offset();\n\n    if (isText$7(container)) {\n      if (isBackwards(direction) && offset > 0) {\n        return CaretPosition(container, --offset);\n      }\n\n      if (isForwards(direction) && offset < container.length) {\n        return CaretPosition(container, ++offset);\n      }\n\n      node = container;\n    } else {\n      if (isBackwards(direction) && offset > 0) {\n        nextNode = nodeAtIndex(container, offset - 1);\n\n        if (isCaretCandidate$3(nextNode)) {\n          if (!isAtomic$1(nextNode)) {\n            innerNode = findNode(nextNode, direction, isEditableCaretCandidate$1, nextNode);\n\n            if (innerNode) {\n              if (isText$7(innerNode)) {\n                return CaretPosition(innerNode, innerNode.data.length);\n              }\n\n              return CaretPosition.after(innerNode);\n            }\n          }\n\n          if (isText$7(nextNode)) {\n            return CaretPosition(nextNode, nextNode.data.length);\n          }\n\n          return CaretPosition.before(nextNode);\n        }\n      }\n\n      if (isForwards(direction) && offset < container.childNodes.length) {\n        nextNode = nodeAtIndex(container, offset);\n\n        if (isCaretCandidate$3(nextNode)) {\n          if (isBr$4(nextNode)) {\n            return moveForwardFromBr(root, nextNode);\n          }\n\n          if (!isAtomic$1(nextNode)) {\n            innerNode = findNode(nextNode, direction, isEditableCaretCandidate$1, nextNode);\n\n            if (innerNode) {\n              if (isText$7(innerNode)) {\n                return CaretPosition(innerNode, 0);\n              }\n\n              return CaretPosition.before(innerNode);\n            }\n          }\n\n          if (isText$7(nextNode)) {\n            return CaretPosition(nextNode, 0);\n          }\n\n          return CaretPosition.after(nextNode);\n        }\n      }\n\n      node = nextNode ? nextNode : caretPosition.getNode();\n    }\n\n    if (isForwards(direction) && caretPosition.isAtEnd() || isBackwards(direction) && caretPosition.isAtStart()) {\n      node = findNode(node, direction, always, root, true);\n\n      if (isEditableCaretCandidate$1(node, root)) {\n        return getCaretCandidatePosition(direction, node);\n      }\n    }\n\n    nextNode = findNode(node, direction, isEditableCaretCandidate$1, root);\n    var rootContentEditableFalseElm = last$1(filter(getParents(container, root), isContentEditableFalse$5));\n\n    if (rootContentEditableFalseElm && (!nextNode || !rootContentEditableFalseElm.contains(nextNode))) {\n      if (isForwards(direction)) {\n        caretPosition = CaretPosition.after(rootContentEditableFalseElm);\n      } else {\n        caretPosition = CaretPosition.before(rootContentEditableFalseElm);\n      }\n\n      return caretPosition;\n    }\n\n    if (nextNode) {\n      return getCaretCandidatePosition(direction, nextNode);\n    }\n\n    return null;\n  };\n\n  var CaretWalker = function (root) {\n    return {\n      next: function (caretPosition) {\n        return findCaretPosition(HDirection.Forwards, caretPosition, root);\n      },\n      prev: function (caretPosition) {\n        return findCaretPosition(HDirection.Backwards, caretPosition, root);\n      }\n    };\n  };\n\n  var walkToPositionIn = function (forward, root, start) {\n    var position = forward ? CaretPosition.before(start) : CaretPosition.after(start);\n    return fromPosition(forward, root, position);\n  };\n\n  var afterElement = function (node) {\n    return isBr(node) ? CaretPosition.before(node) : CaretPosition.after(node);\n  };\n\n  var isBeforeOrStart = function (position) {\n    if (CaretPosition.isTextPosition(position)) {\n      return position.offset() === 0;\n    } else {\n      return isCaretCandidate(position.getNode());\n    }\n  };\n\n  var isAfterOrEnd = function (position) {\n    if (CaretPosition.isTextPosition(position)) {\n      var container = position.container();\n      return position.offset() === container.data.length;\n    } else {\n      return isCaretCandidate(position.getNode(true));\n    }\n  };\n\n  var isBeforeAfterSameElement = function (from, to) {\n    return !CaretPosition.isTextPosition(from) && !CaretPosition.isTextPosition(to) && from.getNode() === to.getNode(true);\n  };\n\n  var isAtBr = function (position) {\n    return !CaretPosition.isTextPosition(position) && isBr(position.getNode());\n  };\n\n  var shouldSkipPosition = function (forward, from, to) {\n    if (forward) {\n      return !isBeforeAfterSameElement(from, to) && !isAtBr(from) && isAfterOrEnd(from) && isBeforeOrStart(to);\n    } else {\n      return !isBeforeAfterSameElement(to, from) && isBeforeOrStart(from) && isAfterOrEnd(to);\n    }\n  };\n\n  var fromPosition = function (forward, root, pos) {\n    var walker = CaretWalker(root);\n    return Optional.from(forward ? walker.next(pos) : walker.prev(pos));\n  };\n\n  var navigate = function (forward, root, from) {\n    return fromPosition(forward, root, from).bind(function (to) {\n      if (isInSameBlock(from, to, root) && shouldSkipPosition(forward, from, to)) {\n        return fromPosition(forward, root, to);\n      } else {\n        return Optional.some(to);\n      }\n    });\n  };\n\n  var navigateIgnore = function (forward, root, from, ignoreFilter) {\n    return navigate(forward, root, from).bind(function (pos) {\n      return ignoreFilter(pos) ? navigateIgnore(forward, root, pos, ignoreFilter) : Optional.some(pos);\n    });\n  };\n\n  var positionIn = function (forward, element) {\n    var startNode = forward ? element.firstChild : element.lastChild;\n\n    if (isText$1(startNode)) {\n      return Optional.some(CaretPosition(startNode, forward ? 0 : startNode.data.length));\n    } else if (startNode) {\n      if (isCaretCandidate(startNode)) {\n        return Optional.some(forward ? CaretPosition.before(startNode) : afterElement(startNode));\n      } else {\n        return walkToPositionIn(forward, element, startNode);\n      }\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var nextPosition = curry(fromPosition, true);\n  var prevPosition = curry(fromPosition, false);\n  var firstPositionIn = curry(positionIn, true);\n  var lastPositionIn = curry(positionIn, false);\n  var CARET_ID = '_mce_caret';\n\n  var isCaretNode = function (node) {\n    return isElement$1(node) && node.id === CARET_ID;\n  };\n\n  var getParentCaretContainer = function (body, node) {\n    while (node && node !== body) {\n      if (node.id === CARET_ID) {\n        return node;\n      }\n\n      node = node.parentNode;\n    }\n\n    return null;\n  };\n\n  var isStringPathBookmark = function (bookmark) {\n    return isString(bookmark.start);\n  };\n\n  var isRangeBookmark = function (bookmark) {\n    return bookmark.hasOwnProperty('rng');\n  };\n\n  var isIdBookmark = function (bookmark) {\n    return bookmark.hasOwnProperty('id');\n  };\n\n  var isIndexBookmark = function (bookmark) {\n    return bookmark.hasOwnProperty('name');\n  };\n\n  var isPathBookmark = function (bookmark) {\n    return Tools.isArray(bookmark.start);\n  };\n\n  var addBogus = function (dom, node) {\n    if (isElement$1(node) && dom.isBlock(node) && !node.innerHTML && !Env.ie) {\n      node.innerHTML = '<br data-mce-bogus=\"1\" />';\n    }\n\n    return node;\n  };\n\n  var resolveCaretPositionBookmark = function (dom, bookmark) {\n    var pos;\n    var rng = dom.createRng();\n    pos = resolve$1(dom.getRoot(), bookmark.start);\n    rng.setStart(pos.container(), pos.offset());\n    pos = resolve$1(dom.getRoot(), bookmark.end);\n    rng.setEnd(pos.container(), pos.offset());\n    return rng;\n  };\n\n  var insertZwsp = function (node, rng) {\n    var textNode = node.ownerDocument.createTextNode(ZWSP);\n    node.appendChild(textNode);\n    rng.setStart(textNode, 0);\n    rng.setEnd(textNode, 0);\n  };\n\n  var isEmpty$1 = function (node) {\n    return node.hasChildNodes() === false;\n  };\n\n  var tryFindRangePosition = function (node, rng) {\n    return lastPositionIn(node).fold(never, function (pos) {\n      rng.setStart(pos.container(), pos.offset());\n      rng.setEnd(pos.container(), pos.offset());\n      return true;\n    });\n  };\n\n  var padEmptyCaretContainer = function (root, node, rng) {\n    if (isEmpty$1(node) && getParentCaretContainer(root, node)) {\n      insertZwsp(node, rng);\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  var setEndPoint = function (dom, start, bookmark, rng) {\n    var point = bookmark[start ? 'start' : 'end'];\n    var i, node, offset, children;\n    var root = dom.getRoot();\n\n    if (point) {\n      offset = point[0];\n\n      for (node = root, i = point.length - 1; i >= 1; i--) {\n        children = node.childNodes;\n\n        if (padEmptyCaretContainer(root, node, rng)) {\n          return true;\n        }\n\n        if (point[i] > children.length - 1) {\n          if (padEmptyCaretContainer(root, node, rng)) {\n            return true;\n          }\n\n          return tryFindRangePosition(node, rng);\n        }\n\n        node = children[point[i]];\n      }\n\n      if (node.nodeType === 3) {\n        offset = Math.min(point[0], node.nodeValue.length);\n      }\n\n      if (node.nodeType === 1) {\n        offset = Math.min(point[0], node.childNodes.length);\n      }\n\n      if (start) {\n        rng.setStart(node, offset);\n      } else {\n        rng.setEnd(node, offset);\n      }\n    }\n\n    return true;\n  };\n\n  var isValidTextNode = function (node) {\n    return isText$1(node) && node.data.length > 0;\n  };\n\n  var restoreEndPoint = function (dom, suffix, bookmark) {\n    var marker = dom.get(bookmark.id + '_' + suffix),\n        node,\n        idx,\n        next,\n        prev;\n    var keep = bookmark.keep;\n    var container, offset;\n\n    if (marker) {\n      node = marker.parentNode;\n\n      if (suffix === 'start') {\n        if (!keep) {\n          idx = dom.nodeIndex(marker);\n        } else {\n          if (marker.hasChildNodes()) {\n            node = marker.firstChild;\n            idx = 1;\n          } else if (isValidTextNode(marker.nextSibling)) {\n            node = marker.nextSibling;\n            idx = 0;\n          } else if (isValidTextNode(marker.previousSibling)) {\n            node = marker.previousSibling;\n            idx = marker.previousSibling.data.length;\n          } else {\n            node = marker.parentNode;\n            idx = dom.nodeIndex(marker) + 1;\n          }\n        }\n\n        container = node;\n        offset = idx;\n      } else {\n        if (!keep) {\n          idx = dom.nodeIndex(marker);\n        } else {\n          if (marker.hasChildNodes()) {\n            node = marker.firstChild;\n            idx = 1;\n          } else if (isValidTextNode(marker.previousSibling)) {\n            node = marker.previousSibling;\n            idx = marker.previousSibling.data.length;\n          } else {\n            node = marker.parentNode;\n            idx = dom.nodeIndex(marker);\n          }\n        }\n\n        container = node;\n        offset = idx;\n      }\n\n      if (!keep) {\n        prev = marker.previousSibling;\n        next = marker.nextSibling;\n        Tools.each(Tools.grep(marker.childNodes), function (node) {\n          if (isText$1(node)) {\n            node.nodeValue = node.nodeValue.replace(/\\uFEFF/g, '');\n          }\n        });\n\n        while (marker = dom.get(bookmark.id + '_' + suffix)) {\n          dom.remove(marker, true);\n        }\n\n        if (prev && next && prev.nodeType === next.nodeType && isText$1(prev) && !Env.opera) {\n          idx = prev.nodeValue.length;\n          prev.appendData(next.nodeValue);\n          dom.remove(next);\n          container = prev;\n          offset = idx;\n        }\n      }\n\n      return Optional.some(CaretPosition(container, offset));\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var resolvePaths = function (dom, bookmark) {\n    var rng = dom.createRng();\n\n    if (setEndPoint(dom, true, bookmark, rng) && setEndPoint(dom, false, bookmark, rng)) {\n      return Optional.some(rng);\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var resolveId = function (dom, bookmark) {\n    var startPos = restoreEndPoint(dom, 'start', bookmark);\n    var endPos = restoreEndPoint(dom, 'end', bookmark);\n    return lift2(startPos, endPos.or(startPos), function (spos, epos) {\n      var rng = dom.createRng();\n      rng.setStart(addBogus(dom, spos.container()), spos.offset());\n      rng.setEnd(addBogus(dom, epos.container()), epos.offset());\n      return rng;\n    });\n  };\n\n  var resolveIndex$1 = function (dom, bookmark) {\n    return Optional.from(dom.select(bookmark.name)[bookmark.index]).map(function (elm) {\n      var rng = dom.createRng();\n      rng.selectNode(elm);\n      return rng;\n    });\n  };\n\n  var resolve$2 = function (selection, bookmark) {\n    var dom = selection.dom;\n\n    if (bookmark) {\n      if (isPathBookmark(bookmark)) {\n        return resolvePaths(dom, bookmark);\n      } else if (isStringPathBookmark(bookmark)) {\n        return Optional.some(resolveCaretPositionBookmark(dom, bookmark));\n      } else if (isIdBookmark(bookmark)) {\n        return resolveId(dom, bookmark);\n      } else if (isIndexBookmark(bookmark)) {\n        return resolveIndex$1(dom, bookmark);\n      } else if (isRangeBookmark(bookmark)) {\n        return Optional.some(bookmark.rng);\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var getBookmark$1 = function (selection, type, normalized) {\n    return getBookmark(selection, type, normalized);\n  };\n\n  var moveToBookmark = function (selection, bookmark) {\n    resolve$2(selection, bookmark).each(function (rng) {\n      selection.setRng(rng);\n    });\n  };\n\n  var isBookmarkNode$1 = function (node) {\n    return isElement$1(node) && node.tagName === 'SPAN' && node.getAttribute('data-mce-type') === 'bookmark';\n  };\n\n  var is$2 = function (expected) {\n    return function (actual) {\n      return expected === actual;\n    };\n  };\n\n  var isNbsp = is$2(nbsp);\n\n  var isWhiteSpace$1 = function (chr) {\n    return chr !== '' && ' \\f\\n\\r\\t\\x0B'.indexOf(chr) !== -1;\n  };\n\n  var isContent$1 = function (chr) {\n    return !isWhiteSpace$1(chr) && !isNbsp(chr);\n  };\n\n  var isNode = function (node) {\n    return !!node.nodeType;\n  };\n\n  var isInlineBlock = function (node) {\n    return node && /^(IMG)$/.test(node.nodeName);\n  };\n\n  var moveStart = function (dom, selection, rng) {\n    var offset = rng.startOffset;\n    var container = rng.startContainer,\n        walker,\n        node,\n        nodes;\n\n    if (rng.startContainer === rng.endContainer) {\n      if (isInlineBlock(rng.startContainer.childNodes[rng.startOffset])) {\n        return;\n      }\n    }\n\n    if (container.nodeType === 1) {\n      nodes = container.childNodes;\n\n      if (offset < nodes.length) {\n        container = nodes[offset];\n        walker = new DomTreeWalker(container, dom.getParent(container, dom.isBlock));\n      } else {\n        container = nodes[nodes.length - 1];\n        walker = new DomTreeWalker(container, dom.getParent(container, dom.isBlock));\n        walker.next(true);\n      }\n\n      for (node = walker.current(); node; node = walker.next()) {\n        if (node.nodeType === 3 && !isWhiteSpaceNode(node)) {\n          rng.setStart(node, 0);\n          selection.setRng(rng);\n          return;\n        }\n      }\n    }\n  };\n\n  var getNonWhiteSpaceSibling = function (node, next, inc) {\n    if (node) {\n      var nextName = next ? 'nextSibling' : 'previousSibling';\n\n      for (node = inc ? node : node[nextName]; node; node = node[nextName]) {\n        if (node.nodeType === 1 || !isWhiteSpaceNode(node)) {\n          return node;\n        }\n      }\n    }\n  };\n\n  var isTextBlock$1 = function (editor, name) {\n    if (isNode(name)) {\n      name = name.nodeName;\n    }\n\n    return !!editor.schema.getTextBlockElements()[name.toLowerCase()];\n  };\n\n  var isValid = function (ed, parent, child) {\n    return ed.schema.isValidChild(parent, child);\n  };\n\n  var isWhiteSpaceNode = function (node, allowSpaces) {\n    if (allowSpaces === void 0) {\n      allowSpaces = false;\n    }\n\n    if (isNonNullable(node) && isText$1(node)) {\n      var data = allowSpaces ? node.data.replace(/ /g, '\\xA0') : node.data;\n      return isWhitespaceText(data);\n    } else {\n      return false;\n    }\n  };\n\n  var isEmptyTextNode = function (node) {\n    return isNonNullable(node) && isText$1(node) && node.length === 0;\n  };\n\n  var replaceVars = function (value, vars) {\n    if (typeof value !== 'string') {\n      value = value(vars);\n    } else if (vars) {\n      value = value.replace(/%(\\w+)/g, function (str, name) {\n        return vars[name] || str;\n      });\n    }\n\n    return value;\n  };\n\n  var isEq = function (str1, str2) {\n    str1 = str1 || '';\n    str2 = str2 || '';\n    str1 = '' + (str1.nodeName || str1);\n    str2 = '' + (str2.nodeName || str2);\n    return str1.toLowerCase() === str2.toLowerCase();\n  };\n\n  var normalizeStyleValue = function (dom, value, name) {\n    if (name === 'color' || name === 'backgroundColor') {\n      value = dom.toHex(value);\n    }\n\n    if (name === 'fontWeight' && value === 700) {\n      value = 'bold';\n    }\n\n    if (name === 'fontFamily') {\n      value = value.replace(/[\\'\\\"]/g, '').replace(/,\\s+/g, ',');\n    }\n\n    return '' + value;\n  };\n\n  var getStyle = function (dom, node, name) {\n    return normalizeStyleValue(dom, dom.getStyle(node, name), name);\n  };\n\n  var getTextDecoration = function (dom, node) {\n    var decoration;\n    dom.getParent(node, function (n) {\n      decoration = dom.getStyle(n, 'text-decoration');\n      return decoration && decoration !== 'none';\n    });\n    return decoration;\n  };\n\n  var getParents$1 = function (dom, node, selector) {\n    return dom.getParents(node, selector, dom.getRoot());\n  };\n\n  var isVariableFormatName = function (editor, formatName) {\n    var hasVariableValues = function (format) {\n      var isVariableValue = function (val) {\n        return val.length > 1 && val.charAt(0) === '%';\n      };\n\n      return exists(['styles', 'attributes'], function (key) {\n        return get$1(format, key).exists(function (field) {\n          var fieldValues = isArray(field) ? field : values(field);\n          return exists(fieldValues, isVariableValue);\n        });\n      });\n    };\n\n    return exists(editor.formatter.get(formatName), hasVariableValues);\n  };\n\n  var areSimilarFormats = function (editor, formatName, otherFormatName) {\n    var validKeys = ['inline', 'block', 'selector', 'attributes', 'styles', 'classes'];\n\n    var filterObj = function (format) {\n      return filter$1(format, function (_, key) {\n        return exists(validKeys, function (validKey) {\n          return validKey === key;\n        });\n      });\n    };\n\n    return exists(editor.formatter.get(formatName), function (fmt1) {\n      var filteredFmt1 = filterObj(fmt1);\n      return exists(editor.formatter.get(otherFormatName), function (fmt2) {\n        var filteredFmt2 = filterObj(fmt2);\n        return equal(filteredFmt1, filteredFmt2);\n      });\n    });\n  };\n\n  var isBlockFormat = function (format) {\n    return hasNonNullableKey(format, 'block');\n  };\n\n  var isSelectorFormat = function (format) {\n    return hasNonNullableKey(format, 'selector');\n  };\n\n  var isInlineFormat = function (format) {\n    return hasNonNullableKey(format, 'inline');\n  };\n\n  var hasBlockChildren = function (dom, elm) {\n    return exists(elm.childNodes, dom.isBlock);\n  };\n\n  var isBookmarkNode$2 = isBookmarkNode$1;\n  var getParents$2 = getParents$1;\n  var isWhiteSpaceNode$1 = isWhiteSpaceNode;\n  var isTextBlock$2 = isTextBlock$1;\n\n  var isBogusBr = function (node) {\n    return isBr(node) && node.getAttribute('data-mce-bogus') && !node.nextSibling;\n  };\n\n  var findParentContentEditable = function (dom, node) {\n    var parent = node;\n\n    while (parent) {\n      if (isElement$1(parent) && dom.getContentEditable(parent)) {\n        return dom.getContentEditable(parent) === 'false' ? parent : node;\n      }\n\n      parent = parent.parentNode;\n    }\n\n    return node;\n  };\n\n  var walkText = function (start, node, offset, predicate) {\n    var str = node.data;\n\n    for (var i = offset; start ? i >= 0 : i < str.length; start ? i-- : i++) {\n      if (predicate(str.charAt(i))) {\n        return start ? i + 1 : i;\n      }\n    }\n\n    return -1;\n  };\n\n  var findSpace = function (start, node, offset) {\n    return walkText(start, node, offset, function (c) {\n      return isNbsp(c) || isWhiteSpace$1(c);\n    });\n  };\n\n  var findContent = function (start, node, offset) {\n    return walkText(start, node, offset, isContent$1);\n  };\n\n  var findWordEndPoint = function (dom, body, container, offset, start, includeTrailingSpaces) {\n    var lastTextNode;\n    var rootNode = dom.getParent(container, dom.isBlock) || body;\n\n    var walk = function (container, offset, pred) {\n      var textSeeker = TextSeeker(dom);\n      var walker = start ? textSeeker.backwards : textSeeker.forwards;\n      return Optional.from(walker(container, offset, function (text, textOffset) {\n        if (isBookmarkNode$2(text.parentNode)) {\n          return -1;\n        } else {\n          lastTextNode = text;\n          return pred(start, text, textOffset);\n        }\n      }, rootNode));\n    };\n\n    var spaceResult = walk(container, offset, findSpace);\n    return spaceResult.bind(function (result) {\n      return includeTrailingSpaces ? walk(result.container, result.offset + (start ? -1 : 0), findContent) : Optional.some(result);\n    }).orThunk(function () {\n      return lastTextNode ? Optional.some({\n        container: lastTextNode,\n        offset: start ? 0 : lastTextNode.length\n      }) : Optional.none();\n    });\n  };\n\n  var findSelectorEndPoint = function (dom, format, rng, container, siblingName) {\n    if (isText$1(container) && container.nodeValue.length === 0 && container[siblingName]) {\n      container = container[siblingName];\n    }\n\n    var parents = getParents$2(dom, container);\n\n    for (var i = 0; i < parents.length; i++) {\n      for (var y = 0; y < format.length; y++) {\n        var curFormat = format[y];\n\n        if ('collapsed' in curFormat && curFormat.collapsed !== rng.collapsed) {\n          continue;\n        }\n\n        if (dom.is(parents[i], curFormat.selector)) {\n          return parents[i];\n        }\n      }\n    }\n\n    return container;\n  };\n\n  var findBlockEndPoint = function (editor, format, container, siblingName) {\n    var node;\n    var dom = editor.dom;\n    var root = dom.getRoot();\n\n    if (!format[0].wrapper) {\n      node = dom.getParent(container, format[0].block, root);\n    }\n\n    if (!node) {\n      var scopeRoot = dom.getParent(container, 'LI,TD,TH');\n      node = dom.getParent(isText$1(container) ? container.parentNode : container, function (node) {\n        return node !== root && isTextBlock$2(editor, node);\n      }, scopeRoot);\n    }\n\n    if (node && format[0].wrapper) {\n      node = getParents$2(dom, node, 'ul,ol').reverse()[0] || node;\n    }\n\n    if (!node) {\n      node = container;\n\n      while (node[siblingName] && !dom.isBlock(node[siblingName])) {\n        node = node[siblingName];\n\n        if (isEq(node, 'br')) {\n          break;\n        }\n      }\n    }\n\n    return node || container;\n  };\n\n  var isAtBlockBoundary = function (dom, root, container, siblingName) {\n    var parent = container.parentNode;\n\n    if (isNonNullable(container[siblingName])) {\n      return false;\n    } else if (parent === root || isNullable(parent) || dom.isBlock(parent)) {\n      return true;\n    } else {\n      return isAtBlockBoundary(dom, root, parent, siblingName);\n    }\n  };\n\n  var findParentContainer = function (dom, format, container, offset, start) {\n    var parent = container;\n    var sibling;\n    var siblingName = start ? 'previousSibling' : 'nextSibling';\n    var root = dom.getRoot();\n\n    if (isText$1(container) && !isWhiteSpaceNode$1(container)) {\n      if (start ? offset > 0 : offset < container.data.length) {\n        return container;\n      }\n    }\n\n    while (true) {\n      if (!format[0].block_expand && dom.isBlock(parent)) {\n        return parent;\n      }\n\n      for (sibling = parent[siblingName]; sibling; sibling = sibling[siblingName]) {\n        var allowSpaces = isText$1(sibling) && !isAtBlockBoundary(dom, root, sibling, siblingName);\n\n        if (!isBookmarkNode$2(sibling) && !isBogusBr(sibling) && !isWhiteSpaceNode$1(sibling, allowSpaces)) {\n          return parent;\n        }\n      }\n\n      if (parent === root || parent.parentNode === root) {\n        container = parent;\n        break;\n      }\n\n      parent = parent.parentNode;\n    }\n\n    return container;\n  };\n\n  var isSelfOrParentBookmark = function (container) {\n    return isBookmarkNode$2(container.parentNode) || isBookmarkNode$2(container);\n  };\n\n  var expandRng = function (editor, rng, format, includeTrailingSpace) {\n    if (includeTrailingSpace === void 0) {\n      includeTrailingSpace = false;\n    }\n\n    var startContainer = rng.startContainer,\n        startOffset = rng.startOffset,\n        endContainer = rng.endContainer,\n        endOffset = rng.endOffset;\n    var dom = editor.dom;\n\n    if (isElement$1(startContainer) && startContainer.hasChildNodes()) {\n      startContainer = getNode(startContainer, startOffset);\n\n      if (isText$1(startContainer)) {\n        startOffset = 0;\n      }\n    }\n\n    if (isElement$1(endContainer) && endContainer.hasChildNodes()) {\n      endContainer = getNode(endContainer, rng.collapsed ? endOffset : endOffset - 1);\n\n      if (isText$1(endContainer)) {\n        endOffset = endContainer.nodeValue.length;\n      }\n    }\n\n    startContainer = findParentContentEditable(dom, startContainer);\n    endContainer = findParentContentEditable(dom, endContainer);\n\n    if (isSelfOrParentBookmark(startContainer)) {\n      startContainer = isBookmarkNode$2(startContainer) ? startContainer : startContainer.parentNode;\n\n      if (rng.collapsed) {\n        startContainer = startContainer.previousSibling || startContainer;\n      } else {\n        startContainer = startContainer.nextSibling || startContainer;\n      }\n\n      if (isText$1(startContainer)) {\n        startOffset = rng.collapsed ? startContainer.length : 0;\n      }\n    }\n\n    if (isSelfOrParentBookmark(endContainer)) {\n      endContainer = isBookmarkNode$2(endContainer) ? endContainer : endContainer.parentNode;\n\n      if (rng.collapsed) {\n        endContainer = endContainer.nextSibling || endContainer;\n      } else {\n        endContainer = endContainer.previousSibling || endContainer;\n      }\n\n      if (isText$1(endContainer)) {\n        endOffset = rng.collapsed ? 0 : endContainer.length;\n      }\n    }\n\n    if (rng.collapsed) {\n      var startPoint = findWordEndPoint(dom, editor.getBody(), startContainer, startOffset, true, includeTrailingSpace);\n      startPoint.each(function (_a) {\n        var container = _a.container,\n            offset = _a.offset;\n        startContainer = container;\n        startOffset = offset;\n      });\n      var endPoint = findWordEndPoint(dom, editor.getBody(), endContainer, endOffset, false, includeTrailingSpace);\n      endPoint.each(function (_a) {\n        var container = _a.container,\n            offset = _a.offset;\n        endContainer = container;\n        endOffset = offset;\n      });\n    }\n\n    if (format[0].inline || format[0].block_expand) {\n      if (!format[0].inline || !isText$1(startContainer) || startOffset === 0) {\n        startContainer = findParentContainer(dom, format, startContainer, startOffset, true);\n      }\n\n      if (!format[0].inline || !isText$1(endContainer) || endOffset === endContainer.nodeValue.length) {\n        endContainer = findParentContainer(dom, format, endContainer, endOffset, false);\n      }\n    }\n\n    if (format[0].selector && format[0].expand !== false && !format[0].inline) {\n      startContainer = findSelectorEndPoint(dom, format, rng, startContainer, 'previousSibling');\n      endContainer = findSelectorEndPoint(dom, format, rng, endContainer, 'nextSibling');\n    }\n\n    if (format[0].block || format[0].selector) {\n      startContainer = findBlockEndPoint(editor, format, startContainer, 'previousSibling');\n      endContainer = findBlockEndPoint(editor, format, endContainer, 'nextSibling');\n\n      if (format[0].block) {\n        if (!dom.isBlock(startContainer)) {\n          startContainer = findParentContainer(dom, format, startContainer, startOffset, true);\n        }\n\n        if (!dom.isBlock(endContainer)) {\n          endContainer = findParentContainer(dom, format, endContainer, endOffset, false);\n        }\n      }\n    }\n\n    if (isElement$1(startContainer)) {\n      startOffset = dom.nodeIndex(startContainer);\n      startContainer = startContainer.parentNode;\n    }\n\n    if (isElement$1(endContainer)) {\n      endOffset = dom.nodeIndex(endContainer) + 1;\n      endContainer = endContainer.parentNode;\n    }\n\n    return {\n      startContainer: startContainer,\n      startOffset: startOffset,\n      endContainer: endContainer,\n      endOffset: endOffset\n    };\n  };\n\n  var clampToExistingChildren = function (container, index) {\n    var childNodes = container.childNodes;\n\n    if (index >= childNodes.length) {\n      index = childNodes.length - 1;\n    } else if (index < 0) {\n      index = 0;\n    }\n\n    return childNodes[index] || container;\n  };\n\n  var getEndChild = function (container, index) {\n    return clampToExistingChildren(container, index - 1);\n  };\n\n  var walk$1 = function (dom, rng, callback) {\n    var startContainer = rng.startContainer;\n    var startOffset = rng.startOffset;\n    var endContainer = rng.endContainer;\n    var endOffset = rng.endOffset;\n\n    var exclude = function (nodes) {\n      var node;\n      node = nodes[0];\n\n      if (node.nodeType === 3 && node === startContainer && startOffset >= node.nodeValue.length) {\n        nodes.splice(0, 1);\n      }\n\n      node = nodes[nodes.length - 1];\n\n      if (endOffset === 0 && nodes.length > 0 && node === endContainer && node.nodeType === 3) {\n        nodes.splice(nodes.length - 1, 1);\n      }\n\n      return nodes;\n    };\n\n    var collectSiblings = function (node, name, endNode) {\n      var siblings = [];\n\n      for (; node && node !== endNode; node = node[name]) {\n        siblings.push(node);\n      }\n\n      return siblings;\n    };\n\n    var findEndPoint = function (node, root) {\n      do {\n        if (node.parentNode === root) {\n          return node;\n        }\n\n        node = node.parentNode;\n      } while (node);\n    };\n\n    var walkBoundary = function (startNode, endNode, next) {\n      var siblingName = next ? 'nextSibling' : 'previousSibling';\n\n      for (var node = startNode, parent_1 = node.parentNode; node && node !== endNode; node = parent_1) {\n        parent_1 = node.parentNode;\n        var siblings_1 = collectSiblings(node === startNode ? node : node[siblingName], siblingName);\n\n        if (siblings_1.length) {\n          if (!next) {\n            siblings_1.reverse();\n          }\n\n          callback(exclude(siblings_1));\n        }\n      }\n    };\n\n    if (startContainer.nodeType === 1 && startContainer.hasChildNodes()) {\n      startContainer = clampToExistingChildren(startContainer, startOffset);\n    }\n\n    if (endContainer.nodeType === 1 && endContainer.hasChildNodes()) {\n      endContainer = getEndChild(endContainer, endOffset);\n    }\n\n    if (startContainer === endContainer) {\n      return callback(exclude([startContainer]));\n    }\n\n    var ancestor = dom.findCommonAncestor(startContainer, endContainer);\n\n    for (var node = startContainer; node; node = node.parentNode) {\n      if (node === endContainer) {\n        return walkBoundary(startContainer, ancestor, true);\n      }\n\n      if (node === ancestor) {\n        break;\n      }\n    }\n\n    for (var node = endContainer; node; node = node.parentNode) {\n      if (node === startContainer) {\n        return walkBoundary(endContainer, ancestor);\n      }\n\n      if (node === ancestor) {\n        break;\n      }\n    }\n\n    var startPoint = findEndPoint(startContainer, ancestor) || startContainer;\n    var endPoint = findEndPoint(endContainer, ancestor) || endContainer;\n    walkBoundary(startContainer, startPoint, true);\n    var siblings = collectSiblings(startPoint === startContainer ? startPoint : startPoint.nextSibling, 'nextSibling', endPoint === endContainer ? endPoint.nextSibling : endPoint);\n\n    if (siblings.length) {\n      callback(exclude(siblings));\n    }\n\n    walkBoundary(endContainer, endPoint);\n  };\n\n  var getRanges = function (selection) {\n    var ranges = [];\n\n    if (selection) {\n      for (var i = 0; i < selection.rangeCount; i++) {\n        ranges.push(selection.getRangeAt(i));\n      }\n    }\n\n    return ranges;\n  };\n\n  var getSelectedNodes = function (ranges) {\n    return bind(ranges, function (range) {\n      var node = getSelectedNode(range);\n      return node ? [SugarElement.fromDom(node)] : [];\n    });\n  };\n\n  var hasMultipleRanges = function (selection) {\n    return getRanges(selection).length > 1;\n  };\n\n  var getCellsFromRanges = function (ranges) {\n    return filter(getSelectedNodes(ranges), isTableCell$1);\n  };\n\n  var getCellsFromElement = function (elm) {\n    return descendants$1(elm, 'td[data-mce-selected],th[data-mce-selected]');\n  };\n\n  var getCellsFromElementOrRanges = function (ranges, element) {\n    var selectedCells = getCellsFromElement(element);\n    return selectedCells.length > 0 ? selectedCells : getCellsFromRanges(ranges);\n  };\n\n  var getCellsFromEditor = function (editor) {\n    return getCellsFromElementOrRanges(getRanges(editor.selection.getSel()), SugarElement.fromDom(editor.getBody()));\n  };\n\n  var getStartNode = function (rng) {\n    var sc = rng.startContainer,\n        so = rng.startOffset;\n\n    if (isText$1(sc)) {\n      return so === 0 ? Optional.some(SugarElement.fromDom(sc)) : Optional.none();\n    } else {\n      return Optional.from(sc.childNodes[so]).map(SugarElement.fromDom);\n    }\n  };\n\n  var getEndNode = function (rng) {\n    var ec = rng.endContainer,\n        eo = rng.endOffset;\n\n    if (isText$1(ec)) {\n      return eo === ec.data.length ? Optional.some(SugarElement.fromDom(ec)) : Optional.none();\n    } else {\n      return Optional.from(ec.childNodes[eo - 1]).map(SugarElement.fromDom);\n    }\n  };\n\n  var getFirstChildren = function (node) {\n    return firstChild(node).fold(constant([node]), function (child) {\n      return [node].concat(getFirstChildren(child));\n    });\n  };\n\n  var getLastChildren = function (node) {\n    return lastChild(node).fold(constant([node]), function (child) {\n      if (name(child) === 'br') {\n        return prevSibling(child).map(function (sibling) {\n          return [node].concat(getLastChildren(sibling));\n        }).getOr([]);\n      } else {\n        return [node].concat(getLastChildren(child));\n      }\n    });\n  };\n\n  var hasAllContentsSelected = function (elm, rng) {\n    return lift2(getStartNode(rng), getEndNode(rng), function (startNode, endNode) {\n      var start = find(getFirstChildren(elm), curry(eq$2, startNode));\n      var end = find(getLastChildren(elm), curry(eq$2, endNode));\n      return start.isSome() && end.isSome();\n    }).getOr(false);\n  };\n\n  var moveEndPoint$1 = function (dom, rng, node, start) {\n    var root = node,\n        walker = new DomTreeWalker(node, root);\n    var moveCaretBeforeOnEnterElementsMap = filter$1(dom.schema.getMoveCaretBeforeOnEnterElements(), function (_, name) {\n      return !contains(['td', 'th', 'table'], name.toLowerCase());\n    });\n\n    do {\n      if (isText$1(node) && Tools.trim(node.nodeValue).length !== 0) {\n        if (start) {\n          rng.setStart(node, 0);\n        } else {\n          rng.setEnd(node, node.nodeValue.length);\n        }\n\n        return;\n      }\n\n      if (moveCaretBeforeOnEnterElementsMap[node.nodeName]) {\n        if (start) {\n          rng.setStartBefore(node);\n        } else {\n          if (node.nodeName === 'BR') {\n            rng.setEndBefore(node);\n          } else {\n            rng.setEndAfter(node);\n          }\n        }\n\n        return;\n      }\n    } while (node = start ? walker.next() : walker.prev());\n\n    if (root.nodeName === 'BODY') {\n      if (start) {\n        rng.setStart(root, 0);\n      } else {\n        rng.setEnd(root, root.childNodes.length);\n      }\n    }\n  };\n\n  var hasAnyRanges = function (editor) {\n    var sel = editor.selection.getSel();\n    return sel && sel.rangeCount > 0;\n  };\n\n  var runOnRanges = function (editor, executor) {\n    var fakeSelectionNodes = getCellsFromEditor(editor);\n\n    if (fakeSelectionNodes.length > 0) {\n      each(fakeSelectionNodes, function (elem) {\n        var node = elem.dom;\n        var fakeNodeRng = editor.dom.createRng();\n        fakeNodeRng.setStartBefore(node);\n        fakeNodeRng.setEndAfter(node);\n        executor(fakeNodeRng, true);\n      });\n    } else {\n      executor(editor.selection.getRng(), false);\n    }\n  };\n\n  var preserve = function (selection, fillBookmark, executor) {\n    var bookmark = getPersistentBookmark(selection, fillBookmark);\n    executor(bookmark);\n    selection.moveToBookmark(bookmark);\n  };\n\n  var NodeValue = function (is, name) {\n    var get = function (element) {\n      if (!is(element)) {\n        throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n      }\n\n      return getOption(element).getOr('');\n    };\n\n    var getOption = function (element) {\n      return is(element) ? Optional.from(element.dom.nodeValue) : Optional.none();\n    };\n\n    var set = function (element, value) {\n      if (!is(element)) {\n        throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n      }\n\n      element.dom.nodeValue = value;\n    };\n\n    return {\n      get: get,\n      getOption: getOption,\n      set: set\n    };\n  };\n\n  var api = NodeValue(isText, 'text');\n\n  var get$8 = function (element) {\n    return api.get(element);\n  };\n\n  var isZeroWidth = function (elem) {\n    return isText(elem) && get$8(elem) === ZWSP;\n  };\n\n  var context = function (editor, elem, wrapName, nodeName) {\n    return parent(elem).fold(function () {\n      return 'skipping';\n    }, function (parent) {\n      if (nodeName === 'br' || isZeroWidth(elem)) {\n        return 'valid';\n      } else if (isAnnotation(elem)) {\n        return 'existing';\n      } else if (isCaretNode(elem.dom)) {\n        return 'caret';\n      } else if (!isValid(editor, wrapName, nodeName) || !isValid(editor, name(parent), wrapName)) {\n        return 'invalid-child';\n      } else {\n        return 'valid';\n      }\n    });\n  };\n\n  var applyWordGrab = function (editor, rng) {\n    var r = expandRng(editor, rng, [{\n      inline: true\n    }]);\n    rng.setStart(r.startContainer, r.startOffset);\n    rng.setEnd(r.endContainer, r.endOffset);\n    editor.selection.setRng(rng);\n  };\n\n  var makeAnnotation = function (eDoc, _a, annotationName, decorate) {\n    var _b = _a.uid,\n        uid = _b === void 0 ? generate$1('mce-annotation') : _b,\n        data = __rest(_a, ['uid']);\n\n    var master = SugarElement.fromTag('span', eDoc);\n    add$3(master, annotation());\n    set(master, '' + dataAnnotationId(), uid);\n    set(master, '' + dataAnnotation(), annotationName);\n\n    var _c = decorate(uid, data),\n        _d = _c.attributes,\n        attributes = _d === void 0 ? {} : _d,\n        _e = _c.classes,\n        classes = _e === void 0 ? [] : _e;\n\n    setAll(master, attributes);\n    add$4(master, classes);\n    return master;\n  };\n\n  var annotate = function (editor, rng, annotationName, decorate, data) {\n    var newWrappers = [];\n    var master = makeAnnotation(editor.getDoc(), data, annotationName, decorate);\n    var wrapper = Cell(Optional.none());\n\n    var finishWrapper = function () {\n      wrapper.set(Optional.none());\n    };\n\n    var getOrOpenWrapper = function () {\n      return wrapper.get().getOrThunk(function () {\n        var nu = shallow(master);\n        newWrappers.push(nu);\n        wrapper.set(Optional.some(nu));\n        return nu;\n      });\n    };\n\n    var processElements = function (elems) {\n      each(elems, processElement);\n    };\n\n    var processElement = function (elem) {\n      var ctx = context(editor, elem, 'span', name(elem));\n\n      switch (ctx) {\n        case 'invalid-child':\n          {\n            finishWrapper();\n            var children$1 = children(elem);\n            processElements(children$1);\n            finishWrapper();\n            break;\n          }\n\n        case 'valid':\n          {\n            var w = getOrOpenWrapper();\n            wrap(elem, w);\n            break;\n          }\n      }\n    };\n\n    var processNodes = function (nodes) {\n      var elems = map(nodes, SugarElement.fromDom);\n      processElements(elems);\n    };\n\n    walk$1(editor.dom, rng, function (nodes) {\n      finishWrapper();\n      processNodes(nodes);\n    });\n    return newWrappers;\n  };\n\n  var annotateWithBookmark = function (editor, name, settings, data) {\n    editor.undoManager.transact(function () {\n      var selection = editor.selection;\n      var initialRng = selection.getRng();\n      var hasFakeSelection = getCellsFromEditor(editor).length > 0;\n\n      if (initialRng.collapsed && !hasFakeSelection) {\n        applyWordGrab(editor, initialRng);\n      }\n\n      if (selection.getRng().collapsed && !hasFakeSelection) {\n        var wrapper = makeAnnotation(editor.getDoc(), data, name, settings.decorate);\n        set$1(wrapper, nbsp);\n        selection.getRng().insertNode(wrapper.dom);\n        selection.select(wrapper.dom);\n      } else {\n        preserve(selection, false, function () {\n          runOnRanges(editor, function (selectionRng) {\n            annotate(editor, selectionRng, name, settings.decorate, data);\n          });\n        });\n      }\n    });\n  };\n\n  var Annotator = function (editor) {\n    var registry = create$2();\n    setup$1(editor, registry);\n    var changes = setup(editor);\n    return {\n      register: function (name, settings) {\n        registry.register(name, settings);\n      },\n      annotate: function (name, data) {\n        registry.lookup(name).each(function (settings) {\n          annotateWithBookmark(editor, name, settings, data);\n        });\n      },\n      annotationChanged: function (name, callback) {\n        changes.addListener(name, callback);\n      },\n      remove: function (name) {\n        identify(editor, Optional.some(name)).each(function (_a) {\n          var elements = _a.elements;\n          each(elements, unwrap);\n        });\n      },\n      getAll: function (name) {\n        var directory = findAll(editor, name);\n        return map$1(directory, function (elems) {\n          return map(elems, function (elem) {\n            return elem.dom;\n          });\n        });\n      }\n    };\n  };\n\n  var BookmarkManager = function (selection) {\n    return {\n      getBookmark: curry(getBookmark$1, selection),\n      moveToBookmark: curry(moveToBookmark, selection)\n    };\n  };\n\n  BookmarkManager.isBookmarkNode = isBookmarkNode$1;\n\n  var getContentEditableRoot = function (root, node) {\n    while (node && node !== root) {\n      if (isContentEditableTrue(node) || isContentEditableFalse(node)) {\n        return node;\n      }\n\n      node = node.parentNode;\n    }\n\n    return null;\n  };\n\n  var isXYWithinRange = function (clientX, clientY, range) {\n    if (range.collapsed) {\n      return false;\n    }\n\n    if (Env.browser.isIE() && range.startOffset === range.endOffset - 1 && range.startContainer === range.endContainer) {\n      var elm = range.startContainer.childNodes[range.startOffset];\n\n      if (isElement$1(elm)) {\n        return exists(elm.getClientRects(), function (rect) {\n          return containsXY(rect, clientX, clientY);\n        });\n      }\n    }\n\n    return exists(range.getClientRects(), function (rect) {\n      return containsXY(rect, clientX, clientY);\n    });\n  };\n\n  var firePreProcess = function (editor, args) {\n    return editor.fire('PreProcess', args);\n  };\n\n  var firePostProcess = function (editor, args) {\n    return editor.fire('PostProcess', args);\n  };\n\n  var fireRemove = function (editor) {\n    return editor.fire('remove');\n  };\n\n  var fireDetach = function (editor) {\n    return editor.fire('detach');\n  };\n\n  var fireSwitchMode = function (editor, mode) {\n    return editor.fire('SwitchMode', {\n      mode: mode\n    });\n  };\n\n  var fireObjectResizeStart = function (editor, target, width, height, origin) {\n    editor.fire('ObjectResizeStart', {\n      target: target,\n      width: width,\n      height: height,\n      origin: origin\n    });\n  };\n\n  var fireObjectResized = function (editor, target, width, height, origin) {\n    editor.fire('ObjectResized', {\n      target: target,\n      width: width,\n      height: height,\n      origin: origin\n    });\n  };\n\n  var firePreInit = function (editor) {\n    return editor.fire('PreInit');\n  };\n\n  var firePostRender = function (editor) {\n    return editor.fire('PostRender');\n  };\n\n  var fireInit = function (editor) {\n    return editor.fire('Init');\n  };\n\n  var firePlaceholderToggle = function (editor, state) {\n    return editor.fire('PlaceholderToggle', {\n      state: state\n    });\n  };\n\n  var fireError = function (editor, errorType, error) {\n    return editor.fire(errorType, error);\n  };\n\n  var VK = {\n    BACKSPACE: 8,\n    DELETE: 46,\n    DOWN: 40,\n    ENTER: 13,\n    LEFT: 37,\n    RIGHT: 39,\n    SPACEBAR: 32,\n    TAB: 9,\n    UP: 38,\n    PAGE_UP: 33,\n    PAGE_DOWN: 34,\n    END: 35,\n    HOME: 36,\n    modifierPressed: function (e) {\n      return e.shiftKey || e.ctrlKey || e.altKey || VK.metaKeyPressed(e);\n    },\n    metaKeyPressed: function (e) {\n      return Env.mac ? e.metaKey : e.ctrlKey && !e.altKey;\n    }\n  };\n  var isContentEditableFalse$6 = isContentEditableFalse;\n\n  var ControlSelection = function (selection, editor) {\n    var elementSelectionAttr = 'data-mce-selected';\n    var dom = editor.dom,\n        each$2 = Tools.each;\n    var selectedElm, selectedElmGhost, resizeHelper, selectedHandle, resizeBackdrop;\n    var startX, startY, selectedElmX, selectedElmY, startW, startH, ratio, resizeStarted;\n    var width, height;\n    var editableDoc = editor.getDoc(),\n        rootDocument = document;\n    var abs = Math.abs,\n        round = Math.round,\n        rootElement = editor.getBody();\n    var startScrollWidth, startScrollHeight;\n    var resizeHandles = {\n      nw: [0, 0, -1, -1],\n      ne: [1, 0, 1, -1],\n      se: [1, 1, 1, 1],\n      sw: [0, 1, -1, 1]\n    };\n\n    var isImage = function (elm) {\n      return elm && (elm.nodeName === 'IMG' || editor.dom.is(elm, 'figure.image'));\n    };\n\n    var isMedia$1 = function (elm) {\n      return isMedia(elm) || dom.hasClass(elm, 'mce-preview-object');\n    };\n\n    var isEventOnImageOutsideRange = function (evt, range) {\n      if (evt.type === 'longpress' || evt.type.indexOf('touch') === 0) {\n        var touch = evt.touches[0];\n        return isImage(evt.target) && !isXYWithinRange(touch.clientX, touch.clientY, range);\n      } else {\n        return isImage(evt.target) && !isXYWithinRange(evt.clientX, evt.clientY, range);\n      }\n    };\n\n    var contextMenuSelectImage = function (evt) {\n      var target = evt.target;\n\n      if (isEventOnImageOutsideRange(evt, editor.selection.getRng()) && !evt.isDefaultPrevented()) {\n        editor.selection.select(target);\n      }\n    };\n\n    var getResizeTargets = function (elm) {\n      if (dom.is(elm, 'figure.image')) {\n        return [elm.querySelector('img')];\n      } else if (dom.hasClass(elm, 'mce-preview-object') && isNonNullable(elm.firstElementChild)) {\n        return [elm, elm.firstElementChild];\n      } else {\n        return [elm];\n      }\n    };\n\n    var isResizable = function (elm) {\n      var selector = getObjectResizing(editor);\n\n      if (!selector) {\n        return false;\n      }\n\n      if (elm.getAttribute('data-mce-resize') === 'false') {\n        return false;\n      }\n\n      if (elm === editor.getBody()) {\n        return false;\n      }\n\n      if (dom.hasClass(elm, 'mce-preview-object')) {\n        return is$1(SugarElement.fromDom(elm.firstElementChild), selector);\n      } else {\n        return is$1(SugarElement.fromDom(elm), selector);\n      }\n    };\n\n    var createGhostElement = function (elm) {\n      if (isMedia$1(elm)) {\n        return dom.create('img', {\n          src: Env.transparentSrc\n        });\n      } else {\n        return elm.cloneNode(true);\n      }\n    };\n\n    var setSizeProp = function (element, name, value) {\n      if (isNonNullable(value)) {\n        var targets = getResizeTargets(element);\n        each(targets, function (target) {\n          if (target.style[name] || !editor.schema.isValid(target.nodeName.toLowerCase(), name)) {\n            dom.setStyle(target, name, value);\n          } else {\n            dom.setAttrib(target, name, '' + value);\n          }\n        });\n      }\n    };\n\n    var setGhostElmSize = function (ghostElm, width, height) {\n      setSizeProp(ghostElm, 'width', width);\n      setSizeProp(ghostElm, 'height', height);\n    };\n\n    var resizeGhostElement = function (e) {\n      var deltaX, deltaY, proportional;\n      var resizeHelperX, resizeHelperY;\n      deltaX = e.screenX - startX;\n      deltaY = e.screenY - startY;\n      width = deltaX * selectedHandle[2] + startW;\n      height = deltaY * selectedHandle[3] + startH;\n      width = width < 5 ? 5 : width;\n      height = height < 5 ? 5 : height;\n\n      if ((isImage(selectedElm) || isMedia$1(selectedElm)) && getResizeImgProportional(editor) !== false) {\n        proportional = !VK.modifierPressed(e);\n      } else {\n        proportional = VK.modifierPressed(e);\n      }\n\n      if (proportional) {\n        if (abs(deltaX) > abs(deltaY)) {\n          height = round(width * ratio);\n          width = round(height / ratio);\n        } else {\n          width = round(height / ratio);\n          height = round(width * ratio);\n        }\n      }\n\n      setGhostElmSize(selectedElmGhost, width, height);\n      resizeHelperX = selectedHandle.startPos.x + deltaX;\n      resizeHelperY = selectedHandle.startPos.y + deltaY;\n      resizeHelperX = resizeHelperX > 0 ? resizeHelperX : 0;\n      resizeHelperY = resizeHelperY > 0 ? resizeHelperY : 0;\n      dom.setStyles(resizeHelper, {\n        left: resizeHelperX,\n        top: resizeHelperY,\n        display: 'block'\n      });\n      resizeHelper.innerHTML = width + ' &times; ' + height;\n\n      if (selectedHandle[2] < 0 && selectedElmGhost.clientWidth <= width) {\n        dom.setStyle(selectedElmGhost, 'left', selectedElmX + (startW - width));\n      }\n\n      if (selectedHandle[3] < 0 && selectedElmGhost.clientHeight <= height) {\n        dom.setStyle(selectedElmGhost, 'top', selectedElmY + (startH - height));\n      }\n\n      deltaX = rootElement.scrollWidth - startScrollWidth;\n      deltaY = rootElement.scrollHeight - startScrollHeight;\n\n      if (deltaX + deltaY !== 0) {\n        dom.setStyles(resizeHelper, {\n          left: resizeHelperX - deltaX,\n          top: resizeHelperY - deltaY\n        });\n      }\n\n      if (!resizeStarted) {\n        fireObjectResizeStart(editor, selectedElm, startW, startH, 'corner-' + selectedHandle.name);\n        resizeStarted = true;\n      }\n    };\n\n    var endGhostResize = function () {\n      var wasResizeStarted = resizeStarted;\n      resizeStarted = false;\n\n      if (wasResizeStarted) {\n        setSizeProp(selectedElm, 'width', width);\n        setSizeProp(selectedElm, 'height', height);\n      }\n\n      dom.unbind(editableDoc, 'mousemove', resizeGhostElement);\n      dom.unbind(editableDoc, 'mouseup', endGhostResize);\n\n      if (rootDocument !== editableDoc) {\n        dom.unbind(rootDocument, 'mousemove', resizeGhostElement);\n        dom.unbind(rootDocument, 'mouseup', endGhostResize);\n      }\n\n      dom.remove(selectedElmGhost);\n      dom.remove(resizeHelper);\n      dom.remove(resizeBackdrop);\n      showResizeRect(selectedElm);\n\n      if (wasResizeStarted) {\n        fireObjectResized(editor, selectedElm, width, height, 'corner-' + selectedHandle.name);\n        dom.setAttrib(selectedElm, 'style', dom.getAttrib(selectedElm, 'style'));\n      }\n\n      editor.nodeChanged();\n    };\n\n    var showResizeRect = function (targetElm) {\n      unbindResizeHandleEvents();\n      var position = dom.getPos(targetElm, rootElement);\n      var selectedElmX = position.x;\n      var selectedElmY = position.y;\n      var rect = targetElm.getBoundingClientRect();\n      var targetWidth = rect.width || rect.right - rect.left;\n      var targetHeight = rect.height || rect.bottom - rect.top;\n\n      if (selectedElm !== targetElm) {\n        hideResizeRect();\n        selectedElm = targetElm;\n        width = height = 0;\n      }\n\n      var e = editor.fire('ObjectSelected', {\n        target: targetElm\n      });\n      var selectedValue = dom.getAttrib(selectedElm, elementSelectionAttr, '1');\n\n      if (isResizable(targetElm) && !e.isDefaultPrevented()) {\n        each$2(resizeHandles, function (handle, name) {\n          var handleElm;\n\n          var startDrag = function (e) {\n            var target = getResizeTargets(selectedElm)[0];\n            startX = e.screenX;\n            startY = e.screenY;\n            startW = target.clientWidth;\n            startH = target.clientHeight;\n            ratio = startH / startW;\n            selectedHandle = handle;\n            selectedHandle.name = name;\n            selectedHandle.startPos = {\n              x: targetWidth * handle[0] + selectedElmX,\n              y: targetHeight * handle[1] + selectedElmY\n            };\n            startScrollWidth = rootElement.scrollWidth;\n            startScrollHeight = rootElement.scrollHeight;\n            resizeBackdrop = dom.add(rootElement, 'div', {\n              class: 'mce-resize-backdrop'\n            });\n            dom.setStyles(resizeBackdrop, {\n              position: 'fixed',\n              left: '0',\n              top: '0',\n              width: '100%',\n              height: '100%'\n            });\n            selectedElmGhost = createGhostElement(selectedElm);\n            dom.addClass(selectedElmGhost, 'mce-clonedresizable');\n            dom.setAttrib(selectedElmGhost, 'data-mce-bogus', 'all');\n            selectedElmGhost.contentEditable = 'false';\n            dom.setStyles(selectedElmGhost, {\n              left: selectedElmX,\n              top: selectedElmY,\n              margin: 0\n            });\n            setGhostElmSize(selectedElmGhost, targetWidth, targetHeight);\n            selectedElmGhost.removeAttribute(elementSelectionAttr);\n            rootElement.appendChild(selectedElmGhost);\n            dom.bind(editableDoc, 'mousemove', resizeGhostElement);\n            dom.bind(editableDoc, 'mouseup', endGhostResize);\n\n            if (rootDocument !== editableDoc) {\n              dom.bind(rootDocument, 'mousemove', resizeGhostElement);\n              dom.bind(rootDocument, 'mouseup', endGhostResize);\n            }\n\n            resizeHelper = dom.add(rootElement, 'div', {\n              'class': 'mce-resize-helper',\n              'data-mce-bogus': 'all'\n            }, startW + ' &times; ' + startH);\n          };\n\n          handleElm = dom.get('mceResizeHandle' + name);\n\n          if (handleElm) {\n            dom.remove(handleElm);\n          }\n\n          handleElm = dom.add(rootElement, 'div', {\n            'id': 'mceResizeHandle' + name,\n            'data-mce-bogus': 'all',\n            'class': 'mce-resizehandle',\n            'unselectable': true,\n            'style': 'cursor:' + name + '-resize; margin:0; padding:0'\n          });\n\n          if (Env.ie === 11) {\n            handleElm.contentEditable = false;\n          }\n\n          dom.bind(handleElm, 'mousedown', function (e) {\n            e.stopImmediatePropagation();\n            e.preventDefault();\n            startDrag(e);\n          });\n          handle.elm = handleElm;\n          dom.setStyles(handleElm, {\n            left: targetWidth * handle[0] + selectedElmX - handleElm.offsetWidth / 2,\n            top: targetHeight * handle[1] + selectedElmY - handleElm.offsetHeight / 2\n          });\n        });\n      } else {\n        hideResizeRect();\n      }\n\n      if (!dom.getAttrib(selectedElm, elementSelectionAttr)) {\n        selectedElm.setAttribute(elementSelectionAttr, selectedValue);\n      }\n    };\n\n    var hideResizeRect = function () {\n      unbindResizeHandleEvents();\n\n      if (selectedElm) {\n        selectedElm.removeAttribute(elementSelectionAttr);\n      }\n\n      each$1(resizeHandles, function (value, name) {\n        var handleElm = dom.get('mceResizeHandle' + name);\n\n        if (handleElm) {\n          dom.unbind(handleElm);\n          dom.remove(handleElm);\n        }\n      });\n    };\n\n    var updateResizeRect = function (e) {\n      var startElm, controlElm;\n\n      var isChildOrEqual = function (node, parent) {\n        if (node) {\n          do {\n            if (node === parent) {\n              return true;\n            }\n          } while (node = node.parentNode);\n        }\n      };\n\n      if (resizeStarted || editor.removed) {\n        return;\n      }\n\n      each$2(dom.select('img[data-mce-selected],hr[data-mce-selected]'), function (img) {\n        img.removeAttribute(elementSelectionAttr);\n      });\n      controlElm = e.type === 'mousedown' ? e.target : selection.getNode();\n      controlElm = dom.$(controlElm).closest('table,img,figure.image,hr,video,span.mce-preview-object')[0];\n\n      if (isChildOrEqual(controlElm, rootElement)) {\n        disableGeckoResize();\n        startElm = selection.getStart(true);\n\n        if (isChildOrEqual(startElm, controlElm) && isChildOrEqual(selection.getEnd(true), controlElm)) {\n          showResizeRect(controlElm);\n          return;\n        }\n      }\n\n      hideResizeRect();\n    };\n\n    var isWithinContentEditableFalse = function (elm) {\n      return isContentEditableFalse$6(getContentEditableRoot(editor.getBody(), elm));\n    };\n\n    var unbindResizeHandleEvents = function () {\n      each$1(resizeHandles, function (handle) {\n        if (handle.elm) {\n          dom.unbind(handle.elm);\n          delete handle.elm;\n        }\n      });\n    };\n\n    var disableGeckoResize = function () {\n      try {\n        editor.getDoc().execCommand('enableObjectResizing', false, 'false');\n      } catch (ex) {}\n    };\n\n    editor.on('init', function () {\n      disableGeckoResize();\n\n      if (Env.browser.isIE() || Env.browser.isEdge()) {\n        editor.on('mousedown click', function (e) {\n          var target = e.target,\n              nodeName = target.nodeName;\n\n          if (!resizeStarted && /^(TABLE|IMG|HR)$/.test(nodeName) && !isWithinContentEditableFalse(target)) {\n            if (e.button !== 2) {\n              editor.selection.select(target, nodeName === 'TABLE');\n            }\n\n            if (e.type === 'mousedown') {\n              editor.nodeChanged();\n            }\n          }\n        });\n\n        var handleMSControlSelect_1 = function (e) {\n          var delayedSelect = function (node) {\n            Delay.setEditorTimeout(editor, function () {\n              return editor.selection.select(node);\n            });\n          };\n\n          if (isWithinContentEditableFalse(e.target) || isMedia(e.target)) {\n            e.preventDefault();\n            delayedSelect(e.target);\n            return;\n          }\n\n          if (/^(TABLE|IMG|HR)$/.test(e.target.nodeName)) {\n            e.preventDefault();\n\n            if (e.target.tagName === 'IMG') {\n              delayedSelect(e.target);\n            }\n          }\n        };\n\n        dom.bind(rootElement, 'mscontrolselect', handleMSControlSelect_1);\n        editor.on('remove', function () {\n          return dom.unbind(rootElement, 'mscontrolselect', handleMSControlSelect_1);\n        });\n      }\n\n      var throttledUpdateResizeRect = Delay.throttle(function (e) {\n        if (!editor.composing) {\n          updateResizeRect(e);\n        }\n      });\n      editor.on('nodechange ResizeEditor ResizeWindow ResizeContent drop FullscreenStateChanged', throttledUpdateResizeRect);\n      editor.on('keyup compositionend', function (e) {\n        if (selectedElm && selectedElm.nodeName === 'TABLE') {\n          throttledUpdateResizeRect(e);\n        }\n      });\n      editor.on('hide blur', hideResizeRect);\n      editor.on('contextmenu longpress', contextMenuSelectImage, true);\n    });\n    editor.on('remove', unbindResizeHandleEvents);\n\n    var destroy = function () {\n      selectedElm = selectedElmGhost = resizeBackdrop = null;\n    };\n\n    return {\n      isResizable: isResizable,\n      showResizeRect: showResizeRect,\n      hideResizeRect: hideResizeRect,\n      updateResizeRect: updateResizeRect,\n      destroy: destroy\n    };\n  };\n\n  var hasCeProperty = function (node) {\n    return isContentEditableTrue(node) || isContentEditableFalse(node);\n  };\n\n  var findParent = function (node, rootNode, predicate) {\n    while (node && node !== rootNode) {\n      if (predicate(node)) {\n        return node;\n      }\n\n      node = node.parentNode;\n    }\n\n    return null;\n  };\n\n  var findClosestIeRange = function (clientX, clientY, doc) {\n    var rects;\n    var element = doc.elementFromPoint(clientX, clientY);\n    var rng = doc.body.createTextRange();\n\n    if (!element || element.tagName === 'HTML') {\n      element = doc.body;\n    }\n\n    rng.moveToElementText(element);\n    rects = Tools.toArray(rng.getClientRects());\n    rects = rects.sort(function (a, b) {\n      a = Math.abs(Math.max(a.top - clientY, a.bottom - clientY));\n      b = Math.abs(Math.max(b.top - clientY, b.bottom - clientY));\n      return a - b;\n    });\n\n    if (rects.length > 0) {\n      clientY = (rects[0].bottom + rects[0].top) / 2;\n\n      try {\n        rng.moveToPoint(clientX, clientY);\n        rng.collapse(true);\n        return rng;\n      } catch (ex) {}\n    }\n\n    return null;\n  };\n\n  var moveOutOfContentEditableFalse = function (rng, rootNode) {\n    var parentElement = rng && rng.parentElement ? rng.parentElement() : null;\n    return isContentEditableFalse(findParent(parentElement, rootNode, hasCeProperty)) ? null : rng;\n  };\n\n  var fromPoint$1 = function (clientX, clientY, doc) {\n    var rng, point;\n    var pointDoc = doc;\n\n    if (pointDoc.caretPositionFromPoint) {\n      point = pointDoc.caretPositionFromPoint(clientX, clientY);\n\n      if (point) {\n        rng = doc.createRange();\n        rng.setStart(point.offsetNode, point.offset);\n        rng.collapse(true);\n      }\n    } else if (doc.caretRangeFromPoint) {\n      rng = doc.caretRangeFromPoint(clientX, clientY);\n    } else if (pointDoc.body.createTextRange) {\n      rng = pointDoc.body.createTextRange();\n\n      try {\n        rng.moveToPoint(clientX, clientY);\n        rng.collapse(true);\n      } catch (ex) {\n        rng = findClosestIeRange(clientX, clientY, doc);\n      }\n\n      return moveOutOfContentEditableFalse(rng, doc.body);\n    }\n\n    return rng;\n  };\n\n  var isEq$1 = function (rng1, rng2) {\n    return rng1 && rng2 && rng1.startContainer === rng2.startContainer && rng1.startOffset === rng2.startOffset && rng1.endContainer === rng2.endContainer && rng1.endOffset === rng2.endOffset;\n  };\n\n  var findParent$1 = function (node, rootNode, predicate) {\n    while (node && node !== rootNode) {\n      if (predicate(node)) {\n        return node;\n      }\n\n      node = node.parentNode;\n    }\n\n    return null;\n  };\n\n  var hasParent = function (node, rootNode, predicate) {\n    return findParent$1(node, rootNode, predicate) !== null;\n  };\n\n  var hasParentWithName = function (node, rootNode, name) {\n    return hasParent(node, rootNode, function (node) {\n      return node.nodeName === name;\n    });\n  };\n\n  var isTable$3 = function (node) {\n    return node && node.nodeName === 'TABLE';\n  };\n\n  var isTableCell$3 = function (node) {\n    return node && /^(TD|TH|CAPTION)$/.test(node.nodeName);\n  };\n\n  var isCeFalseCaretContainer = function (node, rootNode) {\n    return isCaretContainer(node) && hasParent(node, rootNode, isCaretNode) === false;\n  };\n\n  var hasBrBeforeAfter = function (dom, node, left) {\n    var walker = new DomTreeWalker(node, dom.getParent(node.parentNode, dom.isBlock) || dom.getRoot());\n\n    while (node = walker[left ? 'prev' : 'next']()) {\n      if (isBr(node)) {\n        return true;\n      }\n    }\n  };\n\n  var isPrevNode = function (node, name) {\n    return node.previousSibling && node.previousSibling.nodeName === name;\n  };\n\n  var hasContentEditableFalseParent = function (body, node) {\n    while (node && node !== body) {\n      if (isContentEditableFalse(node)) {\n        return true;\n      }\n\n      node = node.parentNode;\n    }\n\n    return false;\n  };\n\n  var findTextNodeRelative = function (dom, isAfterNode, collapsed, left, startNode) {\n    var lastInlineElement;\n    var body = dom.getRoot();\n    var node;\n    var nonEmptyElementsMap = dom.schema.getNonEmptyElements();\n    var parentBlockContainer = dom.getParent(startNode.parentNode, dom.isBlock) || body;\n\n    if (left && isBr(startNode) && isAfterNode && dom.isEmpty(parentBlockContainer)) {\n      return Optional.some(CaretPosition(startNode.parentNode, dom.nodeIndex(startNode)));\n    }\n\n    var walker = new DomTreeWalker(startNode, parentBlockContainer);\n\n    while (node = walker[left ? 'prev' : 'next']()) {\n      if (dom.getContentEditableParent(node) === 'false' || isCeFalseCaretContainer(node, body)) {\n        return Optional.none();\n      }\n\n      if (isText$1(node) && node.nodeValue.length > 0) {\n        if (hasParentWithName(node, body, 'A') === false) {\n          return Optional.some(CaretPosition(node, left ? node.nodeValue.length : 0));\n        }\n\n        return Optional.none();\n      }\n\n      if (dom.isBlock(node) || nonEmptyElementsMap[node.nodeName.toLowerCase()]) {\n        return Optional.none();\n      }\n\n      lastInlineElement = node;\n    }\n\n    if (collapsed && lastInlineElement) {\n      return Optional.some(CaretPosition(lastInlineElement, 0));\n    }\n\n    return Optional.none();\n  };\n\n  var normalizeEndPoint = function (dom, collapsed, start, rng) {\n    var container, offset;\n    var body = dom.getRoot();\n    var node;\n    var directionLeft,\n        normalized = false;\n    container = rng[(start ? 'start' : 'end') + 'Container'];\n    offset = rng[(start ? 'start' : 'end') + 'Offset'];\n    var isAfterNode = isElement$1(container) && offset === container.childNodes.length;\n    var nonEmptyElementsMap = dom.schema.getNonEmptyElements();\n    directionLeft = start;\n\n    if (isCaretContainer(container)) {\n      return Optional.none();\n    }\n\n    if (isElement$1(container) && offset > container.childNodes.length - 1) {\n      directionLeft = false;\n    }\n\n    if (isDocument$1(container)) {\n      container = body;\n      offset = 0;\n    }\n\n    if (container === body) {\n      if (directionLeft) {\n        node = container.childNodes[offset > 0 ? offset - 1 : 0];\n\n        if (node) {\n          if (isCaretContainer(node)) {\n            return Optional.none();\n          }\n\n          if (nonEmptyElementsMap[node.nodeName] || isTable$3(node)) {\n            return Optional.none();\n          }\n        }\n      }\n\n      if (container.hasChildNodes()) {\n        offset = Math.min(!directionLeft && offset > 0 ? offset - 1 : offset, container.childNodes.length - 1);\n        container = container.childNodes[offset];\n        offset = isText$1(container) && isAfterNode ? container.data.length : 0;\n\n        if (!collapsed && container === body.lastChild && isTable$3(container)) {\n          return Optional.none();\n        }\n\n        if (hasContentEditableFalseParent(body, container) || isCaretContainer(container)) {\n          return Optional.none();\n        }\n\n        if (container.hasChildNodes() && isTable$3(container) === false) {\n          node = container;\n          var walker = new DomTreeWalker(container, body);\n\n          do {\n            if (isContentEditableFalse(node) || isCaretContainer(node)) {\n              normalized = false;\n              break;\n            }\n\n            if (isText$1(node) && node.nodeValue.length > 0) {\n              offset = directionLeft ? 0 : node.nodeValue.length;\n              container = node;\n              normalized = true;\n              break;\n            }\n\n            if (nonEmptyElementsMap[node.nodeName.toLowerCase()] && !isTableCell$3(node)) {\n              offset = dom.nodeIndex(node);\n              container = node.parentNode;\n\n              if (!directionLeft) {\n                offset++;\n              }\n\n              normalized = true;\n              break;\n            }\n          } while (node = directionLeft ? walker.next() : walker.prev());\n        }\n      }\n    }\n\n    if (collapsed) {\n      if (isText$1(container) && offset === 0) {\n        findTextNodeRelative(dom, isAfterNode, collapsed, true, container).each(function (pos) {\n          container = pos.container();\n          offset = pos.offset();\n          normalized = true;\n        });\n      }\n\n      if (isElement$1(container)) {\n        node = container.childNodes[offset];\n\n        if (!node) {\n          node = container.childNodes[offset - 1];\n        }\n\n        if (node && isBr(node) && !isPrevNode(node, 'A') && !hasBrBeforeAfter(dom, node, false) && !hasBrBeforeAfter(dom, node, true)) {\n          findTextNodeRelative(dom, isAfterNode, collapsed, true, node).each(function (pos) {\n            container = pos.container();\n            offset = pos.offset();\n            normalized = true;\n          });\n        }\n      }\n    }\n\n    if (directionLeft && !collapsed && isText$1(container) && offset === container.nodeValue.length) {\n      findTextNodeRelative(dom, isAfterNode, collapsed, false, container).each(function (pos) {\n        container = pos.container();\n        offset = pos.offset();\n        normalized = true;\n      });\n    }\n\n    return normalized ? Optional.some(CaretPosition(container, offset)) : Optional.none();\n  };\n\n  var normalize = function (dom, rng) {\n    var collapsed = rng.collapsed,\n        normRng = rng.cloneRange();\n    var startPos = CaretPosition.fromRangeStart(rng);\n    normalizeEndPoint(dom, collapsed, true, normRng).each(function (pos) {\n      if (!collapsed || !CaretPosition.isAbove(startPos, pos)) {\n        normRng.setStart(pos.container(), pos.offset());\n      }\n    });\n\n    if (!collapsed) {\n      normalizeEndPoint(dom, collapsed, false, normRng).each(function (pos) {\n        normRng.setEnd(pos.container(), pos.offset());\n      });\n    }\n\n    if (collapsed) {\n      normRng.collapse(true);\n    }\n\n    return isEq$1(rng, normRng) ? Optional.none() : Optional.some(normRng);\n  };\n\n  var splitText = function (node, offset) {\n    return node.splitText(offset);\n  };\n\n  var split$1 = function (rng) {\n    var startContainer = rng.startContainer,\n        startOffset = rng.startOffset,\n        endContainer = rng.endContainer,\n        endOffset = rng.endOffset;\n\n    if (startContainer === endContainer && isText$1(startContainer)) {\n      if (startOffset > 0 && startOffset < startContainer.nodeValue.length) {\n        endContainer = splitText(startContainer, startOffset);\n        startContainer = endContainer.previousSibling;\n\n        if (endOffset > startOffset) {\n          endOffset = endOffset - startOffset;\n          startContainer = endContainer = splitText(endContainer, endOffset).previousSibling;\n          endOffset = endContainer.nodeValue.length;\n          startOffset = 0;\n        } else {\n          endOffset = 0;\n        }\n      }\n    } else {\n      if (isText$1(startContainer) && startOffset > 0 && startOffset < startContainer.nodeValue.length) {\n        startContainer = splitText(startContainer, startOffset);\n        startOffset = 0;\n      }\n\n      if (isText$1(endContainer) && endOffset > 0 && endOffset < endContainer.nodeValue.length) {\n        endContainer = splitText(endContainer, endOffset).previousSibling;\n        endOffset = endContainer.nodeValue.length;\n      }\n    }\n\n    return {\n      startContainer: startContainer,\n      startOffset: startOffset,\n      endContainer: endContainer,\n      endOffset: endOffset\n    };\n  };\n\n  var RangeUtils = function (dom) {\n    var walk = function (rng, callback) {\n      return walk$1(dom, rng, callback);\n    };\n\n    var split = split$1;\n\n    var normalize$1 = function (rng) {\n      return normalize(dom, rng).fold(never, function (normalizedRng) {\n        rng.setStart(normalizedRng.startContainer, normalizedRng.startOffset);\n        rng.setEnd(normalizedRng.endContainer, normalizedRng.endOffset);\n        return true;\n      });\n    };\n\n    return {\n      walk: walk,\n      split: split,\n      normalize: normalize$1\n    };\n  };\n\n  RangeUtils.compareRanges = isEq$1;\n  RangeUtils.getCaretRangeFromPoint = fromPoint$1;\n  RangeUtils.getSelectedNode = getSelectedNode;\n  RangeUtils.getNode = getNode;\n\n  var Dimension = function (name, getOffset) {\n    var set = function (element, h) {\n      if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n        throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n      }\n\n      var dom = element.dom;\n\n      if (isSupported$1(dom)) {\n        dom.style[name] = h + 'px';\n      }\n    };\n\n    var get = function (element) {\n      var r = getOffset(element);\n\n      if (r <= 0 || r === null) {\n        var css = get$5(element, name);\n        return parseFloat(css) || 0;\n      }\n\n      return r;\n    };\n\n    var getOuter = get;\n\n    var aggregate = function (element, properties) {\n      return foldl(properties, function (acc, property) {\n        var val = get$5(element, property);\n        var value = val === undefined ? 0 : parseInt(val, 10);\n        return isNaN(value) ? acc : acc + value;\n      }, 0);\n    };\n\n    var max = function (element, value, properties) {\n      var cumulativeInclusions = aggregate(element, properties);\n      var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n      return absoluteMax;\n    };\n\n    return {\n      set: set,\n      get: get,\n      getOuter: getOuter,\n      aggregate: aggregate,\n      max: max\n    };\n  };\n\n  var api$1 = Dimension('height', function (element) {\n    var dom = element.dom;\n    return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n  });\n\n  var get$9 = function (element) {\n    return api$1.get(element);\n  };\n\n  var walkUp = function (navigation, doc) {\n    var frame = navigation.view(doc);\n    return frame.fold(constant([]), function (f) {\n      var parent = navigation.owner(f);\n      var rest = walkUp(navigation, parent);\n      return [f].concat(rest);\n    });\n  };\n\n  var pathTo = function (element, navigation) {\n    var d = navigation.owner(element);\n    return walkUp(navigation, d);\n  };\n\n  var view = function (doc) {\n    var _a;\n\n    var element = doc.dom === document ? Optional.none() : Optional.from((_a = doc.dom.defaultView) === null || _a === void 0 ? void 0 : _a.frameElement);\n    return element.map(SugarElement.fromDom);\n  };\n\n  var owner$1 = function (element) {\n    return documentOrOwner(element);\n  };\n\n  var Navigation = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    view: view,\n    owner: owner$1\n  });\n\n  var find$2 = function (element) {\n    var doc = SugarElement.fromDom(document);\n    var scroll = get$2(doc);\n    var frames = pathTo(element, Navigation);\n    var offset = viewport(element);\n    var r = foldr(frames, function (b, a) {\n      var loc = viewport(a);\n      return {\n        left: b.left + loc.left,\n        top: b.top + loc.top\n      };\n    }, {\n      left: 0,\n      top: 0\n    });\n    return SugarPosition(r.left + offset.left + scroll.left, r.top + offset.top + scroll.top);\n  };\n\n  var excludeFromDescend = function (element) {\n    return name(element) === 'textarea';\n  };\n\n  var fireScrollIntoViewEvent = function (editor, data) {\n    var scrollEvent = editor.fire('ScrollIntoView', data);\n    return scrollEvent.isDefaultPrevented();\n  };\n\n  var fireAfterScrollIntoViewEvent = function (editor, data) {\n    editor.fire('AfterScrollIntoView', data);\n  };\n\n  var descend = function (element, offset) {\n    var children$1 = children(element);\n\n    if (children$1.length === 0 || excludeFromDescend(element)) {\n      return {\n        element: element,\n        offset: offset\n      };\n    } else if (offset < children$1.length && !excludeFromDescend(children$1[offset])) {\n      return {\n        element: children$1[offset],\n        offset: 0\n      };\n    } else {\n      var last = children$1[children$1.length - 1];\n\n      if (excludeFromDescend(last)) {\n        return {\n          element: element,\n          offset: offset\n        };\n      } else {\n        if (name(last) === 'img') {\n          return {\n            element: last,\n            offset: 1\n          };\n        } else if (isText(last)) {\n          return {\n            element: last,\n            offset: get$8(last).length\n          };\n        } else {\n          return {\n            element: last,\n            offset: children(last).length\n          };\n        }\n      }\n    }\n  };\n\n  var markerInfo = function (element, cleanupFun) {\n    var pos = absolute(element);\n    var height = get$9(element);\n    return {\n      element: element,\n      bottom: pos.top + height,\n      height: height,\n      pos: pos,\n      cleanup: cleanupFun\n    };\n  };\n\n  var createMarker = function (element, offset) {\n    var startPoint = descend(element, offset);\n    var span = SugarElement.fromHtml('<span data-mce-bogus=\"all\">' + ZWSP + '</span>');\n    before(startPoint.element, span);\n    return markerInfo(span, function () {\n      return remove(span);\n    });\n  };\n\n  var elementMarker = function (element) {\n    return markerInfo(SugarElement.fromDom(element), noop);\n  };\n\n  var withMarker = function (editor, f, rng, alignToTop) {\n    preserveWith(editor, function (_s, _e) {\n      return applyWithMarker(editor, f, rng, alignToTop);\n    }, rng);\n  };\n\n  var withScrollEvents = function (editor, doc, f, marker, alignToTop) {\n    var data = {\n      elm: marker.element.dom,\n      alignToTop: alignToTop\n    };\n\n    if (fireScrollIntoViewEvent(editor, data)) {\n      return;\n    }\n\n    var scrollTop = get$2(doc).top;\n    f(doc, scrollTop, marker, alignToTop);\n    fireAfterScrollIntoViewEvent(editor, data);\n  };\n\n  var applyWithMarker = function (editor, f, rng, alignToTop) {\n    var body = SugarElement.fromDom(editor.getBody());\n    var doc = SugarElement.fromDom(editor.getDoc());\n    reflow(body);\n    var marker = createMarker(SugarElement.fromDom(rng.startContainer), rng.startOffset);\n    withScrollEvents(editor, doc, f, marker, alignToTop);\n    marker.cleanup();\n  };\n\n  var withElement = function (editor, element, f, alignToTop) {\n    var doc = SugarElement.fromDom(editor.getDoc());\n    withScrollEvents(editor, doc, f, elementMarker(element), alignToTop);\n  };\n\n  var preserveWith = function (editor, f, rng) {\n    var startElement = rng.startContainer;\n    var startOffset = rng.startOffset;\n    var endElement = rng.endContainer;\n    var endOffset = rng.endOffset;\n    f(SugarElement.fromDom(startElement), SugarElement.fromDom(endElement));\n    var newRng = editor.dom.createRng();\n    newRng.setStart(startElement, startOffset);\n    newRng.setEnd(endElement, endOffset);\n    editor.selection.setRng(rng);\n  };\n\n  var scrollToMarker = function (marker, viewHeight, alignToTop, doc) {\n    var pos = marker.pos;\n\n    if (alignToTop) {\n      to(pos.left, pos.top, doc);\n    } else {\n      var y = pos.top - viewHeight + marker.height;\n      to(pos.left, y, doc);\n    }\n  };\n\n  var intoWindowIfNeeded = function (doc, scrollTop, viewHeight, marker, alignToTop) {\n    var viewportBottom = viewHeight + scrollTop;\n    var markerTop = marker.pos.top;\n    var markerBottom = marker.bottom;\n    var largerThanViewport = markerBottom - markerTop >= viewHeight;\n\n    if (markerTop < scrollTop) {\n      scrollToMarker(marker, viewHeight, alignToTop !== false, doc);\n    } else if (markerTop > viewportBottom) {\n      var align = largerThanViewport ? alignToTop !== false : alignToTop === true;\n      scrollToMarker(marker, viewHeight, align, doc);\n    } else if (markerBottom > viewportBottom && !largerThanViewport) {\n      scrollToMarker(marker, viewHeight, alignToTop === true, doc);\n    }\n  };\n\n  var intoWindow = function (doc, scrollTop, marker, alignToTop) {\n    var viewHeight = doc.dom.defaultView.innerHeight;\n    intoWindowIfNeeded(doc, scrollTop, viewHeight, marker, alignToTop);\n  };\n\n  var intoFrame = function (doc, scrollTop, marker, alignToTop) {\n    var frameViewHeight = doc.dom.defaultView.innerHeight;\n    intoWindowIfNeeded(doc, scrollTop, frameViewHeight, marker, alignToTop);\n    var op = find$2(marker.element);\n    var viewportBounds = getBounds(window);\n\n    if (op.top < viewportBounds.y) {\n      intoView(marker.element, alignToTop !== false);\n    } else if (op.top > viewportBounds.bottom) {\n      intoView(marker.element, alignToTop === true);\n    }\n  };\n\n  var rangeIntoWindow = function (editor, rng, alignToTop) {\n    return withMarker(editor, intoWindow, rng, alignToTop);\n  };\n\n  var elementIntoWindow = function (editor, element, alignToTop) {\n    return withElement(editor, element, intoWindow, alignToTop);\n  };\n\n  var rangeIntoFrame = function (editor, rng, alignToTop) {\n    return withMarker(editor, intoFrame, rng, alignToTop);\n  };\n\n  var elementIntoFrame = function (editor, element, alignToTop) {\n    return withElement(editor, element, intoFrame, alignToTop);\n  };\n\n  var scrollElementIntoView = function (editor, element, alignToTop) {\n    var scroller = editor.inline ? elementIntoWindow : elementIntoFrame;\n    scroller(editor, element, alignToTop);\n  };\n\n  var scrollRangeIntoView = function (editor, rng, alignToTop) {\n    var scroller = editor.inline ? rangeIntoWindow : rangeIntoFrame;\n    scroller(editor, rng, alignToTop);\n  };\n\n  var getDocument = function () {\n    return SugarElement.fromDom(document);\n  };\n\n  var focus = function (element) {\n    return element.dom.focus();\n  };\n\n  var hasFocus = function (element) {\n    var root = getRootNode(element).dom;\n    return element.dom === root.activeElement;\n  };\n\n  var active = function (root) {\n    if (root === void 0) {\n      root = getDocument();\n    }\n\n    return Optional.from(root.dom.activeElement).map(SugarElement.fromDom);\n  };\n\n  var search = function (element) {\n    return active(getRootNode(element)).filter(function (e) {\n      return element.dom.contains(e.dom);\n    });\n  };\n\n  var create$4 = function (start, soffset, finish, foffset) {\n    return {\n      start: start,\n      soffset: soffset,\n      finish: finish,\n      foffset: foffset\n    };\n  };\n\n  var SimRange = {\n    create: create$4\n  };\n  var adt = Adt.generate([{\n    before: ['element']\n  }, {\n    on: ['element', 'offset']\n  }, {\n    after: ['element']\n  }]);\n\n  var cata = function (subject, onBefore, onOn, onAfter) {\n    return subject.fold(onBefore, onOn, onAfter);\n  };\n\n  var getStart = function (situ) {\n    return situ.fold(identity, identity, identity);\n  };\n\n  var before$3 = adt.before;\n  var on = adt.on;\n  var after$2 = adt.after;\n  var Situ = {\n    before: before$3,\n    on: on,\n    after: after$2,\n    cata: cata,\n    getStart: getStart\n  };\n  var adt$1 = Adt.generate([{\n    domRange: ['rng']\n  }, {\n    relative: ['startSitu', 'finishSitu']\n  }, {\n    exact: ['start', 'soffset', 'finish', 'foffset']\n  }]);\n\n  var exactFromRange = function (simRange) {\n    return adt$1.exact(simRange.start, simRange.soffset, simRange.finish, simRange.foffset);\n  };\n\n  var getStart$1 = function (selection) {\n    return selection.match({\n      domRange: function (rng) {\n        return SugarElement.fromDom(rng.startContainer);\n      },\n      relative: function (startSitu, _finishSitu) {\n        return Situ.getStart(startSitu);\n      },\n      exact: function (start, _soffset, _finish, _foffset) {\n        return start;\n      }\n    });\n  };\n\n  var domRange = adt$1.domRange;\n  var relative = adt$1.relative;\n  var exact = adt$1.exact;\n\n  var getWin = function (selection) {\n    var start = getStart$1(selection);\n    return defaultView(start);\n  };\n\n  var range = SimRange.create;\n  var SimSelection = {\n    domRange: domRange,\n    relative: relative,\n    exact: exact,\n    exactFromRange: exactFromRange,\n    getWin: getWin,\n    range: range\n  };\n  var browser$3 = detect$3().browser;\n\n  var clamp = function (offset, element) {\n    var max = isText(element) ? get$8(element).length : children(element).length + 1;\n\n    if (offset > max) {\n      return max;\n    } else if (offset < 0) {\n      return 0;\n    }\n\n    return offset;\n  };\n\n  var normalizeRng = function (rng) {\n    return SimSelection.range(rng.start, clamp(rng.soffset, rng.start), rng.finish, clamp(rng.foffset, rng.finish));\n  };\n\n  var isOrContains = function (root, elm) {\n    return !isRestrictedNode(elm.dom) && (contains$2(root, elm) || eq$2(root, elm));\n  };\n\n  var isRngInRoot = function (root) {\n    return function (rng) {\n      return isOrContains(root, rng.start) && isOrContains(root, rng.finish);\n    };\n  };\n\n  var shouldStore = function (editor) {\n    return editor.inline === true || browser$3.isIE();\n  };\n\n  var nativeRangeToSelectionRange = function (r) {\n    return SimSelection.range(SugarElement.fromDom(r.startContainer), r.startOffset, SugarElement.fromDom(r.endContainer), r.endOffset);\n  };\n\n  var readRange = function (win) {\n    var selection = win.getSelection();\n    var rng = !selection || selection.rangeCount === 0 ? Optional.none() : Optional.from(selection.getRangeAt(0));\n    return rng.map(nativeRangeToSelectionRange);\n  };\n\n  var getBookmark$2 = function (root) {\n    var win = defaultView(root);\n    return readRange(win.dom).filter(isRngInRoot(root));\n  };\n\n  var validate = function (root, bookmark) {\n    return Optional.from(bookmark).filter(isRngInRoot(root)).map(normalizeRng);\n  };\n\n  var bookmarkToNativeRng = function (bookmark) {\n    var rng = document.createRange();\n\n    try {\n      rng.setStart(bookmark.start.dom, bookmark.soffset);\n      rng.setEnd(bookmark.finish.dom, bookmark.foffset);\n      return Optional.some(rng);\n    } catch (_) {\n      return Optional.none();\n    }\n  };\n\n  var store = function (editor) {\n    var newBookmark = shouldStore(editor) ? getBookmark$2(SugarElement.fromDom(editor.getBody())) : Optional.none();\n    editor.bookmark = newBookmark.isSome() ? newBookmark : editor.bookmark;\n  };\n\n  var storeNative = function (editor, rng) {\n    var root = SugarElement.fromDom(editor.getBody());\n    var range = shouldStore(editor) ? Optional.from(rng) : Optional.none();\n    var newBookmark = range.map(nativeRangeToSelectionRange).filter(isRngInRoot(root));\n    editor.bookmark = newBookmark.isSome() ? newBookmark : editor.bookmark;\n  };\n\n  var getRng = function (editor) {\n    var bookmark = editor.bookmark ? editor.bookmark : Optional.none();\n    return bookmark.bind(function (x) {\n      return validate(SugarElement.fromDom(editor.getBody()), x);\n    }).bind(bookmarkToNativeRng);\n  };\n\n  var restore = function (editor) {\n    getRng(editor).each(function (rng) {\n      return editor.selection.setRng(rng);\n    });\n  };\n\n  var isEditorUIElement = function (elm) {\n    var className = elm.className.toString();\n    return className.indexOf('tox-') !== -1 || className.indexOf('mce-') !== -1;\n  };\n\n  var FocusManager = {\n    isEditorUIElement: isEditorUIElement\n  };\n\n  var isManualNodeChange = function (e) {\n    return e.type === 'nodechange' && e.selectionChange;\n  };\n\n  var registerPageMouseUp = function (editor, throttledStore) {\n    var mouseUpPage = function () {\n      throttledStore.throttle();\n    };\n\n    DOMUtils.DOM.bind(document, 'mouseup', mouseUpPage);\n    editor.on('remove', function () {\n      DOMUtils.DOM.unbind(document, 'mouseup', mouseUpPage);\n    });\n  };\n\n  var registerFocusOut = function (editor) {\n    editor.on('focusout', function () {\n      store(editor);\n    });\n  };\n\n  var registerMouseUp = function (editor, throttledStore) {\n    editor.on('mouseup touchend', function (_e) {\n      throttledStore.throttle();\n    });\n  };\n\n  var registerEditorEvents = function (editor, throttledStore) {\n    var browser = detect$3().browser;\n\n    if (browser.isIE()) {\n      registerFocusOut(editor);\n    } else {\n      registerMouseUp(editor, throttledStore);\n    }\n\n    editor.on('keyup NodeChange', function (e) {\n      if (!isManualNodeChange(e)) {\n        store(editor);\n      }\n    });\n  };\n\n  var register = function (editor) {\n    var throttledStore = first(function () {\n      store(editor);\n    }, 0);\n    editor.on('init', function () {\n      if (editor.inline) {\n        registerPageMouseUp(editor, throttledStore);\n      }\n\n      registerEditorEvents(editor, throttledStore);\n    });\n    editor.on('remove', function () {\n      throttledStore.cancel();\n    });\n  };\n\n  var documentFocusInHandler;\n  var DOM$2 = DOMUtils.DOM;\n\n  var isEditorUIElement$1 = function (elm) {\n    return FocusManager.isEditorUIElement(elm);\n  };\n\n  var isEditorContentAreaElement = function (elm) {\n    var classList = elm.classList;\n\n    if (classList !== undefined) {\n      return classList.contains('tox-edit-area') || classList.contains('tox-edit-area__iframe') || classList.contains('mce-content-body');\n    } else {\n      return false;\n    }\n  };\n\n  var isUIElement = function (editor, elm) {\n    var customSelector = getCustomUiSelector(editor);\n    var parent = DOM$2.getParent(elm, function (elm) {\n      return isEditorUIElement$1(elm) || (customSelector ? editor.dom.is(elm, customSelector) : false);\n    });\n    return parent !== null;\n  };\n\n  var getActiveElement = function (editor) {\n    try {\n      var root = getRootNode(SugarElement.fromDom(editor.getElement()));\n      return active(root).fold(function () {\n        return document.body;\n      }, function (x) {\n        return x.dom;\n      });\n    } catch (ex) {\n      return document.body;\n    }\n  };\n\n  var registerEvents = function (editorManager, e) {\n    var editor = e.editor;\n    register(editor);\n    editor.on('focusin', function () {\n      var focusedEditor = editorManager.focusedEditor;\n\n      if (focusedEditor !== editor) {\n        if (focusedEditor) {\n          focusedEditor.fire('blur', {\n            focusedEditor: editor\n          });\n        }\n\n        editorManager.setActive(editor);\n        editorManager.focusedEditor = editor;\n        editor.fire('focus', {\n          blurredEditor: focusedEditor\n        });\n        editor.focus(true);\n      }\n    });\n    editor.on('focusout', function () {\n      Delay.setEditorTimeout(editor, function () {\n        var focusedEditor = editorManager.focusedEditor;\n\n        if (!isUIElement(editor, getActiveElement(editor)) && focusedEditor === editor) {\n          editor.fire('blur', {\n            focusedEditor: null\n          });\n          editorManager.focusedEditor = null;\n        }\n      });\n    });\n\n    if (!documentFocusInHandler) {\n      documentFocusInHandler = function (e) {\n        var activeEditor = editorManager.activeEditor;\n\n        if (activeEditor) {\n          getOriginalEventTarget(e).each(function (target) {\n            if (target.ownerDocument === document) {\n              if (target !== document.body && !isUIElement(activeEditor, target) && editorManager.focusedEditor === activeEditor) {\n                activeEditor.fire('blur', {\n                  focusedEditor: null\n                });\n                editorManager.focusedEditor = null;\n              }\n            }\n          });\n        }\n      };\n\n      DOM$2.bind(document, 'focusin', documentFocusInHandler);\n    }\n  };\n\n  var unregisterDocumentEvents = function (editorManager, e) {\n    if (editorManager.focusedEditor === e.editor) {\n      editorManager.focusedEditor = null;\n    }\n\n    if (!editorManager.activeEditor) {\n      DOM$2.unbind(document, 'focusin', documentFocusInHandler);\n      documentFocusInHandler = null;\n    }\n  };\n\n  var setup$2 = function (editorManager) {\n    editorManager.on('AddEditor', curry(registerEvents, editorManager));\n    editorManager.on('RemoveEditor', curry(unregisterDocumentEvents, editorManager));\n  };\n\n  var getContentEditableHost = function (editor, node) {\n    return editor.dom.getParent(node, function (node) {\n      return editor.dom.getContentEditable(node) === 'true';\n    });\n  };\n\n  var getCollapsedNode = function (rng) {\n    return rng.collapsed ? Optional.from(getNode(rng.startContainer, rng.startOffset)).map(SugarElement.fromDom) : Optional.none();\n  };\n\n  var getFocusInElement = function (root, rng) {\n    return getCollapsedNode(rng).bind(function (node) {\n      if (isTableSection(node)) {\n        return Optional.some(node);\n      } else if (contains$2(root, node) === false) {\n        return Optional.some(root);\n      } else {\n        return Optional.none();\n      }\n    });\n  };\n\n  var normalizeSelection = function (editor, rng) {\n    getFocusInElement(SugarElement.fromDom(editor.getBody()), rng).bind(function (elm) {\n      return firstPositionIn(elm.dom);\n    }).fold(function () {\n      editor.selection.normalize();\n      return;\n    }, function (caretPos) {\n      return editor.selection.setRng(caretPos.toRange());\n    });\n  };\n\n  var focusBody = function (body) {\n    if (body.setActive) {\n      try {\n        body.setActive();\n      } catch (ex) {\n        body.focus();\n      }\n    } else {\n      body.focus();\n    }\n  };\n\n  var hasElementFocus = function (elm) {\n    return hasFocus(elm) || search(elm).isSome();\n  };\n\n  var hasIframeFocus = function (editor) {\n    return editor.iframeElement && hasFocus(SugarElement.fromDom(editor.iframeElement));\n  };\n\n  var hasInlineFocus = function (editor) {\n    var rawBody = editor.getBody();\n    return rawBody && hasElementFocus(SugarElement.fromDom(rawBody));\n  };\n\n  var hasUiFocus = function (editor) {\n    var dos = getRootNode(SugarElement.fromDom(editor.getElement()));\n    return active(dos).filter(function (elem) {\n      return !isEditorContentAreaElement(elem.dom) && isUIElement(editor, elem.dom);\n    }).isSome();\n  };\n\n  var hasFocus$1 = function (editor) {\n    return editor.inline ? hasInlineFocus(editor) : hasIframeFocus(editor);\n  };\n\n  var hasEditorOrUiFocus = function (editor) {\n    return hasFocus$1(editor) || hasUiFocus(editor);\n  };\n\n  var focusEditor = function (editor) {\n    var selection = editor.selection;\n    var body = editor.getBody();\n    var rng = selection.getRng();\n    editor.quirks.refreshContentEditable();\n\n    if (editor.bookmark !== undefined && hasFocus$1(editor) === false) {\n      getRng(editor).each(function (bookmarkRng) {\n        editor.selection.setRng(bookmarkRng);\n        rng = bookmarkRng;\n      });\n    }\n\n    var contentEditableHost = getContentEditableHost(editor, selection.getNode());\n\n    if (editor.$.contains(body, contentEditableHost)) {\n      focusBody(contentEditableHost);\n      normalizeSelection(editor, rng);\n      activateEditor(editor);\n      return;\n    }\n\n    if (!editor.inline) {\n      if (!Env.opera) {\n        focusBody(body);\n      }\n\n      editor.getWin().focus();\n    }\n\n    if (Env.gecko || editor.inline) {\n      focusBody(body);\n      normalizeSelection(editor, rng);\n    }\n\n    activateEditor(editor);\n  };\n\n  var activateEditor = function (editor) {\n    return editor.editorManager.setActive(editor);\n  };\n\n  var focus$1 = function (editor, skipFocus) {\n    if (editor.removed) {\n      return;\n    }\n\n    skipFocus ? activateEditor(editor) : focusEditor(editor);\n  };\n\n  var getEndpointElement = function (root, rng, start, real, resolve) {\n    var container = start ? rng.startContainer : rng.endContainer;\n    var offset = start ? rng.startOffset : rng.endOffset;\n    return Optional.from(container).map(SugarElement.fromDom).map(function (elm) {\n      return !real || !rng.collapsed ? child(elm, resolve(elm, offset)).getOr(elm) : elm;\n    }).bind(function (elm) {\n      return isElement(elm) ? Optional.some(elm) : parent(elm).filter(isElement);\n    }).map(function (elm) {\n      return elm.dom;\n    }).getOr(root);\n  };\n\n  var getStart$2 = function (root, rng, real) {\n    return getEndpointElement(root, rng, true, real, function (elm, offset) {\n      return Math.min(childNodesCount(elm), offset);\n    });\n  };\n\n  var getEnd = function (root, rng, real) {\n    return getEndpointElement(root, rng, false, real, function (elm, offset) {\n      return offset > 0 ? offset - 1 : offset;\n    });\n  };\n\n  var skipEmptyTextNodes = function (node, forwards) {\n    var orig = node;\n\n    while (node && isText$1(node) && node.length === 0) {\n      node = forwards ? node.nextSibling : node.previousSibling;\n    }\n\n    return node || orig;\n  };\n\n  var getNode$1 = function (root, rng) {\n    var elm, startContainer, endContainer;\n\n    if (!rng) {\n      return root;\n    }\n\n    startContainer = rng.startContainer;\n    endContainer = rng.endContainer;\n    var startOffset = rng.startOffset;\n    var endOffset = rng.endOffset;\n    elm = rng.commonAncestorContainer;\n\n    if (!rng.collapsed) {\n      if (startContainer === endContainer) {\n        if (endOffset - startOffset < 2) {\n          if (startContainer.hasChildNodes()) {\n            elm = startContainer.childNodes[startOffset];\n          }\n        }\n      }\n\n      if (startContainer.nodeType === 3 && endContainer.nodeType === 3) {\n        if (startContainer.length === startOffset) {\n          startContainer = skipEmptyTextNodes(startContainer.nextSibling, true);\n        } else {\n          startContainer = startContainer.parentNode;\n        }\n\n        if (endOffset === 0) {\n          endContainer = skipEmptyTextNodes(endContainer.previousSibling, false);\n        } else {\n          endContainer = endContainer.parentNode;\n        }\n\n        if (startContainer && startContainer === endContainer) {\n          return startContainer;\n        }\n      }\n    }\n\n    if (elm && elm.nodeType === 3) {\n      return elm.parentNode;\n    }\n\n    return elm;\n  };\n\n  var getSelectedBlocks = function (dom, rng, startElm, endElm) {\n    var node;\n    var selectedBlocks = [];\n    var root = dom.getRoot();\n    startElm = dom.getParent(startElm || getStart$2(root, rng, rng.collapsed), dom.isBlock);\n    endElm = dom.getParent(endElm || getEnd(root, rng, rng.collapsed), dom.isBlock);\n\n    if (startElm && startElm !== root) {\n      selectedBlocks.push(startElm);\n    }\n\n    if (startElm && endElm && startElm !== endElm) {\n      node = startElm;\n      var walker = new DomTreeWalker(startElm, root);\n\n      while ((node = walker.next()) && node !== endElm) {\n        if (dom.isBlock(node)) {\n          selectedBlocks.push(node);\n        }\n      }\n    }\n\n    if (endElm && startElm !== endElm && endElm !== root) {\n      selectedBlocks.push(endElm);\n    }\n\n    return selectedBlocks;\n  };\n\n  var select$1 = function (dom, node, content) {\n    return Optional.from(node).map(function (node) {\n      var idx = dom.nodeIndex(node);\n      var rng = dom.createRng();\n      rng.setStart(node.parentNode, idx);\n      rng.setEnd(node.parentNode, idx + 1);\n\n      if (content) {\n        moveEndPoint$1(dom, rng, node, true);\n        moveEndPoint$1(dom, rng, node, false);\n      }\n\n      return rng;\n    });\n  };\n\n  var processRanges = function (editor, ranges) {\n    return map(ranges, function (range) {\n      var evt = editor.fire('GetSelectionRange', {\n        range: range\n      });\n      return evt.range !== range ? evt.range : range;\n    });\n  };\n\n  var typeLookup = {\n    '#text': 3,\n    '#comment': 8,\n    '#cdata': 4,\n    '#pi': 7,\n    '#doctype': 10,\n    '#document-fragment': 11\n  };\n\n  var walk$2 = function (node, root, prev) {\n    var startName = prev ? 'lastChild' : 'firstChild';\n    var siblingName = prev ? 'prev' : 'next';\n\n    if (node[startName]) {\n      return node[startName];\n    }\n\n    if (node !== root) {\n      var sibling = node[siblingName];\n\n      if (sibling) {\n        return sibling;\n      }\n\n      for (var parent_1 = node.parent; parent_1 && parent_1 !== root; parent_1 = parent_1.parent) {\n        sibling = parent_1[siblingName];\n\n        if (sibling) {\n          return sibling;\n        }\n      }\n    }\n  };\n\n  var isEmptyTextNode$1 = function (node) {\n    if (!isWhitespaceText(node.value)) {\n      return false;\n    }\n\n    var parentNode = node.parent;\n\n    if (parentNode && (parentNode.name !== 'span' || parentNode.attr('style')) && /^[ ]+$/.test(node.value)) {\n      return false;\n    }\n\n    return true;\n  };\n\n  var isNonEmptyElement = function (node) {\n    var isNamedAnchor = node.name === 'a' && !node.attr('href') && node.attr('id');\n    return node.attr('name') || node.attr('id') && !node.firstChild || node.attr('data-mce-bookmark') || isNamedAnchor;\n  };\n\n  var AstNode = function () {\n    function AstNode(name, type) {\n      this.name = name;\n      this.type = type;\n\n      if (type === 1) {\n        this.attributes = [];\n        this.attributes.map = {};\n      }\n    }\n\n    AstNode.create = function (name, attrs) {\n      var node = new AstNode(name, typeLookup[name] || 1);\n\n      if (attrs) {\n        each$1(attrs, function (value, attrName) {\n          node.attr(attrName, value);\n        });\n      }\n\n      return node;\n    };\n\n    AstNode.prototype.replace = function (node) {\n      var self = this;\n\n      if (node.parent) {\n        node.remove();\n      }\n\n      self.insert(node, self);\n      self.remove();\n      return self;\n    };\n\n    AstNode.prototype.attr = function (name, value) {\n      var self = this;\n      var attrs;\n\n      if (typeof name !== 'string') {\n        if (name !== undefined && name !== null) {\n          each$1(name, function (value, key) {\n            self.attr(key, value);\n          });\n        }\n\n        return self;\n      }\n\n      if (attrs = self.attributes) {\n        if (value !== undefined) {\n          if (value === null) {\n            if (name in attrs.map) {\n              delete attrs.map[name];\n              var i = attrs.length;\n\n              while (i--) {\n                if (attrs[i].name === name) {\n                  attrs.splice(i, 1);\n                  return self;\n                }\n              }\n            }\n\n            return self;\n          }\n\n          if (name in attrs.map) {\n            var i = attrs.length;\n\n            while (i--) {\n              if (attrs[i].name === name) {\n                attrs[i].value = value;\n                break;\n              }\n            }\n          } else {\n            attrs.push({\n              name: name,\n              value: value\n            });\n          }\n\n          attrs.map[name] = value;\n          return self;\n        }\n\n        return attrs.map[name];\n      }\n    };\n\n    AstNode.prototype.clone = function () {\n      var self = this;\n      var clone = new AstNode(self.name, self.type);\n      var selfAttrs;\n\n      if (selfAttrs = self.attributes) {\n        var cloneAttrs = [];\n        cloneAttrs.map = {};\n\n        for (var i = 0, l = selfAttrs.length; i < l; i++) {\n          var selfAttr = selfAttrs[i];\n\n          if (selfAttr.name !== 'id') {\n            cloneAttrs[cloneAttrs.length] = {\n              name: selfAttr.name,\n              value: selfAttr.value\n            };\n            cloneAttrs.map[selfAttr.name] = selfAttr.value;\n          }\n        }\n\n        clone.attributes = cloneAttrs;\n      }\n\n      clone.value = self.value;\n      clone.shortEnded = self.shortEnded;\n      return clone;\n    };\n\n    AstNode.prototype.wrap = function (wrapper) {\n      var self = this;\n      self.parent.insert(wrapper, self);\n      wrapper.append(self);\n      return self;\n    };\n\n    AstNode.prototype.unwrap = function () {\n      var self = this;\n\n      for (var node = self.firstChild; node;) {\n        var next = node.next;\n        self.insert(node, self, true);\n        node = next;\n      }\n\n      self.remove();\n    };\n\n    AstNode.prototype.remove = function () {\n      var self = this,\n          parent = self.parent,\n          next = self.next,\n          prev = self.prev;\n\n      if (parent) {\n        if (parent.firstChild === self) {\n          parent.firstChild = next;\n\n          if (next) {\n            next.prev = null;\n          }\n        } else {\n          prev.next = next;\n        }\n\n        if (parent.lastChild === self) {\n          parent.lastChild = prev;\n\n          if (prev) {\n            prev.next = null;\n          }\n        } else {\n          next.prev = prev;\n        }\n\n        self.parent = self.next = self.prev = null;\n      }\n\n      return self;\n    };\n\n    AstNode.prototype.append = function (node) {\n      var self = this;\n\n      if (node.parent) {\n        node.remove();\n      }\n\n      var last = self.lastChild;\n\n      if (last) {\n        last.next = node;\n        node.prev = last;\n        self.lastChild = node;\n      } else {\n        self.lastChild = self.firstChild = node;\n      }\n\n      node.parent = self;\n      return node;\n    };\n\n    AstNode.prototype.insert = function (node, refNode, before) {\n      if (node.parent) {\n        node.remove();\n      }\n\n      var parent = refNode.parent || this;\n\n      if (before) {\n        if (refNode === parent.firstChild) {\n          parent.firstChild = node;\n        } else {\n          refNode.prev.next = node;\n        }\n\n        node.prev = refNode.prev;\n        node.next = refNode;\n        refNode.prev = node;\n      } else {\n        if (refNode === parent.lastChild) {\n          parent.lastChild = node;\n        } else {\n          refNode.next.prev = node;\n        }\n\n        node.next = refNode.next;\n        node.prev = refNode;\n        refNode.next = node;\n      }\n\n      node.parent = parent;\n      return node;\n    };\n\n    AstNode.prototype.getAll = function (name) {\n      var self = this;\n      var collection = [];\n\n      for (var node = self.firstChild; node; node = walk$2(node, self)) {\n        if (node.name === name) {\n          collection.push(node);\n        }\n      }\n\n      return collection;\n    };\n\n    AstNode.prototype.empty = function () {\n      var self = this;\n\n      if (self.firstChild) {\n        var nodes = [];\n\n        for (var node = self.firstChild; node; node = walk$2(node, self)) {\n          nodes.push(node);\n        }\n\n        var i = nodes.length;\n\n        while (i--) {\n          var node = nodes[i];\n          node.parent = node.firstChild = node.lastChild = node.next = node.prev = null;\n        }\n      }\n\n      self.firstChild = self.lastChild = null;\n      return self;\n    };\n\n    AstNode.prototype.isEmpty = function (elements, whitespace, predicate) {\n      if (whitespace === void 0) {\n        whitespace = {};\n      }\n\n      var self = this;\n      var node = self.firstChild;\n\n      if (isNonEmptyElement(self)) {\n        return false;\n      }\n\n      if (node) {\n        do {\n          if (node.type === 1) {\n            if (node.attr('data-mce-bogus')) {\n              continue;\n            }\n\n            if (elements[node.name]) {\n              return false;\n            }\n\n            if (isNonEmptyElement(node)) {\n              return false;\n            }\n          }\n\n          if (node.type === 8) {\n            return false;\n          }\n\n          if (node.type === 3 && !isEmptyTextNode$1(node)) {\n            return false;\n          }\n\n          if (node.type === 3 && node.parent && whitespace[node.parent.name] && isWhitespaceText(node.value)) {\n            return false;\n          }\n\n          if (predicate && predicate(node)) {\n            return false;\n          }\n        } while (node = walk$2(node, self));\n      }\n\n      return true;\n    };\n\n    AstNode.prototype.walk = function (prev) {\n      return walk$2(this, null, prev);\n    };\n\n    return AstNode;\n  }();\n\n  var extractBase64DataUris = function (html) {\n    var dataImageUri = /data:[^;]+;base64,([a-z0-9\\+\\/=]+)/gi;\n    var chunks = [];\n    var uris = {};\n    var prefix = generate$1('img');\n    var matches;\n    var index = 0;\n    var count = 0;\n\n    while (matches = dataImageUri.exec(html)) {\n      var uri = matches[0];\n      var imageId = prefix + '_' + count++;\n      uris[imageId] = uri;\n\n      if (index < matches.index) {\n        chunks.push(html.substr(index, matches.index - index));\n      }\n\n      chunks.push(imageId);\n      index = matches.index + uri.length;\n    }\n\n    var re = new RegExp(prefix + '_[0-9]+', 'g');\n\n    if (index === 0) {\n      return {\n        prefix: prefix,\n        uris: uris,\n        html: html,\n        re: re\n      };\n    } else {\n      if (index < html.length) {\n        chunks.push(html.substr(index));\n      }\n\n      return {\n        prefix: prefix,\n        uris: uris,\n        html: chunks.join(''),\n        re: re\n      };\n    }\n  };\n\n  var restoreDataUris = function (html, result) {\n    return html.replace(result.re, function (imageId) {\n      return get$1(result.uris, imageId).getOr(imageId);\n    });\n  };\n\n  var parseDataUri = function (uri) {\n    var matches = /data:([^;]+);base64,([a-z0-9\\+\\/=]+)/i.exec(uri);\n\n    if (matches) {\n      return Optional.some({\n        type: matches[1],\n        data: decodeURIComponent(matches[2])\n      });\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var safeSvgDataUrlElements = ['img', 'video'];\n\n  var isValidPrefixAttrName = function (name) {\n    return name.indexOf('data-') === 0 || name.indexOf('aria-') === 0;\n  };\n\n  var blockSvgDataUris = function (allowSvgDataUrls, tagName) {\n    var allowed = isNullable(allowSvgDataUrls) ? contains(safeSvgDataUrlElements, tagName) : allowSvgDataUrls;\n    return !allowed;\n  };\n\n  var isInvalidUri = function (settings, uri, tagName) {\n    if (settings.allow_html_data_urls) {\n      return false;\n    } else if (/^data:image\\//i.test(uri)) {\n      return blockSvgDataUris(settings.allow_svg_data_urls, tagName) && /^data:image\\/svg\\+xml/i.test(uri);\n    } else {\n      return /^data:/i.test(uri);\n    }\n  };\n\n  var findEndTagIndex = function (schema, html, startIndex) {\n    var count = 1,\n        index,\n        matches;\n    var shortEndedElements = schema.getShortEndedElements();\n    var tokenRegExp = /<([!?\\/])?([A-Za-z0-9\\-_:.]+)(\\s(?:[^'\">]+(?:\"[^\"]*\"|'[^']*'))*[^\"'>]*(?:\"[^\">]*|'[^'>]*)?|\\s*|\\/)>/g;\n    tokenRegExp.lastIndex = index = startIndex;\n\n    while (matches = tokenRegExp.exec(html)) {\n      index = tokenRegExp.lastIndex;\n\n      if (matches[1] === '/') {\n        count--;\n      } else if (!matches[1]) {\n        if (matches[2] in shortEndedElements) {\n          continue;\n        }\n\n        count++;\n      }\n\n      if (count === 0) {\n        break;\n      }\n    }\n\n    return index;\n  };\n\n  var isConditionalComment = function (html, startIndex) {\n    return /^\\s*\\[if [\\w\\W]+\\]>.*<!\\[endif\\](--!?)?>/.test(html.substr(startIndex));\n  };\n\n  var findCommentEndIndex = function (html, isBogus, startIndex) {\n    if (startIndex === void 0) {\n      startIndex = 0;\n    }\n\n    var lcHtml = html.toLowerCase();\n\n    if (lcHtml.indexOf('[if ', startIndex) !== -1 && isConditionalComment(lcHtml, startIndex)) {\n      var endIfIndex = lcHtml.indexOf('[endif]', startIndex);\n      return lcHtml.indexOf('>', endIfIndex);\n    } else {\n      if (isBogus) {\n        var endIndex = lcHtml.indexOf('>', startIndex);\n        return endIndex !== -1 ? endIndex : lcHtml.length;\n      } else {\n        var endCommentRegexp = /--!?>/g;\n        endCommentRegexp.lastIndex = startIndex;\n        var match = endCommentRegexp.exec(html);\n        return match ? match.index + match[0].length : lcHtml.length;\n      }\n    }\n  };\n\n  var checkBogusAttribute = function (regExp, attrString) {\n    var matches = regExp.exec(attrString);\n\n    if (matches) {\n      var name_1 = matches[1];\n      var value = matches[2];\n      return typeof name_1 === 'string' && name_1.toLowerCase() === 'data-mce-bogus' ? value : null;\n    } else {\n      return null;\n    }\n  };\n\n  var SaxParser = function (settings, schema) {\n    if (schema === void 0) {\n      schema = Schema();\n    }\n\n    settings = settings || {};\n\n    if (settings.fix_self_closing !== false) {\n      settings.fix_self_closing = true;\n    }\n\n    var comment = settings.comment ? settings.comment : noop;\n    var cdata = settings.cdata ? settings.cdata : noop;\n    var text = settings.text ? settings.text : noop;\n    var start = settings.start ? settings.start : noop;\n    var end = settings.end ? settings.end : noop;\n    var pi = settings.pi ? settings.pi : noop;\n    var doctype = settings.doctype ? settings.doctype : noop;\n\n    var parseInternal = function (base64Extract, format) {\n      if (format === void 0) {\n        format = 'html';\n      }\n\n      var html = base64Extract.html;\n      var matches,\n          index = 0,\n          value,\n          endRegExp;\n      var stack = [];\n      var attrList, i, textData, name;\n      var isInternalElement, isShortEnded;\n      var elementRule, isValidElement, attr, attribsValue, validAttributesMap, validAttributePatterns;\n      var attributesRequired, attributesDefault, attributesForced;\n      var anyAttributesRequired,\n          attrValue,\n          idCount = 0;\n      var decode = Entities.decode;\n      var filteredUrlAttrs = Tools.makeMap('src,href,data,background,action,formaction,poster,xlink:href');\n      var scriptUriRegExp = /((java|vb)script|mhtml):/i;\n      var parsingMode = format === 'html' ? 0 : 1;\n\n      var processEndTag = function (name) {\n        var pos, i;\n        pos = stack.length;\n\n        while (pos--) {\n          if (stack[pos].name === name) {\n            break;\n          }\n        }\n\n        if (pos >= 0) {\n          for (i = stack.length - 1; i >= pos; i--) {\n            name = stack[i];\n\n            if (name.valid) {\n              end(name.name);\n            }\n          }\n\n          stack.length = pos;\n        }\n      };\n\n      var processText = function (value, raw) {\n        return text(restoreDataUris(value, base64Extract), raw);\n      };\n\n      var processComment = function (value) {\n        if (value === '') {\n          return;\n        }\n\n        if (value.charAt(0) === '>') {\n          value = ' ' + value;\n        }\n\n        if (!settings.allow_conditional_comments && value.substr(0, 3).toLowerCase() === '[if') {\n          value = ' ' + value;\n        }\n\n        comment(restoreDataUris(value, base64Extract));\n      };\n\n      var processAttr = function (value) {\n        return restoreDataUris(value, base64Extract);\n      };\n\n      var processMalformedComment = function (value, startIndex) {\n        var startTag = value || '';\n        var isBogus = !startsWith(startTag, '--');\n        var endIndex = findCommentEndIndex(html, isBogus, startIndex);\n        value = html.substr(startIndex, endIndex - startIndex);\n        processComment(isBogus ? startTag + value : value);\n        return endIndex + 1;\n      };\n\n      var parseAttribute = function (tagName, name, value, val2, val3) {\n        var attrRule, i;\n        var trimRegExp = /[\\s\\u0000-\\u001F]+/g;\n        name = name.toLowerCase();\n        value = processAttr(name in fillAttrsMap ? name : decode(value || val2 || val3 || ''));\n\n        if (validate && !isInternalElement && isValidPrefixAttrName(name) === false) {\n          attrRule = validAttributesMap[name];\n\n          if (!attrRule && validAttributePatterns) {\n            i = validAttributePatterns.length;\n\n            while (i--) {\n              attrRule = validAttributePatterns[i];\n\n              if (attrRule.pattern.test(name)) {\n                break;\n              }\n            }\n\n            if (i === -1) {\n              attrRule = null;\n            }\n          }\n\n          if (!attrRule) {\n            return;\n          }\n\n          if (attrRule.validValues && !(value in attrRule.validValues)) {\n            return;\n          }\n        }\n\n        if (filteredUrlAttrs[name] && !settings.allow_script_urls) {\n          var uri = value.replace(trimRegExp, '');\n\n          try {\n            uri = decodeURIComponent(uri);\n          } catch (ex) {\n            uri = unescape(uri);\n          }\n\n          if (scriptUriRegExp.test(uri)) {\n            return;\n          }\n\n          if (isInvalidUri(settings, uri, tagName)) {\n            return;\n          }\n        }\n\n        if (isInternalElement && (name in filteredUrlAttrs || name.indexOf('on') === 0)) {\n          return;\n        }\n\n        attrList.map[name] = value;\n        attrList.push({\n          name: name,\n          value: value\n        });\n      };\n\n      var tokenRegExp = new RegExp('<(?:' + '(?:!--([\\\\w\\\\W]*?)--!?>)|' + '(?:!\\\\[CDATA\\\\[([\\\\w\\\\W]*?)\\\\]\\\\]>)|' + '(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\\\w\\\\W]*?)>)|' + '(?:!(--)?)|' + '(?:\\\\?([^\\\\s\\\\/<>]+) ?([\\\\w\\\\W]*?)[?/]>)|' + '(?:\\\\/([A-Za-z][A-Za-z0-9\\\\-_\\\\:\\\\.]*)>)|' + '(?:([A-Za-z][A-Za-z0-9\\\\-_:.]*)(\\\\s(?:[^\\'\">]+(?:\"[^\"]*\"|\\'[^\\']*\\'))*[^\"\\'>]*(?:\"[^\">]*|\\'[^\\'>]*)?|\\\\s*|\\\\/)>)' + ')', 'g');\n      var attrRegExp = /([\\w:\\-]+)(?:\\s*=\\s*(?:(?:\\\"((?:[^\\\"])*)\\\")|(?:\\'((?:[^\\'])*)\\')|([^>\\s]+)))?/g;\n      var shortEndedElements = schema.getShortEndedElements();\n      var selfClosing = settings.self_closing_elements || schema.getSelfClosingElements();\n      var fillAttrsMap = schema.getBoolAttrs();\n      var validate = settings.validate;\n      var removeInternalElements = settings.remove_internals;\n      var fixSelfClosing = settings.fix_self_closing;\n      var specialElements = schema.getSpecialElements();\n      var processHtml = html + '>';\n\n      while (matches = tokenRegExp.exec(processHtml)) {\n        var matchText = matches[0];\n\n        if (index < matches.index) {\n          processText(decode(html.substr(index, matches.index - index)));\n        }\n\n        if (value = matches[7]) {\n          value = value.toLowerCase();\n\n          if (value.charAt(0) === ':') {\n            value = value.substr(1);\n          }\n\n          processEndTag(value);\n        } else if (value = matches[8]) {\n          if (matches.index + matchText.length > html.length) {\n            processText(decode(html.substr(matches.index)));\n            index = matches.index + matchText.length;\n            continue;\n          }\n\n          value = value.toLowerCase();\n\n          if (value.charAt(0) === ':') {\n            value = value.substr(1);\n          }\n\n          isShortEnded = value in shortEndedElements;\n\n          if (fixSelfClosing && selfClosing[value] && stack.length > 0 && stack[stack.length - 1].name === value) {\n            processEndTag(value);\n          }\n\n          var bogusValue = checkBogusAttribute(attrRegExp, matches[9]);\n\n          if (bogusValue !== null) {\n            if (bogusValue === 'all') {\n              index = findEndTagIndex(schema, html, tokenRegExp.lastIndex);\n              tokenRegExp.lastIndex = index;\n              continue;\n            }\n\n            isValidElement = false;\n          }\n\n          if (!validate || (elementRule = schema.getElementRule(value))) {\n            isValidElement = true;\n\n            if (validate) {\n              validAttributesMap = elementRule.attributes;\n              validAttributePatterns = elementRule.attributePatterns;\n            }\n\n            if (attribsValue = matches[9]) {\n              isInternalElement = attribsValue.indexOf('data-mce-type') !== -1;\n\n              if (isInternalElement && removeInternalElements) {\n                isValidElement = false;\n              }\n\n              attrList = [];\n              attrList.map = {};\n              attribsValue.replace(attrRegExp, function (match, name, val, val2, val3) {\n                parseAttribute(value, name, val, val2, val3);\n                return '';\n              });\n            } else {\n              attrList = [];\n              attrList.map = {};\n            }\n\n            if (validate && !isInternalElement) {\n              attributesRequired = elementRule.attributesRequired;\n              attributesDefault = elementRule.attributesDefault;\n              attributesForced = elementRule.attributesForced;\n              anyAttributesRequired = elementRule.removeEmptyAttrs;\n\n              if (anyAttributesRequired && !attrList.length) {\n                isValidElement = false;\n              }\n\n              if (attributesForced) {\n                i = attributesForced.length;\n\n                while (i--) {\n                  attr = attributesForced[i];\n                  name = attr.name;\n                  attrValue = attr.value;\n\n                  if (attrValue === '{$uid}') {\n                    attrValue = 'mce_' + idCount++;\n                  }\n\n                  attrList.map[name] = attrValue;\n                  attrList.push({\n                    name: name,\n                    value: attrValue\n                  });\n                }\n              }\n\n              if (attributesDefault) {\n                i = attributesDefault.length;\n\n                while (i--) {\n                  attr = attributesDefault[i];\n                  name = attr.name;\n\n                  if (!(name in attrList.map)) {\n                    attrValue = attr.value;\n\n                    if (attrValue === '{$uid}') {\n                      attrValue = 'mce_' + idCount++;\n                    }\n\n                    attrList.map[name] = attrValue;\n                    attrList.push({\n                      name: name,\n                      value: attrValue\n                    });\n                  }\n                }\n              }\n\n              if (attributesRequired) {\n                i = attributesRequired.length;\n\n                while (i--) {\n                  if (attributesRequired[i] in attrList.map) {\n                    break;\n                  }\n                }\n\n                if (i === -1) {\n                  isValidElement = false;\n                }\n              }\n\n              if (attr = attrList.map['data-mce-bogus']) {\n                if (attr === 'all') {\n                  index = findEndTagIndex(schema, html, tokenRegExp.lastIndex);\n                  tokenRegExp.lastIndex = index;\n                  continue;\n                }\n\n                isValidElement = false;\n              }\n            }\n\n            if (isValidElement) {\n              start(value, attrList, isShortEnded);\n            }\n          } else {\n            isValidElement = false;\n          }\n\n          if (endRegExp = specialElements[value]) {\n            endRegExp.lastIndex = index = matches.index + matchText.length;\n\n            if (matches = endRegExp.exec(html)) {\n              if (isValidElement) {\n                textData = html.substr(index, matches.index - index);\n              }\n\n              index = matches.index + matches[0].length;\n            } else {\n              textData = html.substr(index);\n              index = html.length;\n            }\n\n            if (isValidElement) {\n              if (textData.length > 0) {\n                processText(textData, true);\n              }\n\n              end(value);\n            }\n\n            tokenRegExp.lastIndex = index;\n            continue;\n          }\n\n          if (!isShortEnded) {\n            if (!attribsValue || attribsValue.indexOf('/') !== attribsValue.length - 1) {\n              stack.push({\n                name: value,\n                valid: isValidElement\n              });\n            } else if (isValidElement) {\n              end(value);\n            }\n          }\n        } else if (value = matches[1]) {\n          processComment(value);\n        } else if (value = matches[2]) {\n          var isValidCdataSection = parsingMode === 1 || settings.preserve_cdata || stack.length > 0 && schema.isValidChild(stack[stack.length - 1].name, '#cdata');\n\n          if (isValidCdataSection) {\n            cdata(value);\n          } else {\n            index = processMalformedComment('', matches.index + 2);\n            tokenRegExp.lastIndex = index;\n            continue;\n          }\n        } else if (value = matches[3]) {\n          doctype(value);\n        } else if ((value = matches[4]) || matchText === '<!') {\n          index = processMalformedComment(value, matches.index + matchText.length);\n          tokenRegExp.lastIndex = index;\n          continue;\n        } else if (value = matches[5]) {\n          if (parsingMode === 1) {\n            pi(value, matches[6]);\n          } else {\n            index = processMalformedComment('?', matches.index + 2);\n            tokenRegExp.lastIndex = index;\n            continue;\n          }\n        }\n\n        index = matches.index + matchText.length;\n      }\n\n      if (index < html.length) {\n        processText(decode(html.substr(index)));\n      }\n\n      for (i = stack.length - 1; i >= 0; i--) {\n        value = stack[i];\n\n        if (value.valid) {\n          end(value.name);\n        }\n      }\n    };\n\n    var parse = function (html, format) {\n      if (format === void 0) {\n        format = 'html';\n      }\n\n      parseInternal(extractBase64DataUris(html), format);\n    };\n\n    return {\n      parse: parse\n    };\n  };\n\n  SaxParser.findEndTag = findEndTagIndex;\n\n  var trimHtml = function (tempAttrs, html) {\n    var trimContentRegExp = new RegExp(['\\\\s?(' + tempAttrs.join('|') + ')=\"[^\"]+\"'].join('|'), 'gi');\n    return html.replace(trimContentRegExp, '');\n  };\n\n  var trimInternal = function (serializer, html) {\n    var content = html;\n    var bogusAllRegExp = /<(\\w+) [^>]*data-mce-bogus=\"all\"[^>]*>/g;\n    var endTagIndex, index, matchLength, matches;\n    var schema = serializer.schema;\n    content = trimHtml(serializer.getTempAttrs(), content);\n    var shortEndedElements = schema.getShortEndedElements();\n\n    while (matches = bogusAllRegExp.exec(content)) {\n      index = bogusAllRegExp.lastIndex;\n      matchLength = matches[0].length;\n\n      if (shortEndedElements[matches[1]]) {\n        endTagIndex = index;\n      } else {\n        endTagIndex = SaxParser.findEndTag(schema, content, index);\n      }\n\n      content = content.substring(0, index - matchLength) + content.substring(endTagIndex);\n      bogusAllRegExp.lastIndex = index - matchLength;\n    }\n\n    return trim$2(content);\n  };\n\n  var trimExternal = trimInternal;\n\n  var trimEmptyContents = function (editor, html) {\n    var blockName = getForcedRootBlock(editor);\n    var emptyRegExp = new RegExp('^(<' + blockName + '[^>]*>(&nbsp;|&#160;|\\\\s|\\xA0|<br \\\\/>|)<\\\\/' + blockName + '>[\\r\\n]*|<br \\\\/>[\\r\\n]*)$');\n    return html.replace(emptyRegExp, '');\n  };\n\n  var getContentFromBody = function (editor, args, format, body) {\n    var content;\n    args.format = format;\n    args.get = true;\n    args.getInner = true;\n\n    if (!args.no_events) {\n      editor.fire('BeforeGetContent', args);\n    }\n\n    if (args.format === 'raw') {\n      content = Tools.trim(trimExternal(editor.serializer, body.innerHTML));\n    } else if (args.format === 'text') {\n      content = editor.dom.isEmpty(body) ? '' : trim$2(body.innerText || body.textContent);\n    } else if (args.format === 'tree') {\n      content = editor.serializer.serialize(body, args);\n    } else {\n      content = trimEmptyContents(editor, editor.serializer.serialize(body, args));\n    }\n\n    if (!contains(['text', 'tree'], args.format) && !isWsPreserveElement(SugarElement.fromDom(body))) {\n      args.content = Tools.trim(content);\n    } else {\n      args.content = content;\n    }\n\n    if (!args.no_events) {\n      editor.fire('GetContent', args);\n    }\n\n    return args.content;\n  };\n\n  var getContentInternal = function (editor, args, format) {\n    return Optional.from(editor.getBody()).fold(constant(args.format === 'tree' ? new AstNode('body', 11) : ''), function (body) {\n      return getContentFromBody(editor, args, format, body);\n    });\n  };\n\n  var each$7 = Tools.each;\n\n  var ElementUtils = function (dom) {\n    var compare = function (node1, node2) {\n      if (node1.nodeName !== node2.nodeName) {\n        return false;\n      }\n\n      var getAttribs = function (node) {\n        var attribs = {};\n        each$7(dom.getAttribs(node), function (attr) {\n          var name = attr.nodeName.toLowerCase();\n\n          if (name.indexOf('_') !== 0 && name !== 'style' && name.indexOf('data-') !== 0) {\n            attribs[name] = dom.getAttrib(node, name);\n          }\n        });\n        return attribs;\n      };\n\n      var compareObjects = function (obj1, obj2) {\n        var value, name;\n\n        for (name in obj1) {\n          if (obj1.hasOwnProperty(name)) {\n            value = obj2[name];\n\n            if (typeof value === 'undefined') {\n              return false;\n            }\n\n            if (obj1[name] !== value) {\n              return false;\n            }\n\n            delete obj2[name];\n          }\n        }\n\n        for (name in obj2) {\n          if (obj2.hasOwnProperty(name)) {\n            return false;\n          }\n        }\n\n        return true;\n      };\n\n      if (!compareObjects(getAttribs(node1), getAttribs(node2))) {\n        return false;\n      }\n\n      if (!compareObjects(dom.parseStyle(dom.getAttrib(node1, 'style')), dom.parseStyle(dom.getAttrib(node2, 'style')))) {\n        return false;\n      }\n\n      return !isBookmarkNode$1(node1) && !isBookmarkNode$1(node2);\n    };\n\n    return {\n      compare: compare\n    };\n  };\n\n  var makeMap$3 = Tools.makeMap;\n\n  var Writer = function (settings) {\n    var html = [];\n    settings = settings || {};\n    var indent = settings.indent;\n    var indentBefore = makeMap$3(settings.indent_before || '');\n    var indentAfter = makeMap$3(settings.indent_after || '');\n    var encode = Entities.getEncodeFunc(settings.entity_encoding || 'raw', settings.entities);\n    var htmlOutput = settings.element_format === 'html';\n    return {\n      start: function (name, attrs, empty) {\n        var i, l, attr, value;\n\n        if (indent && indentBefore[name] && html.length > 0) {\n          value = html[html.length - 1];\n\n          if (value.length > 0 && value !== '\\n') {\n            html.push('\\n');\n          }\n        }\n\n        html.push('<', name);\n\n        if (attrs) {\n          for (i = 0, l = attrs.length; i < l; i++) {\n            attr = attrs[i];\n            html.push(' ', attr.name, '=\"', encode(attr.value, true), '\"');\n          }\n        }\n\n        if (!empty || htmlOutput) {\n          html[html.length] = '>';\n        } else {\n          html[html.length] = ' />';\n        }\n\n        if (empty && indent && indentAfter[name] && html.length > 0) {\n          value = html[html.length - 1];\n\n          if (value.length > 0 && value !== '\\n') {\n            html.push('\\n');\n          }\n        }\n      },\n      end: function (name) {\n        var value;\n        html.push('</', name, '>');\n\n        if (indent && indentAfter[name] && html.length > 0) {\n          value = html[html.length - 1];\n\n          if (value.length > 0 && value !== '\\n') {\n            html.push('\\n');\n          }\n        }\n      },\n      text: function (text, raw) {\n        if (text.length > 0) {\n          html[html.length] = raw ? text : encode(text);\n        }\n      },\n      cdata: function (text) {\n        html.push('<![CDATA[', text, ']]>');\n      },\n      comment: function (text) {\n        html.push('<!--', text, '-->');\n      },\n      pi: function (name, text) {\n        if (text) {\n          html.push('<?', name, ' ', encode(text), '?>');\n        } else {\n          html.push('<?', name, '?>');\n        }\n\n        if (indent) {\n          html.push('\\n');\n        }\n      },\n      doctype: function (text) {\n        html.push('<!DOCTYPE', text, '>', indent ? '\\n' : '');\n      },\n      reset: function () {\n        html.length = 0;\n      },\n      getContent: function () {\n        return html.join('').replace(/\\n$/, '');\n      }\n    };\n  };\n\n  var HtmlSerializer = function (settings, schema) {\n    if (schema === void 0) {\n      schema = Schema();\n    }\n\n    var writer = Writer(settings);\n    settings = settings || {};\n    settings.validate = 'validate' in settings ? settings.validate : true;\n\n    var serialize = function (node) {\n      var validate = settings.validate;\n      var handlers = {\n        3: function (node) {\n          writer.text(node.value, node.raw);\n        },\n        8: function (node) {\n          writer.comment(node.value);\n        },\n        7: function (node) {\n          writer.pi(node.name, node.value);\n        },\n        10: function (node) {\n          writer.doctype(node.value);\n        },\n        4: function (node) {\n          writer.cdata(node.value);\n        },\n        11: function (node) {\n          if (node = node.firstChild) {\n            do {\n              walk(node);\n            } while (node = node.next);\n          }\n        }\n      };\n      writer.reset();\n\n      var walk = function (node) {\n        var handler = handlers[node.type];\n        var name, isEmpty, attrs, attrName, attrValue, sortedAttrs, i, l, elementRule;\n\n        if (!handler) {\n          name = node.name;\n          isEmpty = node.shortEnded;\n          attrs = node.attributes;\n\n          if (validate && attrs && attrs.length > 1) {\n            sortedAttrs = [];\n            sortedAttrs.map = {};\n            elementRule = schema.getElementRule(node.name);\n\n            if (elementRule) {\n              for (i = 0, l = elementRule.attributesOrder.length; i < l; i++) {\n                attrName = elementRule.attributesOrder[i];\n\n                if (attrName in attrs.map) {\n                  attrValue = attrs.map[attrName];\n                  sortedAttrs.map[attrName] = attrValue;\n                  sortedAttrs.push({\n                    name: attrName,\n                    value: attrValue\n                  });\n                }\n              }\n\n              for (i = 0, l = attrs.length; i < l; i++) {\n                attrName = attrs[i].name;\n\n                if (!(attrName in sortedAttrs.map)) {\n                  attrValue = attrs.map[attrName];\n                  sortedAttrs.map[attrName] = attrValue;\n                  sortedAttrs.push({\n                    name: attrName,\n                    value: attrValue\n                  });\n                }\n              }\n\n              attrs = sortedAttrs;\n            }\n          }\n\n          writer.start(node.name, attrs, isEmpty);\n\n          if (!isEmpty) {\n            if (node = node.firstChild) {\n              do {\n                walk(node);\n              } while (node = node.next);\n            }\n\n            writer.end(name);\n          }\n        } else {\n          handler(node);\n        }\n      };\n\n      if (node.type === 1 && !settings.inner) {\n        walk(node);\n      } else {\n        handlers[11](node);\n      }\n\n      return writer.getContent();\n    };\n\n    return {\n      serialize: serialize\n    };\n  };\n\n  var nonInheritableStyles = new Set();\n\n  (function () {\n    var nonInheritableStylesArr = ['margin', 'margin-left', 'margin-right', 'margin-top', 'margin-bottom', 'padding', 'padding-left', 'padding-right', 'padding-top', 'padding-bottom', 'border', 'border-width', 'border-style', 'border-color', 'background', 'background-attachment', 'background-clip', 'background-color', 'background-image', 'background-origin', 'background-position', 'background-repeat', 'background-size', 'float', 'position', 'left', 'right', 'top', 'bottom', 'z-index', 'display', 'transform', 'width', 'max-width', 'min-width', 'height', 'max-height', 'min-height', 'overflow', 'overflow-x', 'overflow-y', 'text-overflow', 'vertical-align', 'transition', 'transition-delay', 'transition-duration', 'transition-property', 'transition-timing-function'];\n    each(nonInheritableStylesArr, function (style) {\n      nonInheritableStyles.add(style);\n    });\n  })();\n\n  var shorthandStyleProps = ['font', 'text-decoration', 'text-emphasis'];\n\n  var getStyleProps = function (dom, node) {\n    return keys(dom.parseStyle(dom.getAttrib(node, 'style')));\n  };\n\n  var isNonInheritableStyle = function (style) {\n    return nonInheritableStyles.has(style);\n  };\n\n  var hasInheritableStyles = function (dom, node) {\n    return forall(getStyleProps(dom, node), function (style) {\n      return !isNonInheritableStyle(style);\n    });\n  };\n\n  var getLonghandStyleProps = function (styles) {\n    return filter(styles, function (style) {\n      return exists(shorthandStyleProps, function (prop) {\n        return startsWith(style, prop);\n      });\n    });\n  };\n\n  var hasStyleConflict = function (dom, node, parentNode) {\n    var nodeStyleProps = getStyleProps(dom, node);\n    var parentNodeStyleProps = getStyleProps(dom, parentNode);\n\n    var valueMismatch = function (prop) {\n      var nodeValue = dom.getStyle(node, prop);\n      var parentValue = dom.getStyle(parentNode, prop);\n      return isNotEmpty(nodeValue) && isNotEmpty(parentValue) && nodeValue !== parentValue;\n    };\n\n    return exists(nodeStyleProps, function (nodeStyleProp) {\n      var propExists = function (props) {\n        return exists(props, function (prop) {\n          return prop === nodeStyleProp;\n        });\n      };\n\n      if (!propExists(parentNodeStyleProps) && propExists(shorthandStyleProps)) {\n        var longhandProps = getLonghandStyleProps(parentNodeStyleProps);\n        return exists(longhandProps, valueMismatch);\n      } else {\n        return valueMismatch(nodeStyleProp);\n      }\n    });\n  };\n\n  var isChar = function (forward, predicate, pos) {\n    return Optional.from(pos.container()).filter(isText$1).exists(function (text) {\n      var delta = forward ? 0 : -1;\n      return predicate(text.data.charAt(pos.offset() + delta));\n    });\n  };\n\n  var isBeforeSpace = curry(isChar, true, isWhiteSpace$1);\n  var isAfterSpace = curry(isChar, false, isWhiteSpace$1);\n\n  var isEmptyText = function (pos) {\n    var container = pos.container();\n    return isText$1(container) && (container.data.length === 0 || isZwsp$1(container.data) && BookmarkManager.isBookmarkNode(container.parentNode));\n  };\n\n  var matchesElementPosition = function (before, predicate) {\n    return function (pos) {\n      return Optional.from(getChildNodeAtRelativeOffset(before ? 0 : -1, pos)).filter(predicate).isSome();\n    };\n  };\n\n  var isImageBlock = function (node) {\n    return isImg(node) && get$5(SugarElement.fromDom(node), 'display') === 'block';\n  };\n\n  var isCefNode = function (node) {\n    return isContentEditableFalse(node) && !isBogusAll(node);\n  };\n\n  var isBeforeImageBlock = matchesElementPosition(true, isImageBlock);\n  var isAfterImageBlock = matchesElementPosition(false, isImageBlock);\n  var isBeforeMedia = matchesElementPosition(true, isMedia);\n  var isAfterMedia = matchesElementPosition(false, isMedia);\n  var isBeforeTable = matchesElementPosition(true, isTable);\n  var isAfterTable = matchesElementPosition(false, isTable);\n  var isBeforeContentEditableFalse = matchesElementPosition(true, isCefNode);\n  var isAfterContentEditableFalse = matchesElementPosition(false, isCefNode);\n\n  var getLastChildren$1 = function (elm) {\n    var children = [];\n    var rawNode = elm.dom;\n\n    while (rawNode) {\n      children.push(SugarElement.fromDom(rawNode));\n      rawNode = rawNode.lastChild;\n    }\n\n    return children;\n  };\n\n  var removeTrailingBr = function (elm) {\n    var allBrs = descendants$1(elm, 'br');\n    var brs = filter(getLastChildren$1(elm).slice(-1), isBr$1);\n\n    if (allBrs.length === brs.length) {\n      each(brs, remove);\n    }\n  };\n\n  var fillWithPaddingBr = function (elm) {\n    empty(elm);\n    append(elm, SugarElement.fromHtml('<br data-mce-bogus=\"1\">'));\n  };\n\n  var trimBlockTrailingBr = function (elm) {\n    lastChild(elm).each(function (lastChild) {\n      prevSibling(lastChild).each(function (lastChildPrevSibling) {\n        if (isBlock(elm) && isBr$1(lastChild) && isBlock(lastChildPrevSibling)) {\n          remove(lastChild);\n        }\n      });\n    });\n  };\n\n  var dropLast = function (xs) {\n    return xs.slice(0, -1);\n  };\n\n  var parentsUntil$1 = function (start, root, predicate) {\n    if (contains$2(root, start)) {\n      return dropLast(parents(start, function (elm) {\n        return predicate(elm) || eq$2(elm, root);\n      }));\n    } else {\n      return [];\n    }\n  };\n\n  var parents$1 = function (start, root) {\n    return parentsUntil$1(start, root, never);\n  };\n\n  var parentsAndSelf = function (start, root) {\n    return [start].concat(parents$1(start, root));\n  };\n\n  var navigateIgnoreEmptyTextNodes = function (forward, root, from) {\n    return navigateIgnore(forward, root, from, isEmptyText);\n  };\n\n  var getClosestBlock = function (root, pos) {\n    return find(parentsAndSelf(SugarElement.fromDom(pos.container()), root), isBlock);\n  };\n\n  var isAtBeforeAfterBlockBoundary = function (forward, root, pos) {\n    return navigateIgnoreEmptyTextNodes(forward, root.dom, pos).forall(function (newPos) {\n      return getClosestBlock(root, pos).fold(function () {\n        return isInSameBlock(newPos, pos, root.dom) === false;\n      }, function (fromBlock) {\n        return isInSameBlock(newPos, pos, root.dom) === false && contains$2(fromBlock, SugarElement.fromDom(newPos.container()));\n      });\n    });\n  };\n\n  var isAtBlockBoundary$1 = function (forward, root, pos) {\n    return getClosestBlock(root, pos).fold(function () {\n      return navigateIgnoreEmptyTextNodes(forward, root.dom, pos).forall(function (newPos) {\n        return isInSameBlock(newPos, pos, root.dom) === false;\n      });\n    }, function (parent) {\n      return navigateIgnoreEmptyTextNodes(forward, parent.dom, pos).isNone();\n    });\n  };\n\n  var isAtStartOfBlock = curry(isAtBlockBoundary$1, false);\n  var isAtEndOfBlock = curry(isAtBlockBoundary$1, true);\n  var isBeforeBlock = curry(isAtBeforeAfterBlockBoundary, false);\n  var isAfterBlock = curry(isAtBeforeAfterBlockBoundary, true);\n\n  var isBr$5 = function (pos) {\n    return getElementFromPosition(pos).exists(isBr$1);\n  };\n\n  var findBr = function (forward, root, pos) {\n    var parentBlocks = filter(parentsAndSelf(SugarElement.fromDom(pos.container()), root), isBlock);\n    var scope = head(parentBlocks).getOr(root);\n    return fromPosition(forward, scope.dom, pos).filter(isBr$5);\n  };\n\n  var isBeforeBr = function (root, pos) {\n    return getElementFromPosition(pos).exists(isBr$1) || findBr(true, root, pos).isSome();\n  };\n\n  var isAfterBr = function (root, pos) {\n    return getElementFromPrevPosition(pos).exists(isBr$1) || findBr(false, root, pos).isSome();\n  };\n\n  var findPreviousBr = curry(findBr, false);\n  var findNextBr = curry(findBr, true);\n\n  var isInMiddleOfText = function (pos) {\n    return CaretPosition.isTextPosition(pos) && !pos.isAtStart() && !pos.isAtEnd();\n  };\n\n  var getClosestBlock$1 = function (root, pos) {\n    var parentBlocks = filter(parentsAndSelf(SugarElement.fromDom(pos.container()), root), isBlock);\n    return head(parentBlocks).getOr(root);\n  };\n\n  var hasSpaceBefore = function (root, pos) {\n    if (isInMiddleOfText(pos)) {\n      return isAfterSpace(pos);\n    } else {\n      return isAfterSpace(pos) || prevPosition(getClosestBlock$1(root, pos).dom, pos).exists(isAfterSpace);\n    }\n  };\n\n  var hasSpaceAfter = function (root, pos) {\n    if (isInMiddleOfText(pos)) {\n      return isBeforeSpace(pos);\n    } else {\n      return isBeforeSpace(pos) || nextPosition(getClosestBlock$1(root, pos).dom, pos).exists(isBeforeSpace);\n    }\n  };\n\n  var isPreValue = function (value) {\n    return contains(['pre', 'pre-wrap'], value);\n  };\n\n  var isInPre = function (pos) {\n    return getElementFromPosition(pos).bind(function (elm) {\n      return closest(elm, isElement);\n    }).exists(function (elm) {\n      return isPreValue(get$5(elm, 'white-space'));\n    });\n  };\n\n  var isAtBeginningOfBody = function (root, pos) {\n    return prevPosition(root.dom, pos).isNone();\n  };\n\n  var isAtEndOfBody = function (root, pos) {\n    return nextPosition(root.dom, pos).isNone();\n  };\n\n  var isAtLineBoundary = function (root, pos) {\n    return isAtBeginningOfBody(root, pos) || isAtEndOfBody(root, pos) || isAtStartOfBlock(root, pos) || isAtEndOfBlock(root, pos) || isAfterBr(root, pos) || isBeforeBr(root, pos);\n  };\n\n  var needsToHaveNbsp = function (root, pos) {\n    if (isInPre(pos)) {\n      return false;\n    } else {\n      return isAtLineBoundary(root, pos) || hasSpaceBefore(root, pos) || hasSpaceAfter(root, pos);\n    }\n  };\n\n  var needsToBeNbspLeft = function (root, pos) {\n    if (isInPre(pos)) {\n      return false;\n    } else {\n      return isAtStartOfBlock(root, pos) || isBeforeBlock(root, pos) || isAfterBr(root, pos) || hasSpaceBefore(root, pos);\n    }\n  };\n\n  var leanRight = function (pos) {\n    var container = pos.container();\n    var offset = pos.offset();\n\n    if (isText$1(container) && offset < container.data.length) {\n      return CaretPosition(container, offset + 1);\n    } else {\n      return pos;\n    }\n  };\n\n  var needsToBeNbspRight = function (root, pos) {\n    if (isInPre(pos)) {\n      return false;\n    } else {\n      return isAtEndOfBlock(root, pos) || isAfterBlock(root, pos) || isBeforeBr(root, pos) || hasSpaceAfter(root, pos);\n    }\n  };\n\n  var needsToBeNbsp = function (root, pos) {\n    return needsToBeNbspLeft(root, pos) || needsToBeNbspRight(root, leanRight(pos));\n  };\n\n  var isNbspAt = function (text, offset) {\n    return isNbsp(text.charAt(offset));\n  };\n\n  var hasNbsp = function (pos) {\n    var container = pos.container();\n    return isText$1(container) && contains$1(container.data, nbsp);\n  };\n\n  var normalizeNbspMiddle = function (text) {\n    var chars = text.split('');\n    return map(chars, function (chr, i) {\n      if (isNbsp(chr) && i > 0 && i < chars.length - 1 && isContent$1(chars[i - 1]) && isContent$1(chars[i + 1])) {\n        return ' ';\n      } else {\n        return chr;\n      }\n    }).join('');\n  };\n\n  var normalizeNbspAtStart = function (root, node) {\n    var text = node.data;\n    var firstPos = CaretPosition(node, 0);\n\n    if (isNbspAt(text, 0) && !needsToBeNbsp(root, firstPos)) {\n      node.data = ' ' + text.slice(1);\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  var normalizeNbspInMiddleOfTextNode = function (node) {\n    var text = node.data;\n    var newText = normalizeNbspMiddle(text);\n\n    if (newText !== text) {\n      node.data = newText;\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  var normalizeNbspAtEnd = function (root, node) {\n    var text = node.data;\n    var lastPos = CaretPosition(node, text.length - 1);\n\n    if (isNbspAt(text, text.length - 1) && !needsToBeNbsp(root, lastPos)) {\n      node.data = text.slice(0, -1) + ' ';\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  var normalizeNbsps = function (root, pos) {\n    return Optional.some(pos).filter(hasNbsp).bind(function (pos) {\n      var container = pos.container();\n      var normalized = normalizeNbspAtStart(root, container) || normalizeNbspInMiddleOfTextNode(container) || normalizeNbspAtEnd(root, container);\n      return normalized ? Optional.some(pos) : Optional.none();\n    });\n  };\n\n  var normalizeNbspsInEditor = function (editor) {\n    var root = SugarElement.fromDom(editor.getBody());\n\n    if (editor.selection.isCollapsed()) {\n      normalizeNbsps(root, CaretPosition.fromRangeStart(editor.selection.getRng())).each(function (pos) {\n        editor.selection.setRng(pos.toRange());\n      });\n    }\n  };\n\n  var normalizeContent = function (content, isStartOfContent, isEndOfContent) {\n    var result = foldl(content, function (acc, c) {\n      if (isWhiteSpace$1(c) || isNbsp(c)) {\n        if (acc.previousCharIsSpace || acc.str === '' && isStartOfContent || acc.str.length === content.length - 1 && isEndOfContent) {\n          return {\n            previousCharIsSpace: false,\n            str: acc.str + nbsp\n          };\n        } else {\n          return {\n            previousCharIsSpace: true,\n            str: acc.str + ' '\n          };\n        }\n      } else {\n        return {\n          previousCharIsSpace: false,\n          str: acc.str + c\n        };\n      }\n    }, {\n      previousCharIsSpace: false,\n      str: ''\n    });\n    return result.str;\n  };\n\n  var normalize$1 = function (node, offset, count) {\n    if (count === 0) {\n      return;\n    }\n\n    var elm = SugarElement.fromDom(node);\n    var root = ancestor(elm, isBlock).getOr(elm);\n    var whitespace = node.data.slice(offset, offset + count);\n    var isEndOfContent = offset + count >= node.data.length && needsToBeNbspRight(root, CaretPosition(node, node.data.length));\n    var isStartOfContent = offset === 0 && needsToBeNbspLeft(root, CaretPosition(node, 0));\n    node.replaceData(offset, count, normalizeContent(whitespace, isStartOfContent, isEndOfContent));\n  };\n\n  var normalizeWhitespaceAfter = function (node, offset) {\n    var content = node.data.slice(offset);\n    var whitespaceCount = content.length - lTrim(content).length;\n    return normalize$1(node, offset, whitespaceCount);\n  };\n\n  var normalizeWhitespaceBefore = function (node, offset) {\n    var content = node.data.slice(0, offset);\n    var whitespaceCount = content.length - rTrim(content).length;\n    return normalize$1(node, offset - whitespaceCount, whitespaceCount);\n  };\n\n  var mergeTextNodes = function (prevNode, nextNode, normalizeWhitespace, mergeToPrev) {\n    if (mergeToPrev === void 0) {\n      mergeToPrev = true;\n    }\n\n    var whitespaceOffset = rTrim(prevNode.data).length;\n    var newNode = mergeToPrev ? prevNode : nextNode;\n    var removeNode = mergeToPrev ? nextNode : prevNode;\n\n    if (mergeToPrev) {\n      newNode.appendData(removeNode.data);\n    } else {\n      newNode.insertData(0, removeNode.data);\n    }\n\n    remove(SugarElement.fromDom(removeNode));\n\n    if (normalizeWhitespace) {\n      normalizeWhitespaceAfter(newNode, whitespaceOffset);\n    }\n\n    return newNode;\n  };\n\n  var needsReposition = function (pos, elm) {\n    var container = pos.container();\n    var offset = pos.offset();\n    return CaretPosition.isTextPosition(pos) === false && container === elm.parentNode && offset > CaretPosition.before(elm).offset();\n  };\n\n  var reposition = function (elm, pos) {\n    return needsReposition(pos, elm) ? CaretPosition(pos.container(), pos.offset() - 1) : pos;\n  };\n\n  var beforeOrStartOf = function (node) {\n    return isText$1(node) ? CaretPosition(node, 0) : CaretPosition.before(node);\n  };\n\n  var afterOrEndOf = function (node) {\n    return isText$1(node) ? CaretPosition(node, node.data.length) : CaretPosition.after(node);\n  };\n\n  var getPreviousSiblingCaretPosition = function (elm) {\n    if (isCaretCandidate(elm.previousSibling)) {\n      return Optional.some(afterOrEndOf(elm.previousSibling));\n    } else {\n      return elm.previousSibling ? lastPositionIn(elm.previousSibling) : Optional.none();\n    }\n  };\n\n  var getNextSiblingCaretPosition = function (elm) {\n    if (isCaretCandidate(elm.nextSibling)) {\n      return Optional.some(beforeOrStartOf(elm.nextSibling));\n    } else {\n      return elm.nextSibling ? firstPositionIn(elm.nextSibling) : Optional.none();\n    }\n  };\n\n  var findCaretPositionBackwardsFromElm = function (rootElement, elm) {\n    var startPosition = CaretPosition.before(elm.previousSibling ? elm.previousSibling : elm.parentNode);\n    return prevPosition(rootElement, startPosition).fold(function () {\n      return nextPosition(rootElement, CaretPosition.after(elm));\n    }, Optional.some);\n  };\n\n  var findCaretPositionForwardsFromElm = function (rootElement, elm) {\n    return nextPosition(rootElement, CaretPosition.after(elm)).fold(function () {\n      return prevPosition(rootElement, CaretPosition.before(elm));\n    }, Optional.some);\n  };\n\n  var findCaretPositionBackwards = function (rootElement, elm) {\n    return getPreviousSiblingCaretPosition(elm).orThunk(function () {\n      return getNextSiblingCaretPosition(elm);\n    }).orThunk(function () {\n      return findCaretPositionBackwardsFromElm(rootElement, elm);\n    });\n  };\n\n  var findCaretPositionForward = function (rootElement, elm) {\n    return getNextSiblingCaretPosition(elm).orThunk(function () {\n      return getPreviousSiblingCaretPosition(elm);\n    }).orThunk(function () {\n      return findCaretPositionForwardsFromElm(rootElement, elm);\n    });\n  };\n\n  var findCaretPosition$1 = function (forward, rootElement, elm) {\n    return forward ? findCaretPositionForward(rootElement, elm) : findCaretPositionBackwards(rootElement, elm);\n  };\n\n  var findCaretPosOutsideElmAfterDelete = function (forward, rootElement, elm) {\n    return findCaretPosition$1(forward, rootElement, elm).map(curry(reposition, elm));\n  };\n\n  var setSelection = function (editor, forward, pos) {\n    pos.fold(function () {\n      editor.focus();\n    }, function (pos) {\n      editor.selection.setRng(pos.toRange(), forward);\n    });\n  };\n\n  var eqRawNode = function (rawNode) {\n    return function (elm) {\n      return elm.dom === rawNode;\n    };\n  };\n\n  var isBlock$2 = function (editor, elm) {\n    return elm && has(editor.schema.getBlockElements(), name(elm));\n  };\n\n  var paddEmptyBlock = function (elm) {\n    if (isEmpty(elm)) {\n      var br = SugarElement.fromHtml('<br data-mce-bogus=\"1\">');\n      empty(elm);\n      append(elm, br);\n      return Optional.some(CaretPosition.before(br.dom));\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var deleteNormalized = function (elm, afterDeletePosOpt, normalizeWhitespace) {\n    var prevTextOpt = prevSibling(elm).filter(isText);\n    var nextTextOpt = nextSibling(elm).filter(isText);\n    remove(elm);\n    return lift3(prevTextOpt, nextTextOpt, afterDeletePosOpt, function (prev, next, pos) {\n      var prevNode = prev.dom,\n          nextNode = next.dom;\n      var offset = prevNode.data.length;\n      mergeTextNodes(prevNode, nextNode, normalizeWhitespace);\n      return pos.container() === nextNode ? CaretPosition(prevNode, offset) : pos;\n    }).orThunk(function () {\n      if (normalizeWhitespace) {\n        prevTextOpt.each(function (elm) {\n          return normalizeWhitespaceBefore(elm.dom, elm.dom.length);\n        });\n        nextTextOpt.each(function (elm) {\n          return normalizeWhitespaceAfter(elm.dom, 0);\n        });\n      }\n\n      return afterDeletePosOpt;\n    });\n  };\n\n  var isInlineElement = function (editor, element) {\n    return has(editor.schema.getTextInlineElements(), name(element));\n  };\n\n  var deleteElement = function (editor, forward, elm, moveCaret) {\n    if (moveCaret === void 0) {\n      moveCaret = true;\n    }\n\n    var afterDeletePos = findCaretPosOutsideElmAfterDelete(forward, editor.getBody(), elm.dom);\n    var parentBlock = ancestor(elm, curry(isBlock$2, editor), eqRawNode(editor.getBody()));\n    var normalizedAfterDeletePos = deleteNormalized(elm, afterDeletePos, isInlineElement(editor, elm));\n\n    if (editor.dom.isEmpty(editor.getBody())) {\n      editor.setContent('');\n      editor.selection.setCursorLocation();\n    } else {\n      parentBlock.bind(paddEmptyBlock).fold(function () {\n        if (moveCaret) {\n          setSelection(editor, forward, normalizedAfterDeletePos);\n        }\n      }, function (paddPos) {\n        if (moveCaret) {\n          setSelection(editor, forward, Optional.some(paddPos));\n        }\n      });\n    }\n  };\n\n  var tableCellRng = function (start, end) {\n    return {\n      start: start,\n      end: end\n    };\n  };\n\n  var tableSelection = function (rng, table, cells) {\n    return {\n      rng: rng,\n      table: table,\n      cells: cells\n    };\n  };\n\n  var deleteAction = Adt.generate([{\n    removeTable: ['element']\n  }, {\n    emptyCells: ['cells']\n  }, {\n    deleteCellSelection: ['rng', 'cell']\n  }]);\n\n  var isRootFromElement = function (root) {\n    return function (cur) {\n      return eq$2(root, cur);\n    };\n  };\n\n  var getClosestCell = function (container, isRoot) {\n    return closest$1(SugarElement.fromDom(container), 'td,th', isRoot);\n  };\n\n  var getClosestTable = function (cell, isRoot) {\n    return ancestor$1(cell, 'table', isRoot);\n  };\n\n  var isExpandedCellRng = function (cellRng) {\n    return !eq$2(cellRng.start, cellRng.end);\n  };\n\n  var getTableFromCellRng = function (cellRng, isRoot) {\n    return getClosestTable(cellRng.start, isRoot).bind(function (startParentTable) {\n      return getClosestTable(cellRng.end, isRoot).bind(function (endParentTable) {\n        return someIf(eq$2(startParentTable, endParentTable), startParentTable);\n      });\n    });\n  };\n\n  var isSingleCellTable = function (cellRng, isRoot) {\n    return !isExpandedCellRng(cellRng) && getTableFromCellRng(cellRng, isRoot).exists(function (table) {\n      var rows = table.dom.rows;\n      return rows.length === 1 && rows[0].cells.length === 1;\n    });\n  };\n\n  var getTableCells = function (table) {\n    return descendants$1(table, 'td,th');\n  };\n\n  var getCellRng = function (rng, isRoot) {\n    var startCell = getClosestCell(rng.startContainer, isRoot);\n    var endCell = getClosestCell(rng.endContainer, isRoot);\n    return lift2(startCell, endCell, tableCellRng);\n  };\n\n  var getCellRangeFromStartTable = function (cellRng, isRoot) {\n    return getClosestTable(cellRng.start, isRoot).bind(function (table) {\n      return last(getTableCells(table)).map(function (endCell) {\n        return tableCellRng(cellRng.start, endCell);\n      });\n    });\n  };\n\n  var partialSelection = function (isRoot, rng) {\n    var startCell = getClosestCell(rng.startContainer, isRoot);\n    var endCell = getClosestCell(rng.endContainer, isRoot);\n    return rng.collapsed ? Optional.none() : lift2(startCell, endCell, tableCellRng).fold(function () {\n      return startCell.fold(function () {\n        return endCell.bind(function (endCell) {\n          return getClosestTable(endCell, isRoot).bind(function (table) {\n            return head(getTableCells(table)).map(function (startCell) {\n              return tableCellRng(startCell, endCell);\n            });\n          });\n        });\n      }, function (startCell) {\n        return getClosestTable(startCell, isRoot).bind(function (table) {\n          return last(getTableCells(table)).map(function (endCell) {\n            return tableCellRng(startCell, endCell);\n          });\n        });\n      });\n    }, function (cellRng) {\n      return isWithinSameTable(isRoot, cellRng) ? Optional.none() : getCellRangeFromStartTable(cellRng, isRoot);\n    });\n  };\n\n  var isWithinSameTable = function (isRoot, cellRng) {\n    return getTableFromCellRng(cellRng, isRoot).isSome();\n  };\n\n  var getTableSelectionFromCellRng = function (cellRng, isRoot) {\n    return getTableFromCellRng(cellRng, isRoot).map(function (table) {\n      return tableSelection(cellRng, table, getTableCells(table));\n    });\n  };\n\n  var getTableSelection = function (optCellRng, rng, isRoot) {\n    return optCellRng.filter(function (cellRng) {\n      return isExpandedCellRng(cellRng) && isWithinSameTable(isRoot, cellRng);\n    }).orThunk(function () {\n      return partialSelection(isRoot, rng);\n    }).bind(function (cRng) {\n      return getTableSelectionFromCellRng(cRng, isRoot);\n    });\n  };\n\n  var getCellIndex = function (cells, cell) {\n    return findIndex(cells, function (x) {\n      return eq$2(x, cell);\n    });\n  };\n\n  var getSelectedCells = function (tableSelection) {\n    return lift2(getCellIndex(tableSelection.cells, tableSelection.rng.start), getCellIndex(tableSelection.cells, tableSelection.rng.end), function (startIndex, endIndex) {\n      return tableSelection.cells.slice(startIndex, endIndex + 1);\n    });\n  };\n\n  var isSingleCellTableContentSelected = function (optCellRng, rng, isRoot) {\n    return optCellRng.filter(function (cellRng) {\n      return isSingleCellTable(cellRng, isRoot) && hasAllContentsSelected(cellRng.start, rng);\n    }).map(function (cellRng) {\n      return cellRng.start;\n    });\n  };\n\n  var getAction = function (tableSelection) {\n    return getSelectedCells(tableSelection).map(function (selected) {\n      var cells = tableSelection.cells;\n      return selected.length === cells.length ? deleteAction.removeTable(tableSelection.table) : deleteAction.emptyCells(selected);\n    });\n  };\n\n  var getActionFromRange = function (root, rng) {\n    var isRoot = isRootFromElement(root);\n    var optCellRng = getCellRng(rng, isRoot);\n    return isSingleCellTableContentSelected(optCellRng, rng, isRoot).map(function (cell) {\n      return deleteAction.deleteCellSelection(rng, cell);\n    }).orThunk(function () {\n      return getTableSelection(optCellRng, rng, isRoot).bind(getAction);\n    });\n  };\n\n  var freefallRtl = function (root) {\n    var child = isComment(root) ? prevSibling(root) : lastChild(root);\n    return child.bind(freefallRtl).orThunk(function () {\n      return Optional.some(root);\n    });\n  };\n\n  var emptyCells = function (editor, cells) {\n    each(cells, fillWithPaddingBr);\n    editor.selection.setCursorLocation(cells[0].dom, 0);\n    return true;\n  };\n\n  var deleteCellContents = function (editor, rng, cell) {\n    rng.deleteContents();\n    var lastNode = freefallRtl(cell).getOr(cell);\n    var lastBlock = SugarElement.fromDom(editor.dom.getParent(lastNode.dom, editor.dom.isBlock));\n\n    if (isEmpty(lastBlock)) {\n      fillWithPaddingBr(lastBlock);\n      editor.selection.setCursorLocation(lastBlock.dom, 0);\n    }\n\n    if (!eq$2(cell, lastBlock)) {\n      var additionalCleanupNodes = parent(lastBlock).is(cell) ? [] : siblings(lastBlock);\n      each(additionalCleanupNodes.concat(children(cell)), function (node) {\n        if (!eq$2(node, lastBlock) && !contains$2(node, lastBlock)) {\n          remove(node);\n        }\n      });\n    }\n\n    return true;\n  };\n\n  var deleteTableElement = function (editor, table) {\n    deleteElement(editor, false, table);\n    return true;\n  };\n\n  var deleteCellRange = function (editor, rootElm, rng) {\n    return getActionFromRange(rootElm, rng).map(function (action) {\n      return action.fold(curry(deleteTableElement, editor), curry(emptyCells, editor), curry(deleteCellContents, editor));\n    });\n  };\n\n  var deleteCaptionRange = function (editor, caption) {\n    return emptyElement(editor, caption);\n  };\n\n  var deleteTableRange = function (editor, rootElm, rng, startElm) {\n    return getParentCaption(rootElm, startElm).fold(function () {\n      return deleteCellRange(editor, rootElm, rng);\n    }, function (caption) {\n      return deleteCaptionRange(editor, caption);\n    }).getOr(false);\n  };\n\n  var deleteRange = function (editor, startElm) {\n    var rootNode = SugarElement.fromDom(editor.getBody());\n    var rng = editor.selection.getRng();\n    var selectedCells = getCellsFromEditor(editor);\n    return selectedCells.length !== 0 ? emptyCells(editor, selectedCells) : deleteTableRange(editor, rootNode, rng, startElm);\n  };\n\n  var getParentCell = function (rootElm, elm) {\n    return find(parentsAndSelf(elm, rootElm), isTableCell$1);\n  };\n\n  var getParentCaption = function (rootElm, elm) {\n    return find(parentsAndSelf(elm, rootElm), function (elm) {\n      return name(elm) === 'caption';\n    });\n  };\n\n  var deleteBetweenCells = function (editor, rootElm, forward, fromCell, from) {\n    return navigate(forward, editor.getBody(), from).bind(function (to) {\n      return getParentCell(rootElm, SugarElement.fromDom(to.getNode())).map(function (toCell) {\n        return eq$2(toCell, fromCell) === false;\n      });\n    });\n  };\n\n  var emptyElement = function (editor, elm) {\n    fillWithPaddingBr(elm);\n    editor.selection.setCursorLocation(elm.dom, 0);\n    return Optional.some(true);\n  };\n\n  var isDeleteOfLastCharPos = function (fromCaption, forward, from, to) {\n    return firstPositionIn(fromCaption.dom).bind(function (first) {\n      return lastPositionIn(fromCaption.dom).map(function (last) {\n        return forward ? from.isEqual(first) && to.isEqual(last) : from.isEqual(last) && to.isEqual(first);\n      });\n    }).getOr(true);\n  };\n\n  var emptyCaretCaption = function (editor, elm) {\n    return emptyElement(editor, elm);\n  };\n\n  var validateCaretCaption = function (rootElm, fromCaption, to) {\n    return getParentCaption(rootElm, SugarElement.fromDom(to.getNode())).map(function (toCaption) {\n      return eq$2(toCaption, fromCaption) === false;\n    });\n  };\n\n  var deleteCaretInsideCaption = function (editor, rootElm, forward, fromCaption, from) {\n    return navigate(forward, editor.getBody(), from).bind(function (to) {\n      return isDeleteOfLastCharPos(fromCaption, forward, from, to) ? emptyCaretCaption(editor, fromCaption) : validateCaretCaption(rootElm, fromCaption, to);\n    }).or(Optional.some(true));\n  };\n\n  var deleteCaretCells = function (editor, forward, rootElm, startElm) {\n    var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n    return getParentCell(rootElm, startElm).bind(function (fromCell) {\n      return isEmpty(fromCell) ? emptyElement(editor, fromCell) : deleteBetweenCells(editor, rootElm, forward, fromCell, from);\n    }).getOr(false);\n  };\n\n  var deleteCaretCaption = function (editor, forward, rootElm, fromCaption) {\n    var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n    return isEmpty(fromCaption) ? emptyElement(editor, fromCaption) : deleteCaretInsideCaption(editor, rootElm, forward, fromCaption, from);\n  };\n\n  var isNearTable = function (forward, pos) {\n    return forward ? isBeforeTable(pos) : isAfterTable(pos);\n  };\n\n  var isBeforeOrAfterTable = function (editor, forward) {\n    var fromPos = CaretPosition.fromRangeStart(editor.selection.getRng());\n    return isNearTable(forward, fromPos) || fromPosition(forward, editor.getBody(), fromPos).exists(function (pos) {\n      return isNearTable(forward, pos);\n    });\n  };\n\n  var deleteCaret = function (editor, forward, startElm) {\n    var rootElm = SugarElement.fromDom(editor.getBody());\n    return getParentCaption(rootElm, startElm).fold(function () {\n      return deleteCaretCells(editor, forward, rootElm, startElm) || isBeforeOrAfterTable(editor, forward);\n    }, function (fromCaption) {\n      return deleteCaretCaption(editor, forward, rootElm, fromCaption).getOr(false);\n    });\n  };\n\n  var backspaceDelete = function (editor, forward) {\n    var startElm = SugarElement.fromDom(editor.selection.getStart(true));\n    var cells = getCellsFromEditor(editor);\n    return editor.selection.isCollapsed() && cells.length === 0 ? deleteCaret(editor, forward, startElm) : deleteRange(editor, startElm);\n  };\n\n  var createRange$1 = function (sc, so, ec, eo) {\n    var rng = document.createRange();\n    rng.setStart(sc, so);\n    rng.setEnd(ec, eo);\n    return rng;\n  };\n\n  var normalizeBlockSelectionRange = function (rng) {\n    var startPos = CaretPosition.fromRangeStart(rng);\n    var endPos = CaretPosition.fromRangeEnd(rng);\n    var rootNode = rng.commonAncestorContainer;\n    return fromPosition(false, rootNode, endPos).map(function (newEndPos) {\n      if (!isInSameBlock(startPos, endPos, rootNode) && isInSameBlock(startPos, newEndPos, rootNode)) {\n        return createRange$1(startPos.container(), startPos.offset(), newEndPos.container(), newEndPos.offset());\n      } else {\n        return rng;\n      }\n    }).getOr(rng);\n  };\n\n  var normalize$2 = function (rng) {\n    return rng.collapsed ? rng : normalizeBlockSelectionRange(rng);\n  };\n\n  var hasOnlyOneChild = function (node) {\n    return node.firstChild && node.firstChild === node.lastChild;\n  };\n\n  var isPaddingNode = function (node) {\n    return node.name === 'br' || node.value === nbsp;\n  };\n\n  var isPaddedEmptyBlock = function (schema, node) {\n    var blockElements = schema.getBlockElements();\n    return blockElements[node.name] && hasOnlyOneChild(node) && isPaddingNode(node.firstChild);\n  };\n\n  var isEmptyFragmentElement = function (schema, node) {\n    var nonEmptyElements = schema.getNonEmptyElements();\n    return node && (node.isEmpty(nonEmptyElements) || isPaddedEmptyBlock(schema, node));\n  };\n\n  var isListFragment = function (schema, fragment) {\n    var firstChild = fragment.firstChild;\n    var lastChild = fragment.lastChild;\n\n    if (firstChild && firstChild.name === 'meta') {\n      firstChild = firstChild.next;\n    }\n\n    if (lastChild && lastChild.attr('id') === 'mce_marker') {\n      lastChild = lastChild.prev;\n    }\n\n    if (isEmptyFragmentElement(schema, lastChild)) {\n      lastChild = lastChild.prev;\n    }\n\n    if (!firstChild || firstChild !== lastChild) {\n      return false;\n    }\n\n    return firstChild.name === 'ul' || firstChild.name === 'ol';\n  };\n\n  var cleanupDomFragment = function (domFragment) {\n    var firstChild = domFragment.firstChild;\n    var lastChild = domFragment.lastChild;\n\n    if (firstChild && firstChild.nodeName === 'META') {\n      firstChild.parentNode.removeChild(firstChild);\n    }\n\n    if (lastChild && lastChild.id === 'mce_marker') {\n      lastChild.parentNode.removeChild(lastChild);\n    }\n\n    return domFragment;\n  };\n\n  var toDomFragment = function (dom, serializer, fragment) {\n    var html = serializer.serialize(fragment);\n    var domFragment = dom.createFragment(html);\n    return cleanupDomFragment(domFragment);\n  };\n\n  var listItems$1 = function (elm) {\n    return Tools.grep(elm.childNodes, function (child) {\n      return child.nodeName === 'LI';\n    });\n  };\n\n  var isPadding = function (node) {\n    return node.data === nbsp || isBr(node);\n  };\n\n  var isListItemPadded = function (node) {\n    return node && node.firstChild && node.firstChild === node.lastChild && isPadding(node.firstChild);\n  };\n\n  var isEmptyOrPadded = function (elm) {\n    return !elm.firstChild || isListItemPadded(elm);\n  };\n\n  var trimListItems = function (elms) {\n    return elms.length > 0 && isEmptyOrPadded(elms[elms.length - 1]) ? elms.slice(0, -1) : elms;\n  };\n\n  var getParentLi = function (dom, node) {\n    var parentBlock = dom.getParent(node, dom.isBlock);\n    return parentBlock && parentBlock.nodeName === 'LI' ? parentBlock : null;\n  };\n\n  var isParentBlockLi = function (dom, node) {\n    return !!getParentLi(dom, node);\n  };\n\n  var getSplit = function (parentNode, rng) {\n    var beforeRng = rng.cloneRange();\n    var afterRng = rng.cloneRange();\n    beforeRng.setStartBefore(parentNode);\n    afterRng.setEndAfter(parentNode);\n    return [beforeRng.cloneContents(), afterRng.cloneContents()];\n  };\n\n  var findFirstIn = function (node, rootNode) {\n    var caretPos = CaretPosition.before(node);\n    var caretWalker = CaretWalker(rootNode);\n    var newCaretPos = caretWalker.next(caretPos);\n    return newCaretPos ? newCaretPos.toRange() : null;\n  };\n\n  var findLastOf = function (node, rootNode) {\n    var caretPos = CaretPosition.after(node);\n    var caretWalker = CaretWalker(rootNode);\n    var newCaretPos = caretWalker.prev(caretPos);\n    return newCaretPos ? newCaretPos.toRange() : null;\n  };\n\n  var insertMiddle = function (target, elms, rootNode, rng) {\n    var parts = getSplit(target, rng);\n    var parentElm = target.parentNode;\n    parentElm.insertBefore(parts[0], target);\n    Tools.each(elms, function (li) {\n      parentElm.insertBefore(li, target);\n    });\n    parentElm.insertBefore(parts[1], target);\n    parentElm.removeChild(target);\n    return findLastOf(elms[elms.length - 1], rootNode);\n  };\n\n  var insertBefore = function (target, elms, rootNode) {\n    var parentElm = target.parentNode;\n    Tools.each(elms, function (elm) {\n      parentElm.insertBefore(elm, target);\n    });\n    return findFirstIn(target, rootNode);\n  };\n\n  var insertAfter = function (target, elms, rootNode, dom) {\n    dom.insertAfter(elms.reverse(), target);\n    return findLastOf(elms[0], rootNode);\n  };\n\n  var insertAtCaret = function (serializer, dom, rng, fragment) {\n    var domFragment = toDomFragment(dom, serializer, fragment);\n    var liTarget = getParentLi(dom, rng.startContainer);\n    var liElms = trimListItems(listItems$1(domFragment.firstChild));\n    var BEGINNING = 1,\n        END = 2;\n    var rootNode = dom.getRoot();\n\n    var isAt = function (location) {\n      var caretPos = CaretPosition.fromRangeStart(rng);\n      var caretWalker = CaretWalker(dom.getRoot());\n      var newPos = location === BEGINNING ? caretWalker.prev(caretPos) : caretWalker.next(caretPos);\n      return newPos ? getParentLi(dom, newPos.getNode()) !== liTarget : true;\n    };\n\n    if (isAt(BEGINNING)) {\n      return insertBefore(liTarget, liElms, rootNode);\n    } else if (isAt(END)) {\n      return insertAfter(liTarget, liElms, rootNode, dom);\n    }\n\n    return insertMiddle(liTarget, liElms, rootNode, rng);\n  };\n\n  var trimOrPadLeftRight = function (dom, rng, html) {\n    var root = SugarElement.fromDom(dom.getRoot());\n\n    if (needsToBeNbspLeft(root, CaretPosition.fromRangeStart(rng))) {\n      html = html.replace(/^ /, '&nbsp;');\n    } else {\n      html = html.replace(/^&nbsp;/, ' ');\n    }\n\n    if (needsToBeNbspRight(root, CaretPosition.fromRangeEnd(rng))) {\n      html = html.replace(/(&nbsp;| )(<br( \\/)>)?$/, '&nbsp;');\n    } else {\n      html = html.replace(/&nbsp;(<br( \\/)?>)?$/, ' ');\n    }\n\n    return html;\n  };\n\n  var isTableCell$4 = isTableCell;\n\n  var isTableCellContentSelected = function (dom, rng, cell) {\n    if (cell !== null) {\n      var endCell = dom.getParent(rng.endContainer, isTableCell$4);\n      return cell === endCell && hasAllContentsSelected(SugarElement.fromDom(cell), rng);\n    } else {\n      return false;\n    }\n  };\n\n  var validInsertion = function (editor, value, parentNode) {\n    if (parentNode.getAttribute('data-mce-bogus') === 'all') {\n      parentNode.parentNode.insertBefore(editor.dom.createFragment(value), parentNode);\n    } else {\n      var node = parentNode.firstChild;\n      var node2 = parentNode.lastChild;\n\n      if (!node || node === node2 && node.nodeName === 'BR') {\n        editor.dom.setHTML(parentNode, value);\n      } else {\n        editor.selection.setContent(value);\n      }\n    }\n  };\n\n  var trimBrsFromTableCell = function (dom, elm) {\n    Optional.from(dom.getParent(elm, 'td,th')).map(SugarElement.fromDom).each(trimBlockTrailingBr);\n  };\n\n  var reduceInlineTextElements = function (editor, merge) {\n    var textInlineElements = editor.schema.getTextInlineElements();\n    var dom = editor.dom;\n\n    if (merge) {\n      var root_1 = editor.getBody();\n      var elementUtils_1 = ElementUtils(dom);\n      Tools.each(dom.select('*[data-mce-fragment]'), function (node) {\n        var isInline = isNonNullable(textInlineElements[node.nodeName.toLowerCase()]);\n\n        if (isInline && hasInheritableStyles(dom, node)) {\n          for (var parentNode = node.parentNode; isNonNullable(parentNode) && parentNode !== root_1; parentNode = parentNode.parentNode) {\n            var styleConflict = hasStyleConflict(dom, node, parentNode);\n\n            if (styleConflict) {\n              break;\n            }\n\n            if (elementUtils_1.compare(parentNode, node)) {\n              dom.remove(node, true);\n              break;\n            }\n          }\n        }\n      });\n    }\n  };\n\n  var markFragmentElements = function (fragment) {\n    var node = fragment;\n\n    while (node = node.walk()) {\n      if (node.type === 1) {\n        node.attr('data-mce-fragment', '1');\n      }\n    }\n  };\n\n  var unmarkFragmentElements = function (elm) {\n    Tools.each(elm.getElementsByTagName('*'), function (elm) {\n      elm.removeAttribute('data-mce-fragment');\n    });\n  };\n\n  var isPartOfFragment = function (node) {\n    return !!node.getAttribute('data-mce-fragment');\n  };\n\n  var canHaveChildren = function (editor, node) {\n    return node && !editor.schema.getShortEndedElements()[node.nodeName];\n  };\n\n  var moveSelectionToMarker = function (editor, marker) {\n    var nextRng;\n    var dom = editor.dom,\n        selection = editor.selection;\n    var node2;\n\n    var getContentEditableFalseParent = function (node) {\n      var root = editor.getBody();\n\n      for (; node && node !== root; node = node.parentNode) {\n        if (dom.getContentEditable(node) === 'false') {\n          return node;\n        }\n      }\n\n      return null;\n    };\n\n    if (!marker) {\n      return;\n    }\n\n    selection.scrollIntoView(marker);\n    var parentEditableFalseElm = getContentEditableFalseParent(marker);\n\n    if (parentEditableFalseElm) {\n      dom.remove(marker);\n      selection.select(parentEditableFalseElm);\n      return;\n    }\n\n    var rng = dom.createRng();\n    var node = marker.previousSibling;\n\n    if (node && node.nodeType === 3) {\n      rng.setStart(node, node.nodeValue.length);\n\n      if (!Env.ie) {\n        node2 = marker.nextSibling;\n\n        if (node2 && node2.nodeType === 3) {\n          node.appendData(node2.data);\n          node2.parentNode.removeChild(node2);\n        }\n      }\n    } else {\n      rng.setStartBefore(marker);\n      rng.setEndBefore(marker);\n    }\n\n    var findNextCaretRng = function (rng) {\n      var caretPos = CaretPosition.fromRangeStart(rng);\n      var caretWalker = CaretWalker(editor.getBody());\n      caretPos = caretWalker.next(caretPos);\n\n      if (caretPos) {\n        return caretPos.toRange();\n      }\n    };\n\n    var parentBlock = dom.getParent(marker, dom.isBlock);\n    dom.remove(marker);\n\n    if (parentBlock && dom.isEmpty(parentBlock)) {\n      editor.$(parentBlock).empty();\n      rng.setStart(parentBlock, 0);\n      rng.setEnd(parentBlock, 0);\n\n      if (!isTableCell$4(parentBlock) && !isPartOfFragment(parentBlock) && (nextRng = findNextCaretRng(rng))) {\n        rng = nextRng;\n        dom.remove(parentBlock);\n      } else {\n        dom.add(parentBlock, dom.create('br', {\n          'data-mce-bogus': '1'\n        }));\n      }\n    }\n\n    selection.setRng(rng);\n  };\n\n  var deleteSelectedContent = function (editor) {\n    var dom = editor.dom;\n    var rng = normalize$2(editor.selection.getRng());\n    editor.selection.setRng(rng);\n    var startCell = dom.getParent(rng.startContainer, isTableCell$4);\n\n    if (isTableCellContentSelected(dom, rng, startCell)) {\n      deleteCellContents(editor, rng, SugarElement.fromDom(startCell));\n    } else {\n      editor.getDoc().execCommand('Delete', false, null);\n    }\n  };\n\n  var insertHtmlAtCaret = function (editor, value, details) {\n    var parentNode, rootNode, args;\n    var marker, rng, node;\n    var selection = editor.selection,\n        dom = editor.dom;\n\n    if (/^ | $/.test(value)) {\n      value = trimOrPadLeftRight(dom, selection.getRng(), value);\n    }\n\n    var parser = editor.parser;\n    var merge = details.merge;\n    var serializer = HtmlSerializer({\n      validate: shouldValidate(editor)\n    }, editor.schema);\n    var bookmarkHtml = '<span id=\"mce_marker\" data-mce-type=\"bookmark\">&#xFEFF;</span>';\n    args = {\n      content: value,\n      format: 'html',\n      selection: true,\n      paste: details.paste\n    };\n    args = editor.fire('BeforeSetContent', args);\n\n    if (args.isDefaultPrevented()) {\n      editor.fire('SetContent', {\n        content: args.content,\n        format: 'html',\n        selection: true,\n        paste: details.paste\n      });\n      return;\n    }\n\n    value = args.content;\n\n    if (value.indexOf('{$caret}') === -1) {\n      value += '{$caret}';\n    }\n\n    value = value.replace(/\\{\\$caret\\}/, bookmarkHtml);\n    rng = selection.getRng();\n    var caretElement = rng.startContainer || (rng.parentElement ? rng.parentElement() : null);\n    var body = editor.getBody();\n\n    if (caretElement === body && selection.isCollapsed()) {\n      if (dom.isBlock(body.firstChild) && canHaveChildren(editor, body.firstChild) && dom.isEmpty(body.firstChild)) {\n        rng = dom.createRng();\n        rng.setStart(body.firstChild, 0);\n        rng.setEnd(body.firstChild, 0);\n        selection.setRng(rng);\n      }\n    }\n\n    if (!selection.isCollapsed()) {\n      deleteSelectedContent(editor);\n    }\n\n    parentNode = selection.getNode();\n    var parserArgs = {\n      context: parentNode.nodeName.toLowerCase(),\n      data: details.data,\n      insert: true\n    };\n    var fragment = parser.parse(value, parserArgs);\n\n    if (details.paste === true && isListFragment(editor.schema, fragment) && isParentBlockLi(dom, parentNode)) {\n      rng = insertAtCaret(serializer, dom, selection.getRng(), fragment);\n      selection.setRng(rng);\n      editor.fire('SetContent', args);\n      return;\n    }\n\n    markFragmentElements(fragment);\n    node = fragment.lastChild;\n\n    if (node.attr('id') === 'mce_marker') {\n      marker = node;\n\n      for (node = node.prev; node; node = node.walk(true)) {\n        if (node.type === 3 || !dom.isBlock(node.name)) {\n          if (editor.schema.isValidChild(node.parent.name, 'span')) {\n            node.parent.insert(marker, node, node.name === 'br');\n          }\n\n          break;\n        }\n      }\n    }\n\n    editor._selectionOverrides.showBlockCaretContainer(parentNode);\n\n    if (!parserArgs.invalid) {\n      value = serializer.serialize(fragment);\n      validInsertion(editor, value, parentNode);\n    } else {\n      editor.selection.setContent(bookmarkHtml);\n      parentNode = selection.getNode();\n      rootNode = editor.getBody();\n\n      if (parentNode.nodeType === 9) {\n        parentNode = node = rootNode;\n      } else {\n        node = parentNode;\n      }\n\n      while (node !== rootNode) {\n        parentNode = node;\n        node = node.parentNode;\n      }\n\n      value = parentNode === rootNode ? rootNode.innerHTML : dom.getOuterHTML(parentNode);\n      value = serializer.serialize(parser.parse(value.replace(/<span (id=\"mce_marker\"|id=mce_marker).+?<\\/span>/i, function () {\n        return serializer.serialize(fragment);\n      })));\n\n      if (parentNode === rootNode) {\n        dom.setHTML(rootNode, value);\n      } else {\n        dom.setOuterHTML(parentNode, value);\n      }\n    }\n\n    reduceInlineTextElements(editor, merge);\n    moveSelectionToMarker(editor, dom.get('mce_marker'));\n    unmarkFragmentElements(editor.getBody());\n    trimBrsFromTableCell(dom, selection.getStart());\n    editor.fire('SetContent', args);\n    editor.addVisual();\n  };\n\n  var traverse = function (node, fn) {\n    fn(node);\n\n    if (node.firstChild) {\n      traverse(node.firstChild, fn);\n    }\n\n    if (node.next) {\n      traverse(node.next, fn);\n    }\n  };\n\n  var findMatchingNodes = function (nodeFilters, attributeFilters, node) {\n    var nodeMatches = {};\n    var attrMatches = {};\n    var matches = [];\n\n    if (node.firstChild) {\n      traverse(node.firstChild, function (node) {\n        each(nodeFilters, function (filter) {\n          if (filter.name === node.name) {\n            if (nodeMatches[filter.name]) {\n              nodeMatches[filter.name].nodes.push(node);\n            } else {\n              nodeMatches[filter.name] = {\n                filter: filter,\n                nodes: [node]\n              };\n            }\n          }\n        });\n        each(attributeFilters, function (filter) {\n          if (typeof node.attr(filter.name) === 'string') {\n            if (attrMatches[filter.name]) {\n              attrMatches[filter.name].nodes.push(node);\n            } else {\n              attrMatches[filter.name] = {\n                filter: filter,\n                nodes: [node]\n              };\n            }\n          }\n        });\n      });\n    }\n\n    for (var name_1 in nodeMatches) {\n      if (nodeMatches.hasOwnProperty(name_1)) {\n        matches.push(nodeMatches[name_1]);\n      }\n    }\n\n    for (var name_2 in attrMatches) {\n      if (attrMatches.hasOwnProperty(name_2)) {\n        matches.push(attrMatches[name_2]);\n      }\n    }\n\n    return matches;\n  };\n\n  var filter$3 = function (nodeFilters, attributeFilters, node) {\n    var matches = findMatchingNodes(nodeFilters, attributeFilters, node);\n    each(matches, function (match) {\n      each(match.filter.callbacks, function (callback) {\n        callback(match.nodes, match.filter.name, {});\n      });\n    });\n  };\n\n  var defaultFormat = 'html';\n\n  var isTreeNode = function (content) {\n    return content instanceof AstNode;\n  };\n\n  var moveSelection = function (editor) {\n    if (hasFocus$1(editor)) {\n      firstPositionIn(editor.getBody()).each(function (pos) {\n        var node = pos.getNode();\n        var caretPos = isTable(node) ? firstPositionIn(node).getOr(pos) : pos;\n        editor.selection.setRng(caretPos.toRange());\n      });\n    }\n  };\n\n  var setEditorHtml = function (editor, html) {\n    editor.dom.setHTML(editor.getBody(), html);\n    moveSelection(editor);\n  };\n\n  var setContentString = function (editor, body, content, args) {\n    var forcedRootBlockName, padd;\n\n    if (content.length === 0 || /^\\s+$/.test(content)) {\n      padd = '<br data-mce-bogus=\"1\">';\n\n      if (body.nodeName === 'TABLE') {\n        content = '<tr><td>' + padd + '</td></tr>';\n      } else if (/^(UL|OL)$/.test(body.nodeName)) {\n        content = '<li>' + padd + '</li>';\n      }\n\n      forcedRootBlockName = getForcedRootBlock(editor);\n\n      if (forcedRootBlockName && editor.schema.isValidChild(body.nodeName.toLowerCase(), forcedRootBlockName.toLowerCase())) {\n        content = padd;\n        content = editor.dom.createHTML(forcedRootBlockName, getForcedRootBlockAttrs(editor), content);\n      } else if (!content) {\n        content = '<br data-mce-bogus=\"1\">';\n      }\n\n      setEditorHtml(editor, content);\n      editor.fire('SetContent', args);\n    } else {\n      if (args.format !== 'raw') {\n        content = HtmlSerializer({\n          validate: editor.validate\n        }, editor.schema).serialize(editor.parser.parse(content, {\n          isRootContent: true,\n          insert: true\n        }));\n      }\n\n      args.content = isWsPreserveElement(SugarElement.fromDom(body)) ? content : Tools.trim(content);\n      setEditorHtml(editor, args.content);\n\n      if (!args.no_events) {\n        editor.fire('SetContent', args);\n      }\n    }\n\n    return args.content;\n  };\n\n  var setContentTree = function (editor, body, content, args) {\n    filter$3(editor.parser.getNodeFilters(), editor.parser.getAttributeFilters(), content);\n    var html = HtmlSerializer({\n      validate: editor.validate\n    }, editor.schema).serialize(content);\n    args.content = isWsPreserveElement(SugarElement.fromDom(body)) ? html : Tools.trim(html);\n    setEditorHtml(editor, args.content);\n\n    if (!args.no_events) {\n      editor.fire('SetContent', args);\n    }\n\n    return content;\n  };\n\n  var setContentInternal = function (editor, content, args) {\n    args.format = args.format ? args.format : defaultFormat;\n    args.set = true;\n    args.content = isTreeNode(content) ? '' : content;\n\n    if (!args.no_events) {\n      editor.fire('BeforeSetContent', args);\n    }\n\n    if (!isTreeNode(content)) {\n      content = args.content;\n    }\n\n    return Optional.from(editor.getBody()).fold(constant(content), function (body) {\n      return isTreeNode(content) ? setContentTree(editor, body, content, args) : setContentString(editor, body, content, args);\n    });\n  };\n\n  var sibling$2 = function (scope, predicate) {\n    return sibling(scope, predicate).isSome();\n  };\n\n  var ensureIsRoot = function (isRoot) {\n    return isFunction(isRoot) ? isRoot : never;\n  };\n\n  var ancestor$3 = function (scope, transform, isRoot) {\n    var element = scope.dom;\n    var stop = ensureIsRoot(isRoot);\n\n    while (element.parentNode) {\n      element = element.parentNode;\n      var el = SugarElement.fromDom(element);\n      var transformed = transform(el);\n\n      if (transformed.isSome()) {\n        return transformed;\n      } else if (stop(el)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var closest$2 = function (scope, transform, isRoot) {\n    var current = transform(scope);\n    var stop = ensureIsRoot(isRoot);\n    return current.orThunk(function () {\n      return stop(scope) ? Optional.none() : ancestor$3(scope, transform, stop);\n    });\n  };\n\n  var isEq$2 = isEq;\n\n  var matchesUnInheritedFormatSelector = function (ed, node, name) {\n    var formatList = ed.formatter.get(name);\n\n    if (formatList) {\n      for (var i = 0; i < formatList.length; i++) {\n        if (formatList[i].inherit === false && ed.dom.is(node, formatList[i].selector)) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  };\n\n  var matchParents = function (editor, node, name, vars) {\n    var root = editor.dom.getRoot();\n\n    if (node === root) {\n      return false;\n    }\n\n    node = editor.dom.getParent(node, function (node) {\n      if (matchesUnInheritedFormatSelector(editor, node, name)) {\n        return true;\n      }\n\n      return node.parentNode === root || !!matchNode(editor, node, name, vars, true);\n    });\n    return matchNode(editor, node, name, vars);\n  };\n\n  var matchName = function (dom, node, format) {\n    if (isEq$2(node, format.inline)) {\n      return true;\n    }\n\n    if (isEq$2(node, format.block)) {\n      return true;\n    }\n\n    if (format.selector) {\n      return node.nodeType === 1 && dom.is(node, format.selector);\n    }\n  };\n\n  var matchItems = function (dom, node, format, itemName, similar, vars) {\n    var key, value;\n    var items = format[itemName];\n    var i;\n\n    if (format.onmatch) {\n      return format.onmatch(node, format, itemName);\n    }\n\n    if (items) {\n      if (typeof items.length === 'undefined') {\n        for (key in items) {\n          if (items.hasOwnProperty(key)) {\n            if (itemName === 'attributes') {\n              value = dom.getAttrib(node, key);\n            } else {\n              value = getStyle(dom, node, key);\n            }\n\n            if (similar && !value && !format.exact) {\n              return;\n            }\n\n            if ((!similar || format.exact) && !isEq$2(value, normalizeStyleValue(dom, replaceVars(items[key], vars), key))) {\n              return;\n            }\n          }\n        }\n      } else {\n        for (i = 0; i < items.length; i++) {\n          if (itemName === 'attributes' ? dom.getAttrib(node, items[i]) : getStyle(dom, node, items[i])) {\n            return format;\n          }\n        }\n      }\n    }\n\n    return format;\n  };\n\n  var matchNode = function (ed, node, name, vars, similar) {\n    var formatList = ed.formatter.get(name);\n    var format, i, x, classes;\n    var dom = ed.dom;\n\n    if (formatList && node) {\n      for (i = 0; i < formatList.length; i++) {\n        format = formatList[i];\n\n        if (matchName(ed.dom, node, format) && matchItems(dom, node, format, 'attributes', similar, vars) && matchItems(dom, node, format, 'styles', similar, vars)) {\n          if (classes = format.classes) {\n            for (x = 0; x < classes.length; x++) {\n              if (!ed.dom.hasClass(node, replaceVars(classes[x], vars))) {\n                return;\n              }\n            }\n          }\n\n          return format;\n        }\n      }\n    }\n  };\n\n  var match = function (editor, name, vars, node) {\n    if (node) {\n      return matchParents(editor, node, name, vars);\n    }\n\n    node = editor.selection.getNode();\n\n    if (matchParents(editor, node, name, vars)) {\n      return true;\n    }\n\n    var startNode = editor.selection.getStart();\n\n    if (startNode !== node) {\n      if (matchParents(editor, startNode, name, vars)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var matchAll = function (editor, names, vars) {\n    var matchedFormatNames = [];\n    var checkedMap = {};\n    var startElement = editor.selection.getStart();\n    editor.dom.getParent(startElement, function (node) {\n      for (var i = 0; i < names.length; i++) {\n        var name_1 = names[i];\n\n        if (!checkedMap[name_1] && matchNode(editor, node, name_1, vars)) {\n          checkedMap[name_1] = true;\n          matchedFormatNames.push(name_1);\n        }\n      }\n    }, editor.dom.getRoot());\n    return matchedFormatNames;\n  };\n\n  var closest$3 = function (editor, names) {\n    var isRoot = function (elm) {\n      return eq$2(elm, SugarElement.fromDom(editor.getBody()));\n    };\n\n    var match = function (elm, name) {\n      return matchNode(editor, elm.dom, name) ? Optional.some(name) : Optional.none();\n    };\n\n    return Optional.from(editor.selection.getStart(true)).bind(function (rawElm) {\n      return closest$2(SugarElement.fromDom(rawElm), function (elm) {\n        return findMap(names, function (name) {\n          return match(elm, name);\n        });\n      }, isRoot);\n    }).getOrNull();\n  };\n\n  var canApply = function (editor, name) {\n    var formatList = editor.formatter.get(name);\n    var startNode, parents, i, x, selector;\n    var dom = editor.dom;\n\n    if (formatList) {\n      startNode = editor.selection.getStart();\n      parents = getParents$1(dom, startNode);\n\n      for (x = formatList.length - 1; x >= 0; x--) {\n        selector = formatList[x].selector;\n\n        if (!selector || formatList[x].defaultBlock) {\n          return true;\n        }\n\n        for (i = parents.length - 1; i >= 0; i--) {\n          if (dom.is(parents[i], selector)) {\n            return true;\n          }\n        }\n      }\n    }\n\n    return false;\n  };\n\n  var matchAllOnNode = function (editor, node, formatNames) {\n    return foldl(formatNames, function (acc, name) {\n      var matchSimilar = isVariableFormatName(editor, name);\n\n      if (editor.formatter.matchNode(node, name, {}, matchSimilar)) {\n        return acc.concat([name]);\n      } else {\n        return acc;\n      }\n    }, []);\n  };\n\n  var ZWSP$1 = ZWSP,\n      CARET_ID$1 = '_mce_caret';\n\n  var importNode = function (ownerDocument, node) {\n    return ownerDocument.importNode(node, true);\n  };\n\n  var getEmptyCaretContainers = function (node) {\n    var nodes = [];\n\n    while (node) {\n      if (node.nodeType === 3 && node.nodeValue !== ZWSP$1 || node.childNodes.length > 1) {\n        return [];\n      }\n\n      if (node.nodeType === 1) {\n        nodes.push(node);\n      }\n\n      node = node.firstChild;\n    }\n\n    return nodes;\n  };\n\n  var isCaretContainerEmpty = function (node) {\n    return getEmptyCaretContainers(node).length > 0;\n  };\n\n  var findFirstTextNode = function (node) {\n    if (node) {\n      var walker = new DomTreeWalker(node, node);\n\n      for (node = walker.current(); node; node = walker.next()) {\n        if (isText$1(node)) {\n          return node;\n        }\n      }\n    }\n\n    return null;\n  };\n\n  var createCaretContainer = function (fill) {\n    var caretContainer = SugarElement.fromTag('span');\n    setAll(caretContainer, {\n      'id': CARET_ID$1,\n      'data-mce-bogus': '1',\n      'data-mce-type': 'format-caret'\n    });\n\n    if (fill) {\n      append(caretContainer, SugarElement.fromText(ZWSP$1));\n    }\n\n    return caretContainer;\n  };\n\n  var trimZwspFromCaretContainer = function (caretContainerNode) {\n    var textNode = findFirstTextNode(caretContainerNode);\n\n    if (textNode && textNode.nodeValue.charAt(0) === ZWSP$1) {\n      textNode.deleteData(0, 1);\n    }\n\n    return textNode;\n  };\n\n  var removeCaretContainerNode = function (editor, node, moveCaret) {\n    if (moveCaret === void 0) {\n      moveCaret = true;\n    }\n\n    var dom = editor.dom,\n        selection = editor.selection;\n\n    if (isCaretContainerEmpty(node)) {\n      deleteElement(editor, false, SugarElement.fromDom(node), moveCaret);\n    } else {\n      var rng = selection.getRng();\n      var block = dom.getParent(node, dom.isBlock);\n      var startContainer = rng.startContainer;\n      var startOffset = rng.startOffset;\n      var endContainer = rng.endContainer;\n      var endOffset = rng.endOffset;\n      var textNode = trimZwspFromCaretContainer(node);\n      dom.remove(node, true);\n\n      if (startContainer === textNode && startOffset > 0) {\n        rng.setStart(textNode, startOffset - 1);\n      }\n\n      if (endContainer === textNode && endOffset > 0) {\n        rng.setEnd(textNode, endOffset - 1);\n      }\n\n      if (block && dom.isEmpty(block)) {\n        fillWithPaddingBr(SugarElement.fromDom(block));\n      }\n\n      selection.setRng(rng);\n    }\n  };\n\n  var removeCaretContainer = function (editor, node, moveCaret) {\n    if (moveCaret === void 0) {\n      moveCaret = true;\n    }\n\n    var dom = editor.dom,\n        selection = editor.selection;\n\n    if (!node) {\n      node = getParentCaretContainer(editor.getBody(), selection.getStart());\n\n      if (!node) {\n        while (node = dom.get(CARET_ID$1)) {\n          removeCaretContainerNode(editor, node, false);\n        }\n      }\n    } else {\n      removeCaretContainerNode(editor, node, moveCaret);\n    }\n  };\n\n  var insertCaretContainerNode = function (editor, caretContainer, formatNode) {\n    var dom = editor.dom,\n        block = dom.getParent(formatNode, curry(isTextBlock$1, editor));\n\n    if (block && dom.isEmpty(block)) {\n      formatNode.parentNode.replaceChild(caretContainer, formatNode);\n    } else {\n      removeTrailingBr(SugarElement.fromDom(formatNode));\n\n      if (dom.isEmpty(formatNode)) {\n        formatNode.parentNode.replaceChild(caretContainer, formatNode);\n      } else {\n        dom.insertAfter(caretContainer, formatNode);\n      }\n    }\n  };\n\n  var appendNode = function (parentNode, node) {\n    parentNode.appendChild(node);\n    return node;\n  };\n\n  var insertFormatNodesIntoCaretContainer = function (formatNodes, caretContainer) {\n    var innerMostFormatNode = foldr(formatNodes, function (parentNode, formatNode) {\n      return appendNode(parentNode, formatNode.cloneNode(false));\n    }, caretContainer);\n    return appendNode(innerMostFormatNode, innerMostFormatNode.ownerDocument.createTextNode(ZWSP$1));\n  };\n\n  var cleanFormatNode = function (editor, caretContainer, formatNode, name, vars, similar) {\n    var formatter = editor.formatter;\n    var dom = editor.dom;\n    var validFormats = filter(keys(formatter.get()), function (formatName) {\n      return formatName !== name && !contains$1(formatName, 'removeformat');\n    });\n    var matchedFormats = matchAllOnNode(editor, formatNode, validFormats);\n    var uniqueFormats = filter(matchedFormats, function (fmtName) {\n      return !areSimilarFormats(editor, fmtName, name);\n    });\n\n    if (uniqueFormats.length > 0) {\n      var clonedFormatNode = formatNode.cloneNode(false);\n      dom.add(caretContainer, clonedFormatNode);\n      formatter.remove(name, vars, clonedFormatNode, similar);\n      dom.remove(clonedFormatNode);\n      return Optional.some(clonedFormatNode);\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var applyCaretFormat = function (editor, name, vars) {\n    var caretContainer, textNode;\n    var selection = editor.selection;\n    var selectionRng = selection.getRng();\n    var offset = selectionRng.startOffset;\n    var container = selectionRng.startContainer;\n    var text = container.nodeValue;\n    caretContainer = getParentCaretContainer(editor.getBody(), selection.getStart());\n\n    if (caretContainer) {\n      textNode = findFirstTextNode(caretContainer);\n    }\n\n    var wordcharRegex = /[^\\s\\u00a0\\u00ad\\u200b\\ufeff]/;\n\n    if (text && offset > 0 && offset < text.length && wordcharRegex.test(text.charAt(offset)) && wordcharRegex.test(text.charAt(offset - 1))) {\n      var bookmark = selection.getBookmark();\n      selectionRng.collapse(true);\n      var rng = expandRng(editor, selectionRng, editor.formatter.get(name));\n      rng = split$1(rng);\n      editor.formatter.apply(name, vars, rng);\n      selection.moveToBookmark(bookmark);\n    } else {\n      if (!caretContainer || textNode.nodeValue !== ZWSP$1) {\n        caretContainer = importNode(editor.getDoc(), createCaretContainer(true).dom);\n        textNode = caretContainer.firstChild;\n        selectionRng.insertNode(caretContainer);\n        offset = 1;\n        editor.formatter.apply(name, vars, caretContainer);\n      } else {\n        editor.formatter.apply(name, vars, caretContainer);\n      }\n\n      selection.setCursorLocation(textNode, offset);\n    }\n  };\n\n  var removeCaretFormat = function (editor, name, vars, similar) {\n    var dom = editor.dom;\n    var selection = editor.selection;\n    var hasContentAfter, node, formatNode;\n    var parents = [];\n    var rng = selection.getRng();\n    var container = rng.startContainer;\n    var offset = rng.startOffset;\n    node = container;\n\n    if (container.nodeType === 3) {\n      if (offset !== container.nodeValue.length) {\n        hasContentAfter = true;\n      }\n\n      node = node.parentNode;\n    }\n\n    while (node) {\n      if (matchNode(editor, node, name, vars, similar)) {\n        formatNode = node;\n        break;\n      }\n\n      if (node.nextSibling) {\n        hasContentAfter = true;\n      }\n\n      parents.push(node);\n      node = node.parentNode;\n    }\n\n    if (!formatNode) {\n      return;\n    }\n\n    if (hasContentAfter) {\n      var bookmark = selection.getBookmark();\n      rng.collapse(true);\n      var expandedRng = expandRng(editor, rng, editor.formatter.get(name), true);\n      expandedRng = split$1(expandedRng);\n      editor.formatter.remove(name, vars, expandedRng, similar);\n      selection.moveToBookmark(bookmark);\n    } else {\n      var caretContainer = getParentCaretContainer(editor.getBody(), formatNode);\n      var newCaretContainer = createCaretContainer(false).dom;\n      insertCaretContainerNode(editor, newCaretContainer, caretContainer !== null ? caretContainer : formatNode);\n      var cleanedFormatNode = cleanFormatNode(editor, newCaretContainer, formatNode, name, vars, similar);\n      var caretTextNode = insertFormatNodesIntoCaretContainer(parents.concat(cleanedFormatNode.toArray()), newCaretContainer);\n      removeCaretContainerNode(editor, caretContainer, false);\n      selection.setCursorLocation(caretTextNode, 1);\n\n      if (dom.isEmpty(formatNode)) {\n        dom.remove(formatNode);\n      }\n    }\n  };\n\n  var disableCaretContainer = function (editor, keyCode) {\n    var selection = editor.selection,\n        body = editor.getBody();\n    removeCaretContainer(editor, null, false);\n\n    if ((keyCode === 8 || keyCode === 46) && selection.isCollapsed() && selection.getStart().innerHTML === ZWSP$1) {\n      removeCaretContainer(editor, getParentCaretContainer(body, selection.getStart()));\n    }\n\n    if (keyCode === 37 || keyCode === 39) {\n      removeCaretContainer(editor, getParentCaretContainer(body, selection.getStart()));\n    }\n  };\n\n  var setup$3 = function (editor) {\n    editor.on('mouseup keydown', function (e) {\n      disableCaretContainer(editor, e.keyCode);\n    });\n  };\n\n  var replaceWithCaretFormat = function (targetNode, formatNodes) {\n    var caretContainer = createCaretContainer(false);\n    var innerMost = insertFormatNodesIntoCaretContainer(formatNodes, caretContainer.dom);\n    before(SugarElement.fromDom(targetNode), caretContainer);\n    remove(SugarElement.fromDom(targetNode));\n    return CaretPosition(innerMost, 0);\n  };\n\n  var isFormatElement = function (editor, element) {\n    var inlineElements = editor.schema.getTextInlineElements();\n    return inlineElements.hasOwnProperty(name(element)) && !isCaretNode(element.dom) && !isBogus(element.dom);\n  };\n\n  var isEmptyCaretFormatElement = function (element) {\n    return isCaretNode(element.dom) && isCaretContainerEmpty(element.dom);\n  };\n\n  var postProcessHooks = {};\n  var filter$4 = filter$2;\n  var each$8 = each$2;\n\n  var addPostProcessHook = function (name, hook) {\n    var hooks = postProcessHooks[name];\n\n    if (!hooks) {\n      postProcessHooks[name] = [];\n    }\n\n    postProcessHooks[name].push(hook);\n  };\n\n  var postProcess = function (name, editor) {\n    each$8(postProcessHooks[name], function (hook) {\n      hook(editor);\n    });\n  };\n\n  addPostProcessHook('pre', function (editor) {\n    var rng = editor.selection.getRng();\n    var blocks;\n\n    var hasPreSibling = function (pre) {\n      return isPre(pre.previousSibling) && indexOf$1(blocks, pre.previousSibling) !== -1;\n    };\n\n    var joinPre = function (pre1, pre2) {\n      DomQuery(pre2).remove();\n      DomQuery(pre1).append('<br><br>').append(pre2.childNodes);\n    };\n\n    var isPre = matchNodeNames(['pre']);\n\n    if (!rng.collapsed) {\n      blocks = editor.selection.getSelectedBlocks();\n      each$8(filter$4(filter$4(blocks, isPre), hasPreSibling), function (pre) {\n        joinPre(pre.previousSibling, pre);\n      });\n    }\n  });\n  var each$9 = Tools.each;\n\n  var isElementNode = function (node) {\n    return isElement$1(node) && !isBookmarkNode$1(node) && !isCaretNode(node) && !isBogus(node);\n  };\n\n  var findElementSibling = function (node, siblingName) {\n    var sibling;\n\n    for (sibling = node; sibling; sibling = sibling[siblingName]) {\n      if (isText$1(sibling) && sibling.nodeValue.length !== 0) {\n        return node;\n      }\n\n      if (isElement$1(sibling) && !isBookmarkNode$1(sibling)) {\n        return sibling;\n      }\n    }\n\n    return node;\n  };\n\n  var mergeSiblingsNodes = function (dom, prev, next) {\n    var sibling, tmpSibling;\n    var elementUtils = ElementUtils(dom);\n\n    if (prev && next) {\n      prev = findElementSibling(prev, 'previousSibling');\n      next = findElementSibling(next, 'nextSibling');\n\n      if (elementUtils.compare(prev, next)) {\n        for (sibling = prev.nextSibling; sibling && sibling !== next;) {\n          tmpSibling = sibling;\n          sibling = sibling.nextSibling;\n          prev.appendChild(tmpSibling);\n        }\n\n        dom.remove(next);\n        Tools.each(Tools.grep(next.childNodes), function (node) {\n          prev.appendChild(node);\n        });\n        return prev;\n      }\n    }\n\n    return next;\n  };\n\n  var mergeSiblings = function (dom, format, vars, node) {\n    if (node && format.merge_siblings !== false) {\n      var newNode = mergeSiblingsNodes(dom, getNonWhiteSpaceSibling(node), node);\n      mergeSiblingsNodes(dom, newNode, getNonWhiteSpaceSibling(newNode, true));\n    }\n  };\n\n  var clearChildStyles = function (dom, format, node) {\n    if (format.clear_child_styles) {\n      var selector = format.links ? '*:not(a)' : '*';\n      each$9(dom.select(selector, node), function (node) {\n        if (isElementNode(node)) {\n          each$9(format.styles, function (value, name) {\n            dom.setStyle(node, name, '');\n          });\n        }\n      });\n    }\n  };\n\n  var processChildElements = function (node, filter, process) {\n    each$9(node.childNodes, function (node) {\n      if (isElementNode(node)) {\n        if (filter(node)) {\n          process(node);\n        }\n\n        if (node.hasChildNodes()) {\n          processChildElements(node, filter, process);\n        }\n      }\n    });\n  };\n\n  var unwrapEmptySpan = function (dom, node) {\n    if (node.nodeName === 'SPAN' && dom.getAttribs(node).length === 0) {\n      dom.remove(node, true);\n    }\n  };\n\n  var hasStyle = function (dom, name) {\n    return function (node) {\n      return !!(node && getStyle(dom, node, name));\n    };\n  };\n\n  var applyStyle = function (dom, name, value) {\n    return function (node) {\n      dom.setStyle(node, name, value);\n\n      if (node.getAttribute('style') === '') {\n        node.removeAttribute('style');\n      }\n\n      unwrapEmptySpan(dom, node);\n    };\n  };\n\n  var removeResult = Adt.generate([{\n    keep: []\n  }, {\n    rename: ['name']\n  }, {\n    removed: []\n  }]);\n  var MCE_ATTR_RE = /^(src|href|style)$/;\n  var each$a = Tools.each;\n  var isEq$3 = isEq;\n\n  var isTableCellOrRow = function (node) {\n    return /^(TR|TH|TD)$/.test(node.nodeName);\n  };\n\n  var isChildOfInlineParent = function (dom, node, parent) {\n    return dom.isChildOf(node, parent) && node !== parent && !dom.isBlock(parent);\n  };\n\n  var getContainer = function (ed, rng, start) {\n    var container, offset;\n    container = rng[start ? 'startContainer' : 'endContainer'];\n    offset = rng[start ? 'startOffset' : 'endOffset'];\n\n    if (isElement$1(container)) {\n      var lastIdx = container.childNodes.length - 1;\n\n      if (!start && offset) {\n        offset--;\n      }\n\n      container = container.childNodes[offset > lastIdx ? lastIdx : offset];\n    }\n\n    if (isText$1(container) && start && offset >= container.nodeValue.length) {\n      container = new DomTreeWalker(container, ed.getBody()).next() || container;\n    }\n\n    if (isText$1(container) && !start && offset === 0) {\n      container = new DomTreeWalker(container, ed.getBody()).prev() || container;\n    }\n\n    return container;\n  };\n\n  var normalizeTableSelection = function (node, start) {\n    var prop = start ? 'firstChild' : 'lastChild';\n\n    if (isTableCellOrRow(node) && node[prop]) {\n      var childNode = node[prop];\n\n      if (node.nodeName === 'TR') {\n        return childNode[prop] || childNode;\n      } else {\n        return childNode;\n      }\n    }\n\n    return node;\n  };\n\n  var wrap$2 = function (dom, node, name, attrs) {\n    var wrapper = dom.create(name, attrs);\n    node.parentNode.insertBefore(wrapper, node);\n    wrapper.appendChild(node);\n    return wrapper;\n  };\n\n  var wrapWithSiblings = function (dom, node, next, name, attrs) {\n    var start = SugarElement.fromDom(node);\n    var wrapper = SugarElement.fromDom(dom.create(name, attrs));\n    var siblings = next ? nextSiblings(start) : prevSiblings(start);\n    append$1(wrapper, siblings);\n\n    if (next) {\n      before(start, wrapper);\n      prepend(wrapper, start);\n    } else {\n      after(start, wrapper);\n      append(wrapper, start);\n    }\n\n    return wrapper.dom;\n  };\n\n  var matchName$1 = function (dom, node, format) {\n    if (isEq$3(node, format.inline)) {\n      return true;\n    }\n\n    if (isEq$3(node, format.block)) {\n      return true;\n    }\n\n    if (format.selector) {\n      return isElement$1(node) && dom.is(node, format.selector);\n    }\n  };\n\n  var isColorFormatAndAnchor = function (node, format) {\n    return format.links && node.nodeName === 'A';\n  };\n\n  var find$3 = function (dom, node, next, inc) {\n    node = getNonWhiteSpaceSibling(node, next, inc);\n    return !node || node.nodeName === 'BR' || dom.isBlock(node);\n  };\n\n  var removeNode$1 = function (ed, node, format) {\n    var parentNode = node.parentNode;\n    var rootBlockElm;\n    var dom = ed.dom,\n        forcedRootBlock = getForcedRootBlock(ed);\n\n    if (format.block) {\n      if (!forcedRootBlock) {\n        if (dom.isBlock(node) && !dom.isBlock(parentNode)) {\n          if (!find$3(dom, node, false) && !find$3(dom, node.firstChild, true, true)) {\n            node.insertBefore(dom.create('br'), node.firstChild);\n          }\n\n          if (!find$3(dom, node, true) && !find$3(dom, node.lastChild, false, true)) {\n            node.appendChild(dom.create('br'));\n          }\n        }\n      } else {\n        if (parentNode === dom.getRoot()) {\n          if (!format.list_block || !isEq$3(node, format.list_block)) {\n            each(from$1(node.childNodes), function (node) {\n              if (isValid(ed, forcedRootBlock, node.nodeName.toLowerCase())) {\n                if (!rootBlockElm) {\n                  rootBlockElm = wrap$2(dom, node, forcedRootBlock);\n                  dom.setAttribs(rootBlockElm, ed.settings.forced_root_block_attrs);\n                } else {\n                  rootBlockElm.appendChild(node);\n                }\n              } else {\n                rootBlockElm = 0;\n              }\n            });\n          }\n        }\n      }\n    }\n\n    if (format.selector && format.inline && !isEq$3(format.inline, node)) {\n      return;\n    }\n\n    dom.remove(node, true);\n  };\n\n  var removeFormatInternal = function (ed, format, vars, node, compareNode) {\n    var stylesModified;\n    var dom = ed.dom;\n\n    if (!matchName$1(dom, node, format) && !isColorFormatAndAnchor(node, format)) {\n      return removeResult.keep();\n    }\n\n    var elm = node;\n\n    if (format.inline && format.remove === 'all' && isArray(format.preserve_attributes)) {\n      var attrsToPreserve = filter(dom.getAttribs(elm), function (attr) {\n        return contains(format.preserve_attributes, attr.name.toLowerCase());\n      });\n      dom.removeAllAttribs(elm);\n      each(attrsToPreserve, function (attr) {\n        return dom.setAttrib(elm, attr.name, attr.value);\n      });\n\n      if (attrsToPreserve.length > 0) {\n        return removeResult.rename('span');\n      }\n    }\n\n    if (format.remove !== 'all') {\n      each$a(format.styles, function (value, name) {\n        value = normalizeStyleValue(dom, replaceVars(value, vars), name + '');\n\n        if (isNumber(name)) {\n          name = value;\n          compareNode = null;\n        }\n\n        if (format.remove_similar || !compareNode || isEq$3(getStyle(dom, compareNode, name), value)) {\n          dom.setStyle(elm, name, '');\n        }\n\n        stylesModified = true;\n      });\n\n      if (stylesModified && dom.getAttrib(elm, 'style') === '') {\n        elm.removeAttribute('style');\n        elm.removeAttribute('data-mce-style');\n      }\n\n      each$a(format.attributes, function (value, name) {\n        var valueOut;\n        value = replaceVars(value, vars);\n\n        if (isNumber(name)) {\n          name = value;\n          compareNode = null;\n        }\n\n        if (format.remove_similar || !compareNode || isEq$3(dom.getAttrib(compareNode, name), value)) {\n          if (name === 'class') {\n            value = dom.getAttrib(elm, name);\n\n            if (value) {\n              valueOut = '';\n              each(value.split(/\\s+/), function (cls) {\n                if (/mce\\-\\w+/.test(cls)) {\n                  valueOut += (valueOut ? ' ' : '') + cls;\n                }\n              });\n\n              if (valueOut) {\n                dom.setAttrib(elm, name, valueOut);\n                return;\n              }\n            }\n          }\n\n          if (MCE_ATTR_RE.test(name)) {\n            elm.removeAttribute('data-mce-' + name);\n          }\n\n          if (name === 'style' && matchNodeNames(['li'])(elm) && dom.getStyle(elm, 'list-style-type') === 'none') {\n            elm.removeAttribute(name);\n            dom.setStyle(elm, 'list-style-type', 'none');\n            return;\n          }\n\n          if (name === 'class') {\n            elm.removeAttribute('className');\n          }\n\n          elm.removeAttribute(name);\n        }\n      });\n      each$a(format.classes, function (value) {\n        value = replaceVars(value, vars);\n\n        if (!compareNode || dom.hasClass(compareNode, value)) {\n          dom.removeClass(elm, value);\n        }\n      });\n      var attrs = dom.getAttribs(elm);\n\n      for (var i = 0; i < attrs.length; i++) {\n        var attrName = attrs[i].nodeName;\n\n        if (attrName.indexOf('_') !== 0 && attrName.indexOf('data-') !== 0) {\n          return removeResult.keep();\n        }\n      }\n    }\n\n    if (format.remove !== 'none') {\n      removeNode$1(ed, elm, format);\n      return removeResult.removed();\n    }\n\n    return removeResult.keep();\n  };\n\n  var removeFormat = function (ed, format, vars, node, compareNode) {\n    return removeFormatInternal(ed, format, vars, node, compareNode).fold(never, function (newName) {\n      ed.dom.rename(node, newName);\n      return true;\n    }, always);\n  };\n\n  var findFormatRoot = function (editor, container, name, vars, similar) {\n    var formatRoot;\n    each(getParents$1(editor.dom, container.parentNode).reverse(), function (parent) {\n      if (!formatRoot && parent.id !== '_start' && parent.id !== '_end') {\n        var format = matchNode(editor, parent, name, vars, similar);\n\n        if (format && format.split !== false) {\n          formatRoot = parent;\n        }\n      }\n    });\n    return formatRoot;\n  };\n\n  var removeFormatFromClone = function (editor, format, vars, clone) {\n    return removeFormatInternal(editor, format, vars, clone, clone).fold(constant(clone), function (newName) {\n      var fragment = editor.dom.createFragment();\n      fragment.appendChild(clone);\n      return editor.dom.rename(clone, newName);\n    }, constant(null));\n  };\n\n  var wrapAndSplit = function (editor, formatList, formatRoot, container, target, split, format, vars) {\n    var clone, lastClone, firstClone;\n    var dom = editor.dom;\n\n    if (formatRoot) {\n      var formatRootParent = formatRoot.parentNode;\n\n      for (var parent_1 = container.parentNode; parent_1 && parent_1 !== formatRootParent; parent_1 = parent_1.parentNode) {\n        clone = dom.clone(parent_1, false);\n\n        for (var i = 0; i < formatList.length; i++) {\n          clone = removeFormatFromClone(editor, formatList[i], vars, clone);\n\n          if (clone === null) {\n            break;\n          }\n        }\n\n        if (clone) {\n          if (lastClone) {\n            clone.appendChild(lastClone);\n          }\n\n          if (!firstClone) {\n            firstClone = clone;\n          }\n\n          lastClone = clone;\n        }\n      }\n\n      if (split && (!format.mixed || !dom.isBlock(formatRoot))) {\n        container = dom.split(formatRoot, container);\n      }\n\n      if (lastClone) {\n        target.parentNode.insertBefore(lastClone, target);\n        firstClone.appendChild(target);\n\n        if (format.inline) {\n          mergeSiblings(dom, format, vars, lastClone);\n        }\n      }\n    }\n\n    return container;\n  };\n\n  var remove$6 = function (ed, name, vars, node, similar) {\n    var formatList = ed.formatter.get(name);\n    var format = formatList[0];\n    var contentEditable = true;\n    var dom = ed.dom;\n    var selection = ed.selection;\n\n    var splitToFormatRoot = function (container) {\n      var formatRoot = findFormatRoot(ed, container, name, vars, similar);\n      return wrapAndSplit(ed, formatList, formatRoot, container, container, true, format, vars);\n    };\n\n    var isRemoveBookmarkNode = function (node) {\n      return isBookmarkNode$1(node) && isElement$1(node) && (node.id === '_start' || node.id === '_end');\n    };\n\n    var process = function (node) {\n      var lastContentEditable, hasContentEditableState;\n      var parentNode = node.parentNode;\n\n      if (isText$1(node) && hasBlockChildren(dom, parentNode)) {\n        removeFormat(ed, format, vars, parentNode, parentNode);\n      }\n\n      if (isElement$1(node) && dom.getContentEditable(node)) {\n        lastContentEditable = contentEditable;\n        contentEditable = dom.getContentEditable(node) === 'true';\n        hasContentEditableState = true;\n      }\n\n      var children = from$1(node.childNodes);\n\n      if (contentEditable && !hasContentEditableState) {\n        for (var i = 0; i < formatList.length; i++) {\n          if (removeFormat(ed, formatList[i], vars, node, node)) {\n            break;\n          }\n        }\n      }\n\n      if (format.deep) {\n        if (children.length) {\n          for (var i = 0; i < children.length; i++) {\n            process(children[i]);\n          }\n\n          if (hasContentEditableState) {\n            contentEditable = lastContentEditable;\n          }\n        }\n      }\n    };\n\n    var unwrap = function (start) {\n      var node = dom.get(start ? '_start' : '_end');\n      var out = node[start ? 'firstChild' : 'lastChild'];\n\n      if (isRemoveBookmarkNode(out)) {\n        out = out[start ? 'firstChild' : 'lastChild'];\n      }\n\n      if (isText$1(out) && out.data.length === 0) {\n        out = start ? node.previousSibling || node.nextSibling : node.nextSibling || node.previousSibling;\n      }\n\n      dom.remove(node, true);\n      return out;\n    };\n\n    var removeRngStyle = function (rng) {\n      var startContainer, endContainer;\n      var expandedRng = expandRng(ed, rng, formatList, rng.collapsed);\n\n      if (format.split) {\n        expandedRng = split$1(expandedRng);\n        startContainer = getContainer(ed, expandedRng, true);\n        endContainer = getContainer(ed, expandedRng);\n\n        if (startContainer !== endContainer) {\n          startContainer = normalizeTableSelection(startContainer, true);\n          endContainer = normalizeTableSelection(endContainer, false);\n\n          if (isChildOfInlineParent(dom, startContainer, endContainer)) {\n            var marker = Optional.from(startContainer.firstChild).getOr(startContainer);\n            splitToFormatRoot(wrapWithSiblings(dom, marker, true, 'span', {\n              'id': '_start',\n              'data-mce-type': 'bookmark'\n            }));\n            unwrap(true);\n            return;\n          }\n\n          if (isChildOfInlineParent(dom, endContainer, startContainer)) {\n            var marker = Optional.from(endContainer.lastChild).getOr(endContainer);\n            splitToFormatRoot(wrapWithSiblings(dom, marker, false, 'span', {\n              'id': '_end',\n              'data-mce-type': 'bookmark'\n            }));\n            unwrap(false);\n            return;\n          }\n\n          startContainer = wrap$2(dom, startContainer, 'span', {\n            'id': '_start',\n            'data-mce-type': 'bookmark'\n          });\n          endContainer = wrap$2(dom, endContainer, 'span', {\n            'id': '_end',\n            'data-mce-type': 'bookmark'\n          });\n          var newRng = dom.createRng();\n          newRng.setStartAfter(startContainer);\n          newRng.setEndBefore(endContainer);\n          walk$1(dom, newRng, function (nodes) {\n            each(nodes, function (n) {\n              if (!isBookmarkNode$1(n) && !isBookmarkNode$1(n.parentNode)) {\n                splitToFormatRoot(n);\n              }\n            });\n          });\n          splitToFormatRoot(startContainer);\n          splitToFormatRoot(endContainer);\n          startContainer = unwrap(true);\n          endContainer = unwrap();\n        } else {\n          startContainer = endContainer = splitToFormatRoot(startContainer);\n        }\n\n        expandedRng.startContainer = startContainer.parentNode ? startContainer.parentNode : startContainer;\n        expandedRng.startOffset = dom.nodeIndex(startContainer);\n        expandedRng.endContainer = endContainer.parentNode ? endContainer.parentNode : endContainer;\n        expandedRng.endOffset = dom.nodeIndex(endContainer) + 1;\n      }\n\n      walk$1(dom, expandedRng, function (nodes) {\n        each(nodes, function (node) {\n          process(node);\n          var textDecorations = ['underline', 'line-through', 'overline'];\n          each(textDecorations, function (decoration) {\n            if (isElement$1(node) && ed.dom.getStyle(node, 'text-decoration') === decoration && node.parentNode && getTextDecoration(dom, node.parentNode) === decoration) {\n              removeFormat(ed, {\n                deep: false,\n                exact: true,\n                inline: 'span',\n                styles: {\n                  textDecoration: decoration\n                }\n              }, null, node);\n            }\n          });\n        });\n      });\n    };\n\n    if (node) {\n      if (isNode(node)) {\n        var rng = dom.createRng();\n        rng.setStartBefore(node);\n        rng.setEndAfter(node);\n        removeRngStyle(rng);\n      } else {\n        removeRngStyle(node);\n      }\n\n      return;\n    }\n\n    if (dom.getContentEditable(selection.getNode()) === 'false') {\n      node = selection.getNode();\n\n      for (var i = 0; i < formatList.length; i++) {\n        if (formatList[i].ceFalseOverride) {\n          if (removeFormat(ed, formatList[i], vars, node, node)) {\n            break;\n          }\n        }\n      }\n\n      return;\n    }\n\n    if (!selection.isCollapsed() || !format.inline || getCellsFromEditor(ed).length) {\n      preserve(selection, true, function () {\n        runOnRanges(ed, removeRngStyle);\n      });\n\n      if (format.inline && match(ed, name, vars, selection.getStart())) {\n        moveStart(dom, selection, selection.getRng());\n      }\n\n      ed.nodeChanged();\n    } else {\n      removeCaretFormat(ed, name, vars, similar);\n    }\n  };\n\n  var each$b = Tools.each;\n\n  var mergeTextDecorationsAndColor = function (dom, format, vars, node) {\n    var processTextDecorationsAndColor = function (n) {\n      if (n.nodeType === 1 && n.parentNode && n.parentNode.nodeType === 1) {\n        var textDecoration = getTextDecoration(dom, n.parentNode);\n\n        if (dom.getStyle(n, 'color') && textDecoration) {\n          dom.setStyle(n, 'text-decoration', textDecoration);\n        } else if (dom.getStyle(n, 'text-decoration') === textDecoration) {\n          dom.setStyle(n, 'text-decoration', null);\n        }\n      }\n    };\n\n    if (format.styles && (format.styles.color || format.styles.textDecoration)) {\n      Tools.walk(node, processTextDecorationsAndColor, 'childNodes');\n      processTextDecorationsAndColor(node);\n    }\n  };\n\n  var mergeBackgroundColorAndFontSize = function (dom, format, vars, node) {\n    if (format.styles && format.styles.backgroundColor) {\n      processChildElements(node, hasStyle(dom, 'fontSize'), applyStyle(dom, 'backgroundColor', replaceVars(format.styles.backgroundColor, vars)));\n    }\n  };\n\n  var mergeSubSup = function (dom, format, vars, node) {\n    if (format.inline === 'sub' || format.inline === 'sup') {\n      processChildElements(node, hasStyle(dom, 'fontSize'), applyStyle(dom, 'fontSize', ''));\n      dom.remove(dom.select(format.inline === 'sup' ? 'sub' : 'sup', node), true);\n    }\n  };\n\n  var mergeWithChildren = function (editor, formatList, vars, node) {\n    each$b(formatList, function (format) {\n      each$b(editor.dom.select(format.inline, node), function (child) {\n        if (!isElementNode(child)) {\n          return;\n        }\n\n        removeFormat(editor, format, vars, child, format.exact ? child : null);\n      });\n      clearChildStyles(editor.dom, format, node);\n    });\n  };\n\n  var mergeWithParents = function (editor, format, name, vars, node) {\n    if (matchNode(editor, node.parentNode, name, vars)) {\n      if (removeFormat(editor, format, vars, node)) {\n        return;\n      }\n    }\n\n    if (format.merge_with_parents) {\n      editor.dom.getParent(node.parentNode, function (parent) {\n        if (matchNode(editor, parent, name, vars)) {\n          removeFormat(editor, format, vars, node);\n          return true;\n        }\n      });\n    }\n  };\n\n  var each$c = Tools.each;\n\n  var hasFormatProperty = function (format, prop) {\n    return hasNonNullableKey(format, prop);\n  };\n\n  var isElementNode$1 = function (node) {\n    return node && node.nodeType === 1 && !isBookmarkNode$1(node) && !isCaretNode(node) && !isBogus(node);\n  };\n\n  var canFormatBR = function (editor, format, node, parentName) {\n    if (canFormatEmptyLines(editor) && isInlineFormat(format)) {\n      var validBRParentElements = __assign(__assign({}, editor.schema.getTextBlockElements()), {\n        td: {},\n        th: {},\n        li: {},\n        dt: {},\n        dd: {},\n        figcaption: {},\n        caption: {},\n        details: {},\n        summary: {}\n      });\n\n      var hasCaretNodeSibling = sibling$2(SugarElement.fromDom(node), function (sibling) {\n        return isCaretNode(sibling.dom);\n      });\n      return hasNonNullableKey(validBRParentElements, parentName) && isEmpty(SugarElement.fromDom(node.parentNode), false) && !hasCaretNodeSibling;\n    } else {\n      return false;\n    }\n  };\n\n  var applyFormat = function (ed, name, vars, node) {\n    var formatList = ed.formatter.get(name);\n    var format = formatList[0];\n    var isCollapsed = !node && ed.selection.isCollapsed();\n    var dom = ed.dom;\n    var selection = ed.selection;\n\n    var setElementFormat = function (elm, fmt) {\n      fmt = fmt || format;\n\n      if (elm) {\n        if (fmt.onformat) {\n          fmt.onformat(elm, fmt, vars, node);\n        }\n\n        each$c(fmt.styles, function (value, name) {\n          dom.setStyle(elm, name, replaceVars(value, vars));\n        });\n\n        if (fmt.styles) {\n          var styleVal = dom.getAttrib(elm, 'style');\n\n          if (styleVal) {\n            dom.setAttrib(elm, 'data-mce-style', styleVal);\n          }\n        }\n\n        each$c(fmt.attributes, function (value, name) {\n          dom.setAttrib(elm, name, replaceVars(value, vars));\n        });\n        each$c(fmt.classes, function (value) {\n          value = replaceVars(value, vars);\n\n          if (!dom.hasClass(elm, value)) {\n            dom.addClass(elm, value);\n          }\n        });\n      }\n    };\n\n    var applyNodeStyle = function (formatList, node) {\n      var found = false;\n\n      if (!isSelectorFormat(format)) {\n        return false;\n      }\n\n      each$c(formatList, function (format) {\n        if ('collapsed' in format && format.collapsed !== isCollapsed) {\n          return;\n        }\n\n        if (dom.is(node, format.selector) && !isCaretNode(node)) {\n          setElementFormat(node, format);\n          found = true;\n          return false;\n        }\n      });\n      return found;\n    };\n\n    var applyRngStyle = function (dom, rng, bookmark, nodeSpecific) {\n      var newWrappers = [];\n      var contentEditable = true;\n      var wrapName = format.inline || format.block;\n      var wrapElm = dom.create(wrapName);\n      setElementFormat(wrapElm);\n      walk$1(dom, rng, function (nodes) {\n        var currentWrapElm;\n\n        var process = function (node) {\n          var hasContentEditableState = false;\n          var lastContentEditable = contentEditable;\n          var nodeName = node.nodeName.toLowerCase();\n          var parentName = node.parentNode.nodeName.toLowerCase();\n\n          if (isElement$1(node) && dom.getContentEditable(node)) {\n            lastContentEditable = contentEditable;\n            contentEditable = dom.getContentEditable(node) === 'true';\n            hasContentEditableState = true;\n          }\n\n          if (isBr(node) && !canFormatBR(ed, format, node, parentName)) {\n            currentWrapElm = null;\n\n            if (isBlockFormat(format)) {\n              dom.remove(node);\n            }\n\n            return;\n          }\n\n          if (format.wrapper && matchNode(ed, node, name, vars)) {\n            currentWrapElm = null;\n            return;\n          }\n\n          if (contentEditable && !hasContentEditableState && isBlockFormat(format) && !format.wrapper && isTextBlock$1(ed, nodeName) && isValid(ed, parentName, wrapName)) {\n            var elm = dom.rename(node, wrapName);\n            setElementFormat(elm);\n            newWrappers.push(elm);\n            currentWrapElm = null;\n            return;\n          }\n\n          if (isSelectorFormat(format)) {\n            var found = applyNodeStyle(formatList, node);\n\n            if (isText$1(node) && hasBlockChildren(dom, node.parentNode)) {\n              applyNodeStyle(formatList, node.parentNode);\n            }\n\n            if (!hasFormatProperty(format, 'inline') || found) {\n              currentWrapElm = null;\n              return;\n            }\n          }\n\n          if (contentEditable && !hasContentEditableState && isValid(ed, wrapName, nodeName) && isValid(ed, parentName, wrapName) && !(!nodeSpecific && node.nodeType === 3 && node.nodeValue.length === 1 && node.nodeValue.charCodeAt(0) === 65279) && !isCaretNode(node) && (!hasFormatProperty(format, 'inline') || !dom.isBlock(node))) {\n            if (!currentWrapElm) {\n              currentWrapElm = dom.clone(wrapElm, false);\n              node.parentNode.insertBefore(currentWrapElm, node);\n              newWrappers.push(currentWrapElm);\n            }\n\n            currentWrapElm.appendChild(node);\n          } else {\n            currentWrapElm = null;\n            each$c(Tools.grep(node.childNodes), process);\n\n            if (hasContentEditableState) {\n              contentEditable = lastContentEditable;\n            }\n\n            currentWrapElm = null;\n          }\n        };\n\n        each$c(nodes, process);\n      });\n\n      if (format.links === true) {\n        each$c(newWrappers, function (node) {\n          var process = function (node) {\n            if (node.nodeName === 'A') {\n              setElementFormat(node, format);\n            }\n\n            each$c(Tools.grep(node.childNodes), process);\n          };\n\n          process(node);\n        });\n      }\n\n      each$c(newWrappers, function (node) {\n        var getChildCount = function (node) {\n          var count = 0;\n          each$c(node.childNodes, function (node) {\n            if (!isEmptyTextNode(node) && !isBookmarkNode$1(node)) {\n              count++;\n            }\n          });\n          return count;\n        };\n\n        var getChildElementNode = function (root) {\n          var child = false;\n          each$c(root.childNodes, function (node) {\n            if (isElementNode$1(node)) {\n              child = node;\n              return false;\n            }\n          });\n          return child;\n        };\n\n        var mergeStyles = function (node) {\n          var clone;\n          var child = getChildElementNode(node);\n\n          if (child && !isBookmarkNode$1(child) && matchName(dom, child, format)) {\n            clone = dom.clone(child, false);\n            setElementFormat(clone);\n            dom.replace(clone, node, true);\n            dom.remove(child, true);\n          }\n\n          return clone || node;\n        };\n\n        var childCount = getChildCount(node);\n\n        if ((newWrappers.length > 1 || !dom.isBlock(node)) && childCount === 0) {\n          dom.remove(node, true);\n          return;\n        }\n\n        if (isInlineFormat(format) || format.wrapper) {\n          if (!format.exact && childCount === 1) {\n            node = mergeStyles(node);\n          }\n\n          mergeWithChildren(ed, formatList, vars, node);\n          mergeWithParents(ed, format, name, vars, node);\n          mergeBackgroundColorAndFontSize(dom, format, vars, node);\n          mergeTextDecorationsAndColor(dom, format, vars, node);\n          mergeSubSup(dom, format, vars, node);\n          mergeSiblings(dom, format, vars, node);\n        }\n      });\n    };\n\n    if (dom.getContentEditable(selection.getNode()) === 'false') {\n      node = selection.getNode();\n\n      for (var i = 0, l = formatList.length; i < l; i++) {\n        var formatItem = formatList[i];\n\n        if (formatItem.ceFalseOverride && isSelectorFormat(formatItem) && dom.is(node, formatItem.selector)) {\n          setElementFormat(node, formatItem);\n          return;\n        }\n      }\n\n      return;\n    }\n\n    if (format) {\n      if (node) {\n        if (isNode(node)) {\n          if (!applyNodeStyle(formatList, node)) {\n            var rng = dom.createRng();\n            rng.setStartBefore(node);\n            rng.setEndAfter(node);\n            applyRngStyle(dom, expandRng(ed, rng, formatList), null, true);\n          }\n        } else {\n          applyRngStyle(dom, node, null, true);\n        }\n      } else {\n        if (!isCollapsed || !isInlineFormat(format) || getCellsFromEditor(ed).length) {\n          var curSelNode = selection.getNode();\n          var firstFormat = formatList[0];\n\n          if (!ed.settings.forced_root_block && firstFormat.defaultBlock && !dom.getParent(curSelNode, dom.isBlock)) {\n            applyFormat(ed, firstFormat.defaultBlock);\n          }\n\n          selection.setRng(normalize$2(selection.getRng()));\n          preserve(selection, true, function (bookmark) {\n            runOnRanges(ed, function (selectionRng, fake) {\n              var expandedRng = fake ? selectionRng : expandRng(ed, selectionRng, formatList);\n              applyRngStyle(dom, expandedRng);\n            });\n          });\n          moveStart(dom, selection, selection.getRng());\n          ed.nodeChanged();\n        } else {\n          applyCaretFormat(ed, name, vars);\n        }\n      }\n\n      postProcess(name, ed);\n    }\n  };\n\n  var setup$4 = function (registeredFormatListeners, editor) {\n    var currentFormats = Cell({});\n    registeredFormatListeners.set({});\n    editor.on('NodeChange', function (e) {\n      updateAndFireChangeCallbacks(editor, e.element, currentFormats, registeredFormatListeners.get());\n    });\n  };\n\n  var updateAndFireChangeCallbacks = function (editor, elm, currentFormats, formatChangeData) {\n    var formatsList = keys(currentFormats.get());\n    var newFormats = {};\n    var matchedFormats = {};\n    var parents = filter(getParents$1(editor.dom, elm), function (node) {\n      return node.nodeType === 1 && !node.getAttribute('data-mce-bogus');\n    });\n    each$1(formatChangeData, function (data, format) {\n      Tools.each(parents, function (node) {\n        if (editor.formatter.matchNode(node, format, {}, data.similar)) {\n          if (formatsList.indexOf(format) === -1) {\n            each(data.callbacks, function (callback) {\n              callback(true, {\n                node: node,\n                format: format,\n                parents: parents\n              });\n            });\n            newFormats[format] = data.callbacks;\n          }\n\n          matchedFormats[format] = data.callbacks;\n          return false;\n        }\n\n        if (matchesUnInheritedFormatSelector(editor, node, format)) {\n          return false;\n        }\n      });\n    });\n    var remainingFormats = filterRemainingFormats(currentFormats.get(), matchedFormats, elm, parents);\n    currentFormats.set(__assign(__assign({}, newFormats), remainingFormats));\n  };\n\n  var filterRemainingFormats = function (currentFormats, matchedFormats, elm, parents) {\n    return bifilter(currentFormats, function (callbacks, format) {\n      if (!has(matchedFormats, format)) {\n        each(callbacks, function (callback) {\n          callback(false, {\n            node: elm,\n            format: format,\n            parents: parents\n          });\n        });\n        return false;\n      } else {\n        return true;\n      }\n    }).t;\n  };\n\n  var addListeners = function (registeredFormatListeners, formats, callback, similar) {\n    var formatChangeItems = registeredFormatListeners.get();\n    each(formats.split(','), function (format) {\n      if (!formatChangeItems[format]) {\n        formatChangeItems[format] = {\n          similar: similar,\n          callbacks: []\n        };\n      }\n\n      formatChangeItems[format].callbacks.push(callback);\n    });\n    registeredFormatListeners.set(formatChangeItems);\n  };\n\n  var removeListeners = function (registeredFormatListeners, formats, callback) {\n    var formatChangeItems = registeredFormatListeners.get();\n    each(formats.split(','), function (format) {\n      formatChangeItems[format].callbacks = filter(formatChangeItems[format].callbacks, function (c) {\n        return c !== callback;\n      });\n\n      if (formatChangeItems[format].callbacks.length === 0) {\n        delete formatChangeItems[format];\n      }\n    });\n    registeredFormatListeners.set(formatChangeItems);\n  };\n\n  var formatChangedInternal = function (editor, registeredFormatListeners, formats, callback, similar) {\n    if (registeredFormatListeners.get() === null) {\n      setup$4(registeredFormatListeners, editor);\n    }\n\n    addListeners(registeredFormatListeners, formats, callback, similar);\n    return {\n      unbind: function () {\n        return removeListeners(registeredFormatListeners, formats, callback);\n      }\n    };\n  };\n\n  var toggle = function (editor, name, vars, node) {\n    var fmt = editor.formatter.get(name);\n\n    if (match(editor, name, vars, node) && (!('toggle' in fmt[0]) || fmt[0].toggle)) {\n      remove$6(editor, name, vars, node);\n    } else {\n      applyFormat(editor, name, vars, node);\n    }\n  };\n\n  var fromElements = function (elements, scope) {\n    var doc = scope || document;\n    var fragment = doc.createDocumentFragment();\n    each(elements, function (element) {\n      fragment.appendChild(element.dom);\n    });\n    return SugarElement.fromDom(fragment);\n  };\n\n  var tableModel = function (element, width, rows) {\n    return {\n      element: element,\n      width: width,\n      rows: rows\n    };\n  };\n\n  var tableRow = function (element, cells) {\n    return {\n      element: element,\n      cells: cells\n    };\n  };\n\n  var cellPosition = function (x, y) {\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  var getSpan = function (td, key) {\n    var value = parseInt(get$4(td, key), 10);\n    return isNaN(value) ? 1 : value;\n  };\n\n  var fillout = function (table, x, y, tr, td) {\n    var rowspan = getSpan(td, 'rowspan');\n    var colspan = getSpan(td, 'colspan');\n    var rows = table.rows;\n\n    for (var y2 = y; y2 < y + rowspan; y2++) {\n      if (!rows[y2]) {\n        rows[y2] = tableRow(deep(tr), []);\n      }\n\n      for (var x2 = x; x2 < x + colspan; x2++) {\n        var cells = rows[y2].cells;\n        cells[x2] = y2 === y && x2 === x ? td : shallow(td);\n      }\n    }\n  };\n\n  var cellExists = function (table, x, y) {\n    var rows = table.rows;\n    var cells = rows[y] ? rows[y].cells : [];\n    return !!cells[x];\n  };\n\n  var skipCellsX = function (table, x, y) {\n    while (cellExists(table, x, y)) {\n      x++;\n    }\n\n    return x;\n  };\n\n  var getWidth = function (rows) {\n    return foldl(rows, function (acc, row) {\n      return row.cells.length > acc ? row.cells.length : acc;\n    }, 0);\n  };\n\n  var findElementPos = function (table, element) {\n    var rows = table.rows;\n\n    for (var y = 0; y < rows.length; y++) {\n      var cells = rows[y].cells;\n\n      for (var x = 0; x < cells.length; x++) {\n        if (eq$2(cells[x], element)) {\n          return Optional.some(cellPosition(x, y));\n        }\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var extractRows = function (table, sx, sy, ex, ey) {\n    var newRows = [];\n    var rows = table.rows;\n\n    for (var y = sy; y <= ey; y++) {\n      var cells = rows[y].cells;\n      var slice = sx < ex ? cells.slice(sx, ex + 1) : cells.slice(ex, sx + 1);\n      newRows.push(tableRow(rows[y].element, slice));\n    }\n\n    return newRows;\n  };\n\n  var subTable = function (table, startPos, endPos) {\n    var sx = startPos.x,\n        sy = startPos.y;\n    var ex = endPos.x,\n        ey = endPos.y;\n    var newRows = sy < ey ? extractRows(table, sx, sy, ex, ey) : extractRows(table, sx, ey, ex, sy);\n    return tableModel(table.element, getWidth(newRows), newRows);\n  };\n\n  var createDomTable = function (table, rows) {\n    var tableElement = shallow(table.element);\n    var tableBody = SugarElement.fromTag('tbody');\n    append$1(tableBody, rows);\n    append(tableElement, tableBody);\n    return tableElement;\n  };\n\n  var modelRowsToDomRows = function (table) {\n    return map(table.rows, function (row) {\n      var cells = map(row.cells, function (cell) {\n        var td = deep(cell);\n        remove$1(td, 'colspan');\n        remove$1(td, 'rowspan');\n        return td;\n      });\n      var tr = shallow(row.element);\n      append$1(tr, cells);\n      return tr;\n    });\n  };\n\n  var fromDom$1 = function (tableElm) {\n    var table = tableModel(shallow(tableElm), 0, []);\n    each(descendants$1(tableElm, 'tr'), function (tr, y) {\n      each(descendants$1(tr, 'td,th'), function (td, x) {\n        fillout(table, skipCellsX(table, x, y), y, tr, td);\n      });\n    });\n    return tableModel(table.element, getWidth(table.rows), table.rows);\n  };\n\n  var toDom = function (table) {\n    return createDomTable(table, modelRowsToDomRows(table));\n  };\n\n  var subsection = function (table, startElement, endElement) {\n    return findElementPos(table, startElement).bind(function (startPos) {\n      return findElementPos(table, endElement).map(function (endPos) {\n        return subTable(table, startPos, endPos);\n      });\n    });\n  };\n\n  var findParentListContainer = function (parents) {\n    return find(parents, function (elm) {\n      return name(elm) === 'ul' || name(elm) === 'ol';\n    });\n  };\n\n  var getFullySelectedListWrappers = function (parents, rng) {\n    return find(parents, function (elm) {\n      return name(elm) === 'li' && hasAllContentsSelected(elm, rng);\n    }).fold(constant([]), function (_li) {\n      return findParentListContainer(parents).map(function (listCont) {\n        var listElm = SugarElement.fromTag(name(listCont));\n        var listStyles = filter$1(getAllRaw(listCont), function (_style, name) {\n          return startsWith(name, 'list-style');\n        });\n        setAll$1(listElm, listStyles);\n        return [SugarElement.fromTag('li'), listElm];\n      }).getOr([]);\n    });\n  };\n\n  var wrap$3 = function (innerElm, elms) {\n    var wrapped = foldl(elms, function (acc, elm) {\n      append(elm, acc);\n      return elm;\n    }, innerElm);\n    return elms.length > 0 ? fromElements([wrapped]) : wrapped;\n  };\n\n  var directListWrappers = function (commonAnchorContainer) {\n    if (isListItem(commonAnchorContainer)) {\n      return parent(commonAnchorContainer).filter(isList).fold(constant([]), function (listElm) {\n        return [commonAnchorContainer, listElm];\n      });\n    } else {\n      return isList(commonAnchorContainer) ? [commonAnchorContainer] : [];\n    }\n  };\n\n  var getWrapElements = function (rootNode, rng) {\n    var commonAnchorContainer = SugarElement.fromDom(rng.commonAncestorContainer);\n    var parents = parentsAndSelf(commonAnchorContainer, rootNode);\n    var wrapElements = filter(parents, function (elm) {\n      return isInline(elm) || isHeading(elm);\n    });\n    var listWrappers = getFullySelectedListWrappers(parents, rng);\n    var allWrappers = wrapElements.concat(listWrappers.length ? listWrappers : directListWrappers(commonAnchorContainer));\n    return map(allWrappers, shallow);\n  };\n\n  var emptyFragment = function () {\n    return fromElements([]);\n  };\n\n  var getFragmentFromRange = function (rootNode, rng) {\n    return wrap$3(SugarElement.fromDom(rng.cloneContents()), getWrapElements(rootNode, rng));\n  };\n\n  var getParentTable = function (rootElm, cell) {\n    return ancestor$1(cell, 'table', curry(eq$2, rootElm));\n  };\n\n  var getTableFragment = function (rootNode, selectedTableCells) {\n    return getParentTable(rootNode, selectedTableCells[0]).bind(function (tableElm) {\n      var firstCell = selectedTableCells[0];\n      var lastCell = selectedTableCells[selectedTableCells.length - 1];\n      var fullTableModel = fromDom$1(tableElm);\n      return subsection(fullTableModel, firstCell, lastCell).map(function (sectionedTableModel) {\n        return fromElements([toDom(sectionedTableModel)]);\n      });\n    }).getOrThunk(emptyFragment);\n  };\n\n  var getSelectionFragment = function (rootNode, ranges) {\n    return ranges.length > 0 && ranges[0].collapsed ? emptyFragment() : getFragmentFromRange(rootNode, ranges[0]);\n  };\n\n  var read$1 = function (rootNode, ranges) {\n    var selectedCells = getCellsFromElementOrRanges(ranges, rootNode);\n    return selectedCells.length > 0 ? getTableFragment(rootNode, selectedCells) : getSelectionFragment(rootNode, ranges);\n  };\n\n  var trimLeadingCollapsibleText = function (text) {\n    return text.replace(/^[ \\f\\n\\r\\t\\v]+/, '');\n  };\n\n  var isCollapsibleWhitespace = function (text, index) {\n    return index >= 0 && index < text.length && isWhiteSpace$1(text.charAt(index));\n  };\n\n  var getInnerText = function (bin, shouldTrim) {\n    var text = trim$2(bin.innerText);\n    return shouldTrim ? trimLeadingCollapsibleText(text) : text;\n  };\n\n  var getContextNodeName = function (parentBlockOpt) {\n    return parentBlockOpt.map(function (block) {\n      return block.nodeName;\n    }).getOr('div').toLowerCase();\n  };\n\n  var getTextContent = function (editor) {\n    return Optional.from(editor.selection.getRng()).map(function (rng) {\n      var parentBlockOpt = Optional.from(editor.dom.getParent(rng.commonAncestorContainer, editor.dom.isBlock));\n      var body = editor.getBody();\n      var contextNodeName = getContextNodeName(parentBlockOpt);\n      var shouldTrimSpaces = Env.browser.isIE() && contextNodeName !== 'pre';\n      var bin = editor.dom.add(body, contextNodeName, {\n        'data-mce-bogus': 'all',\n        'style': 'overflow: hidden; opacity: 0;'\n      }, rng.cloneContents());\n      var text = getInnerText(bin, shouldTrimSpaces);\n      var nonRenderedText = trim$2(bin.textContent);\n      editor.dom.remove(bin);\n\n      if (isCollapsibleWhitespace(nonRenderedText, 0) || isCollapsibleWhitespace(nonRenderedText, nonRenderedText.length - 1)) {\n        var parentBlock = parentBlockOpt.getOr(body);\n        var parentBlockText = getInnerText(parentBlock, shouldTrimSpaces);\n        var textIndex = parentBlockText.indexOf(text);\n\n        if (textIndex === -1) {\n          return text;\n        } else {\n          var hasProceedingSpace = isCollapsibleWhitespace(parentBlockText, textIndex - 1);\n          var hasTrailingSpace = isCollapsibleWhitespace(parentBlockText, textIndex + text.length);\n          return (hasProceedingSpace ? ' ' : '') + text + (hasTrailingSpace ? ' ' : '');\n        }\n      } else {\n        return text;\n      }\n    }).getOr('');\n  };\n\n  var getSerializedContent = function (editor, args) {\n    var rng = editor.selection.getRng(),\n        tmpElm = editor.dom.create('body');\n    var sel = editor.selection.getSel();\n    var ranges = processRanges(editor, getRanges(sel));\n    var fragment = args.contextual ? read$1(SugarElement.fromDom(editor.getBody()), ranges).dom : rng.cloneContents();\n\n    if (fragment) {\n      tmpElm.appendChild(fragment);\n    }\n\n    return editor.selection.serializer.serialize(tmpElm, args);\n  };\n\n  var getSelectedContentInternal = function (editor, format, args) {\n    if (args === void 0) {\n      args = {};\n    }\n\n    args.get = true;\n    args.format = format;\n    args.selection = true;\n    args = editor.fire('BeforeGetContent', args);\n\n    if (args.isDefaultPrevented()) {\n      editor.fire('GetContent', args);\n      return args.content;\n    }\n\n    if (args.format === 'text') {\n      return getTextContent(editor);\n    } else {\n      args.getInner = true;\n      var content = getSerializedContent(editor, args);\n\n      if (args.format === 'tree') {\n        return content;\n      } else {\n        args.content = editor.selection.isCollapsed() ? '' : content;\n        editor.fire('GetContent', args);\n        return args.content;\n      }\n    }\n  };\n\n  var KEEP = 0,\n      INSERT = 1,\n      DELETE = 2;\n\n  var diff = function (left, right) {\n    var size = left.length + right.length + 2;\n    var vDown = new Array(size);\n    var vUp = new Array(size);\n\n    var snake = function (start, end, diag) {\n      return {\n        start: start,\n        end: end,\n        diag: diag\n      };\n    };\n\n    var buildScript = function (start1, end1, start2, end2, script) {\n      var middle = getMiddleSnake(start1, end1, start2, end2);\n\n      if (middle === null || middle.start === end1 && middle.diag === end1 - end2 || middle.end === start1 && middle.diag === start1 - start2) {\n        var i = start1;\n        var j = start2;\n\n        while (i < end1 || j < end2) {\n          if (i < end1 && j < end2 && left[i] === right[j]) {\n            script.push([KEEP, left[i]]);\n            ++i;\n            ++j;\n          } else {\n            if (end1 - start1 > end2 - start2) {\n              script.push([DELETE, left[i]]);\n              ++i;\n            } else {\n              script.push([INSERT, right[j]]);\n              ++j;\n            }\n          }\n        }\n      } else {\n        buildScript(start1, middle.start, start2, middle.start - middle.diag, script);\n\n        for (var i2 = middle.start; i2 < middle.end; ++i2) {\n          script.push([KEEP, left[i2]]);\n        }\n\n        buildScript(middle.end, end1, middle.end - middle.diag, end2, script);\n      }\n    };\n\n    var buildSnake = function (start, diag, end1, end2) {\n      var end = start;\n\n      while (end - diag < end2 && end < end1 && left[end] === right[end - diag]) {\n        ++end;\n      }\n\n      return snake(start, end, diag);\n    };\n\n    var getMiddleSnake = function (start1, end1, start2, end2) {\n      var m = end1 - start1;\n      var n = end2 - start2;\n\n      if (m === 0 || n === 0) {\n        return null;\n      }\n\n      var delta = m - n;\n      var sum = n + m;\n      var offset = (sum % 2 === 0 ? sum : sum + 1) / 2;\n      vDown[1 + offset] = start1;\n      vUp[1 + offset] = end1 + 1;\n      var d, k, i, x, y;\n\n      for (d = 0; d <= offset; ++d) {\n        for (k = -d; k <= d; k += 2) {\n          i = k + offset;\n\n          if (k === -d || k !== d && vDown[i - 1] < vDown[i + 1]) {\n            vDown[i] = vDown[i + 1];\n          } else {\n            vDown[i] = vDown[i - 1] + 1;\n          }\n\n          x = vDown[i];\n          y = x - start1 + start2 - k;\n\n          while (x < end1 && y < end2 && left[x] === right[y]) {\n            vDown[i] = ++x;\n            ++y;\n          }\n\n          if (delta % 2 !== 0 && delta - d <= k && k <= delta + d) {\n            if (vUp[i - delta] <= vDown[i]) {\n              return buildSnake(vUp[i - delta], k + start1 - start2, end1, end2);\n            }\n          }\n        }\n\n        for (k = delta - d; k <= delta + d; k += 2) {\n          i = k + offset - delta;\n\n          if (k === delta - d || k !== delta + d && vUp[i + 1] <= vUp[i - 1]) {\n            vUp[i] = vUp[i + 1] - 1;\n          } else {\n            vUp[i] = vUp[i - 1];\n          }\n\n          x = vUp[i] - 1;\n          y = x - start1 + start2 - k;\n\n          while (x >= start1 && y >= start2 && left[x] === right[y]) {\n            vUp[i] = x--;\n            y--;\n          }\n\n          if (delta % 2 === 0 && -d <= k && k <= d) {\n            if (vUp[i] <= vDown[i + delta]) {\n              return buildSnake(vUp[i], k + start1 - start2, end1, end2);\n            }\n          }\n        }\n      }\n    };\n\n    var script = [];\n    buildScript(0, left.length, 0, right.length, script);\n    return script;\n  };\n\n  var getOuterHtml = function (elm) {\n    if (isElement$1(elm)) {\n      return elm.outerHTML;\n    } else if (isText$1(elm)) {\n      return Entities.encodeRaw(elm.data, false);\n    } else if (isComment$1(elm)) {\n      return '<!--' + elm.data + '-->';\n    }\n\n    return '';\n  };\n\n  var createFragment$1 = function (html) {\n    var node;\n    var container = document.createElement('div');\n    var frag = document.createDocumentFragment();\n\n    if (html) {\n      container.innerHTML = html;\n    }\n\n    while (node = container.firstChild) {\n      frag.appendChild(node);\n    }\n\n    return frag;\n  };\n\n  var insertAt = function (elm, html, index) {\n    var fragment = createFragment$1(html);\n\n    if (elm.hasChildNodes() && index < elm.childNodes.length) {\n      var target = elm.childNodes[index];\n      target.parentNode.insertBefore(fragment, target);\n    } else {\n      elm.appendChild(fragment);\n    }\n  };\n\n  var removeAt = function (elm, index) {\n    if (elm.hasChildNodes() && index < elm.childNodes.length) {\n      var target = elm.childNodes[index];\n      target.parentNode.removeChild(target);\n    }\n  };\n\n  var applyDiff = function (diff, elm) {\n    var index = 0;\n    each(diff, function (action) {\n      if (action[0] === KEEP) {\n        index++;\n      } else if (action[0] === INSERT) {\n        insertAt(elm, action[1], index);\n        index++;\n      } else if (action[0] === DELETE) {\n        removeAt(elm, index);\n      }\n    });\n  };\n\n  var read$2 = function (elm) {\n    return filter(map(from$1(elm.childNodes), getOuterHtml), function (item) {\n      return item.length > 0;\n    });\n  };\n\n  var write = function (fragments, elm) {\n    var currentFragments = map(from$1(elm.childNodes), getOuterHtml);\n    applyDiff(diff(currentFragments, fragments), elm);\n    return elm;\n  };\n\n  var undoLevelDocument = Cell(Optional.none());\n\n  var lazyTempDocument = function () {\n    return undoLevelDocument.get().getOrThunk(function () {\n      var doc = document.implementation.createHTMLDocument('undo');\n      undoLevelDocument.set(Optional.some(doc));\n      return doc;\n    });\n  };\n\n  var hasIframes = function (html) {\n    return html.indexOf('</iframe>') !== -1;\n  };\n\n  var createFragmentedLevel = function (fragments) {\n    return {\n      type: 'fragmented',\n      fragments: fragments,\n      content: '',\n      bookmark: null,\n      beforeBookmark: null\n    };\n  };\n\n  var createCompleteLevel = function (content) {\n    return {\n      type: 'complete',\n      fragments: null,\n      content: content,\n      bookmark: null,\n      beforeBookmark: null\n    };\n  };\n\n  var createFromEditor = function (editor) {\n    var fragments = read$2(editor.getBody());\n    var trimmedFragments = bind(fragments, function (html) {\n      var trimmed = trimInternal(editor.serializer, html);\n      return trimmed.length > 0 ? [trimmed] : [];\n    });\n    var content = trimmedFragments.join('');\n    return hasIframes(content) ? createFragmentedLevel(trimmedFragments) : createCompleteLevel(content);\n  };\n\n  var applyToEditor = function (editor, level, before) {\n    if (level.type === 'fragmented') {\n      write(level.fragments, editor.getBody());\n    } else {\n      editor.setContent(level.content, {\n        format: 'raw'\n      });\n    }\n\n    editor.selection.moveToBookmark(before ? level.beforeBookmark : level.bookmark);\n  };\n\n  var getLevelContent = function (level) {\n    return level.type === 'fragmented' ? level.fragments.join('') : level.content;\n  };\n\n  var getCleanLevelContent = function (level) {\n    var elm = SugarElement.fromTag('body', lazyTempDocument());\n    set$1(elm, getLevelContent(level));\n    each(descendants$1(elm, '*[data-mce-bogus]'), unwrap);\n    return get$7(elm);\n  };\n\n  var hasEqualContent = function (level1, level2) {\n    return getLevelContent(level1) === getLevelContent(level2);\n  };\n\n  var hasEqualCleanedContent = function (level1, level2) {\n    return getCleanLevelContent(level1) === getCleanLevelContent(level2);\n  };\n\n  var isEq$4 = function (level1, level2) {\n    if (!level1 || !level2) {\n      return false;\n    } else if (hasEqualContent(level1, level2)) {\n      return true;\n    } else {\n      return hasEqualCleanedContent(level1, level2);\n    }\n  };\n\n  var isUnlocked = function (locks) {\n    return locks.get() === 0;\n  };\n\n  var setTyping = function (undoManager, typing, locks) {\n    if (isUnlocked(locks)) {\n      undoManager.typing = typing;\n    }\n  };\n\n  var endTyping = function (undoManager, locks) {\n    if (undoManager.typing) {\n      setTyping(undoManager, false, locks);\n      undoManager.add();\n    }\n  };\n\n  var endTypingLevelIgnoreLocks = function (undoManager) {\n    if (undoManager.typing) {\n      undoManager.typing = false;\n      undoManager.add();\n    }\n  };\n\n  var beforeChange = function (editor, locks, beforeBookmark) {\n    if (isUnlocked(locks)) {\n      beforeBookmark.set(Optional.some(getUndoBookmark(editor.selection)));\n    }\n  };\n\n  var addUndoLevel = function (editor, undoManager, index, locks, beforeBookmark, level, event) {\n    var currentLevel = createFromEditor(editor);\n    level = level || {};\n    level = Tools.extend(level, currentLevel);\n\n    if (isUnlocked(locks) === false || editor.removed) {\n      return null;\n    }\n\n    var lastLevel = undoManager.data[index.get()];\n\n    if (editor.fire('BeforeAddUndo', {\n      level: level,\n      lastLevel: lastLevel,\n      originalEvent: event\n    }).isDefaultPrevented()) {\n      return null;\n    }\n\n    if (lastLevel && isEq$4(lastLevel, level)) {\n      return null;\n    }\n\n    if (undoManager.data[index.get()]) {\n      beforeBookmark.get().each(function (bm) {\n        undoManager.data[index.get()].beforeBookmark = bm;\n      });\n    }\n\n    var customUndoRedoLevels = getCustomUndoRedoLevels(editor);\n\n    if (customUndoRedoLevels) {\n      if (undoManager.data.length > customUndoRedoLevels) {\n        for (var i = 0; i < undoManager.data.length - 1; i++) {\n          undoManager.data[i] = undoManager.data[i + 1];\n        }\n\n        undoManager.data.length--;\n        index.set(undoManager.data.length);\n      }\n    }\n\n    level.bookmark = getUndoBookmark(editor.selection);\n\n    if (index.get() < undoManager.data.length - 1) {\n      undoManager.data.length = index.get() + 1;\n    }\n\n    undoManager.data.push(level);\n    index.set(undoManager.data.length - 1);\n    var args = {\n      level: level,\n      lastLevel: lastLevel,\n      originalEvent: event\n    };\n\n    if (index.get() > 0) {\n      editor.setDirty(true);\n      editor.fire('AddUndo', args);\n      editor.fire('change', args);\n    } else {\n      editor.fire('AddUndo', args);\n    }\n\n    return level;\n  };\n\n  var clear = function (editor, undoManager, index) {\n    undoManager.data = [];\n    index.set(0);\n    undoManager.typing = false;\n    editor.fire('ClearUndos');\n  };\n\n  var extra = function (editor, undoManager, index, callback1, callback2) {\n    if (undoManager.transact(callback1)) {\n      var bookmark = undoManager.data[index.get()].bookmark;\n      var lastLevel = undoManager.data[index.get() - 1];\n      applyToEditor(editor, lastLevel, true);\n\n      if (undoManager.transact(callback2)) {\n        undoManager.data[index.get() - 1].beforeBookmark = bookmark;\n      }\n    }\n  };\n\n  var redo = function (editor, index, data) {\n    var level;\n\n    if (index.get() < data.length - 1) {\n      index.set(index.get() + 1);\n      level = data[index.get()];\n      applyToEditor(editor, level, false);\n      editor.setDirty(true);\n      editor.fire('Redo', {\n        level: level\n      });\n    }\n\n    return level;\n  };\n\n  var undo = function (editor, undoManager, locks, index) {\n    var level;\n\n    if (undoManager.typing) {\n      undoManager.add();\n      undoManager.typing = false;\n      setTyping(undoManager, false, locks);\n    }\n\n    if (index.get() > 0) {\n      index.set(index.get() - 1);\n      level = undoManager.data[index.get()];\n      applyToEditor(editor, level, true);\n      editor.setDirty(true);\n      editor.fire('Undo', {\n        level: level\n      });\n    }\n\n    return level;\n  };\n\n  var reset = function (undoManager) {\n    undoManager.clear();\n    undoManager.add();\n  };\n\n  var hasUndo = function (editor, undoManager, index) {\n    return index.get() > 0 || undoManager.typing && undoManager.data[0] && !isEq$4(createFromEditor(editor), undoManager.data[0]);\n  };\n\n  var hasRedo = function (undoManager, index) {\n    return index.get() < undoManager.data.length - 1 && !undoManager.typing;\n  };\n\n  var transact = function (undoManager, locks, callback) {\n    endTyping(undoManager, locks);\n    undoManager.beforeChange();\n    undoManager.ignore(callback);\n    return undoManager.add();\n  };\n\n  var ignore = function (locks, callback) {\n    try {\n      locks.set(locks.get() + 1);\n      callback();\n    } finally {\n      locks.set(locks.get() - 1);\n    }\n  };\n\n  var addVisualInternal = function (editor, elm) {\n    var dom = editor.dom;\n    var scope = isNonNullable(elm) ? elm : editor.getBody();\n\n    if (isUndefined(editor.hasVisual)) {\n      editor.hasVisual = isVisualAidsEnabled(editor);\n    }\n\n    each(dom.select('table,a', scope), function (matchedElm) {\n      switch (matchedElm.nodeName) {\n        case 'TABLE':\n          var cls = getVisualAidsTableClass(editor);\n          var value = dom.getAttrib(matchedElm, 'border');\n\n          if ((!value || value === '0') && editor.hasVisual) {\n            dom.addClass(matchedElm, cls);\n          } else {\n            dom.removeClass(matchedElm, cls);\n          }\n\n          break;\n\n        case 'A':\n          if (!dom.getAttrib(matchedElm, 'href')) {\n            var value_1 = dom.getAttrib(matchedElm, 'name') || matchedElm.id;\n            var cls_1 = getVisualAidsAnchorClass(editor);\n\n            if (value_1 && editor.hasVisual) {\n              dom.addClass(matchedElm, cls_1);\n            } else {\n              dom.removeClass(matchedElm, cls_1);\n            }\n          }\n\n          break;\n      }\n    });\n    editor.fire('VisualAid', {\n      element: elm,\n      hasVisual: editor.hasVisual\n    });\n  };\n\n  var makePlainAdaptor = function (editor) {\n    return {\n      undoManager: {\n        beforeChange: function (locks, beforeBookmark) {\n          return beforeChange(editor, locks, beforeBookmark);\n        },\n        addUndoLevel: function (undoManager, index, locks, beforeBookmark, level, event) {\n          return addUndoLevel(editor, undoManager, index, locks, beforeBookmark, level, event);\n        },\n        undo: function (undoManager, locks, index) {\n          return undo(editor, undoManager, locks, index);\n        },\n        redo: function (index, data) {\n          return redo(editor, index, data);\n        },\n        clear: function (undoManager, index) {\n          return clear(editor, undoManager, index);\n        },\n        reset: function (undoManager) {\n          return reset(undoManager);\n        },\n        hasUndo: function (undoManager, index) {\n          return hasUndo(editor, undoManager, index);\n        },\n        hasRedo: function (undoManager, index) {\n          return hasRedo(undoManager, index);\n        },\n        transact: function (undoManager, locks, callback) {\n          return transact(undoManager, locks, callback);\n        },\n        ignore: function (locks, callback) {\n          return ignore(locks, callback);\n        },\n        extra: function (undoManager, index, callback1, callback2) {\n          return extra(editor, undoManager, index, callback1, callback2);\n        }\n      },\n      formatter: {\n        match: function (name, vars, node) {\n          return match(editor, name, vars, node);\n        },\n        matchAll: function (names, vars) {\n          return matchAll(editor, names, vars);\n        },\n        matchNode: function (node, name, vars, similar) {\n          return matchNode(editor, node, name, vars, similar);\n        },\n        canApply: function (name) {\n          return canApply(editor, name);\n        },\n        closest: function (names) {\n          return closest$3(editor, names);\n        },\n        apply: function (name, vars, node) {\n          return applyFormat(editor, name, vars, node);\n        },\n        remove: function (name, vars, node, similar) {\n          return remove$6(editor, name, vars, node, similar);\n        },\n        toggle: function (name, vars, node) {\n          return toggle(editor, name, vars, node);\n        },\n        formatChanged: function (registeredFormatListeners, formats, callback, similar) {\n          return formatChangedInternal(editor, registeredFormatListeners, formats, callback, similar);\n        }\n      },\n      editor: {\n        getContent: function (args, format) {\n          return getContentInternal(editor, args, format);\n        },\n        setContent: function (content, args) {\n          return setContentInternal(editor, content, args);\n        },\n        insertContent: function (value, details) {\n          return insertHtmlAtCaret(editor, value, details);\n        },\n        addVisual: function (elm) {\n          return addVisualInternal(editor, elm);\n        }\n      },\n      selection: {\n        getContent: function (format, args) {\n          return getSelectedContentInternal(editor, format, args);\n        }\n      },\n      raw: {\n        getModel: function () {\n          return Optional.none();\n        }\n      }\n    };\n  };\n\n  var makeRtcAdaptor = function (rtcEditor) {\n    var defaultVars = function (vars) {\n      return isObject(vars) ? vars : {};\n    };\n\n    var unsupported = die('Unimplemented feature for rtc');\n    var undoManager = rtcEditor.undoManager,\n        formatter = rtcEditor.formatter,\n        editor = rtcEditor.editor,\n        selection = rtcEditor.selection,\n        raw = rtcEditor.raw;\n    var ignore = noop;\n    return {\n      undoManager: {\n        beforeChange: ignore,\n        addUndoLevel: unsupported,\n        undo: function () {\n          return undoManager.undo();\n        },\n        redo: function () {\n          return undoManager.redo();\n        },\n        clear: function () {\n          return undoManager.clear();\n        },\n        reset: function () {\n          return undoManager.reset();\n        },\n        hasUndo: function () {\n          return undoManager.hasUndo();\n        },\n        hasRedo: function () {\n          return undoManager.hasRedo();\n        },\n        transact: function (_undoManager, _locks, fn) {\n          return undoManager.transact(fn);\n        },\n        ignore: function (_locks, callback) {\n          return undoManager.ignore(callback);\n        },\n        extra: function (_undoManager, _index, callback1, callback2) {\n          return undoManager.extra(callback1, callback2);\n        }\n      },\n      formatter: {\n        match: function (name, vars, _node) {\n          return formatter.match(name, defaultVars(vars));\n        },\n        matchAll: unsupported,\n        matchNode: unsupported,\n        canApply: function (name) {\n          return formatter.canApply(name);\n        },\n        closest: function (names) {\n          return formatter.closest(names);\n        },\n        apply: function (name, vars, _node) {\n          return formatter.apply(name, defaultVars(vars));\n        },\n        remove: function (name, vars, _node, _similar) {\n          return formatter.remove(name, defaultVars(vars));\n        },\n        toggle: function (name, vars, _node) {\n          return formatter.toggle(name, defaultVars(vars));\n        },\n        formatChanged: function (_rfl, formats, callback, similar) {\n          return formatter.formatChanged(formats, callback, similar);\n        }\n      },\n      editor: {\n        getContent: function (args, _format) {\n          return editor.getContent(args);\n        },\n        setContent: function (content, args) {\n          return editor.setContent(content, args);\n        },\n        insertContent: function (content, _details) {\n          return editor.insertContent(content);\n        },\n        addVisual: ignore\n      },\n      selection: {\n        getContent: function (_format, args) {\n          return selection.getContent(args);\n        }\n      },\n      raw: {\n        getModel: function () {\n          return Optional.some(raw.getRawModel());\n        }\n      }\n    };\n  };\n\n  var makeNoopAdaptor = function () {\n    var nul = constant(null);\n    var empty = constant('');\n    return {\n      undoManager: {\n        beforeChange: noop,\n        addUndoLevel: nul,\n        undo: nul,\n        redo: nul,\n        clear: noop,\n        reset: noop,\n        hasUndo: never,\n        hasRedo: never,\n        transact: nul,\n        ignore: noop,\n        extra: noop\n      },\n      formatter: {\n        match: never,\n        matchAll: constant([]),\n        matchNode: never,\n        canApply: never,\n        closest: empty,\n        apply: noop,\n        remove: noop,\n        toggle: noop,\n        formatChanged: constant({\n          unbind: noop\n        })\n      },\n      editor: {\n        getContent: empty,\n        setContent: empty,\n        insertContent: noop,\n        addVisual: noop\n      },\n      selection: {\n        getContent: empty\n      },\n      raw: {\n        getModel: constant(Optional.none())\n      }\n    };\n  };\n\n  var isRtc = function (editor) {\n    return has(editor.plugins, 'rtc');\n  };\n\n  var getRtcSetup = function (editor) {\n    return get$1(editor.plugins, 'rtc').bind(function (rtcPlugin) {\n      return Optional.from(rtcPlugin.setup);\n    });\n  };\n\n  var setup$5 = function (editor) {\n    var editorCast = editor;\n    return getRtcSetup(editor).fold(function () {\n      editorCast.rtcInstance = makePlainAdaptor(editor);\n      return Optional.none();\n    }, function (setup) {\n      return Optional.some(setup().then(function (rtcEditor) {\n        editorCast.rtcInstance = makeRtcAdaptor(rtcEditor);\n        return rtcEditor.rtc.isRemote;\n      }, function (err) {\n        editorCast.rtcInstance = makeNoopAdaptor();\n        return promiseObj.reject(err);\n      }));\n    });\n  };\n\n  var getRtcInstanceWithFallback = function (editor) {\n    return editor.rtcInstance ? editor.rtcInstance : makePlainAdaptor(editor);\n  };\n\n  var getRtcInstanceWithError = function (editor) {\n    var rtcInstance = editor.rtcInstance;\n\n    if (!rtcInstance) {\n      throw new Error('Failed to get RTC instance not yet initialized.');\n    } else {\n      return rtcInstance;\n    }\n  };\n\n  var beforeChange$1 = function (editor, locks, beforeBookmark) {\n    getRtcInstanceWithError(editor).undoManager.beforeChange(locks, beforeBookmark);\n  };\n\n  var addUndoLevel$1 = function (editor, undoManager, index, locks, beforeBookmark, level, event) {\n    return getRtcInstanceWithError(editor).undoManager.addUndoLevel(undoManager, index, locks, beforeBookmark, level, event);\n  };\n\n  var undo$1 = function (editor, undoManager, locks, index) {\n    return getRtcInstanceWithError(editor).undoManager.undo(undoManager, locks, index);\n  };\n\n  var redo$1 = function (editor, index, data) {\n    return getRtcInstanceWithError(editor).undoManager.redo(index, data);\n  };\n\n  var clear$1 = function (editor, undoManager, index) {\n    getRtcInstanceWithError(editor).undoManager.clear(undoManager, index);\n  };\n\n  var reset$1 = function (editor, undoManager) {\n    getRtcInstanceWithError(editor).undoManager.reset(undoManager);\n  };\n\n  var hasUndo$1 = function (editor, undoManager, index) {\n    return getRtcInstanceWithError(editor).undoManager.hasUndo(undoManager, index);\n  };\n\n  var hasRedo$1 = function (editor, undoManager, index) {\n    return getRtcInstanceWithError(editor).undoManager.hasRedo(undoManager, index);\n  };\n\n  var transact$1 = function (editor, undoManager, locks, callback) {\n    return getRtcInstanceWithError(editor).undoManager.transact(undoManager, locks, callback);\n  };\n\n  var ignore$1 = function (editor, locks, callback) {\n    getRtcInstanceWithError(editor).undoManager.ignore(locks, callback);\n  };\n\n  var extra$1 = function (editor, undoManager, index, callback1, callback2) {\n    getRtcInstanceWithError(editor).undoManager.extra(undoManager, index, callback1, callback2);\n  };\n\n  var matchFormat = function (editor, name, vars, node) {\n    return getRtcInstanceWithError(editor).formatter.match(name, vars, node);\n  };\n\n  var matchAllFormats = function (editor, names, vars) {\n    return getRtcInstanceWithError(editor).formatter.matchAll(names, vars);\n  };\n\n  var matchNodeFormat = function (editor, node, name, vars, similar) {\n    return getRtcInstanceWithError(editor).formatter.matchNode(node, name, vars, similar);\n  };\n\n  var canApplyFormat = function (editor, name) {\n    return getRtcInstanceWithError(editor).formatter.canApply(name);\n  };\n\n  var closestFormat = function (editor, names) {\n    return getRtcInstanceWithError(editor).formatter.closest(names);\n  };\n\n  var applyFormat$1 = function (editor, name, vars, node) {\n    getRtcInstanceWithError(editor).formatter.apply(name, vars, node);\n  };\n\n  var removeFormat$1 = function (editor, name, vars, node, similar) {\n    getRtcInstanceWithError(editor).formatter.remove(name, vars, node, similar);\n  };\n\n  var toggleFormat = function (editor, name, vars, node) {\n    getRtcInstanceWithError(editor).formatter.toggle(name, vars, node);\n  };\n\n  var formatChanged = function (editor, registeredFormatListeners, formats, callback, similar) {\n    if (similar === void 0) {\n      similar = false;\n    }\n\n    return getRtcInstanceWithError(editor).formatter.formatChanged(registeredFormatListeners, formats, callback, similar);\n  };\n\n  var getContent = function (editor, args, format) {\n    return getRtcInstanceWithFallback(editor).editor.getContent(args, format);\n  };\n\n  var setContent = function (editor, content, args) {\n    return getRtcInstanceWithFallback(editor).editor.setContent(content, args);\n  };\n\n  var insertContent = function (editor, value, details) {\n    return getRtcInstanceWithFallback(editor).editor.insertContent(value, details);\n  };\n\n  var getSelectedContent = function (editor, format, args) {\n    return getRtcInstanceWithError(editor).selection.getContent(format, args);\n  };\n\n  var addVisual = function (editor, elm) {\n    return getRtcInstanceWithError(editor).editor.addVisual(elm);\n  };\n\n  var getContent$1 = function (editor, args) {\n    if (args === void 0) {\n      args = {};\n    }\n\n    var format = args.format ? args.format : 'html';\n    return getSelectedContent(editor, format, args);\n  };\n\n  var removeEmpty = function (text) {\n    if (text.dom.length === 0) {\n      remove(text);\n      return Optional.none();\n    } else {\n      return Optional.some(text);\n    }\n  };\n\n  var walkPastBookmark = function (node, start) {\n    return node.filter(function (elm) {\n      return BookmarkManager.isBookmarkNode(elm.dom);\n    }).bind(start ? nextSibling : prevSibling);\n  };\n\n  var merge = function (outer, inner, rng, start) {\n    var outerElm = outer.dom;\n    var innerElm = inner.dom;\n    var oldLength = start ? outerElm.length : innerElm.length;\n\n    if (start) {\n      mergeTextNodes(outerElm, innerElm, false, !start);\n      rng.setStart(innerElm, oldLength);\n    } else {\n      mergeTextNodes(innerElm, outerElm, false, !start);\n      rng.setEnd(innerElm, oldLength);\n    }\n  };\n\n  var normalizeTextIfRequired = function (inner, start) {\n    parent(inner).each(function (root) {\n      var text = inner.dom;\n\n      if (start && needsToBeNbspLeft(root, CaretPosition(text, 0))) {\n        normalizeWhitespaceAfter(text, 0);\n      } else if (!start && needsToBeNbspRight(root, CaretPosition(text, text.length))) {\n        normalizeWhitespaceBefore(text, text.length);\n      }\n    });\n  };\n\n  var mergeAndNormalizeText = function (outerNode, innerNode, rng, start) {\n    outerNode.bind(function (outer) {\n      var normalizer = start ? normalizeWhitespaceBefore : normalizeWhitespaceAfter;\n      normalizer(outer.dom, start ? outer.dom.length : 0);\n      return innerNode.filter(isText).map(function (inner) {\n        return merge(outer, inner, rng, start);\n      });\n    }).orThunk(function () {\n      var innerTextNode = walkPastBookmark(innerNode, start).or(innerNode).filter(isText);\n      return innerTextNode.map(function (inner) {\n        return normalizeTextIfRequired(inner, start);\n      });\n    });\n  };\n\n  var rngSetContent = function (rng, fragment) {\n    var firstChild = Optional.from(fragment.firstChild).map(SugarElement.fromDom);\n    var lastChild = Optional.from(fragment.lastChild).map(SugarElement.fromDom);\n    rng.deleteContents();\n    rng.insertNode(fragment);\n    var prevText = firstChild.bind(prevSibling).filter(isText).bind(removeEmpty);\n    var nextText = lastChild.bind(nextSibling).filter(isText).bind(removeEmpty);\n    mergeAndNormalizeText(prevText, firstChild, rng, true);\n    mergeAndNormalizeText(nextText, lastChild, rng, false);\n    rng.collapse(false);\n  };\n\n  var setupArgs = function (args, content) {\n    return __assign(__assign({\n      format: 'html'\n    }, args), {\n      set: true,\n      selection: true,\n      content: content\n    });\n  };\n\n  var cleanContent = function (editor, args) {\n    if (args.format !== 'raw') {\n      var rng = editor.selection.getRng();\n      var contextBlock = editor.dom.getParent(rng.commonAncestorContainer, editor.dom.isBlock);\n      var contextArgs = contextBlock ? {\n        context: contextBlock.nodeName.toLowerCase()\n      } : {};\n      var node = editor.parser.parse(args.content, __assign(__assign({\n        isRootContent: true,\n        forced_root_block: false\n      }, contextArgs), args));\n      return HtmlSerializer({\n        validate: editor.validate\n      }, editor.schema).serialize(node);\n    } else {\n      return args.content;\n    }\n  };\n\n  var setContent$1 = function (editor, content, args) {\n    if (args === void 0) {\n      args = {};\n    }\n\n    var contentArgs = setupArgs(args, content);\n\n    if (!contentArgs.no_events) {\n      contentArgs = editor.fire('BeforeSetContent', contentArgs);\n\n      if (contentArgs.isDefaultPrevented()) {\n        editor.fire('SetContent', contentArgs);\n        return;\n      }\n    }\n\n    args.content = cleanContent(editor, contentArgs);\n    var rng = editor.selection.getRng();\n    rngSetContent(rng, rng.createContextualFragment(args.content));\n    editor.selection.setRng(rng);\n    scrollRangeIntoView(editor, rng);\n\n    if (!contentArgs.no_events) {\n      editor.fire('SetContent', contentArgs);\n    }\n  };\n\n  var deleteFromCallbackMap = function (callbackMap, selector, callback) {\n    if (callbackMap && callbackMap.hasOwnProperty(selector)) {\n      var newCallbacks = filter(callbackMap[selector], function (cb) {\n        return cb !== callback;\n      });\n\n      if (newCallbacks.length === 0) {\n        delete callbackMap[selector];\n      } else {\n        callbackMap[selector] = newCallbacks;\n      }\n    }\n  };\n\n  function SelectorChanged(dom, editor) {\n    var selectorChangedData;\n    var currentSelectors;\n    return {\n      selectorChangedWithUnbind: function (selector, callback) {\n        if (!selectorChangedData) {\n          selectorChangedData = {};\n          currentSelectors = {};\n          editor.on('NodeChange', function (e) {\n            var node = e.element,\n                parents = dom.getParents(node, null, dom.getRoot()),\n                matchedSelectors = {};\n            Tools.each(selectorChangedData, function (callbacks, selector) {\n              Tools.each(parents, function (node) {\n                if (dom.is(node, selector)) {\n                  if (!currentSelectors[selector]) {\n                    Tools.each(callbacks, function (callback) {\n                      callback(true, {\n                        node: node,\n                        selector: selector,\n                        parents: parents\n                      });\n                    });\n                    currentSelectors[selector] = callbacks;\n                  }\n\n                  matchedSelectors[selector] = callbacks;\n                  return false;\n                }\n              });\n            });\n            Tools.each(currentSelectors, function (callbacks, selector) {\n              if (!matchedSelectors[selector]) {\n                delete currentSelectors[selector];\n                Tools.each(callbacks, function (callback) {\n                  callback(false, {\n                    node: node,\n                    selector: selector,\n                    parents: parents\n                  });\n                });\n              }\n            });\n          });\n        }\n\n        if (!selectorChangedData[selector]) {\n          selectorChangedData[selector] = [];\n        }\n\n        selectorChangedData[selector].push(callback);\n        return {\n          unbind: function () {\n            deleteFromCallbackMap(selectorChangedData, selector, callback);\n            deleteFromCallbackMap(currentSelectors, selector, callback);\n          }\n        };\n      }\n    };\n  }\n\n  var isNativeIeSelection = function (rng) {\n    return !!rng.select;\n  };\n\n  var isAttachedToDom = function (node) {\n    return !!(node && node.ownerDocument) && contains$2(SugarElement.fromDom(node.ownerDocument), SugarElement.fromDom(node));\n  };\n\n  var isValidRange = function (rng) {\n    if (!rng) {\n      return false;\n    } else if (isNativeIeSelection(rng)) {\n      return true;\n    } else {\n      return isAttachedToDom(rng.startContainer) && isAttachedToDom(rng.endContainer);\n    }\n  };\n\n  var EditorSelection = function (dom, win, serializer, editor) {\n    var selectedRange;\n    var explicitRange;\n    var selectorChangedWithUnbind = SelectorChanged(dom, editor).selectorChangedWithUnbind;\n\n    var setCursorLocation = function (node, offset) {\n      var rng = dom.createRng();\n\n      if (isNonNullable(node) && isNonNullable(offset)) {\n        rng.setStart(node, offset);\n        rng.setEnd(node, offset);\n        setRng(rng);\n        collapse(false);\n      } else {\n        moveEndPoint$1(dom, rng, editor.getBody(), true);\n        setRng(rng);\n      }\n    };\n\n    var getContent = function (args) {\n      return getContent$1(editor, args);\n    };\n\n    var setContent = function (content, args) {\n      return setContent$1(editor, content, args);\n    };\n\n    var getStart = function (real) {\n      return getStart$2(editor.getBody(), getRng$1(), real);\n    };\n\n    var getEnd$1 = function (real) {\n      return getEnd(editor.getBody(), getRng$1(), real);\n    };\n\n    var getBookmark = function (type, normalized) {\n      return bookmarkManager.getBookmark(type, normalized);\n    };\n\n    var moveToBookmark = function (bookmark) {\n      return bookmarkManager.moveToBookmark(bookmark);\n    };\n\n    var select = function (node, content) {\n      select$1(dom, node, content).each(setRng);\n      return node;\n    };\n\n    var isCollapsed = function () {\n      var rng = getRng$1(),\n          sel = getSel();\n\n      if (!rng || rng.item) {\n        return false;\n      }\n\n      if (rng.compareEndPoints) {\n        return rng.compareEndPoints('StartToEnd', rng) === 0;\n      }\n\n      return !sel || rng.collapsed;\n    };\n\n    var collapse = function (toStart) {\n      var rng = getRng$1();\n      rng.collapse(!!toStart);\n      setRng(rng);\n    };\n\n    var getSel = function () {\n      return win.getSelection ? win.getSelection() : win.document.selection;\n    };\n\n    var getRng$1 = function () {\n      var selection, rng, elm;\n\n      var tryCompareBoundaryPoints = function (how, sourceRange, destinationRange) {\n        try {\n          return sourceRange.compareBoundaryPoints(how, destinationRange);\n        } catch (ex) {\n          return -1;\n        }\n      };\n\n      var doc = win.document;\n\n      if (editor.bookmark !== undefined && hasFocus$1(editor) === false) {\n        var bookmark = getRng(editor);\n\n        if (bookmark.isSome()) {\n          return bookmark.map(function (r) {\n            return processRanges(editor, [r])[0];\n          }).getOr(doc.createRange());\n        }\n      }\n\n      try {\n        if ((selection = getSel()) && !isRestrictedNode(selection.anchorNode)) {\n          if (selection.rangeCount > 0) {\n            rng = selection.getRangeAt(0);\n          } else {\n            rng = selection.createRange ? selection.createRange() : doc.createRange();\n          }\n\n          rng = processRanges(editor, [rng])[0];\n        }\n      } catch (ex) {}\n\n      if (!rng) {\n        rng = doc.createRange ? doc.createRange() : doc.body.createTextRange();\n      }\n\n      if (rng.setStart && rng.startContainer.nodeType === 9 && rng.collapsed) {\n        elm = dom.getRoot();\n        rng.setStart(elm, 0);\n        rng.setEnd(elm, 0);\n      }\n\n      if (selectedRange && explicitRange) {\n        if (tryCompareBoundaryPoints(rng.START_TO_START, rng, selectedRange) === 0 && tryCompareBoundaryPoints(rng.END_TO_END, rng, selectedRange) === 0) {\n          rng = explicitRange;\n        } else {\n          selectedRange = null;\n          explicitRange = null;\n        }\n      }\n\n      return rng;\n    };\n\n    var setRng = function (rng, forward) {\n      var node;\n\n      if (!isValidRange(rng)) {\n        return;\n      }\n\n      var ieRange = isNativeIeSelection(rng) ? rng : null;\n\n      if (ieRange) {\n        explicitRange = null;\n\n        try {\n          ieRange.select();\n        } catch (ex) {}\n\n        return;\n      }\n\n      var sel = getSel();\n      var evt = editor.fire('SetSelectionRange', {\n        range: rng,\n        forward: forward\n      });\n      rng = evt.range;\n\n      if (sel) {\n        explicitRange = rng;\n\n        try {\n          sel.removeAllRanges();\n          sel.addRange(rng);\n        } catch (ex) {}\n\n        if (forward === false && sel.extend) {\n          sel.collapse(rng.endContainer, rng.endOffset);\n          sel.extend(rng.startContainer, rng.startOffset);\n        }\n\n        selectedRange = sel.rangeCount > 0 ? sel.getRangeAt(0) : null;\n      }\n\n      if (!rng.collapsed && rng.startContainer === rng.endContainer && sel.setBaseAndExtent && !Env.ie) {\n        if (rng.endOffset - rng.startOffset < 2) {\n          if (rng.startContainer.hasChildNodes()) {\n            node = rng.startContainer.childNodes[rng.startOffset];\n\n            if (node && node.tagName === 'IMG') {\n              sel.setBaseAndExtent(rng.startContainer, rng.startOffset, rng.endContainer, rng.endOffset);\n\n              if (sel.anchorNode !== rng.startContainer || sel.focusNode !== rng.endContainer) {\n                sel.setBaseAndExtent(node, 0, node, 1);\n              }\n            }\n          }\n        }\n      }\n\n      editor.fire('AfterSetSelectionRange', {\n        range: rng,\n        forward: forward\n      });\n    };\n\n    var setNode = function (elm) {\n      setContent(dom.getOuterHTML(elm));\n      return elm;\n    };\n\n    var getNode = function () {\n      return getNode$1(editor.getBody(), getRng$1());\n    };\n\n    var getSelectedBlocks$1 = function (startElm, endElm) {\n      return getSelectedBlocks(dom, getRng$1(), startElm, endElm);\n    };\n\n    var isForward = function () {\n      var sel = getSel();\n      var anchorNode = sel === null || sel === void 0 ? void 0 : sel.anchorNode;\n      var focusNode = sel === null || sel === void 0 ? void 0 : sel.focusNode;\n\n      if (!sel || !anchorNode || !focusNode || isRestrictedNode(anchorNode) || isRestrictedNode(focusNode)) {\n        return true;\n      }\n\n      var anchorRange = dom.createRng();\n      anchorRange.setStart(anchorNode, sel.anchorOffset);\n      anchorRange.collapse(true);\n      var focusRange = dom.createRng();\n      focusRange.setStart(focusNode, sel.focusOffset);\n      focusRange.collapse(true);\n      return anchorRange.compareBoundaryPoints(anchorRange.START_TO_START, focusRange) <= 0;\n    };\n\n    var normalize$1 = function () {\n      var rng = getRng$1();\n      var sel = getSel();\n\n      if (!hasMultipleRanges(sel) && hasAnyRanges(editor)) {\n        var normRng = normalize(dom, rng);\n        normRng.each(function (normRng) {\n          setRng(normRng, isForward());\n        });\n        return normRng.getOr(rng);\n      }\n\n      return rng;\n    };\n\n    var selectorChanged = function (selector, callback) {\n      selectorChangedWithUnbind(selector, callback);\n      return exports;\n    };\n\n    var getScrollContainer = function () {\n      var scrollContainer;\n      var node = dom.getRoot();\n\n      while (node && node.nodeName !== 'BODY') {\n        if (node.scrollHeight > node.clientHeight) {\n          scrollContainer = node;\n          break;\n        }\n\n        node = node.parentNode;\n      }\n\n      return scrollContainer;\n    };\n\n    var scrollIntoView = function (elm, alignToTop) {\n      return scrollElementIntoView(editor, elm, alignToTop);\n    };\n\n    var placeCaretAt = function (clientX, clientY) {\n      return setRng(fromPoint$1(clientX, clientY, editor.getDoc()));\n    };\n\n    var getBoundingClientRect = function () {\n      var rng = getRng$1();\n      return rng.collapsed ? CaretPosition.fromRangeStart(rng).getClientRects()[0] : rng.getBoundingClientRect();\n    };\n\n    var destroy = function () {\n      win = selectedRange = explicitRange = null;\n      controlSelection.destroy();\n    };\n\n    var exports = {\n      bookmarkManager: null,\n      controlSelection: null,\n      dom: dom,\n      win: win,\n      serializer: serializer,\n      editor: editor,\n      collapse: collapse,\n      setCursorLocation: setCursorLocation,\n      getContent: getContent,\n      setContent: setContent,\n      getBookmark: getBookmark,\n      moveToBookmark: moveToBookmark,\n      select: select,\n      isCollapsed: isCollapsed,\n      isForward: isForward,\n      setNode: setNode,\n      getNode: getNode,\n      getSel: getSel,\n      setRng: setRng,\n      getRng: getRng$1,\n      getStart: getStart,\n      getEnd: getEnd$1,\n      getSelectedBlocks: getSelectedBlocks$1,\n      normalize: normalize$1,\n      selectorChanged: selectorChanged,\n      selectorChangedWithUnbind: selectorChangedWithUnbind,\n      getScrollContainer: getScrollContainer,\n      scrollIntoView: scrollIntoView,\n      placeCaretAt: placeCaretAt,\n      getBoundingClientRect: getBoundingClientRect,\n      destroy: destroy\n    };\n    var bookmarkManager = BookmarkManager(exports);\n    var controlSelection = ControlSelection(exports, editor);\n    exports.bookmarkManager = bookmarkManager;\n    exports.controlSelection = controlSelection;\n    return exports;\n  };\n\n  var removeAttrs = function (node, names) {\n    each(names, function (name) {\n      node.attr(name, null);\n    });\n  };\n\n  var addFontToSpansFilter = function (domParser, styles, fontSizes) {\n    domParser.addNodeFilter('font', function (nodes) {\n      each(nodes, function (node) {\n        var props = styles.parse(node.attr('style'));\n        var color = node.attr('color');\n        var face = node.attr('face');\n        var size = node.attr('size');\n\n        if (color) {\n          props.color = color;\n        }\n\n        if (face) {\n          props['font-family'] = face;\n        }\n\n        if (size) {\n          props['font-size'] = fontSizes[parseInt(node.attr('size'), 10) - 1];\n        }\n\n        node.name = 'span';\n        node.attr('style', styles.serialize(props));\n        removeAttrs(node, ['color', 'face', 'size']);\n      });\n    });\n  };\n\n  var addStrikeToSpanFilter = function (domParser, styles) {\n    domParser.addNodeFilter('strike', function (nodes) {\n      each(nodes, function (node) {\n        var props = styles.parse(node.attr('style'));\n        props['text-decoration'] = 'line-through';\n        node.name = 'span';\n        node.attr('style', styles.serialize(props));\n      });\n    });\n  };\n\n  var addFilters = function (domParser, settings) {\n    var styles = Styles();\n\n    if (settings.convert_fonts_to_spans) {\n      addFontToSpansFilter(domParser, styles, Tools.explode(settings.font_size_legacy_values));\n    }\n\n    addStrikeToSpanFilter(domParser, styles);\n  };\n\n  var register$1 = function (domParser, settings) {\n    if (settings.inline_styles) {\n      addFilters(domParser, settings);\n    }\n  };\n\n  var blobUriToBlob = function (url) {\n    return new promiseObj(function (resolve, reject) {\n      var rejectWithError = function () {\n        reject('Cannot convert ' + url + ' to Blob. Resource might not exist or is inaccessible.');\n      };\n\n      try {\n        var xhr_1 = new XMLHttpRequest();\n        xhr_1.open('GET', url, true);\n        xhr_1.responseType = 'blob';\n\n        xhr_1.onload = function () {\n          if (xhr_1.status === 200) {\n            resolve(xhr_1.response);\n          } else {\n            rejectWithError();\n          }\n        };\n\n        xhr_1.onerror = rejectWithError;\n        xhr_1.send();\n      } catch (ex) {\n        rejectWithError();\n      }\n    });\n  };\n\n  var parseDataUri$1 = function (uri) {\n    var type;\n    var uriParts = decodeURIComponent(uri).split(',');\n    var matches = /data:([^;]+)/.exec(uriParts[0]);\n\n    if (matches) {\n      type = matches[1];\n    }\n\n    return {\n      type: type,\n      data: uriParts[1]\n    };\n  };\n\n  var buildBlob = function (type, data) {\n    var str;\n\n    try {\n      str = atob(data);\n    } catch (e) {\n      return Optional.none();\n    }\n\n    var arr = new Uint8Array(str.length);\n\n    for (var i = 0; i < arr.length; i++) {\n      arr[i] = str.charCodeAt(i);\n    }\n\n    return Optional.some(new Blob([arr], {\n      type: type\n    }));\n  };\n\n  var dataUriToBlob = function (uri) {\n    return new promiseObj(function (resolve) {\n      var _a = parseDataUri$1(uri),\n          type = _a.type,\n          data = _a.data;\n\n      buildBlob(type, data).fold(function () {\n        return resolve(new Blob([]));\n      }, resolve);\n    });\n  };\n\n  var uriToBlob = function (url) {\n    if (url.indexOf('blob:') === 0) {\n      return blobUriToBlob(url);\n    }\n\n    if (url.indexOf('data:') === 0) {\n      return dataUriToBlob(url);\n    }\n\n    return null;\n  };\n\n  var blobToDataUri = function (blob) {\n    return new promiseObj(function (resolve) {\n      var reader = new FileReader();\n\n      reader.onloadend = function () {\n        resolve(reader.result);\n      };\n\n      reader.readAsDataURL(blob);\n    });\n  };\n\n  var count = 0;\n\n  var uniqueId = function (prefix) {\n    return (prefix || 'blobid') + count++;\n  };\n\n  var imageToBlobInfo = function (blobCache, img, resolve, reject) {\n    var base64, blobInfo;\n\n    if (img.src.indexOf('blob:') === 0) {\n      blobInfo = blobCache.getByUri(img.src);\n\n      if (blobInfo) {\n        resolve({\n          image: img,\n          blobInfo: blobInfo\n        });\n      } else {\n        uriToBlob(img.src).then(function (blob) {\n          blobToDataUri(blob).then(function (dataUri) {\n            base64 = parseDataUri$1(dataUri).data;\n            blobInfo = blobCache.create(uniqueId(), blob, base64);\n            blobCache.add(blobInfo);\n            resolve({\n              image: img,\n              blobInfo: blobInfo\n            });\n          });\n        }, function (err) {\n          reject(err);\n        });\n      }\n\n      return;\n    }\n\n    var _a = parseDataUri$1(img.src),\n        data = _a.data,\n        type = _a.type;\n\n    base64 = data;\n    blobInfo = blobCache.getByData(base64, type);\n\n    if (blobInfo) {\n      resolve({\n        image: img,\n        blobInfo: blobInfo\n      });\n    } else {\n      uriToBlob(img.src).then(function (blob) {\n        blobInfo = blobCache.create(uniqueId(), blob, base64);\n        blobCache.add(blobInfo);\n        resolve({\n          image: img,\n          blobInfo: blobInfo\n        });\n      }, function (err) {\n        reject(err);\n      });\n    }\n  };\n\n  var getAllImages = function (elm) {\n    return elm ? from$1(elm.getElementsByTagName('img')) : [];\n  };\n\n  var ImageScanner = function (uploadStatus, blobCache) {\n    var cachedPromises = {};\n\n    var findAll = function (elm, predicate) {\n      if (!predicate) {\n        predicate = always;\n      }\n\n      var images = filter(getAllImages(elm), function (img) {\n        var src = img.src;\n\n        if (!Env.fileApi) {\n          return false;\n        }\n\n        if (img.hasAttribute('data-mce-bogus')) {\n          return false;\n        }\n\n        if (img.hasAttribute('data-mce-placeholder')) {\n          return false;\n        }\n\n        if (!src || src === Env.transparentSrc) {\n          return false;\n        }\n\n        if (src.indexOf('blob:') === 0) {\n          return !uploadStatus.isUploaded(src) && predicate(img);\n        }\n\n        if (src.indexOf('data:') === 0) {\n          return predicate(img);\n        }\n\n        return false;\n      });\n      var promises = map(images, function (img) {\n        if (cachedPromises[img.src] !== undefined) {\n          return new promiseObj(function (resolve) {\n            cachedPromises[img.src].then(function (imageInfo) {\n              if (typeof imageInfo === 'string') {\n                return imageInfo;\n              }\n\n              resolve({\n                image: img,\n                blobInfo: imageInfo.blobInfo\n              });\n            });\n          });\n        }\n\n        var newPromise = new promiseObj(function (resolve, reject) {\n          imageToBlobInfo(blobCache, img, resolve, reject);\n        }).then(function (result) {\n          delete cachedPromises[result.image.src];\n          return result;\n        }).catch(function (error) {\n          delete cachedPromises[img.src];\n          return error;\n        });\n        cachedPromises[img.src] = newPromise;\n        return newPromise;\n      });\n      return promiseObj.all(promises);\n    };\n\n    return {\n      findAll: findAll\n    };\n  };\n\n  var paddEmptyNode = function (settings, args, blockElements, node) {\n    var brPreferred = settings.padd_empty_with_br || args.insert;\n\n    if (brPreferred && blockElements[node.name]) {\n      node.empty().append(new AstNode('br', 1)).shortEnded = true;\n    } else {\n      node.empty().append(new AstNode('#text', 3)).value = nbsp;\n    }\n  };\n\n  var isPaddedWithNbsp = function (node) {\n    return hasOnlyChild(node, '#text') && node.firstChild.value === nbsp;\n  };\n\n  var hasOnlyChild = function (node, name) {\n    return node && node.firstChild && node.firstChild === node.lastChild && node.firstChild.name === name;\n  };\n\n  var isPadded = function (schema, node) {\n    var rule = schema.getElementRule(node.name);\n    return rule && rule.paddEmpty;\n  };\n\n  var isEmpty$2 = function (schema, nonEmptyElements, whitespaceElements, node) {\n    return node.isEmpty(nonEmptyElements, whitespaceElements, function (node) {\n      return isPadded(schema, node);\n    });\n  };\n\n  var isLineBreakNode = function (node, blockElements) {\n    return node && (blockElements[node.name] || node.name === 'br');\n  };\n\n  var isBogusImage = function (img) {\n    return img.attr('data-mce-bogus');\n  };\n\n  var isInternalImageSource = function (img) {\n    return img.attr('src') === Env.transparentSrc || img.attr('data-mce-placeholder');\n  };\n\n  var isValidDataImg = function (img, settings) {\n    if (settings.images_dataimg_filter) {\n      var imgElem_1 = new Image();\n      imgElem_1.src = img.attr('src');\n      each$1(img.attributes.map, function (value, key) {\n        imgElem_1.setAttribute(key, value);\n      });\n      return settings.images_dataimg_filter(imgElem_1);\n    } else {\n      return true;\n    }\n  };\n\n  var registerBase64ImageFilter = function (parser, settings) {\n    var blobCache = settings.blob_cache;\n\n    var processImage = function (img) {\n      var inputSrc = img.attr('src');\n\n      if (isInternalImageSource(img) || isBogusImage(img)) {\n        return;\n      }\n\n      parseDataUri(inputSrc).filter(function () {\n        return isValidDataImg(img, settings);\n      }).bind(function (_a) {\n        var type = _a.type,\n            data = _a.data;\n        return Optional.from(blobCache.getByData(data, type)).orThunk(function () {\n          return buildBlob(type, data).map(function (blob) {\n            var blobInfo = blobCache.create(uniqueId(), blob, data);\n            blobCache.add(blobInfo);\n            return blobInfo;\n          });\n        });\n      }).each(function (blobInfo) {\n        img.attr('src', blobInfo.blobUri());\n      });\n    };\n\n    if (blobCache) {\n      parser.addAttributeFilter('src', function (nodes) {\n        return each(nodes, processImage);\n      });\n    }\n  };\n\n  var register$2 = function (parser, settings) {\n    var schema = parser.schema;\n\n    if (settings.remove_trailing_brs) {\n      parser.addNodeFilter('br', function (nodes, _, args) {\n        var i;\n        var l = nodes.length;\n        var node;\n        var blockElements = Tools.extend({}, schema.getBlockElements());\n        var nonEmptyElements = schema.getNonEmptyElements();\n        var parent, lastParent, prev, prevName;\n        var whiteSpaceElements = schema.getWhiteSpaceElements();\n        var elementRule, textNode;\n        blockElements.body = 1;\n\n        for (i = 0; i < l; i++) {\n          node = nodes[i];\n          parent = node.parent;\n\n          if (blockElements[node.parent.name] && node === parent.lastChild) {\n            prev = node.prev;\n\n            while (prev) {\n              prevName = prev.name;\n\n              if (prevName !== 'span' || prev.attr('data-mce-type') !== 'bookmark') {\n                if (prevName === 'br') {\n                  node = null;\n                }\n\n                break;\n              }\n\n              prev = prev.prev;\n            }\n\n            if (node) {\n              node.remove();\n\n              if (isEmpty$2(schema, nonEmptyElements, whiteSpaceElements, parent)) {\n                elementRule = schema.getElementRule(parent.name);\n\n                if (elementRule) {\n                  if (elementRule.removeEmpty) {\n                    parent.remove();\n                  } else if (elementRule.paddEmpty) {\n                    paddEmptyNode(settings, args, blockElements, parent);\n                  }\n                }\n              }\n            }\n          } else {\n            lastParent = node;\n\n            while (parent && parent.firstChild === lastParent && parent.lastChild === lastParent) {\n              lastParent = parent;\n\n              if (blockElements[parent.name]) {\n                break;\n              }\n\n              parent = parent.parent;\n            }\n\n            if (lastParent === parent && settings.padd_empty_with_br !== true) {\n              textNode = new AstNode('#text', 3);\n              textNode.value = nbsp;\n              node.replace(textNode);\n            }\n          }\n        }\n      });\n    }\n\n    parser.addAttributeFilter('href', function (nodes) {\n      var i = nodes.length;\n\n      var appendRel = function (rel) {\n        var parts = rel.split(' ').filter(function (p) {\n          return p.length > 0;\n        });\n        return parts.concat(['noopener']).sort().join(' ');\n      };\n\n      var addNoOpener = function (rel) {\n        var newRel = rel ? Tools.trim(rel) : '';\n\n        if (!/\\b(noopener)\\b/g.test(newRel)) {\n          return appendRel(newRel);\n        } else {\n          return newRel;\n        }\n      };\n\n      if (!settings.allow_unsafe_link_target) {\n        while (i--) {\n          var node = nodes[i];\n\n          if (node.name === 'a' && node.attr('target') === '_blank') {\n            node.attr('rel', addNoOpener(node.attr('rel')));\n          }\n        }\n      }\n    });\n\n    if (!settings.allow_html_in_named_anchor) {\n      parser.addAttributeFilter('id,name', function (nodes) {\n        var i = nodes.length,\n            sibling,\n            prevSibling,\n            parent,\n            node;\n\n        while (i--) {\n          node = nodes[i];\n\n          if (node.name === 'a' && node.firstChild && !node.attr('href')) {\n            parent = node.parent;\n            sibling = node.lastChild;\n\n            do {\n              prevSibling = sibling.prev;\n              parent.insert(sibling, node);\n              sibling = prevSibling;\n            } while (sibling);\n          }\n        }\n      });\n    }\n\n    if (settings.fix_list_elements) {\n      parser.addNodeFilter('ul,ol', function (nodes) {\n        var i = nodes.length,\n            node,\n            parentNode;\n\n        while (i--) {\n          node = nodes[i];\n          parentNode = node.parent;\n\n          if (parentNode.name === 'ul' || parentNode.name === 'ol') {\n            if (node.prev && node.prev.name === 'li') {\n              node.prev.append(node);\n            } else {\n              var li = new AstNode('li', 1);\n              li.attr('style', 'list-style-type: none');\n              node.wrap(li);\n            }\n          }\n        }\n      });\n    }\n\n    if (settings.validate && schema.getValidClasses()) {\n      parser.addAttributeFilter('class', function (nodes) {\n        var i = nodes.length,\n            node,\n            classList,\n            ci,\n            className,\n            classValue;\n        var validClasses = schema.getValidClasses();\n        var validClassesMap, valid;\n\n        while (i--) {\n          node = nodes[i];\n          classList = node.attr('class').split(' ');\n          classValue = '';\n\n          for (ci = 0; ci < classList.length; ci++) {\n            className = classList[ci];\n            valid = false;\n            validClassesMap = validClasses['*'];\n\n            if (validClassesMap && validClassesMap[className]) {\n              valid = true;\n            }\n\n            validClassesMap = validClasses[node.name];\n\n            if (!valid && validClassesMap && validClassesMap[className]) {\n              valid = true;\n            }\n\n            if (valid) {\n              if (classValue) {\n                classValue += ' ';\n              }\n\n              classValue += className;\n            }\n          }\n\n          if (!classValue.length) {\n            classValue = null;\n          }\n\n          node.attr('class', classValue);\n        }\n      });\n    }\n\n    registerBase64ImageFilter(parser, settings);\n  };\n\n  var makeMap$4 = Tools.makeMap,\n      each$d = Tools.each,\n      explode$2 = Tools.explode,\n      extend$2 = Tools.extend;\n\n  var DomParser = function (settings, schema) {\n    if (schema === void 0) {\n      schema = Schema();\n    }\n\n    var nodeFilters = {};\n    var attributeFilters = [];\n    var matchedNodes = {};\n    var matchedAttributes = {};\n    settings = settings || {};\n    settings.validate = 'validate' in settings ? settings.validate : true;\n    settings.root_name = settings.root_name || 'body';\n\n    var fixInvalidChildren = function (nodes) {\n      var ni, node, parent, parents, newParent, currentNode, tempNode, childNode, i;\n      var sibling, nextNode;\n      var nonSplitableElements = makeMap$4('tr,td,th,tbody,thead,tfoot,table');\n      var nonEmptyElements = schema.getNonEmptyElements();\n      var whitespaceElements = schema.getWhiteSpaceElements();\n      var textBlockElements = schema.getTextBlockElements();\n      var specialElements = schema.getSpecialElements();\n\n      for (ni = 0; ni < nodes.length; ni++) {\n        node = nodes[ni];\n\n        if (!node.parent || node.fixed) {\n          continue;\n        }\n\n        if (textBlockElements[node.name] && node.parent.name === 'li') {\n          sibling = node.next;\n\n          while (sibling) {\n            if (textBlockElements[sibling.name]) {\n              sibling.name = 'li';\n              sibling.fixed = true;\n              node.parent.insert(sibling, node.parent);\n            } else {\n              break;\n            }\n\n            sibling = sibling.next;\n          }\n\n          node.unwrap(node);\n          continue;\n        }\n\n        parents = [node];\n\n        for (parent = node.parent; parent && !schema.isValidChild(parent.name, node.name) && !nonSplitableElements[parent.name]; parent = parent.parent) {\n          parents.push(parent);\n        }\n\n        if (parent && parents.length > 1) {\n          parents.reverse();\n          newParent = currentNode = filterNode(parents[0].clone());\n\n          for (i = 0; i < parents.length - 1; i++) {\n            if (schema.isValidChild(currentNode.name, parents[i].name)) {\n              tempNode = filterNode(parents[i].clone());\n              currentNode.append(tempNode);\n            } else {\n              tempNode = currentNode;\n            }\n\n            for (childNode = parents[i].firstChild; childNode && childNode !== parents[i + 1];) {\n              nextNode = childNode.next;\n              tempNode.append(childNode);\n              childNode = nextNode;\n            }\n\n            currentNode = tempNode;\n          }\n\n          if (!isEmpty$2(schema, nonEmptyElements, whitespaceElements, newParent)) {\n            parent.insert(newParent, parents[0], true);\n            parent.insert(node, newParent);\n          } else {\n            parent.insert(node, parents[0], true);\n          }\n\n          parent = parents[0];\n\n          if (isEmpty$2(schema, nonEmptyElements, whitespaceElements, parent) || hasOnlyChild(parent, 'br')) {\n            parent.empty().remove();\n          }\n        } else if (node.parent) {\n          if (node.name === 'li') {\n            sibling = node.prev;\n\n            if (sibling && (sibling.name === 'ul' || sibling.name === 'ol')) {\n              sibling.append(node);\n              continue;\n            }\n\n            sibling = node.next;\n\n            if (sibling && (sibling.name === 'ul' || sibling.name === 'ol')) {\n              sibling.insert(node, sibling.firstChild, true);\n              continue;\n            }\n\n            node.wrap(filterNode(new AstNode('ul', 1)));\n            continue;\n          }\n\n          if (schema.isValidChild(node.parent.name, 'div') && schema.isValidChild('div', node.name)) {\n            node.wrap(filterNode(new AstNode('div', 1)));\n          } else {\n            if (specialElements[node.name]) {\n              node.empty().remove();\n            } else {\n              node.unwrap();\n            }\n          }\n        }\n      }\n    };\n\n    var filterNode = function (node) {\n      var i, name, list;\n      name = node.name;\n\n      if (name in nodeFilters) {\n        list = matchedNodes[name];\n\n        if (list) {\n          list.push(node);\n        } else {\n          matchedNodes[name] = [node];\n        }\n      }\n\n      i = attributeFilters.length;\n\n      while (i--) {\n        name = attributeFilters[i].name;\n\n        if (name in node.attributes.map) {\n          list = matchedAttributes[name];\n\n          if (list) {\n            list.push(node);\n          } else {\n            matchedAttributes[name] = [node];\n          }\n        }\n      }\n\n      return node;\n    };\n\n    var addNodeFilter = function (name, callback) {\n      each$d(explode$2(name), function (name) {\n        var list = nodeFilters[name];\n\n        if (!list) {\n          nodeFilters[name] = list = [];\n        }\n\n        list.push(callback);\n      });\n    };\n\n    var getNodeFilters = function () {\n      var out = [];\n\n      for (var name_1 in nodeFilters) {\n        if (nodeFilters.hasOwnProperty(name_1)) {\n          out.push({\n            name: name_1,\n            callbacks: nodeFilters[name_1]\n          });\n        }\n      }\n\n      return out;\n    };\n\n    var addAttributeFilter = function (name, callback) {\n      each$d(explode$2(name), function (name) {\n        var i;\n\n        for (i = 0; i < attributeFilters.length; i++) {\n          if (attributeFilters[i].name === name) {\n            attributeFilters[i].callbacks.push(callback);\n            return;\n          }\n        }\n\n        attributeFilters.push({\n          name: name,\n          callbacks: [callback]\n        });\n      });\n    };\n\n    var getAttributeFilters = function () {\n      return [].concat(attributeFilters);\n    };\n\n    var parse = function (html, args) {\n      var nodes, i, l, fi, fl, list, name;\n      var invalidChildren = [];\n      var isInWhiteSpacePreservedElement;\n      var node;\n\n      var getRootBlockName = function (name) {\n        if (name === false) {\n          return '';\n        } else if (name === true) {\n          return 'p';\n        } else {\n          return name;\n        }\n      };\n\n      args = args || {};\n      matchedNodes = {};\n      matchedAttributes = {};\n      var blockElements = extend$2(makeMap$4('script,style,head,html,body,title,meta,param'), schema.getBlockElements());\n      var nonEmptyElements = schema.getNonEmptyElements();\n      var children = schema.children;\n      var validate = settings.validate;\n      var forcedRootBlockName = 'forced_root_block' in args ? args.forced_root_block : settings.forced_root_block;\n      var rootBlockName = getRootBlockName(forcedRootBlockName);\n      var whiteSpaceElements = schema.getWhiteSpaceElements();\n      var startWhiteSpaceRegExp = /^[ \\t\\r\\n]+/;\n      var endWhiteSpaceRegExp = /[ \\t\\r\\n]+$/;\n      var allWhiteSpaceRegExp = /[ \\t\\r\\n]+/g;\n      var isAllWhiteSpaceRegExp = /^[ \\t\\r\\n]+$/;\n      isInWhiteSpacePreservedElement = whiteSpaceElements.hasOwnProperty(args.context) || whiteSpaceElements.hasOwnProperty(settings.root_name);\n\n      var addRootBlocks = function () {\n        var node = rootNode.firstChild,\n            next,\n            rootBlockNode;\n\n        var trim = function (rootBlockNode) {\n          if (rootBlockNode) {\n            node = rootBlockNode.firstChild;\n\n            if (node && node.type === 3) {\n              node.value = node.value.replace(startWhiteSpaceRegExp, '');\n            }\n\n            node = rootBlockNode.lastChild;\n\n            if (node && node.type === 3) {\n              node.value = node.value.replace(endWhiteSpaceRegExp, '');\n            }\n          }\n        };\n\n        if (!schema.isValidChild(rootNode.name, rootBlockName.toLowerCase())) {\n          return;\n        }\n\n        while (node) {\n          next = node.next;\n\n          if (node.type === 3 || node.type === 1 && node.name !== 'p' && !blockElements[node.name] && !node.attr('data-mce-type')) {\n            if (!rootBlockNode) {\n              rootBlockNode = createNode(rootBlockName, 1);\n              rootBlockNode.attr(settings.forced_root_block_attrs);\n              rootNode.insert(rootBlockNode, node);\n              rootBlockNode.append(node);\n            } else {\n              rootBlockNode.append(node);\n            }\n          } else {\n            trim(rootBlockNode);\n            rootBlockNode = null;\n          }\n\n          node = next;\n        }\n\n        trim(rootBlockNode);\n      };\n\n      var createNode = function (name, type) {\n        var node = new AstNode(name, type);\n        var list;\n\n        if (name in nodeFilters) {\n          list = matchedNodes[name];\n\n          if (list) {\n            list.push(node);\n          } else {\n            matchedNodes[name] = [node];\n          }\n        }\n\n        return node;\n      };\n\n      var removeWhitespaceBefore = function (node) {\n        var textNode, textNodeNext, textVal, sibling;\n        var blockElements = schema.getBlockElements();\n\n        for (textNode = node.prev; textNode && textNode.type === 3;) {\n          textVal = textNode.value.replace(endWhiteSpaceRegExp, '');\n\n          if (textVal.length > 0) {\n            textNode.value = textVal;\n            return;\n          }\n\n          textNodeNext = textNode.next;\n\n          if (textNodeNext) {\n            if (textNodeNext.type === 3 && textNodeNext.value.length) {\n              textNode = textNode.prev;\n              continue;\n            }\n\n            if (!blockElements[textNodeNext.name] && textNodeNext.name !== 'script' && textNodeNext.name !== 'style') {\n              textNode = textNode.prev;\n              continue;\n            }\n          }\n\n          sibling = textNode.prev;\n          textNode.remove();\n          textNode = sibling;\n        }\n      };\n\n      var cloneAndExcludeBlocks = function (input) {\n        var name;\n        var output = {};\n\n        for (name in input) {\n          if (name !== 'li' && name !== 'p') {\n            output[name] = input[name];\n          }\n        }\n\n        return output;\n      };\n\n      var parser = SaxParser({\n        validate: validate,\n        allow_html_data_urls: settings.allow_html_data_urls,\n        allow_svg_data_urls: settings.allow_svg_data_urls,\n        allow_script_urls: settings.allow_script_urls,\n        allow_conditional_comments: settings.allow_conditional_comments,\n        preserve_cdata: settings.preserve_cdata,\n        self_closing_elements: cloneAndExcludeBlocks(schema.getSelfClosingElements()),\n        cdata: function (text) {\n          node.append(createNode('#cdata', 4)).value = text;\n        },\n        text: function (text, raw) {\n          var textNode;\n\n          if (!isInWhiteSpacePreservedElement) {\n            text = text.replace(allWhiteSpaceRegExp, ' ');\n\n            if (isLineBreakNode(node.lastChild, blockElements)) {\n              text = text.replace(startWhiteSpaceRegExp, '');\n            }\n          }\n\n          if (text.length !== 0) {\n            textNode = createNode('#text', 3);\n            textNode.raw = !!raw;\n            node.append(textNode).value = text;\n          }\n        },\n        comment: function (text) {\n          node.append(createNode('#comment', 8)).value = text;\n        },\n        pi: function (name, text) {\n          node.append(createNode(name, 7)).value = text;\n          removeWhitespaceBefore(node);\n        },\n        doctype: function (text) {\n          var newNode = node.append(createNode('#doctype', 10));\n          newNode.value = text;\n          removeWhitespaceBefore(node);\n        },\n        start: function (name, attrs, empty) {\n          var newNode, attrFiltersLen, attrName, parent;\n          var elementRule = validate ? schema.getElementRule(name) : {};\n\n          if (elementRule) {\n            newNode = createNode(elementRule.outputName || name, 1);\n            newNode.attributes = attrs;\n            newNode.shortEnded = empty;\n            node.append(newNode);\n            parent = children[node.name];\n\n            if (parent && children[newNode.name] && !parent[newNode.name]) {\n              invalidChildren.push(newNode);\n            }\n\n            attrFiltersLen = attributeFilters.length;\n\n            while (attrFiltersLen--) {\n              attrName = attributeFilters[attrFiltersLen].name;\n\n              if (attrName in attrs.map) {\n                list = matchedAttributes[attrName];\n\n                if (list) {\n                  list.push(newNode);\n                } else {\n                  matchedAttributes[attrName] = [newNode];\n                }\n              }\n            }\n\n            if (blockElements[name]) {\n              removeWhitespaceBefore(newNode);\n            }\n\n            if (!empty) {\n              node = newNode;\n            }\n\n            if (!isInWhiteSpacePreservedElement && whiteSpaceElements[name]) {\n              isInWhiteSpacePreservedElement = true;\n            }\n          }\n        },\n        end: function (name) {\n          var textNode, text, sibling, tempNode;\n          var elementRule = validate ? schema.getElementRule(name) : {};\n\n          if (elementRule) {\n            if (blockElements[name]) {\n              if (!isInWhiteSpacePreservedElement) {\n                textNode = node.firstChild;\n\n                if (textNode && textNode.type === 3) {\n                  text = textNode.value.replace(startWhiteSpaceRegExp, '');\n\n                  if (text.length > 0) {\n                    textNode.value = text;\n                    textNode = textNode.next;\n                  } else {\n                    sibling = textNode.next;\n                    textNode.remove();\n                    textNode = sibling;\n\n                    while (textNode && textNode.type === 3) {\n                      text = textNode.value;\n                      sibling = textNode.next;\n\n                      if (text.length === 0 || isAllWhiteSpaceRegExp.test(text)) {\n                        textNode.remove();\n                        textNode = sibling;\n                      }\n\n                      textNode = sibling;\n                    }\n                  }\n                }\n\n                textNode = node.lastChild;\n\n                if (textNode && textNode.type === 3) {\n                  text = textNode.value.replace(endWhiteSpaceRegExp, '');\n\n                  if (text.length > 0) {\n                    textNode.value = text;\n                    textNode = textNode.prev;\n                  } else {\n                    sibling = textNode.prev;\n                    textNode.remove();\n                    textNode = sibling;\n\n                    while (textNode && textNode.type === 3) {\n                      text = textNode.value;\n                      sibling = textNode.prev;\n\n                      if (text.length === 0 || isAllWhiteSpaceRegExp.test(text)) {\n                        textNode.remove();\n                        textNode = sibling;\n                      }\n\n                      textNode = sibling;\n                    }\n                  }\n                }\n              }\n            }\n\n            if (isInWhiteSpacePreservedElement && whiteSpaceElements[name]) {\n              isInWhiteSpacePreservedElement = false;\n            }\n\n            if (elementRule.removeEmpty && isEmpty$2(schema, nonEmptyElements, whiteSpaceElements, node)) {\n              tempNode = node.parent;\n\n              if (blockElements[node.name]) {\n                node.empty().remove();\n              } else {\n                node.unwrap();\n              }\n\n              node = tempNode;\n              return;\n            }\n\n            if (elementRule.paddEmpty && (isPaddedWithNbsp(node) || isEmpty$2(schema, nonEmptyElements, whiteSpaceElements, node))) {\n              paddEmptyNode(settings, args, blockElements, node);\n            }\n\n            node = node.parent;\n          }\n        }\n      }, schema);\n      var rootNode = node = new AstNode(args.context || settings.root_name, 11);\n      parser.parse(html, args.format);\n\n      if (validate && invalidChildren.length) {\n        if (!args.context) {\n          fixInvalidChildren(invalidChildren);\n        } else {\n          args.invalid = true;\n        }\n      }\n\n      if (rootBlockName && (rootNode.name === 'body' || args.isRootContent)) {\n        addRootBlocks();\n      }\n\n      if (!args.invalid) {\n        for (name in matchedNodes) {\n          if (!matchedNodes.hasOwnProperty(name)) {\n            continue;\n          }\n\n          list = nodeFilters[name];\n          nodes = matchedNodes[name];\n          fi = nodes.length;\n\n          while (fi--) {\n            if (!nodes[fi].parent) {\n              nodes.splice(fi, 1);\n            }\n          }\n\n          for (i = 0, l = list.length; i < l; i++) {\n            list[i](nodes, name, args);\n          }\n        }\n\n        for (i = 0, l = attributeFilters.length; i < l; i++) {\n          list = attributeFilters[i];\n\n          if (list.name in matchedAttributes) {\n            nodes = matchedAttributes[list.name];\n            fi = nodes.length;\n\n            while (fi--) {\n              if (!nodes[fi].parent) {\n                nodes.splice(fi, 1);\n              }\n            }\n\n            for (fi = 0, fl = list.callbacks.length; fi < fl; fi++) {\n              list.callbacks[fi](nodes, list.name, args);\n            }\n          }\n        }\n      }\n\n      return rootNode;\n    };\n\n    var exports = {\n      schema: schema,\n      addAttributeFilter: addAttributeFilter,\n      getAttributeFilters: getAttributeFilters,\n      addNodeFilter: addNodeFilter,\n      getNodeFilters: getNodeFilters,\n      filterNode: filterNode,\n      parse: parse\n    };\n    register$2(exports, settings);\n    register$1(exports, settings);\n    return exports;\n  };\n\n  var register$3 = function (htmlParser, settings, dom) {\n    htmlParser.addAttributeFilter('data-mce-tabindex', function (nodes, name) {\n      var i = nodes.length,\n          node;\n\n      while (i--) {\n        node = nodes[i];\n        node.attr('tabindex', node.attr('data-mce-tabindex'));\n        node.attr(name, null);\n      }\n    });\n    htmlParser.addAttributeFilter('src,href,style', function (nodes, name) {\n      var i = nodes.length,\n          node,\n          value;\n      var internalName = 'data-mce-' + name;\n      var urlConverter = settings.url_converter;\n      var urlConverterScope = settings.url_converter_scope;\n\n      while (i--) {\n        node = nodes[i];\n        value = node.attr(internalName);\n\n        if (value !== undefined) {\n          node.attr(name, value.length > 0 ? value : null);\n          node.attr(internalName, null);\n        } else {\n          value = node.attr(name);\n\n          if (name === 'style') {\n            value = dom.serializeStyle(dom.parseStyle(value), node.name);\n          } else if (urlConverter) {\n            value = urlConverter.call(urlConverterScope, value, name, node.name);\n          }\n\n          node.attr(name, value.length > 0 ? value : null);\n        }\n      }\n    });\n    htmlParser.addAttributeFilter('class', function (nodes) {\n      var i = nodes.length,\n          node,\n          value;\n\n      while (i--) {\n        node = nodes[i];\n        value = node.attr('class');\n\n        if (value) {\n          value = node.attr('class').replace(/(?:^|\\s)mce-item-\\w+(?!\\S)/g, '');\n          node.attr('class', value.length > 0 ? value : null);\n        }\n      }\n    });\n    htmlParser.addAttributeFilter('data-mce-type', function (nodes, name, args) {\n      var i = nodes.length,\n          node;\n\n      while (i--) {\n        node = nodes[i];\n\n        if (node.attr('data-mce-type') === 'bookmark' && !args.cleanup) {\n          var hasChildren = Optional.from(node.firstChild).exists(function (firstChild) {\n            return !isZwsp$1(firstChild.value);\n          });\n\n          if (hasChildren) {\n            node.unwrap();\n          } else {\n            node.remove();\n          }\n        }\n      }\n    });\n    htmlParser.addNodeFilter('noscript', function (nodes) {\n      var i = nodes.length,\n          node;\n\n      while (i--) {\n        node = nodes[i].firstChild;\n\n        if (node) {\n          node.value = Entities.decode(node.value);\n        }\n      }\n    });\n    htmlParser.addNodeFilter('script,style', function (nodes, name) {\n      var i = nodes.length,\n          node,\n          value,\n          type;\n\n      var trim = function (value) {\n        return value.replace(/(<!--\\[CDATA\\[|\\]\\]-->)/g, '\\n').replace(/^[\\r\\n]*|[\\r\\n]*$/g, '').replace(/^\\s*((<!--)?(\\s*\\/\\/)?\\s*<!\\[CDATA\\[|(<!--\\s*)?\\/\\*\\s*<!\\[CDATA\\[\\s*\\*\\/|(\\/\\/)?\\s*<!--|\\/\\*\\s*<!--\\s*\\*\\/)\\s*[\\r\\n]*/gi, '').replace(/\\s*(\\/\\*\\s*\\]\\]>\\s*\\*\\/(-->)?|\\s*\\/\\/\\s*\\]\\]>(-->)?|\\/\\/\\s*(-->)?|\\]\\]>|\\/\\*\\s*-->\\s*\\*\\/|\\s*-->\\s*)\\s*$/g, '');\n      };\n\n      while (i--) {\n        node = nodes[i];\n        value = node.firstChild ? node.firstChild.value : '';\n\n        if (name === 'script') {\n          type = node.attr('type');\n\n          if (type) {\n            node.attr('type', type === 'mce-no/type' ? null : type.replace(/^mce\\-/, ''));\n          }\n\n          if (settings.element_format === 'xhtml' && value.length > 0) {\n            node.firstChild.value = '// <![CDATA[\\n' + trim(value) + '\\n// ]]>';\n          }\n        } else {\n          if (settings.element_format === 'xhtml' && value.length > 0) {\n            node.firstChild.value = '<!--\\n' + trim(value) + '\\n-->';\n          }\n        }\n      }\n    });\n    htmlParser.addNodeFilter('#comment', function (nodes) {\n      var i = nodes.length,\n          node;\n\n      while (i--) {\n        node = nodes[i];\n\n        if (settings.preserve_cdata && node.value.indexOf('[CDATA[') === 0) {\n          node.name = '#cdata';\n          node.type = 4;\n          node.value = dom.decode(node.value.replace(/^\\[CDATA\\[|\\]\\]$/g, ''));\n        } else if (node.value.indexOf('mce:protected ') === 0) {\n          node.name = '#text';\n          node.type = 3;\n          node.raw = true;\n          node.value = unescape(node.value).substr(14);\n        }\n      }\n    });\n    htmlParser.addNodeFilter('xml:namespace,input', function (nodes, name) {\n      var i = nodes.length,\n          node;\n\n      while (i--) {\n        node = nodes[i];\n\n        if (node.type === 7) {\n          node.remove();\n        } else if (node.type === 1) {\n          if (name === 'input' && !node.attr('type')) {\n            node.attr('type', 'text');\n          }\n        }\n      }\n    });\n    htmlParser.addAttributeFilter('data-mce-type', function (nodes) {\n      each(nodes, function (node) {\n        if (node.attr('data-mce-type') === 'format-caret') {\n          if (node.isEmpty(htmlParser.schema.getNonEmptyElements())) {\n            node.remove();\n          } else {\n            node.unwrap();\n          }\n        }\n      });\n    });\n    htmlParser.addAttributeFilter('data-mce-src,data-mce-href,data-mce-style,' + 'data-mce-selected,data-mce-expando,' + 'data-mce-type,data-mce-resize,data-mce-placeholder', function (nodes, name) {\n      var i = nodes.length;\n\n      while (i--) {\n        nodes[i].attr(name, null);\n      }\n    });\n  };\n\n  var trimTrailingBr = function (rootNode) {\n    var isBr = function (node) {\n      return node && node.name === 'br';\n    };\n\n    var brNode1 = rootNode.lastChild;\n\n    if (isBr(brNode1)) {\n      var brNode2 = brNode1.prev;\n\n      if (isBr(brNode2)) {\n        brNode1.remove();\n        brNode2.remove();\n      }\n    }\n  };\n\n  var preProcess = function (editor, node, args) {\n    var doc, oldDoc;\n    var dom = editor.dom;\n    node = node.cloneNode(true);\n    var impl = document.implementation;\n\n    if (impl.createHTMLDocument) {\n      doc = impl.createHTMLDocument('');\n      Tools.each(node.nodeName === 'BODY' ? node.childNodes : [node], function (node) {\n        doc.body.appendChild(doc.importNode(node, true));\n      });\n\n      if (node.nodeName !== 'BODY') {\n        node = doc.body.firstChild;\n      } else {\n        node = doc.body;\n      }\n\n      oldDoc = dom.doc;\n      dom.doc = doc;\n    }\n\n    firePreProcess(editor, __assign(__assign({}, args), {\n      node: node\n    }));\n\n    if (oldDoc) {\n      dom.doc = oldDoc;\n    }\n\n    return node;\n  };\n\n  var shouldFireEvent = function (editor, args) {\n    return editor && editor.hasEventListeners('PreProcess') && !args.no_events;\n  };\n\n  var process = function (editor, node, args) {\n    return shouldFireEvent(editor, args) ? preProcess(editor, node, args) : node;\n  };\n\n  var addTempAttr = function (htmlParser, tempAttrs, name) {\n    if (Tools.inArray(tempAttrs, name) === -1) {\n      htmlParser.addAttributeFilter(name, function (nodes, name) {\n        var i = nodes.length;\n\n        while (i--) {\n          nodes[i].attr(name, null);\n        }\n      });\n      tempAttrs.push(name);\n    }\n  };\n\n  var postProcess$1 = function (editor, args, content) {\n    if (!args.no_events && editor) {\n      var outArgs = firePostProcess(editor, __assign(__assign({}, args), {\n        content: content\n      }));\n      return outArgs.content;\n    } else {\n      return content;\n    }\n  };\n\n  var getHtmlFromNode = function (dom, node, args) {\n    var html = trim$2(args.getInner ? node.innerHTML : dom.getOuterHTML(node));\n    return args.selection || isWsPreserveElement(SugarElement.fromDom(node)) ? html : Tools.trim(html);\n  };\n\n  var parseHtml = function (htmlParser, html, args) {\n    var parserArgs = args.selection ? __assign({\n      forced_root_block: false\n    }, args) : args;\n    var rootNode = htmlParser.parse(html, parserArgs);\n    trimTrailingBr(rootNode);\n    return rootNode;\n  };\n\n  var serializeNode = function (settings, schema, node) {\n    var htmlSerializer = HtmlSerializer(settings, schema);\n    return htmlSerializer.serialize(node);\n  };\n\n  var toHtml = function (editor, settings, schema, rootNode, args) {\n    var content = serializeNode(settings, schema, rootNode);\n    return postProcess$1(editor, args, content);\n  };\n\n  var DomSerializerImpl = function (settings, editor) {\n    var tempAttrs = ['data-mce-selected'];\n    var dom = editor && editor.dom ? editor.dom : DOMUtils.DOM;\n    var schema = editor && editor.schema ? editor.schema : Schema(settings);\n    settings.entity_encoding = settings.entity_encoding || 'named';\n    settings.remove_trailing_brs = 'remove_trailing_brs' in settings ? settings.remove_trailing_brs : true;\n    var htmlParser = DomParser(settings, schema);\n    register$3(htmlParser, settings, dom);\n\n    var serialize = function (node, parserArgs) {\n      if (parserArgs === void 0) {\n        parserArgs = {};\n      }\n\n      var args = __assign({\n        format: 'html'\n      }, parserArgs);\n\n      var targetNode = process(editor, node, args);\n      var html = getHtmlFromNode(dom, targetNode, args);\n      var rootNode = parseHtml(htmlParser, html, args);\n      return args.format === 'tree' ? rootNode : toHtml(editor, settings, schema, rootNode, args);\n    };\n\n    return {\n      schema: schema,\n      addNodeFilter: htmlParser.addNodeFilter,\n      addAttributeFilter: htmlParser.addAttributeFilter,\n      serialize: serialize,\n      addRules: function (rules) {\n        schema.addValidElements(rules);\n      },\n      setRules: function (rules) {\n        schema.setValidElements(rules);\n      },\n      addTempAttr: curry(addTempAttr, htmlParser, tempAttrs),\n      getTempAttrs: constant(tempAttrs),\n      getNodeFilters: htmlParser.getNodeFilters,\n      getAttributeFilters: htmlParser.getAttributeFilters\n    };\n  };\n\n  var DomSerializer = function (settings, editor) {\n    var domSerializer = DomSerializerImpl(settings, editor);\n    return {\n      schema: domSerializer.schema,\n      addNodeFilter: domSerializer.addNodeFilter,\n      addAttributeFilter: domSerializer.addAttributeFilter,\n      serialize: domSerializer.serialize,\n      addRules: domSerializer.addRules,\n      setRules: domSerializer.setRules,\n      addTempAttr: domSerializer.addTempAttr,\n      getTempAttrs: domSerializer.getTempAttrs,\n      getNodeFilters: domSerializer.getNodeFilters,\n      getAttributeFilters: domSerializer.getAttributeFilters\n    };\n  };\n\n  var defaultFormat$1 = 'html';\n\n  var getContent$2 = function (editor, args) {\n    if (args === void 0) {\n      args = {};\n    }\n\n    var format = args.format ? args.format : defaultFormat$1;\n    return getContent(editor, args, format);\n  };\n\n  var setContent$2 = function (editor, content, args) {\n    if (args === void 0) {\n      args = {};\n    }\n\n    return setContent(editor, content, args);\n  };\n\n  var DOM$3 = DOMUtils.DOM;\n\n  var restoreOriginalStyles = function (editor) {\n    DOM$3.setStyle(editor.id, 'display', editor.orgDisplay);\n  };\n\n  var safeDestroy = function (x) {\n    return Optional.from(x).each(function (x) {\n      return x.destroy();\n    });\n  };\n\n  var clearDomReferences = function (editor) {\n    editor.contentAreaContainer = editor.formElement = editor.container = editor.editorContainer = null;\n    editor.bodyElement = editor.contentDocument = editor.contentWindow = null;\n    editor.iframeElement = editor.targetElm = null;\n\n    if (editor.selection) {\n      editor.selection = editor.selection.win = editor.selection.dom = editor.selection.dom.doc = null;\n    }\n  };\n\n  var restoreForm = function (editor) {\n    var form = editor.formElement;\n\n    if (form) {\n      if (form._mceOldSubmit) {\n        form.submit = form._mceOldSubmit;\n        form._mceOldSubmit = null;\n      }\n\n      DOM$3.unbind(form, 'submit reset', editor.formEventDelegate);\n    }\n  };\n\n  var remove$7 = function (editor) {\n    if (!editor.removed) {\n      var _selectionOverrides = editor._selectionOverrides,\n          editorUpload = editor.editorUpload;\n      var body = editor.getBody();\n      var element = editor.getElement();\n\n      if (body) {\n        editor.save({\n          is_removing: true\n        });\n      }\n\n      editor.removed = true;\n      editor.unbindAllNativeEvents();\n\n      if (editor.hasHiddenInput && element) {\n        DOM$3.remove(element.nextSibling);\n      }\n\n      fireRemove(editor);\n      editor.editorManager.remove(editor);\n\n      if (!editor.inline && body) {\n        restoreOriginalStyles(editor);\n      }\n\n      fireDetach(editor);\n      DOM$3.remove(editor.getContainer());\n      safeDestroy(_selectionOverrides);\n      safeDestroy(editorUpload);\n      editor.destroy();\n    }\n  };\n\n  var destroy = function (editor, automatic) {\n    var selection = editor.selection,\n        dom = editor.dom;\n\n    if (editor.destroyed) {\n      return;\n    }\n\n    if (!automatic && !editor.removed) {\n      editor.remove();\n      return;\n    }\n\n    if (!automatic) {\n      editor.editorManager.off('beforeunload', editor._beforeUnload);\n\n      if (editor.theme && editor.theme.destroy) {\n        editor.theme.destroy();\n      }\n\n      safeDestroy(selection);\n      safeDestroy(dom);\n    }\n\n    restoreForm(editor);\n    clearDomReferences(editor);\n    editor.destroyed = true;\n  };\n\n  var hasOwnProperty$2 = Object.prototype.hasOwnProperty;\n\n  var deep$1 = function (old, nu) {\n    var bothObjects = isObject(old) && isObject(nu);\n    return bothObjects ? deepMerge(old, nu) : nu;\n  };\n\n  var baseMerge = function (merger) {\n    return function () {\n      var objects = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        objects[_i] = arguments[_i];\n      }\n\n      if (objects.length === 0) {\n        throw new Error('Can\\'t merge zero objects');\n      }\n\n      var ret = {};\n\n      for (var j = 0; j < objects.length; j++) {\n        var curObject = objects[j];\n\n        for (var key in curObject) {\n          if (hasOwnProperty$2.call(curObject, key)) {\n            ret[key] = merger(ret[key], curObject[key]);\n          }\n        }\n      }\n\n      return ret;\n    };\n  };\n\n  var deepMerge = baseMerge(deep$1);\n\n  var sectionResult = function (sections, settings) {\n    return {\n      sections: constant(sections),\n      settings: constant(settings)\n    };\n  };\n\n  var deviceDetection = detect$3().deviceType;\n  var isTouch = deviceDetection.isTouch();\n  var isPhone = deviceDetection.isPhone();\n  var isTablet = deviceDetection.isTablet();\n  var legacyMobilePlugins = ['lists', 'autolink', 'autosave'];\n  var defaultTouchSettings = {\n    table_grid: false,\n    object_resizing: false,\n    resize: false\n  };\n\n  var normalizePlugins = function (plugins) {\n    var pluginNames = isArray(plugins) ? plugins.join(' ') : plugins;\n    var trimmedPlugins = map(isString(pluginNames) ? pluginNames.split(' ') : [], trim);\n    return filter(trimmedPlugins, function (item) {\n      return item.length > 0;\n    });\n  };\n\n  var filterLegacyMobilePlugins = function (plugins) {\n    return filter(plugins, curry(contains, legacyMobilePlugins));\n  };\n\n  var extractSections = function (keys, settings) {\n    var result = bifilter(settings, function (value, key) {\n      return contains(keys, key);\n    });\n    return sectionResult(result.t, result.f);\n  };\n\n  var getSection = function (sectionResult, name, defaults) {\n    if (defaults === void 0) {\n      defaults = {};\n    }\n\n    var sections = sectionResult.sections();\n    var sectionSettings = sections.hasOwnProperty(name) ? sections[name] : {};\n    return Tools.extend({}, defaults, sectionSettings);\n  };\n\n  var hasSection = function (sectionResult, name) {\n    return sectionResult.sections().hasOwnProperty(name);\n  };\n\n  var isSectionTheme = function (sectionResult, name, theme) {\n    var section = sectionResult.sections();\n    return hasSection(sectionResult, name) && section[name].theme === theme;\n  };\n\n  var getSectionConfig = function (sectionResult, name) {\n    return hasSection(sectionResult, name) ? sectionResult.sections()[name] : {};\n  };\n\n  var getToolbarMode = function (settings, defaultVal) {\n    return get$1(settings, 'toolbar_mode').orThunk(function () {\n      return get$1(settings, 'toolbar_drawer').map(function (val) {\n        return val === false ? 'wrap' : val;\n      });\n    }).getOr(defaultVal);\n  };\n\n  var getDefaultSettings = function (settings, id, documentBaseUrl, isTouch, editor) {\n    var baseDefaults = {\n      id: id,\n      theme: 'silver',\n      toolbar_mode: getToolbarMode(settings, 'floating'),\n      plugins: '',\n      document_base_url: documentBaseUrl,\n      add_form_submit_trigger: true,\n      submit_patch: true,\n      add_unload_trigger: true,\n      convert_urls: true,\n      relative_urls: true,\n      remove_script_host: true,\n      object_resizing: true,\n      doctype: '<!DOCTYPE html>',\n      visual: true,\n      font_size_legacy_values: 'xx-small,small,medium,large,x-large,xx-large,300%',\n      forced_root_block: 'p',\n      hidden_input: true,\n      inline_styles: true,\n      convert_fonts_to_spans: true,\n      indent: true,\n      indent_before: 'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,' + 'tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist',\n      indent_after: 'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,' + 'tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist',\n      entity_encoding: 'named',\n      url_converter: editor.convertURL,\n      url_converter_scope: editor\n    };\n    return __assign(__assign({}, baseDefaults), isTouch ? defaultTouchSettings : {});\n  };\n\n  var getDefaultMobileSettings = function (mobileSettings, isPhone) {\n    var defaultMobileSettings = {\n      resize: false,\n      toolbar_mode: getToolbarMode(mobileSettings, 'scrolling'),\n      toolbar_sticky: false\n    };\n    var defaultPhoneSettings = {\n      menubar: false\n    };\n    return __assign(__assign(__assign({}, defaultTouchSettings), defaultMobileSettings), isPhone ? defaultPhoneSettings : {});\n  };\n\n  var getExternalPlugins$1 = function (overrideSettings, settings) {\n    var userDefinedExternalPlugins = settings.external_plugins ? settings.external_plugins : {};\n\n    if (overrideSettings && overrideSettings.external_plugins) {\n      return Tools.extend({}, overrideSettings.external_plugins, userDefinedExternalPlugins);\n    } else {\n      return userDefinedExternalPlugins;\n    }\n  };\n\n  var combinePlugins = function (forcedPlugins, plugins) {\n    return [].concat(normalizePlugins(forcedPlugins)).concat(normalizePlugins(plugins));\n  };\n\n  var getPlatformPlugins = function (isMobileDevice, sectionResult, desktopPlugins, mobilePlugins) {\n    if (isMobileDevice && isSectionTheme(sectionResult, 'mobile', 'mobile')) {\n      return filterLegacyMobilePlugins(mobilePlugins);\n    } else if (isMobileDevice && hasSection(sectionResult, 'mobile')) {\n      return mobilePlugins;\n    } else {\n      return desktopPlugins;\n    }\n  };\n\n  var processPlugins = function (isMobileDevice, sectionResult, defaultOverrideSettings, settings) {\n    var forcedPlugins = normalizePlugins(defaultOverrideSettings.forced_plugins);\n    var desktopPlugins = normalizePlugins(settings.plugins);\n    var mobileConfig = getSectionConfig(sectionResult, 'mobile');\n    var mobilePlugins = mobileConfig.plugins ? normalizePlugins(mobileConfig.plugins) : desktopPlugins;\n    var platformPlugins = getPlatformPlugins(isMobileDevice, sectionResult, desktopPlugins, mobilePlugins);\n    var combinedPlugins = combinePlugins(forcedPlugins, platformPlugins);\n\n    if (Env.browser.isIE() && contains(combinedPlugins, 'rtc')) {\n      throw new Error('RTC plugin is not supported on IE 11.');\n    }\n\n    return Tools.extend(settings, {\n      plugins: combinedPlugins.join(' ')\n    });\n  };\n\n  var isOnMobile = function (isMobileDevice, sectionResult) {\n    return isMobileDevice && hasSection(sectionResult, 'mobile');\n  };\n\n  var combineSettings = function (isMobileDevice, isPhone, defaultSettings, defaultOverrideSettings, settings) {\n    var defaultDeviceSettings = isMobileDevice ? {\n      mobile: getDefaultMobileSettings(settings.mobile || {}, isPhone)\n    } : {};\n    var sectionResult = extractSections(['mobile'], deepMerge(defaultDeviceSettings, settings));\n    var extendedSettings = Tools.extend(defaultSettings, defaultOverrideSettings, sectionResult.settings(), isOnMobile(isMobileDevice, sectionResult) ? getSection(sectionResult, 'mobile') : {}, {\n      validate: true,\n      external_plugins: getExternalPlugins$1(defaultOverrideSettings, sectionResult.settings())\n    });\n    return processPlugins(isMobileDevice, sectionResult, defaultOverrideSettings, extendedSettings);\n  };\n\n  var getEditorSettings = function (editor, id, documentBaseUrl, defaultOverrideSettings, settings) {\n    var defaultSettings = getDefaultSettings(settings, id, documentBaseUrl, isTouch, editor);\n    return combineSettings(isPhone || isTablet, isPhone, defaultSettings, defaultOverrideSettings, settings);\n  };\n\n  var getFiltered = function (predicate, editor, name) {\n    return Optional.from(editor.settings[name]).filter(predicate);\n  };\n\n  var getParamObject = function (value) {\n    var output = {};\n\n    if (typeof value === 'string') {\n      each(value.indexOf('=') > 0 ? value.split(/[;,](?![^=;,]*(?:[;,]|$))/) : value.split(','), function (val) {\n        var arr = val.split('=');\n\n        if (arr.length > 1) {\n          output[Tools.trim(arr[0])] = Tools.trim(arr[1]);\n        } else {\n          output[Tools.trim(arr[0])] = Tools.trim(arr[0]);\n        }\n      });\n    } else {\n      output = value;\n    }\n\n    return output;\n  };\n\n  var isArrayOf = function (p) {\n    return function (a) {\n      return isArray(a) && forall(a, p);\n    };\n  };\n\n  var getParam = function (editor, name, defaultVal, type) {\n    var value = name in editor.settings ? editor.settings[name] : defaultVal;\n\n    if (type === 'hash') {\n      return getParamObject(value);\n    } else if (type === 'string') {\n      return getFiltered(isString, editor, name).getOr(defaultVal);\n    } else if (type === 'number') {\n      return getFiltered(isNumber, editor, name).getOr(defaultVal);\n    } else if (type === 'boolean') {\n      return getFiltered(isBoolean, editor, name).getOr(defaultVal);\n    } else if (type === 'object') {\n      return getFiltered(isObject, editor, name).getOr(defaultVal);\n    } else if (type === 'array') {\n      return getFiltered(isArray, editor, name).getOr(defaultVal);\n    } else if (type === 'string[]') {\n      return getFiltered(isArrayOf(isString), editor, name).getOr(defaultVal);\n    } else if (type === 'function') {\n      return getFiltered(isFunction, editor, name).getOr(defaultVal);\n    } else {\n      return value;\n    }\n  };\n\n  var CreateIconManager = function () {\n    var lookup = {};\n\n    var add = function (id, iconPack) {\n      lookup[id] = iconPack;\n    };\n\n    var get = function (id) {\n      if (lookup[id]) {\n        return lookup[id];\n      }\n\n      return {\n        icons: {}\n      };\n    };\n\n    var has$1 = function (id) {\n      return has(lookup, id);\n    };\n\n    return {\n      add: add,\n      get: get,\n      has: has$1\n    };\n  };\n\n  var IconManager = CreateIconManager();\n\n  var getProp = function (propName, elm) {\n    var rawElm = elm.dom;\n    return rawElm[propName];\n  };\n\n  var getComputedSizeProp = function (propName, elm) {\n    return parseInt(get$5(elm, propName), 10);\n  };\n\n  var getClientWidth = curry(getProp, 'clientWidth');\n  var getClientHeight = curry(getProp, 'clientHeight');\n  var getMarginTop = curry(getComputedSizeProp, 'margin-top');\n  var getMarginLeft = curry(getComputedSizeProp, 'margin-left');\n\n  var getBoundingClientRect$1 = function (elm) {\n    return elm.dom.getBoundingClientRect();\n  };\n\n  var isInsideElementContentArea = function (bodyElm, clientX, clientY) {\n    var clientWidth = getClientWidth(bodyElm);\n    var clientHeight = getClientHeight(bodyElm);\n    return clientX >= 0 && clientY >= 0 && clientX <= clientWidth && clientY <= clientHeight;\n  };\n\n  var transpose = function (inline, elm, clientX, clientY) {\n    var clientRect = getBoundingClientRect$1(elm);\n    var deltaX = inline ? clientRect.left + elm.dom.clientLeft + getMarginLeft(elm) : 0;\n    var deltaY = inline ? clientRect.top + elm.dom.clientTop + getMarginTop(elm) : 0;\n    var x = clientX - deltaX;\n    var y = clientY - deltaY;\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  var isXYInContentArea = function (editor, clientX, clientY) {\n    var bodyElm = SugarElement.fromDom(editor.getBody());\n    var targetElm = editor.inline ? bodyElm : documentElement(bodyElm);\n    var transposedPoint = transpose(editor.inline, targetElm, clientX, clientY);\n    return isInsideElementContentArea(targetElm, transposedPoint.x, transposedPoint.y);\n  };\n\n  var fromDomSafe = function (node) {\n    return Optional.from(node).map(SugarElement.fromDom);\n  };\n\n  var isEditorAttachedToDom = function (editor) {\n    var rawContainer = editor.inline ? editor.getBody() : editor.getContentAreaContainer();\n    return fromDomSafe(rawContainer).map(inBody).getOr(false);\n  };\n\n  var NotificationManagerImpl = function () {\n    var unimplemented = function () {\n      throw new Error('Theme did not provide a NotificationManager implementation.');\n    };\n\n    return {\n      open: unimplemented,\n      close: unimplemented,\n      reposition: unimplemented,\n      getArgs: unimplemented\n    };\n  };\n\n  var NotificationManager = function (editor) {\n    var notifications = [];\n\n    var getImplementation = function () {\n      var theme = editor.theme;\n      return theme && theme.getNotificationManagerImpl ? theme.getNotificationManagerImpl() : NotificationManagerImpl();\n    };\n\n    var getTopNotification = function () {\n      return Optional.from(notifications[0]);\n    };\n\n    var isEqual = function (a, b) {\n      return a.type === b.type && a.text === b.text && !a.progressBar && !a.timeout && !b.progressBar && !b.timeout;\n    };\n\n    var reposition = function () {\n      if (notifications.length > 0) {\n        getImplementation().reposition(notifications);\n      }\n    };\n\n    var addNotification = function (notification) {\n      notifications.push(notification);\n    };\n\n    var closeNotification = function (notification) {\n      findIndex(notifications, function (otherNotification) {\n        return otherNotification === notification;\n      }).each(function (index) {\n        notifications.splice(index, 1);\n      });\n    };\n\n    var open = function (spec, fireEvent) {\n      if (fireEvent === void 0) {\n        fireEvent = true;\n      }\n\n      if (editor.removed || !isEditorAttachedToDom(editor)) {\n        return;\n      }\n\n      if (fireEvent) {\n        editor.fire('BeforeOpenNotification', {\n          notification: spec\n        });\n      }\n\n      return find(notifications, function (notification) {\n        return isEqual(getImplementation().getArgs(notification), spec);\n      }).getOrThunk(function () {\n        editor.editorManager.setActive(editor);\n        var notification = getImplementation().open(spec, function () {\n          closeNotification(notification);\n          reposition();\n          getTopNotification().fold(function () {\n            return editor.focus();\n          }, function (top) {\n            return focus(SugarElement.fromDom(top.getEl()));\n          });\n        });\n        addNotification(notification);\n        reposition();\n        editor.fire('OpenNotification', {\n          notification: __assign({}, notification)\n        });\n        return notification;\n      });\n    };\n\n    var close = function () {\n      getTopNotification().each(function (notification) {\n        getImplementation().close(notification);\n        closeNotification(notification);\n        reposition();\n      });\n    };\n\n    var getNotifications = function () {\n      return notifications;\n    };\n\n    var registerEvents = function (editor) {\n      editor.on('SkinLoaded', function () {\n        var serviceMessage = getServiceMessage(editor);\n\n        if (serviceMessage) {\n          open({\n            text: serviceMessage,\n            type: 'warning',\n            timeout: 0\n          }, false);\n        }\n      });\n      editor.on('ResizeEditor ResizeWindow NodeChange', function () {\n        Delay.requestAnimationFrame(reposition);\n      });\n      editor.on('remove', function () {\n        each(notifications.slice(), function (notification) {\n          getImplementation().close(notification);\n        });\n      });\n    };\n\n    registerEvents(editor);\n    return {\n      open: open,\n      close: close,\n      getNotifications: getNotifications\n    };\n  };\n\n  var PluginManager = AddOnManager.PluginManager;\n  var ThemeManager = AddOnManager.ThemeManager;\n\n  function WindowManagerImpl() {\n    var unimplemented = function () {\n      throw new Error('Theme did not provide a WindowManager implementation.');\n    };\n\n    return {\n      open: unimplemented,\n      openUrl: unimplemented,\n      alert: unimplemented,\n      confirm: unimplemented,\n      close: unimplemented,\n      getParams: unimplemented,\n      setParams: unimplemented\n    };\n  }\n\n  var WindowManager = function (editor) {\n    var dialogs = [];\n\n    var getImplementation = function () {\n      var theme = editor.theme;\n      return theme && theme.getWindowManagerImpl ? theme.getWindowManagerImpl() : WindowManagerImpl();\n    };\n\n    var funcBind = function (scope, f) {\n      return function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        return f ? f.apply(scope, args) : undefined;\n      };\n    };\n\n    var fireOpenEvent = function (dialog) {\n      editor.fire('OpenWindow', {\n        dialog: dialog\n      });\n    };\n\n    var fireCloseEvent = function (dialog) {\n      editor.fire('CloseWindow', {\n        dialog: dialog\n      });\n    };\n\n    var addDialog = function (dialog) {\n      dialogs.push(dialog);\n      fireOpenEvent(dialog);\n    };\n\n    var closeDialog = function (dialog) {\n      fireCloseEvent(dialog);\n      dialogs = filter(dialogs, function (otherDialog) {\n        return otherDialog !== dialog;\n      });\n\n      if (dialogs.length === 0) {\n        editor.focus();\n      }\n    };\n\n    var getTopDialog = function () {\n      return Optional.from(dialogs[dialogs.length - 1]);\n    };\n\n    var storeSelectionAndOpenDialog = function (openDialog) {\n      editor.editorManager.setActive(editor);\n      store(editor);\n      var dialog = openDialog();\n      addDialog(dialog);\n      return dialog;\n    };\n\n    var open = function (args, params) {\n      return storeSelectionAndOpenDialog(function () {\n        return getImplementation().open(args, params, closeDialog);\n      });\n    };\n\n    var openUrl = function (args) {\n      return storeSelectionAndOpenDialog(function () {\n        return getImplementation().openUrl(args, closeDialog);\n      });\n    };\n\n    var alert = function (message, callback, scope) {\n      var windowManagerImpl = getImplementation();\n      windowManagerImpl.alert(message, funcBind(scope ? scope : windowManagerImpl, callback));\n    };\n\n    var confirm = function (message, callback, scope) {\n      var windowManagerImpl = getImplementation();\n      windowManagerImpl.confirm(message, funcBind(scope ? scope : windowManagerImpl, callback));\n    };\n\n    var close = function () {\n      getTopDialog().each(function (dialog) {\n        getImplementation().close(dialog);\n        closeDialog(dialog);\n      });\n    };\n\n    editor.on('remove', function () {\n      each(dialogs, function (dialog) {\n        getImplementation().close(dialog);\n      });\n    });\n    return {\n      open: open,\n      openUrl: openUrl,\n      alert: alert,\n      confirm: confirm,\n      close: close\n    };\n  };\n\n  var displayNotification = function (editor, message) {\n    editor.notificationManager.open({\n      type: 'error',\n      text: message\n    });\n  };\n\n  var displayError = function (editor, message) {\n    if (editor._skinLoaded) {\n      displayNotification(editor, message);\n    } else {\n      editor.on('SkinLoaded', function () {\n        displayNotification(editor, message);\n      });\n    }\n  };\n\n  var uploadError = function (editor, message) {\n    displayError(editor, I18n.translate(['Failed to upload image: {0}', message]));\n  };\n\n  var logError = function (editor, errorType, msg) {\n    fireError(editor, errorType, {\n      message: msg\n    });\n    console.error(msg);\n  };\n\n  var createLoadError = function (type, url, name) {\n    return name ? 'Failed to load ' + type + ': ' + name + ' from url ' + url : 'Failed to load ' + type + ' url: ' + url;\n  };\n\n  var pluginLoadError = function (editor, url, name) {\n    logError(editor, 'PluginLoadError', createLoadError('plugin', url, name));\n  };\n\n  var iconsLoadError = function (editor, url, name) {\n    logError(editor, 'IconsLoadError', createLoadError('icons', url, name));\n  };\n\n  var languageLoadError = function (editor, url, name) {\n    logError(editor, 'LanguageLoadError', createLoadError('language', url, name));\n  };\n\n  var pluginInitError = function (editor, name, err) {\n    var message = I18n.translate(['Failed to initialize plugin: {0}', name]);\n    fireError(editor, 'PluginLoadError', {\n      message: message\n    });\n    initError(message, err);\n    displayError(editor, message);\n  };\n\n  var initError = function (message) {\n    var x = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      x[_i - 1] = arguments[_i];\n    }\n\n    var console = window.console;\n\n    if (console) {\n      if (console.error) {\n        console.error.apply(console, __spreadArrays([message], x));\n      } else {\n        console.log.apply(console, __spreadArrays([message], x));\n      }\n    }\n  };\n\n  var isContentCssSkinName = function (url) {\n    return /^[a-z0-9\\-]+$/i.test(url);\n  };\n\n  var getContentCssUrls = function (editor) {\n    return transformToUrls(editor, getContentCss(editor));\n  };\n\n  var getFontCssUrls = function (editor) {\n    return transformToUrls(editor, getFontCss(editor));\n  };\n\n  var transformToUrls = function (editor, cssLinks) {\n    var skinUrl = editor.editorManager.baseURL + '/skins/content';\n    var suffix = editor.editorManager.suffix;\n    var contentCssFile = 'content' + suffix + '.css';\n    var inline = editor.inline === true;\n    return map(cssLinks, function (url) {\n      if (isContentCssSkinName(url) && !inline) {\n        return skinUrl + '/' + url + '/' + contentCssFile;\n      } else {\n        return editor.documentBaseURI.toAbsolute(url);\n      }\n    });\n  };\n\n  var appendContentCssFromSettings = function (editor) {\n    editor.contentCSS = editor.contentCSS.concat(getContentCssUrls(editor), getFontCssUrls(editor));\n  };\n\n  var UploadStatus = function () {\n    var PENDING = 1,\n        UPLOADED = 2;\n    var blobUriStatuses = {};\n\n    var createStatus = function (status, resultUri) {\n      return {\n        status: status,\n        resultUri: resultUri\n      };\n    };\n\n    var hasBlobUri = function (blobUri) {\n      return blobUri in blobUriStatuses;\n    };\n\n    var getResultUri = function (blobUri) {\n      var result = blobUriStatuses[blobUri];\n      return result ? result.resultUri : null;\n    };\n\n    var isPending = function (blobUri) {\n      return hasBlobUri(blobUri) ? blobUriStatuses[blobUri].status === PENDING : false;\n    };\n\n    var isUploaded = function (blobUri) {\n      return hasBlobUri(blobUri) ? blobUriStatuses[blobUri].status === UPLOADED : false;\n    };\n\n    var markPending = function (blobUri) {\n      blobUriStatuses[blobUri] = createStatus(PENDING, null);\n    };\n\n    var markUploaded = function (blobUri, resultUri) {\n      blobUriStatuses[blobUri] = createStatus(UPLOADED, resultUri);\n    };\n\n    var removeFailed = function (blobUri) {\n      delete blobUriStatuses[blobUri];\n    };\n\n    var destroy = function () {\n      blobUriStatuses = {};\n    };\n\n    return {\n      hasBlobUri: hasBlobUri,\n      getResultUri: getResultUri,\n      isPending: isPending,\n      isUploaded: isUploaded,\n      markPending: markPending,\n      markUploaded: markUploaded,\n      removeFailed: removeFailed,\n      destroy: destroy\n    };\n  };\n\n  var count$1 = 0;\n\n  var seed = function () {\n    var rnd = function () {\n      return Math.round(Math.random() * 4294967295).toString(36);\n    };\n\n    var now = new Date().getTime();\n    return 's' + now.toString(36) + rnd() + rnd() + rnd();\n  };\n\n  var uuid = function (prefix) {\n    return prefix + count$1++ + seed();\n  };\n\n  var BlobCache = function () {\n    var cache = [];\n\n    var mimeToExt = function (mime) {\n      var mimes = {\n        'image/jpeg': 'jpg',\n        'image/jpg': 'jpg',\n        'image/gif': 'gif',\n        'image/png': 'png',\n        'image/apng': 'apng',\n        'image/avif': 'avif',\n        'image/svg+xml': 'svg',\n        'image/webp': 'webp',\n        'image/bmp': 'bmp',\n        'image/tiff': 'tiff'\n      };\n      return mimes[mime.toLowerCase()] || 'dat';\n    };\n\n    var create = function (o, blob, base64, name, filename) {\n      if (isString(o)) {\n        var id = o;\n        return toBlobInfo({\n          id: id,\n          name: name,\n          filename: filename,\n          blob: blob,\n          base64: base64\n        });\n      } else if (isObject(o)) {\n        return toBlobInfo(o);\n      } else {\n        throw new Error('Unknown input type');\n      }\n    };\n\n    var toBlobInfo = function (o) {\n      if (!o.blob || !o.base64) {\n        throw new Error('blob and base64 representations of the image are required for BlobInfo to be created');\n      }\n\n      var id = o.id || uuid('blobid');\n      var name = o.name || id;\n      var blob = o.blob;\n      return {\n        id: constant(id),\n        name: constant(name),\n        filename: constant(o.filename || name + '.' + mimeToExt(blob.type)),\n        blob: constant(blob),\n        base64: constant(o.base64),\n        blobUri: constant(o.blobUri || URL.createObjectURL(blob)),\n        uri: constant(o.uri)\n      };\n    };\n\n    var add = function (blobInfo) {\n      if (!get(blobInfo.id())) {\n        cache.push(blobInfo);\n      }\n    };\n\n    var findFirst = function (predicate) {\n      return find(cache, predicate).getOrUndefined();\n    };\n\n    var get = function (id) {\n      return findFirst(function (cachedBlobInfo) {\n        return cachedBlobInfo.id() === id;\n      });\n    };\n\n    var getByUri = function (blobUri) {\n      return findFirst(function (blobInfo) {\n        return blobInfo.blobUri() === blobUri;\n      });\n    };\n\n    var getByData = function (base64, type) {\n      return findFirst(function (blobInfo) {\n        return blobInfo.base64() === base64 && blobInfo.blob().type === type;\n      });\n    };\n\n    var removeByUri = function (blobUri) {\n      cache = filter(cache, function (blobInfo) {\n        if (blobInfo.blobUri() === blobUri) {\n          URL.revokeObjectURL(blobInfo.blobUri());\n          return false;\n        }\n\n        return true;\n      });\n    };\n\n    var destroy = function () {\n      each(cache, function (cachedBlobInfo) {\n        URL.revokeObjectURL(cachedBlobInfo.blobUri());\n      });\n      cache = [];\n    };\n\n    return {\n      create: create,\n      add: add,\n      get: get,\n      getByUri: getByUri,\n      getByData: getByData,\n      findFirst: findFirst,\n      removeByUri: removeByUri,\n      destroy: destroy\n    };\n  };\n\n  var Uploader = function (uploadStatus, settings) {\n    var pendingPromises = {};\n\n    var pathJoin = function (path1, path2) {\n      if (path1) {\n        return path1.replace(/\\/$/, '') + '/' + path2.replace(/^\\//, '');\n      }\n\n      return path2;\n    };\n\n    var defaultHandler = function (blobInfo, success, failure, progress) {\n      var xhr = new XMLHttpRequest();\n      xhr.open('POST', settings.url);\n      xhr.withCredentials = settings.credentials;\n\n      xhr.upload.onprogress = function (e) {\n        progress(e.loaded / e.total * 100);\n      };\n\n      xhr.onerror = function () {\n        failure('Image upload failed due to a XHR Transport error. Code: ' + xhr.status);\n      };\n\n      xhr.onload = function () {\n        if (xhr.status < 200 || xhr.status >= 300) {\n          failure('HTTP Error: ' + xhr.status);\n          return;\n        }\n\n        var json = JSON.parse(xhr.responseText);\n\n        if (!json || typeof json.location !== 'string') {\n          failure('Invalid JSON: ' + xhr.responseText);\n          return;\n        }\n\n        success(pathJoin(settings.basePath, json.location));\n      };\n\n      var formData = new FormData();\n      formData.append('file', blobInfo.blob(), blobInfo.filename());\n      xhr.send(formData);\n    };\n\n    var noUpload = function () {\n      return new promiseObj(function (resolve) {\n        resolve([]);\n      });\n    };\n\n    var handlerSuccess = function (blobInfo, url) {\n      return {\n        url: url,\n        blobInfo: blobInfo,\n        status: true\n      };\n    };\n\n    var handlerFailure = function (blobInfo, message, options) {\n      return {\n        url: '',\n        blobInfo: blobInfo,\n        status: false,\n        error: {\n          message: message,\n          options: options\n        }\n      };\n    };\n\n    var resolvePending = function (blobUri, result) {\n      Tools.each(pendingPromises[blobUri], function (resolve) {\n        resolve(result);\n      });\n      delete pendingPromises[blobUri];\n    };\n\n    var uploadBlobInfo = function (blobInfo, handler, openNotification) {\n      uploadStatus.markPending(blobInfo.blobUri());\n      return new promiseObj(function (resolve) {\n        var notification, progress;\n\n        try {\n          var closeNotification_1 = function () {\n            if (notification) {\n              notification.close();\n              progress = noop;\n            }\n          };\n\n          var success = function (url) {\n            closeNotification_1();\n            uploadStatus.markUploaded(blobInfo.blobUri(), url);\n            resolvePending(blobInfo.blobUri(), handlerSuccess(blobInfo, url));\n            resolve(handlerSuccess(blobInfo, url));\n          };\n\n          var failure = function (error, options) {\n            var failureOptions = options ? options : {};\n            closeNotification_1();\n            uploadStatus.removeFailed(blobInfo.blobUri());\n            resolvePending(blobInfo.blobUri(), handlerFailure(blobInfo, error, failureOptions));\n            resolve(handlerFailure(blobInfo, error, failureOptions));\n          };\n\n          progress = function (percent) {\n            if (percent < 0 || percent > 100) {\n              return;\n            }\n\n            Optional.from(notification).orThunk(function () {\n              return Optional.from(openNotification).map(apply);\n            }).each(function (n) {\n              notification = n;\n              n.progressBar.value(percent);\n            });\n          };\n\n          handler(blobInfo, success, failure, progress);\n        } catch (ex) {\n          resolve(handlerFailure(blobInfo, ex.message, {}));\n        }\n      });\n    };\n\n    var isDefaultHandler = function (handler) {\n      return handler === defaultHandler;\n    };\n\n    var pendingUploadBlobInfo = function (blobInfo) {\n      var blobUri = blobInfo.blobUri();\n      return new promiseObj(function (resolve) {\n        pendingPromises[blobUri] = pendingPromises[blobUri] || [];\n        pendingPromises[blobUri].push(resolve);\n      });\n    };\n\n    var uploadBlobs = function (blobInfos, openNotification) {\n      blobInfos = Tools.grep(blobInfos, function (blobInfo) {\n        return !uploadStatus.isUploaded(blobInfo.blobUri());\n      });\n      return promiseObj.all(Tools.map(blobInfos, function (blobInfo) {\n        return uploadStatus.isPending(blobInfo.blobUri()) ? pendingUploadBlobInfo(blobInfo) : uploadBlobInfo(blobInfo, settings.handler, openNotification);\n      }));\n    };\n\n    var upload = function (blobInfos, openNotification) {\n      return !settings.url && isDefaultHandler(settings.handler) ? noUpload() : uploadBlobs(blobInfos, openNotification);\n    };\n\n    if (isFunction(settings.handler) === false) {\n      settings.handler = defaultHandler;\n    }\n\n    return {\n      upload: upload\n    };\n  };\n\n  var openNotification = function (editor) {\n    return function () {\n      return editor.notificationManager.open({\n        text: editor.translate('Image uploading...'),\n        type: 'info',\n        timeout: -1,\n        progressBar: true\n      });\n    };\n  };\n\n  var createUploader = function (editor, uploadStatus) {\n    return Uploader(uploadStatus, {\n      url: getImageUploadUrl(editor),\n      basePath: getImageUploadBasePath(editor),\n      credentials: getImagesUploadCredentials(editor),\n      handler: getImagesUploadHandler(editor)\n    });\n  };\n\n  var ImageUploader = function (editor) {\n    var uploadStatus = UploadStatus();\n    var uploader = createUploader(editor, uploadStatus);\n    return {\n      upload: function (blobInfos, showNotification) {\n        if (showNotification === void 0) {\n          showNotification = true;\n        }\n\n        return uploader.upload(blobInfos, showNotification ? openNotification(editor) : undefined);\n      }\n    };\n  };\n\n  var UploadChangeHandler = function (editor) {\n    var lastChangedLevel = Cell(null);\n    editor.on('change AddUndo', function (e) {\n      lastChangedLevel.set(__assign({}, e.level));\n    });\n\n    var fireIfChanged = function () {\n      var data = editor.undoManager.data;\n      last(data).filter(function (level) {\n        return !isEq$4(lastChangedLevel.get(), level);\n      }).each(function (level) {\n        editor.setDirty(true);\n        editor.fire('change', {\n          level: level,\n          lastLevel: get(data, data.length - 2).getOrNull()\n        });\n      });\n    };\n\n    return {\n      fireIfChanged: fireIfChanged\n    };\n  };\n\n  var EditorUpload = function (editor) {\n    var blobCache = BlobCache();\n    var uploader, imageScanner;\n    var uploadStatus = UploadStatus();\n    var urlFilters = [];\n    var changeHandler = UploadChangeHandler(editor);\n\n    var aliveGuard = function (callback) {\n      return function (result) {\n        if (editor.selection) {\n          return callback(result);\n        }\n\n        return [];\n      };\n    };\n\n    var cacheInvalidator = function (url) {\n      return url + (url.indexOf('?') === -1 ? '?' : '&') + new Date().getTime();\n    };\n\n    var replaceString = function (content, search, replace) {\n      var index = 0;\n\n      do {\n        index = content.indexOf(search, index);\n\n        if (index !== -1) {\n          content = content.substring(0, index) + replace + content.substr(index + search.length);\n          index += replace.length - search.length + 1;\n        }\n      } while (index !== -1);\n\n      return content;\n    };\n\n    var replaceImageUrl = function (content, targetUrl, replacementUrl) {\n      var replacementString = 'src=\"' + replacementUrl + '\"' + (replacementUrl === Env.transparentSrc ? ' data-mce-placeholder=\"1\"' : '');\n      content = replaceString(content, 'src=\"' + targetUrl + '\"', replacementString);\n      content = replaceString(content, 'data-mce-src=\"' + targetUrl + '\"', 'data-mce-src=\"' + replacementUrl + '\"');\n      return content;\n    };\n\n    var replaceUrlInUndoStack = function (targetUrl, replacementUrl) {\n      each(editor.undoManager.data, function (level) {\n        if (level.type === 'fragmented') {\n          level.fragments = map(level.fragments, function (fragment) {\n            return replaceImageUrl(fragment, targetUrl, replacementUrl);\n          });\n        } else {\n          level.content = replaceImageUrl(level.content, targetUrl, replacementUrl);\n        }\n      });\n    };\n\n    var replaceImageUriInView = function (image, resultUri) {\n      var src = editor.convertURL(resultUri, 'src');\n      replaceUrlInUndoStack(image.src, resultUri);\n      editor.$(image).attr({\n        'src': shouldReuseFileName(editor) ? cacheInvalidator(resultUri) : resultUri,\n        'data-mce-src': src\n      });\n    };\n\n    var uploadImages = function (callback) {\n      if (!uploader) {\n        uploader = createUploader(editor, uploadStatus);\n      }\n\n      return scanForImages().then(aliveGuard(function (imageInfos) {\n        var blobInfos = map(imageInfos, function (imageInfo) {\n          return imageInfo.blobInfo;\n        });\n        return uploader.upload(blobInfos, openNotification(editor)).then(aliveGuard(function (result) {\n          var imagesToRemove = [];\n          var filteredResult = map(result, function (uploadInfo, index) {\n            var blobInfo = imageInfos[index].blobInfo;\n            var image = imageInfos[index].image;\n\n            if (uploadInfo.status && shouldReplaceBlobUris(editor)) {\n              blobCache.removeByUri(image.src);\n              replaceImageUriInView(image, uploadInfo.url);\n            } else if (uploadInfo.error) {\n              if (uploadInfo.error.options.remove) {\n                replaceUrlInUndoStack(image.getAttribute('src'), Env.transparentSrc);\n                imagesToRemove.push(image);\n              }\n\n              uploadError(editor, uploadInfo.error.message);\n            }\n\n            return {\n              element: image,\n              status: uploadInfo.status,\n              uploadUri: uploadInfo.url,\n              blobInfo: blobInfo\n            };\n          });\n\n          if (filteredResult.length > 0) {\n            changeHandler.fireIfChanged();\n          }\n\n          if (imagesToRemove.length > 0) {\n            if (isRtc(editor)) {\n              console.error('Removing images on failed uploads is currently unsupported for RTC');\n            } else {\n              editor.undoManager.transact(function () {\n                each(imagesToRemove, function (element) {\n                  editor.dom.remove(element);\n                  blobCache.removeByUri(element.src);\n                });\n              });\n            }\n          }\n\n          if (callback) {\n            callback(filteredResult);\n          }\n\n          return filteredResult;\n        }));\n      }));\n    };\n\n    var uploadImagesAuto = function (callback) {\n      if (isAutomaticUploadsEnabled(editor)) {\n        return uploadImages(callback);\n      }\n    };\n\n    var isValidDataUriImage = function (imgElm) {\n      if (forall(urlFilters, function (filter) {\n        return filter(imgElm);\n      }) === false) {\n        return false;\n      }\n\n      if (imgElm.getAttribute('src').indexOf('data:') === 0) {\n        var dataImgFilter = getImagesDataImgFilter(editor);\n        return dataImgFilter(imgElm);\n      }\n\n      return true;\n    };\n\n    var addFilter = function (filter) {\n      urlFilters.push(filter);\n    };\n\n    var scanForImages = function () {\n      if (!imageScanner) {\n        imageScanner = ImageScanner(uploadStatus, blobCache);\n      }\n\n      return imageScanner.findAll(editor.getBody(), isValidDataUriImage).then(aliveGuard(function (result) {\n        result = filter(result, function (resultItem) {\n          if (typeof resultItem === 'string') {\n            displayError(editor, resultItem);\n            return false;\n          }\n\n          return true;\n        });\n        each(result, function (resultItem) {\n          replaceUrlInUndoStack(resultItem.image.src, resultItem.blobInfo.blobUri());\n          resultItem.image.src = resultItem.blobInfo.blobUri();\n          resultItem.image.removeAttribute('data-mce-src');\n        });\n        return result;\n      }));\n    };\n\n    var destroy = function () {\n      blobCache.destroy();\n      uploadStatus.destroy();\n      imageScanner = uploader = null;\n    };\n\n    var replaceBlobUris = function (content) {\n      return content.replace(/src=\"(blob:[^\"]+)\"/g, function (match, blobUri) {\n        var resultUri = uploadStatus.getResultUri(blobUri);\n\n        if (resultUri) {\n          return 'src=\"' + resultUri + '\"';\n        }\n\n        var blobInfo = blobCache.getByUri(blobUri);\n\n        if (!blobInfo) {\n          blobInfo = foldl(editor.editorManager.get(), function (result, editor) {\n            return result || editor.editorUpload && editor.editorUpload.blobCache.getByUri(blobUri);\n          }, null);\n        }\n\n        if (blobInfo) {\n          var blob = blobInfo.blob();\n          return 'src=\"data:' + blob.type + ';base64,' + blobInfo.base64() + '\"';\n        }\n\n        return match;\n      });\n    };\n\n    editor.on('SetContent', function () {\n      if (isAutomaticUploadsEnabled(editor)) {\n        uploadImagesAuto();\n      } else {\n        scanForImages();\n      }\n    });\n    editor.on('RawSaveContent', function (e) {\n      e.content = replaceBlobUris(e.content);\n    });\n    editor.on('GetContent', function (e) {\n      if (e.source_view || e.format === 'raw' || e.format === 'tree') {\n        return;\n      }\n\n      e.content = replaceBlobUris(e.content);\n    });\n    editor.on('PostRender', function () {\n      editor.parser.addNodeFilter('img', function (images) {\n        each(images, function (img) {\n          var src = img.attr('src');\n\n          if (blobCache.getByUri(src)) {\n            return;\n          }\n\n          var resultUri = uploadStatus.getResultUri(src);\n\n          if (resultUri) {\n            img.attr('src', resultUri);\n          }\n        });\n      });\n    });\n    return {\n      blobCache: blobCache,\n      addFilter: addFilter,\n      uploadImages: uploadImages,\n      uploadImagesAuto: uploadImagesAuto,\n      scanForImages: scanForImages,\n      destroy: destroy\n    };\n  };\n\n  var get$a = function (dom) {\n    var formats = {\n      valigntop: [{\n        selector: 'td,th',\n        styles: {\n          verticalAlign: 'top'\n        }\n      }],\n      valignmiddle: [{\n        selector: 'td,th',\n        styles: {\n          verticalAlign: 'middle'\n        }\n      }],\n      valignbottom: [{\n        selector: 'td,th',\n        styles: {\n          verticalAlign: 'bottom'\n        }\n      }],\n      alignleft: [{\n        selector: 'figure.image',\n        collapsed: false,\n        classes: 'align-left',\n        ceFalseOverride: true,\n        preview: 'font-family font-size'\n      }, {\n        selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n        styles: {\n          textAlign: 'left'\n        },\n        inherit: false,\n        preview: false,\n        defaultBlock: 'div'\n      }, {\n        selector: 'img,table,audio,video',\n        collapsed: false,\n        styles: {\n          float: 'left'\n        },\n        preview: 'font-family font-size'\n      }],\n      aligncenter: [{\n        selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n        styles: {\n          textAlign: 'center'\n        },\n        inherit: false,\n        preview: 'font-family font-size',\n        defaultBlock: 'div'\n      }, {\n        selector: 'figure.image',\n        collapsed: false,\n        classes: 'align-center',\n        ceFalseOverride: true,\n        preview: 'font-family font-size'\n      }, {\n        selector: 'img,audio,video',\n        collapsed: false,\n        styles: {\n          display: 'block',\n          marginLeft: 'auto',\n          marginRight: 'auto'\n        },\n        preview: false\n      }, {\n        selector: 'table',\n        collapsed: false,\n        styles: {\n          marginLeft: 'auto',\n          marginRight: 'auto'\n        },\n        preview: 'font-family font-size'\n      }],\n      alignright: [{\n        selector: 'figure.image',\n        collapsed: false,\n        classes: 'align-right',\n        ceFalseOverride: true,\n        preview: 'font-family font-size'\n      }, {\n        selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n        styles: {\n          textAlign: 'right'\n        },\n        inherit: false,\n        preview: 'font-family font-size',\n        defaultBlock: 'div'\n      }, {\n        selector: 'img,table,audio,video',\n        collapsed: false,\n        styles: {\n          float: 'right'\n        },\n        preview: 'font-family font-size'\n      }],\n      alignjustify: [{\n        selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n        styles: {\n          textAlign: 'justify'\n        },\n        inherit: false,\n        defaultBlock: 'div',\n        preview: 'font-family font-size'\n      }],\n      bold: [{\n        inline: 'strong',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }, {\n        inline: 'span',\n        styles: {\n          fontWeight: 'bold'\n        }\n      }, {\n        inline: 'b',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }],\n      italic: [{\n        inline: 'em',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }, {\n        inline: 'span',\n        styles: {\n          fontStyle: 'italic'\n        }\n      }, {\n        inline: 'i',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }],\n      underline: [{\n        inline: 'span',\n        styles: {\n          textDecoration: 'underline'\n        },\n        exact: true\n      }, {\n        inline: 'u',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }],\n      strikethrough: [{\n        inline: 'span',\n        styles: {\n          textDecoration: 'line-through'\n        },\n        exact: true\n      }, {\n        inline: 'strike',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }, {\n        inline: 's',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }],\n      forecolor: {\n        inline: 'span',\n        styles: {\n          color: '%value'\n        },\n        links: true,\n        remove_similar: true,\n        clear_child_styles: true\n      },\n      hilitecolor: {\n        inline: 'span',\n        styles: {\n          backgroundColor: '%value'\n        },\n        links: true,\n        remove_similar: true,\n        clear_child_styles: true\n      },\n      fontname: {\n        inline: 'span',\n        toggle: false,\n        styles: {\n          fontFamily: '%value'\n        },\n        clear_child_styles: true\n      },\n      fontsize: {\n        inline: 'span',\n        toggle: false,\n        styles: {\n          fontSize: '%value'\n        },\n        clear_child_styles: true\n      },\n      lineheight: {\n        selector: 'h1,h2,h3,h4,h5,h6,p,li,td,th,div',\n        defaultBlock: 'p',\n        styles: {\n          lineHeight: '%value'\n        }\n      },\n      fontsize_class: {\n        inline: 'span',\n        attributes: {\n          class: '%value'\n        }\n      },\n      blockquote: {\n        block: 'blockquote',\n        wrapper: true,\n        remove: 'all'\n      },\n      subscript: {\n        inline: 'sub'\n      },\n      superscript: {\n        inline: 'sup'\n      },\n      code: {\n        inline: 'code'\n      },\n      link: {\n        inline: 'a',\n        selector: 'a',\n        remove: 'all',\n        split: true,\n        deep: true,\n        onmatch: function (node, _fmt, _itemName) {\n          return isElement$1(node) && node.hasAttribute('href');\n        },\n        onformat: function (elm, _fmt, vars) {\n          Tools.each(vars, function (value, key) {\n            dom.setAttrib(elm, key, value);\n          });\n        }\n      },\n      removeformat: [{\n        selector: 'b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small',\n        remove: 'all',\n        split: true,\n        expand: false,\n        block_expand: true,\n        deep: true\n      }, {\n        selector: 'span',\n        attributes: ['style', 'class'],\n        remove: 'empty',\n        split: true,\n        expand: false,\n        deep: true\n      }, {\n        selector: '*',\n        attributes: ['style', 'class'],\n        split: false,\n        expand: false,\n        deep: true\n      }]\n    };\n    Tools.each('p h1 h2 h3 h4 h5 h6 div address pre dt dd samp'.split(/\\s/), function (name) {\n      formats[name] = {\n        block: name,\n        remove: 'all'\n      };\n    });\n    return formats;\n  };\n\n  var FormatRegistry = function (editor) {\n    var formats = {};\n\n    var get = function (name) {\n      return name ? formats[name] : formats;\n    };\n\n    var has$1 = function (name) {\n      return has(formats, name);\n    };\n\n    var register = function (name, format) {\n      if (name) {\n        if (typeof name !== 'string') {\n          Tools.each(name, function (format, name) {\n            register(name, format);\n          });\n        } else {\n          if (!isArray(format)) {\n            format = [format];\n          }\n\n          Tools.each(format, function (format) {\n            if (typeof format.deep === 'undefined') {\n              format.deep = !format.selector;\n            }\n\n            if (typeof format.split === 'undefined') {\n              format.split = !format.selector || format.inline;\n            }\n\n            if (typeof format.remove === 'undefined' && format.selector && !format.inline) {\n              format.remove = 'none';\n            }\n\n            if (format.selector && format.inline) {\n              format.mixed = true;\n              format.block_expand = true;\n            }\n\n            if (typeof format.classes === 'string') {\n              format.classes = format.classes.split(/\\s+/);\n            }\n          });\n          formats[name] = format;\n        }\n      }\n    };\n\n    var unregister = function (name) {\n      if (name && formats[name]) {\n        delete formats[name];\n      }\n\n      return formats;\n    };\n\n    register(get$a(editor.dom));\n    register(getFormats(editor));\n    return {\n      get: get,\n      has: has$1,\n      register: register,\n      unregister: unregister\n    };\n  };\n\n  var each$e = Tools.each;\n  var dom = DOMUtils.DOM;\n\n  var parsedSelectorToHtml = function (ancestry, editor) {\n    var elm, item, fragment;\n    var schema = editor && editor.schema || Schema({});\n\n    var decorate = function (elm, item) {\n      if (item.classes.length) {\n        dom.addClass(elm, item.classes.join(' '));\n      }\n\n      dom.setAttribs(elm, item.attrs);\n    };\n\n    var createElement = function (sItem) {\n      item = typeof sItem === 'string' ? {\n        name: sItem,\n        classes: [],\n        attrs: {}\n      } : sItem;\n      var elm = dom.create(item.name);\n      decorate(elm, item);\n      return elm;\n    };\n\n    var getRequiredParent = function (elm, candidate) {\n      var name = typeof elm !== 'string' ? elm.nodeName.toLowerCase() : elm;\n      var elmRule = schema.getElementRule(name);\n      var parentsRequired = elmRule && elmRule.parentsRequired;\n\n      if (parentsRequired && parentsRequired.length) {\n        return candidate && Tools.inArray(parentsRequired, candidate) !== -1 ? candidate : parentsRequired[0];\n      } else {\n        return false;\n      }\n    };\n\n    var wrapInHtml = function (elm, ancestry, siblings) {\n      var parent, parentCandidate;\n      var ancestor = ancestry.length > 0 && ancestry[0];\n      var ancestorName = ancestor && ancestor.name;\n      var parentRequired = getRequiredParent(elm, ancestorName);\n\n      if (parentRequired) {\n        if (ancestorName === parentRequired) {\n          parentCandidate = ancestry[0];\n          ancestry = ancestry.slice(1);\n        } else {\n          parentCandidate = parentRequired;\n        }\n      } else if (ancestor) {\n        parentCandidate = ancestry[0];\n        ancestry = ancestry.slice(1);\n      } else if (!siblings) {\n        return elm;\n      }\n\n      if (parentCandidate) {\n        parent = createElement(parentCandidate);\n        parent.appendChild(elm);\n      }\n\n      if (siblings) {\n        if (!parent) {\n          parent = dom.create('div');\n          parent.appendChild(elm);\n        }\n\n        Tools.each(siblings, function (sibling) {\n          var siblingElm = createElement(sibling);\n          parent.insertBefore(siblingElm, elm);\n        });\n      }\n\n      return wrapInHtml(parent, ancestry, parentCandidate && parentCandidate.siblings);\n    };\n\n    if (ancestry && ancestry.length) {\n      item = ancestry[0];\n      elm = createElement(item);\n      fragment = dom.create('div');\n      fragment.appendChild(wrapInHtml(elm, ancestry.slice(1), item.siblings));\n      return fragment;\n    } else {\n      return '';\n    }\n  };\n\n  var parseSelectorItem = function (item) {\n    var tagName;\n    var obj = {\n      classes: [],\n      attrs: {}\n    };\n    item = obj.selector = Tools.trim(item);\n\n    if (item !== '*') {\n      tagName = item.replace(/(?:([#\\.]|::?)([\\w\\-]+)|(\\[)([^\\]]+)\\]?)/g, function ($0, $1, $2, $3, $4) {\n        switch ($1) {\n          case '#':\n            obj.attrs.id = $2;\n            break;\n\n          case '.':\n            obj.classes.push($2);\n            break;\n\n          case ':':\n            if (Tools.inArray('checked disabled enabled read-only required'.split(' '), $2) !== -1) {\n              obj.attrs[$2] = $2;\n            }\n\n            break;\n        }\n\n        if ($3 === '[') {\n          var m = $4.match(/([\\w\\-]+)(?:\\=\\\"([^\\\"]+))?/);\n\n          if (m) {\n            obj.attrs[m[1]] = m[2];\n          }\n        }\n\n        return '';\n      });\n    }\n\n    obj.name = tagName || 'div';\n    return obj;\n  };\n\n  var parseSelector = function (selector) {\n    if (!selector || typeof selector !== 'string') {\n      return [];\n    }\n\n    selector = selector.split(/\\s*,\\s*/)[0];\n    selector = selector.replace(/\\s*(~\\+|~|\\+|>)\\s*/g, '$1');\n    return Tools.map(selector.split(/(?:>|\\s+(?![^\\[\\]]+\\]))/), function (item) {\n      var siblings = Tools.map(item.split(/(?:~\\+|~|\\+)/), parseSelectorItem);\n      var obj = siblings.pop();\n\n      if (siblings.length) {\n        obj.siblings = siblings;\n      }\n\n      return obj;\n    }).reverse();\n  };\n\n  var getCssText = function (editor, format) {\n    var name, previewFrag;\n    var previewCss = '',\n        parentFontSize;\n    var previewStyles = getPreviewStyles(editor);\n\n    if (previewStyles === '') {\n      return '';\n    }\n\n    var removeVars = function (val) {\n      return val.replace(/%(\\w+)/g, '');\n    };\n\n    if (typeof format === 'string') {\n      format = editor.formatter.get(format);\n\n      if (!format) {\n        return;\n      }\n\n      format = format[0];\n    }\n\n    if ('preview' in format) {\n      var previewOpt = get$1(format, 'preview');\n\n      if (previewOpt.is(false)) {\n        return '';\n      } else {\n        previewStyles = previewOpt.getOr(previewStyles);\n      }\n    }\n\n    name = format.block || format.inline || 'span';\n    var items = parseSelector(format.selector);\n\n    if (items.length) {\n      if (!items[0].name) {\n        items[0].name = name;\n      }\n\n      name = format.selector;\n      previewFrag = parsedSelectorToHtml(items, editor);\n    } else {\n      previewFrag = parsedSelectorToHtml([name], editor);\n    }\n\n    var previewElm = dom.select(name, previewFrag)[0] || previewFrag.firstChild;\n    each$e(format.styles, function (value, name) {\n      var newValue = removeVars(value);\n\n      if (newValue) {\n        dom.setStyle(previewElm, name, newValue);\n      }\n    });\n    each$e(format.attributes, function (value, name) {\n      var newValue = removeVars(value);\n\n      if (newValue) {\n        dom.setAttrib(previewElm, name, newValue);\n      }\n    });\n    each$e(format.classes, function (value) {\n      var newValue = removeVars(value);\n\n      if (!dom.hasClass(previewElm, newValue)) {\n        dom.addClass(previewElm, newValue);\n      }\n    });\n    editor.fire('PreviewFormats');\n    dom.setStyles(previewFrag, {\n      position: 'absolute',\n      left: -65535\n    });\n    editor.getBody().appendChild(previewFrag);\n    parentFontSize = dom.getStyle(editor.getBody(), 'fontSize', true);\n    parentFontSize = /px$/.test(parentFontSize) ? parseInt(parentFontSize, 10) : 0;\n    each$e(previewStyles.split(' '), function (name) {\n      var value = dom.getStyle(previewElm, name, true);\n\n      if (name === 'background-color' && /transparent|rgba\\s*\\([^)]+,\\s*0\\)/.test(value)) {\n        value = dom.getStyle(editor.getBody(), name, true);\n\n        if (dom.toHex(value).toLowerCase() === '#ffffff') {\n          return;\n        }\n      }\n\n      if (name === 'color') {\n        if (dom.toHex(value).toLowerCase() === '#000000') {\n          return;\n        }\n      }\n\n      if (name === 'font-size') {\n        if (/em|%$/.test(value)) {\n          if (parentFontSize === 0) {\n            return;\n          }\n\n          var numValue = parseFloat(value) / (/%$/.test(value) ? 100 : 1);\n          value = numValue * parentFontSize + 'px';\n        }\n      }\n\n      if (name === 'border' && value) {\n        previewCss += 'padding:0 2px;';\n      }\n\n      previewCss += name + ':' + value + ';';\n    });\n    editor.fire('AfterPreviewFormats');\n    dom.remove(previewFrag);\n    return previewCss;\n  };\n\n  var setup$6 = function (editor) {\n    editor.addShortcut('meta+b', '', 'Bold');\n    editor.addShortcut('meta+i', '', 'Italic');\n    editor.addShortcut('meta+u', '', 'Underline');\n\n    for (var i = 1; i <= 6; i++) {\n      editor.addShortcut('access+' + i, '', ['FormatBlock', false, 'h' + i]);\n    }\n\n    editor.addShortcut('access+7', '', ['FormatBlock', false, 'p']);\n    editor.addShortcut('access+8', '', ['FormatBlock', false, 'div']);\n    editor.addShortcut('access+9', '', ['FormatBlock', false, 'address']);\n  };\n\n  var Formatter = function (editor) {\n    var formats = FormatRegistry(editor);\n    var formatChangeState = Cell(null);\n    setup$6(editor);\n    setup$3(editor);\n    return {\n      get: formats.get,\n      has: formats.has,\n      register: formats.register,\n      unregister: formats.unregister,\n      apply: function (name, vars, node) {\n        applyFormat$1(editor, name, vars, node);\n      },\n      remove: function (name, vars, node, similar) {\n        removeFormat$1(editor, name, vars, node, similar);\n      },\n      toggle: function (name, vars, node) {\n        toggleFormat(editor, name, vars, node);\n      },\n      match: function (name, vars, node) {\n        return matchFormat(editor, name, vars, node);\n      },\n      closest: function (names) {\n        return closestFormat(editor, names);\n      },\n      matchAll: function (names, vars) {\n        return matchAllFormats(editor, names, vars);\n      },\n      matchNode: function (node, names, vars, similar) {\n        return matchNodeFormat(editor, node, names, vars, similar);\n      },\n      canApply: function (name) {\n        return canApplyFormat(editor, name);\n      },\n      formatChanged: function (formats, callback, similar) {\n        return formatChanged(editor, formatChangeState, formats, callback, similar);\n      },\n      getCssText: curry(getCssText, editor)\n    };\n  };\n\n  var registerEvents$1 = function (editor, undoManager, locks) {\n    var isFirstTypedCharacter = Cell(false);\n\n    var addNonTypingUndoLevel = function (e) {\n      setTyping(undoManager, false, locks);\n      undoManager.add({}, e);\n    };\n\n    editor.on('init', function () {\n      undoManager.add();\n    });\n    editor.on('BeforeExecCommand', function (e) {\n      var cmd = e.command.toLowerCase();\n\n      if (cmd !== 'undo' && cmd !== 'redo' && cmd !== 'mcerepaint') {\n        endTyping(undoManager, locks);\n        undoManager.beforeChange();\n      }\n    });\n    editor.on('ExecCommand', function (e) {\n      var cmd = e.command.toLowerCase();\n\n      if (cmd !== 'undo' && cmd !== 'redo' && cmd !== 'mcerepaint') {\n        addNonTypingUndoLevel(e);\n      }\n    });\n    editor.on('ObjectResizeStart cut', function () {\n      undoManager.beforeChange();\n    });\n    editor.on('SaveContent ObjectResized blur', addNonTypingUndoLevel);\n    editor.on('dragend', addNonTypingUndoLevel);\n    editor.on('keyup', function (e) {\n      var keyCode = e.keyCode;\n\n      if (e.isDefaultPrevented()) {\n        return;\n      }\n\n      if (keyCode >= 33 && keyCode <= 36 || keyCode >= 37 && keyCode <= 40 || keyCode === 45 || e.ctrlKey) {\n        addNonTypingUndoLevel();\n        editor.nodeChanged();\n      }\n\n      if (keyCode === 46 || keyCode === 8) {\n        editor.nodeChanged();\n      }\n\n      if (isFirstTypedCharacter.get() && undoManager.typing && isEq$4(createFromEditor(editor), undoManager.data[0]) === false) {\n        if (editor.isDirty() === false) {\n          editor.setDirty(true);\n          editor.fire('change', {\n            level: undoManager.data[0],\n            lastLevel: null\n          });\n        }\n\n        editor.fire('TypingUndo');\n        isFirstTypedCharacter.set(false);\n        editor.nodeChanged();\n      }\n    });\n    editor.on('keydown', function (e) {\n      var keyCode = e.keyCode;\n\n      if (e.isDefaultPrevented()) {\n        return;\n      }\n\n      if (keyCode >= 33 && keyCode <= 36 || keyCode >= 37 && keyCode <= 40 || keyCode === 45) {\n        if (undoManager.typing) {\n          addNonTypingUndoLevel(e);\n        }\n\n        return;\n      }\n\n      var modKey = e.ctrlKey && !e.altKey || e.metaKey;\n\n      if ((keyCode < 16 || keyCode > 20) && keyCode !== 224 && keyCode !== 91 && !undoManager.typing && !modKey) {\n        undoManager.beforeChange();\n        setTyping(undoManager, true, locks);\n        undoManager.add({}, e);\n        isFirstTypedCharacter.set(true);\n      }\n    });\n    editor.on('mousedown', function (e) {\n      if (undoManager.typing) {\n        addNonTypingUndoLevel(e);\n      }\n    });\n\n    var isInsertReplacementText = function (event) {\n      return event.inputType === 'insertReplacementText';\n    };\n\n    var isInsertTextDataNull = function (event) {\n      return event.inputType === 'insertText' && event.data === null;\n    };\n\n    var isInsertFromPasteOrDrop = function (event) {\n      return event.inputType === 'insertFromPaste' || event.inputType === 'insertFromDrop';\n    };\n\n    editor.on('input', function (e) {\n      if (e.inputType && (isInsertReplacementText(e) || isInsertTextDataNull(e) || isInsertFromPasteOrDrop(e))) {\n        addNonTypingUndoLevel(e);\n      }\n    });\n    editor.on('AddUndo Undo Redo ClearUndos', function (e) {\n      if (!e.isDefaultPrevented()) {\n        editor.nodeChanged();\n      }\n    });\n  };\n\n  var addKeyboardShortcuts = function (editor) {\n    editor.addShortcut('meta+z', '', 'Undo');\n    editor.addShortcut('meta+y,meta+shift+z', '', 'Redo');\n  };\n\n  var UndoManager = function (editor) {\n    var beforeBookmark = Cell(Optional.none());\n    var locks = Cell(0);\n    var index = Cell(0);\n    var undoManager = {\n      data: [],\n      typing: false,\n      beforeChange: function () {\n        beforeChange$1(editor, locks, beforeBookmark);\n      },\n      add: function (level, event) {\n        return addUndoLevel$1(editor, undoManager, index, locks, beforeBookmark, level, event);\n      },\n      undo: function () {\n        return undo$1(editor, undoManager, locks, index);\n      },\n      redo: function () {\n        return redo$1(editor, index, undoManager.data);\n      },\n      clear: function () {\n        clear$1(editor, undoManager, index);\n      },\n      reset: function () {\n        reset$1(editor, undoManager);\n      },\n      hasUndo: function () {\n        return hasUndo$1(editor, undoManager, index);\n      },\n      hasRedo: function () {\n        return hasRedo$1(editor, undoManager, index);\n      },\n      transact: function (callback) {\n        return transact$1(editor, undoManager, locks, callback);\n      },\n      ignore: function (callback) {\n        ignore$1(editor, locks, callback);\n      },\n      extra: function (callback1, callback2) {\n        extra$1(editor, undoManager, index, callback1, callback2);\n      }\n    };\n\n    if (!isRtc(editor)) {\n      registerEvents$1(editor, undoManager, locks);\n    }\n\n    addKeyboardShortcuts(editor);\n    return undoManager;\n  };\n\n  var nonTypingKeycodes = [9, 27, VK.HOME, VK.END, 19, 20, 44, 144, 145, 33, 34, 45, 16, 17, 18, 91, 92, 93, VK.DOWN, VK.UP, VK.LEFT, VK.RIGHT].concat(Env.browser.isFirefox() ? [224] : []);\n  var placeholderAttr = 'data-mce-placeholder';\n\n  var isKeyboardEvent = function (e) {\n    return e.type === 'keydown' || e.type === 'keyup';\n  };\n\n  var isDeleteEvent = function (e) {\n    var keyCode = e.keyCode;\n    return keyCode === VK.BACKSPACE || keyCode === VK.DELETE;\n  };\n\n  var isNonTypingKeyboardEvent = function (e) {\n    if (isKeyboardEvent(e)) {\n      var keyCode = e.keyCode;\n      return !isDeleteEvent(e) && (VK.metaKeyPressed(e) || e.altKey || keyCode >= 112 && keyCode <= 123 || contains(nonTypingKeycodes, keyCode));\n    } else {\n      return false;\n    }\n  };\n\n  var isTypingKeyboardEvent = function (e) {\n    return isKeyboardEvent(e) && !(isDeleteEvent(e) || e.type === 'keyup' && e.keyCode === 229);\n  };\n\n  var isVisuallyEmpty = function (dom, rootElm, forcedRootBlock) {\n    if (isEmpty(SugarElement.fromDom(rootElm), false)) {\n      var isForcedRootBlockFalse = forcedRootBlock === '';\n      var firstElement = rootElm.firstElementChild;\n\n      if (!firstElement) {\n        return true;\n      } else if (dom.getStyle(rootElm.firstElementChild, 'padding-left') || dom.getStyle(rootElm.firstElementChild, 'padding-right')) {\n        return false;\n      } else {\n        return isForcedRootBlockFalse ? !dom.isBlock(firstElement) : forcedRootBlock === firstElement.nodeName.toLowerCase();\n      }\n    } else {\n      return false;\n    }\n  };\n\n  var setup$7 = function (editor) {\n    var dom = editor.dom;\n    var rootBlock = getForcedRootBlock(editor);\n    var placeholder = getPlaceholder(editor);\n\n    var updatePlaceholder = function (e, initial) {\n      if (isNonTypingKeyboardEvent(e)) {\n        return;\n      }\n\n      var body = editor.getBody();\n      var showPlaceholder = isTypingKeyboardEvent(e) ? false : isVisuallyEmpty(dom, body, rootBlock);\n      var isPlaceholderShown = dom.getAttrib(body, placeholderAttr) !== '';\n\n      if (isPlaceholderShown !== showPlaceholder || initial) {\n        dom.setAttrib(body, placeholderAttr, showPlaceholder ? placeholder : null);\n        dom.setAttrib(body, 'aria-placeholder', showPlaceholder ? placeholder : null);\n        firePlaceholderToggle(editor, showPlaceholder);\n        editor.on(showPlaceholder ? 'keydown' : 'keyup', updatePlaceholder);\n        editor.off(showPlaceholder ? 'keyup' : 'keydown', updatePlaceholder);\n      }\n    };\n\n    if (placeholder) {\n      editor.on('init', function (e) {\n        updatePlaceholder(e, true);\n        editor.on('change SetContent ExecCommand', updatePlaceholder);\n        editor.on('paste', function (e) {\n          return Delay.setEditorTimeout(editor, function () {\n            return updatePlaceholder(e);\n          });\n        });\n      });\n    }\n  };\n\n  var strongRtl = /[\\u0591-\\u07FF\\uFB1D-\\uFDFF\\uFE70-\\uFEFC]/;\n\n  var hasStrongRtl = function (text) {\n    return strongRtl.test(text);\n  };\n\n  var isInlineTarget = function (editor, elm) {\n    return is$1(SugarElement.fromDom(elm), getInlineBoundarySelector(editor));\n  };\n\n  var isRtl$1 = function (element) {\n    return DOMUtils.DOM.getStyle(element, 'direction', true) === 'rtl' || hasStrongRtl(element.textContent);\n  };\n\n  var findInlineParents = function (isInlineTarget, rootNode, pos) {\n    return filter(DOMUtils.DOM.getParents(pos.container(), '*', rootNode), isInlineTarget);\n  };\n\n  var findRootInline = function (isInlineTarget, rootNode, pos) {\n    var parents = findInlineParents(isInlineTarget, rootNode, pos);\n    return Optional.from(parents[parents.length - 1]);\n  };\n\n  var hasSameParentBlock = function (rootNode, node1, node2) {\n    var block1 = getParentBlock(node1, rootNode);\n    var block2 = getParentBlock(node2, rootNode);\n    return block1 && block1 === block2;\n  };\n\n  var isAtZwsp = function (pos) {\n    return isBeforeInline(pos) || isAfterInline(pos);\n  };\n\n  var normalizePosition = function (forward, pos) {\n    if (!pos) {\n      return pos;\n    }\n\n    var container = pos.container(),\n        offset = pos.offset();\n\n    if (forward) {\n      if (isCaretContainerInline(container)) {\n        if (isText$1(container.nextSibling)) {\n          return CaretPosition(container.nextSibling, 0);\n        } else {\n          return CaretPosition.after(container);\n        }\n      } else {\n        return isBeforeInline(pos) ? CaretPosition(container, offset + 1) : pos;\n      }\n    } else {\n      if (isCaretContainerInline(container)) {\n        if (isText$1(container.previousSibling)) {\n          return CaretPosition(container.previousSibling, container.previousSibling.data.length);\n        } else {\n          return CaretPosition.before(container);\n        }\n      } else {\n        return isAfterInline(pos) ? CaretPosition(container, offset - 1) : pos;\n      }\n    }\n  };\n\n  var normalizeForwards = curry(normalizePosition, true);\n  var normalizeBackwards = curry(normalizePosition, false);\n\n  var isBeforeRoot = function (rootNode) {\n    return function (elm) {\n      return eq$2(rootNode, SugarElement.fromDom(elm.dom.parentNode));\n    };\n  };\n\n  var getParentBlock$1 = function (rootNode, elm) {\n    return contains$2(rootNode, elm) ? closest(elm, function (element) {\n      return isTextBlock(element) || isListItem(element);\n    }, isBeforeRoot(rootNode)) : Optional.none();\n  };\n\n  var placeCaretInEmptyBody = function (editor) {\n    var body = editor.getBody();\n    var node = body.firstChild && editor.dom.isBlock(body.firstChild) ? body.firstChild : body;\n    editor.selection.setCursorLocation(node, 0);\n  };\n\n  var paddEmptyBody = function (editor) {\n    if (editor.dom.isEmpty(editor.getBody())) {\n      editor.setContent('');\n      placeCaretInEmptyBody(editor);\n    }\n  };\n\n  var willDeleteLastPositionInElement = function (forward, fromPos, elm) {\n    return lift2(firstPositionIn(elm), lastPositionIn(elm), function (firstPos, lastPos) {\n      var normalizedFirstPos = normalizePosition(true, firstPos);\n      var normalizedLastPos = normalizePosition(false, lastPos);\n      var normalizedFromPos = normalizePosition(false, fromPos);\n\n      if (forward) {\n        return nextPosition(elm, normalizedFromPos).exists(function (nextPos) {\n          return nextPos.isEqual(normalizedLastPos) && fromPos.isEqual(normalizedFirstPos);\n        });\n      } else {\n        return prevPosition(elm, normalizedFromPos).exists(function (prevPos) {\n          return prevPos.isEqual(normalizedFirstPos) && fromPos.isEqual(normalizedLastPos);\n        });\n      }\n    }).getOr(true);\n  };\n\n  var blockPosition = function (block, position) {\n    return {\n      block: block,\n      position: position\n    };\n  };\n\n  var blockBoundary = function (from, to) {\n    return {\n      from: from,\n      to: to\n    };\n  };\n\n  var getBlockPosition = function (rootNode, pos) {\n    var rootElm = SugarElement.fromDom(rootNode);\n    var containerElm = SugarElement.fromDom(pos.container());\n    return getParentBlock$1(rootElm, containerElm).map(function (block) {\n      return blockPosition(block, pos);\n    });\n  };\n\n  var isDifferentBlocks = function (blockBoundary) {\n    return eq$2(blockBoundary.from.block, blockBoundary.to.block) === false;\n  };\n\n  var hasSameParent = function (blockBoundary) {\n    return parent(blockBoundary.from.block).bind(function (parent1) {\n      return parent(blockBoundary.to.block).filter(function (parent2) {\n        return eq$2(parent1, parent2);\n      });\n    }).isSome();\n  };\n\n  var isEditable = function (blockBoundary) {\n    return isContentEditableFalse(blockBoundary.from.block.dom) === false && isContentEditableFalse(blockBoundary.to.block.dom) === false;\n  };\n\n  var skipLastBr = function (rootNode, forward, blockPosition) {\n    if (isBr(blockPosition.position.getNode()) && isEmpty(blockPosition.block) === false) {\n      return positionIn(false, blockPosition.block.dom).bind(function (lastPositionInBlock) {\n        if (lastPositionInBlock.isEqual(blockPosition.position)) {\n          return fromPosition(forward, rootNode, lastPositionInBlock).bind(function (to) {\n            return getBlockPosition(rootNode, to);\n          });\n        } else {\n          return Optional.some(blockPosition);\n        }\n      }).getOr(blockPosition);\n    } else {\n      return blockPosition;\n    }\n  };\n\n  var readFromRange = function (rootNode, forward, rng) {\n    var fromBlockPos = getBlockPosition(rootNode, CaretPosition.fromRangeStart(rng));\n    var toBlockPos = fromBlockPos.bind(function (blockPos) {\n      return fromPosition(forward, rootNode, blockPos.position).bind(function (to) {\n        return getBlockPosition(rootNode, to).map(function (blockPos) {\n          return skipLastBr(rootNode, forward, blockPos);\n        });\n      });\n    });\n    return lift2(fromBlockPos, toBlockPos, blockBoundary).filter(function (blockBoundary) {\n      return isDifferentBlocks(blockBoundary) && hasSameParent(blockBoundary) && isEditable(blockBoundary);\n    });\n  };\n\n  var read$3 = function (rootNode, forward, rng) {\n    return rng.collapsed ? readFromRange(rootNode, forward, rng) : Optional.none();\n  };\n\n  var getChildrenUntilBlockBoundary = function (block) {\n    var children$1 = children(block);\n    return findIndex(children$1, isBlock).fold(function () {\n      return children$1;\n    }, function (index) {\n      return children$1.slice(0, index);\n    });\n  };\n\n  var extractChildren = function (block) {\n    var children = getChildrenUntilBlockBoundary(block);\n    each(children, remove);\n    return children;\n  };\n\n  var removeEmptyRoot = function (rootNode, block) {\n    var parents = parentsAndSelf(block, rootNode);\n    return find(parents.reverse(), function (element) {\n      return isEmpty(element);\n    }).each(remove);\n  };\n\n  var isEmptyBefore = function (el) {\n    return filter(prevSiblings(el), function (el) {\n      return !isEmpty(el);\n    }).length === 0;\n  };\n\n  var nestedBlockMerge = function (rootNode, fromBlock, toBlock, insertionPoint) {\n    if (isEmpty(toBlock)) {\n      fillWithPaddingBr(toBlock);\n      return firstPositionIn(toBlock.dom);\n    }\n\n    if (isEmptyBefore(insertionPoint) && isEmpty(fromBlock)) {\n      before(insertionPoint, SugarElement.fromTag('br'));\n    }\n\n    var position = prevPosition(toBlock.dom, CaretPosition.before(insertionPoint.dom));\n    each(extractChildren(fromBlock), function (child) {\n      before(insertionPoint, child);\n    });\n    removeEmptyRoot(rootNode, fromBlock);\n    return position;\n  };\n\n  var sidelongBlockMerge = function (rootNode, fromBlock, toBlock) {\n    if (isEmpty(toBlock)) {\n      remove(toBlock);\n\n      if (isEmpty(fromBlock)) {\n        fillWithPaddingBr(fromBlock);\n      }\n\n      return firstPositionIn(fromBlock.dom);\n    }\n\n    var position = lastPositionIn(toBlock.dom);\n    each(extractChildren(fromBlock), function (child) {\n      append(toBlock, child);\n    });\n    removeEmptyRoot(rootNode, fromBlock);\n    return position;\n  };\n\n  var findInsertionPoint = function (toBlock, block) {\n    var parentsAndSelf$1 = parentsAndSelf(block, toBlock);\n    return Optional.from(parentsAndSelf$1[parentsAndSelf$1.length - 1]);\n  };\n\n  var getInsertionPoint = function (fromBlock, toBlock) {\n    return contains$2(toBlock, fromBlock) ? findInsertionPoint(toBlock, fromBlock) : Optional.none();\n  };\n\n  var trimBr = function (first, block) {\n    positionIn(first, block.dom).map(function (position) {\n      return position.getNode();\n    }).map(SugarElement.fromDom).filter(isBr$1).each(remove);\n  };\n\n  var mergeBlockInto = function (rootNode, fromBlock, toBlock) {\n    trimBr(true, fromBlock);\n    trimBr(false, toBlock);\n    return getInsertionPoint(fromBlock, toBlock).fold(curry(sidelongBlockMerge, rootNode, fromBlock, toBlock), curry(nestedBlockMerge, rootNode, fromBlock, toBlock));\n  };\n\n  var mergeBlocks = function (rootNode, forward, block1, block2) {\n    return forward ? mergeBlockInto(rootNode, block2, block1) : mergeBlockInto(rootNode, block1, block2);\n  };\n\n  var backspaceDelete$1 = function (editor, forward) {\n    var rootNode = SugarElement.fromDom(editor.getBody());\n    var position = read$3(rootNode.dom, forward, editor.selection.getRng()).bind(function (blockBoundary) {\n      return mergeBlocks(rootNode, forward, blockBoundary.from.block, blockBoundary.to.block);\n    });\n    position.each(function (pos) {\n      editor.selection.setRng(pos.toRange());\n    });\n    return position.isSome();\n  };\n\n  var deleteRangeMergeBlocks = function (rootNode, selection) {\n    var rng = selection.getRng();\n    return lift2(getParentBlock$1(rootNode, SugarElement.fromDom(rng.startContainer)), getParentBlock$1(rootNode, SugarElement.fromDom(rng.endContainer)), function (block1, block2) {\n      if (eq$2(block1, block2) === false) {\n        rng.deleteContents();\n        mergeBlocks(rootNode, true, block1, block2).each(function (pos) {\n          selection.setRng(pos.toRange());\n        });\n        return true;\n      } else {\n        return false;\n      }\n    }).getOr(false);\n  };\n\n  var isRawNodeInTable = function (root, rawNode) {\n    var node = SugarElement.fromDom(rawNode);\n    var isRoot = curry(eq$2, root);\n    return ancestor(node, isTableCell$1, isRoot).isSome();\n  };\n\n  var isSelectionInTable = function (root, rng) {\n    return isRawNodeInTable(root, rng.startContainer) || isRawNodeInTable(root, rng.endContainer);\n  };\n\n  var isEverythingSelected = function (root, rng) {\n    var noPrevious = prevPosition(root.dom, CaretPosition.fromRangeStart(rng)).isNone();\n    var noNext = nextPosition(root.dom, CaretPosition.fromRangeEnd(rng)).isNone();\n    return !isSelectionInTable(root, rng) && noPrevious && noNext;\n  };\n\n  var emptyEditor = function (editor) {\n    editor.setContent('');\n    editor.selection.setCursorLocation();\n    return true;\n  };\n\n  var deleteRange$1 = function (editor) {\n    var rootNode = SugarElement.fromDom(editor.getBody());\n    var rng = editor.selection.getRng();\n    return isEverythingSelected(rootNode, rng) ? emptyEditor(editor) : deleteRangeMergeBlocks(rootNode, editor.selection);\n  };\n\n  var backspaceDelete$2 = function (editor, _forward) {\n    return editor.selection.isCollapsed() ? false : deleteRange$1(editor);\n  };\n\n  var isContentEditableTrue$2 = isContentEditableTrue;\n  var isContentEditableFalse$7 = isContentEditableFalse;\n\n  var showCaret = function (direction, editor, node, before, scrollIntoView) {\n    return Optional.from(editor._selectionOverrides.showCaret(direction, node, before, scrollIntoView));\n  };\n\n  var getNodeRange = function (node) {\n    var rng = node.ownerDocument.createRange();\n    rng.selectNode(node);\n    return rng;\n  };\n\n  var selectNode = function (editor, node) {\n    var e = editor.fire('BeforeObjectSelected', {\n      target: node\n    });\n\n    if (e.isDefaultPrevented()) {\n      return Optional.none();\n    }\n\n    return Optional.some(getNodeRange(node));\n  };\n\n  var renderCaretAtRange = function (editor, range, scrollIntoView) {\n    var normalizedRange = normalizeRange(1, editor.getBody(), range);\n    var caretPosition = CaretPosition.fromRangeStart(normalizedRange);\n    var caretPositionNode = caretPosition.getNode();\n\n    if (isInlineFakeCaretTarget(caretPositionNode)) {\n      return showCaret(1, editor, caretPositionNode, !caretPosition.isAtEnd(), false);\n    }\n\n    var caretPositionBeforeNode = caretPosition.getNode(true);\n\n    if (isInlineFakeCaretTarget(caretPositionBeforeNode)) {\n      return showCaret(1, editor, caretPositionBeforeNode, false, false);\n    }\n\n    var ceRoot = editor.dom.getParent(caretPosition.getNode(), function (node) {\n      return isContentEditableFalse$7(node) || isContentEditableTrue$2(node);\n    });\n\n    if (isInlineFakeCaretTarget(ceRoot)) {\n      return showCaret(1, editor, ceRoot, false, scrollIntoView);\n    }\n\n    return Optional.none();\n  };\n\n  var renderRangeCaret = function (editor, range, scrollIntoView) {\n    return range.collapsed ? renderCaretAtRange(editor, range, scrollIntoView).getOr(range) : range;\n  };\n\n  var isBeforeBoundary = function (pos) {\n    return isBeforeContentEditableFalse(pos) || isBeforeMedia(pos);\n  };\n\n  var isAfterBoundary = function (pos) {\n    return isAfterContentEditableFalse(pos) || isAfterMedia(pos);\n  };\n\n  var trimEmptyTextNode$1 = function (dom, node) {\n    if (isText$1(node) && node.data.length === 0) {\n      dom.remove(node);\n    }\n  };\n\n  var deleteContentAndShowCaret = function (editor, range, node, direction, forward, peekCaretPosition) {\n    showCaret(direction, editor, peekCaretPosition.getNode(!forward), forward, true).each(function (caretRange) {\n      if (range.collapsed) {\n        var deleteRange = range.cloneRange();\n\n        if (forward) {\n          deleteRange.setEnd(caretRange.startContainer, caretRange.startOffset);\n        } else {\n          deleteRange.setStart(caretRange.endContainer, caretRange.endOffset);\n        }\n\n        deleteRange.deleteContents();\n      } else {\n        range.deleteContents();\n      }\n\n      editor.selection.setRng(caretRange);\n    });\n    trimEmptyTextNode$1(editor.dom, node);\n    return true;\n  };\n\n  var deleteBoundaryText = function (editor, forward) {\n    var range = editor.selection.getRng();\n\n    if (!isText$1(range.commonAncestorContainer)) {\n      return false;\n    }\n\n    var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n    var caretWalker = CaretWalker(editor.getBody());\n    var getNextPosFn = curry(getVisualCaretPosition, forward ? caretWalker.next : caretWalker.prev);\n    var isBeforeFn = forward ? isBeforeBoundary : isAfterBoundary;\n    var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n    var nextCaretPosition = normalizePosition(forward, getNextPosFn(caretPosition));\n\n    if (!nextCaretPosition || !isMoveInsideSameBlock(caretPosition, nextCaretPosition)) {\n      return false;\n    } else if (isBeforeFn(nextCaretPosition)) {\n      return deleteContentAndShowCaret(editor, range, caretPosition.getNode(), direction, forward, nextCaretPosition);\n    }\n\n    var peekCaretPosition = getNextPosFn(nextCaretPosition);\n\n    if (peekCaretPosition && isBeforeFn(peekCaretPosition)) {\n      if (isMoveInsideSameBlock(nextCaretPosition, peekCaretPosition)) {\n        return deleteContentAndShowCaret(editor, range, caretPosition.getNode(), direction, forward, peekCaretPosition);\n      }\n    }\n\n    return false;\n  };\n\n  var backspaceDelete$3 = function (editor, forward) {\n    return deleteBoundaryText(editor, forward);\n  };\n\n  var isCompoundElement = function (node) {\n    return isTableCell$1(SugarElement.fromDom(node)) || isListItem(SugarElement.fromDom(node));\n  };\n\n  var DeleteAction = Adt.generate([{\n    remove: ['element']\n  }, {\n    moveToElement: ['element']\n  }, {\n    moveToPosition: ['position']\n  }]);\n\n  var isAtContentEditableBlockCaret = function (forward, from) {\n    var elm = from.getNode(forward === false);\n    var caretLocation = forward ? 'after' : 'before';\n    return isElement$1(elm) && elm.getAttribute('data-mce-caret') === caretLocation;\n  };\n\n  var isDeleteFromCefDifferentBlocks = function (root, forward, from, to) {\n    var inSameBlock = function (elm) {\n      return isInline(SugarElement.fromDom(elm)) && !isInSameBlock(from, to, root);\n    };\n\n    return getRelativeCefElm(!forward, from).fold(function () {\n      return getRelativeCefElm(forward, to).fold(never, inSameBlock);\n    }, inSameBlock);\n  };\n\n  var deleteEmptyBlockOrMoveToCef = function (root, forward, from, to) {\n    var toCefElm = to.getNode(forward === false);\n    return getParentBlock$1(SugarElement.fromDom(root), SugarElement.fromDom(from.getNode())).map(function (blockElm) {\n      return isEmpty(blockElm) ? DeleteAction.remove(blockElm.dom) : DeleteAction.moveToElement(toCefElm);\n    }).orThunk(function () {\n      return Optional.some(DeleteAction.moveToElement(toCefElm));\n    });\n  };\n\n  var findCefPosition = function (root, forward, from) {\n    return fromPosition(forward, root, from).bind(function (to) {\n      if (isCompoundElement(to.getNode())) {\n        return Optional.none();\n      } else if (isDeleteFromCefDifferentBlocks(root, forward, from, to)) {\n        return Optional.none();\n      } else if (forward && isContentEditableFalse(to.getNode())) {\n        return deleteEmptyBlockOrMoveToCef(root, forward, from, to);\n      } else if (forward === false && isContentEditableFalse(to.getNode(true))) {\n        return deleteEmptyBlockOrMoveToCef(root, forward, from, to);\n      } else if (forward && isAfterContentEditableFalse(from)) {\n        return Optional.some(DeleteAction.moveToPosition(to));\n      } else if (forward === false && isBeforeContentEditableFalse(from)) {\n        return Optional.some(DeleteAction.moveToPosition(to));\n      } else {\n        return Optional.none();\n      }\n    });\n  };\n\n  var getContentEditableBlockAction = function (forward, elm) {\n    if (forward && isContentEditableFalse(elm.nextSibling)) {\n      return Optional.some(DeleteAction.moveToElement(elm.nextSibling));\n    } else if (forward === false && isContentEditableFalse(elm.previousSibling)) {\n      return Optional.some(DeleteAction.moveToElement(elm.previousSibling));\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var skipMoveToActionFromInlineCefToContent = function (root, from, deleteAction) {\n    return deleteAction.fold(function (elm) {\n      return Optional.some(DeleteAction.remove(elm));\n    }, function (elm) {\n      return Optional.some(DeleteAction.moveToElement(elm));\n    }, function (to) {\n      if (isInSameBlock(from, to, root)) {\n        return Optional.none();\n      } else {\n        return Optional.some(DeleteAction.moveToPosition(to));\n      }\n    });\n  };\n\n  var getContentEditableAction = function (root, forward, from) {\n    if (isAtContentEditableBlockCaret(forward, from)) {\n      return getContentEditableBlockAction(forward, from.getNode(forward === false)).fold(function () {\n        return findCefPosition(root, forward, from);\n      }, Optional.some);\n    } else {\n      return findCefPosition(root, forward, from).bind(function (deleteAction) {\n        return skipMoveToActionFromInlineCefToContent(root, from, deleteAction);\n      });\n    }\n  };\n\n  var read$4 = function (root, forward, rng) {\n    var normalizedRange = normalizeRange(forward ? 1 : -1, root, rng);\n    var from = CaretPosition.fromRangeStart(normalizedRange);\n    var rootElement = SugarElement.fromDom(root);\n\n    if (forward === false && isAfterContentEditableFalse(from)) {\n      return Optional.some(DeleteAction.remove(from.getNode(true)));\n    } else if (forward && isBeforeContentEditableFalse(from)) {\n      return Optional.some(DeleteAction.remove(from.getNode()));\n    } else if (forward === false && isBeforeContentEditableFalse(from) && isAfterBr(rootElement, from)) {\n      return findPreviousBr(rootElement, from).map(function (br) {\n        return DeleteAction.remove(br.getNode());\n      });\n    } else if (forward && isAfterContentEditableFalse(from) && isBeforeBr(rootElement, from)) {\n      return findNextBr(rootElement, from).map(function (br) {\n        return DeleteAction.remove(br.getNode());\n      });\n    } else {\n      return getContentEditableAction(root, forward, from);\n    }\n  };\n\n  var deleteElement$1 = function (editor, forward) {\n    return function (element) {\n      editor._selectionOverrides.hideFakeCaret();\n\n      deleteElement(editor, forward, SugarElement.fromDom(element));\n      return true;\n    };\n  };\n\n  var moveToElement = function (editor, forward) {\n    return function (element) {\n      var pos = forward ? CaretPosition.before(element) : CaretPosition.after(element);\n      editor.selection.setRng(pos.toRange());\n      return true;\n    };\n  };\n\n  var moveToPosition = function (editor) {\n    return function (pos) {\n      editor.selection.setRng(pos.toRange());\n      return true;\n    };\n  };\n\n  var getAncestorCe = function (editor, node) {\n    return Optional.from(getContentEditableRoot(editor.getBody(), node));\n  };\n\n  var backspaceDeleteCaret = function (editor, forward) {\n    var selectedNode = editor.selection.getNode();\n    return getAncestorCe(editor, selectedNode).filter(isContentEditableFalse).fold(function () {\n      return read$4(editor.getBody(), forward, editor.selection.getRng()).exists(function (deleteAction) {\n        return deleteAction.fold(deleteElement$1(editor, forward), moveToElement(editor, forward), moveToPosition(editor));\n      });\n    }, always);\n  };\n\n  var deleteOffscreenSelection = function (rootElement) {\n    each(descendants$1(rootElement, '.mce-offscreen-selection'), remove);\n  };\n\n  var backspaceDeleteRange = function (editor, forward) {\n    var selectedNode = editor.selection.getNode();\n\n    if (isContentEditableFalse(selectedNode)) {\n      var hasCefAncestor = getAncestorCe(editor, selectedNode.parentNode).filter(isContentEditableFalse);\n      return hasCefAncestor.fold(function () {\n        deleteOffscreenSelection(SugarElement.fromDom(editor.getBody()));\n        deleteElement(editor, forward, SugarElement.fromDom(editor.selection.getNode()));\n        paddEmptyBody(editor);\n        return true;\n      }, always);\n    }\n\n    return false;\n  };\n\n  var paddEmptyElement = function (editor) {\n    var dom = editor.dom,\n        selection = editor.selection;\n    var ceRoot = getContentEditableRoot(editor.getBody(), selection.getNode());\n\n    if (isContentEditableTrue(ceRoot) && dom.isBlock(ceRoot) && dom.isEmpty(ceRoot)) {\n      var br = dom.create('br', {\n        'data-mce-bogus': '1'\n      });\n      dom.setHTML(ceRoot, '');\n      ceRoot.appendChild(br);\n      selection.setRng(CaretPosition.before(br).toRange());\n    }\n\n    return true;\n  };\n\n  var backspaceDelete$4 = function (editor, forward) {\n    if (editor.selection.isCollapsed()) {\n      return backspaceDeleteCaret(editor, forward);\n    } else {\n      return backspaceDeleteRange(editor, forward);\n    }\n  };\n\n  var deleteCaret$1 = function (editor, forward) {\n    var fromPos = CaretPosition.fromRangeStart(editor.selection.getRng());\n    return fromPosition(forward, editor.getBody(), fromPos).filter(function (pos) {\n      return forward ? isBeforeImageBlock(pos) : isAfterImageBlock(pos);\n    }).bind(function (pos) {\n      return Optional.from(getChildNodeAtRelativeOffset(forward ? 0 : -1, pos));\n    }).exists(function (elm) {\n      editor.selection.select(elm);\n      return true;\n    });\n  };\n\n  var backspaceDelete$5 = function (editor, forward) {\n    return editor.selection.isCollapsed() ? deleteCaret$1(editor, forward) : false;\n  };\n\n  var isText$8 = isText$1;\n\n  var startsWithCaretContainer$1 = function (node) {\n    return isText$8(node) && node.data[0] === ZWSP;\n  };\n\n  var endsWithCaretContainer$1 = function (node) {\n    return isText$8(node) && node.data[node.data.length - 1] === ZWSP;\n  };\n\n  var createZwsp = function (node) {\n    return node.ownerDocument.createTextNode(ZWSP);\n  };\n\n  var insertBefore$1 = function (node) {\n    if (isText$8(node.previousSibling)) {\n      if (endsWithCaretContainer$1(node.previousSibling)) {\n        return node.previousSibling;\n      } else {\n        node.previousSibling.appendData(ZWSP);\n        return node.previousSibling;\n      }\n    } else if (isText$8(node)) {\n      if (startsWithCaretContainer$1(node)) {\n        return node;\n      } else {\n        node.insertData(0, ZWSP);\n        return node;\n      }\n    } else {\n      var newNode = createZwsp(node);\n      node.parentNode.insertBefore(newNode, node);\n      return newNode;\n    }\n  };\n\n  var insertAfter$1 = function (node) {\n    if (isText$8(node.nextSibling)) {\n      if (startsWithCaretContainer$1(node.nextSibling)) {\n        return node.nextSibling;\n      } else {\n        node.nextSibling.insertData(0, ZWSP);\n        return node.nextSibling;\n      }\n    } else if (isText$8(node)) {\n      if (endsWithCaretContainer$1(node)) {\n        return node;\n      } else {\n        node.appendData(ZWSP);\n        return node;\n      }\n    } else {\n      var newNode = createZwsp(node);\n\n      if (node.nextSibling) {\n        node.parentNode.insertBefore(newNode, node.nextSibling);\n      } else {\n        node.parentNode.appendChild(newNode);\n      }\n\n      return newNode;\n    }\n  };\n\n  var insertInline$1 = function (before, node) {\n    return before ? insertBefore$1(node) : insertAfter$1(node);\n  };\n\n  var insertInlineBefore = curry(insertInline$1, true);\n  var insertInlineAfter = curry(insertInline$1, false);\n\n  var insertInlinePos = function (pos, before) {\n    if (isText$1(pos.container())) {\n      return insertInline$1(before, pos.container());\n    } else {\n      return insertInline$1(before, pos.getNode());\n    }\n  };\n\n  var isPosCaretContainer = function (pos, caret) {\n    var caretNode = caret.get();\n    return caretNode && pos.container() === caretNode && isCaretContainerInline(caretNode);\n  };\n\n  var renderCaret = function (caret, location) {\n    return location.fold(function (element) {\n      remove$5(caret.get());\n      var text = insertInlineBefore(element);\n      caret.set(text);\n      return Optional.some(CaretPosition(text, text.length - 1));\n    }, function (element) {\n      return firstPositionIn(element).map(function (pos) {\n        if (!isPosCaretContainer(pos, caret)) {\n          remove$5(caret.get());\n          var text = insertInlinePos(pos, true);\n          caret.set(text);\n          return CaretPosition(text, 1);\n        } else {\n          return CaretPosition(caret.get(), 1);\n        }\n      });\n    }, function (element) {\n      return lastPositionIn(element).map(function (pos) {\n        if (!isPosCaretContainer(pos, caret)) {\n          remove$5(caret.get());\n          var text = insertInlinePos(pos, false);\n          caret.set(text);\n          return CaretPosition(text, text.length - 1);\n        } else {\n          return CaretPosition(caret.get(), caret.get().length - 1);\n        }\n      });\n    }, function (element) {\n      remove$5(caret.get());\n      var text = insertInlineAfter(element);\n      caret.set(text);\n      return Optional.some(CaretPosition(text, 1));\n    });\n  };\n\n  var evaluateUntil = function (fns, args) {\n    for (var i = 0; i < fns.length; i++) {\n      var result = fns[i].apply(null, args);\n\n      if (result.isSome()) {\n        return result;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var Location = Adt.generate([{\n    before: ['element']\n  }, {\n    start: ['element']\n  }, {\n    end: ['element']\n  }, {\n    after: ['element']\n  }]);\n\n  var rescope = function (rootNode, node) {\n    var parentBlock = getParentBlock(node, rootNode);\n    return parentBlock ? parentBlock : rootNode;\n  };\n\n  var before$4 = function (isInlineTarget, rootNode, pos) {\n    var nPos = normalizeForwards(pos);\n    var scope = rescope(rootNode, nPos.container());\n    return findRootInline(isInlineTarget, scope, nPos).fold(function () {\n      return nextPosition(scope, nPos).bind(curry(findRootInline, isInlineTarget, scope)).map(function (inline) {\n        return Location.before(inline);\n      });\n    }, Optional.none);\n  };\n\n  var isNotInsideFormatCaretContainer = function (rootNode, elm) {\n    return getParentCaretContainer(rootNode, elm) === null;\n  };\n\n  var findInsideRootInline = function (isInlineTarget, rootNode, pos) {\n    return findRootInline(isInlineTarget, rootNode, pos).filter(curry(isNotInsideFormatCaretContainer, rootNode));\n  };\n\n  var start = function (isInlineTarget, rootNode, pos) {\n    var nPos = normalizeBackwards(pos);\n    return findInsideRootInline(isInlineTarget, rootNode, nPos).bind(function (inline) {\n      var prevPos = prevPosition(inline, nPos);\n      return prevPos.isNone() ? Optional.some(Location.start(inline)) : Optional.none();\n    });\n  };\n\n  var end = function (isInlineTarget, rootNode, pos) {\n    var nPos = normalizeForwards(pos);\n    return findInsideRootInline(isInlineTarget, rootNode, nPos).bind(function (inline) {\n      var nextPos = nextPosition(inline, nPos);\n      return nextPos.isNone() ? Optional.some(Location.end(inline)) : Optional.none();\n    });\n  };\n\n  var after$3 = function (isInlineTarget, rootNode, pos) {\n    var nPos = normalizeBackwards(pos);\n    var scope = rescope(rootNode, nPos.container());\n    return findRootInline(isInlineTarget, scope, nPos).fold(function () {\n      return prevPosition(scope, nPos).bind(curry(findRootInline, isInlineTarget, scope)).map(function (inline) {\n        return Location.after(inline);\n      });\n    }, Optional.none);\n  };\n\n  var isValidLocation = function (location) {\n    return isRtl$1(getElement(location)) === false;\n  };\n\n  var readLocation = function (isInlineTarget, rootNode, pos) {\n    var location = evaluateUntil([before$4, start, end, after$3], [isInlineTarget, rootNode, pos]);\n    return location.filter(isValidLocation);\n  };\n\n  var getElement = function (location) {\n    return location.fold(identity, identity, identity, identity);\n  };\n\n  var getName = function (location) {\n    return location.fold(constant('before'), constant('start'), constant('end'), constant('after'));\n  };\n\n  var outside = function (location) {\n    return location.fold(Location.before, Location.before, Location.after, Location.after);\n  };\n\n  var inside = function (location) {\n    return location.fold(Location.start, Location.start, Location.end, Location.end);\n  };\n\n  var isEq$5 = function (location1, location2) {\n    return getName(location1) === getName(location2) && getElement(location1) === getElement(location2);\n  };\n\n  var betweenInlines = function (forward, isInlineTarget, rootNode, from, to, location) {\n    return lift2(findRootInline(isInlineTarget, rootNode, from), findRootInline(isInlineTarget, rootNode, to), function (fromInline, toInline) {\n      if (fromInline !== toInline && hasSameParentBlock(rootNode, fromInline, toInline)) {\n        return Location.after(forward ? fromInline : toInline);\n      } else {\n        return location;\n      }\n    }).getOr(location);\n  };\n\n  var skipNoMovement = function (fromLocation, toLocation) {\n    return fromLocation.fold(always, function (fromLocation) {\n      return !isEq$5(fromLocation, toLocation);\n    });\n  };\n\n  var findLocationTraverse = function (forward, isInlineTarget, rootNode, fromLocation, pos) {\n    var from = normalizePosition(forward, pos);\n    var to = fromPosition(forward, rootNode, from).map(curry(normalizePosition, forward));\n    var location = to.fold(function () {\n      return fromLocation.map(outside);\n    }, function (to) {\n      return readLocation(isInlineTarget, rootNode, to).map(curry(betweenInlines, forward, isInlineTarget, rootNode, from, to)).filter(curry(skipNoMovement, fromLocation));\n    });\n    return location.filter(isValidLocation);\n  };\n\n  var findLocationSimple = function (forward, location) {\n    if (forward) {\n      return location.fold(compose(Optional.some, Location.start), Optional.none, compose(Optional.some, Location.after), Optional.none);\n    } else {\n      return location.fold(Optional.none, compose(Optional.some, Location.before), Optional.none, compose(Optional.some, Location.end));\n    }\n  };\n\n  var findLocation = function (forward, isInlineTarget, rootNode, pos) {\n    var from = normalizePosition(forward, pos);\n    var fromLocation = readLocation(isInlineTarget, rootNode, from);\n    return readLocation(isInlineTarget, rootNode, from).bind(curry(findLocationSimple, forward)).orThunk(function () {\n      return findLocationTraverse(forward, isInlineTarget, rootNode, fromLocation, pos);\n    });\n  };\n\n  var prevLocation = curry(findLocation, false);\n  var nextLocation = curry(findLocation, true);\n\n  var hasSelectionModifyApi = function (editor) {\n    return isFunction(editor.selection.getSel().modify);\n  };\n\n  var moveRel = function (forward, selection, pos) {\n    var delta = forward ? 1 : -1;\n    selection.setRng(CaretPosition(pos.container(), pos.offset() + delta).toRange());\n    selection.getSel().modify('move', forward ? 'forward' : 'backward', 'word');\n    return true;\n  };\n\n  var moveByWord = function (forward, editor) {\n    var rng = editor.selection.getRng();\n    var pos = forward ? CaretPosition.fromRangeEnd(rng) : CaretPosition.fromRangeStart(rng);\n\n    if (!hasSelectionModifyApi(editor)) {\n      return false;\n    } else if (forward && isBeforeInline(pos)) {\n      return moveRel(true, editor.selection, pos);\n    } else if (!forward && isAfterInline(pos)) {\n      return moveRel(false, editor.selection, pos);\n    } else {\n      return false;\n    }\n  };\n\n  var BreakType;\n\n  (function (BreakType) {\n    BreakType[BreakType['Br'] = 0] = 'Br';\n    BreakType[BreakType['Block'] = 1] = 'Block';\n    BreakType[BreakType['Wrap'] = 2] = 'Wrap';\n    BreakType[BreakType['Eol'] = 3] = 'Eol';\n  })(BreakType || (BreakType = {}));\n\n  var flip = function (direction, positions) {\n    return direction === HDirection.Backwards ? reverse(positions) : positions;\n  };\n\n  var walk$3 = function (direction, caretWalker, pos) {\n    return direction === HDirection.Forwards ? caretWalker.next(pos) : caretWalker.prev(pos);\n  };\n\n  var getBreakType = function (scope, direction, currentPos, nextPos) {\n    if (isBr(nextPos.getNode(direction === HDirection.Forwards))) {\n      return BreakType.Br;\n    } else if (isInSameBlock(currentPos, nextPos) === false) {\n      return BreakType.Block;\n    } else {\n      return BreakType.Wrap;\n    }\n  };\n\n  var getPositionsUntil = function (predicate, direction, scope, start) {\n    var caretWalker = CaretWalker(scope);\n    var currentPos = start,\n        nextPos;\n    var positions = [];\n\n    while (currentPos) {\n      nextPos = walk$3(direction, caretWalker, currentPos);\n\n      if (!nextPos) {\n        break;\n      }\n\n      if (isBr(nextPos.getNode(false))) {\n        if (direction === HDirection.Forwards) {\n          return {\n            positions: flip(direction, positions).concat([nextPos]),\n            breakType: BreakType.Br,\n            breakAt: Optional.some(nextPos)\n          };\n        } else {\n          return {\n            positions: flip(direction, positions),\n            breakType: BreakType.Br,\n            breakAt: Optional.some(nextPos)\n          };\n        }\n      }\n\n      if (!nextPos.isVisible()) {\n        currentPos = nextPos;\n        continue;\n      }\n\n      if (predicate(currentPos, nextPos)) {\n        var breakType = getBreakType(scope, direction, currentPos, nextPos);\n        return {\n          positions: flip(direction, positions),\n          breakType: breakType,\n          breakAt: Optional.some(nextPos)\n        };\n      }\n\n      positions.push(nextPos);\n      currentPos = nextPos;\n    }\n\n    return {\n      positions: flip(direction, positions),\n      breakType: BreakType.Eol,\n      breakAt: Optional.none()\n    };\n  };\n\n  var getAdjacentLinePositions = function (direction, getPositionsUntilBreak, scope, start) {\n    return getPositionsUntilBreak(scope, start).breakAt.map(function (pos) {\n      var positions = getPositionsUntilBreak(scope, pos).positions;\n      return direction === HDirection.Backwards ? positions.concat(pos) : [pos].concat(positions);\n    }).getOr([]);\n  };\n\n  var findClosestHorizontalPositionFromPoint = function (positions, x) {\n    return foldl(positions, function (acc, newPos) {\n      return acc.fold(function () {\n        return Optional.some(newPos);\n      }, function (lastPos) {\n        return lift2(head(lastPos.getClientRects()), head(newPos.getClientRects()), function (lastRect, newRect) {\n          var lastDist = Math.abs(x - lastRect.left);\n          var newDist = Math.abs(x - newRect.left);\n          return newDist <= lastDist ? newPos : lastPos;\n        }).or(acc);\n      });\n    }, Optional.none());\n  };\n\n  var findClosestHorizontalPosition = function (positions, pos) {\n    return head(pos.getClientRects()).bind(function (targetRect) {\n      return findClosestHorizontalPositionFromPoint(positions, targetRect.left);\n    });\n  };\n\n  var getPositionsUntilPreviousLine = curry(getPositionsUntil, CaretPosition.isAbove, -1);\n  var getPositionsUntilNextLine = curry(getPositionsUntil, CaretPosition.isBelow, 1);\n\n  var isAtFirstLine = function (scope, pos) {\n    return getPositionsUntilPreviousLine(scope, pos).breakAt.isNone();\n  };\n\n  var isAtLastLine = function (scope, pos) {\n    return getPositionsUntilNextLine(scope, pos).breakAt.isNone();\n  };\n\n  var getPositionsAbove = curry(getAdjacentLinePositions, -1, getPositionsUntilPreviousLine);\n  var getPositionsBelow = curry(getAdjacentLinePositions, 1, getPositionsUntilNextLine);\n\n  var getFirstLinePositions = function (scope) {\n    return firstPositionIn(scope).map(function (pos) {\n      return [pos].concat(getPositionsUntilNextLine(scope, pos).positions);\n    }).getOr([]);\n  };\n\n  var getLastLinePositions = function (scope) {\n    return lastPositionIn(scope).map(function (pos) {\n      return getPositionsUntilPreviousLine(scope, pos).positions.concat(pos);\n    }).getOr([]);\n  };\n\n  var getNodeClientRects = function (node) {\n    var toArrayWithNode = function (clientRects) {\n      return map(clientRects, function (clientRect) {\n        clientRect = clone$2(clientRect);\n        clientRect.node = node;\n        return clientRect;\n      });\n    };\n\n    if (isElement$1(node)) {\n      return toArrayWithNode(node.getClientRects());\n    }\n\n    if (isText$1(node)) {\n      var rng = node.ownerDocument.createRange();\n      rng.setStart(node, 0);\n      rng.setEnd(node, node.data.length);\n      return toArrayWithNode(rng.getClientRects());\n    }\n  };\n\n  var getClientRects = function (nodes) {\n    return bind(nodes, getNodeClientRects);\n  };\n\n  var VDirection;\n\n  (function (VDirection) {\n    VDirection[VDirection['Up'] = -1] = 'Up';\n    VDirection[VDirection['Down'] = 1] = 'Down';\n  })(VDirection || (VDirection = {}));\n\n  var findUntil$1 = function (direction, root, predicateFn, node) {\n    while (node = findNode(node, direction, isEditableCaretCandidate, root)) {\n      if (predicateFn(node)) {\n        return;\n      }\n    }\n  };\n\n  var walkUntil = function (direction, isAboveFn, isBeflowFn, root, predicateFn, caretPosition) {\n    var line = 0;\n    var result = [];\n\n    var add = function (node) {\n      var i, clientRect, clientRects;\n      clientRects = getClientRects([node]);\n\n      if (direction === -1) {\n        clientRects = clientRects.reverse();\n      }\n\n      for (i = 0; i < clientRects.length; i++) {\n        clientRect = clientRects[i];\n\n        if (isBeflowFn(clientRect, targetClientRect)) {\n          continue;\n        }\n\n        if (result.length > 0 && isAboveFn(clientRect, last$1(result))) {\n          line++;\n        }\n\n        clientRect.line = line;\n\n        if (predicateFn(clientRect)) {\n          return true;\n        }\n\n        result.push(clientRect);\n      }\n    };\n\n    var targetClientRect = last$1(caretPosition.getClientRects());\n\n    if (!targetClientRect) {\n      return result;\n    }\n\n    var node = caretPosition.getNode();\n    add(node);\n    findUntil$1(direction, root, add, node);\n    return result;\n  };\n\n  var aboveLineNumber = function (lineNumber, clientRect) {\n    return clientRect.line > lineNumber;\n  };\n\n  var isLineNumber = function (lineNumber, clientRect) {\n    return clientRect.line === lineNumber;\n  };\n\n  var upUntil = curry(walkUntil, VDirection.Up, isAbove, isBelow);\n  var downUntil = curry(walkUntil, VDirection.Down, isBelow, isAbove);\n\n  var positionsUntil = function (direction, root, predicateFn, node) {\n    var caretWalker = CaretWalker(root);\n    var walkFn, isBelowFn, isAboveFn, caretPosition;\n    var result = [];\n    var line = 0,\n        clientRect;\n\n    var getClientRect = function (caretPosition) {\n      if (direction === 1) {\n        return last$1(caretPosition.getClientRects());\n      }\n\n      return last$1(caretPosition.getClientRects());\n    };\n\n    if (direction === 1) {\n      walkFn = caretWalker.next;\n      isBelowFn = isBelow;\n      isAboveFn = isAbove;\n      caretPosition = CaretPosition.after(node);\n    } else {\n      walkFn = caretWalker.prev;\n      isBelowFn = isAbove;\n      isAboveFn = isBelow;\n      caretPosition = CaretPosition.before(node);\n    }\n\n    var targetClientRect = getClientRect(caretPosition);\n\n    do {\n      if (!caretPosition.isVisible()) {\n        continue;\n      }\n\n      clientRect = getClientRect(caretPosition);\n\n      if (isAboveFn(clientRect, targetClientRect)) {\n        continue;\n      }\n\n      if (result.length > 0 && isBelowFn(clientRect, last$1(result))) {\n        line++;\n      }\n\n      clientRect = clone$2(clientRect);\n      clientRect.position = caretPosition;\n      clientRect.line = line;\n\n      if (predicateFn(clientRect)) {\n        return result;\n      }\n\n      result.push(clientRect);\n    } while (caretPosition = walkFn(caretPosition));\n\n    return result;\n  };\n\n  var isAboveLine = function (lineNumber) {\n    return function (clientRect) {\n      return aboveLineNumber(lineNumber, clientRect);\n    };\n  };\n\n  var isLine = function (lineNumber) {\n    return function (clientRect) {\n      return isLineNumber(lineNumber, clientRect);\n    };\n  };\n\n  var isContentEditableFalse$8 = isContentEditableFalse;\n  var findNode$1 = findNode;\n\n  var distanceToRectLeft = function (clientRect, clientX) {\n    return Math.abs(clientRect.left - clientX);\n  };\n\n  var distanceToRectRight = function (clientRect, clientX) {\n    return Math.abs(clientRect.right - clientX);\n  };\n\n  var isInsideX = function (clientX, clientRect) {\n    return clientX >= clientRect.left && clientX <= clientRect.right;\n  };\n\n  var isInsideY = function (clientY, clientRect) {\n    return clientY >= clientRect.top && clientY <= clientRect.bottom;\n  };\n\n  var findClosestClientRect = function (clientRects, clientX) {\n    return reduce(clientRects, function (oldClientRect, clientRect) {\n      var oldDistance = Math.min(distanceToRectLeft(oldClientRect, clientX), distanceToRectRight(oldClientRect, clientX));\n      var newDistance = Math.min(distanceToRectLeft(clientRect, clientX), distanceToRectRight(clientRect, clientX));\n\n      if (isInsideX(clientX, clientRect)) {\n        return clientRect;\n      }\n\n      if (isInsideX(clientX, oldClientRect)) {\n        return oldClientRect;\n      }\n\n      if (newDistance === oldDistance && isContentEditableFalse$8(clientRect.node)) {\n        return clientRect;\n      }\n\n      if (newDistance < oldDistance) {\n        return clientRect;\n      }\n\n      return oldClientRect;\n    });\n  };\n\n  var walkUntil$1 = function (direction, root, predicateFn, startNode, includeChildren) {\n    var node = findNode$1(startNode, direction, isEditableCaretCandidate, root, !includeChildren);\n\n    do {\n      if (!node || predicateFn(node)) {\n        return;\n      }\n    } while (node = findNode$1(node, direction, isEditableCaretCandidate, root));\n  };\n\n  var findLineNodeRects = function (root, targetNodeRect, includeChildren) {\n    if (includeChildren === void 0) {\n      includeChildren = true;\n    }\n\n    var clientRects = [];\n\n    var collect = function (checkPosFn, node) {\n      var lineRects = filter(getClientRects([node]), function (clientRect) {\n        return !checkPosFn(clientRect, targetNodeRect);\n      });\n      clientRects = clientRects.concat(lineRects);\n      return lineRects.length === 0;\n    };\n\n    clientRects.push(targetNodeRect);\n    walkUntil$1(VDirection.Up, root, curry(collect, isAbove), targetNodeRect.node, includeChildren);\n    walkUntil$1(VDirection.Down, root, curry(collect, isBelow), targetNodeRect.node, includeChildren);\n    return clientRects;\n  };\n\n  var getFakeCaretTargets = function (root) {\n    return filter(from$1(root.getElementsByTagName('*')), isFakeCaretTarget);\n  };\n\n  var caretInfo = function (clientRect, clientX) {\n    return {\n      node: clientRect.node,\n      before: distanceToRectLeft(clientRect, clientX) < distanceToRectRight(clientRect, clientX)\n    };\n  };\n\n  var closestFakeCaret = function (root, clientX, clientY) {\n    var fakeTargetNodeRects = getClientRects(getFakeCaretTargets(root));\n    var targetNodeRects = filter(fakeTargetNodeRects, curry(isInsideY, clientY));\n    var closestNodeRect = findClosestClientRect(targetNodeRects, clientX);\n\n    if (closestNodeRect) {\n      var includeChildren = !isTable(closestNodeRect.node) && !isMedia(closestNodeRect.node);\n      closestNodeRect = findClosestClientRect(findLineNodeRects(root, closestNodeRect, includeChildren), clientX);\n\n      if (closestNodeRect && isFakeCaretTarget(closestNodeRect.node)) {\n        return caretInfo(closestNodeRect, clientX);\n      }\n    }\n\n    return null;\n  };\n\n  var moveToRange = function (editor, rng) {\n    editor.selection.setRng(rng);\n    scrollRangeIntoView(editor, editor.selection.getRng());\n  };\n\n  var renderRangeCaretOpt = function (editor, range, scrollIntoView) {\n    return Optional.some(renderRangeCaret(editor, range, scrollIntoView));\n  };\n\n  var moveHorizontally = function (editor, direction, range, isBefore, isAfter, isElement) {\n    var forwards = direction === HDirection.Forwards;\n    var caretWalker = CaretWalker(editor.getBody());\n    var getNextPosFn = curry(getVisualCaretPosition, forwards ? caretWalker.next : caretWalker.prev);\n    var isBeforeFn = forwards ? isBefore : isAfter;\n\n    if (!range.collapsed) {\n      var node = getSelectedNode(range);\n\n      if (isElement(node)) {\n        return showCaret(direction, editor, node, direction === HDirection.Backwards, false);\n      }\n    }\n\n    var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n\n    if (isBeforeFn(caretPosition)) {\n      return selectNode(editor, caretPosition.getNode(!forwards));\n    }\n\n    var nextCaretPosition = normalizePosition(forwards, getNextPosFn(caretPosition));\n    var rangeIsInContainerBlock = isRangeInCaretContainerBlock(range);\n\n    if (!nextCaretPosition) {\n      return rangeIsInContainerBlock ? Optional.some(range) : Optional.none();\n    }\n\n    if (isBeforeFn(nextCaretPosition)) {\n      return showCaret(direction, editor, nextCaretPosition.getNode(!forwards), forwards, false);\n    }\n\n    var peekCaretPosition = getNextPosFn(nextCaretPosition);\n\n    if (peekCaretPosition && isBeforeFn(peekCaretPosition)) {\n      if (isMoveInsideSameBlock(nextCaretPosition, peekCaretPosition)) {\n        return showCaret(direction, editor, peekCaretPosition.getNode(!forwards), forwards, false);\n      }\n    }\n\n    if (rangeIsInContainerBlock) {\n      return renderRangeCaretOpt(editor, nextCaretPosition.toRange(), false);\n    }\n\n    return Optional.none();\n  };\n\n  var moveVertically = function (editor, direction, range, isBefore, isAfter, isElement) {\n    var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n    var caretClientRect = last$1(caretPosition.getClientRects());\n    var forwards = direction === VDirection.Down;\n\n    if (!caretClientRect) {\n      return Optional.none();\n    }\n\n    var walkerFn = forwards ? downUntil : upUntil;\n    var linePositions = walkerFn(editor.getBody(), isAboveLine(1), caretPosition);\n    var nextLinePositions = filter(linePositions, isLine(1));\n    var clientX = caretClientRect.left;\n    var nextLineRect = findClosestClientRect(nextLinePositions, clientX);\n\n    if (nextLineRect && isElement(nextLineRect.node)) {\n      var dist1 = Math.abs(clientX - nextLineRect.left);\n      var dist2 = Math.abs(clientX - nextLineRect.right);\n      return showCaret(direction, editor, nextLineRect.node, dist1 < dist2, false);\n    }\n\n    var currentNode;\n\n    if (isBefore(caretPosition)) {\n      currentNode = caretPosition.getNode();\n    } else if (isAfter(caretPosition)) {\n      currentNode = caretPosition.getNode(true);\n    } else {\n      currentNode = getSelectedNode(range);\n    }\n\n    if (currentNode) {\n      var caretPositions = positionsUntil(direction, editor.getBody(), isAboveLine(1), currentNode);\n      var closestNextLineRect = findClosestClientRect(filter(caretPositions, isLine(1)), clientX);\n\n      if (closestNextLineRect) {\n        return renderRangeCaretOpt(editor, closestNextLineRect.position.toRange(), false);\n      }\n\n      closestNextLineRect = last$1(filter(caretPositions, isLine(0)));\n\n      if (closestNextLineRect) {\n        return renderRangeCaretOpt(editor, closestNextLineRect.position.toRange(), false);\n      }\n    }\n\n    if (nextLinePositions.length === 0) {\n      return getLineEndPoint(editor, forwards).filter(forwards ? isAfter : isBefore).map(function (pos) {\n        return renderRangeCaret(editor, pos.toRange(), false);\n      });\n    }\n\n    return Optional.none();\n  };\n\n  var getLineEndPoint = function (editor, forward) {\n    var rng = editor.selection.getRng();\n    var body = editor.getBody();\n\n    if (forward) {\n      var from = CaretPosition.fromRangeEnd(rng);\n      var result = getPositionsUntilNextLine(body, from);\n      return last(result.positions);\n    } else {\n      var from = CaretPosition.fromRangeStart(rng);\n      var result = getPositionsUntilPreviousLine(body, from);\n      return head(result.positions);\n    }\n  };\n\n  var moveToLineEndPoint = function (editor, forward, isElementPosition) {\n    return getLineEndPoint(editor, forward).filter(isElementPosition).exists(function (pos) {\n      editor.selection.setRng(pos.toRange());\n      return true;\n    });\n  };\n\n  var setCaretPosition = function (editor, pos) {\n    var rng = editor.dom.createRng();\n    rng.setStart(pos.container(), pos.offset());\n    rng.setEnd(pos.container(), pos.offset());\n    editor.selection.setRng(rng);\n  };\n\n  var setSelected = function (state, elm) {\n    if (state) {\n      elm.setAttribute('data-mce-selected', 'inline-boundary');\n    } else {\n      elm.removeAttribute('data-mce-selected');\n    }\n  };\n\n  var renderCaretLocation = function (editor, caret, location) {\n    return renderCaret(caret, location).map(function (pos) {\n      setCaretPosition(editor, pos);\n      return location;\n    });\n  };\n\n  var findLocation$1 = function (editor, caret, forward) {\n    var rootNode = editor.getBody();\n    var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n    var isInlineTarget$1 = curry(isInlineTarget, editor);\n    var location = findLocation(forward, isInlineTarget$1, rootNode, from);\n    return location.bind(function (location) {\n      return renderCaretLocation(editor, caret, location);\n    });\n  };\n\n  var toggleInlines = function (isInlineTarget, dom, elms) {\n    var inlineBoundaries = map(descendants$1(SugarElement.fromDom(dom.getRoot()), '*[data-mce-selected=\"inline-boundary\"]'), function (e) {\n      return e.dom;\n    });\n    var selectedInlines = filter(inlineBoundaries, isInlineTarget);\n    var targetInlines = filter(elms, isInlineTarget);\n    each(difference(selectedInlines, targetInlines), curry(setSelected, false));\n    each(difference(targetInlines, selectedInlines), curry(setSelected, true));\n  };\n\n  var safeRemoveCaretContainer = function (editor, caret) {\n    if (editor.selection.isCollapsed() && editor.composing !== true && caret.get()) {\n      var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n\n      if (CaretPosition.isTextPosition(pos) && isAtZwsp(pos) === false) {\n        setCaretPosition(editor, removeAndReposition(caret.get(), pos));\n        caret.set(null);\n      }\n    }\n  };\n\n  var renderInsideInlineCaret = function (isInlineTarget, editor, caret, elms) {\n    if (editor.selection.isCollapsed()) {\n      var inlines = filter(elms, isInlineTarget);\n      each(inlines, function (_inline) {\n        var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n        readLocation(isInlineTarget, editor.getBody(), pos).bind(function (location) {\n          return renderCaretLocation(editor, caret, location);\n        });\n      });\n    }\n  };\n\n  var move = function (editor, caret, forward) {\n    return isInlineBoundariesEnabled(editor) ? findLocation$1(editor, caret, forward).isSome() : false;\n  };\n\n  var moveWord = function (forward, editor, _caret) {\n    return isInlineBoundariesEnabled(editor) ? moveByWord(forward, editor) : false;\n  };\n\n  var setupSelectedState = function (editor) {\n    var caret = Cell(null);\n    var isInlineTarget$1 = curry(isInlineTarget, editor);\n    editor.on('NodeChange', function (e) {\n      if (isInlineBoundariesEnabled(editor) && !(Env.browser.isIE() && e.initial)) {\n        toggleInlines(isInlineTarget$1, editor.dom, e.parents);\n        safeRemoveCaretContainer(editor, caret);\n        renderInsideInlineCaret(isInlineTarget$1, editor, caret, e.parents);\n      }\n    });\n    return caret;\n  };\n\n  var moveNextWord = curry(moveWord, true);\n  var movePrevWord = curry(moveWord, false);\n\n  var moveToLineEndPoint$1 = function (editor, forward, caret) {\n    if (isInlineBoundariesEnabled(editor)) {\n      var linePoint = getLineEndPoint(editor, forward).getOrThunk(function () {\n        var rng = editor.selection.getRng();\n        return forward ? CaretPosition.fromRangeEnd(rng) : CaretPosition.fromRangeStart(rng);\n      });\n      return readLocation(curry(isInlineTarget, editor), editor.getBody(), linePoint).exists(function (loc) {\n        var outsideLoc = outside(loc);\n        return renderCaret(caret, outsideLoc).exists(function (pos) {\n          setCaretPosition(editor, pos);\n          return true;\n        });\n      });\n    } else {\n      return false;\n    }\n  };\n\n  var rangeFromPositions = function (from, to) {\n    var range = document.createRange();\n    range.setStart(from.container(), from.offset());\n    range.setEnd(to.container(), to.offset());\n    return range;\n  };\n\n  var hasOnlyTwoOrLessPositionsLeft = function (elm) {\n    return lift2(firstPositionIn(elm), lastPositionIn(elm), function (firstPos, lastPos) {\n      var normalizedFirstPos = normalizePosition(true, firstPos);\n      var normalizedLastPos = normalizePosition(false, lastPos);\n      return nextPosition(elm, normalizedFirstPos).forall(function (pos) {\n        return pos.isEqual(normalizedLastPos);\n      });\n    }).getOr(true);\n  };\n\n  var setCaretLocation = function (editor, caret) {\n    return function (location) {\n      return renderCaret(caret, location).exists(function (pos) {\n        setCaretPosition(editor, pos);\n        return true;\n      });\n    };\n  };\n\n  var deleteFromTo = function (editor, caret, from, to) {\n    var rootNode = editor.getBody();\n    var isInlineTarget$1 = curry(isInlineTarget, editor);\n    editor.undoManager.ignore(function () {\n      editor.selection.setRng(rangeFromPositions(from, to));\n      editor.execCommand('Delete');\n      readLocation(isInlineTarget$1, rootNode, CaretPosition.fromRangeStart(editor.selection.getRng())).map(inside).map(setCaretLocation(editor, caret));\n    });\n    editor.nodeChanged();\n  };\n\n  var rescope$1 = function (rootNode, node) {\n    var parentBlock = getParentBlock(node, rootNode);\n    return parentBlock ? parentBlock : rootNode;\n  };\n\n  var backspaceDeleteCollapsed = function (editor, caret, forward, from) {\n    var rootNode = rescope$1(editor.getBody(), from.container());\n    var isInlineTarget$1 = curry(isInlineTarget, editor);\n    var fromLocation = readLocation(isInlineTarget$1, rootNode, from);\n    return fromLocation.bind(function (location) {\n      if (forward) {\n        return location.fold(constant(Optional.some(inside(location))), Optional.none, constant(Optional.some(outside(location))), Optional.none);\n      } else {\n        return location.fold(Optional.none, constant(Optional.some(outside(location))), Optional.none, constant(Optional.some(inside(location))));\n      }\n    }).map(setCaretLocation(editor, caret)).getOrThunk(function () {\n      var toPosition = navigate(forward, rootNode, from);\n      var toLocation = toPosition.bind(function (pos) {\n        return readLocation(isInlineTarget$1, rootNode, pos);\n      });\n      return lift2(fromLocation, toLocation, function () {\n        return findRootInline(isInlineTarget$1, rootNode, from).exists(function (elm) {\n          if (hasOnlyTwoOrLessPositionsLeft(elm)) {\n            deleteElement(editor, forward, SugarElement.fromDom(elm));\n            return true;\n          } else {\n            return false;\n          }\n        });\n      }).orThunk(function () {\n        return toLocation.bind(function (_) {\n          return toPosition.map(function (to) {\n            if (forward) {\n              deleteFromTo(editor, caret, from, to);\n            } else {\n              deleteFromTo(editor, caret, to, from);\n            }\n\n            return true;\n          });\n        });\n      }).getOr(false);\n    });\n  };\n\n  var backspaceDelete$6 = function (editor, caret, forward) {\n    if (editor.selection.isCollapsed() && isInlineBoundariesEnabled(editor)) {\n      var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return backspaceDeleteCollapsed(editor, caret, forward, from);\n    }\n\n    return false;\n  };\n\n  var getParentInlines = function (rootElm, startElm) {\n    var parents = parentsAndSelf(startElm, rootElm);\n    return findIndex(parents, isBlock).fold(constant(parents), function (index) {\n      return parents.slice(0, index);\n    });\n  };\n\n  var hasOnlyOneChild$1 = function (elm) {\n    return children(elm).length === 1;\n  };\n\n  var deleteLastPosition = function (forward, editor, target, parentInlines) {\n    var isFormatElement$1 = curry(isFormatElement, editor);\n    var formatNodes = map(filter(parentInlines, isFormatElement$1), function (elm) {\n      return elm.dom;\n    });\n\n    if (formatNodes.length === 0) {\n      deleteElement(editor, forward, target);\n    } else {\n      var pos = replaceWithCaretFormat(target.dom, formatNodes);\n      editor.selection.setRng(pos.toRange());\n    }\n  };\n\n  var deleteCaret$2 = function (editor, forward) {\n    var rootElm = SugarElement.fromDom(editor.getBody());\n    var startElm = SugarElement.fromDom(editor.selection.getStart());\n    var parentInlines = filter(getParentInlines(rootElm, startElm), hasOnlyOneChild$1);\n    return last(parentInlines).exists(function (target) {\n      var fromPos = CaretPosition.fromRangeStart(editor.selection.getRng());\n\n      if (willDeleteLastPositionInElement(forward, fromPos, target.dom) && !isEmptyCaretFormatElement(target)) {\n        deleteLastPosition(forward, editor, target, parentInlines);\n        return true;\n      } else {\n        return false;\n      }\n    });\n  };\n\n  var backspaceDelete$7 = function (editor, forward) {\n    return editor.selection.isCollapsed() ? deleteCaret$2(editor, forward) : false;\n  };\n\n  var deleteElement$2 = function (editor, forward, element) {\n    editor._selectionOverrides.hideFakeCaret();\n\n    deleteElement(editor, forward, SugarElement.fromDom(element));\n    return true;\n  };\n\n  var deleteCaret$3 = function (editor, forward) {\n    var isNearMedia = forward ? isBeforeMedia : isAfterMedia;\n    var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n    var fromPos = getNormalizedRangeEndPoint(direction, editor.getBody(), editor.selection.getRng());\n\n    if (isNearMedia(fromPos)) {\n      return deleteElement$2(editor, forward, fromPos.getNode(!forward));\n    } else {\n      return Optional.from(normalizePosition(forward, fromPos)).filter(function (pos) {\n        return isNearMedia(pos) && isMoveInsideSameBlock(fromPos, pos);\n      }).exists(function (pos) {\n        return deleteElement$2(editor, forward, pos.getNode(!forward));\n      });\n    }\n  };\n\n  var deleteRange$2 = function (editor, forward) {\n    var selectedNode = editor.selection.getNode();\n    return isMedia(selectedNode) ? deleteElement$2(editor, forward, selectedNode) : false;\n  };\n\n  var backspaceDelete$8 = function (editor, forward) {\n    return editor.selection.isCollapsed() ? deleteCaret$3(editor, forward) : deleteRange$2(editor, forward);\n  };\n\n  var isEditable$1 = function (target) {\n    return closest(target, function (elm) {\n      return isContentEditableTrue(elm.dom) || isContentEditableFalse(elm.dom);\n    }).exists(function (elm) {\n      return isContentEditableTrue(elm.dom);\n    });\n  };\n\n  var parseIndentValue = function (value) {\n    var number = parseInt(value, 10);\n    return isNaN(number) ? 0 : number;\n  };\n\n  var getIndentStyleName = function (useMargin, element) {\n    var indentStyleName = useMargin || isTable$1(element) ? 'margin' : 'padding';\n    var suffix = get$5(element, 'direction') === 'rtl' ? '-right' : '-left';\n    return indentStyleName + suffix;\n  };\n\n  var indentElement = function (dom, command, useMargin, value, unit, element) {\n    var indentStyleName = getIndentStyleName(useMargin, SugarElement.fromDom(element));\n\n    if (command === 'outdent') {\n      var styleValue = Math.max(0, parseIndentValue(element.style[indentStyleName]) - value);\n      dom.setStyle(element, indentStyleName, styleValue ? styleValue + unit : '');\n    } else {\n      var styleValue = parseIndentValue(element.style[indentStyleName]) + value + unit;\n      dom.setStyle(element, indentStyleName, styleValue);\n    }\n  };\n\n  var validateBlocks = function (editor, blocks) {\n    return forall(blocks, function (block) {\n      var indentStyleName = getIndentStyleName(shouldIndentUseMargin(editor), block);\n      var intentValue = getRaw(block, indentStyleName).map(parseIndentValue).getOr(0);\n      var contentEditable = editor.dom.getContentEditable(block.dom);\n      return contentEditable !== 'false' && intentValue > 0;\n    });\n  };\n\n  var canOutdent = function (editor) {\n    var blocks = getBlocksToIndent(editor);\n    return !editor.mode.isReadOnly() && (blocks.length > 1 || validateBlocks(editor, blocks));\n  };\n\n  var isListComponent = function (el) {\n    return isList(el) || isListItem(el);\n  };\n\n  var parentIsListComponent = function (el) {\n    return parent(el).map(isListComponent).getOr(false);\n  };\n\n  var getBlocksToIndent = function (editor) {\n    return filter(map(editor.selection.getSelectedBlocks(), SugarElement.fromDom), function (el) {\n      return !isListComponent(el) && !parentIsListComponent(el) && isEditable$1(el);\n    });\n  };\n\n  var handle = function (editor, command) {\n    var dom = editor.dom,\n        selection = editor.selection,\n        formatter = editor.formatter;\n    var indentation = getIndentation(editor);\n    var indentUnit = /[a-z%]+$/i.exec(indentation)[0];\n    var indentValue = parseInt(indentation, 10);\n    var useMargin = shouldIndentUseMargin(editor);\n    var forcedRootBlock = getForcedRootBlock(editor);\n\n    if (!editor.queryCommandState('InsertUnorderedList') && !editor.queryCommandState('InsertOrderedList')) {\n      if (forcedRootBlock === '' && !dom.getParent(selection.getNode(), dom.isBlock)) {\n        formatter.apply('div');\n      }\n    }\n\n    each(getBlocksToIndent(editor), function (block) {\n      indentElement(dom, command, useMargin, indentValue, indentUnit, block.dom);\n    });\n  };\n\n  var backspaceDelete$9 = function (editor, _forward) {\n    if (editor.selection.isCollapsed() && canOutdent(editor)) {\n      var dom = editor.dom;\n      var rng = editor.selection.getRng();\n      var pos = CaretPosition.fromRangeStart(rng);\n      var block = dom.getParent(rng.startContainer, dom.isBlock);\n\n      if (block !== null && isAtStartOfBlock(SugarElement.fromDom(block), pos)) {\n        handle(editor, 'outdent');\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var nativeCommand = function (editor, command) {\n    editor.getDoc().execCommand(command, false, null);\n  };\n\n  var deleteCommand = function (editor, caret) {\n    if (backspaceDelete$9(editor)) {\n      return;\n    } else if (backspaceDelete$4(editor, false)) {\n      return;\n    } else if (backspaceDelete$3(editor, false)) {\n      return;\n    } else if (backspaceDelete$6(editor, caret, false)) {\n      return;\n    } else if (backspaceDelete$1(editor, false)) {\n      return;\n    } else if (backspaceDelete(editor)) {\n      return;\n    } else if (backspaceDelete$5(editor, false)) {\n      return;\n    } else if (backspaceDelete$8(editor, false)) {\n      return;\n    } else if (backspaceDelete$2(editor)) {\n      return;\n    } else if (backspaceDelete$7(editor, false)) {\n      return;\n    } else {\n      nativeCommand(editor, 'Delete');\n      paddEmptyBody(editor);\n    }\n  };\n\n  var forwardDeleteCommand = function (editor, caret) {\n    if (backspaceDelete$4(editor, true)) {\n      return;\n    } else if (backspaceDelete$3(editor, true)) {\n      return;\n    } else if (backspaceDelete$6(editor, caret, true)) {\n      return;\n    } else if (backspaceDelete$1(editor, true)) {\n      return;\n    } else if (backspaceDelete(editor)) {\n      return;\n    } else if (backspaceDelete$5(editor, true)) {\n      return;\n    } else if (backspaceDelete$8(editor, true)) {\n      return;\n    } else if (backspaceDelete$2(editor)) {\n      return;\n    } else if (backspaceDelete$7(editor, true)) {\n      return;\n    } else {\n      nativeCommand(editor, 'ForwardDelete');\n    }\n  };\n\n  var setup$8 = function (editor, caret) {\n    editor.addCommand('delete', function () {\n      deleteCommand(editor, caret);\n    });\n    editor.addCommand('forwardDelete', function () {\n      forwardDeleteCommand(editor, caret);\n    });\n  };\n\n  var SIGNIFICANT_MOVE = 5;\n  var LONGPRESS_DELAY = 400;\n\n  var getTouch = function (event) {\n    if (event.touches === undefined || event.touches.length !== 1) {\n      return Optional.none();\n    }\n\n    return Optional.some(event.touches[0]);\n  };\n\n  var isFarEnough = function (touch, data) {\n    var distX = Math.abs(touch.clientX - data.x);\n    var distY = Math.abs(touch.clientY - data.y);\n    return distX > SIGNIFICANT_MOVE || distY > SIGNIFICANT_MOVE;\n  };\n\n  var setup$9 = function (editor) {\n    var startData = Cell(Optional.none());\n    var longpressFired = Cell(false);\n    var debounceLongpress = last$2(function (e) {\n      editor.fire('longpress', __assign(__assign({}, e), {\n        type: 'longpress'\n      }));\n      longpressFired.set(true);\n    }, LONGPRESS_DELAY);\n    editor.on('touchstart', function (e) {\n      getTouch(e).each(function (touch) {\n        debounceLongpress.cancel();\n        var data = {\n          x: touch.clientX,\n          y: touch.clientY,\n          target: e.target\n        };\n        debounceLongpress.throttle(e);\n        longpressFired.set(false);\n        startData.set(Optional.some(data));\n      });\n    }, true);\n    editor.on('touchmove', function (e) {\n      debounceLongpress.cancel();\n      getTouch(e).each(function (touch) {\n        startData.get().each(function (data) {\n          if (isFarEnough(touch, data)) {\n            startData.set(Optional.none());\n            longpressFired.set(false);\n            editor.fire('longpresscancel');\n          }\n        });\n      });\n    }, true);\n    editor.on('touchend touchcancel', function (e) {\n      debounceLongpress.cancel();\n\n      if (e.type === 'touchcancel') {\n        return;\n      }\n\n      startData.get().filter(function (data) {\n        return data.target.isEqualNode(e.target);\n      }).each(function () {\n        if (longpressFired.get()) {\n          e.preventDefault();\n        } else {\n          editor.fire('tap', __assign(__assign({}, e), {\n            type: 'tap'\n          }));\n        }\n      });\n    }, true);\n  };\n\n  var isBlockElement = function (blockElements, node) {\n    return blockElements.hasOwnProperty(node.nodeName);\n  };\n\n  var isValidTarget = function (blockElements, node) {\n    if (isText$1(node)) {\n      return true;\n    } else if (isElement$1(node)) {\n      return !isBlockElement(blockElements, node) && !isBookmarkNode$1(node);\n    } else {\n      return false;\n    }\n  };\n\n  var hasBlockParent = function (blockElements, root, node) {\n    return exists(parents$1(SugarElement.fromDom(node), SugarElement.fromDom(root)), function (elm) {\n      return isBlockElement(blockElements, elm.dom);\n    });\n  };\n\n  var shouldRemoveTextNode = function (blockElements, node) {\n    if (isText$1(node)) {\n      if (node.nodeValue.length === 0) {\n        return true;\n      } else if (/^\\s+$/.test(node.nodeValue) && (!node.nextSibling || isBlockElement(blockElements, node.nextSibling))) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var addRootBlocks = function (editor) {\n    var dom = editor.dom,\n        selection = editor.selection;\n    var schema = editor.schema,\n        blockElements = schema.getBlockElements();\n    var node = selection.getStart();\n    var rootNode = editor.getBody();\n    var rootBlockNode, tempNode, wrapped;\n    var forcedRootBlock = getForcedRootBlock(editor);\n\n    if (!node || !isElement$1(node) || !forcedRootBlock) {\n      return;\n    }\n\n    var rootNodeName = rootNode.nodeName.toLowerCase();\n\n    if (!schema.isValidChild(rootNodeName, forcedRootBlock.toLowerCase()) || hasBlockParent(blockElements, rootNode, node)) {\n      return;\n    }\n\n    var rng = selection.getRng();\n    var startContainer = rng.startContainer;\n    var startOffset = rng.startOffset;\n    var endContainer = rng.endContainer;\n    var endOffset = rng.endOffset;\n    var restoreSelection = hasFocus$1(editor);\n    node = rootNode.firstChild;\n\n    while (node) {\n      if (isValidTarget(blockElements, node)) {\n        if (shouldRemoveTextNode(blockElements, node)) {\n          tempNode = node;\n          node = node.nextSibling;\n          dom.remove(tempNode);\n          continue;\n        }\n\n        if (!rootBlockNode) {\n          rootBlockNode = dom.create(forcedRootBlock, getForcedRootBlockAttrs(editor));\n          node.parentNode.insertBefore(rootBlockNode, node);\n          wrapped = true;\n        }\n\n        tempNode = node;\n        node = node.nextSibling;\n        rootBlockNode.appendChild(tempNode);\n      } else {\n        rootBlockNode = null;\n        node = node.nextSibling;\n      }\n    }\n\n    if (wrapped && restoreSelection) {\n      rng.setStart(startContainer, startOffset);\n      rng.setEnd(endContainer, endOffset);\n      selection.setRng(rng);\n      editor.nodeChanged();\n    }\n  };\n\n  var setup$a = function (editor) {\n    if (getForcedRootBlock(editor)) {\n      editor.on('NodeChange', curry(addRootBlocks, editor));\n    }\n  };\n\n  var findBlockCaretContainer = function (editor) {\n    return descendant(SugarElement.fromDom(editor.getBody()), '*[data-mce-caret]').fold(constant(null), function (elm) {\n      return elm.dom;\n    });\n  };\n\n  var removeIeControlRect = function (editor) {\n    editor.selection.setRng(editor.selection.getRng());\n  };\n\n  var showBlockCaretContainer = function (editor, blockCaretContainer) {\n    if (blockCaretContainer.hasAttribute('data-mce-caret')) {\n      showCaretContainerBlock(blockCaretContainer);\n      removeIeControlRect(editor);\n      editor.selection.scrollIntoView(blockCaretContainer);\n    }\n  };\n\n  var handleBlockContainer = function (editor, e) {\n    var blockCaretContainer = findBlockCaretContainer(editor);\n\n    if (!blockCaretContainer) {\n      return;\n    }\n\n    if (e.type === 'compositionstart') {\n      e.preventDefault();\n      e.stopPropagation();\n      showBlockCaretContainer(editor, blockCaretContainer);\n      return;\n    }\n\n    if (hasContent(blockCaretContainer)) {\n      showBlockCaretContainer(editor, blockCaretContainer);\n      editor.undoManager.add();\n    }\n  };\n\n  var setup$b = function (editor) {\n    editor.on('keyup compositionstart', curry(handleBlockContainer, editor));\n  };\n\n  var isContentEditableFalse$9 = isContentEditableFalse;\n\n  var moveToCeFalseHorizontally = function (direction, editor, range) {\n    return moveHorizontally(editor, direction, range, isBeforeContentEditableFalse, isAfterContentEditableFalse, isContentEditableFalse$9);\n  };\n\n  var moveToCeFalseVertically = function (direction, editor, range) {\n    var isBefore = function (caretPosition) {\n      return isBeforeContentEditableFalse(caretPosition) || isBeforeTable(caretPosition);\n    };\n\n    var isAfter = function (caretPosition) {\n      return isAfterContentEditableFalse(caretPosition) || isAfterTable(caretPosition);\n    };\n\n    return moveVertically(editor, direction, range, isBefore, isAfter, isContentEditableFalse$9);\n  };\n\n  var createTextBlock = function (editor) {\n    var textBlock = editor.dom.create(getForcedRootBlock(editor));\n\n    if (!Env.ie || Env.ie >= 11) {\n      textBlock.innerHTML = '<br data-mce-bogus=\"1\">';\n    }\n\n    return textBlock;\n  };\n\n  var exitPreBlock = function (editor, direction, range) {\n    var caretWalker = CaretWalker(editor.getBody());\n    var getVisualCaretPosition$1 = curry(getVisualCaretPosition, direction === 1 ? caretWalker.next : caretWalker.prev);\n\n    if (range.collapsed && hasForcedRootBlock(editor)) {\n      var pre = editor.dom.getParent(range.startContainer, 'PRE');\n\n      if (!pre) {\n        return;\n      }\n\n      var caretPos = getVisualCaretPosition$1(CaretPosition.fromRangeStart(range));\n\n      if (!caretPos) {\n        var newBlock = createTextBlock(editor);\n\n        if (direction === 1) {\n          editor.$(pre).after(newBlock);\n        } else {\n          editor.$(pre).before(newBlock);\n        }\n\n        editor.selection.select(newBlock, true);\n        editor.selection.collapse();\n      }\n    }\n  };\n\n  var getHorizontalRange = function (editor, forward) {\n    var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n    var range = editor.selection.getRng();\n    return moveToCeFalseHorizontally(direction, editor, range).orThunk(function () {\n      exitPreBlock(editor, direction, range);\n      return Optional.none();\n    });\n  };\n\n  var getVerticalRange = function (editor, down) {\n    var direction = down ? 1 : -1;\n    var range = editor.selection.getRng();\n    return moveToCeFalseVertically(direction, editor, range).orThunk(function () {\n      exitPreBlock(editor, direction, range);\n      return Optional.none();\n    });\n  };\n\n  var moveH = function (editor, forward) {\n    return getHorizontalRange(editor, forward).exists(function (newRange) {\n      moveToRange(editor, newRange);\n      return true;\n    });\n  };\n\n  var moveV = function (editor, down) {\n    return getVerticalRange(editor, down).exists(function (newRange) {\n      moveToRange(editor, newRange);\n      return true;\n    });\n  };\n\n  var moveToLineEndPoint$2 = function (editor, forward) {\n    var isCefPosition = forward ? isAfterContentEditableFalse : isBeforeContentEditableFalse;\n    return moveToLineEndPoint(editor, forward, isCefPosition);\n  };\n\n  var isTarget = function (node) {\n    return contains(['figcaption'], name(node));\n  };\n\n  var rangeBefore = function (target) {\n    var rng = document.createRange();\n    rng.setStartBefore(target.dom);\n    rng.setEndBefore(target.dom);\n    return rng;\n  };\n\n  var insertElement = function (root, elm, forward) {\n    if (forward) {\n      append(root, elm);\n    } else {\n      prepend(root, elm);\n    }\n  };\n\n  var insertBr = function (root, forward) {\n    var br = SugarElement.fromTag('br');\n    insertElement(root, br, forward);\n    return rangeBefore(br);\n  };\n\n  var insertBlock$1 = function (root, forward, blockName, attrs) {\n    var block = SugarElement.fromTag(blockName);\n    var br = SugarElement.fromTag('br');\n    setAll(block, attrs);\n    append(block, br);\n    insertElement(root, block, forward);\n    return rangeBefore(br);\n  };\n\n  var insertEmptyLine = function (root, rootBlockName, attrs, forward) {\n    if (rootBlockName === '') {\n      return insertBr(root, forward);\n    } else {\n      return insertBlock$1(root, forward, rootBlockName, attrs);\n    }\n  };\n\n  var getClosestTargetBlock = function (pos, root) {\n    var isRoot = curry(eq$2, root);\n    return closest(SugarElement.fromDom(pos.container()), isBlock, isRoot).filter(isTarget);\n  };\n\n  var isAtFirstOrLastLine = function (root, forward, pos) {\n    return forward ? isAtLastLine(root.dom, pos) : isAtFirstLine(root.dom, pos);\n  };\n\n  var moveCaretToNewEmptyLine = function (editor, forward) {\n    var root = SugarElement.fromDom(editor.getBody());\n    var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n    var rootBlock = getForcedRootBlock(editor);\n    var rootBlockAttrs = getForcedRootBlockAttrs(editor);\n    return getClosestTargetBlock(pos, root).exists(function () {\n      if (isAtFirstOrLastLine(root, forward, pos)) {\n        var rng = insertEmptyLine(root, rootBlock, rootBlockAttrs, forward);\n        editor.selection.setRng(rng);\n        return true;\n      } else {\n        return false;\n      }\n    });\n  };\n\n  var moveV$1 = function (editor, forward) {\n    if (editor.selection.isCollapsed()) {\n      return moveCaretToNewEmptyLine(editor, forward);\n    } else {\n      return false;\n    }\n  };\n\n  var defaultPatterns = function (patterns) {\n    return map(patterns, function (pattern) {\n      return __assign({\n        shiftKey: false,\n        altKey: false,\n        ctrlKey: false,\n        metaKey: false,\n        keyCode: 0,\n        action: noop\n      }, pattern);\n    });\n  };\n\n  var matchesEvent = function (pattern, evt) {\n    return evt.keyCode === pattern.keyCode && evt.shiftKey === pattern.shiftKey && evt.altKey === pattern.altKey && evt.ctrlKey === pattern.ctrlKey && evt.metaKey === pattern.metaKey;\n  };\n\n  var match$1 = function (patterns, evt) {\n    return bind(defaultPatterns(patterns), function (pattern) {\n      return matchesEvent(pattern, evt) ? [pattern] : [];\n    });\n  };\n\n  var action = function (f) {\n    var x = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      x[_i - 1] = arguments[_i];\n    }\n\n    return function () {\n      return f.apply(null, x);\n    };\n  };\n\n  var execute = function (patterns, evt) {\n    return find(match$1(patterns, evt), function (pattern) {\n      return pattern.action();\n    });\n  };\n\n  var moveH$1 = function (editor, forward) {\n    var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n    var range = editor.selection.getRng();\n    return moveHorizontally(editor, direction, range, isBeforeMedia, isAfterMedia, isMedia).exists(function (newRange) {\n      moveToRange(editor, newRange);\n      return true;\n    });\n  };\n\n  var moveV$2 = function (editor, down) {\n    var direction = down ? 1 : -1;\n    var range = editor.selection.getRng();\n    return moveVertically(editor, direction, range, isBeforeMedia, isAfterMedia, isMedia).exists(function (newRange) {\n      moveToRange(editor, newRange);\n      return true;\n    });\n  };\n\n  var moveToLineEndPoint$3 = function (editor, forward) {\n    var isNearMedia = forward ? isAfterMedia : isBeforeMedia;\n    return moveToLineEndPoint(editor, forward, isNearMedia);\n  };\n\n  var deflate = function (rect, delta) {\n    return {\n      left: rect.left - delta,\n      top: rect.top - delta,\n      right: rect.right + delta * 2,\n      bottom: rect.bottom + delta * 2,\n      width: rect.width + delta,\n      height: rect.height + delta\n    };\n  };\n\n  var getCorners = function (getYAxisValue, tds) {\n    return bind(tds, function (td) {\n      var rect = deflate(clone$2(td.getBoundingClientRect()), -1);\n      return [{\n        x: rect.left,\n        y: getYAxisValue(rect),\n        cell: td\n      }, {\n        x: rect.right,\n        y: getYAxisValue(rect),\n        cell: td\n      }];\n    });\n  };\n\n  var findClosestCorner = function (corners, x, y) {\n    return foldl(corners, function (acc, newCorner) {\n      return acc.fold(function () {\n        return Optional.some(newCorner);\n      }, function (oldCorner) {\n        var oldDist = Math.sqrt(Math.abs(oldCorner.x - x) + Math.abs(oldCorner.y - y));\n        var newDist = Math.sqrt(Math.abs(newCorner.x - x) + Math.abs(newCorner.y - y));\n        return Optional.some(newDist < oldDist ? newCorner : oldCorner);\n      });\n    }, Optional.none());\n  };\n\n  var getClosestCell$1 = function (getYAxisValue, isTargetCorner, table, x, y) {\n    var cells = descendants$1(SugarElement.fromDom(table), 'td,th,caption').map(function (e) {\n      return e.dom;\n    });\n    var corners = filter(getCorners(getYAxisValue, cells), function (corner) {\n      return isTargetCorner(corner, y);\n    });\n    return findClosestCorner(corners, x, y).map(function (corner) {\n      return corner.cell;\n    });\n  };\n\n  var getBottomValue = function (rect) {\n    return rect.bottom;\n  };\n\n  var getTopValue = function (rect) {\n    return rect.top;\n  };\n\n  var isAbove$1 = function (corner, y) {\n    return corner.y < y;\n  };\n\n  var isBelow$1 = function (corner, y) {\n    return corner.y > y;\n  };\n\n  var getClosestCellAbove = curry(getClosestCell$1, getBottomValue, isAbove$1);\n  var getClosestCellBelow = curry(getClosestCell$1, getTopValue, isBelow$1);\n\n  var findClosestPositionInAboveCell = function (table, pos) {\n    return head(pos.getClientRects()).bind(function (rect) {\n      return getClosestCellAbove(table, rect.left, rect.top);\n    }).bind(function (cell) {\n      return findClosestHorizontalPosition(getLastLinePositions(cell), pos);\n    });\n  };\n\n  var findClosestPositionInBelowCell = function (table, pos) {\n    return last(pos.getClientRects()).bind(function (rect) {\n      return getClosestCellBelow(table, rect.left, rect.top);\n    }).bind(function (cell) {\n      return findClosestHorizontalPosition(getFirstLinePositions(cell), pos);\n    });\n  };\n\n  var hasNextBreak = function (getPositionsUntil, scope, lineInfo) {\n    return lineInfo.breakAt.exists(function (breakPos) {\n      return getPositionsUntil(scope, breakPos).breakAt.isSome();\n    });\n  };\n\n  var startsWithWrapBreak = function (lineInfo) {\n    return lineInfo.breakType === BreakType.Wrap && lineInfo.positions.length === 0;\n  };\n\n  var startsWithBrBreak = function (lineInfo) {\n    return lineInfo.breakType === BreakType.Br && lineInfo.positions.length === 1;\n  };\n\n  var isAtTableCellLine = function (getPositionsUntil, scope, pos) {\n    var lineInfo = getPositionsUntil(scope, pos);\n\n    if (startsWithWrapBreak(lineInfo) || !isBr(pos.getNode()) && startsWithBrBreak(lineInfo)) {\n      return !hasNextBreak(getPositionsUntil, scope, lineInfo);\n    } else {\n      return lineInfo.breakAt.isNone();\n    }\n  };\n\n  var isAtFirstTableCellLine = curry(isAtTableCellLine, getPositionsUntilPreviousLine);\n  var isAtLastTableCellLine = curry(isAtTableCellLine, getPositionsUntilNextLine);\n\n  var isCaretAtStartOrEndOfTable = function (forward, rng, table) {\n    var caretPos = CaretPosition.fromRangeStart(rng);\n    return positionIn(!forward, table).exists(function (pos) {\n      return pos.isEqual(caretPos);\n    });\n  };\n\n  var navigateHorizontally = function (editor, forward, table, _td) {\n    var rng = editor.selection.getRng();\n    var direction = forward ? 1 : -1;\n\n    if (isFakeCaretTableBrowser() && isCaretAtStartOrEndOfTable(forward, rng, table)) {\n      showCaret(direction, editor, table, !forward, false).each(function (newRng) {\n        moveToRange(editor, newRng);\n      });\n      return true;\n    }\n\n    return false;\n  };\n\n  var getClosestAbovePosition = function (root, table, start) {\n    return findClosestPositionInAboveCell(table, start).orThunk(function () {\n      return head(start.getClientRects()).bind(function (rect) {\n        return findClosestHorizontalPositionFromPoint(getPositionsAbove(root, CaretPosition.before(table)), rect.left);\n      });\n    }).getOr(CaretPosition.before(table));\n  };\n\n  var getClosestBelowPosition = function (root, table, start) {\n    return findClosestPositionInBelowCell(table, start).orThunk(function () {\n      return head(start.getClientRects()).bind(function (rect) {\n        return findClosestHorizontalPositionFromPoint(getPositionsBelow(root, CaretPosition.after(table)), rect.left);\n      });\n    }).getOr(CaretPosition.after(table));\n  };\n\n  var getTable = function (previous, pos) {\n    var node = pos.getNode(previous);\n    return isElement$1(node) && node.nodeName === 'TABLE' ? Optional.some(node) : Optional.none();\n  };\n\n  var renderBlock = function (down, editor, table, pos) {\n    var forcedRootBlock = getForcedRootBlock(editor);\n\n    if (forcedRootBlock) {\n      editor.undoManager.transact(function () {\n        var element = SugarElement.fromTag(forcedRootBlock);\n        setAll(element, getForcedRootBlockAttrs(editor));\n        append(element, SugarElement.fromTag('br'));\n\n        if (down) {\n          after(SugarElement.fromDom(table), element);\n        } else {\n          before(SugarElement.fromDom(table), element);\n        }\n\n        var rng = editor.dom.createRng();\n        rng.setStart(element.dom, 0);\n        rng.setEnd(element.dom, 0);\n        moveToRange(editor, rng);\n      });\n    } else {\n      moveToRange(editor, pos.toRange());\n    }\n  };\n\n  var moveCaret = function (editor, down, pos) {\n    var table = down ? getTable(true, pos) : getTable(false, pos);\n    var last = down === false;\n    table.fold(function () {\n      return moveToRange(editor, pos.toRange());\n    }, function (table) {\n      return positionIn(last, editor.getBody()).filter(function (lastPos) {\n        return lastPos.isEqual(pos);\n      }).fold(function () {\n        return moveToRange(editor, pos.toRange());\n      }, function (_) {\n        return renderBlock(down, editor, table, pos);\n      });\n    });\n  };\n\n  var navigateVertically = function (editor, down, table, td) {\n    var rng = editor.selection.getRng();\n    var pos = CaretPosition.fromRangeStart(rng);\n    var root = editor.getBody();\n\n    if (!down && isAtFirstTableCellLine(td, pos)) {\n      var newPos = getClosestAbovePosition(root, table, pos);\n      moveCaret(editor, down, newPos);\n      return true;\n    } else if (down && isAtLastTableCellLine(td, pos)) {\n      var newPos = getClosestBelowPosition(root, table, pos);\n      moveCaret(editor, down, newPos);\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  var move$1 = function (editor, forward, mover) {\n    return Optional.from(editor.dom.getParent(editor.selection.getNode(), 'td,th')).bind(function (td) {\n      return Optional.from(editor.dom.getParent(td, 'table')).map(function (table) {\n        return mover(editor, forward, table, td);\n      });\n    }).getOr(false);\n  };\n\n  var moveH$2 = function (editor, forward) {\n    return move$1(editor, forward, navigateHorizontally);\n  };\n\n  var moveV$3 = function (editor, forward) {\n    return move$1(editor, forward, navigateVertically);\n  };\n\n  var executeKeydownOverride = function (editor, caret, evt) {\n    var os = detect$3().os;\n    execute([{\n      keyCode: VK.RIGHT,\n      action: action(moveH, editor, true)\n    }, {\n      keyCode: VK.LEFT,\n      action: action(moveH, editor, false)\n    }, {\n      keyCode: VK.UP,\n      action: action(moveV, editor, false)\n    }, {\n      keyCode: VK.DOWN,\n      action: action(moveV, editor, true)\n    }, {\n      keyCode: VK.RIGHT,\n      action: action(moveH$2, editor, true)\n    }, {\n      keyCode: VK.LEFT,\n      action: action(moveH$2, editor, false)\n    }, {\n      keyCode: VK.UP,\n      action: action(moveV$3, editor, false)\n    }, {\n      keyCode: VK.DOWN,\n      action: action(moveV$3, editor, true)\n    }, {\n      keyCode: VK.RIGHT,\n      action: action(moveH$1, editor, true)\n    }, {\n      keyCode: VK.LEFT,\n      action: action(moveH$1, editor, false)\n    }, {\n      keyCode: VK.UP,\n      action: action(moveV$2, editor, false)\n    }, {\n      keyCode: VK.DOWN,\n      action: action(moveV$2, editor, true)\n    }, {\n      keyCode: VK.RIGHT,\n      action: action(move, editor, caret, true)\n    }, {\n      keyCode: VK.LEFT,\n      action: action(move, editor, caret, false)\n    }, {\n      keyCode: VK.RIGHT,\n      ctrlKey: !os.isOSX(),\n      altKey: os.isOSX(),\n      action: action(moveNextWord, editor, caret)\n    }, {\n      keyCode: VK.LEFT,\n      ctrlKey: !os.isOSX(),\n      altKey: os.isOSX(),\n      action: action(movePrevWord, editor, caret)\n    }, {\n      keyCode: VK.UP,\n      action: action(moveV$1, editor, false)\n    }, {\n      keyCode: VK.DOWN,\n      action: action(moveV$1, editor, true)\n    }], evt).each(function (_) {\n      evt.preventDefault();\n    });\n  };\n\n  var setup$c = function (editor, caret) {\n    editor.on('keydown', function (evt) {\n      if (evt.isDefaultPrevented() === false) {\n        executeKeydownOverride(editor, caret, evt);\n      }\n    });\n  };\n\n  var executeKeydownOverride$1 = function (editor, caret, evt) {\n    execute([{\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$9, editor, false)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$4, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$4, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$3, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$3, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$6, editor, caret, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$6, editor, caret, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$5, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$5, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$8, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$8, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$2, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$2, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$1, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$1, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$7, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$7, editor, true)\n    }], evt).each(function (_) {\n      evt.preventDefault();\n    });\n  };\n\n  var executeKeyupOverride = function (editor, evt) {\n    execute([{\n      keyCode: VK.BACKSPACE,\n      action: action(paddEmptyElement, editor)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(paddEmptyElement, editor)\n    }], evt);\n  };\n\n  var setup$d = function (editor, caret) {\n    editor.on('keydown', function (evt) {\n      if (evt.isDefaultPrevented() === false) {\n        executeKeydownOverride$1(editor, caret, evt);\n      }\n    });\n    editor.on('keyup', function (evt) {\n      if (evt.isDefaultPrevented() === false) {\n        executeKeyupOverride(editor, evt);\n      }\n    });\n  };\n\n  var firstNonWhiteSpaceNodeSibling = function (node) {\n    while (node) {\n      if (node.nodeType === 1 || node.nodeType === 3 && node.data && /[\\r\\n\\s]/.test(node.data)) {\n        return node;\n      }\n\n      node = node.nextSibling;\n    }\n  };\n\n  var moveToCaretPosition = function (editor, root) {\n    var node,\n        lastNode = root;\n    var dom = editor.dom;\n    var moveCaretBeforeOnEnterElementsMap = editor.schema.getMoveCaretBeforeOnEnterElements();\n\n    if (!root) {\n      return;\n    }\n\n    if (/^(LI|DT|DD)$/.test(root.nodeName)) {\n      var firstChild = firstNonWhiteSpaceNodeSibling(root.firstChild);\n\n      if (firstChild && /^(UL|OL|DL)$/.test(firstChild.nodeName)) {\n        root.insertBefore(dom.doc.createTextNode(nbsp), root.firstChild);\n      }\n    }\n\n    var rng = dom.createRng();\n    root.normalize();\n\n    if (root.hasChildNodes()) {\n      var walker = new DomTreeWalker(root, root);\n\n      while (node = walker.current()) {\n        if (isText$1(node)) {\n          rng.setStart(node, 0);\n          rng.setEnd(node, 0);\n          break;\n        }\n\n        if (moveCaretBeforeOnEnterElementsMap[node.nodeName.toLowerCase()]) {\n          rng.setStartBefore(node);\n          rng.setEndBefore(node);\n          break;\n        }\n\n        lastNode = node;\n        node = walker.next();\n      }\n\n      if (!node) {\n        rng.setStart(lastNode, 0);\n        rng.setEnd(lastNode, 0);\n      }\n    } else {\n      if (isBr(root)) {\n        if (root.nextSibling && dom.isBlock(root.nextSibling)) {\n          rng.setStartBefore(root);\n          rng.setEndBefore(root);\n        } else {\n          rng.setStartAfter(root);\n          rng.setEndAfter(root);\n        }\n      } else {\n        rng.setStart(root, 0);\n        rng.setEnd(root, 0);\n      }\n    }\n\n    editor.selection.setRng(rng);\n    scrollRangeIntoView(editor, rng);\n  };\n\n  var getEditableRoot = function (dom, node) {\n    var root = dom.getRoot();\n    var parent, editableRoot;\n    parent = node;\n\n    while (parent !== root && dom.getContentEditable(parent) !== 'false') {\n      if (dom.getContentEditable(parent) === 'true') {\n        editableRoot = parent;\n      }\n\n      parent = parent.parentNode;\n    }\n\n    return parent !== root ? editableRoot : root;\n  };\n\n  var getParentBlock$2 = function (editor) {\n    return Optional.from(editor.dom.getParent(editor.selection.getStart(true), editor.dom.isBlock));\n  };\n\n  var getParentBlockName = function (editor) {\n    return getParentBlock$2(editor).fold(constant(''), function (parentBlock) {\n      return parentBlock.nodeName.toUpperCase();\n    });\n  };\n\n  var isListItemParentBlock = function (editor) {\n    return getParentBlock$2(editor).filter(function (elm) {\n      return isListItem(SugarElement.fromDom(elm));\n    }).isSome();\n  };\n\n  var hasFirstChild = function (elm, name) {\n    return elm.firstChild && elm.firstChild.nodeName === name;\n  };\n\n  var isFirstChild = function (elm) {\n    var _a;\n\n    return ((_a = elm.parentNode) === null || _a === void 0 ? void 0 : _a.firstChild) === elm;\n  };\n\n  var hasParent$1 = function (elm, parentName) {\n    return elm && elm.parentNode && elm.parentNode.nodeName === parentName;\n  };\n\n  var isListBlock = function (elm) {\n    return elm && /^(OL|UL|LI)$/.test(elm.nodeName);\n  };\n\n  var isNestedList = function (elm) {\n    return isListBlock(elm) && isListBlock(elm.parentNode);\n  };\n\n  var getContainerBlock = function (containerBlock) {\n    var containerBlockParent = containerBlock.parentNode;\n\n    if (/^(LI|DT|DD)$/.test(containerBlockParent.nodeName)) {\n      return containerBlockParent;\n    }\n\n    return containerBlock;\n  };\n\n  var isFirstOrLastLi = function (containerBlock, parentBlock, first) {\n    var node = containerBlock[first ? 'firstChild' : 'lastChild'];\n\n    while (node) {\n      if (isElement$1(node)) {\n        break;\n      }\n\n      node = node[first ? 'nextSibling' : 'previousSibling'];\n    }\n\n    return node === parentBlock;\n  };\n\n  var insert = function (editor, createNewBlock, containerBlock, parentBlock, newBlockName) {\n    var dom = editor.dom;\n    var rng = editor.selection.getRng();\n\n    if (containerBlock === editor.getBody()) {\n      return;\n    }\n\n    if (isNestedList(containerBlock)) {\n      newBlockName = 'LI';\n    }\n\n    var newBlock = newBlockName ? createNewBlock(newBlockName) : dom.create('BR');\n\n    if (isFirstOrLastLi(containerBlock, parentBlock, true) && isFirstOrLastLi(containerBlock, parentBlock, false)) {\n      if (hasParent$1(containerBlock, 'LI')) {\n        var containerBlockParent = getContainerBlock(containerBlock);\n        dom.insertAfter(newBlock, containerBlockParent);\n\n        if (isFirstChild(containerBlock)) {\n          dom.remove(containerBlockParent);\n        } else {\n          dom.remove(containerBlock);\n        }\n      } else {\n        dom.replace(newBlock, containerBlock);\n      }\n    } else if (isFirstOrLastLi(containerBlock, parentBlock, true)) {\n      if (hasParent$1(containerBlock, 'LI')) {\n        dom.insertAfter(newBlock, getContainerBlock(containerBlock));\n        newBlock.appendChild(dom.doc.createTextNode(' '));\n        newBlock.appendChild(containerBlock);\n      } else {\n        containerBlock.parentNode.insertBefore(newBlock, containerBlock);\n      }\n\n      dom.remove(parentBlock);\n    } else if (isFirstOrLastLi(containerBlock, parentBlock, false)) {\n      dom.insertAfter(newBlock, getContainerBlock(containerBlock));\n      dom.remove(parentBlock);\n    } else {\n      containerBlock = getContainerBlock(containerBlock);\n      var tmpRng = rng.cloneRange();\n      tmpRng.setStartAfter(parentBlock);\n      tmpRng.setEndAfter(containerBlock);\n      var fragment = tmpRng.extractContents();\n\n      if (newBlockName === 'LI' && hasFirstChild(fragment, 'LI')) {\n        newBlock = fragment.firstChild;\n        dom.insertAfter(fragment, containerBlock);\n      } else {\n        dom.insertAfter(fragment, containerBlock);\n        dom.insertAfter(newBlock, containerBlock);\n      }\n\n      dom.remove(parentBlock);\n    }\n\n    moveToCaretPosition(editor, newBlock);\n  };\n\n  var trimZwsp = function (fragment) {\n    each(descendants(SugarElement.fromDom(fragment), isText), function (text) {\n      var rawNode = text.dom;\n      rawNode.nodeValue = trim$2(rawNode.nodeValue);\n    });\n  };\n\n  var isEmptyAnchor = function (dom, elm) {\n    return elm && elm.nodeName === 'A' && dom.isEmpty(elm);\n  };\n\n  var isTableCell$5 = function (node) {\n    return node && /^(TD|TH|CAPTION)$/.test(node.nodeName);\n  };\n\n  var emptyBlock = function (elm) {\n    elm.innerHTML = '<br data-mce-bogus=\"1\">';\n  };\n\n  var containerAndSiblingName = function (container, nodeName) {\n    return container.nodeName === nodeName || container.previousSibling && container.previousSibling.nodeName === nodeName;\n  };\n\n  var canSplitBlock = function (dom, node) {\n    return node && dom.isBlock(node) && !/^(TD|TH|CAPTION|FORM)$/.test(node.nodeName) && !/^(fixed|absolute)/i.test(node.style.position) && dom.getContentEditable(node) !== 'true';\n  };\n\n  var trimInlineElementsOnLeftSideOfBlock = function (dom, nonEmptyElementsMap, block) {\n    var node = block;\n    var firstChilds = [];\n    var i;\n\n    if (!node) {\n      return;\n    }\n\n    while (node = node.firstChild) {\n      if (dom.isBlock(node)) {\n        return;\n      }\n\n      if (isElement$1(node) && !nonEmptyElementsMap[node.nodeName.toLowerCase()]) {\n        firstChilds.push(node);\n      }\n    }\n\n    i = firstChilds.length;\n\n    while (i--) {\n      node = firstChilds[i];\n\n      if (!node.hasChildNodes() || node.firstChild === node.lastChild && node.firstChild.nodeValue === '') {\n        dom.remove(node);\n      } else {\n        if (isEmptyAnchor(dom, node)) {\n          dom.remove(node);\n        }\n      }\n    }\n  };\n\n  var normalizeZwspOffset = function (start, container, offset) {\n    if (isText$1(container) === false) {\n      return offset;\n    } else if (start) {\n      return offset === 1 && container.data.charAt(offset - 1) === ZWSP ? 0 : offset;\n    } else {\n      return offset === container.data.length - 1 && container.data.charAt(offset) === ZWSP ? container.data.length : offset;\n    }\n  };\n\n  var includeZwspInRange = function (rng) {\n    var newRng = rng.cloneRange();\n    newRng.setStart(rng.startContainer, normalizeZwspOffset(true, rng.startContainer, rng.startOffset));\n    newRng.setEnd(rng.endContainer, normalizeZwspOffset(false, rng.endContainer, rng.endOffset));\n    return newRng;\n  };\n\n  var trimLeadingLineBreaks = function (node) {\n    do {\n      if (isText$1(node)) {\n        node.nodeValue = node.nodeValue.replace(/^[\\r\\n]+/, '');\n      }\n\n      node = node.firstChild;\n    } while (node);\n  };\n\n  var getEditableRoot$1 = function (dom, node) {\n    var root = dom.getRoot();\n    var parent, editableRoot;\n    parent = node;\n\n    while (parent !== root && dom.getContentEditable(parent) !== 'false') {\n      if (dom.getContentEditable(parent) === 'true') {\n        editableRoot = parent;\n      }\n\n      parent = parent.parentNode;\n    }\n\n    return parent !== root ? editableRoot : root;\n  };\n\n  var applyAttributes = function (editor, node, forcedRootBlockAttrs) {\n    var dom = editor.dom;\n    Optional.from(forcedRootBlockAttrs.style).map(dom.parseStyle).each(function (attrStyles) {\n      var currentStyles = getAllRaw(SugarElement.fromDom(node));\n\n      var newStyles = __assign(__assign({}, currentStyles), attrStyles);\n\n      dom.setStyles(node, newStyles);\n    });\n    var attrClassesOpt = Optional.from(forcedRootBlockAttrs.class).map(function (attrClasses) {\n      return attrClasses.split(/\\s+/);\n    });\n    var currentClassesOpt = Optional.from(node.className).map(function (currentClasses) {\n      return filter(currentClasses.split(/\\s+/), function (clazz) {\n        return clazz !== '';\n      });\n    });\n    lift2(attrClassesOpt, currentClassesOpt, function (attrClasses, currentClasses) {\n      var filteredClasses = filter(currentClasses, function (clazz) {\n        return !contains(attrClasses, clazz);\n      });\n\n      var newClasses = __spreadArrays(attrClasses, filteredClasses);\n\n      dom.setAttrib(node, 'class', newClasses.join(' '));\n    });\n    var appliedAttrs = ['style', 'class'];\n    var remainingAttrs = filter$1(forcedRootBlockAttrs, function (_, attrs) {\n      return !contains(appliedAttrs, attrs);\n    });\n    dom.setAttribs(node, remainingAttrs);\n  };\n\n  var setForcedBlockAttrs = function (editor, node) {\n    var forcedRootBlockName = getForcedRootBlock(editor);\n\n    if (forcedRootBlockName && forcedRootBlockName.toLowerCase() === node.tagName.toLowerCase()) {\n      var forcedRootBlockAttrs = getForcedRootBlockAttrs(editor);\n      applyAttributes(editor, node, forcedRootBlockAttrs);\n    }\n  };\n\n  var wrapSelfAndSiblingsInDefaultBlock = function (editor, newBlockName, rng, container, offset) {\n    var newBlock, parentBlock, startNode, node, next, rootBlockName;\n    var blockName = newBlockName || 'P';\n    var dom = editor.dom,\n        editableRoot = getEditableRoot$1(dom, container);\n    parentBlock = dom.getParent(container, dom.isBlock);\n\n    if (!parentBlock || !canSplitBlock(dom, parentBlock)) {\n      parentBlock = parentBlock || editableRoot;\n\n      if (parentBlock === editor.getBody() || isTableCell$5(parentBlock)) {\n        rootBlockName = parentBlock.nodeName.toLowerCase();\n      } else {\n        rootBlockName = parentBlock.parentNode.nodeName.toLowerCase();\n      }\n\n      if (!parentBlock.hasChildNodes()) {\n        newBlock = dom.create(blockName);\n        setForcedBlockAttrs(editor, newBlock);\n        parentBlock.appendChild(newBlock);\n        rng.setStart(newBlock, 0);\n        rng.setEnd(newBlock, 0);\n        return newBlock;\n      }\n\n      node = container;\n\n      while (node.parentNode !== parentBlock) {\n        node = node.parentNode;\n      }\n\n      while (node && !dom.isBlock(node)) {\n        startNode = node;\n        node = node.previousSibling;\n      }\n\n      if (startNode && editor.schema.isValidChild(rootBlockName, blockName.toLowerCase())) {\n        newBlock = dom.create(blockName);\n        setForcedBlockAttrs(editor, newBlock);\n        startNode.parentNode.insertBefore(newBlock, startNode);\n        node = startNode;\n\n        while (node && !dom.isBlock(node)) {\n          next = node.nextSibling;\n          newBlock.appendChild(node);\n          node = next;\n        }\n\n        rng.setStart(container, offset);\n        rng.setEnd(container, offset);\n      }\n    }\n\n    return container;\n  };\n\n  var addBrToBlockIfNeeded = function (dom, block) {\n    block.normalize();\n    var lastChild = block.lastChild;\n\n    if (!lastChild || /^(left|right)$/gi.test(dom.getStyle(lastChild, 'float', true))) {\n      dom.add(block, 'br');\n    }\n  };\n\n  var insert$1 = function (editor, evt) {\n    var tmpRng, container, offset, parentBlock;\n    var newBlock, fragment, containerBlock, parentBlockName, newBlockName, isAfterLastNodeInContainer;\n    var dom = editor.dom;\n    var schema = editor.schema,\n        nonEmptyElementsMap = schema.getNonEmptyElements();\n    var rng = editor.selection.getRng();\n\n    var createNewBlock = function (name) {\n      var node = container,\n          block,\n          clonedNode,\n          caretNode;\n      var textInlineElements = schema.getTextInlineElements();\n\n      if (name || parentBlockName === 'TABLE' || parentBlockName === 'HR') {\n        block = dom.create(name || newBlockName);\n      } else {\n        block = parentBlock.cloneNode(false);\n      }\n\n      caretNode = block;\n\n      if (shouldKeepStyles(editor) === false) {\n        dom.setAttrib(block, 'style', null);\n        dom.setAttrib(block, 'class', null);\n      } else {\n        do {\n          if (textInlineElements[node.nodeName]) {\n            if (isCaretNode(node) || isBookmarkNode$1(node)) {\n              continue;\n            }\n\n            clonedNode = node.cloneNode(false);\n            dom.setAttrib(clonedNode, 'id', '');\n\n            if (block.hasChildNodes()) {\n              clonedNode.appendChild(block.firstChild);\n              block.appendChild(clonedNode);\n            } else {\n              caretNode = clonedNode;\n              block.appendChild(clonedNode);\n            }\n          }\n        } while ((node = node.parentNode) && node !== editableRoot);\n      }\n\n      setForcedBlockAttrs(editor, block);\n      emptyBlock(caretNode);\n      return block;\n    };\n\n    var isCaretAtStartOrEndOfBlock = function (start) {\n      var node, name;\n      var normalizedOffset = normalizeZwspOffset(start, container, offset);\n\n      if (isText$1(container) && (start ? normalizedOffset > 0 : normalizedOffset < container.nodeValue.length)) {\n        return false;\n      }\n\n      if (container.parentNode === parentBlock && isAfterLastNodeInContainer && !start) {\n        return true;\n      }\n\n      if (start && isElement$1(container) && container === parentBlock.firstChild) {\n        return true;\n      }\n\n      if (containerAndSiblingName(container, 'TABLE') || containerAndSiblingName(container, 'HR')) {\n        return isAfterLastNodeInContainer && !start || !isAfterLastNodeInContainer && start;\n      }\n\n      var walker = new DomTreeWalker(container, parentBlock);\n\n      if (isText$1(container)) {\n        if (start && normalizedOffset === 0) {\n          walker.prev();\n        } else if (!start && normalizedOffset === container.nodeValue.length) {\n          walker.next();\n        }\n      }\n\n      while (node = walker.current()) {\n        if (isElement$1(node)) {\n          if (!node.getAttribute('data-mce-bogus')) {\n            name = node.nodeName.toLowerCase();\n\n            if (nonEmptyElementsMap[name] && name !== 'br') {\n              return false;\n            }\n          }\n        } else if (isText$1(node) && !isWhitespaceText(node.nodeValue)) {\n          return false;\n        }\n\n        if (start) {\n          walker.prev();\n        } else {\n          walker.next();\n        }\n      }\n\n      return true;\n    };\n\n    var insertNewBlockAfter = function () {\n      if (/^(H[1-6]|PRE|FIGURE)$/.test(parentBlockName) && containerBlockName !== 'HGROUP') {\n        newBlock = createNewBlock(newBlockName);\n      } else {\n        newBlock = createNewBlock();\n      }\n\n      if (shouldEndContainerOnEmptyBlock(editor) && canSplitBlock(dom, containerBlock) && dom.isEmpty(parentBlock)) {\n        newBlock = dom.split(containerBlock, parentBlock);\n      } else {\n        dom.insertAfter(newBlock, parentBlock);\n      }\n\n      moveToCaretPosition(editor, newBlock);\n    };\n\n    normalize(dom, rng).each(function (normRng) {\n      rng.setStart(normRng.startContainer, normRng.startOffset);\n      rng.setEnd(normRng.endContainer, normRng.endOffset);\n    });\n    container = rng.startContainer;\n    offset = rng.startOffset;\n    newBlockName = getForcedRootBlock(editor);\n    var shiftKey = !!(evt && evt.shiftKey);\n    var ctrlKey = !!(evt && evt.ctrlKey);\n\n    if (isElement$1(container) && container.hasChildNodes()) {\n      isAfterLastNodeInContainer = offset > container.childNodes.length - 1;\n      container = container.childNodes[Math.min(offset, container.childNodes.length - 1)] || container;\n\n      if (isAfterLastNodeInContainer && isText$1(container)) {\n        offset = container.nodeValue.length;\n      } else {\n        offset = 0;\n      }\n    }\n\n    var editableRoot = getEditableRoot$1(dom, container);\n\n    if (!editableRoot) {\n      return;\n    }\n\n    if (newBlockName && !shiftKey || !newBlockName && shiftKey) {\n      container = wrapSelfAndSiblingsInDefaultBlock(editor, newBlockName, rng, container, offset);\n    }\n\n    parentBlock = dom.getParent(container, dom.isBlock);\n    containerBlock = parentBlock ? dom.getParent(parentBlock.parentNode, dom.isBlock) : null;\n    parentBlockName = parentBlock ? parentBlock.nodeName.toUpperCase() : '';\n    var containerBlockName = containerBlock ? containerBlock.nodeName.toUpperCase() : '';\n\n    if (containerBlockName === 'LI' && !ctrlKey) {\n      parentBlock = containerBlock;\n      containerBlock = containerBlock.parentNode;\n      parentBlockName = containerBlockName;\n    }\n\n    if (/^(LI|DT|DD)$/.test(parentBlockName)) {\n      if (dom.isEmpty(parentBlock)) {\n        insert(editor, createNewBlock, containerBlock, parentBlock, newBlockName);\n        return;\n      }\n    }\n\n    if (newBlockName && parentBlock === editor.getBody()) {\n      return;\n    }\n\n    newBlockName = newBlockName || 'P';\n\n    if (isCaretContainerBlock(parentBlock)) {\n      newBlock = showCaretContainerBlock(parentBlock);\n\n      if (dom.isEmpty(parentBlock)) {\n        emptyBlock(parentBlock);\n      }\n\n      setForcedBlockAttrs(editor, newBlock);\n      moveToCaretPosition(editor, newBlock);\n    } else if (isCaretAtStartOrEndOfBlock()) {\n      insertNewBlockAfter();\n    } else if (isCaretAtStartOrEndOfBlock(true)) {\n      newBlock = parentBlock.parentNode.insertBefore(createNewBlock(), parentBlock);\n      moveToCaretPosition(editor, containerAndSiblingName(parentBlock, 'HR') ? newBlock : parentBlock);\n    } else {\n      tmpRng = includeZwspInRange(rng).cloneRange();\n      tmpRng.setEndAfter(parentBlock);\n      fragment = tmpRng.extractContents();\n      trimZwsp(fragment);\n      trimLeadingLineBreaks(fragment);\n      newBlock = fragment.firstChild;\n      dom.insertAfter(fragment, parentBlock);\n      trimInlineElementsOnLeftSideOfBlock(dom, nonEmptyElementsMap, newBlock);\n      addBrToBlockIfNeeded(dom, parentBlock);\n\n      if (dom.isEmpty(parentBlock)) {\n        emptyBlock(parentBlock);\n      }\n\n      newBlock.normalize();\n\n      if (dom.isEmpty(newBlock)) {\n        dom.remove(newBlock);\n        insertNewBlockAfter();\n      } else {\n        setForcedBlockAttrs(editor, newBlock);\n        moveToCaretPosition(editor, newBlock);\n      }\n    }\n\n    dom.setAttrib(newBlock, 'id', '');\n    editor.fire('NewBlock', {\n      newBlock: newBlock\n    });\n  };\n\n  var hasRightSideContent = function (schema, container, parentBlock) {\n    var walker = new DomTreeWalker(container, parentBlock);\n    var node;\n    var nonEmptyElementsMap = schema.getNonEmptyElements();\n\n    while (node = walker.next()) {\n      if (nonEmptyElementsMap[node.nodeName.toLowerCase()] || node.length > 0) {\n        return true;\n      }\n    }\n  };\n\n  var moveSelectionToBr = function (editor, brElm, extraBr) {\n    var rng = editor.dom.createRng();\n\n    if (!extraBr) {\n      rng.setStartAfter(brElm);\n      rng.setEndAfter(brElm);\n    } else {\n      rng.setStartBefore(brElm);\n      rng.setEndBefore(brElm);\n    }\n\n    editor.selection.setRng(rng);\n    scrollRangeIntoView(editor, rng);\n  };\n\n  var insertBrAtCaret = function (editor, evt) {\n    var selection = editor.selection;\n    var dom = editor.dom;\n    var rng = selection.getRng();\n    var brElm;\n    var extraBr;\n    normalize(dom, rng).each(function (normRng) {\n      rng.setStart(normRng.startContainer, normRng.startOffset);\n      rng.setEnd(normRng.endContainer, normRng.endOffset);\n    });\n    var offset = rng.startOffset;\n    var container = rng.startContainer;\n\n    if (container.nodeType === 1 && container.hasChildNodes()) {\n      var isAfterLastNodeInContainer = offset > container.childNodes.length - 1;\n      container = container.childNodes[Math.min(offset, container.childNodes.length - 1)] || container;\n\n      if (isAfterLastNodeInContainer && container.nodeType === 3) {\n        offset = container.nodeValue.length;\n      } else {\n        offset = 0;\n      }\n    }\n\n    var parentBlock = dom.getParent(container, dom.isBlock);\n    var containerBlock = parentBlock ? dom.getParent(parentBlock.parentNode, dom.isBlock) : null;\n    var containerBlockName = containerBlock ? containerBlock.nodeName.toUpperCase() : '';\n    var isControlKey = !!(evt && evt.ctrlKey);\n\n    if (containerBlockName === 'LI' && !isControlKey) {\n      parentBlock = containerBlock;\n    }\n\n    if (container && container.nodeType === 3 && offset >= container.nodeValue.length) {\n      if (!hasRightSideContent(editor.schema, container, parentBlock)) {\n        brElm = dom.create('br');\n        rng.insertNode(brElm);\n        rng.setStartAfter(brElm);\n        rng.setEndAfter(brElm);\n        extraBr = true;\n      }\n    }\n\n    brElm = dom.create('br');\n    rangeInsertNode(dom, rng, brElm);\n    moveSelectionToBr(editor, brElm, extraBr);\n    editor.undoManager.add();\n  };\n\n  var insertBrBefore = function (editor, inline) {\n    var br = SugarElement.fromTag('br');\n    before(SugarElement.fromDom(inline), br);\n    editor.undoManager.add();\n  };\n\n  var insertBrAfter = function (editor, inline) {\n    if (!hasBrAfter(editor.getBody(), inline)) {\n      after(SugarElement.fromDom(inline), SugarElement.fromTag('br'));\n    }\n\n    var br = SugarElement.fromTag('br');\n    after(SugarElement.fromDom(inline), br);\n    moveSelectionToBr(editor, br.dom, false);\n    editor.undoManager.add();\n  };\n\n  var isBeforeBr$1 = function (pos) {\n    return isBr(pos.getNode());\n  };\n\n  var hasBrAfter = function (rootNode, startNode) {\n    if (isBeforeBr$1(CaretPosition.after(startNode))) {\n      return true;\n    } else {\n      return nextPosition(rootNode, CaretPosition.after(startNode)).map(function (pos) {\n        return isBr(pos.getNode());\n      }).getOr(false);\n    }\n  };\n\n  var isAnchorLink = function (elm) {\n    return elm && elm.nodeName === 'A' && 'href' in elm;\n  };\n\n  var isInsideAnchor = function (location) {\n    return location.fold(never, isAnchorLink, isAnchorLink, never);\n  };\n\n  var readInlineAnchorLocation = function (editor) {\n    var isInlineTarget$1 = curry(isInlineTarget, editor);\n    var position = CaretPosition.fromRangeStart(editor.selection.getRng());\n    return readLocation(isInlineTarget$1, editor.getBody(), position).filter(isInsideAnchor);\n  };\n\n  var insertBrOutsideAnchor = function (editor, location) {\n    location.fold(noop, curry(insertBrBefore, editor), curry(insertBrAfter, editor), noop);\n  };\n\n  var insert$2 = function (editor, evt) {\n    var anchorLocation = readInlineAnchorLocation(editor);\n\n    if (anchorLocation.isSome()) {\n      anchorLocation.each(curry(insertBrOutsideAnchor, editor));\n    } else {\n      insertBrAtCaret(editor, evt);\n    }\n  };\n\n  var matchesSelector = function (editor, selector) {\n    return getParentBlock$2(editor).filter(function (parentBlock) {\n      return selector.length > 0 && is$1(SugarElement.fromDom(parentBlock), selector);\n    }).isSome();\n  };\n\n  var shouldInsertBr = function (editor) {\n    return matchesSelector(editor, getBrNewLineSelector(editor));\n  };\n\n  var shouldBlockNewLine = function (editor) {\n    return matchesSelector(editor, getNoNewLineSelector(editor));\n  };\n\n  var newLineAction = Adt.generate([{\n    br: []\n  }, {\n    block: []\n  }, {\n    none: []\n  }]);\n\n  var shouldBlockNewLine$1 = function (editor, _shiftKey) {\n    return shouldBlockNewLine(editor);\n  };\n\n  var isBrMode = function (requiredState) {\n    return function (editor, _shiftKey) {\n      var brMode = getForcedRootBlock(editor) === '';\n      return brMode === requiredState;\n    };\n  };\n\n  var inListBlock = function (requiredState) {\n    return function (editor, _shiftKey) {\n      return isListItemParentBlock(editor) === requiredState;\n    };\n  };\n\n  var inBlock = function (blockName, requiredState) {\n    return function (editor, _shiftKey) {\n      var state = getParentBlockName(editor) === blockName.toUpperCase();\n      return state === requiredState;\n    };\n  };\n\n  var inPreBlock = function (requiredState) {\n    return inBlock('pre', requiredState);\n  };\n\n  var inSummaryBlock = function () {\n    return inBlock('summary', true);\n  };\n\n  var shouldPutBrInPre$1 = function (requiredState) {\n    return function (editor, _shiftKey) {\n      return shouldPutBrInPre(editor) === requiredState;\n    };\n  };\n\n  var inBrContext = function (editor, _shiftKey) {\n    return shouldInsertBr(editor);\n  };\n\n  var hasShiftKey = function (_editor, shiftKey) {\n    return shiftKey;\n  };\n\n  var canInsertIntoEditableRoot = function (editor) {\n    var forcedRootBlock = getForcedRootBlock(editor);\n    var rootEditable = getEditableRoot(editor.dom, editor.selection.getStart());\n    return rootEditable && editor.schema.isValidChild(rootEditable.nodeName, forcedRootBlock ? forcedRootBlock : 'P');\n  };\n\n  var match$2 = function (predicates, action) {\n    return function (editor, shiftKey) {\n      var isMatch = foldl(predicates, function (res, p) {\n        return res && p(editor, shiftKey);\n      }, true);\n      return isMatch ? Optional.some(action) : Optional.none();\n    };\n  };\n\n  var getAction$1 = function (editor, evt) {\n    return evaluateUntil([match$2([shouldBlockNewLine$1], newLineAction.none()), match$2([inSummaryBlock()], newLineAction.br()), match$2([inPreBlock(true), shouldPutBrInPre$1(false), hasShiftKey], newLineAction.br()), match$2([inPreBlock(true), shouldPutBrInPre$1(false)], newLineAction.block()), match$2([inPreBlock(true), shouldPutBrInPre$1(true), hasShiftKey], newLineAction.block()), match$2([inPreBlock(true), shouldPutBrInPre$1(true)], newLineAction.br()), match$2([inListBlock(true), hasShiftKey], newLineAction.br()), match$2([inListBlock(true)], newLineAction.block()), match$2([isBrMode(true), hasShiftKey, canInsertIntoEditableRoot], newLineAction.block()), match$2([isBrMode(true)], newLineAction.br()), match$2([inBrContext], newLineAction.br()), match$2([isBrMode(false), hasShiftKey], newLineAction.br()), match$2([canInsertIntoEditableRoot], newLineAction.block())], [editor, !!(evt && evt.shiftKey)]).getOr(newLineAction.none());\n  };\n\n  var insert$3 = function (editor, evt) {\n    getAction$1(editor, evt).fold(function () {\n      insert$2(editor, evt);\n    }, function () {\n      insert$1(editor, evt);\n    }, noop);\n  };\n\n  var handleEnterKeyEvent = function (editor, event) {\n    if (event.isDefaultPrevented()) {\n      return;\n    }\n\n    event.preventDefault();\n    endTypingLevelIgnoreLocks(editor.undoManager);\n    editor.undoManager.transact(function () {\n      if (editor.selection.isCollapsed() === false) {\n        editor.execCommand('Delete');\n      }\n\n      insert$3(editor, event);\n    });\n  };\n\n  var setup$e = function (editor) {\n    editor.on('keydown', function (event) {\n      if (event.keyCode === VK.ENTER) {\n        handleEnterKeyEvent(editor, event);\n      }\n    });\n  };\n\n  var executeKeydownOverride$2 = function (editor, caret, evt) {\n    execute([{\n      keyCode: VK.END,\n      action: action(moveToLineEndPoint$2, editor, true)\n    }, {\n      keyCode: VK.HOME,\n      action: action(moveToLineEndPoint$2, editor, false)\n    }, {\n      keyCode: VK.END,\n      action: action(moveToLineEndPoint$3, editor, true)\n    }, {\n      keyCode: VK.HOME,\n      action: action(moveToLineEndPoint$3, editor, false)\n    }, {\n      keyCode: VK.END,\n      action: action(moveToLineEndPoint$1, editor, true, caret)\n    }, {\n      keyCode: VK.HOME,\n      action: action(moveToLineEndPoint$1, editor, false, caret)\n    }], evt).each(function (_) {\n      evt.preventDefault();\n    });\n  };\n\n  var setup$f = function (editor, caret) {\n    editor.on('keydown', function (evt) {\n      if (evt.isDefaultPrevented() === false) {\n        executeKeydownOverride$2(editor, caret, evt);\n      }\n    });\n  };\n\n  var browser$4 = detect$3().browser;\n\n  var setupIeInput = function (editor) {\n    var keypressThrotter = first(function () {\n      if (!editor.composing) {\n        normalizeNbspsInEditor(editor);\n      }\n    }, 0);\n\n    if (browser$4.isIE()) {\n      editor.on('keypress', function (_e) {\n        keypressThrotter.throttle();\n      });\n      editor.on('remove', function (_e) {\n        keypressThrotter.cancel();\n      });\n    }\n  };\n\n  var setup$g = function (editor) {\n    setupIeInput(editor);\n    editor.on('input', function (e) {\n      if (e.isComposing === false) {\n        normalizeNbspsInEditor(editor);\n      }\n    });\n  };\n\n  var platform$2 = detect$3();\n\n  var executeKeyupAction = function (editor, caret, evt) {\n    execute([{\n      keyCode: VK.PAGE_UP,\n      action: action(moveToLineEndPoint$1, editor, false, caret)\n    }, {\n      keyCode: VK.PAGE_DOWN,\n      action: action(moveToLineEndPoint$1, editor, true, caret)\n    }], evt);\n  };\n\n  var stopImmediatePropagation = function (e) {\n    return e.stopImmediatePropagation();\n  };\n\n  var isPageUpDown = function (evt) {\n    return evt.keyCode === VK.PAGE_UP || evt.keyCode === VK.PAGE_DOWN;\n  };\n\n  var setNodeChangeBlocker = function (blocked, editor, block) {\n    if (block && !blocked.get()) {\n      editor.on('NodeChange', stopImmediatePropagation, true);\n    } else if (!block && blocked.get()) {\n      editor.off('NodeChange', stopImmediatePropagation);\n    }\n\n    blocked.set(block);\n  };\n\n  var setup$h = function (editor, caret) {\n    if (platform$2.os.isOSX()) {\n      return;\n    }\n\n    var blocked = Cell(false);\n    editor.on('keydown', function (evt) {\n      if (isPageUpDown(evt)) {\n        setNodeChangeBlocker(blocked, editor, true);\n      }\n    });\n    editor.on('keyup', function (evt) {\n      if (evt.isDefaultPrevented() === false) {\n        executeKeyupAction(editor, caret, evt);\n      }\n\n      if (isPageUpDown(evt) && blocked.get()) {\n        setNodeChangeBlocker(blocked, editor, false);\n        editor.nodeChanged();\n      }\n    });\n  };\n\n  var insertTextAtPosition = function (text, pos) {\n    var container = pos.container();\n    var offset = pos.offset();\n\n    if (isText$1(container)) {\n      container.insertData(offset, text);\n      return Optional.some(CaretPosition(container, offset + text.length));\n    } else {\n      return getElementFromPosition(pos).map(function (elm) {\n        var textNode = SugarElement.fromText(text);\n\n        if (pos.isAtEnd()) {\n          after(elm, textNode);\n        } else {\n          before(elm, textNode);\n        }\n\n        return CaretPosition(textNode.dom, text.length);\n      });\n    }\n  };\n\n  var insertNbspAtPosition = curry(insertTextAtPosition, nbsp);\n  var insertSpaceAtPosition = curry(insertTextAtPosition, ' ');\n\n  var locationToCaretPosition = function (root) {\n    return function (location) {\n      return location.fold(function (element) {\n        return prevPosition(root.dom, CaretPosition.before(element));\n      }, function (element) {\n        return firstPositionIn(element);\n      }, function (element) {\n        return lastPositionIn(element);\n      }, function (element) {\n        return nextPosition(root.dom, CaretPosition.after(element));\n      });\n    };\n  };\n\n  var insertInlineBoundarySpaceOrNbsp = function (root, pos) {\n    return function (checkPos) {\n      return needsToHaveNbsp(root, checkPos) ? insertNbspAtPosition(pos) : insertSpaceAtPosition(pos);\n    };\n  };\n\n  var setSelection$1 = function (editor) {\n    return function (pos) {\n      editor.selection.setRng(pos.toRange());\n      editor.nodeChanged();\n      return true;\n    };\n  };\n\n  var insertSpaceOrNbspAtSelection = function (editor) {\n    var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n    var root = SugarElement.fromDom(editor.getBody());\n\n    if (editor.selection.isCollapsed()) {\n      var isInlineTarget$1 = curry(isInlineTarget, editor);\n      var caretPosition = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return readLocation(isInlineTarget$1, editor.getBody(), caretPosition).bind(locationToCaretPosition(root)).bind(insertInlineBoundarySpaceOrNbsp(root, pos)).exists(setSelection$1(editor));\n    } else {\n      return false;\n    }\n  };\n\n  var executeKeydownOverride$3 = function (editor, evt) {\n    execute([{\n      keyCode: VK.SPACEBAR,\n      action: action(insertSpaceOrNbspAtSelection, editor)\n    }], evt).each(function (_) {\n      evt.preventDefault();\n    });\n  };\n\n  var setup$i = function (editor) {\n    editor.on('keydown', function (evt) {\n      if (evt.isDefaultPrevented() === false) {\n        executeKeydownOverride$3(editor, evt);\n      }\n    });\n  };\n\n  var registerKeyboardOverrides = function (editor) {\n    var caret = setupSelectedState(editor);\n    setup$b(editor);\n    setup$c(editor, caret);\n    setup$d(editor, caret);\n    setup$e(editor);\n    setup$i(editor);\n    setup$g(editor);\n    setup$f(editor, caret);\n    setup$h(editor, caret);\n    return caret;\n  };\n\n  var setup$j = function (editor) {\n    if (!isRtc(editor)) {\n      return registerKeyboardOverrides(editor);\n    } else {\n      return Cell(null);\n    }\n  };\n\n  var NodeChange = function () {\n    function NodeChange(editor) {\n      this.lastPath = [];\n      this.editor = editor;\n      var lastRng;\n      var self = this;\n\n      if (!('onselectionchange' in editor.getDoc())) {\n        editor.on('NodeChange click mouseup keyup focus', function (e) {\n          var nativeRng = editor.selection.getRng();\n          var fakeRng = {\n            startContainer: nativeRng.startContainer,\n            startOffset: nativeRng.startOffset,\n            endContainer: nativeRng.endContainer,\n            endOffset: nativeRng.endOffset\n          };\n\n          if (e.type === 'nodechange' || !isEq$1(fakeRng, lastRng)) {\n            editor.fire('SelectionChange');\n          }\n\n          lastRng = fakeRng;\n        });\n      }\n\n      editor.on('contextmenu', function () {\n        editor.fire('SelectionChange');\n      });\n      editor.on('SelectionChange', function () {\n        var startElm = editor.selection.getStart(true);\n\n        if (!startElm || !Env.range && editor.selection.isCollapsed()) {\n          return;\n        }\n\n        if (hasAnyRanges(editor) && !self.isSameElementPath(startElm) && editor.dom.isChildOf(startElm, editor.getBody())) {\n          editor.nodeChanged({\n            selectionChange: true\n          });\n        }\n      });\n      editor.on('mouseup', function (e) {\n        if (!e.isDefaultPrevented() && hasAnyRanges(editor)) {\n          if (editor.selection.getNode().nodeName === 'IMG') {\n            Delay.setEditorTimeout(editor, function () {\n              editor.nodeChanged();\n            });\n          } else {\n            editor.nodeChanged();\n          }\n        }\n      });\n    }\n\n    NodeChange.prototype.nodeChanged = function (args) {\n      var selection = this.editor.selection;\n      var node, parents, root;\n\n      if (this.editor.initialized && selection && !shouldDisableNodeChange(this.editor) && !this.editor.mode.isReadOnly()) {\n        root = this.editor.getBody();\n        node = selection.getStart(true) || root;\n\n        if (node.ownerDocument !== this.editor.getDoc() || !this.editor.dom.isChildOf(node, root)) {\n          node = root;\n        }\n\n        parents = [];\n        this.editor.dom.getParent(node, function (node) {\n          if (node === root) {\n            return true;\n          }\n\n          parents.push(node);\n        });\n        args = args || {};\n        args.element = node;\n        args.parents = parents;\n        this.editor.fire('NodeChange', args);\n      }\n    };\n\n    NodeChange.prototype.isSameElementPath = function (startElm) {\n      var i;\n      var currentPath = this.editor.$(startElm).parentsUntil(this.editor.getBody()).add(startElm);\n\n      if (currentPath.length === this.lastPath.length) {\n        for (i = currentPath.length; i >= 0; i--) {\n          if (currentPath[i] !== this.lastPath[i]) {\n            break;\n          }\n        }\n\n        if (i === -1) {\n          this.lastPath = currentPath;\n          return true;\n        }\n      }\n\n      this.lastPath = currentPath;\n      return false;\n    };\n\n    return NodeChange;\n  }();\n\n  var preventSummaryToggle = function (editor) {\n    editor.on('click', function (e) {\n      if (editor.dom.getParent(e.target, 'details')) {\n        e.preventDefault();\n      }\n    });\n  };\n\n  var filterDetails = function (editor) {\n    editor.parser.addNodeFilter('details', function (elms) {\n      each(elms, function (details) {\n        details.attr('data-mce-open', details.attr('open'));\n        details.attr('open', 'open');\n      });\n    });\n    editor.serializer.addNodeFilter('details', function (elms) {\n      each(elms, function (details) {\n        var open = details.attr('data-mce-open');\n        details.attr('open', isString(open) ? open : null);\n        details.attr('data-mce-open', null);\n      });\n    });\n  };\n\n  var setup$k = function (editor) {\n    preventSummaryToggle(editor);\n    filterDetails(editor);\n  };\n\n  var isTextBlockNode = function (node) {\n    return isElement$1(node) && isTextBlock(SugarElement.fromDom(node));\n  };\n\n  var normalizeSelection$1 = function (editor) {\n    var rng = editor.selection.getRng();\n    var startPos = CaretPosition.fromRangeStart(rng);\n    var endPos = CaretPosition.fromRangeEnd(rng);\n\n    if (CaretPosition.isElementPosition(startPos)) {\n      var container = startPos.container();\n\n      if (isTextBlockNode(container)) {\n        firstPositionIn(container).each(function (pos) {\n          return rng.setStart(pos.container(), pos.offset());\n        });\n      }\n    }\n\n    if (CaretPosition.isElementPosition(endPos)) {\n      var container = startPos.container();\n\n      if (isTextBlockNode(container)) {\n        lastPositionIn(container).each(function (pos) {\n          return rng.setEnd(pos.container(), pos.offset());\n        });\n      }\n    }\n\n    editor.selection.setRng(normalize$2(rng));\n  };\n\n  var setup$l = function (editor) {\n    editor.on('click', function (e) {\n      if (e.detail >= 3) {\n        normalizeSelection$1(editor);\n      }\n    });\n  };\n\n  var value$1 = function () {\n    var subject = Cell(Optional.none());\n\n    var clear = function () {\n      return subject.set(Optional.none());\n    };\n\n    var set = function (s) {\n      return subject.set(Optional.some(s));\n    };\n\n    var isSet = function () {\n      return subject.get().isSome();\n    };\n\n    var on = function (f) {\n      return subject.get().each(f);\n    };\n\n    return {\n      clear: clear,\n      set: set,\n      isSet: isSet,\n      on: on\n    };\n  };\n\n  var getAbsolutePosition = function (elm) {\n    var clientRect = elm.getBoundingClientRect();\n    var doc = elm.ownerDocument;\n    var docElem = doc.documentElement;\n    var win = doc.defaultView;\n    return {\n      top: clientRect.top + win.pageYOffset - docElem.clientTop,\n      left: clientRect.left + win.pageXOffset - docElem.clientLeft\n    };\n  };\n\n  var getBodyPosition = function (editor) {\n    return editor.inline ? getAbsolutePosition(editor.getBody()) : {\n      left: 0,\n      top: 0\n    };\n  };\n\n  var getScrollPosition = function (editor) {\n    var body = editor.getBody();\n    return editor.inline ? {\n      left: body.scrollLeft,\n      top: body.scrollTop\n    } : {\n      left: 0,\n      top: 0\n    };\n  };\n\n  var getBodyScroll = function (editor) {\n    var body = editor.getBody(),\n        docElm = editor.getDoc().documentElement;\n    var inlineScroll = {\n      left: body.scrollLeft,\n      top: body.scrollTop\n    };\n    var iframeScroll = {\n      left: body.scrollLeft || docElm.scrollLeft,\n      top: body.scrollTop || docElm.scrollTop\n    };\n    return editor.inline ? inlineScroll : iframeScroll;\n  };\n\n  var getMousePosition = function (editor, event) {\n    if (event.target.ownerDocument !== editor.getDoc()) {\n      var iframePosition = getAbsolutePosition(editor.getContentAreaContainer());\n      var scrollPosition = getBodyScroll(editor);\n      return {\n        left: event.pageX - iframePosition.left + scrollPosition.left,\n        top: event.pageY - iframePosition.top + scrollPosition.top\n      };\n    }\n\n    return {\n      left: event.pageX,\n      top: event.pageY\n    };\n  };\n\n  var calculatePosition = function (bodyPosition, scrollPosition, mousePosition) {\n    return {\n      pageX: mousePosition.left - bodyPosition.left + scrollPosition.left,\n      pageY: mousePosition.top - bodyPosition.top + scrollPosition.top\n    };\n  };\n\n  var calc = function (editor, event) {\n    return calculatePosition(getBodyPosition(editor), getScrollPosition(editor), getMousePosition(editor, event));\n  };\n\n  var isContentEditableFalse$a = isContentEditableFalse,\n      isContentEditableTrue$3 = isContentEditableTrue;\n\n  var isDraggable = function (rootElm, elm) {\n    return isContentEditableFalse$a(elm) && elm !== rootElm;\n  };\n\n  var isValidDropTarget = function (editor, targetElement, dragElement) {\n    if (targetElement === dragElement || editor.dom.isChildOf(targetElement, dragElement)) {\n      return false;\n    }\n\n    return !isContentEditableFalse$a(targetElement);\n  };\n\n  var cloneElement = function (elm) {\n    var cloneElm = elm.cloneNode(true);\n    cloneElm.removeAttribute('data-mce-selected');\n    return cloneElm;\n  };\n\n  var createGhost = function (editor, elm, width, height) {\n    var dom = editor.dom;\n    var clonedElm = elm.cloneNode(true);\n    dom.setStyles(clonedElm, {\n      width: width,\n      height: height\n    });\n    dom.setAttrib(clonedElm, 'data-mce-selected', null);\n    var ghostElm = dom.create('div', {\n      'class': 'mce-drag-container',\n      'data-mce-bogus': 'all',\n      'unselectable': 'on',\n      'contenteditable': 'false'\n    });\n    dom.setStyles(ghostElm, {\n      position: 'absolute',\n      opacity: 0.5,\n      overflow: 'hidden',\n      border: 0,\n      padding: 0,\n      margin: 0,\n      width: width,\n      height: height\n    });\n    dom.setStyles(clonedElm, {\n      margin: 0,\n      boxSizing: 'border-box'\n    });\n    ghostElm.appendChild(clonedElm);\n    return ghostElm;\n  };\n\n  var appendGhostToBody = function (ghostElm, bodyElm) {\n    if (ghostElm.parentNode !== bodyElm) {\n      bodyElm.appendChild(ghostElm);\n    }\n  };\n\n  var moveGhost = function (ghostElm, position, width, height, maxX, maxY) {\n    var overflowX = 0,\n        overflowY = 0;\n    ghostElm.style.left = position.pageX + 'px';\n    ghostElm.style.top = position.pageY + 'px';\n\n    if (position.pageX + width > maxX) {\n      overflowX = position.pageX + width - maxX;\n    }\n\n    if (position.pageY + height > maxY) {\n      overflowY = position.pageY + height - maxY;\n    }\n\n    ghostElm.style.width = width - overflowX + 'px';\n    ghostElm.style.height = height - overflowY + 'px';\n  };\n\n  var removeElement = function (elm) {\n    if (elm && elm.parentNode) {\n      elm.parentNode.removeChild(elm);\n    }\n  };\n\n  var isLeftMouseButtonPressed = function (e) {\n    return e.button === 0;\n  };\n\n  var applyRelPos = function (state, position) {\n    return {\n      pageX: position.pageX - state.relX,\n      pageY: position.pageY + 5\n    };\n  };\n\n  var start$1 = function (state, editor) {\n    return function (e) {\n      if (isLeftMouseButtonPressed(e)) {\n        var ceElm = find(editor.dom.getParents(e.target), or(isContentEditableFalse$a, isContentEditableTrue$3)).getOr(null);\n\n        if (isDraggable(editor.getBody(), ceElm)) {\n          var elmPos = editor.dom.getPos(ceElm);\n          var bodyElm = editor.getBody();\n          var docElm = editor.getDoc().documentElement;\n          state.set({\n            element: ceElm,\n            dragging: false,\n            screenX: e.screenX,\n            screenY: e.screenY,\n            maxX: (editor.inline ? bodyElm.scrollWidth : docElm.offsetWidth) - 2,\n            maxY: (editor.inline ? bodyElm.scrollHeight : docElm.offsetHeight) - 2,\n            relX: e.pageX - elmPos.x,\n            relY: e.pageY - elmPos.y,\n            width: ceElm.offsetWidth,\n            height: ceElm.offsetHeight,\n            ghost: createGhost(editor, ceElm, ceElm.offsetWidth, ceElm.offsetHeight)\n          });\n        }\n      }\n    };\n  };\n\n  var move$2 = function (state, editor) {\n    var throttledPlaceCaretAt = Delay.throttle(function (clientX, clientY) {\n      editor._selectionOverrides.hideFakeCaret();\n\n      editor.selection.placeCaretAt(clientX, clientY);\n    }, 0);\n    editor.on('remove', throttledPlaceCaretAt.stop);\n    return function (e) {\n      return state.on(function (state) {\n        var movement = Math.max(Math.abs(e.screenX - state.screenX), Math.abs(e.screenY - state.screenY));\n\n        if (!state.dragging && movement > 10) {\n          var args = editor.fire('dragstart', {\n            target: state.element\n          });\n\n          if (args.isDefaultPrevented()) {\n            return;\n          }\n\n          state.dragging = true;\n          editor.focus();\n        }\n\n        if (state.dragging) {\n          var targetPos = applyRelPos(state, calc(editor, e));\n          appendGhostToBody(state.ghost, editor.getBody());\n          moveGhost(state.ghost, targetPos, state.width, state.height, state.maxX, state.maxY);\n          throttledPlaceCaretAt(e.clientX, e.clientY);\n        }\n      });\n    };\n  };\n\n  var getRawTarget = function (selection) {\n    var rng = selection.getSel().getRangeAt(0);\n    var startContainer = rng.startContainer;\n    return startContainer.nodeType === 3 ? startContainer.parentNode : startContainer;\n  };\n\n  var drop = function (state, editor) {\n    return function (e) {\n      state.on(function (state) {\n        if (state.dragging) {\n          if (isValidDropTarget(editor, getRawTarget(editor.selection), state.element)) {\n            var targetClone_1 = cloneElement(state.element);\n            var args = editor.fire('drop', {\n              clientX: e.clientX,\n              clientY: e.clientY\n            });\n\n            if (!args.isDefaultPrevented()) {\n              editor.undoManager.transact(function () {\n                removeElement(state.element);\n                editor.insertContent(editor.dom.getOuterHTML(targetClone_1));\n\n                editor._selectionOverrides.hideFakeCaret();\n              });\n            }\n          }\n        }\n      });\n      removeDragState(state);\n    };\n  };\n\n  var stop = function (state, editor) {\n    return function () {\n      state.on(function (state) {\n        if (state.dragging) {\n          editor.fire('dragend');\n        }\n      });\n      removeDragState(state);\n    };\n  };\n\n  var removeDragState = function (state) {\n    state.on(function (state) {\n      removeElement(state.ghost);\n    });\n    state.clear();\n  };\n\n  var bindFakeDragEvents = function (editor) {\n    var state = value$1();\n    var pageDom = DOMUtils.DOM;\n    var rootDocument = document;\n    var dragStartHandler = start$1(state, editor);\n    var dragHandler = move$2(state, editor);\n    var dropHandler = drop(state, editor);\n    var dragEndHandler = stop(state, editor);\n    editor.on('mousedown', dragStartHandler);\n    editor.on('mousemove', dragHandler);\n    editor.on('mouseup', dropHandler);\n    pageDom.bind(rootDocument, 'mousemove', dragHandler);\n    pageDom.bind(rootDocument, 'mouseup', dragEndHandler);\n    editor.on('remove', function () {\n      pageDom.unbind(rootDocument, 'mousemove', dragHandler);\n      pageDom.unbind(rootDocument, 'mouseup', dragEndHandler);\n    });\n  };\n\n  var blockIeDrop = function (editor) {\n    editor.on('drop', function (e) {\n      var realTarget = typeof e.clientX !== 'undefined' ? editor.getDoc().elementFromPoint(e.clientX, e.clientY) : null;\n\n      if (isContentEditableFalse$a(realTarget) || editor.dom.getContentEditableParent(realTarget) === 'false') {\n        e.preventDefault();\n      }\n    });\n  };\n\n  var blockUnsupportedFileDrop = function (editor) {\n    var preventFileDrop = function (e) {\n      if (!e.isDefaultPrevented()) {\n        var dataTransfer = e.dataTransfer;\n\n        if (dataTransfer && (contains(dataTransfer.types, 'Files') || dataTransfer.files.length > 0)) {\n          e.preventDefault();\n\n          if (e.type === 'drop') {\n            displayError(editor, 'Dropped file type is not supported');\n          }\n        }\n      }\n    };\n\n    var preventFileDropIfUIElement = function (e) {\n      if (isUIElement(editor, e.target)) {\n        preventFileDrop(e);\n      }\n    };\n\n    var setup = function () {\n      var pageDom = DOMUtils.DOM;\n      var dom = editor.dom;\n      var doc = document;\n      var editorRoot = editor.inline ? editor.getBody() : editor.getDoc();\n      var eventNames = ['drop', 'dragover'];\n      each(eventNames, function (name) {\n        pageDom.bind(doc, name, preventFileDropIfUIElement);\n        dom.bind(editorRoot, name, preventFileDrop);\n      });\n      editor.on('remove', function () {\n        each(eventNames, function (name) {\n          pageDom.unbind(doc, name, preventFileDropIfUIElement);\n          dom.unbind(editorRoot, name, preventFileDrop);\n        });\n      });\n    };\n\n    editor.on('init', function () {\n      Delay.setEditorTimeout(editor, setup, 0);\n    });\n  };\n\n  var init = function (editor) {\n    bindFakeDragEvents(editor);\n    blockIeDrop(editor);\n\n    if (shouldBlockUnsupportedDrop(editor)) {\n      blockUnsupportedFileDrop(editor);\n    }\n  };\n\n  var setup$m = function (editor) {\n    var renderFocusCaret = first(function () {\n      if (!editor.removed && editor.getBody().contains(document.activeElement)) {\n        var rng = editor.selection.getRng();\n\n        if (rng.collapsed) {\n          var caretRange = renderRangeCaret(editor, rng, false);\n          editor.selection.setRng(caretRange);\n        }\n      }\n    }, 0);\n    editor.on('focus', function () {\n      renderFocusCaret.throttle();\n    });\n    editor.on('blur', function () {\n      renderFocusCaret.cancel();\n    });\n  };\n\n  var setup$n = function (editor) {\n    editor.on('init', function () {\n      editor.on('focusin', function (e) {\n        var target = e.target;\n\n        if (isMedia(target)) {\n          var ceRoot = getContentEditableRoot(editor.getBody(), target);\n          var node = isContentEditableFalse(ceRoot) ? ceRoot : target;\n\n          if (editor.selection.getNode() !== node) {\n            selectNode(editor, node).each(function (rng) {\n              return editor.selection.setRng(rng);\n            });\n          }\n        }\n      });\n    });\n  };\n\n  var isContentEditableTrue$4 = isContentEditableTrue;\n  var isContentEditableFalse$b = isContentEditableFalse;\n\n  var getContentEditableRoot$1 = function (editor, node) {\n    return getContentEditableRoot(editor.getBody(), node);\n  };\n\n  var SelectionOverrides = function (editor) {\n    var selection = editor.selection,\n        dom = editor.dom;\n    var isBlock = dom.isBlock;\n    var rootNode = editor.getBody();\n    var fakeCaret = FakeCaret(editor, rootNode, isBlock, function () {\n      return hasFocus$1(editor);\n    });\n    var realSelectionId = 'sel-' + dom.uniqueId();\n    var elementSelectionAttr = 'data-mce-selected';\n    var selectedElement;\n\n    var isFakeSelectionElement = function (node) {\n      return dom.hasClass(node, 'mce-offscreen-selection');\n    };\n\n    var isFakeSelectionTargetElement = function (node) {\n      return node !== rootNode && (isContentEditableFalse$b(node) || isMedia(node)) && dom.isChildOf(node, rootNode);\n    };\n\n    var isNearFakeSelectionElement = function (pos) {\n      return isBeforeContentEditableFalse(pos) || isAfterContentEditableFalse(pos) || isBeforeMedia(pos) || isAfterMedia(pos);\n    };\n\n    var getRealSelectionElement = function () {\n      var container = dom.get(realSelectionId);\n      return container ? container.getElementsByTagName('*')[0] : container;\n    };\n\n    var setRange = function (range) {\n      if (range) {\n        selection.setRng(range);\n      }\n    };\n\n    var getRange = selection.getRng;\n\n    var showCaret = function (direction, node, before, scrollIntoView) {\n      if (scrollIntoView === void 0) {\n        scrollIntoView = true;\n      }\n\n      var e = editor.fire('ShowCaret', {\n        target: node,\n        direction: direction,\n        before: before\n      });\n\n      if (e.isDefaultPrevented()) {\n        return null;\n      }\n\n      if (scrollIntoView) {\n        selection.scrollIntoView(node, direction === -1);\n      }\n\n      return fakeCaret.show(before, node);\n    };\n\n    var showBlockCaretContainer = function (blockCaretContainer) {\n      if (blockCaretContainer.hasAttribute('data-mce-caret')) {\n        showCaretContainerBlock(blockCaretContainer);\n        setRange(getRange());\n        selection.scrollIntoView(blockCaretContainer);\n      }\n    };\n\n    var registerEvents = function () {\n      editor.on('mouseup', function (e) {\n        var range = getRange();\n\n        if (range.collapsed && isXYInContentArea(editor, e.clientX, e.clientY)) {\n          renderCaretAtRange(editor, range, false).each(setRange);\n        }\n      });\n      editor.on('click', function (e) {\n        var contentEditableRoot = getContentEditableRoot$1(editor, e.target);\n\n        if (contentEditableRoot) {\n          if (isContentEditableFalse$b(contentEditableRoot)) {\n            e.preventDefault();\n            editor.focus();\n          }\n\n          if (isContentEditableTrue$4(contentEditableRoot)) {\n            if (dom.isChildOf(contentEditableRoot, selection.getNode())) {\n              removeElementSelection();\n            }\n          }\n        }\n      });\n      editor.on('blur NewBlock', removeElementSelection);\n      editor.on('ResizeWindow FullscreenStateChanged', fakeCaret.reposition);\n\n      var hasNormalCaretPosition = function (elm) {\n        var caretWalker = CaretWalker(elm);\n\n        if (!elm.firstChild) {\n          return false;\n        }\n\n        var startPos = CaretPosition.before(elm.firstChild);\n        var newPos = caretWalker.next(startPos);\n        return newPos && !isNearFakeSelectionElement(newPos);\n      };\n\n      var isInSameBlock = function (node1, node2) {\n        var block1 = dom.getParent(node1, isBlock);\n        var block2 = dom.getParent(node2, isBlock);\n        return block1 === block2;\n      };\n\n      var hasBetterMouseTarget = function (targetNode, caretNode) {\n        var targetBlock = dom.getParent(targetNode, isBlock);\n        var caretBlock = dom.getParent(caretNode, isBlock);\n\n        if (targetBlock && targetNode !== caretBlock && dom.isChildOf(targetBlock, caretBlock) && isContentEditableFalse$b(getContentEditableRoot$1(editor, targetBlock)) === false) {\n          return true;\n        }\n\n        return targetBlock && !isInSameBlock(targetBlock, caretBlock) && hasNormalCaretPosition(targetBlock);\n      };\n\n      editor.on('tap', function (e) {\n        var targetElm = e.target;\n        var contentEditableRoot = getContentEditableRoot$1(editor, targetElm);\n\n        if (isContentEditableFalse$b(contentEditableRoot)) {\n          e.preventDefault();\n          selectNode(editor, contentEditableRoot).each(setElementSelection);\n        } else if (isFakeSelectionTargetElement(targetElm)) {\n          selectNode(editor, targetElm).each(setElementSelection);\n        }\n      }, true);\n      editor.on('mousedown', function (e) {\n        var targetElm = e.target;\n\n        if (targetElm !== rootNode && targetElm.nodeName !== 'HTML' && !dom.isChildOf(targetElm, rootNode)) {\n          return;\n        }\n\n        if (isXYInContentArea(editor, e.clientX, e.clientY) === false) {\n          return;\n        }\n\n        var contentEditableRoot = getContentEditableRoot$1(editor, targetElm);\n\n        if (contentEditableRoot) {\n          if (isContentEditableFalse$b(contentEditableRoot)) {\n            e.preventDefault();\n            selectNode(editor, contentEditableRoot).each(setElementSelection);\n          } else {\n            removeElementSelection();\n\n            if (!(isContentEditableTrue$4(contentEditableRoot) && e.shiftKey) && !isXYWithinRange(e.clientX, e.clientY, selection.getRng())) {\n              hideFakeCaret();\n              selection.placeCaretAt(e.clientX, e.clientY);\n            }\n          }\n        } else if (isFakeSelectionTargetElement(targetElm)) {\n          selectNode(editor, targetElm).each(setElementSelection);\n        } else if (isFakeCaretTarget(targetElm) === false) {\n          removeElementSelection();\n          hideFakeCaret();\n          var fakeCaretInfo = closestFakeCaret(rootNode, e.clientX, e.clientY);\n\n          if (fakeCaretInfo) {\n            if (!hasBetterMouseTarget(targetElm, fakeCaretInfo.node)) {\n              e.preventDefault();\n              var range = showCaret(1, fakeCaretInfo.node, fakeCaretInfo.before, false);\n              editor.getBody().focus();\n              setRange(range);\n            }\n          }\n        }\n      });\n      editor.on('keypress', function (e) {\n        if (VK.modifierPressed(e)) {\n          return;\n        }\n\n        if (isContentEditableFalse$b(selection.getNode())) {\n          e.preventDefault();\n        }\n      });\n      editor.on('GetSelectionRange', function (e) {\n        var rng = e.range;\n\n        if (selectedElement) {\n          if (!selectedElement.parentNode) {\n            selectedElement = null;\n            return;\n          }\n\n          rng = rng.cloneRange();\n          rng.selectNode(selectedElement);\n          e.range = rng;\n        }\n      });\n      editor.on('SetSelectionRange', function (e) {\n        e.range = normalizeShortEndedElementSelection(e.range);\n        var rng = setElementSelection(e.range, e.forward);\n\n        if (rng) {\n          e.range = rng;\n        }\n      });\n\n      var isPasteBin = function (node) {\n        return node.id === 'mcepastebin';\n      };\n\n      editor.on('AfterSetSelectionRange', function (e) {\n        var rng = e.range;\n        var parentNode = rng.startContainer.parentNode;\n\n        if (!isRangeInCaretContainer(rng) && !isPasteBin(parentNode)) {\n          hideFakeCaret();\n        }\n\n        if (!isFakeSelectionElement(parentNode)) {\n          removeElementSelection();\n        }\n      });\n      editor.on('copy', function (e) {\n        var clipboardData = e.clipboardData;\n\n        if (!e.isDefaultPrevented() && e.clipboardData && !Env.ie) {\n          var realSelectionElement = getRealSelectionElement();\n\n          if (realSelectionElement) {\n            e.preventDefault();\n            clipboardData.clearData();\n            clipboardData.setData('text/html', realSelectionElement.outerHTML);\n            clipboardData.setData('text/plain', realSelectionElement.outerText || realSelectionElement.innerText);\n          }\n        }\n      });\n      init(editor);\n      setup$m(editor);\n      setup$n(editor);\n    };\n\n    var isWithinCaretContainer = function (node) {\n      return isCaretContainer(node) || startsWithCaretContainer(node) || endsWithCaretContainer(node);\n    };\n\n    var isRangeInCaretContainer = function (rng) {\n      return isWithinCaretContainer(rng.startContainer) || isWithinCaretContainer(rng.endContainer);\n    };\n\n    var normalizeShortEndedElementSelection = function (rng) {\n      var shortEndedElements = editor.schema.getShortEndedElements();\n      var newRng = dom.createRng();\n      var startContainer = rng.startContainer;\n      var startOffset = rng.startOffset;\n      var endContainer = rng.endContainer;\n      var endOffset = rng.endOffset;\n\n      if (has(shortEndedElements, startContainer.nodeName.toLowerCase())) {\n        if (startOffset === 0) {\n          newRng.setStartBefore(startContainer);\n        } else {\n          newRng.setStartAfter(startContainer);\n        }\n      } else {\n        newRng.setStart(startContainer, startOffset);\n      }\n\n      if (has(shortEndedElements, endContainer.nodeName.toLowerCase())) {\n        if (endOffset === 0) {\n          newRng.setEndBefore(endContainer);\n        } else {\n          newRng.setEndAfter(endContainer);\n        }\n      } else {\n        newRng.setEnd(endContainer, endOffset);\n      }\n\n      return newRng;\n    };\n\n    var setupOffscreenSelection = function (node, targetClone, origTargetClone) {\n      var $ = editor.$;\n      var $realSelectionContainer = descendant(SugarElement.fromDom(editor.getBody()), '#' + realSelectionId).fold(function () {\n        return $([]);\n      }, function (elm) {\n        return $([elm.dom]);\n      });\n\n      if ($realSelectionContainer.length === 0) {\n        $realSelectionContainer = $('<div data-mce-bogus=\"all\" class=\"mce-offscreen-selection\"></div>').attr('id', realSelectionId);\n        $realSelectionContainer.appendTo(editor.getBody());\n      }\n\n      var newRange = dom.createRng();\n\n      if (targetClone === origTargetClone && Env.ie) {\n        $realSelectionContainer.empty().append('<p style=\"font-size: 0\" data-mce-bogus=\"all\">\\xA0</p>').append(targetClone);\n        newRange.setStartAfter($realSelectionContainer[0].firstChild.firstChild);\n        newRange.setEndAfter(targetClone);\n      } else {\n        $realSelectionContainer.empty().append(nbsp).append(targetClone).append(nbsp);\n        newRange.setStart($realSelectionContainer[0].firstChild, 1);\n        newRange.setEnd($realSelectionContainer[0].lastChild, 0);\n      }\n\n      $realSelectionContainer.css({\n        top: dom.getPos(node, editor.getBody()).y\n      });\n      $realSelectionContainer[0].focus();\n      var sel = selection.getSel();\n      sel.removeAllRanges();\n      sel.addRange(newRange);\n      return newRange;\n    };\n\n    var selectElement = function (elm) {\n      var targetClone = elm.cloneNode(true);\n      var e = editor.fire('ObjectSelected', {\n        target: elm,\n        targetClone: targetClone\n      });\n\n      if (e.isDefaultPrevented()) {\n        return null;\n      }\n\n      var range = setupOffscreenSelection(elm, e.targetClone, targetClone);\n      var nodeElm = SugarElement.fromDom(elm);\n      each(descendants$1(SugarElement.fromDom(editor.getBody()), '*[data-mce-selected]'), function (elm) {\n        if (!eq$2(nodeElm, elm)) {\n          remove$1(elm, elementSelectionAttr);\n        }\n      });\n\n      if (!dom.getAttrib(elm, elementSelectionAttr)) {\n        elm.setAttribute(elementSelectionAttr, '1');\n      }\n\n      selectedElement = elm;\n      hideFakeCaret();\n      return range;\n    };\n\n    var setElementSelection = function (range, forward) {\n      if (!range) {\n        return null;\n      }\n\n      if (range.collapsed) {\n        if (!isRangeInCaretContainer(range)) {\n          var dir = forward ? 1 : -1;\n          var caretPosition = getNormalizedRangeEndPoint(dir, rootNode, range);\n          var beforeNode = caretPosition.getNode(!forward);\n\n          if (isFakeCaretTarget(beforeNode)) {\n            return showCaret(dir, beforeNode, forward ? !caretPosition.isAtEnd() : false, false);\n          }\n\n          var afterNode = caretPosition.getNode(forward);\n\n          if (isFakeCaretTarget(afterNode)) {\n            return showCaret(dir, afterNode, forward ? false : !caretPosition.isAtEnd(), false);\n          }\n        }\n\n        return null;\n      }\n\n      var startContainer = range.startContainer;\n      var startOffset = range.startOffset;\n      var endOffset = range.endOffset;\n\n      if (startContainer.nodeType === 3 && startOffset === 0 && isContentEditableFalse$b(startContainer.parentNode)) {\n        startContainer = startContainer.parentNode;\n        startOffset = dom.nodeIndex(startContainer);\n        startContainer = startContainer.parentNode;\n      }\n\n      if (startContainer.nodeType !== 1) {\n        return null;\n      }\n\n      if (endOffset === startOffset + 1 && startContainer === range.endContainer) {\n        var node = startContainer.childNodes[startOffset];\n\n        if (isFakeSelectionTargetElement(node)) {\n          return selectElement(node);\n        }\n      }\n\n      return null;\n    };\n\n    var removeElementSelection = function () {\n      if (selectedElement) {\n        selectedElement.removeAttribute(elementSelectionAttr);\n      }\n\n      descendant(SugarElement.fromDom(editor.getBody()), '#' + realSelectionId).each(remove);\n      selectedElement = null;\n    };\n\n    var destroy = function () {\n      fakeCaret.destroy();\n      selectedElement = null;\n    };\n\n    var hideFakeCaret = function () {\n      fakeCaret.hide();\n    };\n\n    if (Env.ceFalse && !isRtc(editor)) {\n      registerEvents();\n    }\n\n    return {\n      showCaret: showCaret,\n      showBlockCaretContainer: showBlockCaretContainer,\n      hideFakeCaret: hideFakeCaret,\n      destroy: destroy\n    };\n  };\n\n  var Quirks = function (editor) {\n    var each = Tools.each;\n    var BACKSPACE = VK.BACKSPACE,\n        DELETE = VK.DELETE,\n        dom = editor.dom,\n        selection = editor.selection,\n        parser = editor.parser;\n    var isGecko = Env.gecko,\n        isIE = Env.ie,\n        isWebKit = Env.webkit;\n    var mceInternalUrlPrefix = 'data:text/mce-internal,';\n    var mceInternalDataType = isIE ? 'Text' : 'URL';\n\n    var setEditorCommandState = function (cmd, state) {\n      try {\n        editor.getDoc().execCommand(cmd, false, state);\n      } catch (ex) {}\n    };\n\n    var isDefaultPrevented = function (e) {\n      return e.isDefaultPrevented();\n    };\n\n    var setMceInternalContent = function (e) {\n      var selectionHtml, internalContent;\n\n      if (e.dataTransfer) {\n        if (editor.selection.isCollapsed() && e.target.tagName === 'IMG') {\n          selection.select(e.target);\n        }\n\n        selectionHtml = editor.selection.getContent();\n\n        if (selectionHtml.length > 0) {\n          internalContent = mceInternalUrlPrefix + escape(editor.id) + ',' + escape(selectionHtml);\n          e.dataTransfer.setData(mceInternalDataType, internalContent);\n        }\n      }\n    };\n\n    var getMceInternalContent = function (e) {\n      var internalContent;\n\n      if (e.dataTransfer) {\n        internalContent = e.dataTransfer.getData(mceInternalDataType);\n\n        if (internalContent && internalContent.indexOf(mceInternalUrlPrefix) >= 0) {\n          internalContent = internalContent.substr(mceInternalUrlPrefix.length).split(',');\n          return {\n            id: unescape(internalContent[0]),\n            html: unescape(internalContent[1])\n          };\n        }\n      }\n\n      return null;\n    };\n\n    var insertClipboardContents = function (content, internal) {\n      if (editor.queryCommandSupported('mceInsertClipboardContent')) {\n        editor.execCommand('mceInsertClipboardContent', false, {\n          content: content,\n          internal: internal\n        });\n      } else {\n        editor.execCommand('mceInsertContent', false, content);\n      }\n    };\n\n    var emptyEditorWhenDeleting = function () {\n      var serializeRng = function (rng) {\n        var body = dom.create('body');\n        var contents = rng.cloneContents();\n        body.appendChild(contents);\n        return selection.serializer.serialize(body, {\n          format: 'html'\n        });\n      };\n\n      var allContentsSelected = function (rng) {\n        var selection = serializeRng(rng);\n        var allRng = dom.createRng();\n        allRng.selectNode(editor.getBody());\n        var allSelection = serializeRng(allRng);\n        return selection === allSelection;\n      };\n\n      editor.on('keydown', function (e) {\n        var keyCode = e.keyCode;\n        var isCollapsed, body;\n\n        if (!isDefaultPrevented(e) && (keyCode === DELETE || keyCode === BACKSPACE)) {\n          isCollapsed = editor.selection.isCollapsed();\n          body = editor.getBody();\n\n          if (isCollapsed && !dom.isEmpty(body)) {\n            return;\n          }\n\n          if (!isCollapsed && !allContentsSelected(editor.selection.getRng())) {\n            return;\n          }\n\n          e.preventDefault();\n          editor.setContent('');\n\n          if (body.firstChild && dom.isBlock(body.firstChild)) {\n            editor.selection.setCursorLocation(body.firstChild, 0);\n          } else {\n            editor.selection.setCursorLocation(body, 0);\n          }\n\n          editor.nodeChanged();\n        }\n      });\n    };\n\n    var selectAll = function () {\n      editor.shortcuts.add('meta+a', null, 'SelectAll');\n    };\n\n    var inputMethodFocus = function () {\n      if (!editor.inline) {\n        dom.bind(editor.getDoc(), 'mousedown mouseup', function (e) {\n          var rng;\n\n          if (e.target === editor.getDoc().documentElement) {\n            rng = selection.getRng();\n            editor.getBody().focus();\n\n            if (e.type === 'mousedown') {\n              if (isCaretContainer(rng.startContainer)) {\n                return;\n              }\n\n              selection.placeCaretAt(e.clientX, e.clientY);\n            } else {\n              selection.setRng(rng);\n            }\n          }\n        });\n      }\n    };\n\n    var removeHrOnBackspace = function () {\n      editor.on('keydown', function (e) {\n        if (!isDefaultPrevented(e) && e.keyCode === BACKSPACE) {\n          if (!editor.getBody().getElementsByTagName('hr').length) {\n            return;\n          }\n\n          if (selection.isCollapsed() && selection.getRng().startOffset === 0) {\n            var node = selection.getNode();\n            var previousSibling = node.previousSibling;\n\n            if (node.nodeName === 'HR') {\n              dom.remove(node);\n              e.preventDefault();\n              return;\n            }\n\n            if (previousSibling && previousSibling.nodeName && previousSibling.nodeName.toLowerCase() === 'hr') {\n              dom.remove(previousSibling);\n              e.preventDefault();\n            }\n          }\n        }\n      });\n    };\n\n    var focusBody = function () {\n      if (!Range.prototype.getClientRects) {\n        editor.on('mousedown', function (e) {\n          if (!isDefaultPrevented(e) && e.target.nodeName === 'HTML') {\n            var body_1 = editor.getBody();\n            body_1.blur();\n            Delay.setEditorTimeout(editor, function () {\n              body_1.focus();\n            });\n          }\n        });\n      }\n    };\n\n    var selectControlElements = function () {\n      editor.on('click', function (e) {\n        var target = e.target;\n\n        if (/^(IMG|HR)$/.test(target.nodeName) && dom.getContentEditableParent(target) !== 'false') {\n          e.preventDefault();\n          editor.selection.select(target);\n          editor.nodeChanged();\n        }\n\n        if (target.nodeName === 'A' && dom.hasClass(target, 'mce-item-anchor')) {\n          e.preventDefault();\n          selection.select(target);\n        }\n      });\n    };\n\n    var removeStylesWhenDeletingAcrossBlockElements = function () {\n      var getAttributeApplyFunction = function () {\n        var template = dom.getAttribs(selection.getStart().cloneNode(false));\n        return function () {\n          var target = selection.getStart();\n\n          if (target !== editor.getBody()) {\n            dom.setAttrib(target, 'style', null);\n            each(template, function (attr) {\n              target.setAttributeNode(attr.cloneNode(true));\n            });\n          }\n        };\n      };\n\n      var isSelectionAcrossElements = function () {\n        return !selection.isCollapsed() && dom.getParent(selection.getStart(), dom.isBlock) !== dom.getParent(selection.getEnd(), dom.isBlock);\n      };\n\n      editor.on('keypress', function (e) {\n        var applyAttributes;\n\n        if (!isDefaultPrevented(e) && (e.keyCode === 8 || e.keyCode === 46) && isSelectionAcrossElements()) {\n          applyAttributes = getAttributeApplyFunction();\n          editor.getDoc().execCommand('delete', false, null);\n          applyAttributes();\n          e.preventDefault();\n          return false;\n        }\n      });\n      dom.bind(editor.getDoc(), 'cut', function (e) {\n        var applyAttributes;\n\n        if (!isDefaultPrevented(e) && isSelectionAcrossElements()) {\n          applyAttributes = getAttributeApplyFunction();\n          Delay.setEditorTimeout(editor, function () {\n            applyAttributes();\n          });\n        }\n      });\n    };\n\n    var disableBackspaceIntoATable = function () {\n      editor.on('keydown', function (e) {\n        if (!isDefaultPrevented(e) && e.keyCode === BACKSPACE) {\n          if (selection.isCollapsed() && selection.getRng().startOffset === 0) {\n            var previousSibling = selection.getNode().previousSibling;\n\n            if (previousSibling && previousSibling.nodeName && previousSibling.nodeName.toLowerCase() === 'table') {\n              e.preventDefault();\n              return false;\n            }\n          }\n        }\n      });\n    };\n\n    var removeBlockQuoteOnBackSpace = function () {\n      editor.on('keydown', function (e) {\n        var rng, parent;\n\n        if (isDefaultPrevented(e) || e.keyCode !== VK.BACKSPACE) {\n          return;\n        }\n\n        rng = selection.getRng();\n        var container = rng.startContainer;\n        var offset = rng.startOffset;\n        var root = dom.getRoot();\n        parent = container;\n\n        if (!rng.collapsed || offset !== 0) {\n          return;\n        }\n\n        while (parent && parent.parentNode && parent.parentNode.firstChild === parent && parent.parentNode !== root) {\n          parent = parent.parentNode;\n        }\n\n        if (parent.tagName === 'BLOCKQUOTE') {\n          editor.formatter.toggle('blockquote', null, parent);\n          rng = dom.createRng();\n          rng.setStart(container, 0);\n          rng.setEnd(container, 0);\n          selection.setRng(rng);\n        }\n      });\n    };\n\n    var setGeckoEditingOptions = function () {\n      var setOpts = function () {\n        setEditorCommandState('StyleWithCSS', false);\n        setEditorCommandState('enableInlineTableEditing', false);\n\n        if (!getObjectResizing(editor)) {\n          setEditorCommandState('enableObjectResizing', false);\n        }\n      };\n\n      if (!isReadOnly(editor)) {\n        editor.on('BeforeExecCommand mousedown', setOpts);\n      }\n    };\n\n    var addBrAfterLastLinks = function () {\n      var fixLinks = function () {\n        each(dom.select('a'), function (node) {\n          var parentNode = node.parentNode;\n          var root = dom.getRoot();\n\n          if (parentNode.lastChild === node) {\n            while (parentNode && !dom.isBlock(parentNode)) {\n              if (parentNode.parentNode.lastChild !== parentNode || parentNode === root) {\n                return;\n              }\n\n              parentNode = parentNode.parentNode;\n            }\n\n            dom.add(parentNode, 'br', {\n              'data-mce-bogus': 1\n            });\n          }\n        });\n      };\n\n      editor.on('SetContent ExecCommand', function (e) {\n        if (e.type === 'setcontent' || e.command === 'mceInsertLink') {\n          fixLinks();\n        }\n      });\n    };\n\n    var setDefaultBlockType = function () {\n      if (getForcedRootBlock(editor)) {\n        editor.on('init', function () {\n          setEditorCommandState('DefaultParagraphSeparator', getForcedRootBlock(editor));\n        });\n      }\n    };\n\n    var normalizeSelection = function () {\n      editor.on('keyup focusin mouseup', function (e) {\n        if (!VK.modifierPressed(e)) {\n          selection.normalize();\n        }\n      }, true);\n    };\n\n    var showBrokenImageIcon = function () {\n      editor.contentStyles.push('img:-moz-broken {' + '-moz-force-broken-image-icon:1;' + 'min-width:24px;' + 'min-height:24px' + '}');\n    };\n\n    var restoreFocusOnKeyDown = function () {\n      if (!editor.inline) {\n        editor.on('keydown', function () {\n          if (document.activeElement === document.body) {\n            editor.getWin().focus();\n          }\n        });\n      }\n    };\n\n    var bodyHeight = function () {\n      if (!editor.inline) {\n        editor.contentStyles.push('body {min-height: 150px}');\n        editor.on('click', function (e) {\n          var rng;\n\n          if (e.target.nodeName === 'HTML') {\n            if (Env.ie > 11) {\n              editor.getBody().focus();\n              return;\n            }\n\n            rng = editor.selection.getRng();\n            editor.getBody().focus();\n            editor.selection.setRng(rng);\n            editor.selection.normalize();\n            editor.nodeChanged();\n          }\n        });\n      }\n    };\n\n    var blockCmdArrowNavigation = function () {\n      if (Env.mac) {\n        editor.on('keydown', function (e) {\n          if (VK.metaKeyPressed(e) && !e.shiftKey && (e.keyCode === 37 || e.keyCode === 39)) {\n            e.preventDefault();\n            var selection_1 = editor.selection.getSel();\n            selection_1.modify('move', e.keyCode === 37 ? 'backward' : 'forward', 'lineboundary');\n          }\n        });\n      }\n    };\n\n    var disableAutoUrlDetect = function () {\n      setEditorCommandState('AutoUrlDetect', false);\n    };\n\n    var tapLinksAndImages = function () {\n      editor.on('click', function (e) {\n        var elm = e.target;\n\n        do {\n          if (elm.tagName === 'A') {\n            e.preventDefault();\n            return;\n          }\n        } while (elm = elm.parentNode);\n      });\n      editor.contentStyles.push('.mce-content-body {-webkit-touch-callout: none}');\n    };\n\n    var blockFormSubmitInsideEditor = function () {\n      editor.on('init', function () {\n        editor.dom.bind(editor.getBody(), 'submit', function (e) {\n          e.preventDefault();\n        });\n      });\n    };\n\n    var removeAppleInterchangeBrs = function () {\n      parser.addNodeFilter('br', function (nodes) {\n        var i = nodes.length;\n\n        while (i--) {\n          if (nodes[i].attr('class') === 'Apple-interchange-newline') {\n            nodes[i].remove();\n          }\n        }\n      });\n    };\n\n    var ieInternalDragAndDrop = function () {\n      editor.on('dragstart', function (e) {\n        setMceInternalContent(e);\n      });\n      editor.on('drop', function (e) {\n        if (!isDefaultPrevented(e)) {\n          var internalContent = getMceInternalContent(e);\n\n          if (internalContent && internalContent.id !== editor.id) {\n            e.preventDefault();\n            var rng = fromPoint$1(e.x, e.y, editor.getDoc());\n            selection.setRng(rng);\n            insertClipboardContents(internalContent.html, true);\n          }\n        }\n      });\n    };\n\n    var refreshContentEditable = noop;\n\n    var isHidden = function () {\n      if (!isGecko || editor.removed) {\n        return false;\n      }\n\n      var sel = editor.selection.getSel();\n      return !sel || !sel.rangeCount || sel.rangeCount === 0;\n    };\n\n    var setupRtc = function () {\n      if (isWebKit) {\n        selectControlElements();\n        blockFormSubmitInsideEditor();\n        selectAll();\n\n        if (Env.iOS) {\n          restoreFocusOnKeyDown();\n          bodyHeight();\n          tapLinksAndImages();\n        }\n      }\n\n      if (isGecko) {\n        focusBody();\n        setGeckoEditingOptions();\n        showBrokenImageIcon();\n        blockCmdArrowNavigation();\n      }\n    };\n\n    var setup = function () {\n      removeBlockQuoteOnBackSpace();\n      emptyEditorWhenDeleting();\n\n      if (!Env.windowsPhone) {\n        normalizeSelection();\n      }\n\n      if (isWebKit) {\n        inputMethodFocus();\n        selectControlElements();\n        setDefaultBlockType();\n        blockFormSubmitInsideEditor();\n        disableBackspaceIntoATable();\n        removeAppleInterchangeBrs();\n\n        if (Env.iOS) {\n          restoreFocusOnKeyDown();\n          bodyHeight();\n          tapLinksAndImages();\n        } else {\n          selectAll();\n        }\n      }\n\n      if (Env.ie >= 11) {\n        bodyHeight();\n        disableBackspaceIntoATable();\n      }\n\n      if (Env.ie) {\n        selectAll();\n        disableAutoUrlDetect();\n        ieInternalDragAndDrop();\n      }\n\n      if (isGecko) {\n        removeHrOnBackspace();\n        focusBody();\n        removeStylesWhenDeletingAcrossBlockElements();\n        setGeckoEditingOptions();\n        addBrAfterLastLinks();\n        showBrokenImageIcon();\n        blockCmdArrowNavigation();\n        disableBackspaceIntoATable();\n      }\n    };\n\n    if (isRtc(editor)) {\n      setupRtc();\n    } else {\n      setup();\n    }\n\n    return {\n      refreshContentEditable: refreshContentEditable,\n      isHidden: isHidden\n    };\n  };\n\n  var DOM$4 = DOMUtils.DOM;\n\n  var appendStyle = function (editor, text) {\n    var body = SugarElement.fromDom(editor.getBody());\n    var container = getStyleContainer(getRootNode(body));\n    var style = SugarElement.fromTag('style');\n    set(style, 'type', 'text/css');\n    append(style, SugarElement.fromText(text));\n    append(container, style);\n    editor.on('remove', function () {\n      remove(style);\n    });\n  };\n\n  var getRootName = function (editor) {\n    return editor.inline ? editor.getElement().nodeName.toLowerCase() : undefined;\n  };\n\n  var removeUndefined = function (obj) {\n    return filter$1(obj, function (v) {\n      return isUndefined(v) === false;\n    });\n  };\n\n  var mkParserSettings = function (editor) {\n    var settings = editor.settings;\n    var blobCache = editor.editorUpload.blobCache;\n    return removeUndefined({\n      allow_conditional_comments: settings.allow_conditional_comments,\n      allow_html_data_urls: settings.allow_html_data_urls,\n      allow_svg_data_urls: settings.allow_svg_data_urls,\n      allow_html_in_named_anchor: settings.allow_html_in_named_anchor,\n      allow_script_urls: settings.allow_script_urls,\n      allow_unsafe_link_target: settings.allow_unsafe_link_target,\n      convert_fonts_to_spans: settings.convert_fonts_to_spans,\n      fix_list_elements: settings.fix_list_elements,\n      font_size_legacy_values: settings.font_size_legacy_values,\n      forced_root_block: settings.forced_root_block,\n      forced_root_block_attrs: settings.forced_root_block_attrs,\n      padd_empty_with_br: settings.padd_empty_with_br,\n      preserve_cdata: settings.preserve_cdata,\n      remove_trailing_brs: settings.remove_trailing_brs,\n      inline_styles: settings.inline_styles,\n      root_name: getRootName(editor),\n      validate: true,\n      blob_cache: blobCache,\n      images_dataimg_filter: settings.images_dataimg_filter\n    });\n  };\n\n  var mkSerializerSettings = function (editor) {\n    var settings = editor.settings;\n    return __assign(__assign({}, mkParserSettings(editor)), removeUndefined({\n      url_converter: settings.url_converter,\n      url_converter_scope: settings.url_converter_scope,\n      element_format: settings.element_format,\n      entities: settings.entities,\n      entity_encoding: settings.entity_encoding,\n      indent: settings.indent,\n      indent_after: settings.indent_after,\n      indent_before: settings.indent_before,\n      block_elements: settings.block_elements,\n      boolean_attributes: settings.boolean_attributes,\n      custom_elements: settings.custom_elements,\n      extended_valid_elements: settings.extended_valid_elements,\n      invalid_elements: settings.invalid_elements,\n      invalid_styles: settings.invalid_styles,\n      move_caret_before_on_enter_elements: settings.move_caret_before_on_enter_elements,\n      non_empty_elements: settings.non_empty_elements,\n      schema: settings.schema,\n      self_closing_elements: settings.self_closing_elements,\n      short_ended_elements: settings.short_ended_elements,\n      special: settings.special,\n      text_block_elements: settings.text_block_elements,\n      text_inline_elements: settings.text_inline_elements,\n      valid_children: settings.valid_children,\n      valid_classes: settings.valid_classes,\n      valid_elements: settings.valid_elements,\n      valid_styles: settings.valid_styles,\n      verify_html: settings.verify_html,\n      whitespace_elements: settings.whitespace_elements\n    }));\n  };\n\n  var createParser = function (editor) {\n    var parser = DomParser(mkParserSettings(editor), editor.schema);\n    parser.addAttributeFilter('src,href,style,tabindex', function (nodes, name) {\n      var i = nodes.length,\n          node,\n          value;\n      var dom = editor.dom;\n      var internalName = 'data-mce-' + name;\n\n      while (i--) {\n        node = nodes[i];\n        value = node.attr(name);\n\n        if (value && !node.attr(internalName)) {\n          if (value.indexOf('data:') === 0 || value.indexOf('blob:') === 0) {\n            continue;\n          }\n\n          if (name === 'style') {\n            value = dom.serializeStyle(dom.parseStyle(value), node.name);\n\n            if (!value.length) {\n              value = null;\n            }\n\n            node.attr(internalName, value);\n            node.attr(name, value);\n          } else if (name === 'tabindex') {\n            node.attr(internalName, value);\n            node.attr(name, null);\n          } else {\n            node.attr(internalName, editor.convertURL(value, name, node.name));\n          }\n        }\n      }\n    });\n    parser.addNodeFilter('script', function (nodes) {\n      var i = nodes.length;\n\n      while (i--) {\n        var node = nodes[i];\n        var type = node.attr('type') || 'no/type';\n\n        if (type.indexOf('mce-') !== 0) {\n          node.attr('type', 'mce-' + type);\n        }\n      }\n    });\n\n    if (editor.settings.preserve_cdata) {\n      parser.addNodeFilter('#cdata', function (nodes) {\n        var i = nodes.length;\n\n        while (i--) {\n          var node = nodes[i];\n          node.type = 8;\n          node.name = '#comment';\n          node.value = '[CDATA[' + editor.dom.encode(node.value) + ']]';\n        }\n      });\n    }\n\n    parser.addNodeFilter('p,h1,h2,h3,h4,h5,h6,div', function (nodes) {\n      var i = nodes.length;\n      var nonEmptyElements = editor.schema.getNonEmptyElements();\n\n      while (i--) {\n        var node = nodes[i];\n\n        if (node.isEmpty(nonEmptyElements) && node.getAll('br').length === 0) {\n          node.append(new AstNode('br', 1)).shortEnded = true;\n        }\n      }\n    });\n    return parser;\n  };\n\n  var autoFocus = function (editor) {\n    if (editor.settings.auto_focus) {\n      Delay.setEditorTimeout(editor, function () {\n        var focusEditor;\n\n        if (editor.settings.auto_focus === true) {\n          focusEditor = editor;\n        } else {\n          focusEditor = editor.editorManager.get(editor.settings.auto_focus);\n        }\n\n        if (!focusEditor.destroyed) {\n          focusEditor.focus();\n        }\n      }, 100);\n    }\n  };\n\n  var moveSelectionToFirstCaretPosition = function (editor) {\n    var root = editor.dom.getRoot();\n\n    if (!editor.inline && (!hasAnyRanges(editor) || editor.selection.getStart(true) === root)) {\n      firstPositionIn(root).each(function (pos) {\n        var node = pos.getNode();\n        var caretPos = isTable(node) ? firstPositionIn(node).getOr(pos) : pos;\n\n        if (Env.browser.isIE()) {\n          storeNative(editor, caretPos.toRange());\n        } else {\n          editor.selection.setRng(caretPos.toRange());\n        }\n      });\n    }\n  };\n\n  var initEditor = function (editor) {\n    editor.bindPendingEventDelegates();\n    editor.initialized = true;\n    fireInit(editor);\n    editor.focus(true);\n    moveSelectionToFirstCaretPosition(editor);\n    editor.nodeChanged({\n      initial: true\n    });\n    editor.execCallback('init_instance_callback', editor);\n    autoFocus(editor);\n  };\n\n  var getStyleSheetLoader = function (editor) {\n    return editor.inline ? editor.ui.styleSheetLoader : editor.dom.styleSheetLoader;\n  };\n\n  var makeStylesheetLoadingPromises = function (editor, css, framedFonts) {\n    var promises = [new promiseObj(function (resolve, reject) {\n      return getStyleSheetLoader(editor).loadAll(css, resolve, reject);\n    })];\n\n    if (editor.inline) {\n      return promises;\n    } else {\n      return promises.concat([new promiseObj(function (resolve, reject) {\n        return editor.ui.styleSheetLoader.loadAll(framedFonts, resolve, reject);\n      })]);\n    }\n  };\n\n  var loadContentCss = function (editor, css) {\n    var styleSheetLoader = getStyleSheetLoader(editor);\n    var fontCss = getFontCss(editor);\n\n    var removeCss = function () {\n      styleSheetLoader.unloadAll(css);\n\n      if (!editor.inline) {\n        editor.ui.styleSheetLoader.unloadAll(fontCss);\n      }\n    };\n\n    var loaded = function () {\n      if (editor.removed) {\n        removeCss();\n      } else {\n        editor.on('remove', removeCss);\n        initEditor(editor);\n      }\n    };\n\n    promiseObj.all(makeStylesheetLoadingPromises(editor, css, fontCss)).then(loaded).catch(loaded);\n  };\n\n  var preInit = function (editor) {\n    var settings = editor.settings,\n        doc = editor.getDoc(),\n        body = editor.getBody();\n\n    if (!settings.browser_spellcheck && !settings.gecko_spellcheck) {\n      doc.body.spellcheck = false;\n      DOM$4.setAttrib(body, 'spellcheck', 'false');\n    }\n\n    editor.quirks = Quirks(editor);\n    firePostRender(editor);\n    var directionality = getDirectionality(editor);\n\n    if (directionality !== undefined) {\n      body.dir = directionality;\n    }\n\n    if (settings.protect) {\n      editor.on('BeforeSetContent', function (e) {\n        Tools.each(settings.protect, function (pattern) {\n          e.content = e.content.replace(pattern, function (str) {\n            return '<!--mce:protected ' + escape(str) + '-->';\n          });\n        });\n      });\n    }\n\n    editor.on('SetContent', function () {\n      editor.addVisual(editor.getBody());\n    });\n\n    if (!isRtc(editor)) {\n      editor.load({\n        initial: true,\n        format: 'html'\n      });\n    }\n\n    editor.startContent = editor.getContent({\n      format: 'raw'\n    });\n    editor.on('compositionstart compositionend', function (e) {\n      editor.composing = e.type === 'compositionstart';\n    });\n\n    if (editor.contentStyles.length > 0) {\n      var contentCssText_1 = '';\n      Tools.each(editor.contentStyles, function (style) {\n        contentCssText_1 += style + '\\r\\n';\n      });\n      editor.dom.addStyle(contentCssText_1);\n    }\n\n    loadContentCss(editor, editor.contentCSS);\n\n    if (settings.content_style) {\n      appendStyle(editor, settings.content_style);\n    }\n  };\n\n  var initContentBody = function (editor, skipWrite) {\n    var settings = editor.settings;\n    var targetElm = editor.getElement();\n    var doc = editor.getDoc();\n\n    if (!settings.inline) {\n      editor.getElement().style.visibility = editor.orgVisibility;\n    }\n\n    if (!skipWrite && !editor.inline) {\n      doc.open();\n      doc.write(editor.iframeHTML);\n      doc.close();\n    }\n\n    if (editor.inline) {\n      DOM$4.addClass(targetElm, 'mce-content-body');\n      editor.contentDocument = doc = document;\n      editor.contentWindow = window;\n      editor.bodyElement = targetElm;\n      editor.contentAreaContainer = targetElm;\n    }\n\n    var body = editor.getBody();\n    body.disabled = true;\n    editor.readonly = !!settings.readonly;\n\n    if (!editor.readonly) {\n      if (editor.inline && DOM$4.getStyle(body, 'position', true) === 'static') {\n        body.style.position = 'relative';\n      }\n\n      body.contentEditable = editor.getParam('content_editable_state', true);\n    }\n\n    body.disabled = false;\n    editor.editorUpload = EditorUpload(editor);\n    editor.schema = Schema(settings);\n    editor.dom = DOMUtils(doc, {\n      keep_values: true,\n      url_converter: editor.convertURL,\n      url_converter_scope: editor,\n      hex_colors: settings.force_hex_style_colors,\n      update_styles: true,\n      root_element: editor.inline ? editor.getBody() : null,\n      collect: function () {\n        return editor.inline;\n      },\n      schema: editor.schema,\n      contentCssCors: shouldUseContentCssCors(editor),\n      referrerPolicy: getReferrerPolicy(editor),\n      onSetAttrib: function (e) {\n        editor.fire('SetAttrib', e);\n      }\n    });\n    editor.parser = createParser(editor);\n    editor.serializer = DomSerializer(mkSerializerSettings(editor), editor);\n    editor.selection = EditorSelection(editor.dom, editor.getWin(), editor.serializer, editor);\n    editor.annotator = Annotator(editor);\n    editor.formatter = Formatter(editor);\n    editor.undoManager = UndoManager(editor);\n    editor._nodeChangeDispatcher = new NodeChange(editor);\n    editor._selectionOverrides = SelectionOverrides(editor);\n    setup$9(editor);\n    setup$k(editor);\n\n    if (!isRtc(editor)) {\n      setup$l(editor);\n    }\n\n    var caret = setup$j(editor);\n    setup$8(editor, caret);\n    setup$a(editor);\n    setup$7(editor);\n    firePreInit(editor);\n    setup$5(editor).fold(function () {\n      preInit(editor);\n    }, function (loadingRtc) {\n      editor.setProgressState(true);\n      loadingRtc.then(function (_rtcMode) {\n        editor.setProgressState(false);\n        preInit(editor);\n      }, function (err) {\n        editor.notificationManager.open({\n          type: 'error',\n          text: String(err)\n        });\n        preInit(editor);\n      });\n    });\n  };\n\n  var DOM$5 = DOMUtils.DOM;\n\n  var relaxDomain = function (editor, ifr) {\n    if (document.domain !== window.location.hostname && Env.browser.isIE()) {\n      var bodyUuid = uuid('mce');\n\n      editor[bodyUuid] = function () {\n        initContentBody(editor);\n      };\n\n      var domainRelaxUrl = 'javascript:(function(){' + 'document.open();document.domain=\"' + document.domain + '\";' + 'var ed = window.parent.tinymce.get(\"' + editor.id + '\");document.write(ed.iframeHTML);' + 'document.close();ed.' + bodyUuid + '(true);})()';\n      DOM$5.setAttrib(ifr, 'src', domainRelaxUrl);\n      return true;\n    }\n\n    return false;\n  };\n\n  var createIframeElement = function (id, title, height, customAttrs) {\n    var iframe = SugarElement.fromTag('iframe');\n    setAll(iframe, customAttrs);\n    setAll(iframe, {\n      id: id + '_ifr',\n      frameBorder: '0',\n      allowTransparency: 'true',\n      title: title\n    });\n    add$3(iframe, 'tox-edit-area__iframe');\n    return iframe;\n  };\n\n  var getIframeHtml = function (editor) {\n    var iframeHTML = getDocType(editor) + '<html><head>';\n\n    if (getDocumentBaseUrl(editor) !== editor.documentBaseUrl) {\n      iframeHTML += '<base href=\"' + editor.documentBaseURI.getURI() + '\" />';\n    }\n\n    iframeHTML += '<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />';\n    var bodyId = getBodyId(editor);\n    var bodyClass = getBodyClass(editor);\n\n    if (getContentSecurityPolicy(editor)) {\n      iframeHTML += '<meta http-equiv=\"Content-Security-Policy\" content=\"' + getContentSecurityPolicy(editor) + '\" />';\n    }\n\n    iframeHTML += '</head><body id=\"' + bodyId + '\" class=\"mce-content-body ' + bodyClass + '\" data-id=\"' + editor.id + '\"><br></body></html>';\n    return iframeHTML;\n  };\n\n  var createIframe = function (editor, o) {\n    var title = editor.editorManager.translate('Rich Text Area. Press ALT-0 for help.');\n    var ifr = createIframeElement(editor.id, title, o.height, getIframeAttrs(editor)).dom;\n\n    ifr.onload = function () {\n      ifr.onload = null;\n      editor.fire('load');\n    };\n\n    var isDomainRelaxed = relaxDomain(editor, ifr);\n    editor.contentAreaContainer = o.iframeContainer;\n    editor.iframeElement = ifr;\n    editor.iframeHTML = getIframeHtml(editor);\n    DOM$5.add(o.iframeContainer, ifr);\n    return isDomainRelaxed;\n  };\n\n  var init$1 = function (editor, boxInfo) {\n    var isDomainRelaxed = createIframe(editor, boxInfo);\n\n    if (boxInfo.editorContainer) {\n      DOM$5.get(boxInfo.editorContainer).style.display = editor.orgDisplay;\n      editor.hidden = DOM$5.isHidden(boxInfo.editorContainer);\n    }\n\n    editor.getElement().style.display = 'none';\n    DOM$5.setAttrib(editor.id, 'aria-hidden', 'true');\n\n    if (!isDomainRelaxed) {\n      initContentBody(editor);\n    }\n  };\n\n  var DOM$6 = DOMUtils.DOM;\n\n  var initPlugin = function (editor, initializedPlugins, plugin) {\n    var Plugin = PluginManager.get(plugin);\n    var pluginUrl = PluginManager.urls[plugin] || editor.documentBaseUrl.replace(/\\/$/, '');\n    plugin = Tools.trim(plugin);\n\n    if (Plugin && Tools.inArray(initializedPlugins, plugin) === -1) {\n      Tools.each(PluginManager.dependencies(plugin), function (dep) {\n        initPlugin(editor, initializedPlugins, dep);\n      });\n\n      if (editor.plugins[plugin]) {\n        return;\n      }\n\n      try {\n        var pluginInstance = new Plugin(editor, pluginUrl, editor.$);\n        editor.plugins[plugin] = pluginInstance;\n\n        if (pluginInstance.init) {\n          pluginInstance.init(editor, pluginUrl);\n          initializedPlugins.push(plugin);\n        }\n      } catch (e) {\n        pluginInitError(editor, plugin, e);\n      }\n    }\n  };\n\n  var trimLegacyPrefix = function (name) {\n    return name.replace(/^\\-/, '');\n  };\n\n  var initPlugins = function (editor) {\n    var initializedPlugins = [];\n    Tools.each(getPlugins(editor).split(/[ ,]/), function (name) {\n      initPlugin(editor, initializedPlugins, trimLegacyPrefix(name));\n    });\n  };\n\n  var initIcons = function (editor) {\n    var iconPackName = Tools.trim(getIconPackName(editor));\n    var currentIcons = editor.ui.registry.getAll().icons;\n\n    var loadIcons = __assign(__assign({}, IconManager.get('default').icons), IconManager.get(iconPackName).icons);\n\n    each$1(loadIcons, function (svgData, icon) {\n      if (!has(currentIcons, icon)) {\n        editor.ui.registry.addIcon(icon, svgData);\n      }\n    });\n  };\n\n  var initTheme = function (editor) {\n    var theme = getTheme(editor);\n\n    if (isString(theme)) {\n      editor.settings.theme = trimLegacyPrefix(theme);\n      var Theme = ThemeManager.get(theme);\n      editor.theme = new Theme(editor, ThemeManager.urls[theme]);\n\n      if (editor.theme.init) {\n        editor.theme.init(editor, ThemeManager.urls[theme] || editor.documentBaseUrl.replace(/\\/$/, ''), editor.$);\n      }\n    } else {\n      editor.theme = {};\n    }\n  };\n\n  var renderFromLoadedTheme = function (editor) {\n    return editor.theme.renderUI();\n  };\n\n  var renderFromThemeFunc = function (editor) {\n    var elm = editor.getElement();\n    var theme = getTheme(editor);\n    var info = theme(editor, elm);\n\n    if (info.editorContainer.nodeType) {\n      info.editorContainer.id = info.editorContainer.id || editor.id + '_parent';\n    }\n\n    if (info.iframeContainer && info.iframeContainer.nodeType) {\n      info.iframeContainer.id = info.iframeContainer.id || editor.id + '_iframecontainer';\n    }\n\n    info.height = info.iframeHeight ? info.iframeHeight : elm.offsetHeight;\n    return info;\n  };\n\n  var createThemeFalseResult = function (element) {\n    return {\n      editorContainer: element,\n      iframeContainer: element,\n      api: {}\n    };\n  };\n\n  var renderThemeFalseIframe = function (targetElement) {\n    var iframeContainer = DOM$6.create('div');\n    DOM$6.insertAfter(iframeContainer, targetElement);\n    return createThemeFalseResult(iframeContainer);\n  };\n\n  var renderThemeFalse = function (editor) {\n    var targetElement = editor.getElement();\n    return editor.inline ? createThemeFalseResult(null) : renderThemeFalseIframe(targetElement);\n  };\n\n  var renderThemeUi = function (editor) {\n    var elm = editor.getElement();\n    editor.orgDisplay = elm.style.display;\n\n    if (isString(getTheme(editor))) {\n      return renderFromLoadedTheme(editor);\n    } else if (isFunction(getTheme(editor))) {\n      return renderFromThemeFunc(editor);\n    } else {\n      return renderThemeFalse(editor);\n    }\n  };\n\n  var augmentEditorUiApi = function (editor, api) {\n    var uiApiFacade = {\n      show: Optional.from(api.show).getOr(noop),\n      hide: Optional.from(api.hide).getOr(noop),\n      disable: Optional.from(api.disable).getOr(noop),\n      isDisabled: Optional.from(api.isDisabled).getOr(never),\n      enable: function () {\n        if (!editor.mode.isReadOnly()) {\n          Optional.from(api.enable).map(call);\n        }\n      }\n    };\n    editor.ui = __assign(__assign({}, editor.ui), uiApiFacade);\n  };\n\n  var init$2 = function (editor) {\n    editor.fire('ScriptsLoaded');\n    initIcons(editor);\n    initTheme(editor);\n    initPlugins(editor);\n    var renderInfo = renderThemeUi(editor);\n    augmentEditorUiApi(editor, Optional.from(renderInfo.api).getOr({}));\n    var boxInfo = {\n      editorContainer: renderInfo.editorContainer,\n      iframeContainer: renderInfo.iframeContainer\n    };\n    editor.editorContainer = boxInfo.editorContainer ? boxInfo.editorContainer : null;\n    appendContentCssFromSettings(editor);\n\n    if (editor.inline) {\n      return initContentBody(editor);\n    } else {\n      return init$1(editor, boxInfo);\n    }\n  };\n\n  var DOM$7 = DOMUtils.DOM;\n\n  var hasSkipLoadPrefix = function (name) {\n    return name.charAt(0) === '-';\n  };\n\n  var loadLanguage = function (scriptLoader, editor) {\n    var languageCode = getLanguageCode(editor);\n    var languageUrl = getLanguageUrl(editor);\n\n    if (I18n.hasCode(languageCode) === false && languageCode !== 'en') {\n      var url_1 = languageUrl !== '' ? languageUrl : editor.editorManager.baseURL + '/langs/' + languageCode + '.js';\n      scriptLoader.add(url_1, noop, undefined, function () {\n        languageLoadError(editor, url_1, languageCode);\n      });\n    }\n  };\n\n  var loadTheme = function (scriptLoader, editor, suffix, callback) {\n    var theme = getTheme(editor);\n\n    if (isString(theme)) {\n      if (!hasSkipLoadPrefix(theme) && !ThemeManager.urls.hasOwnProperty(theme)) {\n        var themeUrl = getThemeUrl(editor);\n\n        if (themeUrl) {\n          ThemeManager.load(theme, editor.documentBaseURI.toAbsolute(themeUrl));\n        } else {\n          ThemeManager.load(theme, 'themes/' + theme + '/theme' + suffix + '.js');\n        }\n      }\n\n      scriptLoader.loadQueue(function () {\n        ThemeManager.waitFor(theme, callback);\n      });\n    } else {\n      callback();\n    }\n  };\n\n  var getIconsUrlMetaFromUrl = function (editor) {\n    return Optional.from(getIconsUrl(editor)).filter(function (url) {\n      return url.length > 0;\n    }).map(function (url) {\n      return {\n        url: url,\n        name: Optional.none()\n      };\n    });\n  };\n\n  var getIconsUrlMetaFromName = function (editor, name, suffix) {\n    return Optional.from(name).filter(function (name) {\n      return name.length > 0 && !IconManager.has(name);\n    }).map(function (name) {\n      return {\n        url: editor.editorManager.baseURL + '/icons/' + name + '/icons' + suffix + '.js',\n        name: Optional.some(name)\n      };\n    });\n  };\n\n  var loadIcons = function (scriptLoader, editor, suffix) {\n    var defaultIconsUrl = getIconsUrlMetaFromName(editor, 'default', suffix);\n    var customIconsUrl = getIconsUrlMetaFromUrl(editor).orThunk(function () {\n      return getIconsUrlMetaFromName(editor, getIconPackName(editor), '');\n    });\n    each(cat([defaultIconsUrl, customIconsUrl]), function (urlMeta) {\n      scriptLoader.add(urlMeta.url, noop, undefined, function () {\n        iconsLoadError(editor, urlMeta.url, urlMeta.name.getOrUndefined());\n      });\n    });\n  };\n\n  var loadPlugins = function (editor, suffix) {\n    Tools.each(getExternalPlugins(editor), function (url, name) {\n      PluginManager.load(name, url, noop, undefined, function () {\n        pluginLoadError(editor, url, name);\n      });\n      editor.settings.plugins += ' ' + name;\n    });\n    Tools.each(getPlugins(editor).split(/[ ,]/), function (plugin) {\n      plugin = Tools.trim(plugin);\n\n      if (plugin && !PluginManager.urls[plugin]) {\n        if (hasSkipLoadPrefix(plugin)) {\n          plugin = plugin.substr(1, plugin.length);\n          var dependencies = PluginManager.dependencies(plugin);\n          Tools.each(dependencies, function (depPlugin) {\n            var defaultSettings = {\n              prefix: 'plugins/',\n              resource: depPlugin,\n              suffix: '/plugin' + suffix + '.js'\n            };\n            var dep = PluginManager.createUrl(defaultSettings, depPlugin);\n            PluginManager.load(dep.resource, dep, noop, undefined, function () {\n              pluginLoadError(editor, dep.prefix + dep.resource + dep.suffix, dep.resource);\n            });\n          });\n        } else {\n          var url_2 = {\n            prefix: 'plugins/',\n            resource: plugin,\n            suffix: '/plugin' + suffix + '.js'\n          };\n          PluginManager.load(plugin, url_2, noop, undefined, function () {\n            pluginLoadError(editor, url_2.prefix + url_2.resource + url_2.suffix, plugin);\n          });\n        }\n      }\n    });\n  };\n\n  var loadScripts = function (editor, suffix) {\n    var scriptLoader = ScriptLoader.ScriptLoader;\n    loadTheme(scriptLoader, editor, suffix, function () {\n      loadLanguage(scriptLoader, editor);\n      loadIcons(scriptLoader, editor, suffix);\n      loadPlugins(editor, suffix);\n      scriptLoader.loadQueue(function () {\n        if (!editor.removed) {\n          init$2(editor);\n        }\n      }, editor, function () {\n        if (!editor.removed) {\n          init$2(editor);\n        }\n      });\n    });\n  };\n\n  var getStyleSheetLoader$1 = function (element, editor) {\n    return instance.forElement(element, {\n      contentCssCors: hasContentCssCors(editor),\n      referrerPolicy: getReferrerPolicy(editor)\n    });\n  };\n\n  var render = function (editor) {\n    var id = editor.id;\n    I18n.setCode(getLanguageCode(editor));\n\n    var readyHandler = function () {\n      DOM$7.unbind(window, 'ready', readyHandler);\n      editor.render();\n    };\n\n    if (!EventUtils.Event.domLoaded) {\n      DOM$7.bind(window, 'ready', readyHandler);\n      return;\n    }\n\n    if (!editor.getElement()) {\n      return;\n    }\n\n    if (!Env.contentEditable) {\n      return;\n    }\n\n    var element = SugarElement.fromDom(editor.getElement());\n    var snapshot = clone(element);\n    editor.on('remove', function () {\n      eachr(element.dom.attributes, function (attr) {\n        return remove$1(element, attr.name);\n      });\n      setAll(element, snapshot);\n    });\n    editor.ui.styleSheetLoader = getStyleSheetLoader$1(element, editor);\n\n    if (!isInline$1(editor)) {\n      editor.orgVisibility = editor.getElement().style.visibility;\n      editor.getElement().style.visibility = 'hidden';\n    } else {\n      editor.inline = true;\n    }\n\n    var form = editor.getElement().form || DOM$7.getParent(id, 'form');\n\n    if (form) {\n      editor.formElement = form;\n\n      if (hasHiddenInput(editor) && !isTextareaOrInput(editor.getElement())) {\n        DOM$7.insertAfter(DOM$7.create('input', {\n          type: 'hidden',\n          name: id\n        }), id);\n        editor.hasHiddenInput = true;\n      }\n\n      editor.formEventDelegate = function (e) {\n        editor.fire(e.type, e);\n      };\n\n      DOM$7.bind(form, 'submit reset', editor.formEventDelegate);\n      editor.on('reset', function () {\n        editor.resetContent();\n      });\n\n      if (shouldPatchSubmit(editor) && !form.submit.nodeType && !form.submit.length && !form._mceOldSubmit) {\n        form._mceOldSubmit = form.submit;\n\n        form.submit = function () {\n          editor.editorManager.triggerSave();\n          editor.setDirty(false);\n          return form._mceOldSubmit(form);\n        };\n      }\n    }\n\n    editor.windowManager = WindowManager(editor);\n    editor.notificationManager = NotificationManager(editor);\n\n    if (isEncodingXml(editor)) {\n      editor.on('GetContent', function (e) {\n        if (e.save) {\n          e.content = DOM$7.encode(e.content);\n        }\n      });\n    }\n\n    if (shouldAddFormSubmitTrigger(editor)) {\n      editor.on('submit', function () {\n        if (editor.initialized) {\n          editor.save();\n        }\n      });\n    }\n\n    if (shouldAddUnloadTrigger(editor)) {\n      editor._beforeUnload = function () {\n        if (editor.initialized && !editor.destroyed && !editor.isHidden()) {\n          editor.save({\n            format: 'raw',\n            no_events: true,\n            set_dirty: false\n          });\n        }\n      };\n\n      editor.editorManager.on('BeforeUnload', editor._beforeUnload);\n    }\n\n    editor.editorManager.add(editor);\n    loadScripts(editor, editor.suffix);\n  };\n\n  var addVisual$1 = function (editor, elm) {\n    return addVisual(editor, elm);\n  };\n\n  var legacyPropNames = {\n    'font-size': 'size',\n    'font-family': 'face'\n  };\n\n  var getSpecifiedFontProp = function (propName, rootElm, elm) {\n    var getProperty = function (elm) {\n      return getRaw(elm, propName).orThunk(function () {\n        if (name(elm) === 'font') {\n          return get$1(legacyPropNames, propName).bind(function (legacyPropName) {\n            return getOpt(elm, legacyPropName);\n          });\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n\n    var isRoot = function (elm) {\n      return eq$2(SugarElement.fromDom(rootElm), elm);\n    };\n\n    return closest$2(SugarElement.fromDom(elm), function (elm) {\n      return getProperty(elm);\n    }, isRoot);\n  };\n\n  var normalizeFontFamily = function (fontFamily) {\n    return fontFamily.replace(/[\\'\\\"\\\\]/g, '').replace(/,\\s+/g, ',');\n  };\n\n  var getComputedFontProp = function (propName, elm) {\n    return Optional.from(DOMUtils.DOM.getStyle(elm, propName, true));\n  };\n\n  var getFontProp = function (propName) {\n    return function (rootElm, elm) {\n      return Optional.from(elm).map(SugarElement.fromDom).filter(isElement).bind(function (element) {\n        return getSpecifiedFontProp(propName, rootElm, element.dom).or(getComputedFontProp(propName, element.dom));\n      }).getOr('');\n    };\n  };\n\n  var getFontSize = getFontProp('font-size');\n  var getFontFamily = compose(normalizeFontFamily, getFontProp('font-family'));\n\n  var findFirstCaretElement = function (editor) {\n    return firstPositionIn(editor.getBody()).map(function (caret) {\n      var container = caret.container();\n      return isText$1(container) ? container.parentNode : container;\n    });\n  };\n\n  var getCaretElement = function (editor) {\n    return Optional.from(editor.selection.getRng()).bind(function (rng) {\n      var root = editor.getBody();\n      var atStartOfNode = rng.startContainer === root && rng.startOffset === 0;\n      return atStartOfNode ? Optional.none() : Optional.from(editor.selection.getStart(true));\n    });\n  };\n\n  var mapRange = function (editor, mapper) {\n    return getCaretElement(editor).orThunk(curry(findFirstCaretElement, editor)).map(SugarElement.fromDom).filter(isElement).map(mapper);\n  };\n\n  var fromFontSizeNumber = function (editor, value) {\n    if (/^[0-9.]+$/.test(value)) {\n      var fontSizeNumber = parseInt(value, 10);\n\n      if (fontSizeNumber >= 1 && fontSizeNumber <= 7) {\n        var fontSizes = getFontStyleValues(editor);\n        var fontClasses = getFontSizeClasses(editor);\n\n        if (fontClasses) {\n          return fontClasses[fontSizeNumber - 1] || value;\n        } else {\n          return fontSizes[fontSizeNumber - 1] || value;\n        }\n      } else {\n        return value;\n      }\n    } else {\n      return value;\n    }\n  };\n\n  var normalizeFontNames = function (font) {\n    var fonts = font.split(/\\s*,\\s*/);\n    return map(fonts, function (font) {\n      if (font.indexOf(' ') !== -1 && !(startsWith(font, '\"') || startsWith(font, '\\''))) {\n        return '\\'' + font + '\\'';\n      } else {\n        return font;\n      }\n    }).join(',');\n  };\n\n  var fontNameAction = function (editor, value) {\n    var font = fromFontSizeNumber(editor, value);\n    editor.formatter.toggle('fontname', {\n      value: normalizeFontNames(font)\n    });\n    editor.nodeChanged();\n  };\n\n  var fontNameQuery = function (editor) {\n    return mapRange(editor, function (elm) {\n      return getFontFamily(editor.getBody(), elm.dom);\n    }).getOr('');\n  };\n\n  var fontSizeAction = function (editor, value) {\n    editor.formatter.toggle('fontsize', {\n      value: fromFontSizeNumber(editor, value)\n    });\n    editor.nodeChanged();\n  };\n\n  var fontSizeQuery = function (editor) {\n    return mapRange(editor, function (elm) {\n      return getFontSize(editor.getBody(), elm.dom);\n    }).getOr('');\n  };\n\n  var lineHeightQuery = function (editor) {\n    return mapRange(editor, function (elm) {\n      var root = SugarElement.fromDom(editor.getBody());\n      var specifiedStyle = closest$2(elm, function (elm) {\n        return getRaw(elm, 'line-height');\n      }, curry(eq$2, root));\n\n      var computedStyle = function () {\n        var lineHeight = parseFloat(get$5(elm, 'line-height'));\n        var fontSize = parseFloat(get$5(elm, 'font-size'));\n        return String(lineHeight / fontSize);\n      };\n\n      return specifiedStyle.getOrThunk(computedStyle);\n    }).getOr('');\n  };\n\n  var lineHeightAction = function (editor, lineHeight) {\n    editor.formatter.toggle('lineheight', {\n      value: String(lineHeight)\n    });\n    editor.nodeChanged();\n  };\n\n  var processValue = function (value) {\n    var details;\n\n    if (typeof value !== 'string') {\n      details = Tools.extend({\n        paste: value.paste,\n        data: {\n          paste: value.paste\n        }\n      }, value);\n      return {\n        content: value.content,\n        details: details\n      };\n    }\n\n    return {\n      content: value,\n      details: {}\n    };\n  };\n\n  var insertAtCaret$1 = function (editor, value) {\n    var result = processValue(value);\n    insertContent(editor, result.content, result.details);\n  };\n\n  var each$f = Tools.each;\n  var map$3 = Tools.map,\n      inArray$2 = Tools.inArray;\n\n  var EditorCommands = function () {\n    function EditorCommands(editor) {\n      this.commands = {\n        state: {},\n        exec: {},\n        value: {}\n      };\n      this.editor = editor;\n      this.setupCommands(editor);\n    }\n\n    EditorCommands.prototype.execCommand = function (command, ui, value, args) {\n      var func,\n          state = false;\n      var self = this;\n\n      if (self.editor.removed) {\n        return;\n      }\n\n      if (!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(command) && (!args || !args.skip_focus)) {\n        self.editor.focus();\n      } else {\n        restore(self.editor);\n      }\n\n      args = self.editor.fire('BeforeExecCommand', {\n        command: command,\n        ui: ui,\n        value: value\n      });\n\n      if (args.isDefaultPrevented()) {\n        return false;\n      }\n\n      var customCommand = command.toLowerCase();\n\n      if (func = self.commands.exec[customCommand]) {\n        func(customCommand, ui, value);\n        self.editor.fire('ExecCommand', {\n          command: command,\n          ui: ui,\n          value: value\n        });\n        return true;\n      }\n\n      each$f(this.editor.plugins, function (p) {\n        if (p.execCommand && p.execCommand(command, ui, value)) {\n          self.editor.fire('ExecCommand', {\n            command: command,\n            ui: ui,\n            value: value\n          });\n          state = true;\n          return false;\n        }\n      });\n\n      if (state) {\n        return state;\n      }\n\n      if (self.editor.theme && self.editor.theme.execCommand && self.editor.theme.execCommand(command, ui, value)) {\n        self.editor.fire('ExecCommand', {\n          command: command,\n          ui: ui,\n          value: value\n        });\n        return true;\n      }\n\n      try {\n        state = self.editor.getDoc().execCommand(command, ui, value);\n      } catch (ex) {}\n\n      if (state) {\n        self.editor.fire('ExecCommand', {\n          command: command,\n          ui: ui,\n          value: value\n        });\n        return true;\n      }\n\n      return false;\n    };\n\n    EditorCommands.prototype.queryCommandState = function (command) {\n      var func;\n\n      if (this.editor.quirks.isHidden() || this.editor.removed) {\n        return;\n      }\n\n      command = command.toLowerCase();\n\n      if (func = this.commands.state[command]) {\n        return func(command);\n      }\n\n      try {\n        return this.editor.getDoc().queryCommandState(command);\n      } catch (ex) {}\n\n      return false;\n    };\n\n    EditorCommands.prototype.queryCommandValue = function (command) {\n      var func;\n\n      if (this.editor.quirks.isHidden() || this.editor.removed) {\n        return;\n      }\n\n      command = command.toLowerCase();\n\n      if (func = this.commands.value[command]) {\n        return func(command);\n      }\n\n      try {\n        return this.editor.getDoc().queryCommandValue(command);\n      } catch (ex) {}\n    };\n\n    EditorCommands.prototype.addCommands = function (commandList, type) {\n      if (type === void 0) {\n        type = 'exec';\n      }\n\n      var self = this;\n      each$f(commandList, function (callback, command) {\n        each$f(command.toLowerCase().split(','), function (command) {\n          self.commands[type][command] = callback;\n        });\n      });\n    };\n\n    EditorCommands.prototype.addCommand = function (command, callback, scope) {\n      var _this = this;\n\n      command = command.toLowerCase();\n\n      this.commands.exec[command] = function (command, ui, value, args) {\n        return callback.call(scope || _this.editor, ui, value, args);\n      };\n    };\n\n    EditorCommands.prototype.queryCommandSupported = function (command) {\n      command = command.toLowerCase();\n\n      if (this.commands.exec[command]) {\n        return true;\n      }\n\n      try {\n        return this.editor.getDoc().queryCommandSupported(command);\n      } catch (ex) {}\n\n      return false;\n    };\n\n    EditorCommands.prototype.addQueryStateHandler = function (command, callback, scope) {\n      var _this = this;\n\n      command = command.toLowerCase();\n\n      this.commands.state[command] = function () {\n        return callback.call(scope || _this.editor);\n      };\n    };\n\n    EditorCommands.prototype.addQueryValueHandler = function (command, callback, scope) {\n      var _this = this;\n\n      command = command.toLowerCase();\n\n      this.commands.value[command] = function () {\n        return callback.call(scope || _this.editor);\n      };\n    };\n\n    EditorCommands.prototype.hasCustomCommand = function (command) {\n      command = command.toLowerCase();\n      return !!this.commands.exec[command];\n    };\n\n    EditorCommands.prototype.execNativeCommand = function (command, ui, value) {\n      if (ui === undefined) {\n        ui = false;\n      }\n\n      if (value === undefined) {\n        value = null;\n      }\n\n      return this.editor.getDoc().execCommand(command, ui, value);\n    };\n\n    EditorCommands.prototype.isFormatMatch = function (name) {\n      return this.editor.formatter.match(name);\n    };\n\n    EditorCommands.prototype.toggleFormat = function (name, value) {\n      this.editor.formatter.toggle(name, value ? {\n        value: value\n      } : undefined);\n      this.editor.nodeChanged();\n    };\n\n    EditorCommands.prototype.storeSelection = function (type) {\n      this.selectionBookmark = this.editor.selection.getBookmark(type);\n    };\n\n    EditorCommands.prototype.restoreSelection = function () {\n      this.editor.selection.moveToBookmark(this.selectionBookmark);\n    };\n\n    EditorCommands.prototype.setupCommands = function (editor) {\n      var self = this;\n      this.addCommands({\n        'mceResetDesignMode,mceBeginUndoLevel': noop,\n        'mceEndUndoLevel,mceAddUndoLevel': function () {\n          editor.undoManager.add();\n        },\n        'Cut,Copy,Paste': function (command) {\n          var doc = editor.getDoc();\n          var failed;\n\n          try {\n            self.execNativeCommand(command);\n          } catch (ex) {\n            failed = true;\n          }\n\n          if (command === 'paste' && !doc.queryCommandEnabled(command)) {\n            failed = true;\n          }\n\n          if (failed || !doc.queryCommandSupported(command)) {\n            var msg = editor.translate('Your browser doesn\\'t support direct access to the clipboard. ' + 'Please use the Ctrl+X/C/V keyboard shortcuts instead.');\n\n            if (Env.mac) {\n              msg = msg.replace(/Ctrl\\+/g, '\\u2318+');\n            }\n\n            editor.notificationManager.open({\n              text: msg,\n              type: 'error'\n            });\n          }\n        },\n        'unlink': function () {\n          if (editor.selection.isCollapsed()) {\n            var elm = editor.dom.getParent(editor.selection.getStart(), 'a');\n\n            if (elm) {\n              editor.dom.remove(elm, true);\n            }\n\n            return;\n          }\n\n          editor.formatter.remove('link');\n        },\n        'JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone': function (command) {\n          var align = command.substring(7);\n\n          if (align === 'full') {\n            align = 'justify';\n          }\n\n          each$f('left,center,right,justify'.split(','), function (name) {\n            if (align !== name) {\n              editor.formatter.remove('align' + name);\n            }\n          });\n\n          if (align !== 'none') {\n            self.toggleFormat('align' + align);\n          }\n        },\n        'InsertUnorderedList,InsertOrderedList': function (command) {\n          var listParent;\n          self.execNativeCommand(command);\n          var listElm = editor.dom.getParent(editor.selection.getNode(), 'ol,ul');\n\n          if (listElm) {\n            listParent = listElm.parentNode;\n\n            if (/^(H[1-6]|P|ADDRESS|PRE)$/.test(listParent.nodeName)) {\n              self.storeSelection();\n              editor.dom.split(listParent, listElm);\n              self.restoreSelection();\n            }\n          }\n        },\n        'Bold,Italic,Underline,Strikethrough,Superscript,Subscript': function (command) {\n          self.toggleFormat(command);\n        },\n        'ForeColor,HiliteColor': function (command, ui, value) {\n          self.toggleFormat(command, value);\n        },\n        'FontName': function (command, ui, value) {\n          fontNameAction(editor, value);\n        },\n        'FontSize': function (command, ui, value) {\n          fontSizeAction(editor, value);\n        },\n        'LineHeight': function (command, ui, value) {\n          lineHeightAction(editor, value);\n        },\n        'RemoveFormat': function (command) {\n          editor.formatter.remove(command);\n        },\n        'mceBlockQuote': function () {\n          self.toggleFormat('blockquote');\n        },\n        'FormatBlock': function (command, ui, value) {\n          return self.toggleFormat(value || 'p');\n        },\n        'mceCleanup': function () {\n          var bookmark = editor.selection.getBookmark();\n          editor.setContent(editor.getContent());\n          editor.selection.moveToBookmark(bookmark);\n        },\n        'mceRemoveNode': function (command, ui, value) {\n          var node = value || editor.selection.getNode();\n\n          if (node !== editor.getBody()) {\n            self.storeSelection();\n            editor.dom.remove(node, true);\n            self.restoreSelection();\n          }\n        },\n        'mceSelectNodeDepth': function (command, ui, value) {\n          var counter = 0;\n          editor.dom.getParent(editor.selection.getNode(), function (node) {\n            if (node.nodeType === 1 && counter++ === value) {\n              editor.selection.select(node);\n              return false;\n            }\n          }, editor.getBody());\n        },\n        'mceSelectNode': function (command, ui, value) {\n          editor.selection.select(value);\n        },\n        'mceInsertContent': function (command, ui, value) {\n          insertAtCaret$1(editor, value);\n        },\n        'mceInsertRawHTML': function (command, ui, value) {\n          editor.selection.setContent('tiny_mce_marker');\n          var content = editor.getContent();\n          editor.setContent(content.replace(/tiny_mce_marker/g, function () {\n            return value;\n          }));\n        },\n        'mceInsertNewLine': function (command, ui, value) {\n          insert$3(editor, value);\n        },\n        'mceToggleFormat': function (command, ui, value) {\n          self.toggleFormat(value);\n        },\n        'mceSetContent': function (command, ui, value) {\n          editor.setContent(value);\n        },\n        'Indent,Outdent': function (command) {\n          handle(editor, command);\n        },\n        'mceRepaint': noop,\n        'InsertHorizontalRule': function () {\n          editor.execCommand('mceInsertContent', false, '<hr />');\n        },\n        'mceToggleVisualAid': function () {\n          editor.hasVisual = !editor.hasVisual;\n          editor.addVisual();\n        },\n        'mceReplaceContent': function (command, ui, value) {\n          editor.execCommand('mceInsertContent', false, value.replace(/\\{\\$selection\\}/g, editor.selection.getContent({\n            format: 'text'\n          })));\n        },\n        'mceInsertLink': function (command, ui, value) {\n          if (typeof value === 'string') {\n            value = {\n              href: value\n            };\n          }\n\n          var anchor = editor.dom.getParent(editor.selection.getNode(), 'a');\n          value.href = value.href.replace(/ /g, '%20');\n\n          if (!anchor || !value.href) {\n            editor.formatter.remove('link');\n          }\n\n          if (value.href) {\n            editor.formatter.apply('link', value, anchor);\n          }\n        },\n        'selectAll': function () {\n          var editingHost = editor.dom.getParent(editor.selection.getStart(), isContentEditableTrue);\n\n          if (editingHost) {\n            var rng = editor.dom.createRng();\n            rng.selectNodeContents(editingHost);\n            editor.selection.setRng(rng);\n          }\n        },\n        'mceNewDocument': function () {\n          editor.setContent('');\n        },\n        'InsertLineBreak': function (command, ui, value) {\n          insert$2(editor, value);\n          return true;\n        }\n      });\n\n      var alignStates = function (name) {\n        return function () {\n          var selection = editor.selection;\n          var nodes = selection.isCollapsed() ? [editor.dom.getParent(selection.getNode(), editor.dom.isBlock)] : selection.getSelectedBlocks();\n          var matches = map$3(nodes, function (node) {\n            return !!editor.formatter.matchNode(node, name);\n          });\n          return inArray$2(matches, true) !== -1;\n        };\n      };\n\n      self.addCommands({\n        'JustifyLeft': alignStates('alignleft'),\n        'JustifyCenter': alignStates('aligncenter'),\n        'JustifyRight': alignStates('alignright'),\n        'JustifyFull': alignStates('alignjustify'),\n        'Bold,Italic,Underline,Strikethrough,Superscript,Subscript': function (command) {\n          return self.isFormatMatch(command);\n        },\n        'mceBlockQuote': function () {\n          return self.isFormatMatch('blockquote');\n        },\n        'Outdent': function () {\n          return canOutdent(editor);\n        },\n        'InsertUnorderedList,InsertOrderedList': function (command) {\n          var list = editor.dom.getParent(editor.selection.getNode(), 'ul,ol');\n          return list && (command === 'insertunorderedlist' && list.tagName === 'UL' || command === 'insertorderedlist' && list.tagName === 'OL');\n        }\n      }, 'state');\n      self.addCommands({\n        Undo: function () {\n          editor.undoManager.undo();\n        },\n        Redo: function () {\n          editor.undoManager.redo();\n        }\n      });\n      self.addQueryValueHandler('FontName', function () {\n        return fontNameQuery(editor);\n      }, this);\n      self.addQueryValueHandler('FontSize', function () {\n        return fontSizeQuery(editor);\n      }, this);\n      self.addQueryValueHandler('LineHeight', function () {\n        return lineHeightQuery(editor);\n      }, this);\n    };\n\n    return EditorCommands;\n  }();\n\n  var internalContentEditableAttr = 'data-mce-contenteditable';\n\n  var toggleClass = function (elm, cls, state) {\n    if (has$2(elm, cls) && state === false) {\n      remove$4(elm, cls);\n    } else if (state) {\n      add$3(elm, cls);\n    }\n  };\n\n  var setEditorCommandState = function (editor, cmd, state) {\n    try {\n      editor.getDoc().execCommand(cmd, false, String(state));\n    } catch (ex) {}\n  };\n\n  var setContentEditable = function (elm, state) {\n    elm.dom.contentEditable = state ? 'true' : 'false';\n  };\n\n  var switchOffContentEditableTrue = function (elm) {\n    each(descendants$1(elm, '*[contenteditable=\"true\"]'), function (elm) {\n      set(elm, internalContentEditableAttr, 'true');\n      setContentEditable(elm, false);\n    });\n  };\n\n  var switchOnContentEditableTrue = function (elm) {\n    each(descendants$1(elm, '*[' + internalContentEditableAttr + '=\"true\"]'), function (elm) {\n      remove$1(elm, internalContentEditableAttr);\n      setContentEditable(elm, true);\n    });\n  };\n\n  var removeFakeSelection = function (editor) {\n    Optional.from(editor.selection.getNode()).each(function (elm) {\n      elm.removeAttribute('data-mce-selected');\n    });\n  };\n\n  var restoreFakeSelection = function (editor) {\n    editor.selection.setRng(editor.selection.getRng());\n  };\n\n  var toggleReadOnly = function (editor, state) {\n    var body = SugarElement.fromDom(editor.getBody());\n    toggleClass(body, 'mce-content-readonly', state);\n\n    if (state) {\n      editor.selection.controlSelection.hideResizeRect();\n\n      editor._selectionOverrides.hideFakeCaret();\n\n      removeFakeSelection(editor);\n      editor.readonly = true;\n      setContentEditable(body, false);\n      switchOffContentEditableTrue(body);\n    } else {\n      editor.readonly = false;\n      setContentEditable(body, true);\n      switchOnContentEditableTrue(body);\n      setEditorCommandState(editor, 'StyleWithCSS', false);\n      setEditorCommandState(editor, 'enableInlineTableEditing', false);\n      setEditorCommandState(editor, 'enableObjectResizing', false);\n\n      if (hasEditorOrUiFocus(editor)) {\n        editor.focus();\n      }\n\n      restoreFakeSelection(editor);\n      editor.nodeChanged();\n    }\n  };\n\n  var isReadOnly$1 = function (editor) {\n    return editor.readonly;\n  };\n\n  var registerFilters = function (editor) {\n    editor.parser.addAttributeFilter('contenteditable', function (nodes) {\n      if (isReadOnly$1(editor)) {\n        each(nodes, function (node) {\n          node.attr(internalContentEditableAttr, node.attr('contenteditable'));\n          node.attr('contenteditable', 'false');\n        });\n      }\n    });\n    editor.serializer.addAttributeFilter(internalContentEditableAttr, function (nodes) {\n      if (isReadOnly$1(editor)) {\n        each(nodes, function (node) {\n          node.attr('contenteditable', node.attr(internalContentEditableAttr));\n        });\n      }\n    });\n    editor.serializer.addTempAttr(internalContentEditableAttr);\n  };\n\n  var registerReadOnlyContentFilters = function (editor) {\n    if (editor.serializer) {\n      registerFilters(editor);\n    } else {\n      editor.on('PreInit', function () {\n        registerFilters(editor);\n      });\n    }\n  };\n\n  var isClickEvent = function (e) {\n    return e.type === 'click';\n  };\n\n  var getAnchorHrefOpt = function (editor, elm) {\n    var isRoot = function (elm) {\n      return eq$2(elm, SugarElement.fromDom(editor.getBody()));\n    };\n\n    return closest$1(elm, 'a', isRoot).bind(function (a) {\n      return getOpt(a, 'href');\n    });\n  };\n\n  var processReadonlyEvents = function (editor, e) {\n    if (isClickEvent(e) && !VK.metaKeyPressed(e)) {\n      var elm = SugarElement.fromDom(e.target);\n      getAnchorHrefOpt(editor, elm).each(function (href) {\n        e.preventDefault();\n\n        if (/^#/.test(href)) {\n          var targetEl = editor.dom.select(href + ',[name=\"' + removeLeading(href, '#') + '\"]');\n\n          if (targetEl.length) {\n            editor.selection.scrollIntoView(targetEl[0], true);\n          }\n        } else {\n          window.open(href, '_blank', 'rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes');\n        }\n      });\n    }\n  };\n\n  var registerReadOnlySelectionBlockers = function (editor) {\n    editor.on('ShowCaret', function (e) {\n      if (isReadOnly$1(editor)) {\n        e.preventDefault();\n      }\n    });\n    editor.on('ObjectSelected', function (e) {\n      if (isReadOnly$1(editor)) {\n        e.preventDefault();\n      }\n    });\n  };\n\n  var nativeEvents = Tools.makeMap('focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange ' + 'mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover ' + 'draggesture dragdrop drop drag submit ' + 'compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel', ' ');\n\n  var EventDispatcher = function () {\n    function EventDispatcher(settings) {\n      this.bindings = {};\n      this.settings = settings || {};\n      this.scope = this.settings.scope || this;\n      this.toggleEvent = this.settings.toggleEvent || never;\n    }\n\n    EventDispatcher.isNative = function (name) {\n      return !!nativeEvents[name.toLowerCase()];\n    };\n\n    EventDispatcher.prototype.fire = function (nameIn, argsIn) {\n      var name = nameIn.toLowerCase();\n      var args = argsIn || {};\n      args.type = name;\n\n      if (!args.target) {\n        args.target = this.scope;\n      }\n\n      if (!args.preventDefault) {\n        args.preventDefault = function () {\n          args.isDefaultPrevented = always;\n        };\n\n        args.stopPropagation = function () {\n          args.isPropagationStopped = always;\n        };\n\n        args.stopImmediatePropagation = function () {\n          args.isImmediatePropagationStopped = always;\n        };\n\n        args.isDefaultPrevented = never;\n        args.isPropagationStopped = never;\n        args.isImmediatePropagationStopped = never;\n      }\n\n      if (this.settings.beforeFire) {\n        this.settings.beforeFire(args);\n      }\n\n      var handlers = this.bindings[name];\n\n      if (handlers) {\n        for (var i = 0, l = handlers.length; i < l; i++) {\n          var callback = handlers[i];\n\n          if (callback.once) {\n            this.off(name, callback.func);\n          }\n\n          if (args.isImmediatePropagationStopped()) {\n            args.stopPropagation();\n            return args;\n          }\n\n          if (callback.func.call(this.scope, args) === false) {\n            args.preventDefault();\n            return args;\n          }\n        }\n      }\n\n      return args;\n    };\n\n    EventDispatcher.prototype.on = function (name, callback, prepend, extra) {\n      if (callback === false) {\n        callback = never;\n      }\n\n      if (callback) {\n        var wrappedCallback = {\n          func: callback\n        };\n\n        if (extra) {\n          Tools.extend(wrappedCallback, extra);\n        }\n\n        var names = name.toLowerCase().split(' ');\n        var i = names.length;\n\n        while (i--) {\n          var currentName = names[i];\n          var handlers = this.bindings[currentName];\n\n          if (!handlers) {\n            handlers = this.bindings[currentName] = [];\n            this.toggleEvent(currentName, true);\n          }\n\n          if (prepend) {\n            handlers.unshift(wrappedCallback);\n          } else {\n            handlers.push(wrappedCallback);\n          }\n        }\n      }\n\n      return this;\n    };\n\n    EventDispatcher.prototype.off = function (name, callback) {\n      var _this = this;\n\n      if (name) {\n        var names = name.toLowerCase().split(' ');\n        var i = names.length;\n\n        while (i--) {\n          var currentName = names[i];\n          var handlers = this.bindings[currentName];\n\n          if (!currentName) {\n            each$1(this.bindings, function (_value, bindingName) {\n              _this.toggleEvent(bindingName, false);\n\n              delete _this.bindings[bindingName];\n            });\n            return this;\n          }\n\n          if (handlers) {\n            if (!callback) {\n              handlers.length = 0;\n            } else {\n              var hi = handlers.length;\n\n              while (hi--) {\n                if (handlers[hi].func === callback) {\n                  handlers = handlers.slice(0, hi).concat(handlers.slice(hi + 1));\n                  this.bindings[currentName] = handlers;\n                }\n              }\n            }\n\n            if (!handlers.length) {\n              this.toggleEvent(name, false);\n              delete this.bindings[currentName];\n            }\n          }\n        }\n      } else {\n        each$1(this.bindings, function (_value, name) {\n          _this.toggleEvent(name, false);\n        });\n        this.bindings = {};\n      }\n\n      return this;\n    };\n\n    EventDispatcher.prototype.once = function (name, callback, prepend) {\n      return this.on(name, callback, prepend, {\n        once: true\n      });\n    };\n\n    EventDispatcher.prototype.has = function (name) {\n      name = name.toLowerCase();\n      return !(!this.bindings[name] || this.bindings[name].length === 0);\n    };\n\n    return EventDispatcher;\n  }();\n\n  var getEventDispatcher = function (obj) {\n    if (!obj._eventDispatcher) {\n      obj._eventDispatcher = new EventDispatcher({\n        scope: obj,\n        toggleEvent: function (name, state) {\n          if (EventDispatcher.isNative(name) && obj.toggleNativeEvent) {\n            obj.toggleNativeEvent(name, state);\n          }\n        }\n      });\n    }\n\n    return obj._eventDispatcher;\n  };\n\n  var Observable = {\n    fire: function (name, args, bubble) {\n      var self = this;\n\n      if (self.removed && name !== 'remove' && name !== 'detach') {\n        return args;\n      }\n\n      var dispatcherArgs = getEventDispatcher(self).fire(name, args);\n\n      if (bubble !== false && self.parent) {\n        var parent_1 = self.parent();\n\n        while (parent_1 && !dispatcherArgs.isPropagationStopped()) {\n          parent_1.fire(name, dispatcherArgs, false);\n          parent_1 = parent_1.parent();\n        }\n      }\n\n      return dispatcherArgs;\n    },\n    on: function (name, callback, prepend) {\n      return getEventDispatcher(this).on(name, callback, prepend);\n    },\n    off: function (name, callback) {\n      return getEventDispatcher(this).off(name, callback);\n    },\n    once: function (name, callback) {\n      return getEventDispatcher(this).once(name, callback);\n    },\n    hasEventListeners: function (name) {\n      return getEventDispatcher(this).has(name);\n    }\n  };\n  var DOM$8 = DOMUtils.DOM;\n  var customEventRootDelegates;\n\n  var getEventTarget = function (editor, eventName) {\n    if (eventName === 'selectionchange') {\n      return editor.getDoc();\n    }\n\n    if (!editor.inline && /^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(eventName)) {\n      return editor.getDoc().documentElement;\n    }\n\n    var eventRoot = getEventRoot(editor);\n\n    if (eventRoot) {\n      if (!editor.eventRoot) {\n        editor.eventRoot = DOM$8.select(eventRoot)[0];\n      }\n\n      return editor.eventRoot;\n    }\n\n    return editor.getBody();\n  };\n\n  var isListening = function (editor) {\n    return !editor.hidden && !isReadOnly$1(editor);\n  };\n\n  var fireEvent = function (editor, eventName, e) {\n    if (isListening(editor)) {\n      editor.fire(eventName, e);\n    } else if (isReadOnly$1(editor)) {\n      processReadonlyEvents(editor, e);\n    }\n  };\n\n  var bindEventDelegate = function (editor, eventName) {\n    var delegate;\n\n    if (!editor.delegates) {\n      editor.delegates = {};\n    }\n\n    if (editor.delegates[eventName] || editor.removed) {\n      return;\n    }\n\n    var eventRootElm = getEventTarget(editor, eventName);\n\n    if (getEventRoot(editor)) {\n      if (!customEventRootDelegates) {\n        customEventRootDelegates = {};\n        editor.editorManager.on('removeEditor', function () {\n          if (!editor.editorManager.activeEditor) {\n            if (customEventRootDelegates) {\n              each$1(customEventRootDelegates, function (_value, name) {\n                editor.dom.unbind(getEventTarget(editor, name));\n              });\n              customEventRootDelegates = null;\n            }\n          }\n        });\n      }\n\n      if (customEventRootDelegates[eventName]) {\n        return;\n      }\n\n      delegate = function (e) {\n        var target = e.target;\n        var editors = editor.editorManager.get();\n        var i = editors.length;\n\n        while (i--) {\n          var body = editors[i].getBody();\n\n          if (body === target || DOM$8.isChildOf(target, body)) {\n            fireEvent(editors[i], eventName, e);\n          }\n        }\n      };\n\n      customEventRootDelegates[eventName] = delegate;\n      DOM$8.bind(eventRootElm, eventName, delegate);\n    } else {\n      delegate = function (e) {\n        fireEvent(editor, eventName, e);\n      };\n\n      DOM$8.bind(eventRootElm, eventName, delegate);\n      editor.delegates[eventName] = delegate;\n    }\n  };\n\n  var EditorObservable = __assign(__assign({}, Observable), {\n    bindPendingEventDelegates: function () {\n      var self = this;\n      Tools.each(self._pendingNativeEvents, function (name) {\n        bindEventDelegate(self, name);\n      });\n    },\n    toggleNativeEvent: function (name, state) {\n      var self = this;\n\n      if (name === 'focus' || name === 'blur') {\n        return;\n      }\n\n      if (state) {\n        if (self.initialized) {\n          bindEventDelegate(self, name);\n        } else {\n          if (!self._pendingNativeEvents) {\n            self._pendingNativeEvents = [name];\n          } else {\n            self._pendingNativeEvents.push(name);\n          }\n        }\n      } else if (self.initialized) {\n        self.dom.unbind(getEventTarget(self, name), name, self.delegates[name]);\n        delete self.delegates[name];\n      }\n    },\n    unbindAllNativeEvents: function () {\n      var self = this;\n      var body = self.getBody();\n      var dom = self.dom;\n\n      if (self.delegates) {\n        each$1(self.delegates, function (value, name) {\n          self.dom.unbind(getEventTarget(self, name), name, value);\n        });\n        delete self.delegates;\n      }\n\n      if (!self.inline && body && dom) {\n        body.onload = null;\n        dom.unbind(self.getWin());\n        dom.unbind(self.getDoc());\n      }\n\n      if (dom) {\n        dom.unbind(body);\n        dom.unbind(self.getContainer());\n      }\n    }\n  });\n\n  var defaultModes = ['design', 'readonly'];\n\n  var switchToMode = function (editor, activeMode, availableModes, mode) {\n    var oldMode = availableModes[activeMode.get()];\n    var newMode = availableModes[mode];\n\n    try {\n      newMode.activate();\n    } catch (e) {\n      console.error('problem while activating editor mode ' + mode + ':', e);\n      return;\n    }\n\n    oldMode.deactivate();\n\n    if (oldMode.editorReadOnly !== newMode.editorReadOnly) {\n      toggleReadOnly(editor, newMode.editorReadOnly);\n    }\n\n    activeMode.set(mode);\n    fireSwitchMode(editor, mode);\n  };\n\n  var setMode = function (editor, availableModes, activeMode, mode) {\n    if (mode === activeMode.get()) {\n      return;\n    } else if (!has(availableModes, mode)) {\n      throw new Error('Editor mode \\'' + mode + '\\' is invalid');\n    }\n\n    if (editor.initialized) {\n      switchToMode(editor, activeMode, availableModes, mode);\n    } else {\n      editor.on('init', function () {\n        return switchToMode(editor, activeMode, availableModes, mode);\n      });\n    }\n  };\n\n  var registerMode = function (availableModes, mode, api) {\n    var _a;\n\n    if (contains(defaultModes, mode)) {\n      throw new Error('Cannot override default mode ' + mode);\n    }\n\n    return __assign(__assign({}, availableModes), (_a = {}, _a[mode] = __assign(__assign({}, api), {\n      deactivate: function () {\n        try {\n          api.deactivate();\n        } catch (e) {\n          console.error('problem while deactivating editor mode ' + mode + ':', e);\n        }\n      }\n    }), _a));\n  };\n\n  var create$5 = function (editor) {\n    var activeMode = Cell('design');\n    var availableModes = Cell({\n      design: {\n        activate: noop,\n        deactivate: noop,\n        editorReadOnly: false\n      },\n      readonly: {\n        activate: noop,\n        deactivate: noop,\n        editorReadOnly: true\n      }\n    });\n    registerReadOnlyContentFilters(editor);\n    registerReadOnlySelectionBlockers(editor);\n    return {\n      isReadOnly: function () {\n        return isReadOnly$1(editor);\n      },\n      set: function (mode) {\n        return setMode(editor, availableModes.get(), activeMode, mode);\n      },\n      get: function () {\n        return activeMode.get();\n      },\n      register: function (mode, api) {\n        availableModes.set(registerMode(availableModes.get(), mode, api));\n      }\n    };\n  };\n\n  var each$g = Tools.each,\n      explode$3 = Tools.explode;\n  var keyCodeLookup = {\n    f1: 112,\n    f2: 113,\n    f3: 114,\n    f4: 115,\n    f5: 116,\n    f6: 117,\n    f7: 118,\n    f8: 119,\n    f9: 120,\n    f10: 121,\n    f11: 122,\n    f12: 123\n  };\n  var modifierNames = Tools.makeMap('alt,ctrl,shift,meta,access');\n\n  var parseShortcut = function (pattern) {\n    var key;\n    var shortcut = {};\n    each$g(explode$3(pattern.toLowerCase(), '+'), function (value) {\n      if (value in modifierNames) {\n        shortcut[value] = true;\n      } else {\n        if (/^[0-9]{2,}$/.test(value)) {\n          shortcut.keyCode = parseInt(value, 10);\n        } else {\n          shortcut.charCode = value.charCodeAt(0);\n          shortcut.keyCode = keyCodeLookup[value] || value.toUpperCase().charCodeAt(0);\n        }\n      }\n    });\n    var id = [shortcut.keyCode];\n\n    for (key in modifierNames) {\n      if (shortcut[key]) {\n        id.push(key);\n      } else {\n        shortcut[key] = false;\n      }\n    }\n\n    shortcut.id = id.join(',');\n\n    if (shortcut.access) {\n      shortcut.alt = true;\n\n      if (Env.mac) {\n        shortcut.ctrl = true;\n      } else {\n        shortcut.shift = true;\n      }\n    }\n\n    if (shortcut.meta) {\n      if (Env.mac) {\n        shortcut.meta = true;\n      } else {\n        shortcut.ctrl = true;\n        shortcut.meta = false;\n      }\n    }\n\n    return shortcut;\n  };\n\n  var Shortcuts = function () {\n    function Shortcuts(editor) {\n      this.shortcuts = {};\n      this.pendingPatterns = [];\n      this.editor = editor;\n      var self = this;\n      editor.on('keyup keypress keydown', function (e) {\n        if ((self.hasModifier(e) || self.isFunctionKey(e)) && !e.isDefaultPrevented()) {\n          each$g(self.shortcuts, function (shortcut) {\n            if (self.matchShortcut(e, shortcut)) {\n              self.pendingPatterns = shortcut.subpatterns.slice(0);\n\n              if (e.type === 'keydown') {\n                self.executeShortcutAction(shortcut);\n              }\n\n              return true;\n            }\n          });\n\n          if (self.matchShortcut(e, self.pendingPatterns[0])) {\n            if (self.pendingPatterns.length === 1) {\n              if (e.type === 'keydown') {\n                self.executeShortcutAction(self.pendingPatterns[0]);\n              }\n            }\n\n            self.pendingPatterns.shift();\n          }\n        }\n      });\n    }\n\n    Shortcuts.prototype.add = function (pattern, desc, cmdFunc, scope) {\n      var self = this;\n      var func = self.normalizeCommandFunc(cmdFunc);\n      each$g(explode$3(Tools.trim(pattern)), function (pattern) {\n        var shortcut = self.createShortcut(pattern, desc, func, scope);\n        self.shortcuts[shortcut.id] = shortcut;\n      });\n      return true;\n    };\n\n    Shortcuts.prototype.remove = function (pattern) {\n      var shortcut = this.createShortcut(pattern);\n\n      if (this.shortcuts[shortcut.id]) {\n        delete this.shortcuts[shortcut.id];\n        return true;\n      }\n\n      return false;\n    };\n\n    Shortcuts.prototype.normalizeCommandFunc = function (cmdFunc) {\n      var self = this;\n      var cmd = cmdFunc;\n\n      if (typeof cmd === 'string') {\n        return function () {\n          self.editor.execCommand(cmd, false, null);\n        };\n      } else if (Tools.isArray(cmd)) {\n        return function () {\n          self.editor.execCommand(cmd[0], cmd[1], cmd[2]);\n        };\n      } else {\n        return cmd;\n      }\n    };\n\n    Shortcuts.prototype.createShortcut = function (pattern, desc, cmdFunc, scope) {\n      var shortcuts = Tools.map(explode$3(pattern, '>'), parseShortcut);\n      shortcuts[shortcuts.length - 1] = Tools.extend(shortcuts[shortcuts.length - 1], {\n        func: cmdFunc,\n        scope: scope || this.editor\n      });\n      return Tools.extend(shortcuts[0], {\n        desc: this.editor.translate(desc),\n        subpatterns: shortcuts.slice(1)\n      });\n    };\n\n    Shortcuts.prototype.hasModifier = function (e) {\n      return e.altKey || e.ctrlKey || e.metaKey;\n    };\n\n    Shortcuts.prototype.isFunctionKey = function (e) {\n      return e.type === 'keydown' && e.keyCode >= 112 && e.keyCode <= 123;\n    };\n\n    Shortcuts.prototype.matchShortcut = function (e, shortcut) {\n      if (!shortcut) {\n        return false;\n      }\n\n      if (shortcut.ctrl !== e.ctrlKey || shortcut.meta !== e.metaKey) {\n        return false;\n      }\n\n      if (shortcut.alt !== e.altKey || shortcut.shift !== e.shiftKey) {\n        return false;\n      }\n\n      if (e.keyCode === shortcut.keyCode || e.charCode && e.charCode === shortcut.charCode) {\n        e.preventDefault();\n        return true;\n      }\n\n      return false;\n    };\n\n    Shortcuts.prototype.executeShortcutAction = function (shortcut) {\n      return shortcut.func ? shortcut.func.call(shortcut.scope) : null;\n    };\n\n    return Shortcuts;\n  }();\n\n  var create$6 = function () {\n    var buttons = {};\n    var menuItems = {};\n    var popups = {};\n    var icons = {};\n    var contextMenus = {};\n    var contextToolbars = {};\n    var sidebars = {};\n\n    var add = function (collection, type) {\n      return function (name, spec) {\n        return collection[name.toLowerCase()] = __assign(__assign({}, spec), {\n          type: type\n        });\n      };\n    };\n\n    var addIcon = function (name, svgData) {\n      return icons[name.toLowerCase()] = svgData;\n    };\n\n    return {\n      addButton: add(buttons, 'button'),\n      addGroupToolbarButton: add(buttons, 'grouptoolbarbutton'),\n      addToggleButton: add(buttons, 'togglebutton'),\n      addMenuButton: add(buttons, 'menubutton'),\n      addSplitButton: add(buttons, 'splitbutton'),\n      addMenuItem: add(menuItems, 'menuitem'),\n      addNestedMenuItem: add(menuItems, 'nestedmenuitem'),\n      addToggleMenuItem: add(menuItems, 'togglemenuitem'),\n      addAutocompleter: add(popups, 'autocompleter'),\n      addContextMenu: add(contextMenus, 'contextmenu'),\n      addContextToolbar: add(contextToolbars, 'contexttoolbar'),\n      addContextForm: add(contextToolbars, 'contextform'),\n      addSidebar: add(sidebars, 'sidebar'),\n      addIcon: addIcon,\n      getAll: function () {\n        return {\n          buttons: buttons,\n          menuItems: menuItems,\n          icons: icons,\n          popups: popups,\n          contextMenus: contextMenus,\n          contextToolbars: contextToolbars,\n          sidebars: sidebars\n        };\n      }\n    };\n  };\n\n  var registry = function () {\n    var bridge = create$6();\n    return {\n      addAutocompleter: bridge.addAutocompleter,\n      addButton: bridge.addButton,\n      addContextForm: bridge.addContextForm,\n      addContextMenu: bridge.addContextMenu,\n      addContextToolbar: bridge.addContextToolbar,\n      addIcon: bridge.addIcon,\n      addMenuButton: bridge.addMenuButton,\n      addMenuItem: bridge.addMenuItem,\n      addNestedMenuItem: bridge.addNestedMenuItem,\n      addSidebar: bridge.addSidebar,\n      addSplitButton: bridge.addSplitButton,\n      addToggleButton: bridge.addToggleButton,\n      addGroupToolbarButton: bridge.addGroupToolbarButton,\n      addToggleMenuItem: bridge.addToggleMenuItem,\n      getAll: bridge.getAll\n    };\n  };\n\n  var each$h = Tools.each,\n      trim$4 = Tools.trim;\n  var queryParts = 'source protocol authority userInfo user password host port relative path directory file query anchor'.split(' ');\n  var DEFAULT_PORTS = {\n    ftp: 21,\n    http: 80,\n    https: 443,\n    mailto: 25\n  };\n\n  var URI = function () {\n    function URI(url, settings) {\n      url = trim$4(url);\n      this.settings = settings || {};\n      var baseUri = this.settings.base_uri;\n      var self = this;\n\n      if (/^([\\w\\-]+):([^\\/]{2})/i.test(url) || /^\\s*#/.test(url)) {\n        self.source = url;\n        return;\n      }\n\n      var isProtocolRelative = url.indexOf('//') === 0;\n\n      if (url.indexOf('/') === 0 && !isProtocolRelative) {\n        url = (baseUri ? baseUri.protocol || 'http' : 'http') + '://mce_host' + url;\n      }\n\n      if (!/^[\\w\\-]*:?\\/\\//.test(url)) {\n        var baseUrl = this.settings.base_uri ? this.settings.base_uri.path : new URI(document.location.href).directory;\n\n        if (this.settings.base_uri && this.settings.base_uri.protocol == '') {\n          url = '//mce_host' + self.toAbsPath(baseUrl, url);\n        } else {\n          var match = /([^#?]*)([#?]?.*)/.exec(url);\n          url = (baseUri && baseUri.protocol || 'http') + '://mce_host' + self.toAbsPath(baseUrl, match[1]) + match[2];\n        }\n      }\n\n      url = url.replace(/@@/g, '(mce_at)');\n      var urlMatch = /^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@\\/]*):?([^:@\\/]*))?@)?(\\[[a-zA-Z0-9:.%]+\\]|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(url);\n      each$h(queryParts, function (v, i) {\n        var part = urlMatch[i];\n\n        if (part) {\n          part = part.replace(/\\(mce_at\\)/g, '@@');\n        }\n\n        self[v] = part;\n      });\n\n      if (baseUri) {\n        if (!self.protocol) {\n          self.protocol = baseUri.protocol;\n        }\n\n        if (!self.userInfo) {\n          self.userInfo = baseUri.userInfo;\n        }\n\n        if (!self.port && self.host === 'mce_host') {\n          self.port = baseUri.port;\n        }\n\n        if (!self.host || self.host === 'mce_host') {\n          self.host = baseUri.host;\n        }\n\n        self.source = '';\n      }\n\n      if (isProtocolRelative) {\n        self.protocol = '';\n      }\n    }\n\n    URI.parseDataUri = function (uri) {\n      var type;\n      var uriComponents = decodeURIComponent(uri).split(',');\n      var matches = /data:([^;]+)/.exec(uriComponents[0]);\n\n      if (matches) {\n        type = matches[1];\n      }\n\n      return {\n        type: type,\n        data: uriComponents[1]\n      };\n    };\n\n    URI.getDocumentBaseUrl = function (loc) {\n      var baseUrl;\n\n      if (loc.protocol.indexOf('http') !== 0 && loc.protocol !== 'file:') {\n        baseUrl = loc.href;\n      } else {\n        baseUrl = loc.protocol + '//' + loc.host + loc.pathname;\n      }\n\n      if (/^[^:]+:\\/\\/\\/?[^\\/]+\\//.test(baseUrl)) {\n        baseUrl = baseUrl.replace(/[\\?#].*$/, '').replace(/[\\/\\\\][^\\/]+$/, '');\n\n        if (!/[\\/\\\\]$/.test(baseUrl)) {\n          baseUrl += '/';\n        }\n      }\n\n      return baseUrl;\n    };\n\n    URI.prototype.setPath = function (path) {\n      var pathMatch = /^(.*?)\\/?(\\w+)?$/.exec(path);\n      this.path = pathMatch[0];\n      this.directory = pathMatch[1];\n      this.file = pathMatch[2];\n      this.source = '';\n      this.getURI();\n    };\n\n    URI.prototype.toRelative = function (uri) {\n      var output;\n\n      if (uri === './') {\n        return uri;\n      }\n\n      var relativeUri = new URI(uri, {\n        base_uri: this\n      });\n\n      if (relativeUri.host !== 'mce_host' && this.host !== relativeUri.host && relativeUri.host || this.port !== relativeUri.port || this.protocol !== relativeUri.protocol && relativeUri.protocol !== '') {\n        return relativeUri.getURI();\n      }\n\n      var tu = this.getURI(),\n          uu = relativeUri.getURI();\n\n      if (tu === uu || tu.charAt(tu.length - 1) === '/' && tu.substr(0, tu.length - 1) === uu) {\n        return tu;\n      }\n\n      output = this.toRelPath(this.path, relativeUri.path);\n\n      if (relativeUri.query) {\n        output += '?' + relativeUri.query;\n      }\n\n      if (relativeUri.anchor) {\n        output += '#' + relativeUri.anchor;\n      }\n\n      return output;\n    };\n\n    URI.prototype.toAbsolute = function (uri, noHost) {\n      var absoluteUri = new URI(uri, {\n        base_uri: this\n      });\n      return absoluteUri.getURI(noHost && this.isSameOrigin(absoluteUri));\n    };\n\n    URI.prototype.isSameOrigin = function (uri) {\n      if (this.host == uri.host && this.protocol == uri.protocol) {\n        if (this.port == uri.port) {\n          return true;\n        }\n\n        var defaultPort = DEFAULT_PORTS[this.protocol];\n\n        if (defaultPort && (this.port || defaultPort) == (uri.port || defaultPort)) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n\n    URI.prototype.toRelPath = function (base, path) {\n      var breakPoint = 0,\n          out = '',\n          i,\n          l;\n      var normalizedBase = base.substring(0, base.lastIndexOf('/')).split('/');\n      var items = path.split('/');\n\n      if (normalizedBase.length >= items.length) {\n        for (i = 0, l = normalizedBase.length; i < l; i++) {\n          if (i >= items.length || normalizedBase[i] !== items[i]) {\n            breakPoint = i + 1;\n            break;\n          }\n        }\n      }\n\n      if (normalizedBase.length < items.length) {\n        for (i = 0, l = items.length; i < l; i++) {\n          if (i >= normalizedBase.length || normalizedBase[i] !== items[i]) {\n            breakPoint = i + 1;\n            break;\n          }\n        }\n      }\n\n      if (breakPoint === 1) {\n        return path;\n      }\n\n      for (i = 0, l = normalizedBase.length - (breakPoint - 1); i < l; i++) {\n        out += '../';\n      }\n\n      for (i = breakPoint - 1, l = items.length; i < l; i++) {\n        if (i !== breakPoint - 1) {\n          out += '/' + items[i];\n        } else {\n          out += items[i];\n        }\n      }\n\n      return out;\n    };\n\n    URI.prototype.toAbsPath = function (base, path) {\n      var i,\n          nb = 0,\n          o = [],\n          outPath;\n      var tr = /\\/$/.test(path) ? '/' : '';\n      var normalizedBase = base.split('/');\n      var normalizedPath = path.split('/');\n      each$h(normalizedBase, function (k) {\n        if (k) {\n          o.push(k);\n        }\n      });\n      normalizedBase = o;\n\n      for (i = normalizedPath.length - 1, o = []; i >= 0; i--) {\n        if (normalizedPath[i].length === 0 || normalizedPath[i] === '.') {\n          continue;\n        }\n\n        if (normalizedPath[i] === '..') {\n          nb++;\n          continue;\n        }\n\n        if (nb > 0) {\n          nb--;\n          continue;\n        }\n\n        o.push(normalizedPath[i]);\n      }\n\n      i = normalizedBase.length - nb;\n\n      if (i <= 0) {\n        outPath = reverse(o).join('/');\n      } else {\n        outPath = normalizedBase.slice(0, i).join('/') + '/' + reverse(o).join('/');\n      }\n\n      if (outPath.indexOf('/') !== 0) {\n        outPath = '/' + outPath;\n      }\n\n      if (tr && outPath.lastIndexOf('/') !== outPath.length - 1) {\n        outPath += tr;\n      }\n\n      return outPath;\n    };\n\n    URI.prototype.getURI = function (noProtoHost) {\n      if (noProtoHost === void 0) {\n        noProtoHost = false;\n      }\n\n      var s;\n\n      if (!this.source || noProtoHost) {\n        s = '';\n\n        if (!noProtoHost) {\n          if (this.protocol) {\n            s += this.protocol + '://';\n          } else {\n            s += '//';\n          }\n\n          if (this.userInfo) {\n            s += this.userInfo + '@';\n          }\n\n          if (this.host) {\n            s += this.host;\n          }\n\n          if (this.port) {\n            s += ':' + this.port;\n          }\n        }\n\n        if (this.path) {\n          s += this.path;\n        }\n\n        if (this.query) {\n          s += '?' + this.query;\n        }\n\n        if (this.anchor) {\n          s += '#' + this.anchor;\n        }\n\n        this.source = s;\n      }\n\n      return this.source;\n    };\n\n    return URI;\n  }();\n\n  var DOM$9 = DOMUtils.DOM;\n  var extend$3 = Tools.extend,\n      each$i = Tools.each;\n  var resolve$3 = Tools.resolve;\n  var ie$1 = Env.ie;\n\n  var Editor = function () {\n    function Editor(id, settings, editorManager) {\n      var _this = this;\n\n      this.plugins = {};\n      this.contentCSS = [];\n      this.contentStyles = [];\n      this.loadedCSS = {};\n      this.isNotDirty = false;\n      this.editorManager = editorManager;\n      this.documentBaseUrl = editorManager.documentBaseURL;\n      extend$3(this, EditorObservable);\n      this.settings = getEditorSettings(this, id, this.documentBaseUrl, editorManager.defaultSettings, settings);\n\n      if (this.settings.suffix) {\n        editorManager.suffix = this.settings.suffix;\n      }\n\n      this.suffix = editorManager.suffix;\n\n      if (this.settings.base_url) {\n        editorManager._setBaseUrl(this.settings.base_url);\n      }\n\n      this.baseUri = editorManager.baseURI;\n\n      if (this.settings.referrer_policy) {\n        ScriptLoader.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy);\n\n        DOMUtils.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy);\n      }\n\n      AddOnManager.languageLoad = this.settings.language_load;\n      AddOnManager.baseURL = editorManager.baseURL;\n      this.id = id;\n      this.setDirty(false);\n      this.documentBaseURI = new URI(this.settings.document_base_url, {\n        base_uri: this.baseUri\n      });\n      this.baseURI = this.baseUri;\n      this.inline = !!this.settings.inline;\n      this.shortcuts = new Shortcuts(this);\n      this.editorCommands = new EditorCommands(this);\n\n      if (this.settings.cache_suffix) {\n        Env.cacheSuffix = this.settings.cache_suffix.replace(/^[\\?\\&]+/, '');\n      }\n\n      this.ui = {\n        registry: registry(),\n        styleSheetLoader: undefined,\n        show: noop,\n        hide: noop,\n        enable: noop,\n        disable: noop,\n        isDisabled: never\n      };\n      var self = this;\n      var modeInstance = create$5(self);\n      this.mode = modeInstance;\n      this.setMode = modeInstance.set;\n      editorManager.fire('SetupEditor', {\n        editor: this\n      });\n      this.execCallback('setup', this);\n      this.$ = DomQuery.overrideDefaults(function () {\n        return {\n          context: _this.inline ? _this.getBody() : _this.getDoc(),\n          element: _this.getBody()\n        };\n      });\n    }\n\n    Editor.prototype.render = function () {\n      render(this);\n    };\n\n    Editor.prototype.focus = function (skipFocus) {\n      focus$1(this, skipFocus);\n    };\n\n    Editor.prototype.hasFocus = function () {\n      return hasFocus$1(this);\n    };\n\n    Editor.prototype.execCallback = function (name) {\n      var x = [];\n\n      for (var _i = 1; _i < arguments.length; _i++) {\n        x[_i - 1] = arguments[_i];\n      }\n\n      var self = this;\n      var callback = self.settings[name],\n          scope;\n\n      if (!callback) {\n        return;\n      }\n\n      if (self.callbackLookup && (scope = self.callbackLookup[name])) {\n        callback = scope.func;\n        scope = scope.scope;\n      }\n\n      if (typeof callback === 'string') {\n        scope = callback.replace(/\\.\\w+$/, '');\n        scope = scope ? resolve$3(scope) : 0;\n        callback = resolve$3(callback);\n        self.callbackLookup = self.callbackLookup || {};\n        self.callbackLookup[name] = {\n          func: callback,\n          scope: scope\n        };\n      }\n\n      return callback.apply(scope || self, x);\n    };\n\n    Editor.prototype.translate = function (text) {\n      return I18n.translate(text);\n    };\n\n    Editor.prototype.getParam = function (name, defaultVal, type) {\n      return getParam(this, name, defaultVal, type);\n    };\n\n    Editor.prototype.hasPlugin = function (name, loaded) {\n      var hasPlugin = contains(getPlugins(this).split(/[ ,]/), name);\n\n      if (hasPlugin) {\n        return loaded ? PluginManager.get(name) !== undefined : true;\n      } else {\n        return false;\n      }\n    };\n\n    Editor.prototype.nodeChanged = function (args) {\n      this._nodeChangeDispatcher.nodeChanged(args);\n    };\n\n    Editor.prototype.addCommand = function (name, callback, scope) {\n      this.editorCommands.addCommand(name, callback, scope);\n    };\n\n    Editor.prototype.addQueryStateHandler = function (name, callback, scope) {\n      this.editorCommands.addQueryStateHandler(name, callback, scope);\n    };\n\n    Editor.prototype.addQueryValueHandler = function (name, callback, scope) {\n      this.editorCommands.addQueryValueHandler(name, callback, scope);\n    };\n\n    Editor.prototype.addShortcut = function (pattern, desc, cmdFunc, scope) {\n      this.shortcuts.add(pattern, desc, cmdFunc, scope);\n    };\n\n    Editor.prototype.execCommand = function (cmd, ui, value, args) {\n      return this.editorCommands.execCommand(cmd, ui, value, args);\n    };\n\n    Editor.prototype.queryCommandState = function (cmd) {\n      return this.editorCommands.queryCommandState(cmd);\n    };\n\n    Editor.prototype.queryCommandValue = function (cmd) {\n      return this.editorCommands.queryCommandValue(cmd);\n    };\n\n    Editor.prototype.queryCommandSupported = function (cmd) {\n      return this.editorCommands.queryCommandSupported(cmd);\n    };\n\n    Editor.prototype.show = function () {\n      var self = this;\n\n      if (self.hidden) {\n        self.hidden = false;\n\n        if (self.inline) {\n          self.getBody().contentEditable = 'true';\n        } else {\n          DOM$9.show(self.getContainer());\n          DOM$9.hide(self.id);\n        }\n\n        self.load();\n        self.fire('show');\n      }\n    };\n\n    Editor.prototype.hide = function () {\n      var self = this,\n          doc = self.getDoc();\n\n      if (!self.hidden) {\n        if (ie$1 && doc && !self.inline) {\n          doc.execCommand('SelectAll');\n        }\n\n        self.save();\n\n        if (self.inline) {\n          self.getBody().contentEditable = 'false';\n\n          if (self === self.editorManager.focusedEditor) {\n            self.editorManager.focusedEditor = null;\n          }\n        } else {\n          DOM$9.hide(self.getContainer());\n          DOM$9.setStyle(self.id, 'display', self.orgDisplay);\n        }\n\n        self.hidden = true;\n        self.fire('hide');\n      }\n    };\n\n    Editor.prototype.isHidden = function () {\n      return !!this.hidden;\n    };\n\n    Editor.prototype.setProgressState = function (state, time) {\n      this.fire('ProgressState', {\n        state: state,\n        time: time\n      });\n    };\n\n    Editor.prototype.load = function (args) {\n      var self = this;\n      var elm = self.getElement(),\n          html;\n\n      if (self.removed) {\n        return '';\n      }\n\n      if (elm) {\n        args = args || {};\n        args.load = true;\n        var value = isTextareaOrInput(elm) ? elm.value : elm.innerHTML;\n        html = self.setContent(value, args);\n        args.element = elm;\n\n        if (!args.no_events) {\n          self.fire('LoadContent', args);\n        }\n\n        args.element = elm = null;\n        return html;\n      }\n    };\n\n    Editor.prototype.save = function (args) {\n      var self = this;\n      var elm = self.getElement(),\n          html,\n          form;\n\n      if (!elm || !self.initialized || self.removed) {\n        return;\n      }\n\n      args = args || {};\n      args.save = true;\n      args.element = elm;\n      html = args.content = self.getContent(args);\n\n      if (!args.no_events) {\n        self.fire('SaveContent', args);\n      }\n\n      if (args.format === 'raw') {\n        self.fire('RawSaveContent', args);\n      }\n\n      html = args.content;\n\n      if (!isTextareaOrInput(elm)) {\n        if (args.is_removing || !self.inline) {\n          elm.innerHTML = html;\n        }\n\n        if (form = DOM$9.getParent(self.id, 'form')) {\n          each$i(form.elements, function (elm) {\n            if (elm.name === self.id) {\n              elm.value = html;\n              return false;\n            }\n          });\n        }\n      } else {\n        elm.value = html;\n      }\n\n      args.element = elm = null;\n\n      if (args.set_dirty !== false) {\n        self.setDirty(false);\n      }\n\n      return html;\n    };\n\n    Editor.prototype.setContent = function (content, args) {\n      return setContent$2(this, content, args);\n    };\n\n    Editor.prototype.getContent = function (args) {\n      return getContent$2(this, args);\n    };\n\n    Editor.prototype.insertContent = function (content, args) {\n      if (args) {\n        content = extend$3({\n          content: content\n        }, args);\n      }\n\n      this.execCommand('mceInsertContent', false, content);\n    };\n\n    Editor.prototype.resetContent = function (initialContent) {\n      if (initialContent === undefined) {\n        setContent$2(this, this.startContent, {\n          format: 'raw'\n        });\n      } else {\n        setContent$2(this, initialContent);\n      }\n\n      this.undoManager.reset();\n      this.setDirty(false);\n      this.nodeChanged();\n    };\n\n    Editor.prototype.isDirty = function () {\n      return !this.isNotDirty;\n    };\n\n    Editor.prototype.setDirty = function (state) {\n      var oldState = !this.isNotDirty;\n      this.isNotDirty = !state;\n\n      if (state && state !== oldState) {\n        this.fire('dirty');\n      }\n    };\n\n    Editor.prototype.getContainer = function () {\n      var self = this;\n\n      if (!self.container) {\n        self.container = DOM$9.get(self.editorContainer || self.id + '_parent');\n      }\n\n      return self.container;\n    };\n\n    Editor.prototype.getContentAreaContainer = function () {\n      return this.contentAreaContainer;\n    };\n\n    Editor.prototype.getElement = function () {\n      if (!this.targetElm) {\n        this.targetElm = DOM$9.get(this.id);\n      }\n\n      return this.targetElm;\n    };\n\n    Editor.prototype.getWin = function () {\n      var self = this;\n      var elm;\n\n      if (!self.contentWindow) {\n        elm = self.iframeElement;\n\n        if (elm) {\n          self.contentWindow = elm.contentWindow;\n        }\n      }\n\n      return self.contentWindow;\n    };\n\n    Editor.prototype.getDoc = function () {\n      var self = this;\n      var win;\n\n      if (!self.contentDocument) {\n        win = self.getWin();\n\n        if (win) {\n          self.contentDocument = win.document;\n        }\n      }\n\n      return self.contentDocument;\n    };\n\n    Editor.prototype.getBody = function () {\n      var doc = this.getDoc();\n      return this.bodyElement || (doc ? doc.body : null);\n    };\n\n    Editor.prototype.convertURL = function (url, name, elm) {\n      var self = this,\n          settings = self.settings;\n\n      if (settings.urlconverter_callback) {\n        return self.execCallback('urlconverter_callback', url, elm, true, name);\n      }\n\n      if (!settings.convert_urls || elm && elm.nodeName === 'LINK' || url.indexOf('file:') === 0 || url.length === 0) {\n        return url;\n      }\n\n      if (settings.relative_urls) {\n        return self.documentBaseURI.toRelative(url);\n      }\n\n      url = self.documentBaseURI.toAbsolute(url, settings.remove_script_host);\n      return url;\n    };\n\n    Editor.prototype.addVisual = function (elm) {\n      addVisual$1(this, elm);\n    };\n\n    Editor.prototype.remove = function () {\n      remove$7(this);\n    };\n\n    Editor.prototype.destroy = function (automatic) {\n      destroy(this, automatic);\n    };\n\n    Editor.prototype.uploadImages = function (callback) {\n      return this.editorUpload.uploadImages(callback);\n    };\n\n    Editor.prototype._scanForImages = function () {\n      return this.editorUpload.scanForImages();\n    };\n\n    Editor.prototype.addButton = function () {\n      throw new Error('editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead');\n    };\n\n    Editor.prototype.addSidebar = function () {\n      throw new Error('editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead');\n    };\n\n    Editor.prototype.addMenuItem = function () {\n      throw new Error('editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead');\n    };\n\n    Editor.prototype.addContextToolbar = function () {\n      throw new Error('editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead');\n    };\n\n    return Editor;\n  }();\n\n  var DOM$a = DOMUtils.DOM;\n  var explode$4 = Tools.explode,\n      each$j = Tools.each,\n      extend$4 = Tools.extend;\n  var instanceCounter = 0,\n      boundGlobalEvents = false;\n  var beforeUnloadDelegate;\n  var legacyEditors = [];\n  var editors = [];\n\n  var isValidLegacyKey = function (id) {\n    return id !== 'length';\n  };\n\n  var globalEventDelegate = function (e) {\n    var type = e.type;\n    each$j(EditorManager.get(), function (editor) {\n      switch (type) {\n        case 'scroll':\n          editor.fire('ScrollWindow', e);\n          break;\n\n        case 'resize':\n          editor.fire('ResizeWindow', e);\n          break;\n      }\n    });\n  };\n\n  var toggleGlobalEvents = function (state) {\n    if (state !== boundGlobalEvents) {\n      if (state) {\n        DomQuery(window).on('resize scroll', globalEventDelegate);\n      } else {\n        DomQuery(window).off('resize scroll', globalEventDelegate);\n      }\n\n      boundGlobalEvents = state;\n    }\n  };\n\n  var removeEditorFromList = function (targetEditor) {\n    var oldEditors = editors;\n    delete legacyEditors[targetEditor.id];\n\n    for (var i = 0; i < legacyEditors.length; i++) {\n      if (legacyEditors[i] === targetEditor) {\n        legacyEditors.splice(i, 1);\n        break;\n      }\n    }\n\n    editors = filter(editors, function (editor) {\n      return targetEditor !== editor;\n    });\n\n    if (EditorManager.activeEditor === targetEditor) {\n      EditorManager.activeEditor = editors.length > 0 ? editors[0] : null;\n    }\n\n    if (EditorManager.focusedEditor === targetEditor) {\n      EditorManager.focusedEditor = null;\n    }\n\n    return oldEditors.length !== editors.length;\n  };\n\n  var purgeDestroyedEditor = function (editor) {\n    if (editor && editor.initialized && !(editor.getContainer() || editor.getBody()).parentNode) {\n      removeEditorFromList(editor);\n      editor.unbindAllNativeEvents();\n      editor.destroy(true);\n      editor.removed = true;\n      editor = null;\n    }\n\n    return editor;\n  };\n\n  var isQuirksMode = document.compatMode !== 'CSS1Compat';\n\n  var EditorManager = __assign(__assign({}, Observable), {\n    baseURI: null,\n    baseURL: null,\n    defaultSettings: {},\n    documentBaseURL: null,\n    suffix: null,\n    $: DomQuery,\n    majorVersion: '5',\n    minorVersion: '8.2',\n    releaseDate: '2021-06-23',\n    editors: legacyEditors,\n    i18n: I18n,\n    activeEditor: null,\n    focusedEditor: null,\n    settings: {},\n    setup: function () {\n      var self = this;\n      var baseURL,\n          documentBaseURL,\n          suffix = '';\n      documentBaseURL = URI.getDocumentBaseUrl(document.location);\n\n      if (/^[^:]+:\\/\\/\\/?[^\\/]+\\//.test(documentBaseURL)) {\n        documentBaseURL = documentBaseURL.replace(/[\\?#].*$/, '').replace(/[\\/\\\\][^\\/]+$/, '');\n\n        if (!/[\\/\\\\]$/.test(documentBaseURL)) {\n          documentBaseURL += '/';\n        }\n      }\n\n      var preInit = window.tinymce || window.tinyMCEPreInit;\n\n      if (preInit) {\n        baseURL = preInit.base || preInit.baseURL;\n        suffix = preInit.suffix;\n      } else {\n        var scripts = document.getElementsByTagName('script');\n\n        for (var i = 0; i < scripts.length; i++) {\n          var src = scripts[i].src || '';\n\n          if (src === '') {\n            continue;\n          }\n\n          var srcScript = src.substring(src.lastIndexOf('/'));\n\n          if (/tinymce(\\.full|\\.jquery|)(\\.min|\\.dev|)\\.js/.test(src)) {\n            if (srcScript.indexOf('.min') !== -1) {\n              suffix = '.min';\n            }\n\n            baseURL = src.substring(0, src.lastIndexOf('/'));\n            break;\n          }\n        }\n\n        if (!baseURL && document.currentScript) {\n          var src = document.currentScript.src;\n\n          if (src.indexOf('.min') !== -1) {\n            suffix = '.min';\n          }\n\n          baseURL = src.substring(0, src.lastIndexOf('/'));\n        }\n      }\n\n      self.baseURL = new URI(documentBaseURL).toAbsolute(baseURL);\n      self.documentBaseURL = documentBaseURL;\n      self.baseURI = new URI(self.baseURL);\n      self.suffix = suffix;\n      setup$2(self);\n    },\n    overrideDefaults: function (defaultSettings) {\n      var baseUrl = defaultSettings.base_url;\n\n      if (baseUrl) {\n        this._setBaseUrl(baseUrl);\n      }\n\n      var suffix = defaultSettings.suffix;\n\n      if (defaultSettings.suffix) {\n        this.suffix = suffix;\n      }\n\n      this.defaultSettings = defaultSettings;\n      var pluginBaseUrls = defaultSettings.plugin_base_urls;\n\n      if (pluginBaseUrls !== undefined) {\n        each$1(pluginBaseUrls, function (pluginBaseUrl, pluginName) {\n          AddOnManager.PluginManager.urls[pluginName] = pluginBaseUrl;\n        });\n      }\n    },\n    init: function (settings) {\n      var self = this;\n      var result;\n      var invalidInlineTargets = Tools.makeMap('area base basefont br col frame hr img input isindex link meta param embed source wbr track ' + 'colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu', ' ');\n\n      var isInvalidInlineTarget = function (settings, elm) {\n        return settings.inline && elm.tagName.toLowerCase() in invalidInlineTargets;\n      };\n\n      var createId = function (elm) {\n        var id = elm.id;\n\n        if (!id) {\n          id = get$1(elm, 'name').filter(function (name) {\n            return !DOM$a.get(name);\n          }).getOrThunk(DOM$a.uniqueId);\n          elm.setAttribute('id', id);\n        }\n\n        return id;\n      };\n\n      var execCallback = function (name) {\n        var callback = settings[name];\n\n        if (!callback) {\n          return;\n        }\n\n        return callback.apply(self, []);\n      };\n\n      var hasClass = function (elm, className) {\n        return className.constructor === RegExp ? className.test(elm.className) : DOM$a.hasClass(elm, className);\n      };\n\n      var findTargets = function (settings) {\n        var targets = [];\n\n        if (Env.browser.isIE() && Env.browser.version.major < 11) {\n          initError('TinyMCE does not support the browser you are using. For a list of supported' + ' browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/');\n          return [];\n        } else if (isQuirksMode) {\n          initError('Failed to initialize the editor as the document is not in standards mode. ' + 'TinyMCE requires standards mode.');\n          return [];\n        }\n\n        if (settings.types) {\n          each$j(settings.types, function (type) {\n            targets = targets.concat(DOM$a.select(type.selector));\n          });\n          return targets;\n        } else if (settings.selector) {\n          return DOM$a.select(settings.selector);\n        } else if (settings.target) {\n          return [settings.target];\n        }\n\n        switch (settings.mode) {\n          case 'exact':\n            var l = settings.elements || '';\n\n            if (l.length > 0) {\n              each$j(explode$4(l), function (id) {\n                var elm = DOM$a.get(id);\n\n                if (elm) {\n                  targets.push(elm);\n                } else {\n                  each$j(document.forms, function (f) {\n                    each$j(f.elements, function (e) {\n                      if (e.name === id) {\n                        id = 'mce_editor_' + instanceCounter++;\n                        DOM$a.setAttrib(e, 'id', id);\n                        targets.push(e);\n                      }\n                    });\n                  });\n                }\n              });\n            }\n\n            break;\n\n          case 'textareas':\n          case 'specific_textareas':\n            each$j(DOM$a.select('textarea'), function (elm) {\n              if (settings.editor_deselector && hasClass(elm, settings.editor_deselector)) {\n                return;\n              }\n\n              if (!settings.editor_selector || hasClass(elm, settings.editor_selector)) {\n                targets.push(elm);\n              }\n            });\n            break;\n        }\n\n        return targets;\n      };\n\n      var provideResults = function (editors) {\n        result = editors;\n      };\n\n      var initEditors = function () {\n        var initCount = 0;\n        var editors = [];\n        var targets;\n\n        var createEditor = function (id, settings, targetElm) {\n          var editor = new Editor(id, settings, self);\n          editors.push(editor);\n          editor.on('init', function () {\n            if (++initCount === targets.length) {\n              provideResults(editors);\n            }\n          });\n          editor.targetElm = editor.targetElm || targetElm;\n          editor.render();\n        };\n\n        DOM$a.unbind(window, 'ready', initEditors);\n        execCallback('onpageload');\n        targets = DomQuery.unique(findTargets(settings));\n\n        if (settings.types) {\n          each$j(settings.types, function (type) {\n            Tools.each(targets, function (elm) {\n              if (DOM$a.is(elm, type.selector)) {\n                createEditor(createId(elm), extend$4({}, settings, type), elm);\n                return false;\n              }\n\n              return true;\n            });\n          });\n          return;\n        }\n\n        Tools.each(targets, function (elm) {\n          purgeDestroyedEditor(self.get(elm.id));\n        });\n        targets = Tools.grep(targets, function (elm) {\n          return !self.get(elm.id);\n        });\n\n        if (targets.length === 0) {\n          provideResults([]);\n        } else {\n          each$j(targets, function (elm) {\n            if (isInvalidInlineTarget(settings, elm)) {\n              initError('Could not initialize inline editor on invalid inline target element', elm);\n            } else {\n              createEditor(createId(elm), settings, elm);\n            }\n          });\n        }\n      };\n\n      self.settings = settings;\n      DOM$a.bind(window, 'ready', initEditors);\n      return new promiseObj(function (resolve) {\n        if (result) {\n          resolve(result);\n        } else {\n          provideResults = function (editors) {\n            resolve(editors);\n          };\n        }\n      });\n    },\n    get: function (id) {\n      if (arguments.length === 0) {\n        return editors.slice(0);\n      } else if (isString(id)) {\n        return find(editors, function (editor) {\n          return editor.id === id;\n        }).getOr(null);\n      } else if (isNumber(id)) {\n        return editors[id] ? editors[id] : null;\n      } else {\n        return null;\n      }\n    },\n    add: function (editor) {\n      var self = this;\n      var existingEditor = legacyEditors[editor.id];\n\n      if (existingEditor === editor) {\n        return editor;\n      }\n\n      if (self.get(editor.id) === null) {\n        if (isValidLegacyKey(editor.id)) {\n          legacyEditors[editor.id] = editor;\n        }\n\n        legacyEditors.push(editor);\n        editors.push(editor);\n      }\n\n      toggleGlobalEvents(true);\n      self.activeEditor = editor;\n      self.fire('AddEditor', {\n        editor: editor\n      });\n\n      if (!beforeUnloadDelegate) {\n        beforeUnloadDelegate = function (e) {\n          var event = self.fire('BeforeUnload');\n\n          if (event.returnValue) {\n            e.preventDefault();\n            e.returnValue = event.returnValue;\n            return event.returnValue;\n          }\n        };\n\n        window.addEventListener('beforeunload', beforeUnloadDelegate);\n      }\n\n      return editor;\n    },\n    createEditor: function (id, settings) {\n      return this.add(new Editor(id, settings, this));\n    },\n    remove: function (selector) {\n      var self = this;\n      var i, editor;\n\n      if (!selector) {\n        for (i = editors.length - 1; i >= 0; i--) {\n          self.remove(editors[i]);\n        }\n\n        return;\n      }\n\n      if (isString(selector)) {\n        each$j(DOM$a.select(selector), function (elm) {\n          editor = self.get(elm.id);\n\n          if (editor) {\n            self.remove(editor);\n          }\n        });\n        return;\n      }\n\n      editor = selector;\n\n      if (isNull(self.get(editor.id))) {\n        return null;\n      }\n\n      if (removeEditorFromList(editor)) {\n        self.fire('RemoveEditor', {\n          editor: editor\n        });\n      }\n\n      if (editors.length === 0) {\n        window.removeEventListener('beforeunload', beforeUnloadDelegate);\n      }\n\n      editor.remove();\n      toggleGlobalEvents(editors.length > 0);\n      return editor;\n    },\n    execCommand: function (cmd, ui, value) {\n      var self = this,\n          editor = self.get(value);\n\n      switch (cmd) {\n        case 'mceAddEditor':\n          if (!self.get(value)) {\n            new Editor(value, self.settings, self).render();\n          }\n\n          return true;\n\n        case 'mceRemoveEditor':\n          if (editor) {\n            editor.remove();\n          }\n\n          return true;\n\n        case 'mceToggleEditor':\n          if (!editor) {\n            self.execCommand('mceAddEditor', false, value);\n            return true;\n          }\n\n          if (editor.isHidden()) {\n            editor.show();\n          } else {\n            editor.hide();\n          }\n\n          return true;\n      }\n\n      if (self.activeEditor) {\n        return self.activeEditor.execCommand(cmd, ui, value);\n      }\n\n      return false;\n    },\n    triggerSave: function () {\n      each$j(editors, function (editor) {\n        editor.save();\n      });\n    },\n    addI18n: function (code, items) {\n      I18n.add(code, items);\n    },\n    translate: function (text) {\n      return I18n.translate(text);\n    },\n    setActive: function (editor) {\n      var activeEditor = this.activeEditor;\n\n      if (this.activeEditor !== editor) {\n        if (activeEditor) {\n          activeEditor.fire('deactivate', {\n            relatedTarget: editor\n          });\n        }\n\n        editor.fire('activate', {\n          relatedTarget: activeEditor\n        });\n      }\n\n      this.activeEditor = editor;\n    },\n    _setBaseUrl: function (baseUrl) {\n      this.baseURL = new URI(this.documentBaseURL).toAbsolute(baseUrl.replace(/\\/+$/, ''));\n      this.baseURI = new URI(this.baseURL);\n    }\n  });\n\n  EditorManager.setup();\n  var min = Math.min,\n      max = Math.max,\n      round$1 = Math.round;\n\n  var relativePosition = function (rect, targetRect, rel) {\n    var x = targetRect.x;\n    var y = targetRect.y;\n    var w = rect.w;\n    var h = rect.h;\n    var targetW = targetRect.w;\n    var targetH = targetRect.h;\n    var relChars = (rel || '').split('');\n\n    if (relChars[0] === 'b') {\n      y += targetH;\n    }\n\n    if (relChars[1] === 'r') {\n      x += targetW;\n    }\n\n    if (relChars[0] === 'c') {\n      y += round$1(targetH / 2);\n    }\n\n    if (relChars[1] === 'c') {\n      x += round$1(targetW / 2);\n    }\n\n    if (relChars[3] === 'b') {\n      y -= h;\n    }\n\n    if (relChars[4] === 'r') {\n      x -= w;\n    }\n\n    if (relChars[3] === 'c') {\n      y -= round$1(h / 2);\n    }\n\n    if (relChars[4] === 'c') {\n      x -= round$1(w / 2);\n    }\n\n    return create$7(x, y, w, h);\n  };\n\n  var findBestRelativePosition = function (rect, targetRect, constrainRect, rels) {\n    var pos, i;\n\n    for (i = 0; i < rels.length; i++) {\n      pos = relativePosition(rect, targetRect, rels[i]);\n\n      if (pos.x >= constrainRect.x && pos.x + pos.w <= constrainRect.w + constrainRect.x && pos.y >= constrainRect.y && pos.y + pos.h <= constrainRect.h + constrainRect.y) {\n        return rels[i];\n      }\n    }\n\n    return null;\n  };\n\n  var inflate = function (rect, w, h) {\n    return create$7(rect.x - w, rect.y - h, rect.w + w * 2, rect.h + h * 2);\n  };\n\n  var intersect = function (rect, cropRect) {\n    var x1 = max(rect.x, cropRect.x);\n    var y1 = max(rect.y, cropRect.y);\n    var x2 = min(rect.x + rect.w, cropRect.x + cropRect.w);\n    var y2 = min(rect.y + rect.h, cropRect.y + cropRect.h);\n\n    if (x2 - x1 < 0 || y2 - y1 < 0) {\n      return null;\n    }\n\n    return create$7(x1, y1, x2 - x1, y2 - y1);\n  };\n\n  var clamp$1 = function (rect, clampRect, fixedSize) {\n    var x1 = rect.x;\n    var y1 = rect.y;\n    var x2 = rect.x + rect.w;\n    var y2 = rect.y + rect.h;\n    var cx2 = clampRect.x + clampRect.w;\n    var cy2 = clampRect.y + clampRect.h;\n    var underflowX1 = max(0, clampRect.x - x1);\n    var underflowY1 = max(0, clampRect.y - y1);\n    var overflowX2 = max(0, x2 - cx2);\n    var overflowY2 = max(0, y2 - cy2);\n    x1 += underflowX1;\n    y1 += underflowY1;\n\n    if (fixedSize) {\n      x2 += underflowX1;\n      y2 += underflowY1;\n      x1 -= overflowX2;\n      y1 -= overflowY2;\n    }\n\n    x2 -= overflowX2;\n    y2 -= overflowY2;\n    return create$7(x1, y1, x2 - x1, y2 - y1);\n  };\n\n  var create$7 = function (x, y, w, h) {\n    return {\n      x: x,\n      y: y,\n      w: w,\n      h: h\n    };\n  };\n\n  var fromClientRect = function (clientRect) {\n    return create$7(clientRect.left, clientRect.top, clientRect.width, clientRect.height);\n  };\n\n  var Rect = {\n    inflate: inflate,\n    relativePosition: relativePosition,\n    findBestRelativePosition: findBestRelativePosition,\n    intersect: intersect,\n    clamp: clamp$1,\n    create: create$7,\n    fromClientRect: fromClientRect\n  };\n\n  var awaiter = function (resolveCb, rejectCb, timeout) {\n    if (timeout === void 0) {\n      timeout = 1000;\n    }\n\n    var done = false;\n    var timer = null;\n\n    var complete = function (completer) {\n      return function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        if (!done) {\n          done = true;\n\n          if (timer !== null) {\n            clearTimeout(timer);\n            timer = null;\n          }\n\n          completer.apply(null, args);\n        }\n      };\n    };\n\n    var resolve = complete(resolveCb);\n    var reject = complete(rejectCb);\n\n    var start = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (!done && timer === null) {\n        timer = setTimeout(function () {\n          return reject.apply(null, args);\n        }, timeout);\n      }\n    };\n\n    return {\n      start: start,\n      resolve: resolve,\n      reject: reject\n    };\n  };\n\n  var create$8 = function () {\n    var tasks = {};\n    var resultFns = {};\n\n    var load = function (id, url) {\n      var loadErrMsg = 'Script at URL \"' + url + '\" failed to load';\n      var runErrMsg = 'Script at URL \"' + url + '\" did not call `tinymce.Resource.add(\\'' + id + '\\', data)` within 1 second';\n\n      if (tasks[id] !== undefined) {\n        return tasks[id];\n      } else {\n        var task = new promiseObj(function (resolve, reject) {\n          var waiter = awaiter(resolve, reject);\n          resultFns[id] = waiter.resolve;\n          ScriptLoader.ScriptLoader.loadScript(url, function () {\n            return waiter.start(runErrMsg);\n          }, function () {\n            return waiter.reject(loadErrMsg);\n          });\n        });\n        tasks[id] = task;\n        return task;\n      }\n    };\n\n    var add = function (id, data) {\n      if (resultFns[id] !== undefined) {\n        resultFns[id](data);\n        delete resultFns[id];\n      }\n\n      tasks[id] = promiseObj.resolve(data);\n    };\n\n    return {\n      load: load,\n      add: add\n    };\n  };\n\n  var Resource = create$8();\n  var each$k = Tools.each,\n      extend$5 = Tools.extend;\n  var extendClass, initializing;\n\n  var Class = function () {};\n\n  Class.extend = extendClass = function (props) {\n    var self = this;\n    var _super = self.prototype;\n\n    var Class = function () {\n      var i, mixins, mixin;\n      var self = this;\n\n      if (!initializing) {\n        if (self.init) {\n          self.init.apply(self, arguments);\n        }\n\n        mixins = self.Mixins;\n\n        if (mixins) {\n          i = mixins.length;\n\n          while (i--) {\n            mixin = mixins[i];\n\n            if (mixin.init) {\n              mixin.init.apply(self, arguments);\n            }\n          }\n        }\n      }\n    };\n\n    var dummy = function () {\n      return this;\n    };\n\n    var createMethod = function (name, fn) {\n      return function () {\n        var self = this;\n        var tmp = self._super;\n        self._super = _super[name];\n        var ret = fn.apply(self, arguments);\n        self._super = tmp;\n        return ret;\n      };\n    };\n\n    initializing = true;\n    var prototype = new self();\n    initializing = false;\n\n    if (props.Mixins) {\n      each$k(props.Mixins, function (mixin) {\n        for (var name_1 in mixin) {\n          if (name_1 !== 'init') {\n            props[name_1] = mixin[name_1];\n          }\n        }\n      });\n\n      if (_super.Mixins) {\n        props.Mixins = _super.Mixins.concat(props.Mixins);\n      }\n    }\n\n    if (props.Methods) {\n      each$k(props.Methods.split(','), function (name) {\n        props[name] = dummy;\n      });\n    }\n\n    if (props.Properties) {\n      each$k(props.Properties.split(','), function (name) {\n        var fieldName = '_' + name;\n\n        props[name] = function (value) {\n          var self = this;\n\n          if (value !== undefined) {\n            self[fieldName] = value;\n            return self;\n          }\n\n          return self[fieldName];\n        };\n      });\n    }\n\n    if (props.Statics) {\n      each$k(props.Statics, function (func, name) {\n        Class[name] = func;\n      });\n    }\n\n    if (props.Defaults && _super.Defaults) {\n      props.Defaults = extend$5({}, _super.Defaults, props.Defaults);\n    }\n\n    each$1(props, function (member, name) {\n      if (typeof member === 'function' && _super[name]) {\n        prototype[name] = createMethod(name, member);\n      } else {\n        prototype[name] = member;\n      }\n    });\n    Class.prototype = prototype;\n    Class.constructor = Class;\n    Class.extend = extendClass;\n    return Class;\n  };\n\n  var min$1 = Math.min,\n      max$1 = Math.max,\n      round$2 = Math.round;\n\n  var Color = function (value) {\n    var self = {};\n    var r = 0,\n        g = 0,\n        b = 0;\n\n    var rgb2hsv = function (r, g, b) {\n      var h, s, v;\n      h = 0;\n      s = 0;\n      v = 0;\n      r = r / 255;\n      g = g / 255;\n      b = b / 255;\n      var minRGB = min$1(r, min$1(g, b));\n      var maxRGB = max$1(r, max$1(g, b));\n\n      if (minRGB === maxRGB) {\n        v = minRGB;\n        return {\n          h: 0,\n          s: 0,\n          v: v * 100\n        };\n      }\n\n      var d = r === minRGB ? g - b : b === minRGB ? r - g : b - r;\n      h = r === minRGB ? 3 : b === minRGB ? 1 : 5;\n      h = 60 * (h - d / (maxRGB - minRGB));\n      s = (maxRGB - minRGB) / maxRGB;\n      v = maxRGB;\n      return {\n        h: round$2(h),\n        s: round$2(s * 100),\n        v: round$2(v * 100)\n      };\n    };\n\n    var hsvToRgb = function (hue, saturation, brightness) {\n      hue = (parseInt(hue, 10) || 0) % 360;\n      saturation = parseInt(saturation, 10) / 100;\n      brightness = parseInt(brightness, 10) / 100;\n      saturation = max$1(0, min$1(saturation, 1));\n      brightness = max$1(0, min$1(brightness, 1));\n\n      if (saturation === 0) {\n        r = g = b = round$2(255 * brightness);\n        return;\n      }\n\n      var side = hue / 60;\n      var chroma = brightness * saturation;\n      var x = chroma * (1 - Math.abs(side % 2 - 1));\n      var match = brightness - chroma;\n\n      switch (Math.floor(side)) {\n        case 0:\n          r = chroma;\n          g = x;\n          b = 0;\n          break;\n\n        case 1:\n          r = x;\n          g = chroma;\n          b = 0;\n          break;\n\n        case 2:\n          r = 0;\n          g = chroma;\n          b = x;\n          break;\n\n        case 3:\n          r = 0;\n          g = x;\n          b = chroma;\n          break;\n\n        case 4:\n          r = x;\n          g = 0;\n          b = chroma;\n          break;\n\n        case 5:\n          r = chroma;\n          g = 0;\n          b = x;\n          break;\n\n        default:\n          r = g = b = 0;\n      }\n\n      r = round$2(255 * (r + match));\n      g = round$2(255 * (g + match));\n      b = round$2(255 * (b + match));\n    };\n\n    var toHex = function () {\n      var hex = function (val) {\n        val = parseInt(val, 10).toString(16);\n        return val.length > 1 ? val : '0' + val;\n      };\n\n      return '#' + hex(r) + hex(g) + hex(b);\n    };\n\n    var toRgb = function () {\n      return {\n        r: r,\n        g: g,\n        b: b\n      };\n    };\n\n    var toHsv = function () {\n      return rgb2hsv(r, g, b);\n    };\n\n    var parse = function (value) {\n      var matches;\n\n      if (typeof value === 'object') {\n        if ('r' in value) {\n          r = value.r;\n          g = value.g;\n          b = value.b;\n        } else if ('v' in value) {\n          hsvToRgb(value.h, value.s, value.v);\n        }\n      } else {\n        if (matches = /rgb\\s*\\(\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*,\\s*([0-9]+)[^\\)]*\\)/gi.exec(value)) {\n          r = parseInt(matches[1], 10);\n          g = parseInt(matches[2], 10);\n          b = parseInt(matches[3], 10);\n        } else if (matches = /#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(value)) {\n          r = parseInt(matches[1], 16);\n          g = parseInt(matches[2], 16);\n          b = parseInt(matches[3], 16);\n        } else if (matches = /#([0-F])([0-F])([0-F])/gi.exec(value)) {\n          r = parseInt(matches[1] + matches[1], 16);\n          g = parseInt(matches[2] + matches[2], 16);\n          b = parseInt(matches[3] + matches[3], 16);\n        }\n      }\n\n      r = r < 0 ? 0 : r > 255 ? 255 : r;\n      g = g < 0 ? 0 : g > 255 ? 255 : g;\n      b = b < 0 ? 0 : b > 255 ? 255 : b;\n      return self;\n    };\n\n    if (value) {\n      parse(value);\n    }\n\n    self.toRgb = toRgb;\n    self.toHsv = toHsv;\n    self.toHex = toHex;\n    self.parse = parse;\n    return self;\n  };\n\n  var serialize = function (obj) {\n    var data = JSON.stringify(obj);\n\n    if (!isString(data)) {\n      return data;\n    }\n\n    return data.replace(/[\\u0080-\\uFFFF]/g, function (match) {\n      var hexCode = match.charCodeAt(0).toString(16);\n      return '\\\\u' + '0000'.substring(hexCode.length) + hexCode;\n    });\n  };\n\n  var JSONUtils = {\n    serialize: serialize,\n    parse: function (text) {\n      try {\n        return JSON.parse(text);\n      } catch (ex) {}\n    }\n  };\n  var JSONP = {\n    callbacks: {},\n    count: 0,\n    send: function (settings) {\n      var self = this,\n          dom = DOMUtils.DOM,\n          count = settings.count !== undefined ? settings.count : self.count;\n      var id = 'tinymce_jsonp_' + count;\n\n      self.callbacks[count] = function (json) {\n        dom.remove(id);\n        delete self.callbacks[count];\n        settings.callback(json);\n      };\n\n      dom.add(dom.doc.body, 'script', {\n        id: id,\n        src: settings.url,\n        type: 'text/javascript'\n      });\n      self.count++;\n    }\n  };\n\n  var XHR = __assign(__assign({}, Observable), {\n    send: function (settings) {\n      var xhr,\n          count = 0;\n\n      var ready = function () {\n        if (!settings.async || xhr.readyState === 4 || count++ > 10000) {\n          if (settings.success && count < 10000 && xhr.status === 200) {\n            settings.success.call(settings.success_scope, '' + xhr.responseText, xhr, settings);\n          } else if (settings.error) {\n            settings.error.call(settings.error_scope, count > 10000 ? 'TIMED_OUT' : 'GENERAL', xhr, settings);\n          }\n\n          xhr = null;\n        } else {\n          Delay.setTimeout(ready, 10);\n        }\n      };\n\n      settings.scope = settings.scope || this;\n      settings.success_scope = settings.success_scope || settings.scope;\n      settings.error_scope = settings.error_scope || settings.scope;\n      settings.async = settings.async !== false;\n      settings.data = settings.data || '';\n      XHR.fire('beforeInitialize', {\n        settings: settings\n      });\n      xhr = new XMLHttpRequest();\n\n      if (xhr.overrideMimeType) {\n        xhr.overrideMimeType(settings.content_type);\n      }\n\n      xhr.open(settings.type || (settings.data ? 'POST' : 'GET'), settings.url, settings.async);\n\n      if (settings.crossDomain) {\n        xhr.withCredentials = true;\n      }\n\n      if (settings.content_type) {\n        xhr.setRequestHeader('Content-Type', settings.content_type);\n      }\n\n      if (settings.requestheaders) {\n        Tools.each(settings.requestheaders, function (header) {\n          xhr.setRequestHeader(header.key, header.value);\n        });\n      }\n\n      xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n      xhr = XHR.fire('beforeSend', {\n        xhr: xhr,\n        settings: settings\n      }).xhr;\n      xhr.send(settings.data);\n\n      if (!settings.async) {\n        return ready();\n      }\n\n      Delay.setTimeout(ready, 10);\n    }\n  });\n\n  var extend$6 = Tools.extend;\n\n  var JSONRequest = function () {\n    function JSONRequest(settings) {\n      this.settings = extend$6({}, settings);\n      this.count = 0;\n    }\n\n    JSONRequest.sendRPC = function (o) {\n      return new JSONRequest().send(o);\n    };\n\n    JSONRequest.prototype.send = function (args) {\n      var ecb = args.error,\n          scb = args.success;\n      var xhrArgs = extend$6(this.settings, args);\n\n      xhrArgs.success = function (c, x) {\n        c = JSONUtils.parse(c);\n\n        if (typeof c === 'undefined') {\n          c = {\n            error: 'JSON Parse error.'\n          };\n        }\n\n        if (c.error) {\n          ecb.call(xhrArgs.error_scope || xhrArgs.scope, c.error, x);\n        } else {\n          scb.call(xhrArgs.success_scope || xhrArgs.scope, c.result);\n        }\n      };\n\n      xhrArgs.error = function (ty, x) {\n        if (ecb) {\n          ecb.call(xhrArgs.error_scope || xhrArgs.scope, ty, x);\n        }\n      };\n\n      xhrArgs.data = JSONUtils.serialize({\n        id: args.id || 'c' + this.count++,\n        method: args.method,\n        params: args.params\n      });\n      xhrArgs.content_type = 'application/json';\n      XHR.send(xhrArgs);\n    };\n\n    return JSONRequest;\n  }();\n\n  var create$9 = function () {\n    return function () {\n      var data = {};\n      var keys = [];\n      var storage = {\n        getItem: function (key) {\n          var item = data[key];\n          return item ? item : null;\n        },\n        setItem: function (key, value) {\n          keys.push(key);\n          data[key] = String(value);\n        },\n        key: function (index) {\n          return keys[index];\n        },\n        removeItem: function (key) {\n          keys = keys.filter(function (k) {\n            return k === key;\n          });\n          delete data[key];\n        },\n        clear: function () {\n          keys = [];\n          data = {};\n        },\n        length: 0\n      };\n      Object.defineProperty(storage, 'length', {\n        get: function () {\n          return keys.length;\n        },\n        configurable: false,\n        enumerable: false\n      });\n      return storage;\n    }();\n  };\n\n  var localStorage;\n\n  try {\n    var test = '__storage_test__';\n    localStorage = window.localStorage;\n    localStorage.setItem(test, test);\n    localStorage.removeItem(test);\n  } catch (e) {\n    localStorage = create$9();\n  }\n\n  var LocalStorage = localStorage;\n  var publicApi = {\n    geom: {\n      Rect: Rect\n    },\n    util: {\n      Promise: promiseObj,\n      Delay: Delay,\n      Tools: Tools,\n      VK: VK,\n      URI: URI,\n      Class: Class,\n      EventDispatcher: EventDispatcher,\n      Observable: Observable,\n      I18n: I18n,\n      XHR: XHR,\n      JSON: JSONUtils,\n      JSONRequest: JSONRequest,\n      JSONP: JSONP,\n      LocalStorage: LocalStorage,\n      Color: Color,\n      ImageUploader: ImageUploader\n    },\n    dom: {\n      EventUtils: EventUtils,\n      Sizzle: Sizzle,\n      DomQuery: DomQuery,\n      TreeWalker: DomTreeWalker,\n      TextSeeker: TextSeeker,\n      DOMUtils: DOMUtils,\n      ScriptLoader: ScriptLoader,\n      RangeUtils: RangeUtils,\n      Serializer: DomSerializer,\n      StyleSheetLoader: StyleSheetLoader,\n      ControlSelection: ControlSelection,\n      BookmarkManager: BookmarkManager,\n      Selection: EditorSelection,\n      Event: EventUtils.Event\n    },\n    html: {\n      Styles: Styles,\n      Entities: Entities,\n      Node: AstNode,\n      Schema: Schema,\n      SaxParser: SaxParser,\n      DomParser: DomParser,\n      Writer: Writer,\n      Serializer: HtmlSerializer\n    },\n    Env: Env,\n    AddOnManager: AddOnManager,\n    Annotator: Annotator,\n    Formatter: Formatter,\n    UndoManager: UndoManager,\n    EditorCommands: EditorCommands,\n    WindowManager: WindowManager,\n    NotificationManager: NotificationManager,\n    EditorObservable: EditorObservable,\n    Shortcuts: Shortcuts,\n    Editor: Editor,\n    FocusManager: FocusManager,\n    EditorManager: EditorManager,\n    DOM: DOMUtils.DOM,\n    ScriptLoader: ScriptLoader.ScriptLoader,\n    PluginManager: PluginManager,\n    ThemeManager: ThemeManager,\n    IconManager: IconManager,\n    Resource: Resource,\n    trim: Tools.trim,\n    isArray: Tools.isArray,\n    is: Tools.is,\n    toArray: Tools.toArray,\n    makeMap: Tools.makeMap,\n    each: Tools.each,\n    map: Tools.map,\n    grep: Tools.grep,\n    inArray: Tools.inArray,\n    extend: Tools.extend,\n    create: Tools.create,\n    walk: Tools.walk,\n    createNS: Tools.createNS,\n    resolve: Tools.resolve,\n    explode: Tools.explode,\n    _addCacheSuffix: Tools._addCacheSuffix,\n    isOpera: Env.opera,\n    isWebKit: Env.webkit,\n    isIE: Env.ie,\n    isGecko: Env.gecko,\n    isMac: Env.mac\n  };\n  var tinymce = Tools.extend(EditorManager, publicApi);\n\n  var exportToModuleLoaders = function (tinymce) {\n    if (typeof module === 'object') {\n      try {\n        module.exports = tinymce;\n      } catch (_) {}\n    }\n  };\n\n  var exportToWindowGlobal = function (tinymce) {\n    window.tinymce = tinymce;\n    window.tinyMCE = tinymce;\n  };\n\n  exportToWindowGlobal(tinymce);\n  exportToModuleLoaders(tinymce);\n})();","map":{"version":3,"sources":["/Users/emilessung/dev/psy-website/node_modules/tinymce/tinymce.js"],"names":["typeOf","x","undefined","t","Array","prototype","isPrototypeOf","constructor","name","String","isEquatableType","indexOf","sort","xs","compareFn","clone","slice","call","contramap","eqa","f","eq","y","tripleEq","eqString","eqArray","length","len","i","eqSortedArray","eqRecord","kx","Object","keys","ky","q","eqAny","tx","ty","typeOf$1","isType","type","value","isSimpleType","eq$1","a","isString","isObject","isArray","isNull","isBoolean","isUndefined","isNullable","isNonNullable","isFunction","isNumber","noop","compose","fa","fb","args","_i","arguments","apply","compose1","fbc","fab","constant","identity","curry","fn","initialArgs","restArgs","all","concat","not","die","msg","Error","never","always","none","NONE","o","isNone","thunk","id","n","me","fold","_s","is","isSome","getOr","getOrThunk","getOrDie","getOrNull","getOrUndefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","some","constant_a","self","s","v","elementEq","b","from","Optional","nativeSlice","nativeIndexOf","nativePush","push","rawIndexOf","ts","r","contains","pred","eachr","partition","pass","fail","arr","foldr","acc","foldl","findUntil","until","find","findIndex","flatten","reverse","difference","a1","a2","mapToObject","sort$1","comparator","copy","get","head","last","from$1","findMap","hasOwnProperty","each$1","obj","props","k","map$1","tupleMap","tuple","objAcc","internalFilter","onTrue","onFalse","bifilter","filter$1","mapToArray","values","get$1","key","has","hasNonNullableKey","equal","isArray$1","array","l","each$2","cb","map$2","callback","out","item","index","filter$2","indexOf$1","reduce","collection","iteratee","accumulator","thisArg","findIndex$1","predicate","last$1","__assign","assign","p","__rest","e","getOwnPropertySymbols","propertyIsEnumerable","__spreadArrays","il","j","jl","cached","called","DeviceType","os","browser","userAgent","mediaMatch","isiPad","isiOS","test","isiPhone","isMobile","isAndroid","isTouch","isTablet","isPhone","iOSwebview","isSafari","isDesktop","isWebView","firstMatch","regexes","find$1","agent","major","minor","group","Number","replace","nu","detect","versionRegexes","cleanedAgent","toLowerCase","unknown","Version","detect$1","candidates","candidate","search","detectBrowser","browsers","version","current","detectOs","oses","UaString","removeFromStart","str","numChars","substring","checkRange","substr","start","removeLeading","prefix","startsWith","contains$1","blank","trim","lTrim","rTrim","isNotEmpty","normalVersionRegex","checkContains","target","uastring","PlatformInfo","edge","chrome","ie","opera","firefox","safari","unknown$1","nu$1","info","isBrowser","isEdge","isChrome","isIE","isOpera","isFirefox","Browser","windows","ios","android","linux","osx","solaris","freebsd","chromeos","unknown$2","nu$2","isOS","isWindows","isOSX","isLinux","isSolaris","isFreeBSD","isChromeOS","OperatingSystem","detect$2","deviceType","PlatformDetection","query","window","matchMedia","matches","platform","navigator","detect$3","platform$1","webkit","fileApi","URL","createObjectURL","windowsPhone","Env","gecko","mac","iOS","contentEditable","transparentSrc","caretAfter","range","getSelection","documentMode","document","ceFalse","cacheSuffix","container","experimentalShadowDom","canHaveCSP","desktop","whiteSpaceRegExp","trim$1","makeMap","items","delim","split","hasOwnProperty$1","prop","create","root","sp","scn","c","de","exec","cn","match","ns","createNS","onCreate","extend","resolve","parent","static","exts","ext","name_1","walk","explode","d","_addCacheSuffix","url","Tools","grep","inArray","hasOwn","fromHtml","html","scope","doc","div","createElement","innerHTML","hasChildNodes","childNodes","console","error","fromDom","fromTag","tag","node","fromText","text","createTextNode","dom","fromPoint","docElm","elementFromPoint","SugarElement","toArray$1","recurse","cur","compareDocumentPosition","documentPositionContainedBy","Node","DOCUMENT_POSITION_CONTAINED_BY","COMMENT","DOCUMENT","DOCUMENT_FRAGMENT","ELEMENT","TEXT","is$1","element","selector","nodeType","elem","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","bypassSelector","childElementCount","base","querySelectorAll","one","querySelector","eq$2","e1","e2","regularContains","d1","d2","ieContains","contains$2","Global","Function","nodeName","isType$1","isComment","isElement","isText","isDocument","isDocumentFragment","owner","ownerDocument","documentOrOwner","dos","documentElement","defaultView","parentNode","parents","isRoot","stop","ret","rawParent","siblings","filterSelf","elements","children","prevSibling","previousSibling","nextSibling","prevSiblings","nextSiblings","child","cs","firstChild","lastChild","childNodesCount","getHead","isShadowRoot","host","supported","Element","attachShadow","getRootNode","isSupported","getStyleContainer","getShadowRoot","getShadowHost","getOriginalEventTarget","event","el","isOpenShadowHost","composed","composedPath","shadowRoot","before","marker","parent$1","insertBefore","after","sibling","append","prepend","firstChild$1","appendChild","wrap","wrapper","before$1","append$1","empty","textContent","rogue","remove","removeChild","unwrap","children$1","inBody","body","left","top","translate","SugarPosition","boxPosition","box","getBoundingClientRect","firstDefinedOrZero","absolute","win","offsetLeft","offsetTop","scrollTop","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","viewport","get$2","_DOC","to","scrollTo","intoView","alignToTop","scrollIntoViewIfNeeded","scrollIntoView","get$3","_win","bounds","width","height","right","bottom","getBounds","scroll","clientWidth","clientHeight","visualViewport","Math","max","pageLeft","pageTop","isNodeType","isRestrictedNode","getPrototypeOf","isElement$1","matchNodeNames","names","lowercasedNames","matchStyleValues","cssValue","computed","getComputedStyle","getPropertyValue","hasAttribute","attrName","hasAttributeValue","attrValue","getAttribute","isBogus","isBogusAll","isTable","tagName","hasContentEditableState","isTextareaOrInput","isText$1","isComment$1","isDocument$1","isDocumentFragment$1","isBr","isImg","isContentEditableTrue","isContentEditableFalse","isTableCell","isMedia","isSupported$1","style","rawSet","setAttribute","set","setAll","attrs","get$4","getOpt","has$1","remove$1","removeAttribute","attributes","attr","internalSet","property","setProperty","setAll$1","css","get$5","styles","getUnsafeProperty","getRaw","raw","getAllRaw","ruleName","reflow","offsetWidth","browser$1","firstElement","nodes","getTableCaptionDeltaY","elm","caption","bodyTop","captionTop","captionHeight","offsetHeight","hasChild","getPos","rootElm","offsetParent","pos","exports$1","module$1","exports","define","module","require","amd","g","global","EphoxContactWrapper","u","code","process","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","setTimeout","clearTimeout","runTimeout","fun","runClearTimeout","queue","draining","currentQueue","queueIndex","cleanUpNextTick","drainQueue","timeout","run","nextTick","Item","title","env","argv","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","setImmediate","setTimeoutFunc","Promise","TypeError","_state","_handled","_value","_deferreds","doResolve","handle","deferred","_immediateFn","onFulfilled","onRejected","reject","promise","newValue","then","finale","_unhandledRejectionFn","Handler","done","reason","ex","prom","remaining","res","val","race","err","warn","_setImmediateFn","_setUnhandledRejectionFn","clearImmediate","immediateIds","nextImmediateId","Timeout","setInterval","clearInterval","close","clearFn","_id","_clearFn","unref","ref","enroll","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","onTimeout","_onTimeout","onNextTick","promisePolyfill","boltExport","nu$3","baseFn","data","callbacks","nCallback","isReady","cbs","pure","LazyValue","errorReporter","make","aFutureB","toPromise","anonBind","futureB","toLazy","toCached","cache","nu$4","pure$1","Future","par","asyncValues","count","asyncValue","par$1","futures","_opt","_f","mapError","_","onValue","toOptional","isValue","isError","message","opt","onError","fromOption","Result","generate","cases","constructors","adt","acase","keys$1","argLength","branches","branchKeys","join","allReqd","reqKey","foldArgs","log","label","params","Adt","comparison","bothErrors","firstError","secondError","bothValues","unite","result","ClosestOrAncestor","ancestor","closest","child$1","ancestor$1","descendant","closest$1","asap","immediateFn","catch","promiseObj","requestAnimationFramePromise","requestAnimationFrame","requestAnimationFrameFunc","vendors","featurefill","wrappedSetTimeout","time","wrappedSetInterval","wrappedClearTimeout","wrappedClearInterval","debounce","timer","func","Delay","setEditorTimeout","editor","removed","setEditorInterval","throttle","StyleSheetLoader","documentOrShadowRoot","settings","idCount","loadedStates","edos","maxLoadTime","_setReferrerPolicy","referrerPolicy","addStyle","removeStyle","styleContainer","getOrCreateState","passed","failed","load","success","failure","link","urlWithSuffix","state","status","onload","onerror","wait","testCallback","waitCallback","Date","now","startTime","waitForWebKitLinkLoaded","styleSheets","styleSheet","ownerNode","linkElem","rel","contentCssCors","loadF","loadAll","urls","parts","unload","unloadAll","create$1","WeakMap","forElement","referenceElement","rootDom","sl","instance","DomTreeWalker","startNode","rootNode","next","prev","prev2","shallow","findSibling","findPreviousNode","startName","siblingName","blocks","tableCells","tableSections","textBlocks","headings","listItems","lists","wsElements","lazyLookup","lookup","isHeading","isBlock","isTable$1","isInline","isBr$1","isTextBlock","isList","isListItem","isTableSection","isTableCell$1","isWsPreserveElement","ancestor$2","zeroWidth","nbsp","isZwsp","char","removeZwsp","ZWSP","isZwsp$1","trim$2","isElement$2","isText$2","isCaretContainerBlock","isCaretContainerInline","isCaretContainer","hasContent","insertInline","textNode","startsWithCaretContainer","splitText","endsWithCaretContainer","isBeforeInline","charAt","offset","isAtStart","isAfterInline","isAtEnd","createBogusBr","br","insertBlock","blockName","blockNode","trimBogusBr","brs","getElementsByTagName","lastBr","showCaretContainerBlock","caretContainer","isRangeInCaretContainerBlock","startContainer","isContentEditableTrue$1","isContentEditableFalse$1","isBr$2","isText$3","isInvalidTextElement","isAtomicInline","isTable$2","isCaretContainer$1","isCaretCandidate","isNonUiContentEditableFalse","isUnselectable","isInEditable","isAtomicContentEditableFalse","isAtomic","isEditableCaretCandidate","whiteSpaceRegExp$1","isWhitespaceText","hasWhitespacePreserveParent","rootElement","isWhitespace","isNamedAnchor","isContent","isBookmark","isBogus$1","isBogusAll$1","isEmptyNode","targetNode","skipBogus","brCount","walker","isEmpty","isSpan","isInlineContent","surroundedByInlineContent","prevIsInline","nextIsInline","isBookmarkNode","isKeepTextNode","isKeepElement","isDocument$2","trimNode","currentChildren","makeMap$1","attrsCharsRegExp","textCharsRegExp","rawCharsRegExp","entityRegExp","asciiMap","baseEntities","reverseEntities","nativeDecode","innerText","buildEntitiesLookup","radix","chr","entity","fromCharCode","parseInt","namedEntities","encodeRaw","encodeAllRaw","encodeNumeric","charCodeAt","encodeNamed","entities","getEncodeFunc","entitiesMap","encodeNamedAndNumeric","encodeCustomNamed","nameMap","named","numeric","decode","Entities","mapCache","dummyObj","makeMap$2","each$3","extend$1","explode$1","compileSchema","schema","globalAttributes","blockContent","phrasingContent","flowContent","html4BlockContent","html4PhrasingContent","add","ni","attributesOrder","arrayToMap","addAttrs","schemaItem","table","script","compileElementMap","mode","toUpperCase","Schema","patternElements","customElementsMap","specialElements","createLookupTable","option","defaultValue","extendWith","schemaItems","verify_html","valid_elements","validStyles","valid_styles","invalidStyles","invalid_styles","validClasses","valid_classes","whiteSpaceElementsMap","selfClosingElementsMap","shortEndedElementsMap","boolAttrMap","nonEmptyOrMoveCaretBeforeOnEnter","nonEmptyElementsMap","moveCaretBeforeOnEnterElementsMap","textBlockElementsMap","blockElementsMap","textInlineElementsMap","special","RegExp","patternToRegExp","addValidElements","validElements","ei","ai","al","attrData","elementName","attrType","outputName","globalAttributesOrder","elementRuleRegExp","attrRuleRegExp","hasPatternsRegExp","validElementsArr","paddEmpty","removeEmpty","removeEmptyAttrs","attributesRequired","required","splice","attributesDefault","attributesForced","forcedValue","validValues","attributePatterns","pattern","setValidElements","addCustomElements","customElements","customElementRegExp","text_block_elements","block_elements","rule","inline","cloneName","customRule","elmName","addValidChildren","validChildren","childRuleRegExp","getElementRule","custom_elements","valid_children","extended_valid_elements","dd","dt","li","td","th","tr","tbody","thead","tfoot","legend","area","param","parentsRequired","invalid_elements","getValidStyles","getInvalidStyles","getValidClasses","getBoolAttrs","getBlockElements","getTextBlockElements","getTextInlineElements","getShortEndedElements","getSelfClosingElements","getNonEmptyElements","getMoveCaretBeforeOnEnterElements","getWhiteSpaceElements","getSpecialElements","isValidChild","isValid","attrPatterns","getCustomElements","toHex","hex","Styles","_this","rgbRegExp","urlOrStrRegExp","styleRegExp","trimRightRegExp","encodingLookup","invisibleChar","encodingItems","color","parse","isEncoded","urlConverter","url_converter","urlConverterScope","url_converter_scope","compress","suffix","noJoin","canCompress","compress2","encode","keepSlashes","decodeSingleHexSequence","escSeq","decodeHexSequences","processUrl","url2","url3","str2","allow_script_urls","scriptUrl","allow_svg_data_urls","lastIndex","border","serialize","serializeStyles","styleList","i_1","styleMap","eventExpandoPrefix","mouseEventRe","deprecated","keyLocation","layerX","layerY","returnValue","webkitMovementX","webkitMovementY","keyIdentifier","mozPressure","hasIsDefaultPrevented","isDefaultPrevented","returnTrue","returnFalse","addEvent","capture","addEventListener","attachEvent","removeEvent","removeEventListener","detachEvent","isMouseEvent","fix","originalEvent","srcElement","pageX","clientX","eventDoc","pageY","clientY","preventDefault","defaultPrevented","stopPropagation","cancelBubble","isPropagationStopped","stopImmediatePropagation","isImmediatePropagationStopped","metaKey","bindOnReady","eventUtils","domLoaded","isDocReady","readyState","readyHandler","EventUtils","events","expando","hasMouseEnterLeave","hasFocusIn","callbackList","fakeName","nativeHandler","defaultNativeHandler","evt","executeHandlers","namesList","mouseEnterLeave","currentTarget","related","relatedTarget","unbind","ci","eventMap","fire","parentWindow","clean","destroy","cancel","Event","support","Expr","getText","isXML","tokenize","compile","select","outermostContext","sortInput","hasDuplicate","setDocument","document$1","docElem","documentIsHTML","rbuggyQSA","rbuggyMatches","contains$3","preferredDoc","dirruns","classCache","createCache","tokenCache","compilerCache","sortOrder","strundefined","MAX_NEGATIVE","pop","push_native","indexOf$2","booleans","whitespace","identifier","pseudos","rtrim","rcomma","rcombinators","rattributeQuotes","rpseudo","ridentifier","matchExpr","ID","CLASS","TAG","ATTR","PSEUDO","CHILD","bool","needsContext","rinputs","rheader","rnative","rquickExpr","rsibling","rescape","runescape","funescape","escaped","escapedWhitespace","high","els","Sizzle","context","results","seed","m","groups","old","nid","newContext","newSelector","getElementById","getElementsByClassName","qsa","toSelector","testContext","qsaError","cacheLength","shift","markFunction","siblingCheck","diff","sourceIndex","createInputPseudo","createButtonPseudo","createPositionalPseudo","argument","matchIndexes","hasCompare","getTop","getById","attrId","tmp","className","disconnectedMatch","adown","bup","compare","sortDetached","aup","ap","bp","unshift","expr","matchesSelector","attrHandle","getAttributeNode","specified","uniqueSort","duplicates","detectDuplicates","sortStable","nodeValue","selectors","createPseudo","relative","first","preFilter","excess","unquoted","nodeNameSelector","operator","check","what","simple","forward","ofType","xml","outerCache","nodeIndex","useCache","pseudo","setFilters","idx","matched","input","matcher","unmatched","lang","elemLang","hash","location","focus","activeElement","hasFocus","href","tabIndex","enabled","disabled","checked","selected","selectedIndex","header","button","even","odd","lt","gt","nth","filters","parseOnly","tokens","soFar","preFilters","addCombinator","combinator","checkNonElements","doneName","oldCache","newCache","elementMatcher","matchers","multipleContexts","contexts","condense","newUnmatched","mapped","setMatcher","postFilter","postFinder","postSelector","temp","preMap","postMap","preexisting","elems","matcherIn","matcherOut","matcherFromTokens","checkContext","leadingRelative","implicitRelative","matchContext","matchAnyContext","matcherFromGroupMatchers","elementMatchers","setMatchers","bySet","byElement","superMatcher","outermost","matchedCount","setMatched","contextBackup","dirrunsUnique","random","token","compiled","push$1","slice$1","rquickExpr$1","skipUniques","isDefined","isString$1","isWindow","createFragment","fragDoc","frag","createDocumentFragment","domManipulate","targetNodes","sourceItem","getElementDocument","DomQuery","makeArray","hasClass","wrap$1","lastParent","newWrapper","cloneNode","numericCssMap","booleanMap","propFix","for","class","readonly","cssFix","float","attrHooks","cssHooks","DomQueryConstructor","init","inArray$1","whiteSpaceRegExp$2","trim$3","each$4","unique","hook","removeAttr","camel","dashed","removeProperty","currentStyle","appendTo","prependTo","replaceWith","content","wrapAll","wrapInner","contents","addClass","toggleClass","removeClass","classState","existingClassName","trigger","show","hide","object","sibling$1","firstSibling","contentDocument","contentWindow","wrappedResult","parentsUntil","nextUntil","prevUntil","overrideDefaults","defaults","sub","each$5","grep$1","simpleSelectorRe","setupAttrHooks","getContext","keepValues","keep_values","keepUrlHook","$elm","src","updateInternalStyleAttr","rawValue","findNodeIndex","normalized","lastNodeType","DOMUtils","addedStyles","files","counter","stdMode","boxModel","styleSheetLoader","boundEvents","ownEvents","$","getRoot","$$","getAttrib","defaultVal","getAttribs","setAttrib","originalValue","onSetAttrib","attrElm","deep","clone_1","root_element","getViewPort","argWin","vp","w","h","getPos$1","setStyle","update_styles","setStyles","stylesArg","getStyle","getSize","getRect","size","elms","getParents","collect","selectorVal","getParent","_findSib","getNext","getPrev","setAttribs","setHTML","canHaveHTML","parentElm","newElm","createHTML","outHtml","keepChildren","$node","removeAllAttribs","removeAttributeNode","parseStyle","cssText","serializeStyle","styleElm","DOM","loadCSS","cls","isHidden","uniqueId","getOuterHTML","outerHTML","setOuterHTML","insertAfter","reference","referenceNode","oldElm","replaceChild","rename","attrNode","findCommonAncestor","ps","pe","rgbVal","isNonEmptyElement","bogusVal","createRng","createRange","splitElm","replacementElm","beforeFragment","afterFragment","setStart","setEnd","extractContents","rv","output","getContentEditable","getContentEditableParent","isChildOf","dumpRng","startOffset","endContainer","endOffset","each$6","grep$2","QUEUED","LOADING","LOADED","FAILED","ScriptLoader","states","scriptLoadedCallbacks","queueLoadedCallbacks","loading","loadScript","cleanup","isDone","markDone","loadQueue","loadScripts","scripts","failures","execCallbacks","loadingScripts","notifyCallbacks","Cell","initial","isRaw","isTokenised","currentCode","getLanguageData","getData","setCode","newCode","getCode","langData","translation","getLangData","textstr","removeContext","values_1","substitued","$1","$2","isRtl","hasCode","I18n","AddOnManager","_listeners","runListeners","matchedListeners","listener","dependencies","requireLangPack","languages","languageLoad","waitFor","language","wrappedLanguages","addOn","addOnConstructor","createUrl","baseUrl","dep","resource","addComponents","pluginName","pluginUrl","loadDependencies","addOnUrl","deps","newUrl","urlString","baseURL","lastIndexOf","PluginManager","ThemeManager","rate","last$2","read","add$1","remove$2","supports","classList","get$6","add$2","clazz","remove$3","add$3","cleanClass","remove$4","has$2","descendants","descendants$1","annotation","dataAnnotation","dataAnnotationId","identify","annotationName","rng","selection","getRng","getBody","an","newStart","getAttr","uid","findMarkers","isAnnotation","findAll","markers","directory","nodesAlready","setup","_registry","changeCallbacks","initData","previous","withCallbacks","updateCallbacks","callbackMap","outputData","fireCallbacks","fireNoAnnotation","onNodeChange","annotations","_a","setup$1","registry","identifyParserNode","span","serializer","addNodeFilter","spans","persistent","create$2","register","generate$1","date","getTime","floor","add$4","classes","fromHtml$1","get$7","set$1","owner$1","docDom","fragment","contentElements","clone$1","original","isDeep","TextWalker","isBoundary","direction","TextSeeker","isBlockBoundary","newOffset","backwards","forwards","cat","lift2","oa","ob","lift3","oc","someIf","round","clone$2","rect","collapse","toStart","isEqual","rect1","rect2","isValidOverflow","overflowY","min","isAbove","halfHeight","isBelow","containsXY","getSelectedNode","getNode","extendingChars","isExtendingChar","ch","and","isElement$3","isCaretCandidate$1","isBlock$1","isFloated","isValidElementCaretCandidate","isNotPre","isText$4","isBr$3","resolveIndex","isWhiteSpace","isRange","isHiddenWhiteSpaceRange","getBrClientRect","brNode","nbsp$1","clientRect","getBoundingClientRectWebKitText","sc","ec","so","eo","newRng","cloneRange","setEndAfter","isZeroRect","clientRects","getClientRects","collapseAndInflateWidth","newClientRect","getCaretPositionClientRects","caretPosition","beforeNode","addUniqueAndValidRect","addCharacterOffset","CaretPosition","toRange","isVisible","fromRangeStart","fromRangeEnd","pos1","pos2","isTextPosition","isElementPosition","trimEmptyTextNode","insertNode","insertFragment","rangeInsertNode","isText$5","isBogus$2","nodeIndex$1","normalizedParent","getChildNodes","normalizedTextOffset","equal$1","normalizedNodeIndex","numTextFragments","createPathItem","create$3","path","outputOffset","resolvePathItem","findTextPosition","targetOffset","dataLen","resolve$1","paths","isContentEditableFalse$2","getNormalizedTextOffset","trimmedOffset","getPoint","point","getLocation","bookmark","isCollapsed","end","findIndex$2","moveEndPoint","normalizeTableCellSelection","findAdjacentContentEditableFalseElm","getOffsetBookmark","getCaretBookmark","getRangeBookmark","createBookmarkSpan","filled","getPersistentBookmark","collapsed","rng2","endBookmarkNode","startBookmarkNode","moveToBookmark","keep","getBookmark","getUndoBookmark","DOM$1","defaultPreviewStyles","getBodySetting","getParam","bodyObj","getIframeAttrs","getDocType","getDocumentBaseUrl","getBodyId","getBodyClass","getContentSecurityPolicy","shouldPutBrInPre","getForcedRootBlock","block","getForcedRootBlockAttrs","getBrNewLineSelector","getNoNewLineSelector","shouldKeepStyles","shouldEndContainerOnEmptyBlock","getFontStyleValues","getFontSizeClasses","getImagesDataImgFilter","isAutomaticUploadsEnabled","shouldReuseFileName","shouldReplaceBlobUris","getIconPackName","getIconsUrl","getImageUploadUrl","getImageUploadBasePath","getImagesUploadCredentials","getImagesUploadHandler","shouldUseContentCssCors","getReferrerPolicy","getLanguageCode","getLanguageUrl","shouldIndentUseMargin","getIndentation","getContentCss","contentCss","getFontCss","fontCss","getDirectionality","getInlineBoundarySelector","getObjectResizing","getResizeImgProportional","getPlaceholder","getElement","getEventRoot","getServiceMessage","getTheme","shouldValidate","isInlineBoundariesEnabled","getFormats","getPreviewStyles","canFormatEmptyLines","getCustomUiSelector","getThemeUrl","isInline$1","hasHiddenInput","shouldPatchSubmit","isEncodingXml","shouldAddFormSubmitTrigger","shouldAddUnloadTrigger","hasForcedRootBlock","getCustomUndoRedoLevels","shouldDisableNodeChange","isReadOnly","hasContentCssCors","getPlugins","getExternalPlugins","shouldBlockUnsupportedDrop","isVisualAidsEnabled","getVisualAidsTableClass","getVisualAidsAnchorClass","isElement$4","isText$6","removeNode","trimCount","trimmedText","deleteZwspChars","deleteData","removeUnchanged","remove$5","removeTextAndReposition","removeElementAndReposition","newPosition","removeTextCaretContainer","removeElementCaretContainer","removeAndReposition","caretContainerNode","browser$2","isContentEditableFalse$3","isMedia$1","isTableCell$2","inlineFakeCaretSelector","getAbsoluteClientRect","scrollX","scrollY","margin","rootRect","trimInlineCaretContainers","fakeCaretTargetNodes","FakeCaret","lastVisualCaret","cursorInterval","rootBlock","caretBlock","caret","caretState","startBlink","isInlineFakeCaretTarget","reposition","getCss","isFakeCaretTableBrowser","isFakeCaretTarget","isContentEditableFalse$4","isMedia$2","isBlockLike","isCaretContainer$2","isCaretContainerBlock$1","isElement$5","isCaretCandidate$2","isForwards","isBackwards","skipCaretContainers","findNode","predicateFn","isCefOrCaretContainer","getParentBlock","isInSameBlock","caretPosition1","caretPosition2","getChildNodeAtRelativeOffset","relativeOffset","beforeAfter","setStartBefore","setEndBefore","setStartAfter","isNodesInSameBlock","node1","node2","lean","before$2","after$1","normalizeRange","leanLeft","leanRight","getRelativeCefElm","getNormalizedRangeEndPoint","normalizedRange","getElementFromPosition","getElementFromPrevPosition","getVisualCaretPosition","walkFn","isMoveInsideSameBlock","inSameBlock","HDirection","isContentEditableFalse$5","isText$7","isElement$6","isBr$4","isCaretCandidate$3","isAtomic$1","isEditableCaretCandidate$1","nodeAtIndex","getCaretCandidatePosition","moveForwardFromBr","nextNode","findCaretPosition","Forwards","startPos","innerNode","rootContentEditableFalseElm","CaretWalker","Backwards","walkToPositionIn","position","fromPosition","afterElement","isBeforeOrStart","isAfterOrEnd","isBeforeAfterSameElement","isAtBr","shouldSkipPosition","navigate","navigateIgnore","ignoreFilter","positionIn","nextPosition","prevPosition","firstPositionIn","lastPositionIn","CARET_ID","isCaretNode","getParentCaretContainer","isStringPathBookmark","isRangeBookmark","isIdBookmark","isIndexBookmark","isPathBookmark","addBogus","resolveCaretPositionBookmark","insertZwsp","isEmpty$1","tryFindRangePosition","padEmptyCaretContainer","setEndPoint","isValidTextNode","restoreEndPoint","appendData","resolvePaths","resolveId","endPos","spos","epos","resolveIndex$1","selectNode","resolve$2","getBookmark$1","setRng","isBookmarkNode$1","is$2","expected","actual","isNbsp","isWhiteSpace$1","isContent$1","isNode","isInlineBlock","moveStart","isWhiteSpaceNode","getNonWhiteSpaceSibling","inc","nextName","isTextBlock$1","ed","allowSpaces","isEmptyTextNode","replaceVars","vars","isEq","str1","normalizeStyleValue","getTextDecoration","decoration","getParents$1","isVariableFormatName","formatName","hasVariableValues","format","isVariableValue","field","fieldValues","formatter","areSimilarFormats","otherFormatName","validKeys","filterObj","validKey","fmt1","filteredFmt1","fmt2","filteredFmt2","isBlockFormat","isSelectorFormat","isInlineFormat","hasBlockChildren","isBookmarkNode$2","getParents$2","isWhiteSpaceNode$1","isTextBlock$2","isBogusBr","findParentContentEditable","walkText","findSpace","findContent","findWordEndPoint","includeTrailingSpaces","lastTextNode","textSeeker","textOffset","spaceResult","findSelectorEndPoint","curFormat","findBlockEndPoint","scopeRoot","isAtBlockBoundary","findParentContainer","block_expand","isSelfOrParentBookmark","expandRng","includeTrailingSpace","startPoint","endPoint","expand","clampToExistingChildren","getEndChild","walk$1","exclude","collectSiblings","endNode","findEndPoint","walkBoundary","parent_1","siblings_1","getRanges","ranges","rangeCount","getRangeAt","getSelectedNodes","hasMultipleRanges","getCellsFromRanges","getCellsFromElement","getCellsFromElementOrRanges","selectedCells","getCellsFromEditor","getSel","getStartNode","getEndNode","getFirstChildren","getLastChildren","hasAllContentsSelected","moveEndPoint$1","hasAnyRanges","sel","runOnRanges","executor","fakeSelectionNodes","fakeNodeRng","preserve","fillBookmark","NodeValue","getOption","api","get$8","isZeroWidth","wrapName","applyWordGrab","makeAnnotation","eDoc","decorate","_b","master","_c","_d","_e","annotate","newWrappers","getDoc","finishWrapper","getOrOpenWrapper","processElements","processElement","ctx","processNodes","annotateWithBookmark","undoManager","transact","initialRng","hasFakeSelection","selectionRng","Annotator","changes","annotationChanged","getAll","BookmarkManager","getContentEditableRoot","isXYWithinRange","firePreProcess","firePostProcess","fireRemove","fireDetach","fireSwitchMode","fireObjectResizeStart","origin","fireObjectResized","firePreInit","firePostRender","fireInit","firePlaceholderToggle","fireError","errorType","VK","BACKSPACE","DELETE","DOWN","ENTER","LEFT","RIGHT","SPACEBAR","TAB","UP","PAGE_UP","PAGE_DOWN","END","HOME","modifierPressed","shiftKey","ctrlKey","altKey","metaKeyPressed","isContentEditableFalse$6","ControlSelection","elementSelectionAttr","selectedElm","selectedElmGhost","resizeHelper","selectedHandle","resizeBackdrop","startX","startY","selectedElmX","selectedElmY","startW","startH","ratio","resizeStarted","editableDoc","rootDocument","abs","startScrollWidth","startScrollHeight","resizeHandles","nw","ne","se","sw","isImage","isEventOnImageOutsideRange","touch","touches","contextMenuSelectImage","getResizeTargets","firstElementChild","isResizable","createGhostElement","setSizeProp","targets","setGhostElmSize","ghostElm","resizeGhostElement","deltaX","deltaY","proportional","resizeHelperX","resizeHelperY","screenX","screenY","display","scrollWidth","scrollHeight","endGhostResize","wasResizeStarted","showResizeRect","nodeChanged","targetElm","unbindResizeHandleEvents","targetWidth","targetHeight","hideResizeRect","selectedValue","handleElm","startDrag","updateResizeRect","startElm","controlElm","isChildOrEqual","img","disableGeckoResize","getStart","getEnd","isWithinContentEditableFalse","execCommand","handleMSControlSelect_1","delayedSelect","throttledUpdateResizeRect","composing","hasCeProperty","findParent","findClosestIeRange","rects","createTextRange","moveToElementText","moveToPoint","moveOutOfContentEditableFalse","parentElement","fromPoint$1","pointDoc","caretPositionFromPoint","offsetNode","caretRangeFromPoint","isEq$1","rng1","findParent$1","hasParent","hasParentWithName","isTable$3","isTableCell$3","isCeFalseCaretContainer","hasBrBeforeAfter","isPrevNode","hasContentEditableFalseParent","findTextNodeRelative","isAfterNode","lastInlineElement","parentBlockContainer","normalizeEndPoint","directionLeft","normalize","normRng","split$1","RangeUtils","normalize$1","normalizedRng","compareRanges","getCaretRangeFromPoint","Dimension","getOffset","parseFloat","getOuter","aggregate","properties","isNaN","cumulativeInclusions","absoluteMax","api$1","get$9","walkUp","navigation","frame","view","rest","pathTo","frameElement","Navigation","freeze","__proto__","find$2","frames","loc","excludeFromDescend","fireScrollIntoViewEvent","scrollEvent","fireAfterScrollIntoViewEvent","descend","markerInfo","cleanupFun","createMarker","elementMarker","withMarker","preserveWith","applyWithMarker","withScrollEvents","withElement","startElement","endElement","scrollToMarker","viewHeight","intoWindowIfNeeded","viewportBottom","markerTop","markerBottom","largerThanViewport","align","intoWindow","innerHeight","intoFrame","frameViewHeight","op","viewportBounds","rangeIntoWindow","elementIntoWindow","rangeIntoFrame","elementIntoFrame","scrollElementIntoView","scroller","scrollRangeIntoView","getDocument","create$4","soffset","finish","foffset","SimRange","cata","subject","onBefore","onOn","onAfter","situ","before$3","after$2","Situ","adt$1","domRange","exact","exactFromRange","simRange","getStart$1","startSitu","_finishSitu","_soffset","_finish","_foffset","getWin","SimSelection","browser$3","clamp","normalizeRng","isOrContains","isRngInRoot","shouldStore","nativeRangeToSelectionRange","readRange","getBookmark$2","validate","bookmarkToNativeRng","store","newBookmark","storeNative","restore","isEditorUIElement","FocusManager","isManualNodeChange","selectionChange","registerPageMouseUp","throttledStore","mouseUpPage","registerFocusOut","registerMouseUp","registerEditorEvents","documentFocusInHandler","DOM$2","isEditorUIElement$1","isEditorContentAreaElement","isUIElement","customSelector","getActiveElement","registerEvents","editorManager","focusedEditor","setActive","blurredEditor","activeEditor","unregisterDocumentEvents","setup$2","getContentEditableHost","getCollapsedNode","getFocusInElement","normalizeSelection","caretPos","focusBody","hasElementFocus","hasIframeFocus","iframeElement","hasInlineFocus","rawBody","hasUiFocus","hasFocus$1","hasEditorOrUiFocus","focusEditor","quirks","refreshContentEditable","bookmarkRng","contentEditableHost","activateEditor","focus$1","skipFocus","getEndpointElement","real","getStart$2","skipEmptyTextNodes","orig","getNode$1","commonAncestorContainer","getSelectedBlocks","endElm","selectedBlocks","select$1","processRanges","typeLookup","walk$2","isEmptyTextNode$1","AstNode","insert","selfAttrs","cloneAttrs","selfAttr","shortEnded","refNode","extractBase64DataUris","dataImageUri","chunks","uris","uri","imageId","re","restoreDataUris","parseDataUri","decodeURIComponent","safeSvgDataUrlElements","isValidPrefixAttrName","blockSvgDataUris","allowSvgDataUrls","allowed","isInvalidUri","allow_html_data_urls","findEndTagIndex","startIndex","shortEndedElements","tokenRegExp","isConditionalComment","findCommentEndIndex","lcHtml","endIfIndex","endIndex","endCommentRegexp","checkBogusAttribute","regExp","attrString","SaxParser","fix_self_closing","comment","cdata","pi","doctype","parseInternal","base64Extract","endRegExp","stack","attrList","textData","isInternalElement","isShortEnded","elementRule","isValidElement","attribsValue","validAttributesMap","validAttributePatterns","anyAttributesRequired","filteredUrlAttrs","scriptUriRegExp","parsingMode","processEndTag","valid","processText","processComment","allow_conditional_comments","processAttr","processMalformedComment","startTag","parseAttribute","val2","val3","attrRule","trimRegExp","fillAttrsMap","unescape","attrRegExp","selfClosing","self_closing_elements","removeInternalElements","remove_internals","fixSelfClosing","processHtml","matchText","bogusValue","isValidCdataSection","preserve_cdata","findEndTag","trimHtml","tempAttrs","trimContentRegExp","trimInternal","bogusAllRegExp","endTagIndex","matchLength","getTempAttrs","trimExternal","trimEmptyContents","emptyRegExp","getContentFromBody","getInner","no_events","getContentInternal","each$7","ElementUtils","attribs","compareObjects","obj1","obj2","makeMap$3","Writer","indent","indentBefore","indent_before","indentAfter","indent_after","entity_encoding","htmlOutput","element_format","reset","getContent","HtmlSerializer","writer","handlers","handler","sortedAttrs","inner","nonInheritableStyles","Set","nonInheritableStylesArr","shorthandStyleProps","getStyleProps","isNonInheritableStyle","hasInheritableStyles","getLonghandStyleProps","hasStyleConflict","nodeStyleProps","parentNodeStyleProps","valueMismatch","parentValue","nodeStyleProp","propExists","longhandProps","isChar","delta","isBeforeSpace","isAfterSpace","isEmptyText","matchesElementPosition","isImageBlock","isCefNode","isBeforeImageBlock","isAfterImageBlock","isBeforeMedia","isAfterMedia","isBeforeTable","isAfterTable","isBeforeContentEditableFalse","isAfterContentEditableFalse","getLastChildren$1","rawNode","removeTrailingBr","allBrs","fillWithPaddingBr","trimBlockTrailingBr","lastChildPrevSibling","dropLast","parentsUntil$1","parents$1","parentsAndSelf","navigateIgnoreEmptyTextNodes","getClosestBlock","isAtBeforeAfterBlockBoundary","newPos","fromBlock","isAtBlockBoundary$1","isAtStartOfBlock","isAtEndOfBlock","isBeforeBlock","isAfterBlock","isBr$5","findBr","parentBlocks","isBeforeBr","isAfterBr","findPreviousBr","findNextBr","isInMiddleOfText","getClosestBlock$1","hasSpaceBefore","hasSpaceAfter","isPreValue","isInPre","isAtBeginningOfBody","isAtEndOfBody","isAtLineBoundary","needsToHaveNbsp","needsToBeNbspLeft","needsToBeNbspRight","needsToBeNbsp","isNbspAt","hasNbsp","normalizeNbspMiddle","chars","normalizeNbspAtStart","firstPos","normalizeNbspInMiddleOfTextNode","newText","normalizeNbspAtEnd","lastPos","normalizeNbsps","normalizeNbspsInEditor","normalizeContent","isStartOfContent","isEndOfContent","previousCharIsSpace","replaceData","normalizeWhitespaceAfter","whitespaceCount","normalizeWhitespaceBefore","mergeTextNodes","prevNode","normalizeWhitespace","mergeToPrev","whitespaceOffset","newNode","insertData","needsReposition","beforeOrStartOf","afterOrEndOf","getPreviousSiblingCaretPosition","getNextSiblingCaretPosition","findCaretPositionBackwardsFromElm","startPosition","findCaretPositionForwardsFromElm","findCaretPositionBackwards","findCaretPositionForward","findCaretPosition$1","findCaretPosOutsideElmAfterDelete","setSelection","eqRawNode","isBlock$2","paddEmptyBlock","deleteNormalized","afterDeletePosOpt","prevTextOpt","nextTextOpt","isInlineElement","deleteElement","moveCaret","afterDeletePos","parentBlock","normalizedAfterDeletePos","setContent","setCursorLocation","paddPos","tableCellRng","tableSelection","cells","deleteAction","removeTable","emptyCells","deleteCellSelection","isRootFromElement","getClosestCell","getClosestTable","cell","isExpandedCellRng","cellRng","getTableFromCellRng","startParentTable","endParentTable","isSingleCellTable","rows","getTableCells","getCellRng","startCell","endCell","getCellRangeFromStartTable","partialSelection","isWithinSameTable","getTableSelectionFromCellRng","getTableSelection","optCellRng","cRng","getCellIndex","getSelectedCells","isSingleCellTableContentSelected","getAction","getActionFromRange","freefallRtl","deleteCellContents","deleteContents","lastNode","lastBlock","additionalCleanupNodes","deleteTableElement","deleteCellRange","action","deleteCaptionRange","emptyElement","deleteTableRange","getParentCaption","deleteRange","getParentCell","deleteBetweenCells","fromCell","toCell","isDeleteOfLastCharPos","fromCaption","emptyCaretCaption","validateCaretCaption","toCaption","deleteCaretInsideCaption","deleteCaretCells","deleteCaretCaption","isNearTable","isBeforeOrAfterTable","fromPos","deleteCaret","backspaceDelete","createRange$1","normalizeBlockSelectionRange","newEndPos","normalize$2","hasOnlyOneChild","isPaddingNode","isPaddedEmptyBlock","blockElements","isEmptyFragmentElement","nonEmptyElements","isListFragment","cleanupDomFragment","domFragment","toDomFragment","listItems$1","isPadding","isListItemPadded","isEmptyOrPadded","trimListItems","getParentLi","isParentBlockLi","getSplit","beforeRng","afterRng","cloneContents","findFirstIn","caretWalker","newCaretPos","findLastOf","insertMiddle","insertAtCaret","liTarget","liElms","BEGINNING","isAt","trimOrPadLeftRight","isTableCell$4","isTableCellContentSelected","validInsertion","trimBrsFromTableCell","reduceInlineTextElements","merge","textInlineElements","root_1","elementUtils_1","styleConflict","markFragmentElements","unmarkFragmentElements","isPartOfFragment","canHaveChildren","moveSelectionToMarker","nextRng","getContentEditableFalseParent","parentEditableFalseElm","findNextCaretRng","deleteSelectedContent","insertHtmlAtCaret","details","parser","bookmarkHtml","paste","caretElement","parserArgs","_selectionOverrides","showBlockCaretContainer","invalid","addVisual","traverse","findMatchingNodes","nodeFilters","attributeFilters","nodeMatches","attrMatches","name_2","filter$3","defaultFormat","isTreeNode","moveSelection","setEditorHtml","setContentString","forcedRootBlockName","padd","isRootContent","setContentTree","getNodeFilters","getAttributeFilters","setContentInternal","sibling$2","ensureIsRoot","ancestor$3","transform","transformed","closest$2","isEq$2","matchesUnInheritedFormatSelector","formatList","inherit","matchParents","matchNode","matchName","matchItems","itemName","similar","onmatch","matchAll","matchedFormatNames","checkedMap","closest$3","rawElm","canApply","defaultBlock","matchAllOnNode","formatNames","matchSimilar","ZWSP$1","CARET_ID$1","importNode","getEmptyCaretContainers","isCaretContainerEmpty","findFirstTextNode","createCaretContainer","fill","trimZwspFromCaretContainer","removeCaretContainerNode","removeCaretContainer","insertCaretContainerNode","formatNode","appendNode","insertFormatNodesIntoCaretContainer","formatNodes","innerMostFormatNode","cleanFormatNode","validFormats","matchedFormats","uniqueFormats","fmtName","clonedFormatNode","applyCaretFormat","wordcharRegex","removeCaretFormat","hasContentAfter","expandedRng","newCaretContainer","cleanedFormatNode","caretTextNode","disableCaretContainer","keyCode","setup$3","replaceWithCaretFormat","innerMost","isFormatElement","inlineElements","isEmptyCaretFormatElement","postProcessHooks","filter$4","each$8","addPostProcessHook","hooks","postProcess","hasPreSibling","pre","isPre","joinPre","pre1","pre2","each$9","isElementNode","findElementSibling","mergeSiblingsNodes","tmpSibling","elementUtils","mergeSiblings","merge_siblings","clearChildStyles","clear_child_styles","links","processChildElements","unwrapEmptySpan","hasStyle","applyStyle","removeResult","MCE_ATTR_RE","each$a","isEq$3","isTableCellOrRow","isChildOfInlineParent","getContainer","lastIdx","normalizeTableSelection","childNode","wrap$2","wrapWithSiblings","matchName$1","isColorFormatAndAnchor","find$3","removeNode$1","rootBlockElm","forcedRootBlock","list_block","forced_root_block_attrs","removeFormatInternal","compareNode","stylesModified","preserve_attributes","attrsToPreserve","remove_similar","valueOut","removeFormat","newName","findFormatRoot","formatRoot","removeFormatFromClone","wrapAndSplit","lastClone","firstClone","formatRootParent","mixed","remove$6","splitToFormatRoot","isRemoveBookmarkNode","lastContentEditable","removeRngStyle","textDecorations","textDecoration","ceFalseOverride","each$b","mergeTextDecorationsAndColor","processTextDecorationsAndColor","mergeBackgroundColorAndFontSize","backgroundColor","mergeSubSup","mergeWithChildren","mergeWithParents","merge_with_parents","each$c","hasFormatProperty","isElementNode$1","canFormatBR","parentName","validBRParentElements","figcaption","summary","hasCaretNodeSibling","applyFormat","setElementFormat","fmt","onformat","styleVal","applyNodeStyle","found","applyRngStyle","nodeSpecific","wrapElm","currentWrapElm","getChildCount","getChildElementNode","mergeStyles","childCount","formatItem","curSelNode","firstFormat","forced_root_block","fake","setup$4","registeredFormatListeners","currentFormats","updateAndFireChangeCallbacks","formatChangeData","formatsList","newFormats","remainingFormats","filterRemainingFormats","addListeners","formats","formatChangeItems","removeListeners","formatChangedInternal","toggle","fromElements","tableModel","tableRow","cellPosition","getSpan","fillout","rowspan","colspan","y2","x2","cellExists","skipCellsX","getWidth","row","findElementPos","extractRows","sx","sy","ey","newRows","subTable","createDomTable","tableElement","tableBody","modelRowsToDomRows","fromDom$1","tableElm","toDom","subsection","findParentListContainer","getFullySelectedListWrappers","_li","listCont","listElm","listStyles","_style","wrap$3","innerElm","wrapped","directListWrappers","commonAnchorContainer","getWrapElements","wrapElements","listWrappers","allWrappers","emptyFragment","getFragmentFromRange","getParentTable","getTableFragment","selectedTableCells","firstCell","lastCell","fullTableModel","sectionedTableModel","getSelectionFragment","read$1","trimLeadingCollapsibleText","isCollapsibleWhitespace","getInnerText","bin","shouldTrim","getContextNodeName","parentBlockOpt","getTextContent","contextNodeName","shouldTrimSpaces","nonRenderedText","parentBlockText","textIndex","hasProceedingSpace","hasTrailingSpace","getSerializedContent","tmpElm","contextual","getSelectedContentInternal","KEEP","INSERT","vDown","vUp","snake","diag","buildScript","start1","end1","start2","end2","middle","getMiddleSnake","i2","buildSnake","sum","getOuterHtml","createFragment$1","insertAt","removeAt","applyDiff","read$2","write","fragments","currentFragments","undoLevelDocument","lazyTempDocument","implementation","createHTMLDocument","hasIframes","createFragmentedLevel","beforeBookmark","createCompleteLevel","createFromEditor","trimmedFragments","trimmed","applyToEditor","level","getLevelContent","getCleanLevelContent","hasEqualContent","level1","level2","hasEqualCleanedContent","isEq$4","isUnlocked","locks","setTyping","typing","endTyping","endTypingLevelIgnoreLocks","beforeChange","addUndoLevel","currentLevel","lastLevel","bm","customUndoRedoLevels","setDirty","clear","extra","callback1","callback2","redo","undo","hasUndo","hasRedo","ignore","addVisualInternal","hasVisual","matchedElm","value_1","cls_1","makePlainAdaptor","formatChanged","insertContent","getModel","makeRtcAdaptor","rtcEditor","defaultVars","unsupported","_undoManager","_locks","_index","_node","_similar","_rfl","_format","_details","getRawModel","makeNoopAdaptor","nul","isRtc","plugins","getRtcSetup","rtcPlugin","setup$5","editorCast","rtcInstance","rtc","isRemote","getRtcInstanceWithFallback","getRtcInstanceWithError","beforeChange$1","addUndoLevel$1","undo$1","redo$1","clear$1","reset$1","hasUndo$1","hasRedo$1","transact$1","ignore$1","extra$1","matchFormat","matchAllFormats","matchNodeFormat","canApplyFormat","closestFormat","applyFormat$1","removeFormat$1","toggleFormat","getSelectedContent","getContent$1","walkPastBookmark","outer","outerElm","oldLength","normalizeTextIfRequired","mergeAndNormalizeText","outerNode","normalizer","innerTextNode","rngSetContent","prevText","nextText","setupArgs","cleanContent","contextBlock","contextArgs","setContent$1","contentArgs","createContextualFragment","deleteFromCallbackMap","newCallbacks","SelectorChanged","selectorChangedData","currentSelectors","selectorChangedWithUnbind","matchedSelectors","isNativeIeSelection","isAttachedToDom","isValidRange","EditorSelection","selectedRange","explicitRange","getRng$1","getEnd$1","bookmarkManager","compareEndPoints","tryCompareBoundaryPoints","how","sourceRange","destinationRange","compareBoundaryPoints","anchorNode","START_TO_START","END_TO_END","ieRange","removeAllRanges","addRange","setBaseAndExtent","focusNode","setNode","getSelectedBlocks$1","isForward","anchorRange","anchorOffset","focusRange","focusOffset","selectorChanged","getScrollContainer","scrollContainer","placeCaretAt","controlSelection","removeAttrs","addFontToSpansFilter","domParser","fontSizes","face","addStrikeToSpanFilter","addFilters","convert_fonts_to_spans","font_size_legacy_values","register$1","inline_styles","blobUriToBlob","rejectWithError","xhr_1","XMLHttpRequest","open","responseType","response","send","parseDataUri$1","uriParts","buildBlob","atob","Uint8Array","Blob","dataUriToBlob","uriToBlob","blobToDataUri","blob","reader","FileReader","onloadend","readAsDataURL","imageToBlobInfo","blobCache","base64","blobInfo","getByUri","image","dataUri","getByData","getAllImages","ImageScanner","uploadStatus","cachedPromises","images","isUploaded","promises","imageInfo","newPromise","paddEmptyNode","brPreferred","padd_empty_with_br","isPaddedWithNbsp","hasOnlyChild","isPadded","isEmpty$2","whitespaceElements","isLineBreakNode","isBogusImage","isInternalImageSource","isValidDataImg","images_dataimg_filter","imgElem_1","Image","registerBase64ImageFilter","blob_cache","processImage","inputSrc","blobUri","addAttributeFilter","register$2","remove_trailing_brs","prevName","whiteSpaceElements","appendRel","addNoOpener","newRel","allow_unsafe_link_target","allow_html_in_named_anchor","fix_list_elements","classValue","validClassesMap","makeMap$4","each$d","explode$2","extend$2","DomParser","matchedNodes","matchedAttributes","root_name","fixInvalidChildren","newParent","currentNode","tempNode","nonSplitableElements","textBlockElements","fixed","filterNode","list","fi","fl","invalidChildren","isInWhiteSpacePreservedElement","getRootBlockName","rootBlockName","startWhiteSpaceRegExp","endWhiteSpaceRegExp","allWhiteSpaceRegExp","isAllWhiteSpaceRegExp","addRootBlocks","rootBlockNode","createNode","removeWhitespaceBefore","textNodeNext","textVal","cloneAndExcludeBlocks","attrFiltersLen","register$3","htmlParser","internalName","hasChildren","trimTrailingBr","brNode1","brNode2","preProcess","oldDoc","impl","shouldFireEvent","hasEventListeners","addTempAttr","postProcess$1","outArgs","getHtmlFromNode","parseHtml","serializeNode","htmlSerializer","toHtml","DomSerializerImpl","addRules","rules","setRules","DomSerializer","domSerializer","defaultFormat$1","getContent$2","setContent$2","DOM$3","restoreOriginalStyles","orgDisplay","safeDestroy","clearDomReferences","contentAreaContainer","formElement","editorContainer","bodyElement","restoreForm","form","_mceOldSubmit","submit","formEventDelegate","remove$7","editorUpload","save","is_removing","unbindAllNativeEvents","automatic","destroyed","_beforeUnload","theme","hasOwnProperty$2","deep$1","bothObjects","deepMerge","baseMerge","merger","objects","curObject","sectionResult","sections","deviceDetection","legacyMobilePlugins","defaultTouchSettings","table_grid","object_resizing","resize","normalizePlugins","pluginNames","trimmedPlugins","filterLegacyMobilePlugins","extractSections","getSection","sectionSettings","hasSection","isSectionTheme","section","getSectionConfig","getToolbarMode","getDefaultSettings","documentBaseUrl","baseDefaults","toolbar_mode","document_base_url","add_form_submit_trigger","submit_patch","add_unload_trigger","convert_urls","relative_urls","remove_script_host","visual","hidden_input","convertURL","getDefaultMobileSettings","mobileSettings","defaultMobileSettings","toolbar_sticky","defaultPhoneSettings","menubar","getExternalPlugins$1","overrideSettings","userDefinedExternalPlugins","external_plugins","combinePlugins","forcedPlugins","getPlatformPlugins","isMobileDevice","desktopPlugins","mobilePlugins","processPlugins","defaultOverrideSettings","forced_plugins","mobileConfig","platformPlugins","combinedPlugins","isOnMobile","combineSettings","defaultSettings","defaultDeviceSettings","mobile","extendedSettings","getEditorSettings","getFiltered","getParamObject","isArrayOf","CreateIconManager","iconPack","icons","IconManager","getProp","propName","getComputedSizeProp","getClientWidth","getClientHeight","getMarginTop","getMarginLeft","getBoundingClientRect$1","isInsideElementContentArea","bodyElm","transpose","isXYInContentArea","transposedPoint","fromDomSafe","isEditorAttachedToDom","rawContainer","getContentAreaContainer","NotificationManagerImpl","unimplemented","getArgs","NotificationManager","notifications","getImplementation","getNotificationManagerImpl","getTopNotification","progressBar","addNotification","notification","closeNotification","otherNotification","spec","fireEvent","getEl","getNotifications","serviceMessage","WindowManagerImpl","openUrl","alert","confirm","getParams","setParams","WindowManager","dialogs","getWindowManagerImpl","funcBind","fireOpenEvent","dialog","fireCloseEvent","addDialog","closeDialog","otherDialog","getTopDialog","storeSelectionAndOpenDialog","openDialog","windowManagerImpl","displayNotification","notificationManager","displayError","_skinLoaded","uploadError","logError","createLoadError","pluginLoadError","iconsLoadError","languageLoadError","pluginInitError","initError","isContentCssSkinName","getContentCssUrls","transformToUrls","getFontCssUrls","cssLinks","skinUrl","contentCssFile","documentBaseURI","toAbsolute","appendContentCssFromSettings","contentCSS","UploadStatus","PENDING","UPLOADED","blobUriStatuses","createStatus","resultUri","hasBlobUri","getResultUri","isPending","markPending","markUploaded","removeFailed","count$1","rnd","uuid","BlobCache","mimeToExt","mime","mimes","filename","toBlobInfo","findFirst","cachedBlobInfo","removeByUri","revokeObjectURL","Uploader","pendingPromises","pathJoin","path1","path2","defaultHandler","progress","xhr","withCredentials","credentials","upload","onprogress","loaded","total","json","JSON","responseText","basePath","formData","FormData","noUpload","handlerSuccess","handlerFailure","options","resolvePending","uploadBlobInfo","openNotification","closeNotification_1","failureOptions","percent","isDefaultHandler","pendingUploadBlobInfo","uploadBlobs","blobInfos","createUploader","ImageUploader","uploader","showNotification","UploadChangeHandler","lastChangedLevel","fireIfChanged","EditorUpload","imageScanner","urlFilters","changeHandler","aliveGuard","cacheInvalidator","replaceString","replaceImageUrl","targetUrl","replacementUrl","replacementString","replaceUrlInUndoStack","replaceImageUriInView","uploadImages","scanForImages","imageInfos","imagesToRemove","filteredResult","uploadInfo","uploadUri","uploadImagesAuto","isValidDataUriImage","imgElm","dataImgFilter","addFilter","resultItem","replaceBlobUris","source_view","get$a","valigntop","verticalAlign","valignmiddle","valignbottom","alignleft","preview","textAlign","aligncenter","marginLeft","marginRight","alignright","alignjustify","bold","fontWeight","italic","fontStyle","underline","strikethrough","forecolor","hilitecolor","fontname","fontFamily","fontsize","fontSize","lineheight","lineHeight","fontsize_class","blockquote","subscript","superscript","_fmt","_itemName","removeformat","FormatRegistry","unregister","each$e","parsedSelectorToHtml","ancestry","sItem","getRequiredParent","elmRule","wrapInHtml","parentCandidate","ancestorName","parentRequired","siblingElm","parseSelectorItem","$0","$3","$4","parseSelector","getCssText","previewFrag","previewCss","parentFontSize","previewStyles","removeVars","previewOpt","previewElm","numValue","setup$6","addShortcut","Formatter","formatChangeState","registerEvents$1","isFirstTypedCharacter","addNonTypingUndoLevel","cmd","command","isDirty","modKey","isInsertReplacementText","inputType","isInsertTextDataNull","isInsertFromPasteOrDrop","addKeyboardShortcuts","UndoManager","nonTypingKeycodes","placeholderAttr","isKeyboardEvent","isDeleteEvent","isNonTypingKeyboardEvent","isTypingKeyboardEvent","isVisuallyEmpty","isForcedRootBlockFalse","setup$7","placeholder","updatePlaceholder","showPlaceholder","isPlaceholderShown","strongRtl","hasStrongRtl","isInlineTarget","isRtl$1","findInlineParents","findRootInline","hasSameParentBlock","block1","block2","isAtZwsp","normalizePosition","normalizeForwards","normalizeBackwards","isBeforeRoot","getParentBlock$1","placeCaretInEmptyBody","paddEmptyBody","willDeleteLastPositionInElement","normalizedFirstPos","normalizedLastPos","normalizedFromPos","nextPos","prevPos","blockPosition","blockBoundary","getBlockPosition","containerElm","isDifferentBlocks","hasSameParent","parent1","parent2","isEditable","skipLastBr","lastPositionInBlock","readFromRange","fromBlockPos","toBlockPos","blockPos","read$3","getChildrenUntilBlockBoundary","extractChildren","removeEmptyRoot","isEmptyBefore","nestedBlockMerge","toBlock","insertionPoint","sidelongBlockMerge","findInsertionPoint","parentsAndSelf$1","getInsertionPoint","trimBr","mergeBlockInto","mergeBlocks","backspaceDelete$1","deleteRangeMergeBlocks","isRawNodeInTable","isSelectionInTable","isEverythingSelected","noPrevious","noNext","emptyEditor","deleteRange$1","backspaceDelete$2","_forward","isContentEditableTrue$2","isContentEditableFalse$7","showCaret","getNodeRange","renderCaretAtRange","caretPositionNode","caretPositionBeforeNode","ceRoot","renderRangeCaret","isBeforeBoundary","isAfterBoundary","trimEmptyTextNode$1","deleteContentAndShowCaret","peekCaretPosition","caretRange","deleteBoundaryText","getNextPosFn","isBeforeFn","nextCaretPosition","backspaceDelete$3","isCompoundElement","DeleteAction","moveToElement","moveToPosition","isAtContentEditableBlockCaret","caretLocation","isDeleteFromCefDifferentBlocks","deleteEmptyBlockOrMoveToCef","toCefElm","blockElm","findCefPosition","getContentEditableBlockAction","skipMoveToActionFromInlineCefToContent","getContentEditableAction","read$4","deleteElement$1","hideFakeCaret","getAncestorCe","backspaceDeleteCaret","selectedNode","deleteOffscreenSelection","backspaceDeleteRange","hasCefAncestor","paddEmptyElement","backspaceDelete$4","deleteCaret$1","backspaceDelete$5","isText$8","startsWithCaretContainer$1","endsWithCaretContainer$1","createZwsp","insertBefore$1","insertAfter$1","insertInline$1","insertInlineBefore","insertInlineAfter","insertInlinePos","isPosCaretContainer","caretNode","renderCaret","evaluateUntil","fns","Location","rescope","before$4","nPos","isNotInsideFormatCaretContainer","findInsideRootInline","after$3","isValidLocation","readLocation","getName","outside","inside","isEq$5","location1","location2","betweenInlines","fromInline","toInline","skipNoMovement","fromLocation","toLocation","findLocationTraverse","findLocationSimple","findLocation","prevLocation","nextLocation","hasSelectionModifyApi","modify","moveRel","moveByWord","BreakType","flip","positions","walk$3","getBreakType","currentPos","Br","Block","Wrap","getPositionsUntil","breakType","breakAt","Eol","getAdjacentLinePositions","getPositionsUntilBreak","findClosestHorizontalPositionFromPoint","lastRect","newRect","lastDist","newDist","findClosestHorizontalPosition","targetRect","getPositionsUntilPreviousLine","getPositionsUntilNextLine","isAtFirstLine","isAtLastLine","getPositionsAbove","getPositionsBelow","getFirstLinePositions","getLastLinePositions","getNodeClientRects","toArrayWithNode","VDirection","findUntil$1","walkUntil","isAboveFn","isBeflowFn","line","targetClientRect","aboveLineNumber","lineNumber","isLineNumber","upUntil","Up","downUntil","Down","positionsUntil","isBelowFn","getClientRect","isAboveLine","isLine","isContentEditableFalse$8","findNode$1","distanceToRectLeft","distanceToRectRight","isInsideX","isInsideY","findClosestClientRect","oldClientRect","oldDistance","newDistance","walkUntil$1","includeChildren","findLineNodeRects","targetNodeRect","checkPosFn","lineRects","getFakeCaretTargets","caretInfo","closestFakeCaret","fakeTargetNodeRects","targetNodeRects","closestNodeRect","moveToRange","renderRangeCaretOpt","moveHorizontally","isBefore","isAfter","rangeIsInContainerBlock","moveVertically","caretClientRect","walkerFn","linePositions","nextLinePositions","nextLineRect","dist1","dist2","caretPositions","closestNextLineRect","getLineEndPoint","moveToLineEndPoint","setCaretPosition","setSelected","renderCaretLocation","findLocation$1","isInlineTarget$1","toggleInlines","inlineBoundaries","selectedInlines","targetInlines","safeRemoveCaretContainer","renderInsideInlineCaret","inlines","_inline","move","moveWord","_caret","setupSelectedState","moveNextWord","movePrevWord","moveToLineEndPoint$1","linePoint","outsideLoc","rangeFromPositions","hasOnlyTwoOrLessPositionsLeft","setCaretLocation","deleteFromTo","rescope$1","backspaceDeleteCollapsed","toPosition","backspaceDelete$6","getParentInlines","hasOnlyOneChild$1","deleteLastPosition","parentInlines","isFormatElement$1","deleteCaret$2","backspaceDelete$7","deleteElement$2","deleteCaret$3","isNearMedia","deleteRange$2","backspaceDelete$8","isEditable$1","parseIndentValue","number","getIndentStyleName","useMargin","indentStyleName","indentElement","unit","styleValue","validateBlocks","intentValue","canOutdent","getBlocksToIndent","isListComponent","parentIsListComponent","indentation","indentUnit","indentValue","queryCommandState","backspaceDelete$9","nativeCommand","deleteCommand","forwardDeleteCommand","setup$8","addCommand","SIGNIFICANT_MOVE","LONGPRESS_DELAY","getTouch","isFarEnough","distX","distY","setup$9","startData","longpressFired","debounceLongpress","isEqualNode","isBlockElement","isValidTarget","hasBlockParent","shouldRemoveTextNode","rootNodeName","restoreSelection","setup$a","findBlockCaretContainer","removeIeControlRect","blockCaretContainer","handleBlockContainer","setup$b","isContentEditableFalse$9","moveToCeFalseHorizontally","moveToCeFalseVertically","createTextBlock","textBlock","exitPreBlock","getVisualCaretPosition$1","newBlock","getHorizontalRange","getVerticalRange","down","moveH","newRange","moveV","moveToLineEndPoint$2","isCefPosition","isTarget","rangeBefore","insertElement","insertBr","insertBlock$1","insertEmptyLine","getClosestTargetBlock","isAtFirstOrLastLine","moveCaretToNewEmptyLine","rootBlockAttrs","moveV$1","defaultPatterns","patterns","matchesEvent","match$1","execute","moveH$1","moveV$2","moveToLineEndPoint$3","deflate","getCorners","getYAxisValue","tds","findClosestCorner","corners","newCorner","oldCorner","oldDist","sqrt","getClosestCell$1","isTargetCorner","corner","getBottomValue","getTopValue","isAbove$1","isBelow$1","getClosestCellAbove","getClosestCellBelow","findClosestPositionInAboveCell","findClosestPositionInBelowCell","hasNextBreak","lineInfo","breakPos","startsWithWrapBreak","startsWithBrBreak","isAtTableCellLine","isAtFirstTableCellLine","isAtLastTableCellLine","isCaretAtStartOrEndOfTable","navigateHorizontally","_td","getClosestAbovePosition","getClosestBelowPosition","getTable","renderBlock","navigateVertically","move$1","mover","moveH$2","moveV$3","executeKeydownOverride","setup$c","executeKeydownOverride$1","executeKeyupOverride","setup$d","firstNonWhiteSpaceNodeSibling","moveToCaretPosition","getEditableRoot","editableRoot","getParentBlock$2","getParentBlockName","isListItemParentBlock","hasFirstChild","isFirstChild","hasParent$1","isListBlock","isNestedList","getContainerBlock","containerBlock","containerBlockParent","isFirstOrLastLi","createNewBlock","newBlockName","tmpRng","trimZwsp","isEmptyAnchor","isTableCell$5","emptyBlock","containerAndSiblingName","canSplitBlock","trimInlineElementsOnLeftSideOfBlock","firstChilds","normalizeZwspOffset","includeZwspInRange","trimLeadingLineBreaks","getEditableRoot$1","applyAttributes","forcedRootBlockAttrs","attrStyles","currentStyles","newStyles","attrClassesOpt","attrClasses","currentClassesOpt","currentClasses","filteredClasses","newClasses","appliedAttrs","remainingAttrs","setForcedBlockAttrs","wrapSelfAndSiblingsInDefaultBlock","addBrToBlockIfNeeded","insert$1","parentBlockName","isAfterLastNodeInContainer","clonedNode","isCaretAtStartOrEndOfBlock","normalizedOffset","insertNewBlockAfter","containerBlockName","hasRightSideContent","moveSelectionToBr","brElm","extraBr","insertBrAtCaret","isControlKey","insertBrBefore","insertBrAfter","hasBrAfter","isBeforeBr$1","isAnchorLink","isInsideAnchor","readInlineAnchorLocation","insertBrOutsideAnchor","insert$2","anchorLocation","shouldInsertBr","shouldBlockNewLine","newLineAction","shouldBlockNewLine$1","_shiftKey","isBrMode","requiredState","brMode","inListBlock","inBlock","inPreBlock","inSummaryBlock","shouldPutBrInPre$1","inBrContext","hasShiftKey","_editor","canInsertIntoEditableRoot","rootEditable","match$2","predicates","isMatch","getAction$1","insert$3","handleEnterKeyEvent","setup$e","executeKeydownOverride$2","setup$f","browser$4","setupIeInput","keypressThrotter","setup$g","isComposing","platform$2","executeKeyupAction","isPageUpDown","setNodeChangeBlocker","blocked","setup$h","insertTextAtPosition","insertNbspAtPosition","insertSpaceAtPosition","locationToCaretPosition","insertInlineBoundarySpaceOrNbsp","checkPos","setSelection$1","insertSpaceOrNbspAtSelection","executeKeydownOverride$3","setup$i","registerKeyboardOverrides","setup$j","NodeChange","lastPath","lastRng","nativeRng","fakeRng","isSameElementPath","initialized","currentPath","preventSummaryToggle","filterDetails","setup$k","isTextBlockNode","normalizeSelection$1","setup$l","detail","value$1","isSet","getAbsolutePosition","getBodyPosition","getScrollPosition","getBodyScroll","inlineScroll","iframeScroll","getMousePosition","iframePosition","scrollPosition","calculatePosition","bodyPosition","mousePosition","calc","isContentEditableFalse$a","isContentEditableTrue$3","isDraggable","isValidDropTarget","targetElement","dragElement","cloneElement","cloneElm","createGhost","clonedElm","opacity","overflow","padding","boxSizing","appendGhostToBody","moveGhost","maxX","maxY","overflowX","removeElement","isLeftMouseButtonPressed","applyRelPos","relX","start$1","ceElm","elmPos","dragging","relY","ghost","move$2","throttledPlaceCaretAt","movement","targetPos","getRawTarget","drop","targetClone_1","removeDragState","bindFakeDragEvents","pageDom","dragStartHandler","dragHandler","dropHandler","dragEndHandler","blockIeDrop","realTarget","blockUnsupportedFileDrop","preventFileDrop","dataTransfer","types","preventFileDropIfUIElement","editorRoot","eventNames","setup$m","renderFocusCaret","setup$n","isContentEditableTrue$4","isContentEditableFalse$b","getContentEditableRoot$1","SelectionOverrides","fakeCaret","realSelectionId","selectedElement","isFakeSelectionElement","isFakeSelectionTargetElement","isNearFakeSelectionElement","getRealSelectionElement","setRange","getRange","contentEditableRoot","removeElementSelection","hasNormalCaretPosition","hasBetterMouseTarget","targetBlock","setElementSelection","fakeCaretInfo","normalizeShortEndedElementSelection","isPasteBin","isRangeInCaretContainer","clipboardData","realSelectionElement","clearData","setData","outerText","isWithinCaretContainer","setupOffscreenSelection","targetClone","origTargetClone","$realSelectionContainer","selectElement","nodeElm","afterNode","Quirks","isGecko","isWebKit","mceInternalUrlPrefix","mceInternalDataType","setEditorCommandState","setMceInternalContent","selectionHtml","internalContent","escape","getMceInternalContent","insertClipboardContents","internal","queryCommandSupported","emptyEditorWhenDeleting","serializeRng","allContentsSelected","allRng","allSelection","selectAll","shortcuts","inputMethodFocus","removeHrOnBackspace","Range","body_1","blur","selectControlElements","removeStylesWhenDeletingAcrossBlockElements","getAttributeApplyFunction","template","setAttributeNode","isSelectionAcrossElements","disableBackspaceIntoATable","removeBlockQuoteOnBackSpace","setGeckoEditingOptions","setOpts","addBrAfterLastLinks","fixLinks","setDefaultBlockType","showBrokenImageIcon","contentStyles","restoreFocusOnKeyDown","bodyHeight","blockCmdArrowNavigation","selection_1","disableAutoUrlDetect","tapLinksAndImages","blockFormSubmitInsideEditor","removeAppleInterchangeBrs","ieInternalDragAndDrop","setupRtc","DOM$4","appendStyle","getRootName","removeUndefined","mkParserSettings","mkSerializerSettings","boolean_attributes","move_caret_before_on_enter_elements","non_empty_elements","short_ended_elements","text_inline_elements","whitespace_elements","createParser","autoFocus","auto_focus","moveSelectionToFirstCaretPosition","initEditor","bindPendingEventDelegates","execCallback","getStyleSheetLoader","ui","makeStylesheetLoadingPromises","framedFonts","loadContentCss","removeCss","preInit","browser_spellcheck","gecko_spellcheck","spellcheck","directionality","protect","startContent","contentCssText_1","content_style","initContentBody","skipWrite","visibility","orgVisibility","iframeHTML","hex_colors","force_hex_style_colors","annotator","_nodeChangeDispatcher","loadingRtc","setProgressState","_rtcMode","DOM$5","relaxDomain","ifr","domain","hostname","bodyUuid","domainRelaxUrl","createIframeElement","customAttrs","iframe","frameBorder","allowTransparency","getIframeHtml","getURI","bodyId","bodyClass","createIframe","isDomainRelaxed","iframeContainer","init$1","boxInfo","hidden","DOM$6","initPlugin","initializedPlugins","plugin","Plugin","pluginInstance","trimLegacyPrefix","initPlugins","initIcons","iconPackName","currentIcons","loadIcons","svgData","icon","addIcon","initTheme","Theme","renderFromLoadedTheme","renderUI","renderFromThemeFunc","iframeHeight","createThemeFalseResult","renderThemeFalseIframe","renderThemeFalse","renderThemeUi","augmentEditorUiApi","uiApiFacade","disable","isDisabled","enable","init$2","renderInfo","DOM$7","hasSkipLoadPrefix","loadLanguage","scriptLoader","languageCode","languageUrl","url_1","loadTheme","themeUrl","getIconsUrlMetaFromUrl","getIconsUrlMetaFromName","defaultIconsUrl","customIconsUrl","urlMeta","loadPlugins","depPlugin","url_2","getStyleSheetLoader$1","render","snapshot","resetContent","triggerSave","windowManager","set_dirty","addVisual$1","legacyPropNames","getSpecifiedFontProp","getProperty","legacyPropName","normalizeFontFamily","getComputedFontProp","getFontProp","getFontSize","getFontFamily","findFirstCaretElement","getCaretElement","atStartOfNode","mapRange","mapper","fromFontSizeNumber","fontSizeNumber","fontClasses","normalizeFontNames","font","fonts","fontNameAction","fontNameQuery","fontSizeAction","fontSizeQuery","lineHeightQuery","specifiedStyle","computedStyle","lineHeightAction","processValue","insertAtCaret$1","each$f","map$3","inArray$2","EditorCommands","commands","setupCommands","skip_focus","customCommand","queryCommandValue","addCommands","commandList","addQueryStateHandler","addQueryValueHandler","hasCustomCommand","execNativeCommand","isFormatMatch","storeSelection","selectionBookmark","queryCommandEnabled","listParent","anchor","editingHost","selectNodeContents","alignStates","Undo","Redo","internalContentEditableAttr","setContentEditable","switchOffContentEditableTrue","switchOnContentEditableTrue","removeFakeSelection","restoreFakeSelection","toggleReadOnly","isReadOnly$1","registerFilters","registerReadOnlyContentFilters","isClickEvent","getAnchorHrefOpt","processReadonlyEvents","targetEl","registerReadOnlySelectionBlockers","nativeEvents","EventDispatcher","bindings","toggleEvent","isNative","nameIn","argsIn","beforeFire","wrappedCallback","currentName","bindingName","hi","getEventDispatcher","_eventDispatcher","toggleNativeEvent","Observable","bubble","dispatcherArgs","DOM$8","customEventRootDelegates","getEventTarget","eventName","eventRoot","isListening","bindEventDelegate","delegate","delegates","eventRootElm","editors","EditorObservable","_pendingNativeEvents","defaultModes","switchToMode","activeMode","availableModes","oldMode","newMode","activate","deactivate","editorReadOnly","setMode","registerMode","create$5","design","each$g","explode$3","keyCodeLookup","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","modifierNames","parseShortcut","shortcut","charCode","access","alt","ctrl","meta","Shortcuts","pendingPatterns","hasModifier","isFunctionKey","matchShortcut","subpatterns","executeShortcutAction","desc","cmdFunc","normalizeCommandFunc","createShortcut","create$6","buttons","menuItems","popups","contextMenus","contextToolbars","sidebars","addButton","addGroupToolbarButton","addToggleButton","addMenuButton","addSplitButton","addMenuItem","addNestedMenuItem","addToggleMenuItem","addAutocompleter","addContextMenu","addContextToolbar","addContextForm","addSidebar","bridge","each$h","trim$4","queryParts","DEFAULT_PORTS","ftp","http","https","mailto","URI","baseUri","base_uri","source","isProtocolRelative","protocol","toAbsPath","urlMatch","part","userInfo","port","uriComponents","pathname","setPath","pathMatch","file","toRelative","relativeUri","tu","uu","toRelPath","noHost","absoluteUri","isSameOrigin","defaultPort","breakPoint","normalizedBase","nb","outPath","normalizedPath","noProtoHost","DOM$9","extend$3","each$i","resolve$3","ie$1","Editor","loadedCSS","isNotDirty","documentBaseURL","base_url","_setBaseUrl","baseURI","referrer_policy","language_load","editorCommands","cache_suffix","modeInstance","callbackLookup","hasPlugin","initialContent","oldState","urlconverter_callback","_scanForImages","DOM$a","explode$4","each$j","extend$4","instanceCounter","boundGlobalEvents","beforeUnloadDelegate","legacyEditors","isValidLegacyKey","globalEventDelegate","EditorManager","toggleGlobalEvents","removeEditorFromList","targetEditor","oldEditors","purgeDestroyedEditor","isQuirksMode","compatMode","majorVersion","minorVersion","releaseDate","i18n","tinymce","tinyMCEPreInit","srcScript","currentScript","pluginBaseUrls","plugin_base_urls","pluginBaseUrl","invalidInlineTargets","isInvalidInlineTarget","createId","findTargets","forms","editor_deselector","editor_selector","provideResults","initEditors","initCount","createEditor","existingEditor","addI18n","round$1","relativePosition","targetW","targetH","relChars","create$7","findBestRelativePosition","constrainRect","rels","inflate","intersect","cropRect","x1","y1","clamp$1","clampRect","fixedSize","cx2","cy2","underflowX1","underflowY1","overflowX2","overflowY2","fromClientRect","Rect","awaiter","resolveCb","rejectCb","complete","completer","create$8","tasks","resultFns","loadErrMsg","runErrMsg","task","waiter","Resource","each$k","extend$5","extendClass","initializing","Class","_super","mixins","mixin","Mixins","dummy","createMethod","Methods","Properties","fieldName","Statics","Defaults","member","min$1","max$1","round$2","Color","rgb2hsv","minRGB","maxRGB","hsvToRgb","hue","saturation","brightness","side","chroma","toRgb","toHsv","stringify","hexCode","JSONUtils","JSONP","XHR","ready","async","success_scope","error_scope","overrideMimeType","content_type","crossDomain","setRequestHeader","requestheaders","extend$6","JSONRequest","sendRPC","ecb","scb","xhrArgs","method","create$9","storage","getItem","setItem","removeItem","defineProperty","configurable","enumerable","localStorage","LocalStorage","publicApi","geom","util","TreeWalker","Serializer","Selection","isMac","exportToModuleLoaders","exportToWindowGlobal","tinyMCE"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.8.2 (2021-06-23)\n */\n(function () {\n    'use strict';\n\n    var typeOf = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      if (x === undefined) {\n        return 'undefined';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isEquatableType = function (x) {\n      return [\n        'undefined',\n        'boolean',\n        'number',\n        'string',\n        'function',\n        'xml',\n        'null'\n      ].indexOf(x) !== -1;\n    };\n\n    var sort = function (xs, compareFn) {\n      var clone = Array.prototype.slice.call(xs);\n      return clone.sort(compareFn);\n    };\n\n    var contramap = function (eqa, f) {\n      return eq(function (x, y) {\n        return eqa.eq(f(x), f(y));\n      });\n    };\n    var eq = function (f) {\n      return { eq: f };\n    };\n    var tripleEq = eq(function (x, y) {\n      return x === y;\n    });\n    var eqString = tripleEq;\n    var eqArray = function (eqa) {\n      return eq(function (x, y) {\n        if (x.length !== y.length) {\n          return false;\n        }\n        var len = x.length;\n        for (var i = 0; i < len; i++) {\n          if (!eqa.eq(x[i], y[i])) {\n            return false;\n          }\n        }\n        return true;\n      });\n    };\n    var eqSortedArray = function (eqa, compareFn) {\n      return contramap(eqArray(eqa), function (xs) {\n        return sort(xs, compareFn);\n      });\n    };\n    var eqRecord = function (eqa) {\n      return eq(function (x, y) {\n        var kx = Object.keys(x);\n        var ky = Object.keys(y);\n        if (!eqSortedArray(eqString).eq(kx, ky)) {\n          return false;\n        }\n        var len = kx.length;\n        for (var i = 0; i < len; i++) {\n          var q = kx[i];\n          if (!eqa.eq(x[q], y[q])) {\n            return false;\n          }\n        }\n        return true;\n      });\n    };\n    var eqAny = eq(function (x, y) {\n      if (x === y) {\n        return true;\n      }\n      var tx = typeOf(x);\n      var ty = typeOf(y);\n      if (tx !== ty) {\n        return false;\n      }\n      if (isEquatableType(tx)) {\n        return x === y;\n      } else if (tx === 'array') {\n        return eqArray(eqAny).eq(x, y);\n      } else if (tx === 'object') {\n        return eqRecord(eqAny).eq(x, y);\n      }\n      return false;\n    });\n\n    var typeOf$1 = function (x) {\n      var t = typeof x;\n      if (x === null) {\n        return 'null';\n      } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      } else {\n        return t;\n      }\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf$1(value) === type;\n      };\n    };\n    var isSimpleType = function (type) {\n      return function (value) {\n        return typeof value === type;\n      };\n    };\n    var eq$1 = function (t) {\n      return function (a) {\n        return t === a;\n      };\n    };\n    var isString = isType('string');\n    var isObject = isType('object');\n    var isArray = isType('array');\n    var isNull = eq$1(null);\n    var isBoolean = isSimpleType('boolean');\n    var isUndefined = eq$1(undefined);\n    var isNullable = function (a) {\n      return a === null || a === undefined;\n    };\n    var isNonNullable = function (a) {\n      return !isNullable(a);\n    };\n    var isFunction = isSimpleType('function');\n    var isNumber = isSimpleType('number');\n\n    var noop = function () {\n    };\n    var compose = function (fa, fb) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return fa(fb.apply(null, args));\n      };\n    };\n    var compose1 = function (fbc, fab) {\n      return function (a) {\n        return fbc(fab(a));\n      };\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var identity = function (x) {\n      return x;\n    };\n    function curry(fn) {\n      var initialArgs = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        initialArgs[_i - 1] = arguments[_i];\n      }\n      return function () {\n        var restArgs = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          restArgs[_i] = arguments[_i];\n        }\n        var all = initialArgs.concat(restArgs);\n        return fn.apply(null, all);\n      };\n    }\n    var not = function (f) {\n      return function (t) {\n        return !f(t);\n      };\n    };\n    var die = function (msg) {\n      return function () {\n        throw new Error(msg);\n      };\n    };\n    var apply = function (f) {\n      return f();\n    };\n    var call = function (f) {\n      f();\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, _s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Optional = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var nativeSlice = Array.prototype.slice;\n    var nativeIndexOf = Array.prototype.indexOf;\n    var nativePush = Array.prototype.push;\n    var rawIndexOf = function (ts, t) {\n      return nativeIndexOf.call(ts, t);\n    };\n    var indexOf = function (xs, x) {\n      var r = rawIndexOf(xs, x);\n      return r === -1 ? Optional.none() : Optional.some(r);\n    };\n    var contains = function (xs, x) {\n      return rawIndexOf(xs, x) > -1;\n    };\n    var exists = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var eachr = function (xs, f) {\n      for (var i = xs.length - 1; i >= 0; i--) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var partition = function (xs, pred) {\n      var pass = [];\n      var fail = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        var arr = pred(x, i) ? pass : fail;\n        arr.push(x);\n      }\n      return {\n        pass: pass,\n        fail: fail\n      };\n    };\n    var filter = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var foldr = function (xs, f, acc) {\n      eachr(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var foldl = function (xs, f, acc) {\n      each(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var findUntil = function (xs, pred, until) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Optional.some(x);\n        } else if (until(x, i)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var find = function (xs, pred) {\n      return findUntil(xs, pred, never);\n    };\n    var findIndex = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Optional.some(i);\n        }\n      }\n      return Optional.none();\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind = function (xs, f) {\n      return flatten(map(xs, f));\n    };\n    var forall = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        var x = xs[i];\n        if (pred(x, i) !== true) {\n          return false;\n        }\n      }\n      return true;\n    };\n    var reverse = function (xs) {\n      var r = nativeSlice.call(xs, 0);\n      r.reverse();\n      return r;\n    };\n    var difference = function (a1, a2) {\n      return filter(a1, function (x) {\n        return !contains(a2, x);\n      });\n    };\n    var mapToObject = function (xs, f) {\n      var r = {};\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        r[String(x)] = f(x, i);\n      }\n      return r;\n    };\n    var sort$1 = function (xs, comparator) {\n      var copy = nativeSlice.call(xs, 0);\n      copy.sort(comparator);\n      return copy;\n    };\n    var get = function (xs, i) {\n      return i >= 0 && i < xs.length ? Optional.some(xs[i]) : Optional.none();\n    };\n    var head = function (xs) {\n      return get(xs, 0);\n    };\n    var last = function (xs) {\n      return get(xs, xs.length - 1);\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n    var findMap = function (arr, f) {\n      for (var i = 0; i < arr.length; i++) {\n        var r = f(arr[i], i);\n        if (r.isSome()) {\n          return r;\n        }\n      }\n      return Optional.none();\n    };\n\n    var keys = Object.keys;\n    var hasOwnProperty = Object.hasOwnProperty;\n    var each$1 = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n    var map$1 = function (obj, f) {\n      return tupleMap(obj, function (x, i) {\n        return {\n          k: i,\n          v: f(x, i)\n        };\n      });\n    };\n    var tupleMap = function (obj, f) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        var tuple = f(x, i);\n        r[tuple.k] = tuple.v;\n      });\n      return r;\n    };\n    var objAcc = function (r) {\n      return function (x, i) {\n        r[i] = x;\n      };\n    };\n    var internalFilter = function (obj, pred, onTrue, onFalse) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        (pred(x, i) ? onTrue : onFalse)(x, i);\n      });\n      return r;\n    };\n    var bifilter = function (obj, pred) {\n      var t = {};\n      var f = {};\n      internalFilter(obj, pred, objAcc(t), objAcc(f));\n      return {\n        t: t,\n        f: f\n      };\n    };\n    var filter$1 = function (obj, pred) {\n      var t = {};\n      internalFilter(obj, pred, objAcc(t), noop);\n      return t;\n    };\n    var mapToArray = function (obj, f) {\n      var r = [];\n      each$1(obj, function (value, name) {\n        r.push(f(value, name));\n      });\n      return r;\n    };\n    var values = function (obj) {\n      return mapToArray(obj, function (v) {\n        return v;\n      });\n    };\n    var get$1 = function (obj, key) {\n      return has(obj, key) ? Optional.from(obj[key]) : Optional.none();\n    };\n    var has = function (obj, key) {\n      return hasOwnProperty.call(obj, key);\n    };\n    var hasNonNullableKey = function (obj, key) {\n      return has(obj, key) && obj[key] !== undefined && obj[key] !== null;\n    };\n    var equal = function (a1, a2, eq) {\n      if (eq === void 0) {\n        eq = eqAny;\n      }\n      return eqRecord(eq).eq(a1, a2);\n    };\n\n    var isArray$1 = Array.isArray;\n    var toArray = function (obj) {\n      if (!isArray$1(obj)) {\n        var array = [];\n        for (var i = 0, l = obj.length; i < l; i++) {\n          array[i] = obj[i];\n        }\n        return array;\n      } else {\n        return obj;\n      }\n    };\n    var each$2 = function (o, cb, s) {\n      var n, l;\n      if (!o) {\n        return false;\n      }\n      s = s || o;\n      if (o.length !== undefined) {\n        for (n = 0, l = o.length; n < l; n++) {\n          if (cb.call(s, o[n], n, o) === false) {\n            return false;\n          }\n        }\n      } else {\n        for (n in o) {\n          if (o.hasOwnProperty(n)) {\n            if (cb.call(s, o[n], n, o) === false) {\n              return false;\n            }\n          }\n        }\n      }\n      return true;\n    };\n    var map$2 = function (array, callback) {\n      var out = [];\n      each$2(array, function (item, index) {\n        out.push(callback(item, index, array));\n      });\n      return out;\n    };\n    var filter$2 = function (a, f) {\n      var o = [];\n      each$2(a, function (v, index) {\n        if (!f || f(v, index, a)) {\n          o.push(v);\n        }\n      });\n      return o;\n    };\n    var indexOf$1 = function (a, v) {\n      if (a) {\n        for (var i = 0, l = a.length; i < l; i++) {\n          if (a[i] === v) {\n            return i;\n          }\n        }\n      }\n      return -1;\n    };\n    var reduce = function (collection, iteratee, accumulator, thisArg) {\n      var acc = isUndefined(accumulator) ? collection[0] : accumulator;\n      for (var i = 0; i < collection.length; i++) {\n        acc = iteratee.call(thisArg, acc, collection[i], i);\n      }\n      return acc;\n    };\n    var findIndex$1 = function (array, predicate, thisArg) {\n      var i, l;\n      for (i = 0, l = array.length; i < l; i++) {\n        if (predicate.call(thisArg, array[i], i, array)) {\n          return i;\n        }\n      }\n      return -1;\n    };\n    var last$1 = function (collection) {\n      return collection[collection.length - 1];\n    };\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n    function __rest(s, e) {\n      var t = {};\n      for (var p in s)\n        if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n          t[p] = s[p];\n      if (s != null && typeof Object.getOwnPropertySymbols === 'function')\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n            t[p[i]] = s[p[i]];\n        }\n      return t;\n    }\n    function __spreadArrays() {\n      for (var s = 0, i = 0, il = arguments.length; i < il; i++)\n        s += arguments[i].length;\n      for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n      return r;\n    }\n\n    var cached = function (f) {\n      var called = false;\n      var r;\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (!called) {\n          called = true;\n          r = f.apply(null, args);\n        }\n        return r;\n      };\n    };\n\n    var DeviceType = function (os, browser, userAgent, mediaMatch) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isMobile = os.isiOS() || os.isAndroid();\n      var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n      var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n      var isPhone = isiPhone || isMobile && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      var isDesktop = !isPhone && !isTablet && !iOSwebview;\n      return {\n        isiPad: constant(isiPad),\n        isiPhone: constant(isiPhone),\n        isTablet: constant(isTablet),\n        isPhone: constant(isPhone),\n        isTouch: constant(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: constant(iOSwebview),\n        isDesktop: constant(isDesktop)\n      };\n    };\n\n    var firstMatch = function (regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s)) {\n          return x;\n        }\n      }\n      return undefined;\n    };\n    var find$1 = function (regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r) {\n        return {\n          major: 0,\n          minor: 0\n        };\n      }\n      var group = function (i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n      return nu(group(1), group(2));\n    };\n    var detect = function (versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0) {\n        return unknown();\n      }\n      return find$1(versionRegexes, cleanedAgent);\n    };\n    var unknown = function () {\n      return nu(0, 0);\n    };\n    var nu = function (major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n    var Version = {\n      nu: nu,\n      detect: detect,\n      unknown: unknown\n    };\n\n    var detect$1 = function (candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return find(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n    var detectBrowser = function (browsers, userAgent) {\n      return detect$1(browsers, userAgent).map(function (browser) {\n        var version = Version.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n    var detectOs = function (oses, userAgent) {\n      return detect$1(oses, userAgent).map(function (os) {\n        var version = Version.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n    var UaString = {\n      detectBrowser: detectBrowser,\n      detectOs: detectOs\n    };\n\n    var removeFromStart = function (str, numChars) {\n      return str.substring(numChars);\n    };\n\n    var checkRange = function (str, substr, start) {\n      return substr === '' || str.length >= substr.length && str.substr(start, start + substr.length) === substr;\n    };\n    var removeLeading = function (str, prefix) {\n      return startsWith(str, prefix) ? removeFromStart(str, prefix.length) : str;\n    };\n    var contains$1 = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n    var startsWith = function (str, prefix) {\n      return checkRange(str, prefix, 0);\n    };\n    var blank = function (r) {\n      return function (s) {\n        return s.replace(r, '');\n      };\n    };\n    var trim = blank(/^\\s+|\\s+$/g);\n    var lTrim = blank(/^\\s+/g);\n    var rTrim = blank(/\\s+$/g);\n    var isNotEmpty = function (s) {\n      return s.length > 0;\n    };\n\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n    var checkContains = function (target) {\n      return function (uastring) {\n        return contains$1(uastring, target);\n      };\n    };\n    var browsers = [\n      {\n        name: 'Edge',\n        versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n        search: function (uastring) {\n          return contains$1(uastring, 'edge/') && contains$1(uastring, 'chrome') && contains$1(uastring, 'safari') && contains$1(uastring, 'applewebkit');\n        }\n      },\n      {\n        name: 'Chrome',\n        versionRegexes: [\n          /.*?chrome\\/([0-9]+)\\.([0-9]+).*/,\n          normalVersionRegex\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'chrome') && !contains$1(uastring, 'chromeframe');\n        }\n      },\n      {\n        name: 'IE',\n        versionRegexes: [\n          /.*?msie\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*?rv:([0-9]+)\\.([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'msie') || contains$1(uastring, 'trident');\n        }\n      },\n      {\n        name: 'Opera',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?opera\\/([0-9]+)\\.([0-9]+).*/\n        ],\n        search: checkContains('opera')\n      },\n      {\n        name: 'Firefox',\n        versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n        search: checkContains('firefox')\n      },\n      {\n        name: 'Safari',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?cpu os ([0-9]+)_([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return (contains$1(uastring, 'safari') || contains$1(uastring, 'mobile/')) && contains$1(uastring, 'applewebkit');\n        }\n      }\n    ];\n    var oses = [\n      {\n        name: 'Windows',\n        search: checkContains('win'),\n        versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'iOS',\n        search: function (uastring) {\n          return contains$1(uastring, 'iphone') || contains$1(uastring, 'ipad');\n        },\n        versionRegexes: [\n          /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*cpu os ([0-9]+)_([0-9]+).*/,\n          /.*cpu iphone os ([0-9]+)_([0-9]+).*/\n        ]\n      },\n      {\n        name: 'Android',\n        search: checkContains('android'),\n        versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'OSX',\n        search: checkContains('mac os x'),\n        versionRegexes: [/.*?mac\\ os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n      },\n      {\n        name: 'Linux',\n        search: checkContains('linux'),\n        versionRegexes: []\n      },\n      {\n        name: 'Solaris',\n        search: checkContains('sunos'),\n        versionRegexes: []\n      },\n      {\n        name: 'FreeBSD',\n        search: checkContains('freebsd'),\n        versionRegexes: []\n      },\n      {\n        name: 'ChromeOS',\n        search: checkContains('cros'),\n        versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/]\n      }\n    ];\n    var PlatformInfo = {\n      browsers: constant(browsers),\n      oses: constant(oses)\n    };\n\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n    var unknown$1 = function () {\n      return nu$1({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$1 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      var isBrowser = function (name) {\n        return function () {\n          return current === name;\n        };\n      };\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge),\n        isChrome: isBrowser(chrome),\n        isIE: isBrowser(ie),\n        isOpera: isBrowser(opera),\n        isFirefox: isBrowser(firefox),\n        isSafari: isBrowser(safari)\n      };\n    };\n    var Browser = {\n      unknown: unknown$1,\n      nu: nu$1,\n      edge: constant(edge),\n      chrome: constant(chrome),\n      ie: constant(ie),\n      opera: constant(opera),\n      firefox: constant(firefox),\n      safari: constant(safari)\n    };\n\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n    var chromeos = 'ChromeOS';\n    var unknown$2 = function () {\n      return nu$2({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$2 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      var isOS = function (name) {\n        return function () {\n          return current === name;\n        };\n      };\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows),\n        isiOS: isOS(ios),\n        isAndroid: isOS(android),\n        isOSX: isOS(osx),\n        isLinux: isOS(linux),\n        isSolaris: isOS(solaris),\n        isFreeBSD: isOS(freebsd),\n        isChromeOS: isOS(chromeos)\n      };\n    };\n    var OperatingSystem = {\n      unknown: unknown$2,\n      nu: nu$2,\n      windows: constant(windows),\n      ios: constant(ios),\n      android: constant(android),\n      linux: constant(linux),\n      osx: constant(osx),\n      solaris: constant(solaris),\n      freebsd: constant(freebsd),\n      chromeos: constant(chromeos)\n    };\n\n    var detect$2 = function (userAgent, mediaMatch) {\n      var browsers = PlatformInfo.browsers();\n      var oses = PlatformInfo.oses();\n      var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n      var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n      var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n    var PlatformDetection = { detect: detect$2 };\n\n    var mediaMatch = function (query) {\n      return window.matchMedia(query).matches;\n    };\n    var platform = cached(function () {\n      return PlatformDetection.detect(navigator.userAgent, mediaMatch);\n    });\n    var detect$3 = function () {\n      return platform();\n    };\n\n    var userAgent = navigator.userAgent;\n    var platform$1 = detect$3();\n    var browser = platform$1.browser;\n    var os = platform$1.os;\n    var deviceType = platform$1.deviceType;\n    var webkit = /WebKit/.test(userAgent) && !browser.isEdge();\n    var fileApi = 'FormData' in window && 'FileReader' in window && 'URL' in window && !!URL.createObjectURL;\n    var windowsPhone = userAgent.indexOf('Windows Phone') !== -1;\n    var Env = {\n      opera: browser.isOpera(),\n      webkit: webkit,\n      ie: browser.isIE() || browser.isEdge() ? browser.version.major : false,\n      gecko: browser.isFirefox(),\n      mac: os.isOSX() || os.isiOS(),\n      iOS: deviceType.isiPad() || deviceType.isiPhone(),\n      android: os.isAndroid(),\n      contentEditable: true,\n      transparentSrc: 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7',\n      caretAfter: true,\n      range: window.getSelection && 'Range' in window,\n      documentMode: browser.isIE() ? document.documentMode || 7 : 10,\n      fileApi: fileApi,\n      ceFalse: true,\n      cacheSuffix: null,\n      container: null,\n      experimentalShadowDom: false,\n      canHaveCSP: !browser.isIE(),\n      desktop: deviceType.isDesktop(),\n      windowsPhone: windowsPhone,\n      browser: {\n        current: browser.current,\n        version: browser.version,\n        isChrome: browser.isChrome,\n        isEdge: browser.isEdge,\n        isFirefox: browser.isFirefox,\n        isIE: browser.isIE,\n        isOpera: browser.isOpera,\n        isSafari: browser.isSafari\n      },\n      os: {\n        current: os.current,\n        version: os.version,\n        isAndroid: os.isAndroid,\n        isChromeOS: os.isChromeOS,\n        isFreeBSD: os.isFreeBSD,\n        isiOS: os.isiOS,\n        isLinux: os.isLinux,\n        isOSX: os.isOSX,\n        isSolaris: os.isSolaris,\n        isWindows: os.isWindows\n      },\n      deviceType: {\n        isDesktop: deviceType.isDesktop,\n        isiPad: deviceType.isiPad,\n        isiPhone: deviceType.isiPhone,\n        isPhone: deviceType.isPhone,\n        isTablet: deviceType.isTablet,\n        isTouch: deviceType.isTouch,\n        isWebView: deviceType.isWebView\n      }\n    };\n\n    var whiteSpaceRegExp = /^\\s*|\\s*$/g;\n    var trim$1 = function (str) {\n      return str === null || str === undefined ? '' : ('' + str).replace(whiteSpaceRegExp, '');\n    };\n    var is = function (obj, type) {\n      if (!type) {\n        return obj !== undefined;\n      }\n      if (type === 'array' && isArray$1(obj)) {\n        return true;\n      }\n      return typeof obj === type;\n    };\n    var makeMap = function (items, delim, map) {\n      var i;\n      items = items || [];\n      delim = delim || ',';\n      if (typeof items === 'string') {\n        items = items.split(delim);\n      }\n      map = map || {};\n      i = items.length;\n      while (i--) {\n        map[items[i]] = {};\n      }\n      return map;\n    };\n    var hasOwnProperty$1 = function (obj, prop) {\n      return Object.prototype.hasOwnProperty.call(obj, prop);\n    };\n    var create = function (s, p, root) {\n      var self = this;\n      var sp, scn, c, de = 0;\n      s = /^((static) )?([\\w.]+)(:([\\w.]+))?/.exec(s);\n      var cn = s[3].match(/(^|\\.)(\\w+)$/i)[2];\n      var ns = self.createNS(s[3].replace(/\\.\\w+$/, ''), root);\n      if (ns[cn]) {\n        return;\n      }\n      if (s[2] === 'static') {\n        ns[cn] = p;\n        if (this.onCreate) {\n          this.onCreate(s[2], s[3], ns[cn]);\n        }\n        return;\n      }\n      if (!p[cn]) {\n        p[cn] = function () {\n        };\n        de = 1;\n      }\n      ns[cn] = p[cn];\n      self.extend(ns[cn].prototype, p);\n      if (s[5]) {\n        sp = self.resolve(s[5]).prototype;\n        scn = s[5].match(/\\.(\\w+)$/i)[1];\n        c = ns[cn];\n        if (de) {\n          ns[cn] = function () {\n            return sp[scn].apply(this, arguments);\n          };\n        } else {\n          ns[cn] = function () {\n            this.parent = sp[scn];\n            return c.apply(this, arguments);\n          };\n        }\n        ns[cn].prototype[cn] = ns[cn];\n        self.each(sp, function (f, n) {\n          ns[cn].prototype[n] = sp[n];\n        });\n        self.each(p, function (f, n) {\n          if (sp[n]) {\n            ns[cn].prototype[n] = function () {\n              this.parent = sp[n];\n              return f.apply(this, arguments);\n            };\n          } else {\n            if (n !== cn) {\n              ns[cn].prototype[n] = f;\n            }\n          }\n        });\n      }\n      self.each(p.static, function (f, n) {\n        ns[cn][n] = f;\n      });\n    };\n    var extend = function (obj) {\n      var exts = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        exts[_i - 1] = arguments[_i];\n      }\n      for (var i = 0; i < exts.length; i++) {\n        var ext = exts[i];\n        for (var name_1 in ext) {\n          if (ext.hasOwnProperty(name_1)) {\n            var value = ext[name_1];\n            if (value !== undefined) {\n              obj[name_1] = value;\n            }\n          }\n        }\n      }\n      return obj;\n    };\n    var walk = function (o, f, n, s) {\n      s = s || this;\n      if (o) {\n        if (n) {\n          o = o[n];\n        }\n        each$2(o, function (o, i) {\n          if (f.call(s, o, i, n) === false) {\n            return false;\n          }\n          walk(o, f, n, s);\n        });\n      }\n    };\n    var createNS = function (n, o) {\n      var i, v;\n      o = o || window;\n      n = n.split('.');\n      for (i = 0; i < n.length; i++) {\n        v = n[i];\n        if (!o[v]) {\n          o[v] = {};\n        }\n        o = o[v];\n      }\n      return o;\n    };\n    var resolve = function (n, o) {\n      var i, l;\n      o = o || window;\n      n = n.split('.');\n      for (i = 0, l = n.length; i < l; i++) {\n        o = o[n[i]];\n        if (!o) {\n          break;\n        }\n      }\n      return o;\n    };\n    var explode = function (s, d) {\n      if (!s || is(s, 'array')) {\n        return s;\n      }\n      return map$2(s.split(d || ','), trim$1);\n    };\n    var _addCacheSuffix = function (url) {\n      var cacheSuffix = Env.cacheSuffix;\n      if (cacheSuffix) {\n        url += (url.indexOf('?') === -1 ? '?' : '&') + cacheSuffix;\n      }\n      return url;\n    };\n    var Tools = {\n      trim: trim$1,\n      isArray: isArray$1,\n      is: is,\n      toArray: toArray,\n      makeMap: makeMap,\n      each: each$2,\n      map: map$2,\n      grep: filter$2,\n      inArray: indexOf$1,\n      hasOwn: hasOwnProperty$1,\n      extend: extend,\n      create: create,\n      walk: walk,\n      createNS: createNS,\n      resolve: resolve,\n      explode: explode,\n      _addCacheSuffix: _addCacheSuffix\n    };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: node };\n    };\n    var fromPoint = function (docElm, x, y) {\n      return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom);\n    };\n    var SugarElement = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var toArray$1 = function (target, f) {\n      var r = [];\n      var recurse = function (e) {\n        r.push(e);\n        return f(e);\n      };\n      var cur = f(target);\n      do {\n        cur = cur.bind(recurse);\n      } while (cur.isSome());\n      return r;\n    };\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionContainedBy = function (a, b) {\n      return compareDocumentPosition(a, b, Node.DOCUMENT_POSITION_CONTAINED_BY);\n    };\n\n    var COMMENT = 8;\n    var DOCUMENT = 9;\n    var DOCUMENT_FRAGMENT = 11;\n    var ELEMENT = 1;\n    var TEXT = 3;\n\n    var is$1 = function (element, selector) {\n      var dom = element.dom;\n      if (dom.nodeType !== ELEMENT) {\n        return false;\n      } else {\n        var elem = dom;\n        if (elem.matches !== undefined) {\n          return elem.matches(selector);\n        } else if (elem.msMatchesSelector !== undefined) {\n          return elem.msMatchesSelector(selector);\n        } else if (elem.webkitMatchesSelector !== undefined) {\n          return elem.webkitMatchesSelector(selector);\n        } else if (elem.mozMatchesSelector !== undefined) {\n          return elem.mozMatchesSelector(selector);\n        } else {\n          throw new Error('Browser lacks native selectors');\n        }\n      }\n    };\n    var bypassSelector = function (dom) {\n      return dom.nodeType !== ELEMENT && dom.nodeType !== DOCUMENT && dom.nodeType !== DOCUMENT_FRAGMENT || dom.childElementCount === 0;\n    };\n    var all = function (selector, scope) {\n      var base = scope === undefined ? document : scope.dom;\n      return bypassSelector(base) ? [] : map(base.querySelectorAll(selector), SugarElement.fromDom);\n    };\n    var one = function (selector, scope) {\n      var base = scope === undefined ? document : scope.dom;\n      return bypassSelector(base) ? Optional.none() : Optional.from(base.querySelector(selector)).map(SugarElement.fromDom);\n    };\n\n    var eq$2 = function (e1, e2) {\n      return e1.dom === e2.dom;\n    };\n    var regularContains = function (e1, e2) {\n      var d1 = e1.dom;\n      var d2 = e2.dom;\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n    var ieContains = function (e1, e2) {\n      return documentPositionContainedBy(e1.dom, e2.dom);\n    };\n    var contains$2 = function (e1, e2) {\n      return detect$3().browser.isIE() ? ieContains(e1, e2) : regularContains(e1, e2);\n    };\n\n    var Global = typeof window !== 'undefined' ? window : Function('return this;')();\n\n    var name = function (element) {\n      var r = element.dom.nodeName;\n      return r.toLowerCase();\n    };\n    var type = function (element) {\n      return element.dom.nodeType;\n    };\n    var isType$1 = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isComment = function (element) {\n      return type(element) === COMMENT || name(element) === '#comment';\n    };\n    var isElement = isType$1(ELEMENT);\n    var isText = isType$1(TEXT);\n    var isDocument = isType$1(DOCUMENT);\n    var isDocumentFragment = isType$1(DOCUMENT_FRAGMENT);\n\n    var owner = function (element) {\n      return SugarElement.fromDom(element.dom.ownerDocument);\n    };\n    var documentOrOwner = function (dos) {\n      return isDocument(dos) ? dos : owner(dos);\n    };\n    var documentElement = function (element) {\n      return SugarElement.fromDom(documentOrOwner(element).dom.documentElement);\n    };\n    var defaultView = function (element) {\n      return SugarElement.fromDom(documentOrOwner(element).dom.defaultView);\n    };\n    var parent = function (element) {\n      return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);\n    };\n    var parents = function (element, isRoot) {\n      var stop = isFunction(isRoot) ? isRoot : never;\n      var dom = element.dom;\n      var ret = [];\n      while (dom.parentNode !== null && dom.parentNode !== undefined) {\n        var rawParent = dom.parentNode;\n        var p = SugarElement.fromDom(rawParent);\n        ret.push(p);\n        if (stop(p) === true) {\n          break;\n        } else {\n          dom = rawParent;\n        }\n      }\n      return ret;\n    };\n    var siblings = function (element) {\n      var filterSelf = function (elements) {\n        return filter(elements, function (x) {\n          return !eq$2(element, x);\n        });\n      };\n      return parent(element).map(children).map(filterSelf).getOr([]);\n    };\n    var prevSibling = function (element) {\n      return Optional.from(element.dom.previousSibling).map(SugarElement.fromDom);\n    };\n    var nextSibling = function (element) {\n      return Optional.from(element.dom.nextSibling).map(SugarElement.fromDom);\n    };\n    var prevSiblings = function (element) {\n      return reverse(toArray$1(element, prevSibling));\n    };\n    var nextSiblings = function (element) {\n      return toArray$1(element, nextSibling);\n    };\n    var children = function (element) {\n      return map(element.dom.childNodes, SugarElement.fromDom);\n    };\n    var child = function (element, index) {\n      var cs = element.dom.childNodes;\n      return Optional.from(cs[index]).map(SugarElement.fromDom);\n    };\n    var firstChild = function (element) {\n      return child(element, 0);\n    };\n    var lastChild = function (element) {\n      return child(element, element.dom.childNodes.length - 1);\n    };\n    var childNodesCount = function (element) {\n      return element.dom.childNodes.length;\n    };\n\n    var getHead = function (doc) {\n      var b = doc.dom.head;\n      if (b === null || b === undefined) {\n        throw new Error('Head is not available yet');\n      }\n      return SugarElement.fromDom(b);\n    };\n\n    var isShadowRoot = function (dos) {\n      return isDocumentFragment(dos) && isNonNullable(dos.dom.host);\n    };\n    var supported = isFunction(Element.prototype.attachShadow) && isFunction(Node.prototype.getRootNode);\n    var isSupported = constant(supported);\n    var getRootNode = supported ? function (e) {\n      return SugarElement.fromDom(e.dom.getRootNode());\n    } : documentOrOwner;\n    var getStyleContainer = function (dos) {\n      return isShadowRoot(dos) ? dos : getHead(documentOrOwner(dos));\n    };\n    var getShadowRoot = function (e) {\n      var r = getRootNode(e);\n      return isShadowRoot(r) ? Optional.some(r) : Optional.none();\n    };\n    var getShadowHost = function (e) {\n      return SugarElement.fromDom(e.dom.host);\n    };\n    var getOriginalEventTarget = function (event) {\n      if (isSupported() && isNonNullable(event.target)) {\n        var el = SugarElement.fromDom(event.target);\n        if (isElement(el) && isOpenShadowHost(el)) {\n          if (event.composed && event.composedPath) {\n            var composedPath = event.composedPath();\n            if (composedPath) {\n              return head(composedPath);\n            }\n          }\n        }\n      }\n      return Optional.from(event.target);\n    };\n    var isOpenShadowHost = function (element) {\n      return isNonNullable(element.dom.shadowRoot);\n    };\n\n    var before = function (marker, element) {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        v.dom.insertBefore(element.dom, marker.dom);\n      });\n    };\n    var after = function (marker, element) {\n      var sibling = nextSibling(marker);\n      sibling.fold(function () {\n        var parent$1 = parent(marker);\n        parent$1.each(function (v) {\n          append(v, element);\n        });\n      }, function (v) {\n        before(v, element);\n      });\n    };\n    var prepend = function (parent, element) {\n      var firstChild$1 = firstChild(parent);\n      firstChild$1.fold(function () {\n        append(parent, element);\n      }, function (v) {\n        parent.dom.insertBefore(element.dom, v.dom);\n      });\n    };\n    var append = function (parent, element) {\n      parent.dom.appendChild(element.dom);\n    };\n    var wrap = function (element, wrapper) {\n      before(element, wrapper);\n      append(wrapper, element);\n    };\n\n    var before$1 = function (marker, elements) {\n      each(elements, function (x) {\n        before(marker, x);\n      });\n    };\n    var append$1 = function (parent, elements) {\n      each(elements, function (x) {\n        append(parent, x);\n      });\n    };\n\n    var empty = function (element) {\n      element.dom.textContent = '';\n      each(children(element), function (rogue) {\n        remove(rogue);\n      });\n    };\n    var remove = function (element) {\n      var dom = element.dom;\n      if (dom.parentNode !== null) {\n        dom.parentNode.removeChild(dom);\n      }\n    };\n    var unwrap = function (wrapper) {\n      var children$1 = children(wrapper);\n      if (children$1.length > 0) {\n        before$1(wrapper, children$1);\n      }\n      remove(wrapper);\n    };\n\n    var inBody = function (element) {\n      var dom = isText(element) ? element.dom.parentNode : element.dom;\n      if (dom === undefined || dom === null || dom.ownerDocument === null) {\n        return false;\n      }\n      var doc = dom.ownerDocument;\n      return getShadowRoot(SugarElement.fromDom(dom)).fold(function () {\n        return doc.body.contains(dom);\n      }, compose1(inBody, getShadowHost));\n    };\n\n    var r = function (left, top) {\n      var translate = function (x, y) {\n        return r(left + x, top + y);\n      };\n      return {\n        left: left,\n        top: top,\n        translate: translate\n      };\n    };\n    var SugarPosition = r;\n\n    var boxPosition = function (dom) {\n      var box = dom.getBoundingClientRect();\n      return SugarPosition(box.left, box.top);\n    };\n    var firstDefinedOrZero = function (a, b) {\n      if (a !== undefined) {\n        return a;\n      } else {\n        return b !== undefined ? b : 0;\n      }\n    };\n    var absolute = function (element) {\n      var doc = element.dom.ownerDocument;\n      var body = doc.body;\n      var win = doc.defaultView;\n      var html = doc.documentElement;\n      if (body === element.dom) {\n        return SugarPosition(body.offsetLeft, body.offsetTop);\n      }\n      var scrollTop = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageYOffset, html.scrollTop);\n      var scrollLeft = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageXOffset, html.scrollLeft);\n      var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n      var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n      return viewport(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n    };\n    var viewport = function (element) {\n      var dom = element.dom;\n      var doc = dom.ownerDocument;\n      var body = doc.body;\n      if (body === dom) {\n        return SugarPosition(body.offsetLeft, body.offsetTop);\n      }\n      if (!inBody(element)) {\n        return SugarPosition(0, 0);\n      }\n      return boxPosition(dom);\n    };\n\n    var get$2 = function (_DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom : document;\n      var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n      var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n      return SugarPosition(x, y);\n    };\n    var to = function (x, y, _DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom : document;\n      var win = doc.defaultView;\n      if (win) {\n        win.scrollTo(x, y);\n      }\n    };\n    var intoView = function (element, alignToTop) {\n      var isSafari = detect$3().browser.isSafari();\n      if (isSafari && isFunction(element.dom.scrollIntoViewIfNeeded)) {\n        element.dom.scrollIntoViewIfNeeded(false);\n      } else {\n        element.dom.scrollIntoView(alignToTop);\n      }\n    };\n\n    var get$3 = function (_win) {\n      var win = _win === undefined ? window : _win;\n      return Optional.from(win['visualViewport']);\n    };\n    var bounds = function (x, y, width, height) {\n      return {\n        x: x,\n        y: y,\n        width: width,\n        height: height,\n        right: x + width,\n        bottom: y + height\n      };\n    };\n    var getBounds = function (_win) {\n      var win = _win === undefined ? window : _win;\n      var doc = win.document;\n      var scroll = get$2(SugarElement.fromDom(doc));\n      return get$3(win).fold(function () {\n        var html = win.document.documentElement;\n        var width = html.clientWidth;\n        var height = html.clientHeight;\n        return bounds(scroll.left, scroll.top, width, height);\n      }, function (visualViewport) {\n        return bounds(Math.max(visualViewport.pageLeft, scroll.left), Math.max(visualViewport.pageTop, scroll.top), visualViewport.width, visualViewport.height);\n      });\n    };\n\n    var isNodeType = function (type) {\n      return function (node) {\n        return !!node && node.nodeType === type;\n      };\n    };\n    var isRestrictedNode = function (node) {\n      return !!node && !Object.getPrototypeOf(node);\n    };\n    var isElement$1 = isNodeType(1);\n    var matchNodeNames = function (names) {\n      var lowercasedNames = names.map(function (s) {\n        return s.toLowerCase();\n      });\n      return function (node) {\n        if (node && node.nodeName) {\n          var nodeName = node.nodeName.toLowerCase();\n          return contains(lowercasedNames, nodeName);\n        }\n        return false;\n      };\n    };\n    var matchStyleValues = function (name, values) {\n      var items = values.toLowerCase().split(' ');\n      return function (node) {\n        var i, cssValue;\n        if (isElement$1(node)) {\n          for (i = 0; i < items.length; i++) {\n            var computed = node.ownerDocument.defaultView.getComputedStyle(node, null);\n            cssValue = computed ? computed.getPropertyValue(name) : null;\n            if (cssValue === items[i]) {\n              return true;\n            }\n          }\n        }\n        return false;\n      };\n    };\n    var hasAttribute = function (attrName) {\n      return function (node) {\n        return isElement$1(node) && node.hasAttribute(attrName);\n      };\n    };\n    var hasAttributeValue = function (attrName, attrValue) {\n      return function (node) {\n        return isElement$1(node) && node.getAttribute(attrName) === attrValue;\n      };\n    };\n    var isBogus = function (node) {\n      return isElement$1(node) && node.hasAttribute('data-mce-bogus');\n    };\n    var isBogusAll = function (node) {\n      return isElement$1(node) && node.getAttribute('data-mce-bogus') === 'all';\n    };\n    var isTable = function (node) {\n      return isElement$1(node) && node.tagName === 'TABLE';\n    };\n    var hasContentEditableState = function (value) {\n      return function (node) {\n        if (isElement$1(node)) {\n          if (node.contentEditable === value) {\n            return true;\n          }\n          if (node.getAttribute('data-mce-contenteditable') === value) {\n            return true;\n          }\n        }\n        return false;\n      };\n    };\n    var isTextareaOrInput = matchNodeNames([\n      'textarea',\n      'input'\n    ]);\n    var isText$1 = isNodeType(3);\n    var isComment$1 = isNodeType(8);\n    var isDocument$1 = isNodeType(9);\n    var isDocumentFragment$1 = isNodeType(11);\n    var isBr = matchNodeNames(['br']);\n    var isImg = matchNodeNames(['img']);\n    var isContentEditableTrue = hasContentEditableState('true');\n    var isContentEditableFalse = hasContentEditableState('false');\n    var isTableCell = matchNodeNames([\n      'td',\n      'th'\n    ]);\n    var isMedia = matchNodeNames([\n      'video',\n      'audio',\n      'object',\n      'embed'\n    ]);\n\n    var isSupported$1 = function (dom) {\n      return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n    };\n\n    var rawSet = function (dom, key, value) {\n      if (isString(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var set = function (element, key, value) {\n      rawSet(element.dom, key, value);\n    };\n    var setAll = function (element, attrs) {\n      var dom = element.dom;\n      each$1(attrs, function (v, k) {\n        rawSet(dom, k, v);\n      });\n    };\n    var get$4 = function (element, key) {\n      var v = element.dom.getAttribute(key);\n      return v === null ? undefined : v;\n    };\n    var getOpt = function (element, key) {\n      return Optional.from(get$4(element, key));\n    };\n    var has$1 = function (element, key) {\n      var dom = element.dom;\n      return dom && dom.hasAttribute ? dom.hasAttribute(key) : false;\n    };\n    var remove$1 = function (element, key) {\n      element.dom.removeAttribute(key);\n    };\n    var clone = function (element) {\n      return foldl(element.dom.attributes, function (acc, attr) {\n        acc[attr.name] = attr.value;\n        return acc;\n      }, {});\n    };\n\n    var internalSet = function (dom, property, value) {\n      if (!isString(value)) {\n        console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n        throw new Error('CSS value must be a string: ' + value);\n      }\n      if (isSupported$1(dom)) {\n        dom.style.setProperty(property, value);\n      }\n    };\n    var setAll$1 = function (element, css) {\n      var dom = element.dom;\n      each$1(css, function (v, k) {\n        internalSet(dom, k, v);\n      });\n    };\n    var get$5 = function (element, property) {\n      var dom = element.dom;\n      var styles = window.getComputedStyle(dom);\n      var r = styles.getPropertyValue(property);\n      return r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n    };\n    var getUnsafeProperty = function (dom, property) {\n      return isSupported$1(dom) ? dom.style.getPropertyValue(property) : '';\n    };\n    var getRaw = function (element, property) {\n      var dom = element.dom;\n      var raw = getUnsafeProperty(dom, property);\n      return Optional.from(raw).filter(function (r) {\n        return r.length > 0;\n      });\n    };\n    var getAllRaw = function (element) {\n      var css = {};\n      var dom = element.dom;\n      if (isSupported$1(dom)) {\n        for (var i = 0; i < dom.style.length; i++) {\n          var ruleName = dom.style.item(i);\n          css[ruleName] = dom.style[ruleName];\n        }\n      }\n      return css;\n    };\n    var reflow = function (e) {\n      return e.dom.offsetWidth;\n    };\n\n    var browser$1 = detect$3().browser;\n    var firstElement = function (nodes) {\n      return find(nodes, isElement);\n    };\n    var getTableCaptionDeltaY = function (elm) {\n      if (browser$1.isFirefox() && name(elm) === 'table') {\n        return firstElement(children(elm)).filter(function (elm) {\n          return name(elm) === 'caption';\n        }).bind(function (caption) {\n          return firstElement(nextSiblings(caption)).map(function (body) {\n            var bodyTop = body.dom.offsetTop;\n            var captionTop = caption.dom.offsetTop;\n            var captionHeight = caption.dom.offsetHeight;\n            return bodyTop <= captionTop ? -captionHeight : 0;\n          });\n        }).getOr(0);\n      } else {\n        return 0;\n      }\n    };\n    var hasChild = function (elm, child) {\n      return elm.children && contains(elm.children, child);\n    };\n    var getPos = function (body, elm, rootElm) {\n      var x = 0, y = 0, offsetParent;\n      var doc = body.ownerDocument;\n      var pos;\n      rootElm = rootElm ? rootElm : body;\n      if (elm) {\n        if (rootElm === body && elm.getBoundingClientRect && get$5(SugarElement.fromDom(body), 'position') === 'static') {\n          pos = elm.getBoundingClientRect();\n          x = pos.left + (doc.documentElement.scrollLeft || body.scrollLeft) - doc.documentElement.clientLeft;\n          y = pos.top + (doc.documentElement.scrollTop || body.scrollTop) - doc.documentElement.clientTop;\n          return {\n            x: x,\n            y: y\n          };\n        }\n        offsetParent = elm;\n        while (offsetParent && offsetParent !== rootElm && offsetParent.nodeType && !hasChild(offsetParent, rootElm)) {\n          x += offsetParent.offsetLeft || 0;\n          y += offsetParent.offsetTop || 0;\n          offsetParent = offsetParent.offsetParent;\n        }\n        offsetParent = elm.parentNode;\n        while (offsetParent && offsetParent !== rootElm && offsetParent.nodeType && !hasChild(offsetParent, rootElm)) {\n          x -= offsetParent.scrollLeft || 0;\n          y -= offsetParent.scrollTop || 0;\n          offsetParent = offsetParent.parentNode;\n        }\n        y += getTableCaptionDeltaY(SugarElement.fromDom(elm));\n      }\n      return {\n        x: x,\n        y: y\n      };\n    };\n\n    var exports$1 = {}, module$1 = { exports: exports$1 };\n    (function (define, exports, module, require) {\n      (function (f) {\n        if (typeof exports === 'object' && typeof module !== 'undefined') {\n          module.exports = f();\n        } else if (typeof define === 'function' && define.amd) {\n          define([], f);\n        } else {\n          var g;\n          if (typeof window !== 'undefined') {\n            g = window;\n          } else if (typeof global !== 'undefined') {\n            g = global;\n          } else if (typeof self !== 'undefined') {\n            g = self;\n          } else {\n            g = this;\n          }\n          g.EphoxContactWrapper = f();\n        }\n      }(function () {\n        return function () {\n          function r(e, n, t) {\n            function o(i, f) {\n              if (!n[i]) {\n                if (!e[i]) {\n                  var c = 'function' == typeof require && require;\n                  if (!f && c)\n                    return c(i, !0);\n                  if (u)\n                    return u(i, !0);\n                  var a = new Error('Cannot find module \\'' + i + '\\'');\n                  throw a.code = 'MODULE_NOT_FOUND', a;\n                }\n                var p = n[i] = { exports: {} };\n                e[i][0].call(p.exports, function (r) {\n                  var n = e[i][1][r];\n                  return o(n || r);\n                }, p, p.exports, r, e, n, t);\n              }\n              return n[i].exports;\n            }\n            for (var u = 'function' == typeof require && require, i = 0; i < t.length; i++)\n              o(t[i]);\n            return o;\n          }\n          return r;\n        }()({\n          1: [\n            function (require, module, exports) {\n              var process = module.exports = {};\n              var cachedSetTimeout;\n              var cachedClearTimeout;\n              function defaultSetTimout() {\n                throw new Error('setTimeout has not been defined');\n              }\n              function defaultClearTimeout() {\n                throw new Error('clearTimeout has not been defined');\n              }\n              (function () {\n                try {\n                  if (typeof setTimeout === 'function') {\n                    cachedSetTimeout = setTimeout;\n                  } else {\n                    cachedSetTimeout = defaultSetTimout;\n                  }\n                } catch (e) {\n                  cachedSetTimeout = defaultSetTimout;\n                }\n                try {\n                  if (typeof clearTimeout === 'function') {\n                    cachedClearTimeout = clearTimeout;\n                  } else {\n                    cachedClearTimeout = defaultClearTimeout;\n                  }\n                } catch (e) {\n                  cachedClearTimeout = defaultClearTimeout;\n                }\n              }());\n              function runTimeout(fun) {\n                if (cachedSetTimeout === setTimeout) {\n                  return setTimeout(fun, 0);\n                }\n                if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n                  cachedSetTimeout = setTimeout;\n                  return setTimeout(fun, 0);\n                }\n                try {\n                  return cachedSetTimeout(fun, 0);\n                } catch (e) {\n                  try {\n                    return cachedSetTimeout.call(null, fun, 0);\n                  } catch (e) {\n                    return cachedSetTimeout.call(this, fun, 0);\n                  }\n                }\n              }\n              function runClearTimeout(marker) {\n                if (cachedClearTimeout === clearTimeout) {\n                  return clearTimeout(marker);\n                }\n                if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n                  cachedClearTimeout = clearTimeout;\n                  return clearTimeout(marker);\n                }\n                try {\n                  return cachedClearTimeout(marker);\n                } catch (e) {\n                  try {\n                    return cachedClearTimeout.call(null, marker);\n                  } catch (e) {\n                    return cachedClearTimeout.call(this, marker);\n                  }\n                }\n              }\n              var queue = [];\n              var draining = false;\n              var currentQueue;\n              var queueIndex = -1;\n              function cleanUpNextTick() {\n                if (!draining || !currentQueue) {\n                  return;\n                }\n                draining = false;\n                if (currentQueue.length) {\n                  queue = currentQueue.concat(queue);\n                } else {\n                  queueIndex = -1;\n                }\n                if (queue.length) {\n                  drainQueue();\n                }\n              }\n              function drainQueue() {\n                if (draining) {\n                  return;\n                }\n                var timeout = runTimeout(cleanUpNextTick);\n                draining = true;\n                var len = queue.length;\n                while (len) {\n                  currentQueue = queue;\n                  queue = [];\n                  while (++queueIndex < len) {\n                    if (currentQueue) {\n                      currentQueue[queueIndex].run();\n                    }\n                  }\n                  queueIndex = -1;\n                  len = queue.length;\n                }\n                currentQueue = null;\n                draining = false;\n                runClearTimeout(timeout);\n              }\n              process.nextTick = function (fun) {\n                var args = new Array(arguments.length - 1);\n                if (arguments.length > 1) {\n                  for (var i = 1; i < arguments.length; i++) {\n                    args[i - 1] = arguments[i];\n                  }\n                }\n                queue.push(new Item(fun, args));\n                if (queue.length === 1 && !draining) {\n                  runTimeout(drainQueue);\n                }\n              };\n              function Item(fun, array) {\n                this.fun = fun;\n                this.array = array;\n              }\n              Item.prototype.run = function () {\n                this.fun.apply(null, this.array);\n              };\n              process.title = 'browser';\n              process.browser = true;\n              process.env = {};\n              process.argv = [];\n              process.version = '';\n              process.versions = {};\n              function noop() {\n              }\n              process.on = noop;\n              process.addListener = noop;\n              process.once = noop;\n              process.off = noop;\n              process.removeListener = noop;\n              process.removeAllListeners = noop;\n              process.emit = noop;\n              process.prependListener = noop;\n              process.prependOnceListener = noop;\n              process.listeners = function (name) {\n                return [];\n              };\n              process.binding = function (name) {\n                throw new Error('process.binding is not supported');\n              };\n              process.cwd = function () {\n                return '/';\n              };\n              process.chdir = function (dir) {\n                throw new Error('process.chdir is not supported');\n              };\n              process.umask = function () {\n                return 0;\n              };\n            },\n            {}\n          ],\n          2: [\n            function (require, module, exports) {\n              (function (setImmediate) {\n                (function (root) {\n                  var setTimeoutFunc = setTimeout;\n                  function noop() {\n                  }\n                  function bind(fn, thisArg) {\n                    return function () {\n                      fn.apply(thisArg, arguments);\n                    };\n                  }\n                  function Promise(fn) {\n                    if (typeof this !== 'object')\n                      throw new TypeError('Promises must be constructed via new');\n                    if (typeof fn !== 'function')\n                      throw new TypeError('not a function');\n                    this._state = 0;\n                    this._handled = false;\n                    this._value = undefined;\n                    this._deferreds = [];\n                    doResolve(fn, this);\n                  }\n                  function handle(self, deferred) {\n                    while (self._state === 3) {\n                      self = self._value;\n                    }\n                    if (self._state === 0) {\n                      self._deferreds.push(deferred);\n                      return;\n                    }\n                    self._handled = true;\n                    Promise._immediateFn(function () {\n                      var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n                      if (cb === null) {\n                        (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                        return;\n                      }\n                      var ret;\n                      try {\n                        ret = cb(self._value);\n                      } catch (e) {\n                        reject(deferred.promise, e);\n                        return;\n                      }\n                      resolve(deferred.promise, ret);\n                    });\n                  }\n                  function resolve(self, newValue) {\n                    try {\n                      if (newValue === self)\n                        throw new TypeError('A promise cannot be resolved with itself.');\n                      if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                        var then = newValue.then;\n                        if (newValue instanceof Promise) {\n                          self._state = 3;\n                          self._value = newValue;\n                          finale(self);\n                          return;\n                        } else if (typeof then === 'function') {\n                          doResolve(bind(then, newValue), self);\n                          return;\n                        }\n                      }\n                      self._state = 1;\n                      self._value = newValue;\n                      finale(self);\n                    } catch (e) {\n                      reject(self, e);\n                    }\n                  }\n                  function reject(self, newValue) {\n                    self._state = 2;\n                    self._value = newValue;\n                    finale(self);\n                  }\n                  function finale(self) {\n                    if (self._state === 2 && self._deferreds.length === 0) {\n                      Promise._immediateFn(function () {\n                        if (!self._handled) {\n                          Promise._unhandledRejectionFn(self._value);\n                        }\n                      });\n                    }\n                    for (var i = 0, len = self._deferreds.length; i < len; i++) {\n                      handle(self, self._deferreds[i]);\n                    }\n                    self._deferreds = null;\n                  }\n                  function Handler(onFulfilled, onRejected, promise) {\n                    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n                    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n                    this.promise = promise;\n                  }\n                  function doResolve(fn, self) {\n                    var done = false;\n                    try {\n                      fn(function (value) {\n                        if (done)\n                          return;\n                        done = true;\n                        resolve(self, value);\n                      }, function (reason) {\n                        if (done)\n                          return;\n                        done = true;\n                        reject(self, reason);\n                      });\n                    } catch (ex) {\n                      if (done)\n                        return;\n                      done = true;\n                      reject(self, ex);\n                    }\n                  }\n                  Promise.prototype['catch'] = function (onRejected) {\n                    return this.then(null, onRejected);\n                  };\n                  Promise.prototype.then = function (onFulfilled, onRejected) {\n                    var prom = new this.constructor(noop);\n                    handle(this, new Handler(onFulfilled, onRejected, prom));\n                    return prom;\n                  };\n                  Promise.all = function (arr) {\n                    var args = Array.prototype.slice.call(arr);\n                    return new Promise(function (resolve, reject) {\n                      if (args.length === 0)\n                        return resolve([]);\n                      var remaining = args.length;\n                      function res(i, val) {\n                        try {\n                          if (val && (typeof val === 'object' || typeof val === 'function')) {\n                            var then = val.then;\n                            if (typeof then === 'function') {\n                              then.call(val, function (val) {\n                                res(i, val);\n                              }, reject);\n                              return;\n                            }\n                          }\n                          args[i] = val;\n                          if (--remaining === 0) {\n                            resolve(args);\n                          }\n                        } catch (ex) {\n                          reject(ex);\n                        }\n                      }\n                      for (var i = 0; i < args.length; i++) {\n                        res(i, args[i]);\n                      }\n                    });\n                  };\n                  Promise.resolve = function (value) {\n                    if (value && typeof value === 'object' && value.constructor === Promise) {\n                      return value;\n                    }\n                    return new Promise(function (resolve) {\n                      resolve(value);\n                    });\n                  };\n                  Promise.reject = function (value) {\n                    return new Promise(function (resolve, reject) {\n                      reject(value);\n                    });\n                  };\n                  Promise.race = function (values) {\n                    return new Promise(function (resolve, reject) {\n                      for (var i = 0, len = values.length; i < len; i++) {\n                        values[i].then(resolve, reject);\n                      }\n                    });\n                  };\n                  Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n                    setImmediate(fn);\n                  } : function (fn) {\n                    setTimeoutFunc(fn, 0);\n                  };\n                  Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n                    if (typeof console !== 'undefined' && console) {\n                      console.warn('Possible Unhandled Promise Rejection:', err);\n                    }\n                  };\n                  Promise._setImmediateFn = function _setImmediateFn(fn) {\n                    Promise._immediateFn = fn;\n                  };\n                  Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n                    Promise._unhandledRejectionFn = fn;\n                  };\n                  if (typeof module !== 'undefined' && module.exports) {\n                    module.exports = Promise;\n                  } else if (!root.Promise) {\n                    root.Promise = Promise;\n                  }\n                }(this));\n              }.call(this, require('timers').setImmediate));\n            },\n            { 'timers': 3 }\n          ],\n          3: [\n            function (require, module, exports) {\n              (function (setImmediate, clearImmediate) {\n                var nextTick = require('process/browser.js').nextTick;\n                var apply = Function.prototype.apply;\n                var slice = Array.prototype.slice;\n                var immediateIds = {};\n                var nextImmediateId = 0;\n                exports.setTimeout = function () {\n                  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n                };\n                exports.setInterval = function () {\n                  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n                };\n                exports.clearTimeout = exports.clearInterval = function (timeout) {\n                  timeout.close();\n                };\n                function Timeout(id, clearFn) {\n                  this._id = id;\n                  this._clearFn = clearFn;\n                }\n                Timeout.prototype.unref = Timeout.prototype.ref = function () {\n                };\n                Timeout.prototype.close = function () {\n                  this._clearFn.call(window, this._id);\n                };\n                exports.enroll = function (item, msecs) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = msecs;\n                };\n                exports.unenroll = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = -1;\n                };\n                exports._unrefActive = exports.active = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  var msecs = item._idleTimeout;\n                  if (msecs >= 0) {\n                    item._idleTimeoutId = setTimeout(function onTimeout() {\n                      if (item._onTimeout)\n                        item._onTimeout();\n                    }, msecs);\n                  }\n                };\n                exports.setImmediate = typeof setImmediate === 'function' ? setImmediate : function (fn) {\n                  var id = nextImmediateId++;\n                  var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n                  immediateIds[id] = true;\n                  nextTick(function onNextTick() {\n                    if (immediateIds[id]) {\n                      if (args) {\n                        fn.apply(null, args);\n                      } else {\n                        fn.call(null);\n                      }\n                      exports.clearImmediate(id);\n                    }\n                  });\n                  return id;\n                };\n                exports.clearImmediate = typeof clearImmediate === 'function' ? clearImmediate : function (id) {\n                  delete immediateIds[id];\n                };\n              }.call(this, require('timers').setImmediate, require('timers').clearImmediate));\n            },\n            {\n              'process/browser.js': 1,\n              'timers': 3\n            }\n          ],\n          4: [\n            function (require, module, exports) {\n              var promisePolyfill = require('promise-polyfill');\n              var Global = function () {\n                if (typeof window !== 'undefined') {\n                  return window;\n                } else {\n                  return Function('return this;')();\n                }\n              }();\n              module.exports = { boltExport: Global.Promise || promisePolyfill };\n            },\n            { 'promise-polyfill': 2 }\n          ]\n        }, {}, [4])(4);\n      }));\n    }(undefined, exports$1, module$1, undefined));\n    var Promise = module$1.exports.boltExport;\n\n    var nu$3 = function (baseFn) {\n      var data = Optional.none();\n      var callbacks = [];\n      var map = function (f) {\n        return nu$3(function (nCallback) {\n          get(function (data) {\n            nCallback(f(data));\n          });\n        });\n      };\n      var get = function (nCallback) {\n        if (isReady()) {\n          call(nCallback);\n        } else {\n          callbacks.push(nCallback);\n        }\n      };\n      var set = function (x) {\n        if (!isReady()) {\n          data = Optional.some(x);\n          run(callbacks);\n          callbacks = [];\n        }\n      };\n      var isReady = function () {\n        return data.isSome();\n      };\n      var run = function (cbs) {\n        each(cbs, call);\n      };\n      var call = function (cb) {\n        data.each(function (x) {\n          setTimeout(function () {\n            cb(x);\n          }, 0);\n        });\n      };\n      baseFn(set);\n      return {\n        get: get,\n        map: map,\n        isReady: isReady\n      };\n    };\n    var pure = function (a) {\n      return nu$3(function (callback) {\n        callback(a);\n      });\n    };\n    var LazyValue = {\n      nu: nu$3,\n      pure: pure\n    };\n\n    var errorReporter = function (err) {\n      setTimeout(function () {\n        throw err;\n      }, 0);\n    };\n    var make = function (run) {\n      var get = function (callback) {\n        run().then(callback, errorReporter);\n      };\n      var map = function (fab) {\n        return make(function () {\n          return run().then(fab);\n        });\n      };\n      var bind = function (aFutureB) {\n        return make(function () {\n          return run().then(function (v) {\n            return aFutureB(v).toPromise();\n          });\n        });\n      };\n      var anonBind = function (futureB) {\n        return make(function () {\n          return run().then(function () {\n            return futureB.toPromise();\n          });\n        });\n      };\n      var toLazy = function () {\n        return LazyValue.nu(get);\n      };\n      var toCached = function () {\n        var cache = null;\n        return make(function () {\n          if (cache === null) {\n            cache = run();\n          }\n          return cache;\n        });\n      };\n      var toPromise = run;\n      return {\n        map: map,\n        bind: bind,\n        anonBind: anonBind,\n        toLazy: toLazy,\n        toCached: toCached,\n        toPromise: toPromise,\n        get: get\n      };\n    };\n    var nu$4 = function (baseFn) {\n      return make(function () {\n        return new Promise(baseFn);\n      });\n    };\n    var pure$1 = function (a) {\n      return make(function () {\n        return Promise.resolve(a);\n      });\n    };\n    var Future = {\n      nu: nu$4,\n      pure: pure$1\n    };\n\n    var par = function (asyncValues, nu) {\n      return nu(function (callback) {\n        var r = [];\n        var count = 0;\n        var cb = function (i) {\n          return function (value) {\n            r[i] = value;\n            count++;\n            if (count >= asyncValues.length) {\n              callback(r);\n            }\n          };\n        };\n        if (asyncValues.length === 0) {\n          callback([]);\n        } else {\n          each(asyncValues, function (asyncValue, i) {\n            asyncValue.get(cb(i));\n          });\n        }\n      });\n    };\n\n    var par$1 = function (futures) {\n      return par(futures, Future.nu);\n    };\n\n    var value = function (o) {\n      var is = function (v) {\n        return o === v;\n      };\n      var or = function (_opt) {\n        return value(o);\n      };\n      var orThunk = function (_f) {\n        return value(o);\n      };\n      var map = function (f) {\n        return value(f(o));\n      };\n      var mapError = function (_f) {\n        return value(o);\n      };\n      var each = function (f) {\n        f(o);\n      };\n      var bind = function (f) {\n        return f(o);\n      };\n      var fold = function (_, onValue) {\n        return onValue(o);\n      };\n      var exists = function (f) {\n        return f(o);\n      };\n      var forall = function (f) {\n        return f(o);\n      };\n      var toOptional = function () {\n        return Optional.some(o);\n      };\n      return {\n        is: is,\n        isValue: always,\n        isError: never,\n        getOr: constant(o),\n        getOrThunk: constant(o),\n        getOrDie: constant(o),\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: each,\n        bind: bind,\n        exists: exists,\n        forall: forall,\n        toOptional: toOptional\n      };\n    };\n    var error = function (message) {\n      var getOrThunk = function (f) {\n        return f();\n      };\n      var getOrDie = function () {\n        return die(String(message))();\n      };\n      var or = function (opt) {\n        return opt;\n      };\n      var orThunk = function (f) {\n        return f();\n      };\n      var map = function (_f) {\n        return error(message);\n      };\n      var mapError = function (f) {\n        return error(f(message));\n      };\n      var bind = function (_f) {\n        return error(message);\n      };\n      var fold = function (onError, _) {\n        return onError(message);\n      };\n      return {\n        is: never,\n        isValue: never,\n        isError: always,\n        getOr: identity,\n        getOrThunk: getOrThunk,\n        getOrDie: getOrDie,\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: noop,\n        bind: bind,\n        exists: never,\n        forall: always,\n        toOptional: Optional.none\n      };\n    };\n    var fromOption = function (opt, err) {\n      return opt.fold(function () {\n        return error(err);\n      }, value);\n    };\n    var Result = {\n      value: value,\n      error: error,\n      fromOption: fromOption\n    };\n\n    var generate = function (cases) {\n      if (!isArray(cases)) {\n        throw new Error('cases must be an array');\n      }\n      if (cases.length === 0) {\n        throw new Error('there must be at least one case');\n      }\n      var constructors = [];\n      var adt = {};\n      each(cases, function (acase, count) {\n        var keys$1 = keys(acase);\n        if (keys$1.length !== 1) {\n          throw new Error('one and only one name per case');\n        }\n        var key = keys$1[0];\n        var value = acase[key];\n        if (adt[key] !== undefined) {\n          throw new Error('duplicate key detected:' + key);\n        } else if (key === 'cata') {\n          throw new Error('cannot have a case named cata (sorry)');\n        } else if (!isArray(value)) {\n          throw new Error('case arguments must be an array');\n        }\n        constructors.push(key);\n        adt[key] = function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          var argLength = args.length;\n          if (argLength !== value.length) {\n            throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n          }\n          var match = function (branches) {\n            var branchKeys = keys(branches);\n            if (constructors.length !== branchKeys.length) {\n              throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n            }\n            var allReqd = forall(constructors, function (reqKey) {\n              return contains(branchKeys, reqKey);\n            });\n            if (!allReqd) {\n              throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n            }\n            return branches[key].apply(null, args);\n          };\n          return {\n            fold: function () {\n              var foldArgs = [];\n              for (var _i = 0; _i < arguments.length; _i++) {\n                foldArgs[_i] = arguments[_i];\n              }\n              if (foldArgs.length !== cases.length) {\n                throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + foldArgs.length);\n              }\n              var target = foldArgs[count];\n              return target.apply(null, args);\n            },\n            match: match,\n            log: function (label) {\n              console.log(label, {\n                constructors: constructors,\n                constructor: key,\n                params: args\n              });\n            }\n          };\n        };\n      });\n      return adt;\n    };\n    var Adt = { generate: generate };\n\n    var comparison = Adt.generate([\n      {\n        bothErrors: [\n          'error1',\n          'error2'\n        ]\n      },\n      {\n        firstError: [\n          'error1',\n          'value2'\n        ]\n      },\n      {\n        secondError: [\n          'value1',\n          'error2'\n        ]\n      },\n      {\n        bothValues: [\n          'value1',\n          'value2'\n        ]\n      }\n    ]);\n    var unite = function (result) {\n      return result.fold(identity, identity);\n    };\n\n    function ClosestOrAncestor (is, ancestor, scope, a, isRoot) {\n      if (is(scope, a)) {\n        return Optional.some(scope);\n      } else if (isFunction(isRoot) && isRoot(scope)) {\n        return Optional.none();\n      } else {\n        return ancestor(scope, a, isRoot);\n      }\n    }\n\n    var ancestor = function (scope, predicate, isRoot) {\n      var element = scope.dom;\n      var stop = isFunction(isRoot) ? isRoot : never;\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = SugarElement.fromDom(element);\n        if (predicate(el)) {\n          return Optional.some(el);\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var closest = function (scope, predicate, isRoot) {\n      var is = function (s, test) {\n        return test(s);\n      };\n      return ClosestOrAncestor(is, ancestor, scope, predicate, isRoot);\n    };\n    var sibling = function (scope, predicate) {\n      var element = scope.dom;\n      if (!element.parentNode) {\n        return Optional.none();\n      }\n      return child$1(SugarElement.fromDom(element.parentNode), function (x) {\n        return !eq$2(scope, x) && predicate(x);\n      });\n    };\n    var child$1 = function (scope, predicate) {\n      var pred = function (node) {\n        return predicate(SugarElement.fromDom(node));\n      };\n      var result = find(scope.dom.childNodes, pred);\n      return result.map(SugarElement.fromDom);\n    };\n\n    var ancestor$1 = function (scope, selector, isRoot) {\n      return ancestor(scope, function (e) {\n        return is$1(e, selector);\n      }, isRoot);\n    };\n    var descendant = function (scope, selector) {\n      return one(selector, scope);\n    };\n    var closest$1 = function (scope, selector, isRoot) {\n      var is = function (element, selector) {\n        return is$1(element, selector);\n      };\n      return ClosestOrAncestor(is, ancestor$1, scope, selector, isRoot);\n    };\n\n    var promise = function () {\n      var bind = function (fn, thisArg) {\n        return function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          fn.apply(thisArg, args);\n        };\n      };\n      var isArray = Array.isArray || function (value) {\n        return Object.prototype.toString.call(value) === '[object Array]';\n      };\n      var Promise = function (fn) {\n        if (typeof this !== 'object') {\n          throw new TypeError('Promises must be constructed via new');\n        }\n        if (typeof fn !== 'function') {\n          throw new TypeError('not a function');\n        }\n        this._state = null;\n        this._value = null;\n        this._deferreds = [];\n        doResolve(fn, bind(resolve, this), bind(reject, this));\n      };\n      var asap = Promise.immediateFn || typeof setImmediate === 'function' && setImmediate || function (fn) {\n        return setTimeout(fn, 1);\n      };\n      function handle(deferred) {\n        var me = this;\n        if (this._state === null) {\n          this._deferreds.push(deferred);\n          return;\n        }\n        asap(function () {\n          var cb = me._state ? deferred.onFulfilled : deferred.onRejected;\n          if (cb === null) {\n            (me._state ? deferred.resolve : deferred.reject)(me._value);\n            return;\n          }\n          var ret;\n          try {\n            ret = cb(me._value);\n          } catch (e) {\n            deferred.reject(e);\n            return;\n          }\n          deferred.resolve(ret);\n        });\n      }\n      function resolve(newValue) {\n        try {\n          if (newValue === this) {\n            throw new TypeError('A promise cannot be resolved with itself.');\n          }\n          if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n            var then = newValue.then;\n            if (typeof then === 'function') {\n              doResolve(bind(then, newValue), bind(resolve, this), bind(reject, this));\n              return;\n            }\n          }\n          this._state = true;\n          this._value = newValue;\n          finale.call(this);\n        } catch (e) {\n          reject.call(this, e);\n        }\n      }\n      function reject(newValue) {\n        this._state = false;\n        this._value = newValue;\n        finale.call(this);\n      }\n      function finale() {\n        for (var i = 0, len = this._deferreds.length; i < len; i++) {\n          handle.call(this, this._deferreds[i]);\n        }\n        this._deferreds = null;\n      }\n      function Handler(onFulfilled, onRejected, resolve, reject) {\n        this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n        this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n        this.resolve = resolve;\n        this.reject = reject;\n      }\n      var doResolve = function (fn, onFulfilled, onRejected) {\n        var done = false;\n        try {\n          fn(function (value) {\n            if (done) {\n              return;\n            }\n            done = true;\n            onFulfilled(value);\n          }, function (reason) {\n            if (done) {\n              return;\n            }\n            done = true;\n            onRejected(reason);\n          });\n        } catch (ex) {\n          if (done) {\n            return;\n          }\n          done = true;\n          onRejected(ex);\n        }\n      };\n      Promise.prototype.catch = function (onRejected) {\n        return this.then(null, onRejected);\n      };\n      Promise.prototype.then = function (onFulfilled, onRejected) {\n        var me = this;\n        return new Promise(function (resolve, reject) {\n          handle.call(me, new Handler(onFulfilled, onRejected, resolve, reject));\n        });\n      };\n      Promise.all = function () {\n        var values = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          values[_i] = arguments[_i];\n        }\n        var args = Array.prototype.slice.call(values.length === 1 && isArray(values[0]) ? values[0] : values);\n        return new Promise(function (resolve, reject) {\n          if (args.length === 0) {\n            return resolve([]);\n          }\n          var remaining = args.length;\n          var res = function (i, val) {\n            try {\n              if (val && (typeof val === 'object' || typeof val === 'function')) {\n                var then = val.then;\n                if (typeof then === 'function') {\n                  then.call(val, function (val) {\n                    res(i, val);\n                  }, reject);\n                  return;\n                }\n              }\n              args[i] = val;\n              if (--remaining === 0) {\n                resolve(args);\n              }\n            } catch (ex) {\n              reject(ex);\n            }\n          };\n          for (var i = 0; i < args.length; i++) {\n            res(i, args[i]);\n          }\n        });\n      };\n      Promise.resolve = function (value) {\n        if (value && typeof value === 'object' && value.constructor === Promise) {\n          return value;\n        }\n        return new Promise(function (resolve) {\n          resolve(value);\n        });\n      };\n      Promise.reject = function (value) {\n        return new Promise(function (resolve, reject) {\n          reject(value);\n        });\n      };\n      Promise.race = function (values) {\n        return new Promise(function (resolve, reject) {\n          for (var i = 0, len = values.length; i < len; i++) {\n            values[i].then(resolve, reject);\n          }\n        });\n      };\n      return Promise;\n    };\n    var promiseObj = window.Promise ? window.Promise : promise();\n\n    var requestAnimationFramePromise;\n    var requestAnimationFrame = function (callback, element) {\n      var requestAnimationFrameFunc = window.requestAnimationFrame;\n      var vendors = [\n        'ms',\n        'moz',\n        'webkit'\n      ];\n      var featurefill = function (cb) {\n        window.setTimeout(cb, 0);\n      };\n      for (var i = 0; i < vendors.length && !requestAnimationFrameFunc; i++) {\n        requestAnimationFrameFunc = window[vendors[i] + 'RequestAnimationFrame'];\n      }\n      if (!requestAnimationFrameFunc) {\n        requestAnimationFrameFunc = featurefill;\n      }\n      requestAnimationFrameFunc(callback, element);\n    };\n    var wrappedSetTimeout = function (callback, time) {\n      if (typeof time !== 'number') {\n        time = 0;\n      }\n      return setTimeout(callback, time);\n    };\n    var wrappedSetInterval = function (callback, time) {\n      if (typeof time !== 'number') {\n        time = 1;\n      }\n      return setInterval(callback, time);\n    };\n    var wrappedClearTimeout = function (id) {\n      return clearTimeout(id);\n    };\n    var wrappedClearInterval = function (id) {\n      return clearInterval(id);\n    };\n    var debounce = function (callback, time) {\n      var timer;\n      var func = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        clearTimeout(timer);\n        timer = wrappedSetTimeout(function () {\n          callback.apply(this, args);\n        }, time);\n      };\n      func.stop = function () {\n        clearTimeout(timer);\n      };\n      return func;\n    };\n    var Delay = {\n      requestAnimationFrame: function (callback, element) {\n        if (requestAnimationFramePromise) {\n          requestAnimationFramePromise.then(callback);\n          return;\n        }\n        requestAnimationFramePromise = new promiseObj(function (resolve) {\n          if (!element) {\n            element = document.body;\n          }\n          requestAnimationFrame(resolve, element);\n        }).then(callback);\n      },\n      setTimeout: wrappedSetTimeout,\n      setInterval: wrappedSetInterval,\n      setEditorTimeout: function (editor, callback, time) {\n        return wrappedSetTimeout(function () {\n          if (!editor.removed) {\n            callback();\n          }\n        }, time);\n      },\n      setEditorInterval: function (editor, callback, time) {\n        var timer = wrappedSetInterval(function () {\n          if (!editor.removed) {\n            callback();\n          } else {\n            clearInterval(timer);\n          }\n        }, time);\n        return timer;\n      },\n      debounce: debounce,\n      throttle: debounce,\n      clearInterval: wrappedClearInterval,\n      clearTimeout: wrappedClearTimeout\n    };\n\n    var StyleSheetLoader = function (documentOrShadowRoot, settings) {\n      if (settings === void 0) {\n        settings = {};\n      }\n      var idCount = 0;\n      var loadedStates = {};\n      var edos = SugarElement.fromDom(documentOrShadowRoot);\n      var doc = documentOrOwner(edos);\n      var maxLoadTime = settings.maxLoadTime || 5000;\n      var _setReferrerPolicy = function (referrerPolicy) {\n        settings.referrerPolicy = referrerPolicy;\n      };\n      var addStyle = function (element) {\n        append(getStyleContainer(edos), element);\n      };\n      var removeStyle = function (id) {\n        var styleContainer = getStyleContainer(edos);\n        descendant(styleContainer, '#' + id).each(remove);\n      };\n      var getOrCreateState = function (url) {\n        return get$1(loadedStates, url).getOrThunk(function () {\n          return {\n            id: 'mce-u' + idCount++,\n            passed: [],\n            failed: [],\n            count: 0\n          };\n        });\n      };\n      var load = function (url, success, failure) {\n        var link;\n        var urlWithSuffix = Tools._addCacheSuffix(url);\n        var state = getOrCreateState(urlWithSuffix);\n        loadedStates[urlWithSuffix] = state;\n        state.count++;\n        var resolve = function (callbacks, status) {\n          var i = callbacks.length;\n          while (i--) {\n            callbacks[i]();\n          }\n          state.status = status;\n          state.passed = [];\n          state.failed = [];\n          if (link) {\n            link.onload = null;\n            link.onerror = null;\n            link = null;\n          }\n        };\n        var passed = function () {\n          return resolve(state.passed, 2);\n        };\n        var failed = function () {\n          return resolve(state.failed, 3);\n        };\n        var wait = function (testCallback, waitCallback) {\n          if (!testCallback()) {\n            if (Date.now() - startTime < maxLoadTime) {\n              Delay.setTimeout(waitCallback);\n            } else {\n              failed();\n            }\n          }\n        };\n        var waitForWebKitLinkLoaded = function () {\n          wait(function () {\n            var styleSheets = documentOrShadowRoot.styleSheets;\n            var i = styleSheets.length;\n            while (i--) {\n              var styleSheet = styleSheets[i];\n              var owner = styleSheet.ownerNode;\n              if (owner && owner.id === link.id) {\n                passed();\n                return true;\n              }\n            }\n            return false;\n          }, waitForWebKitLinkLoaded);\n        };\n        if (success) {\n          state.passed.push(success);\n        }\n        if (failure) {\n          state.failed.push(failure);\n        }\n        if (state.status === 1) {\n          return;\n        }\n        if (state.status === 2) {\n          passed();\n          return;\n        }\n        if (state.status === 3) {\n          failed();\n          return;\n        }\n        state.status = 1;\n        var linkElem = SugarElement.fromTag('link', doc.dom);\n        setAll(linkElem, {\n          rel: 'stylesheet',\n          type: 'text/css',\n          id: state.id\n        });\n        var startTime = Date.now();\n        if (settings.contentCssCors) {\n          set(linkElem, 'crossOrigin', 'anonymous');\n        }\n        if (settings.referrerPolicy) {\n          set(linkElem, 'referrerpolicy', settings.referrerPolicy);\n        }\n        link = linkElem.dom;\n        link.onload = waitForWebKitLinkLoaded;\n        link.onerror = failed;\n        addStyle(linkElem);\n        set(linkElem, 'href', urlWithSuffix);\n      };\n      var loadF = function (url) {\n        return Future.nu(function (resolve) {\n          load(url, compose(resolve, constant(Result.value(url))), compose(resolve, constant(Result.error(url))));\n        });\n      };\n      var loadAll = function (urls, success, failure) {\n        par$1(map(urls, loadF)).get(function (result) {\n          var parts = partition(result, function (r) {\n            return r.isValue();\n          });\n          if (parts.fail.length > 0) {\n            failure(parts.fail.map(unite));\n          } else {\n            success(parts.pass.map(unite));\n          }\n        });\n      };\n      var unload = function (url) {\n        var urlWithSuffix = Tools._addCacheSuffix(url);\n        get$1(loadedStates, urlWithSuffix).each(function (state) {\n          var count = --state.count;\n          if (count === 0) {\n            delete loadedStates[urlWithSuffix];\n            removeStyle(state.id);\n          }\n        });\n      };\n      var unloadAll = function (urls) {\n        each(urls, function (url) {\n          unload(url);\n        });\n      };\n      return {\n        load: load,\n        loadAll: loadAll,\n        unload: unload,\n        unloadAll: unloadAll,\n        _setReferrerPolicy: _setReferrerPolicy\n      };\n    };\n\n    var create$1 = function () {\n      var map = new WeakMap();\n      var forElement = function (referenceElement, settings) {\n        var root = getRootNode(referenceElement);\n        var rootDom = root.dom;\n        return Optional.from(map.get(rootDom)).getOrThunk(function () {\n          var sl = StyleSheetLoader(rootDom, settings);\n          map.set(rootDom, sl);\n          return sl;\n        });\n      };\n      return { forElement: forElement };\n    };\n    var instance = create$1();\n\n    var DomTreeWalker = function () {\n      function DomTreeWalker(startNode, rootNode) {\n        this.node = startNode;\n        this.rootNode = rootNode;\n        this.current = this.current.bind(this);\n        this.next = this.next.bind(this);\n        this.prev = this.prev.bind(this);\n        this.prev2 = this.prev2.bind(this);\n      }\n      DomTreeWalker.prototype.current = function () {\n        return this.node;\n      };\n      DomTreeWalker.prototype.next = function (shallow) {\n        this.node = this.findSibling(this.node, 'firstChild', 'nextSibling', shallow);\n        return this.node;\n      };\n      DomTreeWalker.prototype.prev = function (shallow) {\n        this.node = this.findSibling(this.node, 'lastChild', 'previousSibling', shallow);\n        return this.node;\n      };\n      DomTreeWalker.prototype.prev2 = function (shallow) {\n        this.node = this.findPreviousNode(this.node, 'lastChild', 'previousSibling', shallow);\n        return this.node;\n      };\n      DomTreeWalker.prototype.findSibling = function (node, startName, siblingName, shallow) {\n        var sibling, parent;\n        if (node) {\n          if (!shallow && node[startName]) {\n            return node[startName];\n          }\n          if (node !== this.rootNode) {\n            sibling = node[siblingName];\n            if (sibling) {\n              return sibling;\n            }\n            for (parent = node.parentNode; parent && parent !== this.rootNode; parent = parent.parentNode) {\n              sibling = parent[siblingName];\n              if (sibling) {\n                return sibling;\n              }\n            }\n          }\n        }\n      };\n      DomTreeWalker.prototype.findPreviousNode = function (node, startName, siblingName, shallow) {\n        var sibling, parent, child;\n        if (node) {\n          sibling = node[siblingName];\n          if (this.rootNode && sibling === this.rootNode) {\n            return;\n          }\n          if (sibling) {\n            if (!shallow) {\n              for (child = sibling[startName]; child; child = child[startName]) {\n                if (!child[startName]) {\n                  return child;\n                }\n              }\n            }\n            return sibling;\n          }\n          parent = node.parentNode;\n          if (parent && parent !== this.rootNode) {\n            return parent;\n          }\n        }\n      };\n      return DomTreeWalker;\n    }();\n\n    var blocks = [\n      'article',\n      'aside',\n      'details',\n      'div',\n      'dt',\n      'figcaption',\n      'footer',\n      'form',\n      'fieldset',\n      'header',\n      'hgroup',\n      'html',\n      'main',\n      'nav',\n      'section',\n      'summary',\n      'body',\n      'p',\n      'dl',\n      'multicol',\n      'dd',\n      'figure',\n      'address',\n      'center',\n      'blockquote',\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'listing',\n      'xmp',\n      'pre',\n      'plaintext',\n      'menu',\n      'dir',\n      'ul',\n      'ol',\n      'li',\n      'hr',\n      'table',\n      'tbody',\n      'thead',\n      'tfoot',\n      'th',\n      'tr',\n      'td',\n      'caption'\n    ];\n    var tableCells = [\n      'td',\n      'th'\n    ];\n    var tableSections = [\n      'thead',\n      'tbody',\n      'tfoot'\n    ];\n    var textBlocks = [\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'p',\n      'div',\n      'address',\n      'pre',\n      'form',\n      'blockquote',\n      'center',\n      'dir',\n      'fieldset',\n      'header',\n      'footer',\n      'article',\n      'section',\n      'hgroup',\n      'aside',\n      'nav',\n      'figure'\n    ];\n    var headings = [\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6'\n    ];\n    var listItems = [\n      'li',\n      'dd',\n      'dt'\n    ];\n    var lists = [\n      'ul',\n      'ol',\n      'dl'\n    ];\n    var wsElements = [\n      'pre',\n      'script',\n      'textarea',\n      'style'\n    ];\n    var lazyLookup = function (items) {\n      var lookup;\n      return function (node) {\n        lookup = lookup ? lookup : mapToObject(items, always);\n        return lookup.hasOwnProperty(name(node));\n      };\n    };\n    var isHeading = lazyLookup(headings);\n    var isBlock = lazyLookup(blocks);\n    var isTable$1 = function (node) {\n      return name(node) === 'table';\n    };\n    var isInline = function (node) {\n      return isElement(node) && !isBlock(node);\n    };\n    var isBr$1 = function (node) {\n      return isElement(node) && name(node) === 'br';\n    };\n    var isTextBlock = lazyLookup(textBlocks);\n    var isList = lazyLookup(lists);\n    var isListItem = lazyLookup(listItems);\n    var isTableSection = lazyLookup(tableSections);\n    var isTableCell$1 = lazyLookup(tableCells);\n    var isWsPreserveElement = lazyLookup(wsElements);\n\n    var ancestor$2 = function (scope, selector, isRoot) {\n      return ancestor$1(scope, selector, isRoot).isSome();\n    };\n\n    var zeroWidth = '\\uFEFF';\n    var nbsp = '\\xA0';\n    var isZwsp = function (char) {\n      return char === zeroWidth;\n    };\n    var removeZwsp = function (s) {\n      return s.replace(/\\uFEFF/g, '');\n    };\n\n    var ZWSP = zeroWidth;\n    var isZwsp$1 = isZwsp;\n    var trim$2 = removeZwsp;\n\n    var isElement$2 = isElement$1;\n    var isText$2 = isText$1;\n    var isCaretContainerBlock = function (node) {\n      if (isText$2(node)) {\n        node = node.parentNode;\n      }\n      return isElement$2(node) && node.hasAttribute('data-mce-caret');\n    };\n    var isCaretContainerInline = function (node) {\n      return isText$2(node) && isZwsp$1(node.data);\n    };\n    var isCaretContainer = function (node) {\n      return isCaretContainerBlock(node) || isCaretContainerInline(node);\n    };\n    var hasContent = function (node) {\n      return node.firstChild !== node.lastChild || !isBr(node.firstChild);\n    };\n    var insertInline = function (node, before) {\n      var sibling;\n      var doc = node.ownerDocument;\n      var textNode = doc.createTextNode(ZWSP);\n      var parentNode = node.parentNode;\n      if (!before) {\n        sibling = node.nextSibling;\n        if (isText$2(sibling)) {\n          if (isCaretContainer(sibling)) {\n            return sibling;\n          }\n          if (startsWithCaretContainer(sibling)) {\n            sibling.splitText(1);\n            return sibling;\n          }\n        }\n        if (node.nextSibling) {\n          parentNode.insertBefore(textNode, node.nextSibling);\n        } else {\n          parentNode.appendChild(textNode);\n        }\n      } else {\n        sibling = node.previousSibling;\n        if (isText$2(sibling)) {\n          if (isCaretContainer(sibling)) {\n            return sibling;\n          }\n          if (endsWithCaretContainer(sibling)) {\n            return sibling.splitText(sibling.data.length - 1);\n          }\n        }\n        parentNode.insertBefore(textNode, node);\n      }\n      return textNode;\n    };\n    var isBeforeInline = function (pos) {\n      var container = pos.container();\n      if (!isText$1(container)) {\n        return false;\n      }\n      return container.data.charAt(pos.offset()) === ZWSP || pos.isAtStart() && isCaretContainerInline(container.previousSibling);\n    };\n    var isAfterInline = function (pos) {\n      var container = pos.container();\n      if (!isText$1(container)) {\n        return false;\n      }\n      return container.data.charAt(pos.offset() - 1) === ZWSP || pos.isAtEnd() && isCaretContainerInline(container.nextSibling);\n    };\n    var createBogusBr = function () {\n      var br = document.createElement('br');\n      br.setAttribute('data-mce-bogus', '1');\n      return br;\n    };\n    var insertBlock = function (blockName, node, before) {\n      var doc = node.ownerDocument;\n      var blockNode = doc.createElement(blockName);\n      blockNode.setAttribute('data-mce-caret', before ? 'before' : 'after');\n      blockNode.setAttribute('data-mce-bogus', 'all');\n      blockNode.appendChild(createBogusBr());\n      var parentNode = node.parentNode;\n      if (!before) {\n        if (node.nextSibling) {\n          parentNode.insertBefore(blockNode, node.nextSibling);\n        } else {\n          parentNode.appendChild(blockNode);\n        }\n      } else {\n        parentNode.insertBefore(blockNode, node);\n      }\n      return blockNode;\n    };\n    var startsWithCaretContainer = function (node) {\n      return isText$2(node) && node.data[0] === ZWSP;\n    };\n    var endsWithCaretContainer = function (node) {\n      return isText$2(node) && node.data[node.data.length - 1] === ZWSP;\n    };\n    var trimBogusBr = function (elm) {\n      var brs = elm.getElementsByTagName('br');\n      var lastBr = brs[brs.length - 1];\n      if (isBogus(lastBr)) {\n        lastBr.parentNode.removeChild(lastBr);\n      }\n    };\n    var showCaretContainerBlock = function (caretContainer) {\n      if (caretContainer && caretContainer.hasAttribute('data-mce-caret')) {\n        trimBogusBr(caretContainer);\n        caretContainer.removeAttribute('data-mce-caret');\n        caretContainer.removeAttribute('data-mce-bogus');\n        caretContainer.removeAttribute('style');\n        caretContainer.removeAttribute('_moz_abspos');\n        return caretContainer;\n      }\n      return null;\n    };\n    var isRangeInCaretContainerBlock = function (range) {\n      return isCaretContainerBlock(range.startContainer);\n    };\n\n    var isContentEditableTrue$1 = isContentEditableTrue;\n    var isContentEditableFalse$1 = isContentEditableFalse;\n    var isBr$2 = isBr;\n    var isText$3 = isText$1;\n    var isInvalidTextElement = matchNodeNames([\n      'script',\n      'style',\n      'textarea'\n    ]);\n    var isAtomicInline = matchNodeNames([\n      'img',\n      'input',\n      'textarea',\n      'hr',\n      'iframe',\n      'video',\n      'audio',\n      'object',\n      'embed'\n    ]);\n    var isTable$2 = matchNodeNames(['table']);\n    var isCaretContainer$1 = isCaretContainer;\n    var isCaretCandidate = function (node) {\n      if (isCaretContainer$1(node)) {\n        return false;\n      }\n      if (isText$3(node)) {\n        return !isInvalidTextElement(node.parentNode);\n      }\n      return isAtomicInline(node) || isBr$2(node) || isTable$2(node) || isNonUiContentEditableFalse(node);\n    };\n    var isUnselectable = function (node) {\n      return isElement$1(node) && node.getAttribute('unselectable') === 'true';\n    };\n    var isNonUiContentEditableFalse = function (node) {\n      return isUnselectable(node) === false && isContentEditableFalse$1(node);\n    };\n    var isInEditable = function (node, root) {\n      for (node = node.parentNode; node && node !== root; node = node.parentNode) {\n        if (isNonUiContentEditableFalse(node)) {\n          return false;\n        }\n        if (isContentEditableTrue$1(node)) {\n          return true;\n        }\n      }\n      return true;\n    };\n    var isAtomicContentEditableFalse = function (node) {\n      if (!isNonUiContentEditableFalse(node)) {\n        return false;\n      }\n      return foldl(from$1(node.getElementsByTagName('*')), function (result, elm) {\n        return result || isContentEditableTrue$1(elm);\n      }, false) !== true;\n    };\n    var isAtomic = function (node) {\n      return isAtomicInline(node) || isAtomicContentEditableFalse(node);\n    };\n    var isEditableCaretCandidate = function (node, root) {\n      return isCaretCandidate(node) && isInEditable(node, root);\n    };\n\n    var whiteSpaceRegExp$1 = /^[ \\t\\r\\n]*$/;\n    var isWhitespaceText = function (text) {\n      return whiteSpaceRegExp$1.test(text);\n    };\n\n    var hasWhitespacePreserveParent = function (node, rootNode) {\n      var rootElement = SugarElement.fromDom(rootNode);\n      var startNode = SugarElement.fromDom(node);\n      return ancestor$2(startNode, 'pre,code', curry(eq$2, rootElement));\n    };\n    var isWhitespace = function (node, rootNode) {\n      return isText$1(node) && isWhitespaceText(node.data) && hasWhitespacePreserveParent(node, rootNode) === false;\n    };\n    var isNamedAnchor = function (node) {\n      return isElement$1(node) && node.nodeName === 'A' && !node.hasAttribute('href') && (node.hasAttribute('name') || node.hasAttribute('id'));\n    };\n    var isContent = function (node, rootNode) {\n      return isCaretCandidate(node) && isWhitespace(node, rootNode) === false || isNamedAnchor(node) || isBookmark(node);\n    };\n    var isBookmark = hasAttribute('data-mce-bookmark');\n    var isBogus$1 = hasAttribute('data-mce-bogus');\n    var isBogusAll$1 = hasAttributeValue('data-mce-bogus', 'all');\n    var isEmptyNode = function (targetNode, skipBogus) {\n      var node, brCount = 0;\n      if (isContent(targetNode, targetNode)) {\n        return false;\n      } else {\n        node = targetNode.firstChild;\n        if (!node) {\n          return true;\n        }\n        var walker = new DomTreeWalker(node, targetNode);\n        do {\n          if (skipBogus) {\n            if (isBogusAll$1(node)) {\n              node = walker.next(true);\n              continue;\n            }\n            if (isBogus$1(node)) {\n              node = walker.next();\n              continue;\n            }\n          }\n          if (isBr(node)) {\n            brCount++;\n            node = walker.next();\n            continue;\n          }\n          if (isContent(node, targetNode)) {\n            return false;\n          }\n          node = walker.next();\n        } while (node);\n        return brCount <= 1;\n      }\n    };\n    var isEmpty = function (elm, skipBogus) {\n      if (skipBogus === void 0) {\n        skipBogus = true;\n      }\n      return isEmptyNode(elm.dom, skipBogus);\n    };\n\n    var isSpan = function (node) {\n      return node.nodeName.toLowerCase() === 'span';\n    };\n    var isInlineContent = function (node, root) {\n      return isNonNullable(node) && (isContent(node, root) || isInline(SugarElement.fromDom(node)));\n    };\n    var surroundedByInlineContent = function (node, root) {\n      var prev = new DomTreeWalker(node, root).prev(false);\n      var next = new DomTreeWalker(node, root).next(false);\n      var prevIsInline = isUndefined(prev) || isInlineContent(prev, root);\n      var nextIsInline = isUndefined(next) || isInlineContent(next, root);\n      return prevIsInline && nextIsInline;\n    };\n    var isBookmarkNode = function (node) {\n      return isSpan(node) && node.getAttribute('data-mce-type') === 'bookmark';\n    };\n    var isKeepTextNode = function (node, root) {\n      return isText$1(node) && node.data.length > 0 && surroundedByInlineContent(node, root);\n    };\n    var isKeepElement = function (node) {\n      return isElement$1(node) ? node.childNodes.length > 0 : false;\n    };\n    var isDocument$2 = function (node) {\n      return isDocumentFragment$1(node) || isDocument$1(node);\n    };\n    var trimNode = function (dom, node, root) {\n      var rootNode = root || node;\n      if (isElement$1(node) && isBookmarkNode(node)) {\n        return node;\n      }\n      var children = node.childNodes;\n      for (var i = children.length - 1; i >= 0; i--) {\n        trimNode(dom, children[i], rootNode);\n      }\n      if (isElement$1(node)) {\n        var currentChildren = node.childNodes;\n        if (currentChildren.length === 1 && isBookmarkNode(currentChildren[0])) {\n          node.parentNode.insertBefore(currentChildren[0], node);\n        }\n      }\n      if (!isDocument$2(node) && !isContent(node, rootNode) && !isKeepElement(node) && !isKeepTextNode(node, rootNode)) {\n        dom.remove(node);\n      }\n      return node;\n    };\n\n    var makeMap$1 = Tools.makeMap;\n    var attrsCharsRegExp = /[&<>\\\"\\u0060\\u007E-\\uD7FF\\uE000-\\uFFEF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g;\n    var textCharsRegExp = /[<>&\\u007E-\\uD7FF\\uE000-\\uFFEF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g;\n    var rawCharsRegExp = /[<>&\\\"\\']/g;\n    var entityRegExp = /&#([a-z0-9]+);?|&([a-z0-9]+);/gi;\n    var asciiMap = {\n      128: '\\u20AC',\n      130: '\\u201A',\n      131: '\\u0192',\n      132: '\\u201E',\n      133: '\\u2026',\n      134: '\\u2020',\n      135: '\\u2021',\n      136: '\\u02c6',\n      137: '\\u2030',\n      138: '\\u0160',\n      139: '\\u2039',\n      140: '\\u0152',\n      142: '\\u017d',\n      145: '\\u2018',\n      146: '\\u2019',\n      147: '\\u201C',\n      148: '\\u201D',\n      149: '\\u2022',\n      150: '\\u2013',\n      151: '\\u2014',\n      152: '\\u02DC',\n      153: '\\u2122',\n      154: '\\u0161',\n      155: '\\u203A',\n      156: '\\u0153',\n      158: '\\u017e',\n      159: '\\u0178'\n    };\n    var baseEntities = {\n      '\"': '&quot;',\n      '\\'': '&#39;',\n      '<': '&lt;',\n      '>': '&gt;',\n      '&': '&amp;',\n      '`': '&#96;'\n    };\n    var reverseEntities = {\n      '&lt;': '<',\n      '&gt;': '>',\n      '&amp;': '&',\n      '&quot;': '\"',\n      '&apos;': '\\''\n    };\n    var nativeDecode = function (text) {\n      var elm = SugarElement.fromTag('div').dom;\n      elm.innerHTML = text;\n      return elm.textContent || elm.innerText || text;\n    };\n    var buildEntitiesLookup = function (items, radix) {\n      var i, chr, entity;\n      var lookup = {};\n      if (items) {\n        items = items.split(',');\n        radix = radix || 10;\n        for (i = 0; i < items.length; i += 2) {\n          chr = String.fromCharCode(parseInt(items[i], radix));\n          if (!baseEntities[chr]) {\n            entity = '&' + items[i + 1] + ';';\n            lookup[chr] = entity;\n            lookup[entity] = chr;\n          }\n        }\n        return lookup;\n      }\n    };\n    var namedEntities = buildEntitiesLookup('50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,' + '5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,' + '5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,' + '5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,' + '68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,' + '6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,' + '6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,' + '75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,' + '7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,' + '7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,' + 'sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,' + 'st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,' + 't9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,' + 'tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,' + 'u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,' + '81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,' + '8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,' + '8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,' + '8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,' + '8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,' + 'nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,' + 'rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,' + 'Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,' + '80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,' + '811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro', 32);\n    var encodeRaw = function (text, attr) {\n      return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n        return baseEntities[chr] || chr;\n      });\n    };\n    var encodeAllRaw = function (text) {\n      return ('' + text).replace(rawCharsRegExp, function (chr) {\n        return baseEntities[chr] || chr;\n      });\n    };\n    var encodeNumeric = function (text, attr) {\n      return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n        if (chr.length > 1) {\n          return '&#' + ((chr.charCodeAt(0) - 55296) * 1024 + (chr.charCodeAt(1) - 56320) + 65536) + ';';\n        }\n        return baseEntities[chr] || '&#' + chr.charCodeAt(0) + ';';\n      });\n    };\n    var encodeNamed = function (text, attr, entities) {\n      entities = entities || namedEntities;\n      return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n        return baseEntities[chr] || entities[chr] || chr;\n      });\n    };\n    var getEncodeFunc = function (name, entities) {\n      var entitiesMap = buildEntitiesLookup(entities) || namedEntities;\n      var encodeNamedAndNumeric = function (text, attr) {\n        return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n          if (baseEntities[chr] !== undefined) {\n            return baseEntities[chr];\n          }\n          if (entitiesMap[chr] !== undefined) {\n            return entitiesMap[chr];\n          }\n          if (chr.length > 1) {\n            return '&#' + ((chr.charCodeAt(0) - 55296) * 1024 + (chr.charCodeAt(1) - 56320) + 65536) + ';';\n          }\n          return '&#' + chr.charCodeAt(0) + ';';\n        });\n      };\n      var encodeCustomNamed = function (text, attr) {\n        return encodeNamed(text, attr, entitiesMap);\n      };\n      var nameMap = makeMap$1(name.replace(/\\+/g, ','));\n      if (nameMap.named && nameMap.numeric) {\n        return encodeNamedAndNumeric;\n      }\n      if (nameMap.named) {\n        if (entities) {\n          return encodeCustomNamed;\n        }\n        return encodeNamed;\n      }\n      if (nameMap.numeric) {\n        return encodeNumeric;\n      }\n      return encodeRaw;\n    };\n    var decode = function (text) {\n      return text.replace(entityRegExp, function (all, numeric) {\n        if (numeric) {\n          if (numeric.charAt(0).toLowerCase() === 'x') {\n            numeric = parseInt(numeric.substr(1), 16);\n          } else {\n            numeric = parseInt(numeric, 10);\n          }\n          if (numeric > 65535) {\n            numeric -= 65536;\n            return String.fromCharCode(55296 + (numeric >> 10), 56320 + (numeric & 1023));\n          }\n          return asciiMap[numeric] || String.fromCharCode(numeric);\n        }\n        return reverseEntities[all] || namedEntities[all] || nativeDecode(all);\n      });\n    };\n    var Entities = {\n      encodeRaw: encodeRaw,\n      encodeAllRaw: encodeAllRaw,\n      encodeNumeric: encodeNumeric,\n      encodeNamed: encodeNamed,\n      getEncodeFunc: getEncodeFunc,\n      decode: decode\n    };\n\n    var mapCache = {}, dummyObj = {};\n    var makeMap$2 = Tools.makeMap, each$3 = Tools.each, extend$1 = Tools.extend, explode$1 = Tools.explode, inArray = Tools.inArray;\n    var split = function (items, delim) {\n      items = Tools.trim(items);\n      return items ? items.split(delim || ' ') : [];\n    };\n    var compileSchema = function (type) {\n      var schema = {};\n      var globalAttributes, blockContent;\n      var phrasingContent, flowContent, html4BlockContent, html4PhrasingContent;\n      var add = function (name, attributes, children) {\n        var ni, attributesOrder, element;\n        var arrayToMap = function (array, obj) {\n          var map = {};\n          var i, l;\n          for (i = 0, l = array.length; i < l; i++) {\n            map[array[i]] = obj || {};\n          }\n          return map;\n        };\n        children = children || [];\n        attributes = attributes || '';\n        if (typeof children === 'string') {\n          children = split(children);\n        }\n        var names = split(name);\n        ni = names.length;\n        while (ni--) {\n          attributesOrder = split([\n            globalAttributes,\n            attributes\n          ].join(' '));\n          element = {\n            attributes: arrayToMap(attributesOrder),\n            attributesOrder: attributesOrder,\n            children: arrayToMap(children, dummyObj)\n          };\n          schema[names[ni]] = element;\n        }\n      };\n      var addAttrs = function (name, attributes) {\n        var ni, schemaItem, i, l;\n        var names = split(name);\n        ni = names.length;\n        var attrs = split(attributes);\n        while (ni--) {\n          schemaItem = schema[names[ni]];\n          for (i = 0, l = attrs.length; i < l; i++) {\n            schemaItem.attributes[attrs[i]] = {};\n            schemaItem.attributesOrder.push(attrs[i]);\n          }\n        }\n      };\n      if (mapCache[type]) {\n        return mapCache[type];\n      }\n      globalAttributes = 'id accesskey class dir lang style tabindex title role';\n      blockContent = 'address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul';\n      phrasingContent = 'a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd ' + 'label map noscript object q s samp script select small span strong sub sup ' + 'textarea u var #text #comment';\n      if (type !== 'html4') {\n        globalAttributes += ' contenteditable contextmenu draggable dropzone ' + 'hidden spellcheck translate';\n        blockContent += ' article aside details dialog figure main header footer hgroup section nav';\n        phrasingContent += ' audio canvas command datalist mark meter output picture ' + 'progress time wbr video ruby bdi keygen';\n      }\n      if (type !== 'html5-strict') {\n        globalAttributes += ' xml:lang';\n        html4PhrasingContent = 'acronym applet basefont big font strike tt';\n        phrasingContent = [\n          phrasingContent,\n          html4PhrasingContent\n        ].join(' ');\n        each$3(split(html4PhrasingContent), function (name) {\n          add(name, '', phrasingContent);\n        });\n        html4BlockContent = 'center dir isindex noframes';\n        blockContent = [\n          blockContent,\n          html4BlockContent\n        ].join(' ');\n        flowContent = [\n          blockContent,\n          phrasingContent\n        ].join(' ');\n        each$3(split(html4BlockContent), function (name) {\n          add(name, '', flowContent);\n        });\n      }\n      flowContent = flowContent || [\n        blockContent,\n        phrasingContent\n      ].join(' ');\n      add('html', 'manifest', 'head body');\n      add('head', '', 'base command link meta noscript script style title');\n      add('title hr noscript br');\n      add('base', 'href target');\n      add('link', 'href rel media hreflang type sizes hreflang');\n      add('meta', 'name http-equiv content charset');\n      add('style', 'media type scoped');\n      add('script', 'src async defer type charset');\n      add('body', 'onafterprint onbeforeprint onbeforeunload onblur onerror onfocus ' + 'onhashchange onload onmessage onoffline ononline onpagehide onpageshow ' + 'onpopstate onresize onscroll onstorage onunload', flowContent);\n      add('address dt dd div caption', '', flowContent);\n      add('h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn', '', phrasingContent);\n      add('blockquote', 'cite', flowContent);\n      add('ol', 'reversed start type', 'li');\n      add('ul', '', 'li');\n      add('li', 'value', flowContent);\n      add('dl', '', 'dt dd');\n      add('a', 'href target rel media hreflang type', phrasingContent);\n      add('q', 'cite', phrasingContent);\n      add('ins del', 'cite datetime', flowContent);\n      add('img', 'src sizes srcset alt usemap ismap width height');\n      add('iframe', 'src name width height', flowContent);\n      add('embed', 'src type width height');\n      add('object', 'data type typemustmatch name usemap form width height', [\n        flowContent,\n        'param'\n      ].join(' '));\n      add('param', 'name value');\n      add('map', 'name', [\n        flowContent,\n        'area'\n      ].join(' '));\n      add('area', 'alt coords shape href target rel media hreflang type');\n      add('table', 'border', 'caption colgroup thead tfoot tbody tr' + (type === 'html4' ? ' col' : ''));\n      add('colgroup', 'span', 'col');\n      add('col', 'span');\n      add('tbody thead tfoot', '', 'tr');\n      add('tr', '', 'td th');\n      add('td', 'colspan rowspan headers', flowContent);\n      add('th', 'colspan rowspan headers scope abbr', flowContent);\n      add('form', 'accept-charset action autocomplete enctype method name novalidate target', flowContent);\n      add('fieldset', 'disabled form name', [\n        flowContent,\n        'legend'\n      ].join(' '));\n      add('label', 'form for', phrasingContent);\n      add('input', 'accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate ' + 'formtarget height list max maxlength min multiple name pattern readonly required size src step type value width');\n      add('button', 'disabled form formaction formenctype formmethod formnovalidate formtarget name type value', type === 'html4' ? flowContent : phrasingContent);\n      add('select', 'disabled form multiple name required size', 'option optgroup');\n      add('optgroup', 'disabled label', 'option');\n      add('option', 'disabled label selected value');\n      add('textarea', 'cols dirname disabled form maxlength name readonly required rows wrap');\n      add('menu', 'type label', [\n        flowContent,\n        'li'\n      ].join(' '));\n      add('noscript', '', flowContent);\n      if (type !== 'html4') {\n        add('wbr');\n        add('ruby', '', [\n          phrasingContent,\n          'rt rp'\n        ].join(' '));\n        add('figcaption', '', flowContent);\n        add('mark rt rp summary bdi', '', phrasingContent);\n        add('canvas', 'width height', flowContent);\n        add('video', 'src crossorigin poster preload autoplay mediagroup loop ' + 'muted controls width height buffered', [\n          flowContent,\n          'track source'\n        ].join(' '));\n        add('audio', 'src crossorigin preload autoplay mediagroup loop muted controls ' + 'buffered volume', [\n          flowContent,\n          'track source'\n        ].join(' '));\n        add('picture', '', 'img source');\n        add('source', 'src srcset type media sizes');\n        add('track', 'kind src srclang label default');\n        add('datalist', '', [\n          phrasingContent,\n          'option'\n        ].join(' '));\n        add('article section nav aside main header footer', '', flowContent);\n        add('hgroup', '', 'h1 h2 h3 h4 h5 h6');\n        add('figure', '', [\n          flowContent,\n          'figcaption'\n        ].join(' '));\n        add('time', 'datetime', phrasingContent);\n        add('dialog', 'open', flowContent);\n        add('command', 'type label icon disabled checked radiogroup command');\n        add('output', 'for form name', phrasingContent);\n        add('progress', 'value max', phrasingContent);\n        add('meter', 'value min max low high optimum', phrasingContent);\n        add('details', 'open', [\n          flowContent,\n          'summary'\n        ].join(' '));\n        add('keygen', 'autofocus challenge disabled form keytype name');\n      }\n      if (type !== 'html5-strict') {\n        addAttrs('script', 'language xml:space');\n        addAttrs('style', 'xml:space');\n        addAttrs('object', 'declare classid code codebase codetype archive standby align border hspace vspace');\n        addAttrs('embed', 'align name hspace vspace');\n        addAttrs('param', 'valuetype type');\n        addAttrs('a', 'charset name rev shape coords');\n        addAttrs('br', 'clear');\n        addAttrs('applet', 'codebase archive code object alt name width height align hspace vspace');\n        addAttrs('img', 'name longdesc align border hspace vspace');\n        addAttrs('iframe', 'longdesc frameborder marginwidth marginheight scrolling align');\n        addAttrs('font basefont', 'size color face');\n        addAttrs('input', 'usemap align');\n        addAttrs('select');\n        addAttrs('textarea');\n        addAttrs('h1 h2 h3 h4 h5 h6 div p legend caption', 'align');\n        addAttrs('ul', 'type compact');\n        addAttrs('li', 'type');\n        addAttrs('ol dl menu dir', 'compact');\n        addAttrs('pre', 'width xml:space');\n        addAttrs('hr', 'align noshade size width');\n        addAttrs('isindex', 'prompt');\n        addAttrs('table', 'summary width frame rules cellspacing cellpadding align bgcolor');\n        addAttrs('col', 'width align char charoff valign');\n        addAttrs('colgroup', 'width align char charoff valign');\n        addAttrs('thead', 'align char charoff valign');\n        addAttrs('tr', 'align char charoff valign bgcolor');\n        addAttrs('th', 'axis align char charoff valign nowrap bgcolor width height');\n        addAttrs('form', 'accept');\n        addAttrs('td', 'abbr axis scope align char charoff valign nowrap bgcolor width height');\n        addAttrs('tfoot', 'align char charoff valign');\n        addAttrs('tbody', 'align char charoff valign');\n        addAttrs('area', 'nohref');\n        addAttrs('body', 'background bgcolor text link vlink alink');\n      }\n      if (type !== 'html4') {\n        addAttrs('input button select textarea', 'autofocus');\n        addAttrs('input textarea', 'placeholder');\n        addAttrs('a', 'download');\n        addAttrs('link script img', 'crossorigin');\n        addAttrs('img', 'loading');\n        addAttrs('iframe', 'sandbox seamless allowfullscreen loading');\n      }\n      each$3(split('a form meter progress dfn'), function (name) {\n        if (schema[name]) {\n          delete schema[name].children[name];\n        }\n      });\n      delete schema.caption.children.table;\n      delete schema.script;\n      mapCache[type] = schema;\n      return schema;\n    };\n    var compileElementMap = function (value, mode) {\n      var styles;\n      if (value) {\n        styles = {};\n        if (typeof value === 'string') {\n          value = { '*': value };\n        }\n        each$3(value, function (value, key) {\n          styles[key] = styles[key.toUpperCase()] = mode === 'map' ? makeMap$2(value, /[, ]/) : explode$1(value, /[, ]/);\n        });\n      }\n      return styles;\n    };\n    var Schema = function (settings) {\n      var elements = {};\n      var children = {};\n      var patternElements = [];\n      var customElementsMap = {}, specialElements = {};\n      var createLookupTable = function (option, defaultValue, extendWith) {\n        var value = settings[option];\n        if (!value) {\n          value = mapCache[option];\n          if (!value) {\n            value = makeMap$2(defaultValue, ' ', makeMap$2(defaultValue.toUpperCase(), ' '));\n            value = extend$1(value, extendWith);\n            mapCache[option] = value;\n          }\n        } else {\n          value = makeMap$2(value, /[, ]/, makeMap$2(value.toUpperCase(), /[, ]/));\n        }\n        return value;\n      };\n      settings = settings || {};\n      var schemaItems = compileSchema(settings.schema);\n      if (settings.verify_html === false) {\n        settings.valid_elements = '*[*]';\n      }\n      var validStyles = compileElementMap(settings.valid_styles);\n      var invalidStyles = compileElementMap(settings.invalid_styles, 'map');\n      var validClasses = compileElementMap(settings.valid_classes, 'map');\n      var whiteSpaceElementsMap = createLookupTable('whitespace_elements', 'pre script noscript style textarea video audio iframe object code');\n      var selfClosingElementsMap = createLookupTable('self_closing_elements', 'colgroup dd dt li option p td tfoot th thead tr');\n      var shortEndedElementsMap = createLookupTable('short_ended_elements', 'area base basefont br col frame hr img input isindex link ' + 'meta param embed source wbr track');\n      var boolAttrMap = createLookupTable('boolean_attributes', 'checked compact declare defer disabled ismap multiple nohref noresize ' + 'noshade nowrap readonly selected autoplay loop controls');\n      var nonEmptyOrMoveCaretBeforeOnEnter = 'td th iframe video audio object script code';\n      var nonEmptyElementsMap = createLookupTable('non_empty_elements', nonEmptyOrMoveCaretBeforeOnEnter + ' pre', shortEndedElementsMap);\n      var moveCaretBeforeOnEnterElementsMap = createLookupTable('move_caret_before_on_enter_elements', nonEmptyOrMoveCaretBeforeOnEnter + ' table', shortEndedElementsMap);\n      var textBlockElementsMap = createLookupTable('text_block_elements', 'h1 h2 h3 h4 h5 h6 p div address pre form ' + 'blockquote center dir fieldset header footer article section hgroup aside main nav figure');\n      var blockElementsMap = createLookupTable('block_elements', 'hr table tbody thead tfoot ' + 'th tr td li ol ul caption dl dt dd noscript menu isindex option ' + 'datalist select optgroup figcaption details summary', textBlockElementsMap);\n      var textInlineElementsMap = createLookupTable('text_inline_elements', 'span strong b em i font strike u var cite ' + 'dfn code mark q sup sub samp');\n      each$3((settings.special || 'script noscript iframe noframes noembed title style textarea xmp').split(' '), function (name) {\n        specialElements[name] = new RegExp('</' + name + '[^>]*>', 'gi');\n      });\n      var patternToRegExp = function (str) {\n        return new RegExp('^' + str.replace(/([?+*])/g, '.$1') + '$');\n      };\n      var addValidElements = function (validElements) {\n        var ei, el, ai, al, matches, element, attr, attrData, elementName, attrName, attrType, attributes, attributesOrder, prefix, outputName, globalAttributes, globalAttributesOrder, value;\n        var elementRuleRegExp = /^([#+\\-])?([^\\[!\\/]+)(?:\\/([^\\[!]+))?(?:(!?)\\[([^\\]]+)])?$/, attrRuleRegExp = /^([!\\-])?(\\w+[\\\\:]:\\w+|[^=:<]+)?(?:([=:<])(.*))?$/, hasPatternsRegExp = /[*?+]/;\n        if (validElements) {\n          var validElementsArr = split(validElements, ',');\n          if (elements['@']) {\n            globalAttributes = elements['@'].attributes;\n            globalAttributesOrder = elements['@'].attributesOrder;\n          }\n          for (ei = 0, el = validElementsArr.length; ei < el; ei++) {\n            matches = elementRuleRegExp.exec(validElementsArr[ei]);\n            if (matches) {\n              prefix = matches[1];\n              elementName = matches[2];\n              outputName = matches[3];\n              attrData = matches[5];\n              attributes = {};\n              attributesOrder = [];\n              element = {\n                attributes: attributes,\n                attributesOrder: attributesOrder\n              };\n              if (prefix === '#') {\n                element.paddEmpty = true;\n              }\n              if (prefix === '-') {\n                element.removeEmpty = true;\n              }\n              if (matches[4] === '!') {\n                element.removeEmptyAttrs = true;\n              }\n              if (globalAttributes) {\n                each$1(globalAttributes, function (value, key) {\n                  attributes[key] = value;\n                });\n                attributesOrder.push.apply(attributesOrder, globalAttributesOrder);\n              }\n              if (attrData) {\n                attrData = split(attrData, '|');\n                for (ai = 0, al = attrData.length; ai < al; ai++) {\n                  matches = attrRuleRegExp.exec(attrData[ai]);\n                  if (matches) {\n                    attr = {};\n                    attrType = matches[1];\n                    attrName = matches[2].replace(/[\\\\:]:/g, ':');\n                    prefix = matches[3];\n                    value = matches[4];\n                    if (attrType === '!') {\n                      element.attributesRequired = element.attributesRequired || [];\n                      element.attributesRequired.push(attrName);\n                      attr.required = true;\n                    }\n                    if (attrType === '-') {\n                      delete attributes[attrName];\n                      attributesOrder.splice(inArray(attributesOrder, attrName), 1);\n                      continue;\n                    }\n                    if (prefix) {\n                      if (prefix === '=') {\n                        element.attributesDefault = element.attributesDefault || [];\n                        element.attributesDefault.push({\n                          name: attrName,\n                          value: value\n                        });\n                        attr.defaultValue = value;\n                      }\n                      if (prefix === ':') {\n                        element.attributesForced = element.attributesForced || [];\n                        element.attributesForced.push({\n                          name: attrName,\n                          value: value\n                        });\n                        attr.forcedValue = value;\n                      }\n                      if (prefix === '<') {\n                        attr.validValues = makeMap$2(value, '?');\n                      }\n                    }\n                    if (hasPatternsRegExp.test(attrName)) {\n                      element.attributePatterns = element.attributePatterns || [];\n                      attr.pattern = patternToRegExp(attrName);\n                      element.attributePatterns.push(attr);\n                    } else {\n                      if (!attributes[attrName]) {\n                        attributesOrder.push(attrName);\n                      }\n                      attributes[attrName] = attr;\n                    }\n                  }\n                }\n              }\n              if (!globalAttributes && elementName === '@') {\n                globalAttributes = attributes;\n                globalAttributesOrder = attributesOrder;\n              }\n              if (outputName) {\n                element.outputName = elementName;\n                elements[outputName] = element;\n              }\n              if (hasPatternsRegExp.test(elementName)) {\n                element.pattern = patternToRegExp(elementName);\n                patternElements.push(element);\n              } else {\n                elements[elementName] = element;\n              }\n            }\n          }\n        }\n      };\n      var setValidElements = function (validElements) {\n        elements = {};\n        patternElements = [];\n        addValidElements(validElements);\n        each$3(schemaItems, function (element, name) {\n          children[name] = element.children;\n        });\n      };\n      var addCustomElements = function (customElements) {\n        var customElementRegExp = /^(~)?(.+)$/;\n        if (customElements) {\n          mapCache.text_block_elements = mapCache.block_elements = null;\n          each$3(split(customElements, ','), function (rule) {\n            var matches = customElementRegExp.exec(rule), inline = matches[1] === '~', cloneName = inline ? 'span' : 'div', name = matches[2];\n            children[name] = children[cloneName];\n            customElementsMap[name] = cloneName;\n            if (!inline) {\n              blockElementsMap[name.toUpperCase()] = {};\n              blockElementsMap[name] = {};\n            }\n            if (!elements[name]) {\n              var customRule = elements[cloneName];\n              customRule = extend$1({}, customRule);\n              delete customRule.removeEmptyAttrs;\n              delete customRule.removeEmpty;\n              elements[name] = customRule;\n            }\n            each$3(children, function (element, elmName) {\n              if (element[cloneName]) {\n                children[elmName] = element = extend$1({}, children[elmName]);\n                element[name] = element[cloneName];\n              }\n            });\n          });\n        }\n      };\n      var addValidChildren = function (validChildren) {\n        var childRuleRegExp = /^([+\\-]?)([A-Za-z0-9_\\-.\\u00b7\\u00c0-\\u00d6\\u00d8-\\u00f6\\u00f8-\\u037d\\u037f-\\u1fff\\u200c-\\u200d\\u203f-\\u2040\\u2070-\\u218f\\u2c00-\\u2fef\\u3001-\\ud7ff\\uf900-\\ufdcf\\ufdf0-\\ufffd]+)\\[([^\\]]+)]$/;\n        mapCache[settings.schema] = null;\n        if (validChildren) {\n          each$3(split(validChildren, ','), function (rule) {\n            var matches = childRuleRegExp.exec(rule);\n            var parent, prefix;\n            if (matches) {\n              prefix = matches[1];\n              if (prefix) {\n                parent = children[matches[2]];\n              } else {\n                parent = children[matches[2]] = { '#comment': {} };\n              }\n              parent = children[matches[2]];\n              each$3(split(matches[3], '|'), function (child) {\n                if (prefix === '-') {\n                  delete parent[child];\n                } else {\n                  parent[child] = {};\n                }\n              });\n            }\n          });\n        }\n      };\n      var getElementRule = function (name) {\n        var element = elements[name], i;\n        if (element) {\n          return element;\n        }\n        i = patternElements.length;\n        while (i--) {\n          element = patternElements[i];\n          if (element.pattern.test(name)) {\n            return element;\n          }\n        }\n      };\n      if (!settings.valid_elements) {\n        each$3(schemaItems, function (element, name) {\n          elements[name] = {\n            attributes: element.attributes,\n            attributesOrder: element.attributesOrder\n          };\n          children[name] = element.children;\n        });\n        if (settings.schema !== 'html5') {\n          each$3(split('strong/b em/i'), function (item) {\n            var items = split(item, '/');\n            elements[items[1]].outputName = items[0];\n          });\n        }\n        each$3(split('ol ul sub sup blockquote span font a table tbody strong em b i'), function (name) {\n          if (elements[name]) {\n            elements[name].removeEmpty = true;\n          }\n        });\n        each$3(split('p h1 h2 h3 h4 h5 h6 th td pre div address caption li'), function (name) {\n          elements[name].paddEmpty = true;\n        });\n        each$3(split('span'), function (name) {\n          elements[name].removeEmptyAttrs = true;\n        });\n      } else {\n        setValidElements(settings.valid_elements);\n      }\n      addCustomElements(settings.custom_elements);\n      addValidChildren(settings.valid_children);\n      addValidElements(settings.extended_valid_elements);\n      addValidChildren('+ol[ul|ol],+ul[ul|ol]');\n      each$3({\n        dd: 'dl',\n        dt: 'dl',\n        li: 'ul ol',\n        td: 'tr',\n        th: 'tr',\n        tr: 'tbody thead tfoot',\n        tbody: 'table',\n        thead: 'table',\n        tfoot: 'table',\n        legend: 'fieldset',\n        area: 'map',\n        param: 'video audio object'\n      }, function (parents, item) {\n        if (elements[item]) {\n          elements[item].parentsRequired = split(parents);\n        }\n      });\n      if (settings.invalid_elements) {\n        each$3(explode$1(settings.invalid_elements), function (item) {\n          if (elements[item]) {\n            delete elements[item];\n          }\n        });\n      }\n      if (!getElementRule('span')) {\n        addValidElements('span[!data-mce-type|*]');\n      }\n      var getValidStyles = function () {\n        return validStyles;\n      };\n      var getInvalidStyles = function () {\n        return invalidStyles;\n      };\n      var getValidClasses = function () {\n        return validClasses;\n      };\n      var getBoolAttrs = function () {\n        return boolAttrMap;\n      };\n      var getBlockElements = function () {\n        return blockElementsMap;\n      };\n      var getTextBlockElements = function () {\n        return textBlockElementsMap;\n      };\n      var getTextInlineElements = function () {\n        return textInlineElementsMap;\n      };\n      var getShortEndedElements = function () {\n        return shortEndedElementsMap;\n      };\n      var getSelfClosingElements = function () {\n        return selfClosingElementsMap;\n      };\n      var getNonEmptyElements = function () {\n        return nonEmptyElementsMap;\n      };\n      var getMoveCaretBeforeOnEnterElements = function () {\n        return moveCaretBeforeOnEnterElementsMap;\n      };\n      var getWhiteSpaceElements = function () {\n        return whiteSpaceElementsMap;\n      };\n      var getSpecialElements = function () {\n        return specialElements;\n      };\n      var isValidChild = function (name, child) {\n        var parent = children[name.toLowerCase()];\n        return !!(parent && parent[child.toLowerCase()]);\n      };\n      var isValid = function (name, attr) {\n        var attrPatterns, i;\n        var rule = getElementRule(name);\n        if (rule) {\n          if (attr) {\n            if (rule.attributes[attr]) {\n              return true;\n            }\n            attrPatterns = rule.attributePatterns;\n            if (attrPatterns) {\n              i = attrPatterns.length;\n              while (i--) {\n                if (attrPatterns[i].pattern.test(name)) {\n                  return true;\n                }\n              }\n            }\n          } else {\n            return true;\n          }\n        }\n        return false;\n      };\n      var getCustomElements = function () {\n        return customElementsMap;\n      };\n      return {\n        children: children,\n        elements: elements,\n        getValidStyles: getValidStyles,\n        getValidClasses: getValidClasses,\n        getBlockElements: getBlockElements,\n        getInvalidStyles: getInvalidStyles,\n        getShortEndedElements: getShortEndedElements,\n        getTextBlockElements: getTextBlockElements,\n        getTextInlineElements: getTextInlineElements,\n        getBoolAttrs: getBoolAttrs,\n        getElementRule: getElementRule,\n        getSelfClosingElements: getSelfClosingElements,\n        getNonEmptyElements: getNonEmptyElements,\n        getMoveCaretBeforeOnEnterElements: getMoveCaretBeforeOnEnterElements,\n        getWhiteSpaceElements: getWhiteSpaceElements,\n        getSpecialElements: getSpecialElements,\n        isValidChild: isValidChild,\n        isValid: isValid,\n        getCustomElements: getCustomElements,\n        addValidElements: addValidElements,\n        setValidElements: setValidElements,\n        addCustomElements: addCustomElements,\n        addValidChildren: addValidChildren\n      };\n    };\n\n    var toHex = function (match, r, g, b) {\n      var hex = function (val) {\n        val = parseInt(val, 10).toString(16);\n        return val.length > 1 ? val : '0' + val;\n      };\n      return '#' + hex(r) + hex(g) + hex(b);\n    };\n    var Styles = function (settings, schema) {\n      var _this = this;\n      var rgbRegExp = /rgb\\s*\\(\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*\\)/gi;\n      var urlOrStrRegExp = /(?:url(?:(?:\\(\\s*\\\"([^\\\"]+)\\\"\\s*\\))|(?:\\(\\s*\\'([^\\']+)\\'\\s*\\))|(?:\\(\\s*([^)\\s]+)\\s*\\))))|(?:\\'([^\\']+)\\')|(?:\\\"([^\\\"]+)\\\")/gi;\n      var styleRegExp = /\\s*([^:]+):\\s*([^;]+);?/g;\n      var trimRightRegExp = /\\s+$/;\n      var i;\n      var encodingLookup = {};\n      var validStyles;\n      var invalidStyles;\n      var invisibleChar = zeroWidth;\n      settings = settings || {};\n      if (schema) {\n        validStyles = schema.getValidStyles();\n        invalidStyles = schema.getInvalidStyles();\n      }\n      var encodingItems = ('\\\\\" \\\\\\' \\\\; \\\\: ; : ' + invisibleChar).split(' ');\n      for (i = 0; i < encodingItems.length; i++) {\n        encodingLookup[encodingItems[i]] = invisibleChar + i;\n        encodingLookup[invisibleChar + i] = encodingItems[i];\n      }\n      return {\n        toHex: function (color) {\n          return color.replace(rgbRegExp, toHex);\n        },\n        parse: function (css) {\n          var styles = {};\n          var matches, name, value, isEncoded;\n          var urlConverter = settings.url_converter;\n          var urlConverterScope = settings.url_converter_scope || _this;\n          var compress = function (prefix, suffix, noJoin) {\n            var top = styles[prefix + '-top' + suffix];\n            if (!top) {\n              return;\n            }\n            var right = styles[prefix + '-right' + suffix];\n            if (!right) {\n              return;\n            }\n            var bottom = styles[prefix + '-bottom' + suffix];\n            if (!bottom) {\n              return;\n            }\n            var left = styles[prefix + '-left' + suffix];\n            if (!left) {\n              return;\n            }\n            var box = [\n              top,\n              right,\n              bottom,\n              left\n            ];\n            i = box.length - 1;\n            while (i--) {\n              if (box[i] !== box[i + 1]) {\n                break;\n              }\n            }\n            if (i > -1 && noJoin) {\n              return;\n            }\n            styles[prefix + suffix] = i === -1 ? box[0] : box.join(' ');\n            delete styles[prefix + '-top' + suffix];\n            delete styles[prefix + '-right' + suffix];\n            delete styles[prefix + '-bottom' + suffix];\n            delete styles[prefix + '-left' + suffix];\n          };\n          var canCompress = function (key) {\n            var value = styles[key], i;\n            if (!value) {\n              return;\n            }\n            value = value.split(' ');\n            i = value.length;\n            while (i--) {\n              if (value[i] !== value[0]) {\n                return false;\n              }\n            }\n            styles[key] = value[0];\n            return true;\n          };\n          var compress2 = function (target, a, b, c) {\n            if (!canCompress(a)) {\n              return;\n            }\n            if (!canCompress(b)) {\n              return;\n            }\n            if (!canCompress(c)) {\n              return;\n            }\n            styles[target] = styles[a] + ' ' + styles[b] + ' ' + styles[c];\n            delete styles[a];\n            delete styles[b];\n            delete styles[c];\n          };\n          var encode = function (str) {\n            isEncoded = true;\n            return encodingLookup[str];\n          };\n          var decode = function (str, keepSlashes) {\n            if (isEncoded) {\n              str = str.replace(/\\uFEFF[0-9]/g, function (str) {\n                return encodingLookup[str];\n              });\n            }\n            if (!keepSlashes) {\n              str = str.replace(/\\\\([\\'\\\";:])/g, '$1');\n            }\n            return str;\n          };\n          var decodeSingleHexSequence = function (escSeq) {\n            return String.fromCharCode(parseInt(escSeq.slice(1), 16));\n          };\n          var decodeHexSequences = function (value) {\n            return value.replace(/\\\\[0-9a-f]+/gi, decodeSingleHexSequence);\n          };\n          var processUrl = function (match, url, url2, url3, str, str2) {\n            str = str || str2;\n            if (str) {\n              str = decode(str);\n              return '\\'' + str.replace(/\\'/g, '\\\\\\'') + '\\'';\n            }\n            url = decode(url || url2 || url3);\n            if (!settings.allow_script_urls) {\n              var scriptUrl = url.replace(/[\\s\\r\\n]+/g, '');\n              if (/(java|vb)script:/i.test(scriptUrl)) {\n                return '';\n              }\n              if (!settings.allow_svg_data_urls && /^data:image\\/svg/i.test(scriptUrl)) {\n                return '';\n              }\n            }\n            if (urlConverter) {\n              url = urlConverter.call(urlConverterScope, url, 'style');\n            }\n            return 'url(\\'' + url.replace(/\\'/g, '\\\\\\'') + '\\')';\n          };\n          if (css) {\n            css = css.replace(/[\\u0000-\\u001F]/g, '');\n            css = css.replace(/\\\\[\\\"\\';:\\uFEFF]/g, encode).replace(/\\\"[^\\\"]+\\\"|\\'[^\\']+\\'/g, function (str) {\n              return str.replace(/[;:]/g, encode);\n            });\n            while (matches = styleRegExp.exec(css)) {\n              styleRegExp.lastIndex = matches.index + matches[0].length;\n              name = matches[1].replace(trimRightRegExp, '').toLowerCase();\n              value = matches[2].replace(trimRightRegExp, '');\n              if (name && value) {\n                name = decodeHexSequences(name);\n                value = decodeHexSequences(value);\n                if (name.indexOf(invisibleChar) !== -1 || name.indexOf('\"') !== -1) {\n                  continue;\n                }\n                if (!settings.allow_script_urls && (name === 'behavior' || /expression\\s*\\(|\\/\\*|\\*\\//.test(value))) {\n                  continue;\n                }\n                if (name === 'font-weight' && value === '700') {\n                  value = 'bold';\n                } else if (name === 'color' || name === 'background-color') {\n                  value = value.toLowerCase();\n                }\n                value = value.replace(rgbRegExp, toHex);\n                value = value.replace(urlOrStrRegExp, processUrl);\n                styles[name] = isEncoded ? decode(value, true) : value;\n              }\n            }\n            compress('border', '', true);\n            compress('border', '-width');\n            compress('border', '-color');\n            compress('border', '-style');\n            compress('padding', '');\n            compress('margin', '');\n            compress2('border', 'border-width', 'border-style', 'border-color');\n            if (styles.border === 'medium none') {\n              delete styles.border;\n            }\n            if (styles['border-image'] === 'none') {\n              delete styles['border-image'];\n            }\n          }\n          return styles;\n        },\n        serialize: function (styles, elementName) {\n          var css = '';\n          var serializeStyles = function (name) {\n            var value;\n            var styleList = validStyles[name];\n            if (styleList) {\n              for (var i_1 = 0, l = styleList.length; i_1 < l; i_1++) {\n                name = styleList[i_1];\n                value = styles[name];\n                if (value) {\n                  css += (css.length > 0 ? ' ' : '') + name + ': ' + value + ';';\n                }\n              }\n            }\n          };\n          var isValid = function (name, elementName) {\n            var styleMap = invalidStyles['*'];\n            if (styleMap && styleMap[name]) {\n              return false;\n            }\n            styleMap = invalidStyles[elementName];\n            return !(styleMap && styleMap[name]);\n          };\n          if (elementName && validStyles) {\n            serializeStyles('*');\n            serializeStyles(elementName);\n          } else {\n            each$1(styles, function (value, name) {\n              if (value && (!invalidStyles || isValid(name, elementName))) {\n                css += (css.length > 0 ? ' ' : '') + name + ': ' + value + ';';\n              }\n            });\n          }\n          return css;\n        }\n      };\n    };\n\n    var eventExpandoPrefix = 'mce-data-';\n    var mouseEventRe = /^(?:mouse|contextmenu)|click/;\n    var deprecated = {\n      keyLocation: 1,\n      layerX: 1,\n      layerY: 1,\n      returnValue: 1,\n      webkitMovementX: 1,\n      webkitMovementY: 1,\n      keyIdentifier: 1,\n      mozPressure: 1\n    };\n    var hasIsDefaultPrevented = function (event) {\n      return event.isDefaultPrevented === returnTrue || event.isDefaultPrevented === returnFalse;\n    };\n    var returnFalse = never;\n    var returnTrue = always;\n    var addEvent = function (target, name, callback, capture) {\n      if (target.addEventListener) {\n        target.addEventListener(name, callback, capture || false);\n      } else if (target.attachEvent) {\n        target.attachEvent('on' + name, callback);\n      }\n    };\n    var removeEvent = function (target, name, callback, capture) {\n      if (target.removeEventListener) {\n        target.removeEventListener(name, callback, capture || false);\n      } else if (target.detachEvent) {\n        target.detachEvent('on' + name, callback);\n      }\n    };\n    var isMouseEvent = function (event) {\n      return mouseEventRe.test(event.type);\n    };\n    var fix = function (originalEvent, data) {\n      var name;\n      var event = data || {};\n      for (name in originalEvent) {\n        if (!deprecated[name]) {\n          event[name] = originalEvent[name];\n        }\n      }\n      if (!event.target) {\n        event.target = event.srcElement || document;\n      }\n      if (event.composedPath) {\n        event.composedPath = function () {\n          return originalEvent.composedPath();\n        };\n      }\n      if (originalEvent && isMouseEvent(originalEvent) && originalEvent.pageX === undefined && originalEvent.clientX !== undefined) {\n        var eventDoc = event.target.ownerDocument || document;\n        var doc = eventDoc.documentElement;\n        var body = eventDoc.body;\n        event.pageX = originalEvent.clientX + (doc && doc.scrollLeft || body && body.scrollLeft || 0) - (doc && doc.clientLeft || body && body.clientLeft || 0);\n        event.pageY = originalEvent.clientY + (doc && doc.scrollTop || body && body.scrollTop || 0) - (doc && doc.clientTop || body && body.clientTop || 0);\n      }\n      event.preventDefault = function () {\n        event.defaultPrevented = true;\n        event.isDefaultPrevented = returnTrue;\n        if (originalEvent) {\n          if (originalEvent.preventDefault) {\n            originalEvent.preventDefault();\n          } else {\n            originalEvent.returnValue = false;\n          }\n        }\n      };\n      event.stopPropagation = function () {\n        event.cancelBubble = true;\n        event.isPropagationStopped = returnTrue;\n        if (originalEvent) {\n          if (originalEvent.stopPropagation) {\n            originalEvent.stopPropagation();\n          } else {\n            originalEvent.cancelBubble = true;\n          }\n        }\n      };\n      event.stopImmediatePropagation = function () {\n        event.isImmediatePropagationStopped = returnTrue;\n        event.stopPropagation();\n      };\n      if (hasIsDefaultPrevented(event) === false) {\n        event.isDefaultPrevented = event.defaultPrevented === true ? returnTrue : returnFalse;\n        event.isPropagationStopped = event.cancelBubble === true ? returnTrue : returnFalse;\n        event.isImmediatePropagationStopped = returnFalse;\n      }\n      if (typeof event.metaKey === 'undefined') {\n        event.metaKey = false;\n      }\n      return event;\n    };\n    var bindOnReady = function (win, callback, eventUtils) {\n      var doc = win.document, event = { type: 'ready' };\n      if (eventUtils.domLoaded) {\n        callback(event);\n        return;\n      }\n      var isDocReady = function () {\n        return doc.readyState === 'complete' || doc.readyState === 'interactive' && doc.body;\n      };\n      var readyHandler = function () {\n        removeEvent(win, 'DOMContentLoaded', readyHandler);\n        removeEvent(win, 'load', readyHandler);\n        if (!eventUtils.domLoaded) {\n          eventUtils.domLoaded = true;\n          callback(event);\n        }\n        win = null;\n      };\n      if (isDocReady()) {\n        readyHandler();\n      } else {\n        addEvent(win, 'DOMContentLoaded', readyHandler);\n      }\n      if (!eventUtils.domLoaded) {\n        addEvent(win, 'load', readyHandler);\n      }\n    };\n    var EventUtils = function () {\n      function EventUtils() {\n        this.domLoaded = false;\n        this.events = {};\n        this.count = 1;\n        this.expando = eventExpandoPrefix + (+new Date()).toString(32);\n        this.hasMouseEnterLeave = 'onmouseenter' in document.documentElement;\n        this.hasFocusIn = 'onfocusin' in document.documentElement;\n        this.count = 1;\n      }\n      EventUtils.prototype.bind = function (target, names, callback, scope) {\n        var self = this;\n        var id, callbackList, i, name, fakeName, nativeHandler, capture;\n        var win = window;\n        var defaultNativeHandler = function (evt) {\n          self.executeHandlers(fix(evt || win.event), id);\n        };\n        if (!target || target.nodeType === 3 || target.nodeType === 8) {\n          return;\n        }\n        if (!target[self.expando]) {\n          id = self.count++;\n          target[self.expando] = id;\n          self.events[id] = {};\n        } else {\n          id = target[self.expando];\n        }\n        scope = scope || target;\n        var namesList = names.split(' ');\n        i = namesList.length;\n        while (i--) {\n          name = namesList[i];\n          nativeHandler = defaultNativeHandler;\n          fakeName = capture = false;\n          if (name === 'DOMContentLoaded') {\n            name = 'ready';\n          }\n          if (self.domLoaded && name === 'ready' && target.readyState === 'complete') {\n            callback.call(scope, fix({ type: name }));\n            continue;\n          }\n          if (!self.hasMouseEnterLeave) {\n            fakeName = self.mouseEnterLeave[name];\n            if (fakeName) {\n              nativeHandler = function (evt) {\n                var current = evt.currentTarget;\n                var related = evt.relatedTarget;\n                if (related && current.contains) {\n                  related = current.contains(related);\n                } else {\n                  while (related && related !== current) {\n                    related = related.parentNode;\n                  }\n                }\n                if (!related) {\n                  evt = fix(evt || win.event);\n                  evt.type = evt.type === 'mouseout' ? 'mouseleave' : 'mouseenter';\n                  evt.target = current;\n                  self.executeHandlers(evt, id);\n                }\n              };\n            }\n          }\n          if (!self.hasFocusIn && (name === 'focusin' || name === 'focusout')) {\n            capture = true;\n            fakeName = name === 'focusin' ? 'focus' : 'blur';\n            nativeHandler = function (evt) {\n              evt = fix(evt || win.event);\n              evt.type = evt.type === 'focus' ? 'focusin' : 'focusout';\n              self.executeHandlers(evt, id);\n            };\n          }\n          callbackList = self.events[id][name];\n          if (!callbackList) {\n            self.events[id][name] = callbackList = [{\n                func: callback,\n                scope: scope\n              }];\n            callbackList.fakeName = fakeName;\n            callbackList.capture = capture;\n            callbackList.nativeHandler = nativeHandler;\n            if (name === 'ready') {\n              bindOnReady(target, nativeHandler, self);\n            } else {\n              addEvent(target, fakeName || name, nativeHandler, capture);\n            }\n          } else {\n            if (name === 'ready' && self.domLoaded) {\n              callback(fix({ type: name }));\n            } else {\n              callbackList.push({\n                func: callback,\n                scope: scope\n              });\n            }\n          }\n        }\n        target = callbackList = null;\n        return callback;\n      };\n      EventUtils.prototype.unbind = function (target, names, callback) {\n        var callbackList, i, ci, name, eventMap;\n        if (!target || target.nodeType === 3 || target.nodeType === 8) {\n          return this;\n        }\n        var id = target[this.expando];\n        if (id) {\n          eventMap = this.events[id];\n          if (names) {\n            var namesList = names.split(' ');\n            i = namesList.length;\n            while (i--) {\n              name = namesList[i];\n              callbackList = eventMap[name];\n              if (callbackList) {\n                if (callback) {\n                  ci = callbackList.length;\n                  while (ci--) {\n                    if (callbackList[ci].func === callback) {\n                      var nativeHandler = callbackList.nativeHandler;\n                      var fakeName = callbackList.fakeName, capture = callbackList.capture;\n                      callbackList = callbackList.slice(0, ci).concat(callbackList.slice(ci + 1));\n                      callbackList.nativeHandler = nativeHandler;\n                      callbackList.fakeName = fakeName;\n                      callbackList.capture = capture;\n                      eventMap[name] = callbackList;\n                    }\n                  }\n                }\n                if (!callback || callbackList.length === 0) {\n                  delete eventMap[name];\n                  removeEvent(target, callbackList.fakeName || name, callbackList.nativeHandler, callbackList.capture);\n                }\n              }\n            }\n          } else {\n            each$1(eventMap, function (callbackList, name) {\n              removeEvent(target, callbackList.fakeName || name, callbackList.nativeHandler, callbackList.capture);\n            });\n            eventMap = {};\n          }\n          for (name in eventMap) {\n            if (has(eventMap, name)) {\n              return this;\n            }\n          }\n          delete this.events[id];\n          try {\n            delete target[this.expando];\n          } catch (ex) {\n            target[this.expando] = null;\n          }\n        }\n        return this;\n      };\n      EventUtils.prototype.fire = function (target, name, args) {\n        var id;\n        if (!target || target.nodeType === 3 || target.nodeType === 8) {\n          return this;\n        }\n        var event = fix(null, args);\n        event.type = name;\n        event.target = target;\n        do {\n          id = target[this.expando];\n          if (id) {\n            this.executeHandlers(event, id);\n          }\n          target = target.parentNode || target.ownerDocument || target.defaultView || target.parentWindow;\n        } while (target && !event.isPropagationStopped());\n        return this;\n      };\n      EventUtils.prototype.clean = function (target) {\n        var i, children;\n        if (!target || target.nodeType === 3 || target.nodeType === 8) {\n          return this;\n        }\n        if (target[this.expando]) {\n          this.unbind(target);\n        }\n        if (!target.getElementsByTagName) {\n          target = target.document;\n        }\n        if (target && target.getElementsByTagName) {\n          this.unbind(target);\n          children = target.getElementsByTagName('*');\n          i = children.length;\n          while (i--) {\n            target = children[i];\n            if (target[this.expando]) {\n              this.unbind(target);\n            }\n          }\n        }\n        return this;\n      };\n      EventUtils.prototype.destroy = function () {\n        this.events = {};\n      };\n      EventUtils.prototype.cancel = function (e) {\n        if (e) {\n          e.preventDefault();\n          e.stopImmediatePropagation();\n        }\n        return false;\n      };\n      EventUtils.prototype.executeHandlers = function (evt, id) {\n        var container = this.events[id];\n        var callbackList = container && container[evt.type];\n        if (callbackList) {\n          for (var i = 0, l = callbackList.length; i < l; i++) {\n            var callback = callbackList[i];\n            if (callback && callback.func.call(callback.scope, evt) === false) {\n              evt.preventDefault();\n            }\n            if (evt.isImmediatePropagationStopped()) {\n              return;\n            }\n          }\n        }\n      };\n      EventUtils.Event = new EventUtils();\n      return EventUtils;\n    }();\n\n    var support, Expr, getText, isXML, tokenize, compile, select, outermostContext, sortInput, hasDuplicate, setDocument, document$1, docElem, documentIsHTML, rbuggyQSA, rbuggyMatches, matches, contains$3, expando = 'sizzle' + -new Date(), preferredDoc = window.document, dirruns = 0, done = 0, classCache = createCache(), tokenCache = createCache(), compilerCache = createCache(), sortOrder = function (a, b) {\n        if (a === b) {\n          hasDuplicate = true;\n        }\n        return 0;\n      }, strundefined = typeof undefined, MAX_NEGATIVE = 1 << 31, hasOwn = {}.hasOwnProperty, arr = [], pop = arr.pop, push_native = arr.push, push = arr.push, slice = arr.slice, indexOf$2 = arr.indexOf || function (elem) {\n        var i = 0, len = this.length;\n        for (; i < len; i++) {\n          if (this[i] === elem) {\n            return i;\n          }\n        }\n        return -1;\n      }, booleans = 'checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped', whitespace = '[\\\\x20\\\\t\\\\r\\\\n\\\\f]', identifier = '(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+', attributes = '\\\\[' + whitespace + '*(' + identifier + ')(?:' + whitespace + '*([*^$|!~]?=)' + whitespace + '*(?:\\'((?:\\\\\\\\.|[^\\\\\\\\\\'])*)\\'|\"((?:\\\\\\\\.|[^\\\\\\\\\"])*)\"|(' + identifier + '))|)' + whitespace + '*\\\\]', pseudos = ':(' + identifier + ')(?:\\\\((' + '(\\'((?:\\\\\\\\.|[^\\\\\\\\\\'])*)\\'|\"((?:\\\\\\\\.|[^\\\\\\\\\"])*)\")|' + '((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|' + attributes + ')*)|' + '.*' + ')\\\\)|)', rtrim = new RegExp('^' + whitespace + '+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)' + whitespace + '+$', 'g'), rcomma = new RegExp('^' + whitespace + '*,' + whitespace + '*'), rcombinators = new RegExp('^' + whitespace + '*([>+~]|' + whitespace + ')' + whitespace + '*'), rattributeQuotes = new RegExp('=' + whitespace + '*([^\\\\]\\'\"]*?)' + whitespace + '*\\\\]', 'g'), rpseudo = new RegExp(pseudos), ridentifier = new RegExp('^' + identifier + '$'), matchExpr = {\n        ID: new RegExp('^#(' + identifier + ')'),\n        CLASS: new RegExp('^\\\\.(' + identifier + ')'),\n        TAG: new RegExp('^(' + identifier + '|[*])'),\n        ATTR: new RegExp('^' + attributes),\n        PSEUDO: new RegExp('^' + pseudos),\n        CHILD: new RegExp('^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(' + whitespace + '*(even|odd|(([+-]|)(\\\\d*)n|)' + whitespace + '*(?:([+-]|)' + whitespace + '*(\\\\d+)|))' + whitespace + '*\\\\)|)', 'i'),\n        bool: new RegExp('^(?:' + booleans + ')$', 'i'),\n        needsContext: new RegExp('^' + whitespace + '*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(' + whitespace + '*((?:-\\\\d)?\\\\d*)' + whitespace + '*\\\\)|)(?=[^-]|$)', 'i')\n      }, rinputs = /^(?:input|select|textarea|button)$/i, rheader = /^h\\d$/i, rnative = /^[^{]+\\{\\s*\\[native \\w/, rquickExpr = /^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/, rsibling = /[+~]/, rescape = /'|\\\\/g, runescape = new RegExp('\\\\\\\\([\\\\da-f]{1,6}' + whitespace + '?|(' + whitespace + ')|.)', 'ig'), funescape = function (_, escaped, escapedWhitespace) {\n        var high = '0x' + escaped - 65536;\n        return high !== high || escapedWhitespace ? escaped : high < 0 ? String.fromCharCode(high + 65536) : String.fromCharCode(high >> 10 | 55296, high & 1023 | 56320);\n      };\n    try {\n      push.apply(arr = slice.call(preferredDoc.childNodes), preferredDoc.childNodes);\n      arr[preferredDoc.childNodes.length].nodeType;\n    } catch (e) {\n      push = {\n        apply: arr.length ? function (target, els) {\n          push_native.apply(target, slice.call(els));\n        } : function (target, els) {\n          var j = target.length, i = 0;\n          while (target[j++] = els[i++]) {\n          }\n          target.length = j - 1;\n        }\n      };\n    }\n    var Sizzle = function (selector, context, results, seed) {\n      var match, elem, m, nodeType, i, groups, old, nid, newContext, newSelector;\n      if ((context ? context.ownerDocument || context : preferredDoc) !== document$1) {\n        setDocument(context);\n      }\n      context = context || document$1;\n      results = results || [];\n      if (!selector || typeof selector !== 'string') {\n        return results;\n      }\n      if ((nodeType = context.nodeType) !== 1 && nodeType !== 9) {\n        return [];\n      }\n      if (documentIsHTML && !seed) {\n        if (match = rquickExpr.exec(selector)) {\n          if (m = match[1]) {\n            if (nodeType === 9) {\n              elem = context.getElementById(m);\n              if (elem && elem.parentNode) {\n                if (elem.id === m) {\n                  results.push(elem);\n                  return results;\n                }\n              } else {\n                return results;\n              }\n            } else {\n              if (context.ownerDocument && (elem = context.ownerDocument.getElementById(m)) && contains$3(context, elem) && elem.id === m) {\n                results.push(elem);\n                return results;\n              }\n            }\n          } else if (match[2]) {\n            push.apply(results, context.getElementsByTagName(selector));\n            return results;\n          } else if ((m = match[3]) && support.getElementsByClassName) {\n            push.apply(results, context.getElementsByClassName(m));\n            return results;\n          }\n        }\n        if (support.qsa && (!rbuggyQSA || !rbuggyQSA.test(selector))) {\n          nid = old = expando;\n          newContext = context;\n          newSelector = nodeType === 9 && selector;\n          if (nodeType === 1 && context.nodeName.toLowerCase() !== 'object') {\n            groups = tokenize(selector);\n            if (old = context.getAttribute('id')) {\n              nid = old.replace(rescape, '\\\\$&');\n            } else {\n              context.setAttribute('id', nid);\n            }\n            nid = '[id=\\'' + nid + '\\'] ';\n            i = groups.length;\n            while (i--) {\n              groups[i] = nid + toSelector(groups[i]);\n            }\n            newContext = rsibling.test(selector) && testContext(context.parentNode) || context;\n            newSelector = groups.join(',');\n          }\n          if (newSelector) {\n            try {\n              push.apply(results, newContext.querySelectorAll(newSelector));\n              return results;\n            } catch (qsaError) {\n            } finally {\n              if (!old) {\n                context.removeAttribute('id');\n              }\n            }\n          }\n        }\n      }\n      return select(selector.replace(rtrim, '$1'), context, results, seed);\n    };\n    function createCache() {\n      var keys = [];\n      function cache(key, value) {\n        if (keys.push(key + ' ') > Expr.cacheLength) {\n          delete cache[keys.shift()];\n        }\n        return cache[key + ' '] = value;\n      }\n      return cache;\n    }\n    function markFunction(fn) {\n      fn[expando] = true;\n      return fn;\n    }\n    function siblingCheck(a, b) {\n      var cur = b && a, diff = cur && a.nodeType === 1 && b.nodeType === 1 && (~b.sourceIndex || MAX_NEGATIVE) - (~a.sourceIndex || MAX_NEGATIVE);\n      if (diff) {\n        return diff;\n      }\n      if (cur) {\n        while (cur = cur.nextSibling) {\n          if (cur === b) {\n            return -1;\n          }\n        }\n      }\n      return a ? 1 : -1;\n    }\n    function createInputPseudo(type) {\n      return function (elem) {\n        var name = elem.nodeName.toLowerCase();\n        return name === 'input' && elem.type === type;\n      };\n    }\n    function createButtonPseudo(type) {\n      return function (elem) {\n        var name = elem.nodeName.toLowerCase();\n        return (name === 'input' || name === 'button') && elem.type === type;\n      };\n    }\n    function createPositionalPseudo(fn) {\n      return markFunction(function (argument) {\n        argument = +argument;\n        return markFunction(function (seed, matches) {\n          var j, matchIndexes = fn([], seed.length, argument), i = matchIndexes.length;\n          while (i--) {\n            if (seed[j = matchIndexes[i]]) {\n              seed[j] = !(matches[j] = seed[j]);\n            }\n          }\n        });\n      });\n    }\n    function testContext(context) {\n      return context && typeof context.getElementsByTagName !== strundefined && context;\n    }\n    support = Sizzle.support = {};\n    isXML = Sizzle.isXML = function (elem) {\n      var documentElement = elem && (elem.ownerDocument || elem).documentElement;\n      return documentElement ? documentElement.nodeName !== 'HTML' : false;\n    };\n    setDocument = Sizzle.setDocument = function (node) {\n      var hasCompare, doc = node ? node.ownerDocument || node : preferredDoc, parent = doc.defaultView;\n      function getTop(win) {\n        try {\n          return win.top;\n        } catch (ex) {\n        }\n        return null;\n      }\n      if (doc === document$1 || doc.nodeType !== 9 || !doc.documentElement) {\n        return document$1;\n      }\n      document$1 = doc;\n      docElem = doc.documentElement;\n      documentIsHTML = !isXML(doc);\n      if (parent && parent !== getTop(parent)) {\n        if (parent.addEventListener) {\n          parent.addEventListener('unload', function () {\n            setDocument();\n          }, false);\n        } else if (parent.attachEvent) {\n          parent.attachEvent('onunload', function () {\n            setDocument();\n          });\n        }\n      }\n      support.attributes = true;\n      support.getElementsByTagName = true;\n      support.getElementsByClassName = rnative.test(doc.getElementsByClassName);\n      support.getById = true;\n      Expr.find.ID = function (id, context) {\n        if (typeof context.getElementById !== strundefined && documentIsHTML) {\n          var m = context.getElementById(id);\n          return m && m.parentNode ? [m] : [];\n        }\n      };\n      Expr.filter.ID = function (id) {\n        var attrId = id.replace(runescape, funescape);\n        return function (elem) {\n          return elem.getAttribute('id') === attrId;\n        };\n      };\n      Expr.find.TAG = support.getElementsByTagName ? function (tag, context) {\n        if (typeof context.getElementsByTagName !== strundefined) {\n          return context.getElementsByTagName(tag);\n        }\n      } : function (tag, context) {\n        var elem, tmp = [], i = 0, results = context.getElementsByTagName(tag);\n        if (tag === '*') {\n          while (elem = results[i++]) {\n            if (elem.nodeType === 1) {\n              tmp.push(elem);\n            }\n          }\n          return tmp;\n        }\n        return results;\n      };\n      Expr.find.CLASS = support.getElementsByClassName && function (className, context) {\n        if (documentIsHTML) {\n          return context.getElementsByClassName(className);\n        }\n      };\n      rbuggyMatches = [];\n      rbuggyQSA = [];\n      support.disconnectedMatch = true;\n      rbuggyQSA = rbuggyQSA.length && new RegExp(rbuggyQSA.join('|'));\n      rbuggyMatches = rbuggyMatches.length && new RegExp(rbuggyMatches.join('|'));\n      hasCompare = rnative.test(docElem.compareDocumentPosition);\n      contains$3 = hasCompare || rnative.test(docElem.contains) ? function (a, b) {\n        var adown = a.nodeType === 9 ? a.documentElement : a, bup = b && b.parentNode;\n        return a === bup || !!(bup && bup.nodeType === 1 && (adown.contains ? adown.contains(bup) : a.compareDocumentPosition && a.compareDocumentPosition(bup) & 16));\n      } : function (a, b) {\n        if (b) {\n          while (b = b.parentNode) {\n            if (b === a) {\n              return true;\n            }\n          }\n        }\n        return false;\n      };\n      sortOrder = hasCompare ? function (a, b) {\n        if (a === b) {\n          hasDuplicate = true;\n          return 0;\n        }\n        var compare = !a.compareDocumentPosition - !b.compareDocumentPosition;\n        if (compare) {\n          return compare;\n        }\n        compare = (a.ownerDocument || a) === (b.ownerDocument || b) ? a.compareDocumentPosition(b) : 1;\n        if (compare & 1 || !support.sortDetached && b.compareDocumentPosition(a) === compare) {\n          if (a === doc || a.ownerDocument === preferredDoc && contains$3(preferredDoc, a)) {\n            return -1;\n          }\n          if (b === doc || b.ownerDocument === preferredDoc && contains$3(preferredDoc, b)) {\n            return 1;\n          }\n          return sortInput ? indexOf$2.call(sortInput, a) - indexOf$2.call(sortInput, b) : 0;\n        }\n        return compare & 4 ? -1 : 1;\n      } : function (a, b) {\n        if (a === b) {\n          hasDuplicate = true;\n          return 0;\n        }\n        var cur, i = 0, aup = a.parentNode, bup = b.parentNode, ap = [a], bp = [b];\n        if (!aup || !bup) {\n          return a === doc ? -1 : b === doc ? 1 : aup ? -1 : bup ? 1 : sortInput ? indexOf$2.call(sortInput, a) - indexOf$2.call(sortInput, b) : 0;\n        } else if (aup === bup) {\n          return siblingCheck(a, b);\n        }\n        cur = a;\n        while (cur = cur.parentNode) {\n          ap.unshift(cur);\n        }\n        cur = b;\n        while (cur = cur.parentNode) {\n          bp.unshift(cur);\n        }\n        while (ap[i] === bp[i]) {\n          i++;\n        }\n        return i ? siblingCheck(ap[i], bp[i]) : ap[i] === preferredDoc ? -1 : bp[i] === preferredDoc ? 1 : 0;\n      };\n      return doc;\n    };\n    Sizzle.matches = function (expr, elements) {\n      return Sizzle(expr, null, null, elements);\n    };\n    Sizzle.matchesSelector = function (elem, expr) {\n      if ((elem.ownerDocument || elem) !== document$1) {\n        setDocument(elem);\n      }\n      expr = expr.replace(rattributeQuotes, '=\\'$1\\']');\n      if (support.matchesSelector && documentIsHTML && (!rbuggyMatches || !rbuggyMatches.test(expr)) && (!rbuggyQSA || !rbuggyQSA.test(expr))) {\n        try {\n          var ret = matches.call(elem, expr);\n          if (ret || support.disconnectedMatch || elem.document && elem.document.nodeType !== 11) {\n            return ret;\n          }\n        } catch (e) {\n        }\n      }\n      return Sizzle(expr, document$1, null, [elem]).length > 0;\n    };\n    Sizzle.contains = function (context, elem) {\n      if ((context.ownerDocument || context) !== document$1) {\n        setDocument(context);\n      }\n      return contains$3(context, elem);\n    };\n    Sizzle.attr = function (elem, name) {\n      if ((elem.ownerDocument || elem) !== document$1) {\n        setDocument(elem);\n      }\n      var fn = Expr.attrHandle[name.toLowerCase()], val = fn && hasOwn.call(Expr.attrHandle, name.toLowerCase()) ? fn(elem, name, !documentIsHTML) : undefined;\n      return val !== undefined ? val : support.attributes || !documentIsHTML ? elem.getAttribute(name) : (val = elem.getAttributeNode(name)) && val.specified ? val.value : null;\n    };\n    Sizzle.error = function (msg) {\n      throw new Error('Syntax error, unrecognized expression: ' + msg);\n    };\n    Sizzle.uniqueSort = function (results) {\n      var elem, duplicates = [], j = 0, i = 0;\n      hasDuplicate = !support.detectDuplicates;\n      sortInput = !support.sortStable && results.slice(0);\n      results.sort(sortOrder);\n      if (hasDuplicate) {\n        while (elem = results[i++]) {\n          if (elem === results[i]) {\n            j = duplicates.push(i);\n          }\n        }\n        while (j--) {\n          results.splice(duplicates[j], 1);\n        }\n      }\n      sortInput = null;\n      return results;\n    };\n    getText = Sizzle.getText = function (elem) {\n      var node, ret = '', i = 0, nodeType = elem.nodeType;\n      if (!nodeType) {\n        while (node = elem[i++]) {\n          ret += getText(node);\n        }\n      } else if (nodeType === 1 || nodeType === 9 || nodeType === 11) {\n        if (typeof elem.textContent === 'string') {\n          return elem.textContent;\n        } else {\n          for (elem = elem.firstChild; elem; elem = elem.nextSibling) {\n            ret += getText(elem);\n          }\n        }\n      } else if (nodeType === 3 || nodeType === 4) {\n        return elem.nodeValue;\n      }\n      return ret;\n    };\n    Expr = Sizzle.selectors = {\n      cacheLength: 50,\n      createPseudo: markFunction,\n      match: matchExpr,\n      attrHandle: {},\n      find: {},\n      relative: {\n        '>': {\n          dir: 'parentNode',\n          first: true\n        },\n        ' ': { dir: 'parentNode' },\n        '+': {\n          dir: 'previousSibling',\n          first: true\n        },\n        '~': { dir: 'previousSibling' }\n      },\n      preFilter: {\n        ATTR: function (match) {\n          match[1] = match[1].replace(runescape, funescape);\n          match[3] = (match[3] || match[4] || match[5] || '').replace(runescape, funescape);\n          if (match[2] === '~=') {\n            match[3] = ' ' + match[3] + ' ';\n          }\n          return match.slice(0, 4);\n        },\n        CHILD: function (match) {\n          match[1] = match[1].toLowerCase();\n          if (match[1].slice(0, 3) === 'nth') {\n            if (!match[3]) {\n              Sizzle.error(match[0]);\n            }\n            match[4] = +(match[4] ? match[5] + (match[6] || 1) : 2 * (match[3] === 'even' || match[3] === 'odd'));\n            match[5] = +(match[7] + match[8] || match[3] === 'odd');\n          } else if (match[3]) {\n            Sizzle.error(match[0]);\n          }\n          return match;\n        },\n        PSEUDO: function (match) {\n          var excess, unquoted = !match[6] && match[2];\n          if (matchExpr.CHILD.test(match[0])) {\n            return null;\n          }\n          if (match[3]) {\n            match[2] = match[4] || match[5] || '';\n          } else if (unquoted && rpseudo.test(unquoted) && (excess = tokenize(unquoted, true)) && (excess = unquoted.indexOf(')', unquoted.length - excess) - unquoted.length)) {\n            match[0] = match[0].slice(0, excess);\n            match[2] = unquoted.slice(0, excess);\n          }\n          return match.slice(0, 3);\n        }\n      },\n      filter: {\n        TAG: function (nodeNameSelector) {\n          var nodeName = nodeNameSelector.replace(runescape, funescape).toLowerCase();\n          return nodeNameSelector === '*' ? function () {\n            return true;\n          } : function (elem) {\n            return elem.nodeName && elem.nodeName.toLowerCase() === nodeName;\n          };\n        },\n        CLASS: function (className) {\n          var pattern = classCache[className + ' '];\n          return pattern || (pattern = new RegExp('(^|' + whitespace + ')' + className + '(' + whitespace + '|$)')) && classCache(className, function (elem) {\n            return pattern.test(typeof elem.className === 'string' && elem.className || typeof elem.getAttribute !== strundefined && elem.getAttribute('class') || '');\n          });\n        },\n        ATTR: function (name, operator, check) {\n          return function (elem) {\n            var result = Sizzle.attr(elem, name);\n            if (result == null) {\n              return operator === '!=';\n            }\n            if (!operator) {\n              return true;\n            }\n            result += '';\n            return operator === '=' ? result === check : operator === '!=' ? result !== check : operator === '^=' ? check && result.indexOf(check) === 0 : operator === '*=' ? check && result.indexOf(check) > -1 : operator === '$=' ? check && result.slice(-check.length) === check : operator === '~=' ? (' ' + result + ' ').indexOf(check) > -1 : operator === '|=' ? result === check || result.slice(0, check.length + 1) === check + '-' : false;\n          };\n        },\n        CHILD: function (type, what, argument, first, last) {\n          var simple = type.slice(0, 3) !== 'nth', forward = type.slice(-4) !== 'last', ofType = what === 'of-type';\n          return first === 1 && last === 0 ? function (elem) {\n            return !!elem.parentNode;\n          } : function (elem, context, xml) {\n            var cache, outerCache, node, diff, nodeIndex, start, dir = simple !== forward ? 'nextSibling' : 'previousSibling', parent = elem.parentNode, name = ofType && elem.nodeName.toLowerCase(), useCache = !xml && !ofType;\n            if (parent) {\n              if (simple) {\n                while (dir) {\n                  node = elem;\n                  while (node = node[dir]) {\n                    if (ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1) {\n                      return false;\n                    }\n                  }\n                  start = dir = type === 'only' && !start && 'nextSibling';\n                }\n                return true;\n              }\n              start = [forward ? parent.firstChild : parent.lastChild];\n              if (forward && useCache) {\n                outerCache = parent[expando] || (parent[expando] = {});\n                cache = outerCache[type] || [];\n                nodeIndex = cache[0] === dirruns && cache[1];\n                diff = cache[0] === dirruns && cache[2];\n                node = nodeIndex && parent.childNodes[nodeIndex];\n                while (node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop()) {\n                  if (node.nodeType === 1 && ++diff && node === elem) {\n                    outerCache[type] = [\n                      dirruns,\n                      nodeIndex,\n                      diff\n                    ];\n                    break;\n                  }\n                }\n              } else if (useCache && (cache = (elem[expando] || (elem[expando] = {}))[type]) && cache[0] === dirruns) {\n                diff = cache[1];\n              } else {\n                while (node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop()) {\n                  if ((ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1) && ++diff) {\n                    if (useCache) {\n                      (node[expando] || (node[expando] = {}))[type] = [\n                        dirruns,\n                        diff\n                      ];\n                    }\n                    if (node === elem) {\n                      break;\n                    }\n                  }\n                }\n              }\n              diff -= last;\n              return diff === first || diff % first === 0 && diff / first >= 0;\n            }\n          };\n        },\n        PSEUDO: function (pseudo, argument) {\n          var args, fn = Expr.pseudos[pseudo] || Expr.setFilters[pseudo.toLowerCase()] || Sizzle.error('unsupported pseudo: ' + pseudo);\n          if (fn[expando]) {\n            return fn(argument);\n          }\n          if (fn.length > 1) {\n            args = [\n              pseudo,\n              pseudo,\n              '',\n              argument\n            ];\n            return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase()) ? markFunction(function (seed, matches) {\n              var idx, matched = fn(seed, argument), i = matched.length;\n              while (i--) {\n                idx = indexOf$2.call(seed, matched[i]);\n                seed[idx] = !(matches[idx] = matched[i]);\n              }\n            }) : function (elem) {\n              return fn(elem, 0, args);\n            };\n          }\n          return fn;\n        }\n      },\n      pseudos: {\n        not: markFunction(function (selector) {\n          var input = [], results = [], matcher = compile(selector.replace(rtrim, '$1'));\n          return matcher[expando] ? markFunction(function (seed, matches, context, xml) {\n            var elem, unmatched = matcher(seed, null, xml, []), i = seed.length;\n            while (i--) {\n              if (elem = unmatched[i]) {\n                seed[i] = !(matches[i] = elem);\n              }\n            }\n          }) : function (elem, context, xml) {\n            input[0] = elem;\n            matcher(input, null, xml, results);\n            input[0] = null;\n            return !results.pop();\n          };\n        }),\n        has: markFunction(function (selector) {\n          return function (elem) {\n            return Sizzle(selector, elem).length > 0;\n          };\n        }),\n        contains: markFunction(function (text) {\n          text = text.replace(runescape, funescape);\n          return function (elem) {\n            return (elem.textContent || elem.innerText || getText(elem)).indexOf(text) > -1;\n          };\n        }),\n        lang: markFunction(function (lang) {\n          if (!ridentifier.test(lang || '')) {\n            Sizzle.error('unsupported lang: ' + lang);\n          }\n          lang = lang.replace(runescape, funescape).toLowerCase();\n          return function (elem) {\n            var elemLang;\n            do {\n              if (elemLang = documentIsHTML ? elem.lang : elem.getAttribute('xml:lang') || elem.getAttribute('lang')) {\n                elemLang = elemLang.toLowerCase();\n                return elemLang === lang || elemLang.indexOf(lang + '-') === 0;\n              }\n            } while ((elem = elem.parentNode) && elem.nodeType === 1);\n            return false;\n          };\n        }),\n        target: function (elem) {\n          var hash = window.location && window.location.hash;\n          return hash && hash.slice(1) === elem.id;\n        },\n        root: function (elem) {\n          return elem === docElem;\n        },\n        focus: function (elem) {\n          return elem === document$1.activeElement && (!document$1.hasFocus || document$1.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);\n        },\n        enabled: function (elem) {\n          return elem.disabled === false;\n        },\n        disabled: function (elem) {\n          return elem.disabled === true;\n        },\n        checked: function (elem) {\n          var nodeName = elem.nodeName.toLowerCase();\n          return nodeName === 'input' && !!elem.checked || nodeName === 'option' && !!elem.selected;\n        },\n        selected: function (elem) {\n          if (elem.parentNode) {\n            elem.parentNode.selectedIndex;\n          }\n          return elem.selected === true;\n        },\n        empty: function (elem) {\n          for (elem = elem.firstChild; elem; elem = elem.nextSibling) {\n            if (elem.nodeType < 6) {\n              return false;\n            }\n          }\n          return true;\n        },\n        parent: function (elem) {\n          return !Expr.pseudos.empty(elem);\n        },\n        header: function (elem) {\n          return rheader.test(elem.nodeName);\n        },\n        input: function (elem) {\n          return rinputs.test(elem.nodeName);\n        },\n        button: function (elem) {\n          var name = elem.nodeName.toLowerCase();\n          return name === 'input' && elem.type === 'button' || name === 'button';\n        },\n        text: function (elem) {\n          var attr;\n          return elem.nodeName.toLowerCase() === 'input' && elem.type === 'text' && ((attr = elem.getAttribute('type')) == null || attr.toLowerCase() === 'text');\n        },\n        first: createPositionalPseudo(function () {\n          return [0];\n        }),\n        last: createPositionalPseudo(function (matchIndexes, length) {\n          return [length - 1];\n        }),\n        eq: createPositionalPseudo(function (matchIndexes, length, argument) {\n          return [argument < 0 ? argument + length : argument];\n        }),\n        even: createPositionalPseudo(function (matchIndexes, length) {\n          var i = 0;\n          for (; i < length; i += 2) {\n            matchIndexes.push(i);\n          }\n          return matchIndexes;\n        }),\n        odd: createPositionalPseudo(function (matchIndexes, length) {\n          var i = 1;\n          for (; i < length; i += 2) {\n            matchIndexes.push(i);\n          }\n          return matchIndexes;\n        }),\n        lt: createPositionalPseudo(function (matchIndexes, length, argument) {\n          var i = argument < 0 ? argument + length : argument;\n          for (; --i >= 0;) {\n            matchIndexes.push(i);\n          }\n          return matchIndexes;\n        }),\n        gt: createPositionalPseudo(function (matchIndexes, length, argument) {\n          var i = argument < 0 ? argument + length : argument;\n          for (; ++i < length;) {\n            matchIndexes.push(i);\n          }\n          return matchIndexes;\n        })\n      }\n    };\n    Expr.pseudos.nth = Expr.pseudos.eq;\n    each([\n      'radio',\n      'checkbox',\n      'file',\n      'password',\n      'image'\n    ], function (i) {\n      Expr.pseudos[i] = createInputPseudo(i);\n    });\n    each([\n      'submit',\n      'reset'\n    ], function (i) {\n      Expr.pseudos[i] = createButtonPseudo(i);\n    });\n    function setFilters() {\n    }\n    setFilters.prototype = Expr.filters = Expr.pseudos;\n    Expr.setFilters = new setFilters();\n    tokenize = Sizzle.tokenize = function (selector, parseOnly) {\n      var matched, match, tokens, type, soFar, groups, preFilters, cached = tokenCache[selector + ' '];\n      if (cached) {\n        return parseOnly ? 0 : cached.slice(0);\n      }\n      soFar = selector;\n      groups = [];\n      preFilters = Expr.preFilter;\n      while (soFar) {\n        if (!matched || (match = rcomma.exec(soFar))) {\n          if (match) {\n            soFar = soFar.slice(match[0].length) || soFar;\n          }\n          groups.push(tokens = []);\n        }\n        matched = false;\n        if (match = rcombinators.exec(soFar)) {\n          matched = match.shift();\n          tokens.push({\n            value: matched,\n            type: match[0].replace(rtrim, ' ')\n          });\n          soFar = soFar.slice(matched.length);\n        }\n        for (type in Expr.filter) {\n          if (!Expr.filter.hasOwnProperty(type)) {\n            continue;\n          }\n          if ((match = matchExpr[type].exec(soFar)) && (!preFilters[type] || (match = preFilters[type](match)))) {\n            matched = match.shift();\n            tokens.push({\n              value: matched,\n              type: type,\n              matches: match\n            });\n            soFar = soFar.slice(matched.length);\n          }\n        }\n        if (!matched) {\n          break;\n        }\n      }\n      return parseOnly ? soFar.length : soFar ? Sizzle.error(selector) : tokenCache(selector, groups).slice(0);\n    };\n    function toSelector(tokens) {\n      var i = 0, len = tokens.length, selector = '';\n      for (; i < len; i++) {\n        selector += tokens[i].value;\n      }\n      return selector;\n    }\n    function addCombinator(matcher, combinator, base) {\n      var dir = combinator.dir, checkNonElements = base && dir === 'parentNode', doneName = done++;\n      return combinator.first ? function (elem, context, xml) {\n        while (elem = elem[dir]) {\n          if (elem.nodeType === 1 || checkNonElements) {\n            return matcher(elem, context, xml);\n          }\n        }\n      } : function (elem, context, xml) {\n        var oldCache, outerCache, newCache = [\n            dirruns,\n            doneName\n          ];\n        if (xml) {\n          while (elem = elem[dir]) {\n            if (elem.nodeType === 1 || checkNonElements) {\n              if (matcher(elem, context, xml)) {\n                return true;\n              }\n            }\n          }\n        } else {\n          while (elem = elem[dir]) {\n            if (elem.nodeType === 1 || checkNonElements) {\n              outerCache = elem[expando] || (elem[expando] = {});\n              if ((oldCache = outerCache[dir]) && oldCache[0] === dirruns && oldCache[1] === doneName) {\n                return newCache[2] = oldCache[2];\n              } else {\n                outerCache[dir] = newCache;\n                if (newCache[2] = matcher(elem, context, xml)) {\n                  return true;\n                }\n              }\n            }\n          }\n        }\n      };\n    }\n    function elementMatcher(matchers) {\n      return matchers.length > 1 ? function (elem, context, xml) {\n        var i = matchers.length;\n        while (i--) {\n          if (!matchers[i](elem, context, xml)) {\n            return false;\n          }\n        }\n        return true;\n      } : matchers[0];\n    }\n    function multipleContexts(selector, contexts, results) {\n      var i = 0, len = contexts.length;\n      for (; i < len; i++) {\n        Sizzle(selector, contexts[i], results);\n      }\n      return results;\n    }\n    function condense(unmatched, map, filter, context, xml) {\n      var elem, newUnmatched = [], i = 0, len = unmatched.length, mapped = map != null;\n      for (; i < len; i++) {\n        if (elem = unmatched[i]) {\n          if (!filter || filter(elem, context, xml)) {\n            newUnmatched.push(elem);\n            if (mapped) {\n              map.push(i);\n            }\n          }\n        }\n      }\n      return newUnmatched;\n    }\n    function setMatcher(preFilter, selector, matcher, postFilter, postFinder, postSelector) {\n      if (postFilter && !postFilter[expando]) {\n        postFilter = setMatcher(postFilter);\n      }\n      if (postFinder && !postFinder[expando]) {\n        postFinder = setMatcher(postFinder, postSelector);\n      }\n      return markFunction(function (seed, results, context, xml) {\n        var temp, i, elem, preMap = [], postMap = [], preexisting = results.length, elems = seed || multipleContexts(selector || '*', context.nodeType ? [context] : context, []), matcherIn = preFilter && (seed || !selector) ? condense(elems, preMap, preFilter, context, xml) : elems, matcherOut = matcher ? postFinder || (seed ? preFilter : preexisting || postFilter) ? [] : results : matcherIn;\n        if (matcher) {\n          matcher(matcherIn, matcherOut, context, xml);\n        }\n        if (postFilter) {\n          temp = condense(matcherOut, postMap);\n          postFilter(temp, [], context, xml);\n          i = temp.length;\n          while (i--) {\n            if (elem = temp[i]) {\n              matcherOut[postMap[i]] = !(matcherIn[postMap[i]] = elem);\n            }\n          }\n        }\n        if (seed) {\n          if (postFinder || preFilter) {\n            if (postFinder) {\n              temp = [];\n              i = matcherOut.length;\n              while (i--) {\n                if (elem = matcherOut[i]) {\n                  temp.push(matcherIn[i] = elem);\n                }\n              }\n              postFinder(null, matcherOut = [], temp, xml);\n            }\n            i = matcherOut.length;\n            while (i--) {\n              if ((elem = matcherOut[i]) && (temp = postFinder ? indexOf$2.call(seed, elem) : preMap[i]) > -1) {\n                seed[temp] = !(results[temp] = elem);\n              }\n            }\n          }\n        } else {\n          matcherOut = condense(matcherOut === results ? matcherOut.splice(preexisting, matcherOut.length) : matcherOut);\n          if (postFinder) {\n            postFinder(null, results, matcherOut, xml);\n          } else {\n            push.apply(results, matcherOut);\n          }\n        }\n      });\n    }\n    function matcherFromTokens(tokens) {\n      var checkContext, matcher, j, len = tokens.length, leadingRelative = Expr.relative[tokens[0].type], implicitRelative = leadingRelative || Expr.relative[' '], i = leadingRelative ? 1 : 0, matchContext = addCombinator(function (elem) {\n          return elem === checkContext;\n        }, implicitRelative, true), matchAnyContext = addCombinator(function (elem) {\n          return indexOf$2.call(checkContext, elem) > -1;\n        }, implicitRelative, true), matchers = [function (elem, context, xml) {\n            var ret = !leadingRelative && (xml || context !== outermostContext) || ((checkContext = context).nodeType ? matchContext(elem, context, xml) : matchAnyContext(elem, context, xml));\n            checkContext = null;\n            return ret;\n          }];\n      for (; i < len; i++) {\n        if (matcher = Expr.relative[tokens[i].type]) {\n          matchers = [addCombinator(elementMatcher(matchers), matcher)];\n        } else {\n          matcher = Expr.filter[tokens[i].type].apply(null, tokens[i].matches);\n          if (matcher[expando]) {\n            j = ++i;\n            for (; j < len; j++) {\n              if (Expr.relative[tokens[j].type]) {\n                break;\n              }\n            }\n            return setMatcher(i > 1 && elementMatcher(matchers), i > 1 && toSelector(tokens.slice(0, i - 1).concat({ value: tokens[i - 2].type === ' ' ? '*' : '' })).replace(rtrim, '$1'), matcher, i < j && matcherFromTokens(tokens.slice(i, j)), j < len && matcherFromTokens(tokens = tokens.slice(j)), j < len && toSelector(tokens));\n          }\n          matchers.push(matcher);\n        }\n      }\n      return elementMatcher(matchers);\n    }\n    function matcherFromGroupMatchers(elementMatchers, setMatchers) {\n      var bySet = setMatchers.length > 0, byElement = elementMatchers.length > 0, superMatcher = function (seed, context, xml, results, outermost) {\n          var elem, j, matcher, matchedCount = 0, i = '0', unmatched = seed && [], setMatched = [], contextBackup = outermostContext, elems = seed || byElement && Expr.find.TAG('*', outermost), dirrunsUnique = dirruns += contextBackup == null ? 1 : Math.random() || 0.1, len = elems.length;\n          if (outermost) {\n            outermostContext = context !== document$1 && context;\n          }\n          for (; i !== len && (elem = elems[i]) != null; i++) {\n            if (byElement && elem) {\n              j = 0;\n              while (matcher = elementMatchers[j++]) {\n                if (matcher(elem, context, xml)) {\n                  results.push(elem);\n                  break;\n                }\n              }\n              if (outermost) {\n                dirruns = dirrunsUnique;\n              }\n            }\n            if (bySet) {\n              if (elem = !matcher && elem) {\n                matchedCount--;\n              }\n              if (seed) {\n                unmatched.push(elem);\n              }\n            }\n          }\n          matchedCount += i;\n          if (bySet && i !== matchedCount) {\n            j = 0;\n            while (matcher = setMatchers[j++]) {\n              matcher(unmatched, setMatched, context, xml);\n            }\n            if (seed) {\n              if (matchedCount > 0) {\n                while (i--) {\n                  if (!(unmatched[i] || setMatched[i])) {\n                    setMatched[i] = pop.call(results);\n                  }\n                }\n              }\n              setMatched = condense(setMatched);\n            }\n            push.apply(results, setMatched);\n            if (outermost && !seed && setMatched.length > 0 && matchedCount + setMatchers.length > 1) {\n              Sizzle.uniqueSort(results);\n            }\n          }\n          if (outermost) {\n            dirruns = dirrunsUnique;\n            outermostContext = contextBackup;\n          }\n          return unmatched;\n        };\n      return bySet ? markFunction(superMatcher) : superMatcher;\n    }\n    compile = Sizzle.compile = function (selector, match) {\n      var i, setMatchers = [], elementMatchers = [], cached = compilerCache[selector + ' '];\n      if (!cached) {\n        if (!match) {\n          match = tokenize(selector);\n        }\n        i = match.length;\n        while (i--) {\n          cached = matcherFromTokens(match[i]);\n          if (cached[expando]) {\n            setMatchers.push(cached);\n          } else {\n            elementMatchers.push(cached);\n          }\n        }\n        cached = compilerCache(selector, matcherFromGroupMatchers(elementMatchers, setMatchers));\n        cached.selector = selector;\n      }\n      return cached;\n    };\n    select = Sizzle.select = function (selector, context, results, seed) {\n      var i, tokens, token, type, find, compiled = typeof selector === 'function' && selector, match = !seed && tokenize(selector = compiled.selector || selector);\n      results = results || [];\n      if (match.length === 1) {\n        tokens = match[0] = match[0].slice(0);\n        if (tokens.length > 2 && (token = tokens[0]).type === 'ID' && support.getById && context.nodeType === 9 && documentIsHTML && Expr.relative[tokens[1].type]) {\n          context = (Expr.find.ID(token.matches[0].replace(runescape, funescape), context) || [])[0];\n          if (!context) {\n            return results;\n          } else if (compiled) {\n            context = context.parentNode;\n          }\n          selector = selector.slice(tokens.shift().value.length);\n        }\n        i = matchExpr.needsContext.test(selector) ? 0 : tokens.length;\n        while (i--) {\n          token = tokens[i];\n          if (Expr.relative[type = token.type]) {\n            break;\n          }\n          if (find = Expr.find[type]) {\n            if (seed = find(token.matches[0].replace(runescape, funescape), rsibling.test(tokens[0].type) && testContext(context.parentNode) || context)) {\n              tokens.splice(i, 1);\n              selector = seed.length && toSelector(tokens);\n              if (!selector) {\n                push.apply(results, seed);\n                return results;\n              }\n              break;\n            }\n          }\n        }\n      }\n      (compiled || compile(selector, match))(seed, context, !documentIsHTML, results, rsibling.test(selector) && testContext(context.parentNode) || context);\n      return results;\n    };\n    support.sortStable = expando.split('').sort(sortOrder).join('') === expando;\n    support.detectDuplicates = !!hasDuplicate;\n    setDocument();\n    support.sortDetached = true;\n\n    var doc = document;\n    var push$1 = Array.prototype.push;\n    var slice$1 = Array.prototype.slice;\n    var rquickExpr$1 = /^(?:[^#<]*(<[\\w\\W]+>)[^>]*$|#([\\w\\-]*)$)/;\n    var Event = EventUtils.Event;\n    var skipUniques = Tools.makeMap('children,contents,next,prev');\n    var isDefined = function (obj) {\n      return typeof obj !== 'undefined';\n    };\n    var isString$1 = function (obj) {\n      return typeof obj === 'string';\n    };\n    var isWindow = function (obj) {\n      return obj && obj === obj.window;\n    };\n    var createFragment = function (html, fragDoc) {\n      fragDoc = fragDoc || doc;\n      var container = fragDoc.createElement('div');\n      var frag = fragDoc.createDocumentFragment();\n      container.innerHTML = html;\n      var node;\n      while (node = container.firstChild) {\n        frag.appendChild(node);\n      }\n      return frag;\n    };\n    var domManipulate = function (targetNodes, sourceItem, callback, reverse) {\n      var i;\n      if (isString$1(sourceItem)) {\n        sourceItem = createFragment(sourceItem, getElementDocument(targetNodes[0]));\n      } else if (sourceItem.length && !sourceItem.nodeType) {\n        sourceItem = DomQuery.makeArray(sourceItem);\n        if (reverse) {\n          for (i = sourceItem.length - 1; i >= 0; i--) {\n            domManipulate(targetNodes, sourceItem[i], callback, reverse);\n          }\n        } else {\n          for (i = 0; i < sourceItem.length; i++) {\n            domManipulate(targetNodes, sourceItem[i], callback, reverse);\n          }\n        }\n        return targetNodes;\n      }\n      if (sourceItem.nodeType) {\n        i = targetNodes.length;\n        while (i--) {\n          callback.call(targetNodes[i], sourceItem);\n        }\n      }\n      return targetNodes;\n    };\n    var hasClass = function (node, className) {\n      return node && className && (' ' + node.className + ' ').indexOf(' ' + className + ' ') !== -1;\n    };\n    var wrap$1 = function (elements, wrapper, all) {\n      var lastParent, newWrapper;\n      wrapper = DomQuery(wrapper)[0];\n      elements.each(function () {\n        var self = this;\n        if (!all || lastParent !== self.parentNode) {\n          lastParent = self.parentNode;\n          newWrapper = wrapper.cloneNode(false);\n          self.parentNode.insertBefore(newWrapper, self);\n          newWrapper.appendChild(self);\n        } else {\n          newWrapper.appendChild(self);\n        }\n      });\n      return elements;\n    };\n    var numericCssMap = Tools.makeMap('fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom', ' ');\n    var booleanMap = Tools.makeMap('checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected', ' ');\n    var propFix = {\n      for: 'htmlFor',\n      class: 'className',\n      readonly: 'readOnly'\n    };\n    var cssFix = { float: 'cssFloat' };\n    var attrHooks = {}, cssHooks = {};\n    var DomQueryConstructor = function (selector, context) {\n      return new DomQuery.fn.init(selector, context);\n    };\n    var inArray$1 = function (item, array) {\n      var i;\n      if (array.indexOf) {\n        return array.indexOf(item);\n      }\n      i = array.length;\n      while (i--) {\n        if (array[i] === item) {\n          return i;\n        }\n      }\n      return -1;\n    };\n    var whiteSpaceRegExp$2 = /^\\s*|\\s*$/g;\n    var trim$3 = function (str) {\n      return str === null || str === undefined ? '' : ('' + str).replace(whiteSpaceRegExp$2, '');\n    };\n    var each$4 = function (obj, callback) {\n      var length, key, i, value;\n      if (obj) {\n        length = obj.length;\n        if (length === undefined) {\n          for (key in obj) {\n            if (obj.hasOwnProperty(key)) {\n              value = obj[key];\n              if (callback.call(value, key, value) === false) {\n                break;\n              }\n            }\n          }\n        } else {\n          for (i = 0; i < length; i++) {\n            value = obj[i];\n            if (callback.call(value, i, value) === false) {\n              break;\n            }\n          }\n        }\n      }\n      return obj;\n    };\n    var grep = function (array, callback) {\n      var out = [];\n      each$4(array, function (i, item) {\n        if (callback(item, i)) {\n          out.push(item);\n        }\n      });\n      return out;\n    };\n    var getElementDocument = function (element) {\n      if (!element) {\n        return doc;\n      }\n      if (element.nodeType === 9) {\n        return element;\n      }\n      return element.ownerDocument;\n    };\n    DomQueryConstructor.fn = DomQueryConstructor.prototype = {\n      constructor: DomQueryConstructor,\n      selector: '',\n      context: null,\n      length: 0,\n      init: function (selector, context) {\n        var self = this;\n        var match, node;\n        if (!selector) {\n          return self;\n        }\n        if (selector.nodeType) {\n          self.context = self[0] = selector;\n          self.length = 1;\n          return self;\n        }\n        if (context && context.nodeType) {\n          self.context = context;\n        } else {\n          if (context) {\n            return DomQuery(selector).attr(context);\n          }\n          self.context = context = document;\n        }\n        if (isString$1(selector)) {\n          self.selector = selector;\n          if (selector.charAt(0) === '<' && selector.charAt(selector.length - 1) === '>' && selector.length >= 3) {\n            match = [\n              null,\n              selector,\n              null\n            ];\n          } else {\n            match = rquickExpr$1.exec(selector);\n          }\n          if (match) {\n            if (match[1]) {\n              node = createFragment(selector, getElementDocument(context)).firstChild;\n              while (node) {\n                push$1.call(self, node);\n                node = node.nextSibling;\n              }\n            } else {\n              node = getElementDocument(context).getElementById(match[2]);\n              if (!node) {\n                return self;\n              }\n              if (node.id !== match[2]) {\n                return self.find(selector);\n              }\n              self.length = 1;\n              self[0] = node;\n            }\n          } else {\n            return DomQuery(context).find(selector);\n          }\n        } else {\n          this.add(selector, false);\n        }\n        return self;\n      },\n      toArray: function () {\n        return Tools.toArray(this);\n      },\n      add: function (items, sort) {\n        var self = this;\n        var nodes, i;\n        if (isString$1(items)) {\n          return self.add(DomQuery(items));\n        }\n        if (sort !== false) {\n          nodes = DomQuery.unique(self.toArray().concat(DomQuery.makeArray(items)));\n          self.length = nodes.length;\n          for (i = 0; i < nodes.length; i++) {\n            self[i] = nodes[i];\n          }\n        } else {\n          push$1.apply(self, DomQuery.makeArray(items));\n        }\n        return self;\n      },\n      attr: function (name, value) {\n        var self = this;\n        var hook;\n        if (typeof name === 'object') {\n          each$4(name, function (name, value) {\n            self.attr(name, value);\n          });\n        } else if (isDefined(value)) {\n          this.each(function () {\n            var hook;\n            if (this.nodeType === 1) {\n              hook = attrHooks[name];\n              if (hook && hook.set) {\n                hook.set(this, value);\n                return;\n              }\n              if (value === null) {\n                this.removeAttribute(name, 2);\n              } else {\n                this.setAttribute(name, value, 2);\n              }\n            }\n          });\n        } else {\n          if (self[0] && self[0].nodeType === 1) {\n            hook = attrHooks[name];\n            if (hook && hook.get) {\n              return hook.get(self[0], name);\n            }\n            if (booleanMap[name]) {\n              return self.prop(name) ? name : undefined;\n            }\n            value = self[0].getAttribute(name, 2);\n            if (value === null) {\n              value = undefined;\n            }\n          }\n          return value;\n        }\n        return self;\n      },\n      removeAttr: function (name) {\n        return this.attr(name, null);\n      },\n      prop: function (name, value) {\n        var self = this;\n        name = propFix[name] || name;\n        if (typeof name === 'object') {\n          each$4(name, function (name, value) {\n            self.prop(name, value);\n          });\n        } else if (isDefined(value)) {\n          this.each(function () {\n            if (this.nodeType === 1) {\n              this[name] = value;\n            }\n          });\n        } else {\n          if (self[0] && self[0].nodeType && name in self[0]) {\n            return self[0][name];\n          }\n          return value;\n        }\n        return self;\n      },\n      css: function (name, value) {\n        var self = this;\n        var elm, hook;\n        var camel = function (name) {\n          return name.replace(/-(\\D)/g, function (a, b) {\n            return b.toUpperCase();\n          });\n        };\n        var dashed = function (name) {\n          return name.replace(/[A-Z]/g, function (a) {\n            return '-' + a;\n          });\n        };\n        if (typeof name === 'object') {\n          each$4(name, function (name, value) {\n            self.css(name, value);\n          });\n        } else {\n          if (isDefined(value)) {\n            name = camel(name);\n            if (typeof value === 'number' && !numericCssMap[name]) {\n              value = value.toString() + 'px';\n            }\n            self.each(function () {\n              var style = this.style;\n              hook = cssHooks[name];\n              if (hook && hook.set) {\n                hook.set(this, value);\n                return;\n              }\n              try {\n                this.style[cssFix[name] || name] = value;\n              } catch (ex) {\n              }\n              if (value === null || value === '') {\n                if (style.removeProperty) {\n                  style.removeProperty(dashed(name));\n                } else {\n                  style.removeAttribute(name);\n                }\n              }\n            });\n          } else {\n            elm = self[0];\n            hook = cssHooks[name];\n            if (hook && hook.get) {\n              return hook.get(elm);\n            }\n            if (elm.ownerDocument.defaultView) {\n              try {\n                return elm.ownerDocument.defaultView.getComputedStyle(elm, null).getPropertyValue(dashed(name));\n              } catch (ex) {\n                return undefined;\n              }\n            } else if (elm.currentStyle) {\n              return elm.currentStyle[camel(name)];\n            } else {\n              return '';\n            }\n          }\n        }\n        return self;\n      },\n      remove: function () {\n        var self = this;\n        var node, i = this.length;\n        while (i--) {\n          node = self[i];\n          Event.clean(node);\n          if (node.parentNode) {\n            node.parentNode.removeChild(node);\n          }\n        }\n        return this;\n      },\n      empty: function () {\n        var self = this;\n        var node, i = this.length;\n        while (i--) {\n          node = self[i];\n          while (node.firstChild) {\n            node.removeChild(node.firstChild);\n          }\n        }\n        return this;\n      },\n      html: function (value) {\n        var self = this;\n        var i;\n        if (isDefined(value)) {\n          i = self.length;\n          try {\n            while (i--) {\n              self[i].innerHTML = value;\n            }\n          } catch (ex) {\n            DomQuery(self[i]).empty().append(value);\n          }\n          return self;\n        }\n        return self[0] ? self[0].innerHTML : '';\n      },\n      text: function (value) {\n        var self = this;\n        var i;\n        if (isDefined(value)) {\n          i = self.length;\n          while (i--) {\n            if ('innerText' in self[i]) {\n              self[i].innerText = value;\n            } else {\n              self[0].textContent = value;\n            }\n          }\n          return self;\n        }\n        return self[0] ? self[0].innerText || self[0].textContent : '';\n      },\n      append: function () {\n        return domManipulate(this, arguments, function (node) {\n          if (this.nodeType === 1 || this.host && this.host.nodeType === 1) {\n            this.appendChild(node);\n          }\n        });\n      },\n      prepend: function () {\n        return domManipulate(this, arguments, function (node) {\n          if (this.nodeType === 1 || this.host && this.host.nodeType === 1) {\n            this.insertBefore(node, this.firstChild);\n          }\n        }, true);\n      },\n      before: function () {\n        var self = this;\n        if (self[0] && self[0].parentNode) {\n          return domManipulate(self, arguments, function (node) {\n            this.parentNode.insertBefore(node, this);\n          });\n        }\n        return self;\n      },\n      after: function () {\n        var self = this;\n        if (self[0] && self[0].parentNode) {\n          return domManipulate(self, arguments, function (node) {\n            this.parentNode.insertBefore(node, this.nextSibling);\n          }, true);\n        }\n        return self;\n      },\n      appendTo: function (val) {\n        DomQuery(val).append(this);\n        return this;\n      },\n      prependTo: function (val) {\n        DomQuery(val).prepend(this);\n        return this;\n      },\n      replaceWith: function (content) {\n        return this.before(content).remove();\n      },\n      wrap: function (content) {\n        return wrap$1(this, content);\n      },\n      wrapAll: function (content) {\n        return wrap$1(this, content, true);\n      },\n      wrapInner: function (content) {\n        this.each(function () {\n          DomQuery(this).contents().wrapAll(content);\n        });\n        return this;\n      },\n      unwrap: function () {\n        return this.parent().each(function () {\n          DomQuery(this).replaceWith(this.childNodes);\n        });\n      },\n      clone: function () {\n        var result = [];\n        this.each(function () {\n          result.push(this.cloneNode(true));\n        });\n        return DomQuery(result);\n      },\n      addClass: function (className) {\n        return this.toggleClass(className, true);\n      },\n      removeClass: function (className) {\n        return this.toggleClass(className, false);\n      },\n      toggleClass: function (className, state) {\n        var self = this;\n        if (typeof className !== 'string') {\n          return self;\n        }\n        if (className.indexOf(' ') !== -1) {\n          each$4(className.split(' '), function () {\n            self.toggleClass(this, state);\n          });\n        } else {\n          self.each(function (index, node) {\n            var classState = hasClass(node, className);\n            if (classState !== state) {\n              var existingClassName = node.className;\n              if (classState) {\n                node.className = trim$3((' ' + existingClassName + ' ').replace(' ' + className + ' ', ' '));\n              } else {\n                node.className += existingClassName ? ' ' + className : className;\n              }\n            }\n          });\n        }\n        return self;\n      },\n      hasClass: function (className) {\n        return hasClass(this[0], className);\n      },\n      each: function (callback) {\n        return each$4(this, callback);\n      },\n      on: function (name, callback) {\n        return this.each(function () {\n          Event.bind(this, name, callback);\n        });\n      },\n      off: function (name, callback) {\n        return this.each(function () {\n          Event.unbind(this, name, callback);\n        });\n      },\n      trigger: function (name) {\n        return this.each(function () {\n          if (typeof name === 'object') {\n            Event.fire(this, name.type, name);\n          } else {\n            Event.fire(this, name);\n          }\n        });\n      },\n      show: function () {\n        return this.css('display', '');\n      },\n      hide: function () {\n        return this.css('display', 'none');\n      },\n      slice: function () {\n        return DomQuery(slice$1.apply(this, arguments));\n      },\n      eq: function (index) {\n        return index === -1 ? this.slice(index) : this.slice(index, +index + 1);\n      },\n      first: function () {\n        return this.eq(0);\n      },\n      last: function () {\n        return this.eq(-1);\n      },\n      find: function (selector) {\n        var i, l;\n        var ret = [];\n        for (i = 0, l = this.length; i < l; i++) {\n          DomQuery.find(selector, this[i], ret);\n        }\n        return DomQuery(ret);\n      },\n      filter: function (selector) {\n        if (typeof selector === 'function') {\n          return DomQuery(grep(this.toArray(), function (item, i) {\n            return selector(i, item);\n          }));\n        }\n        return DomQuery(DomQuery.filter(selector, this.toArray()));\n      },\n      closest: function (selector) {\n        var result = [];\n        if (selector instanceof DomQuery) {\n          selector = selector[0];\n        }\n        this.each(function (i, node) {\n          while (node) {\n            if (typeof selector === 'string' && DomQuery(node).is(selector)) {\n              result.push(node);\n              break;\n            } else if (node === selector) {\n              result.push(node);\n              break;\n            }\n            node = node.parentNode;\n          }\n        });\n        return DomQuery(result);\n      },\n      offset: function (offset) {\n        var elm, doc, docElm;\n        var x = 0, y = 0, pos;\n        if (!offset) {\n          elm = this[0];\n          if (elm) {\n            doc = elm.ownerDocument;\n            docElm = doc.documentElement;\n            if (elm.getBoundingClientRect) {\n              pos = elm.getBoundingClientRect();\n              x = pos.left + (docElm.scrollLeft || doc.body.scrollLeft) - docElm.clientLeft;\n              y = pos.top + (docElm.scrollTop || doc.body.scrollTop) - docElm.clientTop;\n            }\n          }\n          return {\n            left: x,\n            top: y\n          };\n        }\n        return this.css(offset);\n      },\n      push: push$1,\n      sort: Array.prototype.sort,\n      splice: Array.prototype.splice\n    };\n    Tools.extend(DomQueryConstructor, {\n      extend: Tools.extend,\n      makeArray: function (object) {\n        if (isWindow(object) || object.nodeType) {\n          return [object];\n        }\n        return Tools.toArray(object);\n      },\n      inArray: inArray$1,\n      isArray: Tools.isArray,\n      each: each$4,\n      trim: trim$3,\n      grep: grep,\n      find: Sizzle,\n      expr: Sizzle.selectors,\n      unique: Sizzle.uniqueSort,\n      text: Sizzle.getText,\n      contains: Sizzle.contains,\n      filter: function (expr, elems, not) {\n        var i = elems.length;\n        if (not) {\n          expr = ':not(' + expr + ')';\n        }\n        while (i--) {\n          if (elems[i].nodeType !== 1) {\n            elems.splice(i, 1);\n          }\n        }\n        if (elems.length === 1) {\n          elems = DomQuery.find.matchesSelector(elems[0], expr) ? [elems[0]] : [];\n        } else {\n          elems = DomQuery.find.matches(expr, elems);\n        }\n        return elems;\n      }\n    });\n    var dir = function (el, prop, until) {\n      var matched = [];\n      var cur = el[prop];\n      if (typeof until !== 'string' && until instanceof DomQuery) {\n        until = until[0];\n      }\n      while (cur && cur.nodeType !== 9) {\n        if (until !== undefined) {\n          if (cur === until) {\n            break;\n          }\n          if (typeof until === 'string' && DomQuery(cur).is(until)) {\n            break;\n          }\n        }\n        if (cur.nodeType === 1) {\n          matched.push(cur);\n        }\n        cur = cur[prop];\n      }\n      return matched;\n    };\n    var sibling$1 = function (node, siblingName, nodeType, until) {\n      var result = [];\n      if (until instanceof DomQuery) {\n        until = until[0];\n      }\n      for (; node; node = node[siblingName]) {\n        if (nodeType && node.nodeType !== nodeType) {\n          continue;\n        }\n        if (until !== undefined) {\n          if (node === until) {\n            break;\n          }\n          if (typeof until === 'string' && DomQuery(node).is(until)) {\n            break;\n          }\n        }\n        result.push(node);\n      }\n      return result;\n    };\n    var firstSibling = function (node, siblingName, nodeType) {\n      for (node = node[siblingName]; node; node = node[siblingName]) {\n        if (node.nodeType === nodeType) {\n          return node;\n        }\n      }\n      return null;\n    };\n    each$4({\n      parent: function (node) {\n        var parent = node.parentNode;\n        return parent && parent.nodeType !== 11 ? parent : null;\n      },\n      parents: function (node) {\n        return dir(node, 'parentNode');\n      },\n      next: function (node) {\n        return firstSibling(node, 'nextSibling', 1);\n      },\n      prev: function (node) {\n        return firstSibling(node, 'previousSibling', 1);\n      },\n      children: function (node) {\n        return sibling$1(node.firstChild, 'nextSibling', 1);\n      },\n      contents: function (node) {\n        return Tools.toArray((node.nodeName === 'iframe' ? node.contentDocument || node.contentWindow.document : node).childNodes);\n      }\n    }, function (name, fn) {\n      DomQueryConstructor.fn[name] = function (selector) {\n        var self = this;\n        var result = [];\n        self.each(function () {\n          var nodes = fn.call(result, this, selector, result);\n          if (nodes) {\n            if (DomQuery.isArray(nodes)) {\n              result.push.apply(result, nodes);\n            } else {\n              result.push(nodes);\n            }\n          }\n        });\n        if (this.length > 1) {\n          if (!skipUniques[name]) {\n            result = DomQuery.unique(result);\n          }\n          if (name.indexOf('parents') === 0) {\n            result = result.reverse();\n          }\n        }\n        var wrappedResult = DomQuery(result);\n        if (selector) {\n          return wrappedResult.filter(selector);\n        }\n        return wrappedResult;\n      };\n    });\n    each$4({\n      parentsUntil: function (node, until) {\n        return dir(node, 'parentNode', until);\n      },\n      nextUntil: function (node, until) {\n        return sibling$1(node, 'nextSibling', 1, until).slice(1);\n      },\n      prevUntil: function (node, until) {\n        return sibling$1(node, 'previousSibling', 1, until).slice(1);\n      }\n    }, function (name, fn) {\n      DomQueryConstructor.fn[name] = function (selector, filter) {\n        var self = this;\n        var result = [];\n        self.each(function () {\n          var nodes = fn.call(result, this, selector, result);\n          if (nodes) {\n            if (DomQuery.isArray(nodes)) {\n              result.push.apply(result, nodes);\n            } else {\n              result.push(nodes);\n            }\n          }\n        });\n        if (this.length > 1) {\n          result = DomQuery.unique(result);\n          if (name.indexOf('parents') === 0 || name === 'prevUntil') {\n            result = result.reverse();\n          }\n        }\n        var wrappedResult = DomQuery(result);\n        if (filter) {\n          return wrappedResult.filter(filter);\n        }\n        return wrappedResult;\n      };\n    });\n    DomQueryConstructor.fn.is = function (selector) {\n      return !!selector && this.filter(selector).length > 0;\n    };\n    DomQueryConstructor.fn.init.prototype = DomQueryConstructor.fn;\n    DomQueryConstructor.overrideDefaults = function (callback) {\n      var defaults;\n      var sub = function (selector, context) {\n        defaults = defaults || callback();\n        if (arguments.length === 0) {\n          selector = defaults.element;\n        }\n        if (!context) {\n          context = defaults.context;\n        }\n        return new sub.fn.init(selector, context);\n      };\n      DomQuery.extend(sub, this);\n      return sub;\n    };\n    DomQueryConstructor.attrHooks = attrHooks;\n    DomQueryConstructor.cssHooks = cssHooks;\n    var DomQuery = DomQueryConstructor;\n\n    var each$5 = Tools.each;\n    var grep$1 = Tools.grep;\n    var isIE = Env.ie;\n    var simpleSelectorRe = /^([a-z0-9],?)+$/i;\n    var setupAttrHooks = function (styles, settings, getContext) {\n      var keepValues = settings.keep_values;\n      var keepUrlHook = {\n        set: function ($elm, value, name) {\n          if (settings.url_converter) {\n            value = settings.url_converter.call(settings.url_converter_scope || getContext(), value, name, $elm[0]);\n          }\n          $elm.attr('data-mce-' + name, value).attr(name, value);\n        },\n        get: function ($elm, name) {\n          return $elm.attr('data-mce-' + name) || $elm.attr(name);\n        }\n      };\n      var attrHooks = {\n        style: {\n          set: function ($elm, value) {\n            if (value !== null && typeof value === 'object') {\n              $elm.css(value);\n              return;\n            }\n            if (keepValues) {\n              $elm.attr('data-mce-style', value);\n            }\n            if (value !== null && typeof value === 'string') {\n              $elm.removeAttr('style');\n              $elm.css(styles.parse(value));\n            } else {\n              $elm.attr('style', value);\n            }\n          },\n          get: function ($elm) {\n            var value = $elm.attr('data-mce-style') || $elm.attr('style');\n            value = styles.serialize(styles.parse(value), $elm[0].nodeName);\n            return value;\n          }\n        }\n      };\n      if (keepValues) {\n        attrHooks.href = attrHooks.src = keepUrlHook;\n      }\n      return attrHooks;\n    };\n    var updateInternalStyleAttr = function (styles, $elm) {\n      var rawValue = $elm.attr('style');\n      var value = styles.serialize(styles.parse(rawValue), $elm[0].nodeName);\n      if (!value) {\n        value = null;\n      }\n      $elm.attr('data-mce-style', value);\n    };\n    var findNodeIndex = function (node, normalized) {\n      var idx = 0, lastNodeType, nodeType;\n      if (node) {\n        for (lastNodeType = node.nodeType, node = node.previousSibling; node; node = node.previousSibling) {\n          nodeType = node.nodeType;\n          if (normalized && nodeType === 3) {\n            if (nodeType === lastNodeType || !node.nodeValue.length) {\n              continue;\n            }\n          }\n          idx++;\n          lastNodeType = nodeType;\n        }\n      }\n      return idx;\n    };\n    var DOMUtils = function (doc, settings) {\n      if (settings === void 0) {\n        settings = {};\n      }\n      var addedStyles = {};\n      var win = window;\n      var files = {};\n      var counter = 0;\n      var stdMode = true;\n      var boxModel = true;\n      var styleSheetLoader = instance.forElement(SugarElement.fromDom(doc), {\n        contentCssCors: settings.contentCssCors,\n        referrerPolicy: settings.referrerPolicy\n      });\n      var boundEvents = [];\n      var schema = settings.schema ? settings.schema : Schema({});\n      var styles = Styles({\n        url_converter: settings.url_converter,\n        url_converter_scope: settings.url_converter_scope\n      }, settings.schema);\n      var events = settings.ownEvents ? new EventUtils() : EventUtils.Event;\n      var blockElementsMap = schema.getBlockElements();\n      var $ = DomQuery.overrideDefaults(function () {\n        return {\n          context: doc,\n          element: self.getRoot()\n        };\n      });\n      var isBlock = function (node) {\n        if (typeof node === 'string') {\n          return !!blockElementsMap[node];\n        } else if (node) {\n          var type = node.nodeType;\n          if (type) {\n            return !!(type === 1 && blockElementsMap[node.nodeName]);\n          }\n        }\n        return false;\n      };\n      var get = function (elm) {\n        return elm && doc && isString(elm) ? doc.getElementById(elm) : elm;\n      };\n      var $$ = function (elm) {\n        return $(typeof elm === 'string' ? get(elm) : elm);\n      };\n      var getAttrib = function (elm, name, defaultVal) {\n        var hook, value;\n        var $elm = $$(elm);\n        if ($elm.length) {\n          hook = attrHooks[name];\n          if (hook && hook.get) {\n            value = hook.get($elm, name);\n          } else {\n            value = $elm.attr(name);\n          }\n        }\n        if (typeof value === 'undefined') {\n          value = defaultVal || '';\n        }\n        return value;\n      };\n      var getAttribs = function (elm) {\n        var node = get(elm);\n        if (!node) {\n          return [];\n        }\n        return node.attributes;\n      };\n      var setAttrib = function (elm, name, value) {\n        if (value === '') {\n          value = null;\n        }\n        var $elm = $$(elm);\n        var originalValue = $elm.attr(name);\n        if (!$elm.length) {\n          return;\n        }\n        var hook = attrHooks[name];\n        if (hook && hook.set) {\n          hook.set($elm, value, name);\n        } else {\n          $elm.attr(name, value);\n        }\n        if (originalValue !== value && settings.onSetAttrib) {\n          settings.onSetAttrib({\n            attrElm: $elm,\n            attrName: name,\n            attrValue: value\n          });\n        }\n      };\n      var clone = function (node, deep) {\n        if (!isIE || node.nodeType !== 1 || deep) {\n          return node.cloneNode(deep);\n        } else {\n          var clone_1 = doc.createElement(node.nodeName);\n          each$5(getAttribs(node), function (attr) {\n            setAttrib(clone_1, attr.nodeName, getAttrib(node, attr.nodeName));\n          });\n          return clone_1;\n        }\n      };\n      var getRoot = function () {\n        return settings.root_element || doc.body;\n      };\n      var getViewPort = function (argWin) {\n        var vp = getBounds(argWin);\n        return {\n          x: vp.x,\n          y: vp.y,\n          w: vp.width,\n          h: vp.height\n        };\n      };\n      var getPos$1 = function (elm, rootElm) {\n        return getPos(doc.body, get(elm), rootElm);\n      };\n      var setStyle = function (elm, name, value) {\n        var $elm = isString(name) ? $$(elm).css(name, value) : $$(elm).css(name);\n        if (settings.update_styles) {\n          updateInternalStyleAttr(styles, $elm);\n        }\n      };\n      var setStyles = function (elm, stylesArg) {\n        var $elm = $$(elm).css(stylesArg);\n        if (settings.update_styles) {\n          updateInternalStyleAttr(styles, $elm);\n        }\n      };\n      var getStyle = function (elm, name, computed) {\n        var $elm = $$(elm);\n        if (computed) {\n          return $elm.css(name);\n        }\n        name = name.replace(/-(\\D)/g, function (a, b) {\n          return b.toUpperCase();\n        });\n        if (name === 'float') {\n          name = Env.browser.isIE() ? 'styleFloat' : 'cssFloat';\n        }\n        return $elm[0] && $elm[0].style ? $elm[0].style[name] : undefined;\n      };\n      var getSize = function (elm) {\n        var w, h;\n        elm = get(elm);\n        w = getStyle(elm, 'width');\n        h = getStyle(elm, 'height');\n        if (w.indexOf('px') === -1) {\n          w = 0;\n        }\n        if (h.indexOf('px') === -1) {\n          h = 0;\n        }\n        return {\n          w: parseInt(w, 10) || elm.offsetWidth || elm.clientWidth,\n          h: parseInt(h, 10) || elm.offsetHeight || elm.clientHeight\n        };\n      };\n      var getRect = function (elm) {\n        elm = get(elm);\n        var pos = getPos$1(elm);\n        var size = getSize(elm);\n        return {\n          x: pos.x,\n          y: pos.y,\n          w: size.w,\n          h: size.h\n        };\n      };\n      var is = function (elm, selector) {\n        var i;\n        if (!elm) {\n          return false;\n        }\n        if (!Array.isArray(elm)) {\n          if (selector === '*') {\n            return elm.nodeType === 1;\n          }\n          if (simpleSelectorRe.test(selector)) {\n            var selectors = selector.toLowerCase().split(/,/);\n            var elmName = elm.nodeName.toLowerCase();\n            for (i = selectors.length - 1; i >= 0; i--) {\n              if (selectors[i] === elmName) {\n                return true;\n              }\n            }\n            return false;\n          }\n          if (elm.nodeType && elm.nodeType !== 1) {\n            return false;\n          }\n        }\n        var elms = !Array.isArray(elm) ? [elm] : elm;\n        return Sizzle(selector, elms[0].ownerDocument || elms[0], null, elms).length > 0;\n      };\n      var getParents = function (elm, selector, root, collect) {\n        var result = [];\n        var selectorVal;\n        var node = get(elm);\n        collect = collect === undefined;\n        root = root || (getRoot().nodeName !== 'BODY' ? getRoot().parentNode : null);\n        if (Tools.is(selector, 'string')) {\n          selectorVal = selector;\n          if (selector === '*') {\n            selector = function (node) {\n              return node.nodeType === 1;\n            };\n          } else {\n            selector = function (node) {\n              return is(node, selectorVal);\n            };\n          }\n        }\n        while (node) {\n          if (node === root || isNullable(node.nodeType) || isDocument$1(node) || isDocumentFragment$1(node)) {\n            break;\n          }\n          if (!selector || typeof selector === 'function' && selector(node)) {\n            if (collect) {\n              result.push(node);\n            } else {\n              return [node];\n            }\n          }\n          node = node.parentNode;\n        }\n        return collect ? result : null;\n      };\n      var getParent = function (node, selector, root) {\n        var parents = getParents(node, selector, root, false);\n        return parents && parents.length > 0 ? parents[0] : null;\n      };\n      var _findSib = function (node, selector, name) {\n        var func = selector;\n        if (node) {\n          if (typeof selector === 'string') {\n            func = function (node) {\n              return is(node, selector);\n            };\n          }\n          for (node = node[name]; node; node = node[name]) {\n            if (typeof func === 'function' && func(node)) {\n              return node;\n            }\n          }\n        }\n        return null;\n      };\n      var getNext = function (node, selector) {\n        return _findSib(node, selector, 'nextSibling');\n      };\n      var getPrev = function (node, selector) {\n        return _findSib(node, selector, 'previousSibling');\n      };\n      var select = function (selector, scope) {\n        return Sizzle(selector, get(scope) || settings.root_element || doc, []);\n      };\n      var run = function (elm, func, scope) {\n        var result;\n        var node = typeof elm === 'string' ? get(elm) : elm;\n        if (!node) {\n          return false;\n        }\n        if (Tools.isArray(node) && (node.length || node.length === 0)) {\n          result = [];\n          each$5(node, function (elm, i) {\n            if (elm) {\n              result.push(func.call(scope, typeof elm === 'string' ? get(elm) : elm, i));\n            }\n          });\n          return result;\n        }\n        var context = scope ? scope : this;\n        return func.call(context, node);\n      };\n      var setAttribs = function (elm, attrs) {\n        $$(elm).each(function (i, node) {\n          each$5(attrs, function (value, name) {\n            setAttrib(node, name, value);\n          });\n        });\n      };\n      var setHTML = function (elm, html) {\n        var $elm = $$(elm);\n        if (isIE) {\n          $elm.each(function (i, target) {\n            if (target.canHaveHTML === false) {\n              return;\n            }\n            while (target.firstChild) {\n              target.removeChild(target.firstChild);\n            }\n            try {\n              target.innerHTML = '<br>' + html;\n              target.removeChild(target.firstChild);\n            } catch (ex) {\n              DomQuery('<div></div>').html('<br>' + html).contents().slice(1).appendTo(target);\n            }\n            return html;\n          });\n        } else {\n          $elm.html(html);\n        }\n      };\n      var add = function (parentElm, name, attrs, html, create) {\n        return run(parentElm, function (parentElm) {\n          var newElm = typeof name === 'string' ? doc.createElement(name) : name;\n          setAttribs(newElm, attrs);\n          if (html) {\n            if (typeof html !== 'string' && html.nodeType) {\n              newElm.appendChild(html);\n            } else if (typeof html === 'string') {\n              setHTML(newElm, html);\n            }\n          }\n          return !create ? parentElm.appendChild(newElm) : newElm;\n        });\n      };\n      var create = function (name, attrs, html) {\n        return add(doc.createElement(name), name, attrs, html, true);\n      };\n      var decode = Entities.decode;\n      var encode = Entities.encodeAllRaw;\n      var createHTML = function (name, attrs, html) {\n        var outHtml = '', key;\n        outHtml += '<' + name;\n        for (key in attrs) {\n          if (attrs.hasOwnProperty(key) && attrs[key] !== null && typeof attrs[key] !== 'undefined') {\n            outHtml += ' ' + key + '=\"' + encode(attrs[key]) + '\"';\n          }\n        }\n        if (typeof html !== 'undefined') {\n          return outHtml + '>' + html + '</' + name + '>';\n        }\n        return outHtml + ' />';\n      };\n      var createFragment = function (html) {\n        var node;\n        var container = doc.createElement('div');\n        var frag = doc.createDocumentFragment();\n        frag.appendChild(container);\n        if (html) {\n          container.innerHTML = html;\n        }\n        while (node = container.firstChild) {\n          frag.appendChild(node);\n        }\n        frag.removeChild(container);\n        return frag;\n      };\n      var remove = function (node, keepChildren) {\n        var $node = $$(node);\n        if (keepChildren) {\n          $node.each(function () {\n            var child;\n            while (child = this.firstChild) {\n              if (child.nodeType === 3 && child.data.length === 0) {\n                this.removeChild(child);\n              } else {\n                this.parentNode.insertBefore(child, this);\n              }\n            }\n          }).remove();\n        } else {\n          $node.remove();\n        }\n        return $node.length > 1 ? $node.toArray() : $node[0];\n      };\n      var removeAllAttribs = function (e) {\n        return run(e, function (e) {\n          var i;\n          var attrs = e.attributes;\n          for (i = attrs.length - 1; i >= 0; i--) {\n            e.removeAttributeNode(attrs.item(i));\n          }\n        });\n      };\n      var parseStyle = function (cssText) {\n        return styles.parse(cssText);\n      };\n      var serializeStyle = function (stylesArg, name) {\n        return styles.serialize(stylesArg, name);\n      };\n      var addStyle = function (cssText) {\n        var head, styleElm;\n        if (self !== DOMUtils.DOM && doc === document) {\n          if (addedStyles[cssText]) {\n            return;\n          }\n          addedStyles[cssText] = true;\n        }\n        styleElm = doc.getElementById('mceDefaultStyles');\n        if (!styleElm) {\n          styleElm = doc.createElement('style');\n          styleElm.id = 'mceDefaultStyles';\n          styleElm.type = 'text/css';\n          head = doc.getElementsByTagName('head')[0];\n          if (head.firstChild) {\n            head.insertBefore(styleElm, head.firstChild);\n          } else {\n            head.appendChild(styleElm);\n          }\n        }\n        if (styleElm.styleSheet) {\n          styleElm.styleSheet.cssText += cssText;\n        } else {\n          styleElm.appendChild(doc.createTextNode(cssText));\n        }\n      };\n      var loadCSS = function (urls) {\n        if (!urls) {\n          urls = '';\n        }\n        each(urls.split(','), function (url) {\n          files[url] = true;\n          styleSheetLoader.load(url, noop);\n        });\n      };\n      var toggleClass = function (elm, cls, state) {\n        $$(elm).toggleClass(cls, state).each(function () {\n          if (this.className === '') {\n            DomQuery(this).attr('class', null);\n          }\n        });\n      };\n      var addClass = function (elm, cls) {\n        $$(elm).addClass(cls);\n      };\n      var removeClass = function (elm, cls) {\n        toggleClass(elm, cls, false);\n      };\n      var hasClass = function (elm, cls) {\n        return $$(elm).hasClass(cls);\n      };\n      var show = function (elm) {\n        $$(elm).show();\n      };\n      var hide = function (elm) {\n        $$(elm).hide();\n      };\n      var isHidden = function (elm) {\n        return $$(elm).css('display') === 'none';\n      };\n      var uniqueId = function (prefix) {\n        return (!prefix ? 'mce_' : prefix) + counter++;\n      };\n      var getOuterHTML = function (elm) {\n        var node = typeof elm === 'string' ? get(elm) : elm;\n        return isElement$1(node) ? node.outerHTML : DomQuery('<div></div>').append(DomQuery(node).clone()).html();\n      };\n      var setOuterHTML = function (elm, html) {\n        $$(elm).each(function () {\n          try {\n            if ('outerHTML' in this) {\n              this.outerHTML = html;\n              return;\n            }\n          } catch (ex) {\n          }\n          remove(DomQuery(this).html(html), true);\n        });\n      };\n      var insertAfter = function (node, reference) {\n        var referenceNode = get(reference);\n        return run(node, function (node) {\n          var parent = referenceNode.parentNode;\n          var nextSibling = referenceNode.nextSibling;\n          if (nextSibling) {\n            parent.insertBefore(node, nextSibling);\n          } else {\n            parent.appendChild(node);\n          }\n          return node;\n        });\n      };\n      var replace = function (newElm, oldElm, keepChildren) {\n        return run(oldElm, function (oldElm) {\n          if (Tools.is(oldElm, 'array')) {\n            newElm = newElm.cloneNode(true);\n          }\n          if (keepChildren) {\n            each$5(grep$1(oldElm.childNodes), function (node) {\n              newElm.appendChild(node);\n            });\n          }\n          return oldElm.parentNode.replaceChild(newElm, oldElm);\n        });\n      };\n      var rename = function (elm, name) {\n        var newElm;\n        if (elm.nodeName !== name.toUpperCase()) {\n          newElm = create(name);\n          each$5(getAttribs(elm), function (attrNode) {\n            setAttrib(newElm, attrNode.nodeName, getAttrib(elm, attrNode.nodeName));\n          });\n          replace(newElm, elm, true);\n        }\n        return newElm || elm;\n      };\n      var findCommonAncestor = function (a, b) {\n        var ps = a, pe;\n        while (ps) {\n          pe = b;\n          while (pe && ps !== pe) {\n            pe = pe.parentNode;\n          }\n          if (ps === pe) {\n            break;\n          }\n          ps = ps.parentNode;\n        }\n        if (!ps && a.ownerDocument) {\n          return a.ownerDocument.documentElement;\n        }\n        return ps;\n      };\n      var toHex = function (rgbVal) {\n        return styles.toHex(Tools.trim(rgbVal));\n      };\n      var isNonEmptyElement = function (node) {\n        if (isElement$1(node)) {\n          var isNamedAnchor = node.nodeName.toLowerCase() === 'a' && !getAttrib(node, 'href') && getAttrib(node, 'id');\n          if (getAttrib(node, 'name') || getAttrib(node, 'data-mce-bookmark') || isNamedAnchor) {\n            return true;\n          }\n        }\n        return false;\n      };\n      var isEmpty = function (node, elements) {\n        var type, name, brCount = 0;\n        if (isNonEmptyElement(node)) {\n          return false;\n        }\n        node = node.firstChild;\n        if (node) {\n          var walker = new DomTreeWalker(node, node.parentNode);\n          var whitespace = schema ? schema.getWhiteSpaceElements() : {};\n          elements = elements || (schema ? schema.getNonEmptyElements() : null);\n          do {\n            type = node.nodeType;\n            if (isElement$1(node)) {\n              var bogusVal = node.getAttribute('data-mce-bogus');\n              if (bogusVal) {\n                node = walker.next(bogusVal === 'all');\n                continue;\n              }\n              name = node.nodeName.toLowerCase();\n              if (elements && elements[name]) {\n                if (name === 'br') {\n                  brCount++;\n                  node = walker.next();\n                  continue;\n                }\n                return false;\n              }\n              if (isNonEmptyElement(node)) {\n                return false;\n              }\n            }\n            if (type === 8) {\n              return false;\n            }\n            if (type === 3 && !isWhitespaceText(node.nodeValue)) {\n              return false;\n            }\n            if (type === 3 && node.parentNode && whitespace[node.parentNode.nodeName] && isWhitespaceText(node.nodeValue)) {\n              return false;\n            }\n            node = walker.next();\n          } while (node);\n        }\n        return brCount <= 1;\n      };\n      var createRng = function () {\n        return doc.createRange();\n      };\n      var split = function (parentElm, splitElm, replacementElm) {\n        var range = createRng();\n        var beforeFragment;\n        var afterFragment;\n        var parentNode;\n        if (parentElm && splitElm) {\n          range.setStart(parentElm.parentNode, findNodeIndex(parentElm));\n          range.setEnd(splitElm.parentNode, findNodeIndex(splitElm));\n          beforeFragment = range.extractContents();\n          range = createRng();\n          range.setStart(splitElm.parentNode, findNodeIndex(splitElm) + 1);\n          range.setEnd(parentElm.parentNode, findNodeIndex(parentElm) + 1);\n          afterFragment = range.extractContents();\n          parentNode = parentElm.parentNode;\n          parentNode.insertBefore(trimNode(self, beforeFragment), parentElm);\n          if (replacementElm) {\n            parentNode.insertBefore(replacementElm, parentElm);\n          } else {\n            parentNode.insertBefore(splitElm, parentElm);\n          }\n          parentNode.insertBefore(trimNode(self, afterFragment), parentElm);\n          remove(parentElm);\n          return replacementElm || splitElm;\n        }\n      };\n      var bind = function (target, name, func, scope) {\n        if (Tools.isArray(target)) {\n          var i = target.length;\n          var rv = [];\n          while (i--) {\n            rv[i] = bind(target[i], name, func, scope);\n          }\n          return rv;\n        }\n        if (settings.collect && (target === doc || target === win)) {\n          boundEvents.push([\n            target,\n            name,\n            func,\n            scope\n          ]);\n        }\n        var output = events.bind(target, name, func, scope || self);\n        return output;\n      };\n      var unbind = function (target, name, func) {\n        if (Tools.isArray(target)) {\n          var i = target.length;\n          var rv = [];\n          while (i--) {\n            rv[i] = unbind(target[i], name, func);\n          }\n          return rv;\n        } else {\n          if (boundEvents.length > 0 && (target === doc || target === win)) {\n            var i = boundEvents.length;\n            while (i--) {\n              var item = boundEvents[i];\n              if (target === item[0] && (!name || name === item[1]) && (!func || func === item[2])) {\n                events.unbind(item[0], item[1], item[2]);\n              }\n            }\n          }\n          return events.unbind(target, name, func);\n        }\n      };\n      var fire = function (target, name, evt) {\n        return events.fire(target, name, evt);\n      };\n      var getContentEditable = function (node) {\n        if (node && isElement$1(node)) {\n          var contentEditable = node.getAttribute('data-mce-contenteditable');\n          if (contentEditable && contentEditable !== 'inherit') {\n            return contentEditable;\n          }\n          return node.contentEditable !== 'inherit' ? node.contentEditable : null;\n        } else {\n          return null;\n        }\n      };\n      var getContentEditableParent = function (node) {\n        var root = getRoot();\n        var state = null;\n        for (; node && node !== root; node = node.parentNode) {\n          state = getContentEditable(node);\n          if (state !== null) {\n            break;\n          }\n        }\n        return state;\n      };\n      var destroy = function () {\n        if (boundEvents.length > 0) {\n          var i = boundEvents.length;\n          while (i--) {\n            var item = boundEvents[i];\n            events.unbind(item[0], item[1], item[2]);\n          }\n        }\n        each$1(files, function (_, url) {\n          styleSheetLoader.unload(url);\n          delete files[url];\n        });\n        if (Sizzle.setDocument) {\n          Sizzle.setDocument();\n        }\n      };\n      var isChildOf = function (node, parent) {\n        while (node) {\n          if (parent === node) {\n            return true;\n          }\n          node = node.parentNode;\n        }\n        return false;\n      };\n      var dumpRng = function (r) {\n        return 'startContainer: ' + r.startContainer.nodeName + ', startOffset: ' + r.startOffset + ', endContainer: ' + r.endContainer.nodeName + ', endOffset: ' + r.endOffset;\n      };\n      var self = {\n        doc: doc,\n        settings: settings,\n        win: win,\n        files: files,\n        stdMode: stdMode,\n        boxModel: boxModel,\n        styleSheetLoader: styleSheetLoader,\n        boundEvents: boundEvents,\n        styles: styles,\n        schema: schema,\n        events: events,\n        isBlock: isBlock,\n        $: $,\n        $$: $$,\n        root: null,\n        clone: clone,\n        getRoot: getRoot,\n        getViewPort: getViewPort,\n        getRect: getRect,\n        getSize: getSize,\n        getParent: getParent,\n        getParents: getParents,\n        get: get,\n        getNext: getNext,\n        getPrev: getPrev,\n        select: select,\n        is: is,\n        add: add,\n        create: create,\n        createHTML: createHTML,\n        createFragment: createFragment,\n        remove: remove,\n        setStyle: setStyle,\n        getStyle: getStyle,\n        setStyles: setStyles,\n        removeAllAttribs: removeAllAttribs,\n        setAttrib: setAttrib,\n        setAttribs: setAttribs,\n        getAttrib: getAttrib,\n        getPos: getPos$1,\n        parseStyle: parseStyle,\n        serializeStyle: serializeStyle,\n        addStyle: addStyle,\n        loadCSS: loadCSS,\n        addClass: addClass,\n        removeClass: removeClass,\n        hasClass: hasClass,\n        toggleClass: toggleClass,\n        show: show,\n        hide: hide,\n        isHidden: isHidden,\n        uniqueId: uniqueId,\n        setHTML: setHTML,\n        getOuterHTML: getOuterHTML,\n        setOuterHTML: setOuterHTML,\n        decode: decode,\n        encode: encode,\n        insertAfter: insertAfter,\n        replace: replace,\n        rename: rename,\n        findCommonAncestor: findCommonAncestor,\n        toHex: toHex,\n        run: run,\n        getAttribs: getAttribs,\n        isEmpty: isEmpty,\n        createRng: createRng,\n        nodeIndex: findNodeIndex,\n        split: split,\n        bind: bind,\n        unbind: unbind,\n        fire: fire,\n        getContentEditable: getContentEditable,\n        getContentEditableParent: getContentEditableParent,\n        destroy: destroy,\n        isChildOf: isChildOf,\n        dumpRng: dumpRng\n      };\n      var attrHooks = setupAttrHooks(styles, settings, function () {\n        return self;\n      });\n      return self;\n    };\n    DOMUtils.DOM = DOMUtils(document);\n    DOMUtils.nodeIndex = findNodeIndex;\n\n    var DOM = DOMUtils.DOM;\n    var each$6 = Tools.each, grep$2 = Tools.grep;\n    var QUEUED = 0;\n    var LOADING = 1;\n    var LOADED = 2;\n    var FAILED = 3;\n    var ScriptLoader = function () {\n      function ScriptLoader(settings) {\n        if (settings === void 0) {\n          settings = {};\n        }\n        this.states = {};\n        this.queue = [];\n        this.scriptLoadedCallbacks = {};\n        this.queueLoadedCallbacks = [];\n        this.loading = 0;\n        this.settings = settings;\n      }\n      ScriptLoader.prototype._setReferrerPolicy = function (referrerPolicy) {\n        this.settings.referrerPolicy = referrerPolicy;\n      };\n      ScriptLoader.prototype.loadScript = function (url, success, failure) {\n        var dom = DOM;\n        var elm;\n        var cleanup = function () {\n          dom.remove(id);\n          if (elm) {\n            elm.onerror = elm.onload = elm = null;\n          }\n        };\n        var done = function () {\n          cleanup();\n          success();\n        };\n        var error = function () {\n          cleanup();\n          if (isFunction(failure)) {\n            failure();\n          } else {\n            if (typeof console !== 'undefined' && console.log) {\n              console.log('Failed to load script: ' + url);\n            }\n          }\n        };\n        var id = dom.uniqueId();\n        elm = document.createElement('script');\n        elm.id = id;\n        elm.type = 'text/javascript';\n        elm.src = Tools._addCacheSuffix(url);\n        if (this.settings.referrerPolicy) {\n          dom.setAttrib(elm, 'referrerpolicy', this.settings.referrerPolicy);\n        }\n        elm.onload = done;\n        elm.onerror = error;\n        (document.getElementsByTagName('head')[0] || document.body).appendChild(elm);\n      };\n      ScriptLoader.prototype.isDone = function (url) {\n        return this.states[url] === LOADED;\n      };\n      ScriptLoader.prototype.markDone = function (url) {\n        this.states[url] = LOADED;\n      };\n      ScriptLoader.prototype.add = function (url, success, scope, failure) {\n        var state = this.states[url];\n        this.queue.push(url);\n        if (state === undefined) {\n          this.states[url] = QUEUED;\n        }\n        if (success) {\n          if (!this.scriptLoadedCallbacks[url]) {\n            this.scriptLoadedCallbacks[url] = [];\n          }\n          this.scriptLoadedCallbacks[url].push({\n            success: success,\n            failure: failure,\n            scope: scope || this\n          });\n        }\n      };\n      ScriptLoader.prototype.load = function (url, success, scope, failure) {\n        return this.add(url, success, scope, failure);\n      };\n      ScriptLoader.prototype.remove = function (url) {\n        delete this.states[url];\n        delete this.scriptLoadedCallbacks[url];\n      };\n      ScriptLoader.prototype.loadQueue = function (success, scope, failure) {\n        this.loadScripts(this.queue, success, scope, failure);\n      };\n      ScriptLoader.prototype.loadScripts = function (scripts, success, scope, failure) {\n        var self = this;\n        var failures = [];\n        var execCallbacks = function (name, url) {\n          each$6(self.scriptLoadedCallbacks[url], function (callback) {\n            if (isFunction(callback[name])) {\n              callback[name].call(callback.scope);\n            }\n          });\n          self.scriptLoadedCallbacks[url] = undefined;\n        };\n        self.queueLoadedCallbacks.push({\n          success: success,\n          failure: failure,\n          scope: scope || this\n        });\n        var loadScripts = function () {\n          var loadingScripts = grep$2(scripts);\n          scripts.length = 0;\n          each$6(loadingScripts, function (url) {\n            if (self.states[url] === LOADED) {\n              execCallbacks('success', url);\n              return;\n            }\n            if (self.states[url] === FAILED) {\n              execCallbacks('failure', url);\n              return;\n            }\n            if (self.states[url] !== LOADING) {\n              self.states[url] = LOADING;\n              self.loading++;\n              self.loadScript(url, function () {\n                self.states[url] = LOADED;\n                self.loading--;\n                execCallbacks('success', url);\n                loadScripts();\n              }, function () {\n                self.states[url] = FAILED;\n                self.loading--;\n                failures.push(url);\n                execCallbacks('failure', url);\n                loadScripts();\n              });\n            }\n          });\n          if (!self.loading) {\n            var notifyCallbacks = self.queueLoadedCallbacks.slice(0);\n            self.queueLoadedCallbacks.length = 0;\n            each$6(notifyCallbacks, function (callback) {\n              if (failures.length === 0) {\n                if (isFunction(callback.success)) {\n                  callback.success.call(callback.scope);\n                }\n              } else {\n                if (isFunction(callback.failure)) {\n                  callback.failure.call(callback.scope, failures);\n                }\n              }\n            });\n          }\n        };\n        loadScripts();\n      };\n      ScriptLoader.ScriptLoader = new ScriptLoader();\n      return ScriptLoader;\n    }();\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n\n    var isRaw = function (str) {\n      return isObject(str) && has(str, 'raw');\n    };\n    var isTokenised = function (str) {\n      return isArray(str) && str.length > 1;\n    };\n    var data = {};\n    var currentCode = Cell('en');\n    var getLanguageData = function () {\n      return get$1(data, currentCode.get());\n    };\n    var getData = function () {\n      return map$1(data, function (value) {\n        return __assign({}, value);\n      });\n    };\n    var setCode = function (newCode) {\n      if (newCode) {\n        currentCode.set(newCode);\n      }\n    };\n    var getCode = function () {\n      return currentCode.get();\n    };\n    var add = function (code, items) {\n      var langData = data[code];\n      if (!langData) {\n        data[code] = langData = {};\n      }\n      each$1(items, function (translation, name) {\n        langData[name.toLowerCase()] = translation;\n      });\n    };\n    var translate = function (text) {\n      var langData = getLanguageData().getOr({});\n      var toString = function (obj) {\n        if (isFunction(obj)) {\n          return Object.prototype.toString.call(obj);\n        }\n        return !isEmpty(obj) ? '' + obj : '';\n      };\n      var isEmpty = function (text) {\n        return text === '' || text === null || text === undefined;\n      };\n      var getLangData = function (text) {\n        var textstr = toString(text);\n        return get$1(langData, textstr.toLowerCase()).map(toString).getOr(textstr);\n      };\n      var removeContext = function (str) {\n        return str.replace(/{context:\\w+}$/, '');\n      };\n      if (isEmpty(text)) {\n        return '';\n      }\n      if (isRaw(text)) {\n        return toString(text.raw);\n      }\n      if (isTokenised(text)) {\n        var values_1 = text.slice(1);\n        var substitued = getLangData(text[0]).replace(/\\{([0-9]+)\\}/g, function ($1, $2) {\n          return has(values_1, $2) ? toString(values_1[$2]) : $1;\n        });\n        return removeContext(substitued);\n      }\n      return removeContext(getLangData(text));\n    };\n    var isRtl = function () {\n      return getLanguageData().bind(function (items) {\n        return get$1(items, '_dir');\n      }).exists(function (dir) {\n        return dir === 'rtl';\n      });\n    };\n    var hasCode = function (code) {\n      return has(data, code);\n    };\n    var I18n = {\n      getData: getData,\n      setCode: setCode,\n      getCode: getCode,\n      add: add,\n      translate: translate,\n      isRtl: isRtl,\n      hasCode: hasCode\n    };\n\n    var AddOnManager = function () {\n      var items = [];\n      var urls = {};\n      var lookup = {};\n      var _listeners = [];\n      var runListeners = function (name, state) {\n        var matchedListeners = filter(_listeners, function (listener) {\n          return listener.name === name && listener.state === state;\n        });\n        each(matchedListeners, function (listener) {\n          return listener.callback();\n        });\n      };\n      var get = function (name) {\n        if (lookup[name]) {\n          return lookup[name].instance;\n        }\n        return undefined;\n      };\n      var dependencies = function (name) {\n        var result;\n        if (lookup[name]) {\n          result = lookup[name].dependencies;\n        }\n        return result || [];\n      };\n      var requireLangPack = function (name, languages) {\n        if (AddOnManager.languageLoad !== false) {\n          waitFor(name, function () {\n            var language = I18n.getCode();\n            var wrappedLanguages = ',' + (languages || '') + ',';\n            if (!language || languages && wrappedLanguages.indexOf(',' + language + ',') === -1) {\n              return;\n            }\n            ScriptLoader.ScriptLoader.add(urls[name] + '/langs/' + language + '.js');\n          }, 'loaded');\n        }\n      };\n      var add = function (id, addOn, dependencies) {\n        var addOnConstructor = addOn;\n        items.push(addOnConstructor);\n        lookup[id] = {\n          instance: addOnConstructor,\n          dependencies: dependencies\n        };\n        runListeners(id, 'added');\n        return addOnConstructor;\n      };\n      var remove = function (name) {\n        delete urls[name];\n        delete lookup[name];\n      };\n      var createUrl = function (baseUrl, dep) {\n        if (typeof dep === 'object') {\n          return dep;\n        }\n        return typeof baseUrl === 'string' ? {\n          prefix: '',\n          resource: dep,\n          suffix: ''\n        } : {\n          prefix: baseUrl.prefix,\n          resource: dep,\n          suffix: baseUrl.suffix\n        };\n      };\n      var addComponents = function (pluginName, scripts) {\n        var pluginUrl = urls[pluginName];\n        each(scripts, function (script) {\n          ScriptLoader.ScriptLoader.add(pluginUrl + '/' + script);\n        });\n      };\n      var loadDependencies = function (name, addOnUrl, success, scope) {\n        var deps = dependencies(name);\n        each(deps, function (dep) {\n          var newUrl = createUrl(addOnUrl, dep);\n          load(newUrl.resource, newUrl, undefined, undefined);\n        });\n        if (success) {\n          if (scope) {\n            success.call(scope);\n          } else {\n            success.call(ScriptLoader);\n          }\n        }\n      };\n      var load = function (name, addOnUrl, success, scope, failure) {\n        if (urls[name]) {\n          return;\n        }\n        var urlString = typeof addOnUrl === 'string' ? addOnUrl : addOnUrl.prefix + addOnUrl.resource + addOnUrl.suffix;\n        if (urlString.indexOf('/') !== 0 && urlString.indexOf('://') === -1) {\n          urlString = AddOnManager.baseURL + '/' + urlString;\n        }\n        urls[name] = urlString.substring(0, urlString.lastIndexOf('/'));\n        var done = function () {\n          runListeners(name, 'loaded');\n          loadDependencies(name, addOnUrl, success, scope);\n        };\n        if (lookup[name]) {\n          done();\n        } else {\n          ScriptLoader.ScriptLoader.add(urlString, done, scope, failure);\n        }\n      };\n      var waitFor = function (name, callback, state) {\n        if (state === void 0) {\n          state = 'added';\n        }\n        if (has(lookup, name) && state === 'added') {\n          callback();\n        } else if (has(urls, name) && state === 'loaded') {\n          callback();\n        } else {\n          _listeners.push({\n            name: name,\n            state: state,\n            callback: callback\n          });\n        }\n      };\n      return {\n        items: items,\n        urls: urls,\n        lookup: lookup,\n        _listeners: _listeners,\n        get: get,\n        dependencies: dependencies,\n        requireLangPack: requireLangPack,\n        add: add,\n        remove: remove,\n        createUrl: createUrl,\n        addComponents: addComponents,\n        load: load,\n        waitFor: waitFor\n      };\n    };\n    AddOnManager.languageLoad = true;\n    AddOnManager.baseURL = '';\n    AddOnManager.PluginManager = AddOnManager();\n    AddOnManager.ThemeManager = AddOnManager();\n\n    var first = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (timer !== null) {\n          clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (timer === null) {\n          timer = setTimeout(function () {\n            fn.apply(null, args);\n            timer = null;\n          }, rate);\n        }\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n    var last$2 = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (timer !== null) {\n          clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (timer !== null) {\n          clearTimeout(timer);\n        }\n        timer = setTimeout(function () {\n          fn.apply(null, args);\n          timer = null;\n        }, rate);\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n\n    var read = function (element, attr) {\n      var value = get$4(element, attr);\n      return value === undefined || value === '' ? [] : value.split(' ');\n    };\n    var add$1 = function (element, attr, id) {\n      var old = read(element, attr);\n      var nu = old.concat([id]);\n      set(element, attr, nu.join(' '));\n      return true;\n    };\n    var remove$2 = function (element, attr, id) {\n      var nu = filter(read(element, attr), function (v) {\n        return v !== id;\n      });\n      if (nu.length > 0) {\n        set(element, attr, nu.join(' '));\n      } else {\n        remove$1(element, attr);\n      }\n      return false;\n    };\n\n    var supports = function (element) {\n      return element.dom.classList !== undefined;\n    };\n    var get$6 = function (element) {\n      return read(element, 'class');\n    };\n    var add$2 = function (element, clazz) {\n      return add$1(element, 'class', clazz);\n    };\n    var remove$3 = function (element, clazz) {\n      return remove$2(element, 'class', clazz);\n    };\n\n    var add$3 = function (element, clazz) {\n      if (supports(element)) {\n        element.dom.classList.add(clazz);\n      } else {\n        add$2(element, clazz);\n      }\n    };\n    var cleanClass = function (element) {\n      var classList = supports(element) ? element.dom.classList : get$6(element);\n      if (classList.length === 0) {\n        remove$1(element, 'class');\n      }\n    };\n    var remove$4 = function (element, clazz) {\n      if (supports(element)) {\n        var classList = element.dom.classList;\n        classList.remove(clazz);\n      } else {\n        remove$3(element, clazz);\n      }\n      cleanClass(element);\n    };\n    var has$2 = function (element, clazz) {\n      return supports(element) && element.dom.classList.contains(clazz);\n    };\n\n    var descendants = function (scope, predicate) {\n      var result = [];\n      each(children(scope), function (x) {\n        if (predicate(x)) {\n          result = result.concat([x]);\n        }\n        result = result.concat(descendants(x, predicate));\n      });\n      return result;\n    };\n\n    var descendants$1 = function (scope, selector) {\n      return all(selector, scope);\n    };\n\n    var annotation = constant('mce-annotation');\n    var dataAnnotation = constant('data-mce-annotation');\n    var dataAnnotationId = constant('data-mce-annotation-uid');\n\n    var identify = function (editor, annotationName) {\n      var rng = editor.selection.getRng();\n      var start = SugarElement.fromDom(rng.startContainer);\n      var root = SugarElement.fromDom(editor.getBody());\n      var selector = annotationName.fold(function () {\n        return '.' + annotation();\n      }, function (an) {\n        return '[' + dataAnnotation() + '=\"' + an + '\"]';\n      });\n      var newStart = child(start, rng.startOffset).getOr(start);\n      var closest = closest$1(newStart, selector, function (n) {\n        return eq$2(n, root);\n      });\n      var getAttr = function (c, property) {\n        if (has$1(c, property)) {\n          return Optional.some(get$4(c, property));\n        } else {\n          return Optional.none();\n        }\n      };\n      return closest.bind(function (c) {\n        return getAttr(c, '' + dataAnnotationId()).bind(function (uid) {\n          return getAttr(c, '' + dataAnnotation()).map(function (name) {\n            var elements = findMarkers(editor, uid);\n            return {\n              uid: uid,\n              name: name,\n              elements: elements\n            };\n          });\n        });\n      });\n    };\n    var isAnnotation = function (elem) {\n      return isElement(elem) && has$2(elem, annotation());\n    };\n    var findMarkers = function (editor, uid) {\n      var body = SugarElement.fromDom(editor.getBody());\n      return descendants$1(body, '[' + dataAnnotationId() + '=\"' + uid + '\"]');\n    };\n    var findAll = function (editor, name) {\n      var body = SugarElement.fromDom(editor.getBody());\n      var markers = descendants$1(body, '[' + dataAnnotation() + '=\"' + name + '\"]');\n      var directory = {};\n      each(markers, function (m) {\n        var uid = get$4(m, dataAnnotationId());\n        var nodesAlready = directory.hasOwnProperty(uid) ? directory[uid] : [];\n        directory[uid] = nodesAlready.concat([m]);\n      });\n      return directory;\n    };\n\n    var setup = function (editor, _registry) {\n      var changeCallbacks = Cell({});\n      var initData = function () {\n        return {\n          listeners: [],\n          previous: Cell(Optional.none())\n        };\n      };\n      var withCallbacks = function (name, f) {\n        updateCallbacks(name, function (data) {\n          f(data);\n          return data;\n        });\n      };\n      var updateCallbacks = function (name, f) {\n        var callbackMap = changeCallbacks.get();\n        var data = callbackMap.hasOwnProperty(name) ? callbackMap[name] : initData();\n        var outputData = f(data);\n        callbackMap[name] = outputData;\n        changeCallbacks.set(callbackMap);\n      };\n      var fireCallbacks = function (name, uid, elements) {\n        withCallbacks(name, function (data) {\n          each(data.listeners, function (f) {\n            return f(true, name, {\n              uid: uid,\n              nodes: map(elements, function (elem) {\n                return elem.dom;\n              })\n            });\n          });\n        });\n      };\n      var fireNoAnnotation = function (name) {\n        withCallbacks(name, function (data) {\n          each(data.listeners, function (f) {\n            return f(false, name);\n          });\n        });\n      };\n      var onNodeChange = last$2(function () {\n        var callbackMap = changeCallbacks.get();\n        var annotations = sort$1(keys(callbackMap));\n        each(annotations, function (name) {\n          updateCallbacks(name, function (data) {\n            var prev = data.previous.get();\n            identify(editor, Optional.some(name)).fold(function () {\n              if (prev.isSome()) {\n                fireNoAnnotation(name);\n                data.previous.set(Optional.none());\n              }\n            }, function (_a) {\n              var uid = _a.uid, name = _a.name, elements = _a.elements;\n              if (!prev.is(uid)) {\n                fireCallbacks(name, uid, elements);\n                data.previous.set(Optional.some(uid));\n              }\n            });\n            return {\n              previous: data.previous,\n              listeners: data.listeners\n            };\n          });\n        });\n      }, 30);\n      editor.on('remove', function () {\n        onNodeChange.cancel();\n      });\n      editor.on('NodeChange', function () {\n        onNodeChange.throttle();\n      });\n      var addListener = function (name, f) {\n        updateCallbacks(name, function (data) {\n          return {\n            previous: data.previous,\n            listeners: data.listeners.concat([f])\n          };\n        });\n      };\n      return { addListener: addListener };\n    };\n\n    var setup$1 = function (editor, registry) {\n      var identifyParserNode = function (span) {\n        return Optional.from(span.attr(dataAnnotation())).bind(registry.lookup);\n      };\n      editor.on('init', function () {\n        editor.serializer.addNodeFilter('span', function (spans) {\n          each(spans, function (span) {\n            identifyParserNode(span).each(function (settings) {\n              if (settings.persistent === false) {\n                span.unwrap();\n              }\n            });\n          });\n        });\n      });\n    };\n\n    var create$2 = function () {\n      var annotations = {};\n      var register = function (name, settings) {\n        annotations[name] = {\n          name: name,\n          settings: settings\n        };\n      };\n      var lookup = function (name) {\n        return annotations.hasOwnProperty(name) ? Optional.from(annotations[name]).map(function (a) {\n          return a.settings;\n        }) : Optional.none();\n      };\n      return {\n        register: register,\n        lookup: lookup\n      };\n    };\n\n    var unique = 0;\n    var generate$1 = function (prefix) {\n      var date = new Date();\n      var time = date.getTime();\n      var random = Math.floor(Math.random() * 1000000000);\n      unique++;\n      return prefix + '_' + random + unique + String(time);\n    };\n\n    var add$4 = function (element, classes) {\n      each(classes, function (x) {\n        add$3(element, x);\n      });\n    };\n\n    var fromHtml$1 = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      return children(SugarElement.fromDom(div));\n    };\n\n    var get$7 = function (element) {\n      return element.dom.innerHTML;\n    };\n    var set$1 = function (element, content) {\n      var owner$1 = owner(element);\n      var docDom = owner$1.dom;\n      var fragment = SugarElement.fromDom(docDom.createDocumentFragment());\n      var contentElements = fromHtml$1(content, docDom);\n      append$1(fragment, contentElements);\n      empty(element);\n      append(element, fragment);\n    };\n\n    var clone$1 = function (original, isDeep) {\n      return SugarElement.fromDom(original.dom.cloneNode(isDeep));\n    };\n    var shallow = function (original) {\n      return clone$1(original, false);\n    };\n    var deep = function (original) {\n      return clone$1(original, true);\n    };\n\n    var TextWalker = function (startNode, rootNode, isBoundary) {\n      if (isBoundary === void 0) {\n        isBoundary = never;\n      }\n      var walker = new DomTreeWalker(startNode, rootNode);\n      var walk = function (direction) {\n        var next;\n        do {\n          next = walker[direction]();\n        } while (next && !isText$1(next) && !isBoundary(next));\n        return Optional.from(next).filter(isText$1);\n      };\n      return {\n        current: function () {\n          return Optional.from(walker.current()).filter(isText$1);\n        },\n        next: function () {\n          return walk('next');\n        },\n        prev: function () {\n          return walk('prev');\n        },\n        prev2: function () {\n          return walk('prev2');\n        }\n      };\n    };\n\n    var TextSeeker = function (dom, isBoundary) {\n      var isBlockBoundary = isBoundary ? isBoundary : function (node) {\n        return dom.isBlock(node) || isBr(node) || isContentEditableFalse(node);\n      };\n      var walk = function (node, offset, walker, process) {\n        if (isText$1(node)) {\n          var newOffset = process(node, offset, node.data);\n          if (newOffset !== -1) {\n            return Optional.some({\n              container: node,\n              offset: newOffset\n            });\n          }\n        }\n        return walker().bind(function (next) {\n          return walk(next.container, next.offset, walker, process);\n        });\n      };\n      var backwards = function (node, offset, process, root) {\n        var walker = TextWalker(node, root, isBlockBoundary);\n        return walk(node, offset, function () {\n          return walker.prev().map(function (prev) {\n            return {\n              container: prev,\n              offset: prev.length\n            };\n          });\n        }, process).getOrNull();\n      };\n      var forwards = function (node, offset, process, root) {\n        var walker = TextWalker(node, root, isBlockBoundary);\n        return walk(node, offset, function () {\n          return walker.next().map(function (next) {\n            return {\n              container: next,\n              offset: 0\n            };\n          });\n        }, process).getOrNull();\n      };\n      return {\n        backwards: backwards,\n        forwards: forwards\n      };\n    };\n\n    var cat = function (arr) {\n      var r = [];\n      var push = function (x) {\n        r.push(x);\n      };\n      for (var i = 0; i < arr.length; i++) {\n        arr[i].each(push);\n      }\n      return r;\n    };\n    var lift2 = function (oa, ob, f) {\n      return oa.isSome() && ob.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie())) : Optional.none();\n    };\n    var lift3 = function (oa, ob, oc, f) {\n      return oa.isSome() && ob.isSome() && oc.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie(), oc.getOrDie())) : Optional.none();\n    };\n    var someIf = function (b, a) {\n      return b ? Optional.some(a) : Optional.none();\n    };\n\n    var round = Math.round;\n    var clone$2 = function (rect) {\n      if (!rect) {\n        return {\n          left: 0,\n          top: 0,\n          bottom: 0,\n          right: 0,\n          width: 0,\n          height: 0\n        };\n      }\n      return {\n        left: round(rect.left),\n        top: round(rect.top),\n        bottom: round(rect.bottom),\n        right: round(rect.right),\n        width: round(rect.width),\n        height: round(rect.height)\n      };\n    };\n    var collapse = function (rect, toStart) {\n      rect = clone$2(rect);\n      if (toStart) {\n        rect.right = rect.left;\n      } else {\n        rect.left = rect.left + rect.width;\n        rect.right = rect.left;\n      }\n      rect.width = 0;\n      return rect;\n    };\n    var isEqual = function (rect1, rect2) {\n      return rect1.left === rect2.left && rect1.top === rect2.top && rect1.bottom === rect2.bottom && rect1.right === rect2.right;\n    };\n    var isValidOverflow = function (overflowY, rect1, rect2) {\n      return overflowY >= 0 && overflowY <= Math.min(rect1.height, rect2.height) / 2;\n    };\n    var isAbove = function (rect1, rect2) {\n      var halfHeight = Math.min(rect2.height / 2, rect1.height / 2);\n      if (rect1.bottom - halfHeight < rect2.top) {\n        return true;\n      }\n      if (rect1.top > rect2.bottom) {\n        return false;\n      }\n      return isValidOverflow(rect2.top - rect1.bottom, rect1, rect2);\n    };\n    var isBelow = function (rect1, rect2) {\n      if (rect1.top > rect2.bottom) {\n        return true;\n      }\n      if (rect1.bottom < rect2.top) {\n        return false;\n      }\n      return isValidOverflow(rect2.bottom - rect1.top, rect1, rect2);\n    };\n    var containsXY = function (rect, clientX, clientY) {\n      return clientX >= rect.left && clientX <= rect.right && clientY >= rect.top && clientY <= rect.bottom;\n    };\n\n    var getSelectedNode = function (range) {\n      var startContainer = range.startContainer, startOffset = range.startOffset;\n      if (startContainer.hasChildNodes() && range.endOffset === startOffset + 1) {\n        return startContainer.childNodes[startOffset];\n      }\n      return null;\n    };\n    var getNode = function (container, offset) {\n      if (container.nodeType === 1 && container.hasChildNodes()) {\n        if (offset >= container.childNodes.length) {\n          offset = container.childNodes.length - 1;\n        }\n        container = container.childNodes[offset];\n      }\n      return container;\n    };\n\n    var extendingChars = new RegExp('[\\u0300-\\u036f\\u0483-\\u0487\\u0488-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1-\\u05c2\\u05c4-\\u05c5\\u05c7\\u0610-\\u061a' + '\\u064b-\\u065f\\u0670\\u06d6-\\u06dc\\u06df-\\u06e4\\u06e7-\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0' + '\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0859-\\u085b\\u08e3-\\u0902\\u093a\\u093c' + '\\u0941-\\u0948\\u094d\\u0951-\\u0957\\u0962-\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2-\\u09e3' + '\\u0a01-\\u0a02\\u0a3c\\u0a41-\\u0a42\\u0a47-\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70-\\u0a71\\u0a75\\u0a81-\\u0a82\\u0abc' + '\\u0ac1-\\u0ac5\\u0ac7-\\u0ac8\\u0acd\\u0ae2-\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57' + '\\u0b62-\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c00\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55-\\u0c56' + '\\u0c62-\\u0c63\\u0c81\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc-\\u0ccd\\u0cd5-\\u0cd6\\u0ce2-\\u0ce3\\u0d01\\u0d3e\\u0d41-\\u0d44' + '\\u0d4d\\u0d57\\u0d62-\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9' + '\\u0ebb-\\u0ebc\\u0ec8-\\u0ecd\\u0f18-\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86-\\u0f87\\u0f8d-\\u0f97' + '\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039-\\u103a\\u103d-\\u103e\\u1058-\\u1059\\u105e-\\u1060\\u1071-\\u1074' + '\\u1082\\u1085-\\u1086\\u108d\\u109d\\u135d-\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752-\\u1753\\u1772-\\u1773\\u17b4-\\u17b5' + '\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927-\\u1928\\u1932\\u1939-\\u193b\\u1a17-\\u1a18' + '\\u1a1b\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1ab0-\\u1abd\\u1ABE\\u1b00-\\u1b03\\u1b34' + '\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80-\\u1b81\\u1ba2-\\u1ba5\\u1ba8-\\u1ba9\\u1bab-\\u1bad\\u1be6\\u1be8-\\u1be9' + '\\u1bed\\u1bef-\\u1bf1\\u1c2c-\\u1c33\\u1c36-\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1cf4\\u1cf8-\\u1cf9' + '\\u1dc0-\\u1df5\\u1dfc-\\u1dff\\u200c-\\u200d\\u20d0-\\u20dc\\u20DD-\\u20E0\\u20e1\\u20E2-\\u20E4\\u20e5-\\u20f0\\u2cef-\\u2cf1' + '\\u2d7f\\u2de0-\\u2dff\\u302a-\\u302d\\u302e-\\u302f\\u3099-\\u309a\\ua66f\\uA670-\\uA672\\ua674-\\ua67d\\ua69e-\\ua69f\\ua6f0-\\ua6f1' + '\\ua802\\ua806\\ua80b\\ua825-\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc' + '\\ua9e5\\uaa29-\\uaa2e\\uaa31-\\uaa32\\uaa35-\\uaa36\\uaa43\\uaa4c\\uaa7c\\uaab0\\uaab2-\\uaab4\\uaab7-\\uaab8\\uaabe-\\uaabf\\uaac1' + '\\uaaec-\\uaaed\\uaaf6\\uabe5\\uabe8\\uabed\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe2f\\uff9e-\\uff9f]');\n    var isExtendingChar = function (ch) {\n      return typeof ch === 'string' && ch.charCodeAt(0) >= 768 && extendingChars.test(ch);\n    };\n\n    var or = function () {\n      var args = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n      return function (x) {\n        for (var i = 0; i < args.length; i++) {\n          if (args[i](x)) {\n            return true;\n          }\n        }\n        return false;\n      };\n    };\n    var and = function () {\n      var args = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n      return function (x) {\n        for (var i = 0; i < args.length; i++) {\n          if (!args[i](x)) {\n            return false;\n          }\n        }\n        return true;\n      };\n    };\n\n    var isElement$3 = isElement$1;\n    var isCaretCandidate$1 = isCaretCandidate;\n    var isBlock$1 = matchStyleValues('display', 'block table');\n    var isFloated = matchStyleValues('float', 'left right');\n    var isValidElementCaretCandidate = and(isElement$3, isCaretCandidate$1, not(isFloated));\n    var isNotPre = not(matchStyleValues('white-space', 'pre pre-line pre-wrap'));\n    var isText$4 = isText$1;\n    var isBr$3 = isBr;\n    var nodeIndex = DOMUtils.nodeIndex;\n    var resolveIndex = getNode;\n    var createRange = function (doc) {\n      return 'createRange' in doc ? doc.createRange() : DOMUtils.DOM.createRng();\n    };\n    var isWhiteSpace = function (chr) {\n      return chr && /[\\r\\n\\t ]/.test(chr);\n    };\n    var isRange = function (rng) {\n      return !!rng.setStart && !!rng.setEnd;\n    };\n    var isHiddenWhiteSpaceRange = function (range) {\n      var container = range.startContainer;\n      var offset = range.startOffset;\n      var text;\n      if (isWhiteSpace(range.toString()) && isNotPre(container.parentNode) && isText$1(container)) {\n        text = container.data;\n        if (isWhiteSpace(text[offset - 1]) || isWhiteSpace(text[offset + 1])) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var getBrClientRect = function (brNode) {\n      var doc = brNode.ownerDocument;\n      var rng = createRange(doc);\n      var nbsp$1 = doc.createTextNode(nbsp);\n      var parentNode = brNode.parentNode;\n      parentNode.insertBefore(nbsp$1, brNode);\n      rng.setStart(nbsp$1, 0);\n      rng.setEnd(nbsp$1, 1);\n      var clientRect = clone$2(rng.getBoundingClientRect());\n      parentNode.removeChild(nbsp$1);\n      return clientRect;\n    };\n    var getBoundingClientRectWebKitText = function (rng) {\n      var sc = rng.startContainer;\n      var ec = rng.endContainer;\n      var so = rng.startOffset;\n      var eo = rng.endOffset;\n      if (sc === ec && isText$1(ec) && so === 0 && eo === 1) {\n        var newRng = rng.cloneRange();\n        newRng.setEndAfter(ec);\n        return getBoundingClientRect(newRng);\n      } else {\n        return null;\n      }\n    };\n    var isZeroRect = function (r) {\n      return r.left === 0 && r.right === 0 && r.top === 0 && r.bottom === 0;\n    };\n    var getBoundingClientRect = function (item) {\n      var clientRect;\n      var clientRects = item.getClientRects();\n      if (clientRects.length > 0) {\n        clientRect = clone$2(clientRects[0]);\n      } else {\n        clientRect = clone$2(item.getBoundingClientRect());\n      }\n      if (!isRange(item) && isBr$3(item) && isZeroRect(clientRect)) {\n        return getBrClientRect(item);\n      }\n      if (isZeroRect(clientRect) && isRange(item)) {\n        return getBoundingClientRectWebKitText(item);\n      }\n      return clientRect;\n    };\n    var collapseAndInflateWidth = function (clientRect, toStart) {\n      var newClientRect = collapse(clientRect, toStart);\n      newClientRect.width = 1;\n      newClientRect.right = newClientRect.left + 1;\n      return newClientRect;\n    };\n    var getCaretPositionClientRects = function (caretPosition) {\n      var clientRects = [];\n      var beforeNode, node;\n      var addUniqueAndValidRect = function (clientRect) {\n        if (clientRect.height === 0) {\n          return;\n        }\n        if (clientRects.length > 0) {\n          if (isEqual(clientRect, clientRects[clientRects.length - 1])) {\n            return;\n          }\n        }\n        clientRects.push(clientRect);\n      };\n      var addCharacterOffset = function (container, offset) {\n        var range = createRange(container.ownerDocument);\n        if (offset < container.data.length) {\n          if (isExtendingChar(container.data[offset])) {\n            return clientRects;\n          }\n          if (isExtendingChar(container.data[offset - 1])) {\n            range.setStart(container, offset);\n            range.setEnd(container, offset + 1);\n            if (!isHiddenWhiteSpaceRange(range)) {\n              addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range), false));\n              return clientRects;\n            }\n          }\n        }\n        if (offset > 0) {\n          range.setStart(container, offset - 1);\n          range.setEnd(container, offset);\n          if (!isHiddenWhiteSpaceRange(range)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range), false));\n          }\n        }\n        if (offset < container.data.length) {\n          range.setStart(container, offset);\n          range.setEnd(container, offset + 1);\n          if (!isHiddenWhiteSpaceRange(range)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range), true));\n          }\n        }\n      };\n      if (isText$4(caretPosition.container())) {\n        addCharacterOffset(caretPosition.container(), caretPosition.offset());\n        return clientRects;\n      }\n      if (isElement$3(caretPosition.container())) {\n        if (caretPosition.isAtEnd()) {\n          node = resolveIndex(caretPosition.container(), caretPosition.offset());\n          if (isText$4(node)) {\n            addCharacterOffset(node, node.data.length);\n          }\n          if (isValidElementCaretCandidate(node) && !isBr$3(node)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node), false));\n          }\n        } else {\n          node = resolveIndex(caretPosition.container(), caretPosition.offset());\n          if (isText$4(node)) {\n            addCharacterOffset(node, 0);\n          }\n          if (isValidElementCaretCandidate(node) && caretPosition.isAtEnd()) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node), false));\n            return clientRects;\n          }\n          beforeNode = resolveIndex(caretPosition.container(), caretPosition.offset() - 1);\n          if (isValidElementCaretCandidate(beforeNode) && !isBr$3(beforeNode)) {\n            if (isBlock$1(beforeNode) || isBlock$1(node) || !isValidElementCaretCandidate(node)) {\n              addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(beforeNode), false));\n            }\n          }\n          if (isValidElementCaretCandidate(node)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node), true));\n          }\n        }\n      }\n      return clientRects;\n    };\n    var CaretPosition = function (container, offset, clientRects) {\n      var isAtStart = function () {\n        if (isText$4(container)) {\n          return offset === 0;\n        }\n        return offset === 0;\n      };\n      var isAtEnd = function () {\n        if (isText$4(container)) {\n          return offset >= container.data.length;\n        }\n        return offset >= container.childNodes.length;\n      };\n      var toRange = function () {\n        var range = createRange(container.ownerDocument);\n        range.setStart(container, offset);\n        range.setEnd(container, offset);\n        return range;\n      };\n      var getClientRects = function () {\n        if (!clientRects) {\n          clientRects = getCaretPositionClientRects(CaretPosition(container, offset));\n        }\n        return clientRects;\n      };\n      var isVisible = function () {\n        return getClientRects().length > 0;\n      };\n      var isEqual = function (caretPosition) {\n        return caretPosition && container === caretPosition.container() && offset === caretPosition.offset();\n      };\n      var getNode = function (before) {\n        return resolveIndex(container, before ? offset - 1 : offset);\n      };\n      return {\n        container: constant(container),\n        offset: constant(offset),\n        toRange: toRange,\n        getClientRects: getClientRects,\n        isVisible: isVisible,\n        isAtStart: isAtStart,\n        isAtEnd: isAtEnd,\n        isEqual: isEqual,\n        getNode: getNode\n      };\n    };\n    CaretPosition.fromRangeStart = function (range) {\n      return CaretPosition(range.startContainer, range.startOffset);\n    };\n    CaretPosition.fromRangeEnd = function (range) {\n      return CaretPosition(range.endContainer, range.endOffset);\n    };\n    CaretPosition.after = function (node) {\n      return CaretPosition(node.parentNode, nodeIndex(node) + 1);\n    };\n    CaretPosition.before = function (node) {\n      return CaretPosition(node.parentNode, nodeIndex(node));\n    };\n    CaretPosition.isAbove = function (pos1, pos2) {\n      return lift2(head(pos2.getClientRects()), last(pos1.getClientRects()), isAbove).getOr(false);\n    };\n    CaretPosition.isBelow = function (pos1, pos2) {\n      return lift2(last(pos2.getClientRects()), head(pos1.getClientRects()), isBelow).getOr(false);\n    };\n    CaretPosition.isAtStart = function (pos) {\n      return pos ? pos.isAtStart() : false;\n    };\n    CaretPosition.isAtEnd = function (pos) {\n      return pos ? pos.isAtEnd() : false;\n    };\n    CaretPosition.isTextPosition = function (pos) {\n      return pos ? isText$1(pos.container()) : false;\n    };\n    CaretPosition.isElementPosition = function (pos) {\n      return CaretPosition.isTextPosition(pos) === false;\n    };\n\n    var trimEmptyTextNode = function (dom, node) {\n      if (isText$1(node) && node.data.length === 0) {\n        dom.remove(node);\n      }\n    };\n    var insertNode = function (dom, rng, node) {\n      rng.insertNode(node);\n      trimEmptyTextNode(dom, node.previousSibling);\n      trimEmptyTextNode(dom, node.nextSibling);\n    };\n    var insertFragment = function (dom, rng, frag) {\n      var firstChild = Optional.from(frag.firstChild);\n      var lastChild = Optional.from(frag.lastChild);\n      rng.insertNode(frag);\n      firstChild.each(function (child) {\n        return trimEmptyTextNode(dom, child.previousSibling);\n      });\n      lastChild.each(function (child) {\n        return trimEmptyTextNode(dom, child.nextSibling);\n      });\n    };\n    var rangeInsertNode = function (dom, rng, node) {\n      if (isDocumentFragment$1(node)) {\n        insertFragment(dom, rng, node);\n      } else {\n        insertNode(dom, rng, node);\n      }\n    };\n\n    var isText$5 = isText$1;\n    var isBogus$2 = isBogus;\n    var nodeIndex$1 = DOMUtils.nodeIndex;\n    var normalizedParent = function (node) {\n      var parentNode = node.parentNode;\n      if (isBogus$2(parentNode)) {\n        return normalizedParent(parentNode);\n      }\n      return parentNode;\n    };\n    var getChildNodes = function (node) {\n      if (!node) {\n        return [];\n      }\n      return reduce(node.childNodes, function (result, node) {\n        if (isBogus$2(node) && node.nodeName !== 'BR') {\n          result = result.concat(getChildNodes(node));\n        } else {\n          result.push(node);\n        }\n        return result;\n      }, []);\n    };\n    var normalizedTextOffset = function (node, offset) {\n      while (node = node.previousSibling) {\n        if (!isText$5(node)) {\n          break;\n        }\n        offset += node.data.length;\n      }\n      return offset;\n    };\n    var equal$1 = function (a) {\n      return function (b) {\n        return a === b;\n      };\n    };\n    var normalizedNodeIndex = function (node) {\n      var nodes, index;\n      nodes = getChildNodes(normalizedParent(node));\n      index = findIndex$1(nodes, equal$1(node), node);\n      nodes = nodes.slice(0, index + 1);\n      var numTextFragments = reduce(nodes, function (result, node, i) {\n        if (isText$5(node) && isText$5(nodes[i - 1])) {\n          result++;\n        }\n        return result;\n      }, 0);\n      nodes = filter$2(nodes, matchNodeNames([node.nodeName]));\n      index = findIndex$1(nodes, equal$1(node), node);\n      return index - numTextFragments;\n    };\n    var createPathItem = function (node) {\n      var name;\n      if (isText$5(node)) {\n        name = 'text()';\n      } else {\n        name = node.nodeName.toLowerCase();\n      }\n      return name + '[' + normalizedNodeIndex(node) + ']';\n    };\n    var parentsUntil = function (root, node, predicate) {\n      var parents = [];\n      for (node = node.parentNode; node !== root; node = node.parentNode) {\n        if (predicate && predicate(node)) {\n          break;\n        }\n        parents.push(node);\n      }\n      return parents;\n    };\n    var create$3 = function (root, caretPosition) {\n      var container, offset, path = [], outputOffset, childNodes, parents;\n      container = caretPosition.container();\n      offset = caretPosition.offset();\n      if (isText$5(container)) {\n        outputOffset = normalizedTextOffset(container, offset);\n      } else {\n        childNodes = container.childNodes;\n        if (offset >= childNodes.length) {\n          outputOffset = 'after';\n          offset = childNodes.length - 1;\n        } else {\n          outputOffset = 'before';\n        }\n        container = childNodes[offset];\n      }\n      path.push(createPathItem(container));\n      parents = parentsUntil(root, container);\n      parents = filter$2(parents, not(isBogus));\n      path = path.concat(map$2(parents, function (node) {\n        return createPathItem(node);\n      }));\n      return path.reverse().join('/') + ',' + outputOffset;\n    };\n    var resolvePathItem = function (node, name, index) {\n      var nodes = getChildNodes(node);\n      nodes = filter$2(nodes, function (node, index) {\n        return !isText$5(node) || !isText$5(nodes[index - 1]);\n      });\n      nodes = filter$2(nodes, matchNodeNames([name]));\n      return nodes[index];\n    };\n    var findTextPosition = function (container, offset) {\n      var node = container, targetOffset = 0, dataLen;\n      while (isText$5(node)) {\n        dataLen = node.data.length;\n        if (offset >= targetOffset && offset <= targetOffset + dataLen) {\n          container = node;\n          offset = offset - targetOffset;\n          break;\n        }\n        if (!isText$5(node.nextSibling)) {\n          container = node;\n          offset = dataLen;\n          break;\n        }\n        targetOffset += dataLen;\n        node = node.nextSibling;\n      }\n      if (isText$5(container) && offset > container.data.length) {\n        offset = container.data.length;\n      }\n      return CaretPosition(container, offset);\n    };\n    var resolve$1 = function (root, path) {\n      var offset;\n      if (!path) {\n        return null;\n      }\n      var parts = path.split(',');\n      var paths = parts[0].split('/');\n      offset = parts.length > 1 ? parts[1] : 'before';\n      var container = reduce(paths, function (result, value) {\n        var match = /([\\w\\-\\(\\)]+)\\[([0-9]+)\\]/.exec(value);\n        if (!match) {\n          return null;\n        }\n        if (match[1] === 'text()') {\n          match[1] = '#text';\n        }\n        return resolvePathItem(result, match[1], parseInt(match[2], 10));\n      }, root);\n      if (!container) {\n        return null;\n      }\n      if (!isText$5(container)) {\n        if (offset === 'after') {\n          offset = nodeIndex$1(container) + 1;\n        } else {\n          offset = nodeIndex$1(container);\n        }\n        return CaretPosition(container.parentNode, offset);\n      }\n      return findTextPosition(container, parseInt(offset, 10));\n    };\n\n    var isContentEditableFalse$2 = isContentEditableFalse;\n    var getNormalizedTextOffset = function (trim, container, offset) {\n      var node, trimmedOffset;\n      trimmedOffset = trim(container.data.slice(0, offset)).length;\n      for (node = container.previousSibling; node && isText$1(node); node = node.previousSibling) {\n        trimmedOffset += trim(node.data).length;\n      }\n      return trimmedOffset;\n    };\n    var getPoint = function (dom, trim, normalized, rng, start) {\n      var container = rng[start ? 'startContainer' : 'endContainer'];\n      var offset = rng[start ? 'startOffset' : 'endOffset'];\n      var point = [];\n      var childNodes, after = 0;\n      var root = dom.getRoot();\n      if (isText$1(container)) {\n        point.push(normalized ? getNormalizedTextOffset(trim, container, offset) : offset);\n      } else {\n        childNodes = container.childNodes;\n        if (offset >= childNodes.length && childNodes.length) {\n          after = 1;\n          offset = Math.max(0, childNodes.length - 1);\n        }\n        point.push(dom.nodeIndex(childNodes[offset], normalized) + after);\n      }\n      for (; container && container !== root; container = container.parentNode) {\n        point.push(dom.nodeIndex(container, normalized));\n      }\n      return point;\n    };\n    var getLocation = function (trim, selection, normalized, rng) {\n      var dom = selection.dom, bookmark = {};\n      bookmark.start = getPoint(dom, trim, normalized, rng, true);\n      if (!selection.isCollapsed()) {\n        bookmark.end = getPoint(dom, trim, normalized, rng, false);\n      }\n      return bookmark;\n    };\n    var findIndex$2 = function (dom, name, element) {\n      var count = 0;\n      Tools.each(dom.select(name), function (node) {\n        if (node.getAttribute('data-mce-bogus') === 'all') {\n          return;\n        }\n        if (node === element) {\n          return false;\n        }\n        count++;\n      });\n      return count;\n    };\n    var moveEndPoint = function (rng, start) {\n      var container, offset, childNodes;\n      var prefix = start ? 'start' : 'end';\n      container = rng[prefix + 'Container'];\n      offset = rng[prefix + 'Offset'];\n      if (isElement$1(container) && container.nodeName === 'TR') {\n        childNodes = container.childNodes;\n        container = childNodes[Math.min(start ? offset : offset - 1, childNodes.length - 1)];\n        if (container) {\n          offset = start ? 0 : container.childNodes.length;\n          rng['set' + (start ? 'Start' : 'End')](container, offset);\n        }\n      }\n    };\n    var normalizeTableCellSelection = function (rng) {\n      moveEndPoint(rng, true);\n      moveEndPoint(rng, false);\n      return rng;\n    };\n    var findSibling = function (node, offset) {\n      var sibling;\n      if (isElement$1(node)) {\n        node = getNode(node, offset);\n        if (isContentEditableFalse$2(node)) {\n          return node;\n        }\n      }\n      if (isCaretContainer(node)) {\n        if (isText$1(node) && isCaretContainerBlock(node)) {\n          node = node.parentNode;\n        }\n        sibling = node.previousSibling;\n        if (isContentEditableFalse$2(sibling)) {\n          return sibling;\n        }\n        sibling = node.nextSibling;\n        if (isContentEditableFalse$2(sibling)) {\n          return sibling;\n        }\n      }\n    };\n    var findAdjacentContentEditableFalseElm = function (rng) {\n      return findSibling(rng.startContainer, rng.startOffset) || findSibling(rng.endContainer, rng.endOffset);\n    };\n    var getOffsetBookmark = function (trim, normalized, selection) {\n      var element = selection.getNode();\n      var name = element ? element.nodeName : null;\n      var rng = selection.getRng();\n      if (isContentEditableFalse$2(element) || name === 'IMG') {\n        return {\n          name: name,\n          index: findIndex$2(selection.dom, name, element)\n        };\n      }\n      var sibling = findAdjacentContentEditableFalseElm(rng);\n      if (sibling) {\n        name = sibling.tagName;\n        return {\n          name: name,\n          index: findIndex$2(selection.dom, name, sibling)\n        };\n      }\n      return getLocation(trim, selection, normalized, rng);\n    };\n    var getCaretBookmark = function (selection) {\n      var rng = selection.getRng();\n      return {\n        start: create$3(selection.dom.getRoot(), CaretPosition.fromRangeStart(rng)),\n        end: create$3(selection.dom.getRoot(), CaretPosition.fromRangeEnd(rng))\n      };\n    };\n    var getRangeBookmark = function (selection) {\n      return { rng: selection.getRng() };\n    };\n    var createBookmarkSpan = function (dom, id, filled) {\n      var args = {\n        'data-mce-type': 'bookmark',\n        id: id,\n        'style': 'overflow:hidden;line-height:0px'\n      };\n      return filled ? dom.create('span', args, '&#xFEFF;') : dom.create('span', args);\n    };\n    var getPersistentBookmark = function (selection, filled) {\n      var dom = selection.dom;\n      var rng = selection.getRng();\n      var id = dom.uniqueId();\n      var collapsed = selection.isCollapsed();\n      var element = selection.getNode();\n      var name = element.nodeName;\n      if (name === 'IMG') {\n        return {\n          name: name,\n          index: findIndex$2(dom, name, element)\n        };\n      }\n      var rng2 = normalizeTableCellSelection(rng.cloneRange());\n      if (!collapsed) {\n        rng2.collapse(false);\n        var endBookmarkNode = createBookmarkSpan(dom, id + '_end', filled);\n        rangeInsertNode(dom, rng2, endBookmarkNode);\n      }\n      rng = normalizeTableCellSelection(rng);\n      rng.collapse(true);\n      var startBookmarkNode = createBookmarkSpan(dom, id + '_start', filled);\n      rangeInsertNode(dom, rng, startBookmarkNode);\n      selection.moveToBookmark({\n        id: id,\n        keep: true\n      });\n      return { id: id };\n    };\n    var getBookmark = function (selection, type, normalized) {\n      if (type === 2) {\n        return getOffsetBookmark(trim$2, normalized, selection);\n      } else if (type === 3) {\n        return getCaretBookmark(selection);\n      } else if (type) {\n        return getRangeBookmark(selection);\n      } else {\n        return getPersistentBookmark(selection, false);\n      }\n    };\n    var getUndoBookmark = curry(getOffsetBookmark, identity, true);\n\n    var DOM$1 = DOMUtils.DOM;\n    var defaultPreviewStyles = 'font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow';\n    var getBodySetting = function (editor, name, defaultValue) {\n      var value = editor.getParam(name, defaultValue);\n      if (value.indexOf('=') !== -1) {\n        var bodyObj = editor.getParam(name, '', 'hash');\n        return bodyObj.hasOwnProperty(editor.id) ? bodyObj[editor.id] : defaultValue;\n      } else {\n        return value;\n      }\n    };\n    var getIframeAttrs = function (editor) {\n      return editor.getParam('iframe_attrs', {});\n    };\n    var getDocType = function (editor) {\n      return editor.getParam('doctype', '<!DOCTYPE html>');\n    };\n    var getDocumentBaseUrl = function (editor) {\n      return editor.getParam('document_base_url', '');\n    };\n    var getBodyId = function (editor) {\n      return getBodySetting(editor, 'body_id', 'tinymce');\n    };\n    var getBodyClass = function (editor) {\n      return getBodySetting(editor, 'body_class', '');\n    };\n    var getContentSecurityPolicy = function (editor) {\n      return editor.getParam('content_security_policy', '');\n    };\n    var shouldPutBrInPre = function (editor) {\n      return editor.getParam('br_in_pre', true);\n    };\n    var getForcedRootBlock = function (editor) {\n      if (editor.getParam('force_p_newlines', false)) {\n        return 'p';\n      }\n      var block = editor.getParam('forced_root_block', 'p');\n      if (block === false) {\n        return '';\n      } else if (block === true) {\n        return 'p';\n      } else {\n        return block;\n      }\n    };\n    var getForcedRootBlockAttrs = function (editor) {\n      return editor.getParam('forced_root_block_attrs', {});\n    };\n    var getBrNewLineSelector = function (editor) {\n      return editor.getParam('br_newline_selector', '.mce-toc h2,figcaption,caption');\n    };\n    var getNoNewLineSelector = function (editor) {\n      return editor.getParam('no_newline_selector', '');\n    };\n    var shouldKeepStyles = function (editor) {\n      return editor.getParam('keep_styles', true);\n    };\n    var shouldEndContainerOnEmptyBlock = function (editor) {\n      return editor.getParam('end_container_on_empty_block', false);\n    };\n    var getFontStyleValues = function (editor) {\n      return Tools.explode(editor.getParam('font_size_style_values', 'xx-small,x-small,small,medium,large,x-large,xx-large'));\n    };\n    var getFontSizeClasses = function (editor) {\n      return Tools.explode(editor.getParam('font_size_classes', ''));\n    };\n    var getImagesDataImgFilter = function (editor) {\n      return editor.getParam('images_dataimg_filter', always, 'function');\n    };\n    var isAutomaticUploadsEnabled = function (editor) {\n      return editor.getParam('automatic_uploads', true, 'boolean');\n    };\n    var shouldReuseFileName = function (editor) {\n      return editor.getParam('images_reuse_filename', false, 'boolean');\n    };\n    var shouldReplaceBlobUris = function (editor) {\n      return editor.getParam('images_replace_blob_uris', true, 'boolean');\n    };\n    var getIconPackName = function (editor) {\n      return editor.getParam('icons', '', 'string');\n    };\n    var getIconsUrl = function (editor) {\n      return editor.getParam('icons_url', '', 'string');\n    };\n    var getImageUploadUrl = function (editor) {\n      return editor.getParam('images_upload_url', '', 'string');\n    };\n    var getImageUploadBasePath = function (editor) {\n      return editor.getParam('images_upload_base_path', '', 'string');\n    };\n    var getImagesUploadCredentials = function (editor) {\n      return editor.getParam('images_upload_credentials', false, 'boolean');\n    };\n    var getImagesUploadHandler = function (editor) {\n      return editor.getParam('images_upload_handler', null, 'function');\n    };\n    var shouldUseContentCssCors = function (editor) {\n      return editor.getParam('content_css_cors', false, 'boolean');\n    };\n    var getReferrerPolicy = function (editor) {\n      return editor.getParam('referrer_policy', '', 'string');\n    };\n    var getLanguageCode = function (editor) {\n      return editor.getParam('language', 'en', 'string');\n    };\n    var getLanguageUrl = function (editor) {\n      return editor.getParam('language_url', '', 'string');\n    };\n    var shouldIndentUseMargin = function (editor) {\n      return editor.getParam('indent_use_margin', false);\n    };\n    var getIndentation = function (editor) {\n      return editor.getParam('indentation', '40px', 'string');\n    };\n    var getContentCss = function (editor) {\n      var contentCss = editor.getParam('content_css');\n      if (isString(contentCss)) {\n        return map(contentCss.split(','), trim);\n      } else if (isArray(contentCss)) {\n        return contentCss;\n      } else if (contentCss === false || editor.inline) {\n        return [];\n      } else {\n        return ['default'];\n      }\n    };\n    var getFontCss = function (editor) {\n      var fontCss = editor.getParam('font_css', []);\n      return isArray(fontCss) ? fontCss : map(fontCss.split(','), trim);\n    };\n    var getDirectionality = function (editor) {\n      return editor.getParam('directionality', I18n.isRtl() ? 'rtl' : undefined);\n    };\n    var getInlineBoundarySelector = function (editor) {\n      return editor.getParam('inline_boundaries_selector', 'a[href],code,.mce-annotation', 'string');\n    };\n    var getObjectResizing = function (editor) {\n      var selector = editor.getParam('object_resizing');\n      if (selector === false || Env.iOS) {\n        return false;\n      } else {\n        return isString(selector) ? selector : 'table,img,figure.image,div,video,iframe';\n      }\n    };\n    var getResizeImgProportional = function (editor) {\n      return editor.getParam('resize_img_proportional', true, 'boolean');\n    };\n    var getPlaceholder = function (editor) {\n      return editor.getParam('placeholder', DOM$1.getAttrib(editor.getElement(), 'placeholder'), 'string');\n    };\n    var getEventRoot = function (editor) {\n      return editor.getParam('event_root');\n    };\n    var getServiceMessage = function (editor) {\n      return editor.getParam('service_message');\n    };\n    var getTheme = function (editor) {\n      return editor.getParam('theme');\n    };\n    var shouldValidate = function (editor) {\n      return editor.getParam('validate');\n    };\n    var isInlineBoundariesEnabled = function (editor) {\n      return editor.getParam('inline_boundaries') !== false;\n    };\n    var getFormats = function (editor) {\n      return editor.getParam('formats');\n    };\n    var getPreviewStyles = function (editor) {\n      var style = editor.getParam('preview_styles', defaultPreviewStyles);\n      if (isString(style)) {\n        return style;\n      } else {\n        return '';\n      }\n    };\n    var canFormatEmptyLines = function (editor) {\n      return editor.getParam('format_empty_lines', false, 'boolean');\n    };\n    var getCustomUiSelector = function (editor) {\n      return editor.getParam('custom_ui_selector', '', 'string');\n    };\n    var getThemeUrl = function (editor) {\n      return editor.getParam('theme_url');\n    };\n    var isInline$1 = function (editor) {\n      return editor.getParam('inline');\n    };\n    var hasHiddenInput = function (editor) {\n      return editor.getParam('hidden_input');\n    };\n    var shouldPatchSubmit = function (editor) {\n      return editor.getParam('submit_patch');\n    };\n    var isEncodingXml = function (editor) {\n      return editor.getParam('encoding') === 'xml';\n    };\n    var shouldAddFormSubmitTrigger = function (editor) {\n      return editor.getParam('add_form_submit_trigger');\n    };\n    var shouldAddUnloadTrigger = function (editor) {\n      return editor.getParam('add_unload_trigger');\n    };\n    var hasForcedRootBlock = function (editor) {\n      return getForcedRootBlock(editor) !== '';\n    };\n    var getCustomUndoRedoLevels = function (editor) {\n      return editor.getParam('custom_undo_redo_levels', 0, 'number');\n    };\n    var shouldDisableNodeChange = function (editor) {\n      return editor.getParam('disable_nodechange');\n    };\n    var isReadOnly = function (editor) {\n      return editor.getParam('readonly');\n    };\n    var hasContentCssCors = function (editor) {\n      return editor.getParam('content_css_cors');\n    };\n    var getPlugins = function (editor) {\n      return editor.getParam('plugins', '', 'string');\n    };\n    var getExternalPlugins = function (editor) {\n      return editor.getParam('external_plugins');\n    };\n    var shouldBlockUnsupportedDrop = function (editor) {\n      return editor.getParam('block_unsupported_drop', true, 'boolean');\n    };\n    var isVisualAidsEnabled = function (editor) {\n      return editor.getParam('visual', true, 'boolean');\n    };\n    var getVisualAidsTableClass = function (editor) {\n      return editor.getParam('visual_table_class', 'mce-item-table', 'string');\n    };\n    var getVisualAidsAnchorClass = function (editor) {\n      return editor.getParam('visual_anchor_class', 'mce-item-anchor', 'string');\n    };\n\n    var isElement$4 = isElement$1;\n    var isText$6 = isText$1;\n    var removeNode = function (node) {\n      var parentNode = node.parentNode;\n      if (parentNode) {\n        parentNode.removeChild(node);\n      }\n    };\n    var trimCount = function (text) {\n      var trimmedText = trim$2(text);\n      return {\n        count: text.length - trimmedText.length,\n        text: trimmedText\n      };\n    };\n    var deleteZwspChars = function (caretContainer) {\n      var idx;\n      while ((idx = caretContainer.data.lastIndexOf(ZWSP)) !== -1) {\n        caretContainer.deleteData(idx, 1);\n      }\n    };\n    var removeUnchanged = function (caretContainer, pos) {\n      remove$5(caretContainer);\n      return pos;\n    };\n    var removeTextAndReposition = function (caretContainer, pos) {\n      var before = trimCount(caretContainer.data.substr(0, pos.offset()));\n      var after = trimCount(caretContainer.data.substr(pos.offset()));\n      var text = before.text + after.text;\n      if (text.length > 0) {\n        deleteZwspChars(caretContainer);\n        return CaretPosition(caretContainer, pos.offset() - before.count);\n      } else {\n        return pos;\n      }\n    };\n    var removeElementAndReposition = function (caretContainer, pos) {\n      var parentNode = pos.container();\n      var newPosition = indexOf(from$1(parentNode.childNodes), caretContainer).map(function (index) {\n        return index < pos.offset() ? CaretPosition(parentNode, pos.offset() - 1) : pos;\n      }).getOr(pos);\n      remove$5(caretContainer);\n      return newPosition;\n    };\n    var removeTextCaretContainer = function (caretContainer, pos) {\n      return isText$6(caretContainer) && pos.container() === caretContainer ? removeTextAndReposition(caretContainer, pos) : removeUnchanged(caretContainer, pos);\n    };\n    var removeElementCaretContainer = function (caretContainer, pos) {\n      return pos.container() === caretContainer.parentNode ? removeElementAndReposition(caretContainer, pos) : removeUnchanged(caretContainer, pos);\n    };\n    var removeAndReposition = function (container, pos) {\n      return CaretPosition.isTextPosition(pos) ? removeTextCaretContainer(container, pos) : removeElementCaretContainer(container, pos);\n    };\n    var remove$5 = function (caretContainerNode) {\n      if (isElement$4(caretContainerNode) && isCaretContainer(caretContainerNode)) {\n        if (hasContent(caretContainerNode)) {\n          caretContainerNode.removeAttribute('data-mce-caret');\n        } else {\n          removeNode(caretContainerNode);\n        }\n      }\n      if (isText$6(caretContainerNode)) {\n        deleteZwspChars(caretContainerNode);\n        if (caretContainerNode.data.length === 0) {\n          removeNode(caretContainerNode);\n        }\n      }\n    };\n\n    var browser$2 = detect$3().browser;\n    var isContentEditableFalse$3 = isContentEditableFalse;\n    var isMedia$1 = isMedia;\n    var isTableCell$2 = isTableCell;\n    var inlineFakeCaretSelector = '*[contentEditable=false],video,audio,embed,object';\n    var getAbsoluteClientRect = function (root, element, before) {\n      var clientRect = collapse(element.getBoundingClientRect(), before);\n      var docElm, scrollX, scrollY, margin, rootRect;\n      if (root.tagName === 'BODY') {\n        docElm = root.ownerDocument.documentElement;\n        scrollX = root.scrollLeft || docElm.scrollLeft;\n        scrollY = root.scrollTop || docElm.scrollTop;\n      } else {\n        rootRect = root.getBoundingClientRect();\n        scrollX = root.scrollLeft - rootRect.left;\n        scrollY = root.scrollTop - rootRect.top;\n      }\n      clientRect.left += scrollX;\n      clientRect.right += scrollX;\n      clientRect.top += scrollY;\n      clientRect.bottom += scrollY;\n      clientRect.width = 1;\n      margin = element.offsetWidth - element.clientWidth;\n      if (margin > 0) {\n        if (before) {\n          margin *= -1;\n        }\n        clientRect.left += margin;\n        clientRect.right += margin;\n      }\n      return clientRect;\n    };\n    var trimInlineCaretContainers = function (root) {\n      var fakeCaretTargetNodes = descendants$1(SugarElement.fromDom(root), inlineFakeCaretSelector);\n      for (var i = 0; i < fakeCaretTargetNodes.length; i++) {\n        var node = fakeCaretTargetNodes[i].dom;\n        var sibling = node.previousSibling;\n        if (endsWithCaretContainer(sibling)) {\n          var data = sibling.data;\n          if (data.length === 1) {\n            sibling.parentNode.removeChild(sibling);\n          } else {\n            sibling.deleteData(data.length - 1, 1);\n          }\n        }\n        sibling = node.nextSibling;\n        if (startsWithCaretContainer(sibling)) {\n          var data = sibling.data;\n          if (data.length === 1) {\n            sibling.parentNode.removeChild(sibling);\n          } else {\n            sibling.deleteData(0, 1);\n          }\n        }\n      }\n    };\n    var FakeCaret = function (editor, root, isBlock, hasFocus) {\n      var lastVisualCaret = Cell(Optional.none());\n      var cursorInterval, caretContainerNode;\n      var rootBlock = getForcedRootBlock(editor);\n      var caretBlock = rootBlock.length > 0 ? rootBlock : 'p';\n      var show = function (before, element) {\n        var clientRect, rng;\n        hide();\n        if (isTableCell$2(element)) {\n          return null;\n        }\n        if (isBlock(element)) {\n          caretContainerNode = insertBlock(caretBlock, element, before);\n          clientRect = getAbsoluteClientRect(root, element, before);\n          DomQuery(caretContainerNode).css('top', clientRect.top);\n          var caret = DomQuery('<div class=\"mce-visual-caret\" data-mce-bogus=\"all\"></div>').css(clientRect).appendTo(root)[0];\n          lastVisualCaret.set(Optional.some({\n            caret: caret,\n            element: element,\n            before: before\n          }));\n          lastVisualCaret.get().each(function (caretState) {\n            if (before) {\n              DomQuery(caretState.caret).addClass('mce-visual-caret-before');\n            }\n          });\n          startBlink();\n          rng = element.ownerDocument.createRange();\n          rng.setStart(caretContainerNode, 0);\n          rng.setEnd(caretContainerNode, 0);\n        } else {\n          caretContainerNode = insertInline(element, before);\n          rng = element.ownerDocument.createRange();\n          if (isInlineFakeCaretTarget(caretContainerNode.nextSibling)) {\n            rng.setStart(caretContainerNode, 0);\n            rng.setEnd(caretContainerNode, 0);\n          } else {\n            rng.setStart(caretContainerNode, 1);\n            rng.setEnd(caretContainerNode, 1);\n          }\n          return rng;\n        }\n        return rng;\n      };\n      var hide = function () {\n        trimInlineCaretContainers(root);\n        if (caretContainerNode) {\n          remove$5(caretContainerNode);\n          caretContainerNode = null;\n        }\n        lastVisualCaret.get().each(function (caretState) {\n          DomQuery(caretState.caret).remove();\n          lastVisualCaret.set(Optional.none());\n        });\n        if (cursorInterval) {\n          Delay.clearInterval(cursorInterval);\n          cursorInterval = null;\n        }\n      };\n      var startBlink = function () {\n        cursorInterval = Delay.setInterval(function () {\n          if (hasFocus()) {\n            DomQuery('div.mce-visual-caret', root).toggleClass('mce-visual-caret-hidden');\n          } else {\n            DomQuery('div.mce-visual-caret', root).addClass('mce-visual-caret-hidden');\n          }\n        }, 500);\n      };\n      var reposition = function () {\n        lastVisualCaret.get().each(function (caretState) {\n          var clientRect = getAbsoluteClientRect(root, caretState.element, caretState.before);\n          DomQuery(caretState.caret).css(__assign({}, clientRect));\n        });\n      };\n      var destroy = function () {\n        return Delay.clearInterval(cursorInterval);\n      };\n      var getCss = function () {\n        return '.mce-visual-caret {' + 'position: absolute;' + 'background-color: black;' + 'background-color: currentcolor;' + '}' + '.mce-visual-caret-hidden {' + 'display: none;' + '}' + '*[data-mce-caret] {' + 'position: absolute;' + 'left: -1000px;' + 'right: auto;' + 'top: 0;' + 'margin: 0;' + 'padding: 0;' + '}';\n      };\n      return {\n        show: show,\n        hide: hide,\n        getCss: getCss,\n        reposition: reposition,\n        destroy: destroy\n      };\n    };\n    var isFakeCaretTableBrowser = function () {\n      return browser$2.isIE() || browser$2.isEdge() || browser$2.isFirefox();\n    };\n    var isInlineFakeCaretTarget = function (node) {\n      return isContentEditableFalse$3(node) || isMedia$1(node);\n    };\n    var isFakeCaretTarget = function (node) {\n      return isInlineFakeCaretTarget(node) || isTable(node) && isFakeCaretTableBrowser();\n    };\n\n    var isContentEditableFalse$4 = isContentEditableFalse;\n    var isMedia$2 = isMedia;\n    var isBlockLike = matchStyleValues('display', 'block table table-cell table-caption list-item');\n    var isCaretContainer$2 = isCaretContainer;\n    var isCaretContainerBlock$1 = isCaretContainerBlock;\n    var isElement$5 = isElement$1;\n    var isCaretCandidate$2 = isCaretCandidate;\n    var isForwards = function (direction) {\n      return direction > 0;\n    };\n    var isBackwards = function (direction) {\n      return direction < 0;\n    };\n    var skipCaretContainers = function (walk, shallow) {\n      var node;\n      while (node = walk(shallow)) {\n        if (!isCaretContainerBlock$1(node)) {\n          return node;\n        }\n      }\n      return null;\n    };\n    var findNode = function (node, direction, predicateFn, rootNode, shallow) {\n      var walker = new DomTreeWalker(node, rootNode);\n      var isCefOrCaretContainer = isContentEditableFalse$4(node) || isCaretContainerBlock$1(node);\n      if (isBackwards(direction)) {\n        if (isCefOrCaretContainer) {\n          node = skipCaretContainers(walker.prev.bind(walker), true);\n          if (predicateFn(node)) {\n            return node;\n          }\n        }\n        while (node = skipCaretContainers(walker.prev.bind(walker), shallow)) {\n          if (predicateFn(node)) {\n            return node;\n          }\n        }\n      }\n      if (isForwards(direction)) {\n        if (isCefOrCaretContainer) {\n          node = skipCaretContainers(walker.next.bind(walker), true);\n          if (predicateFn(node)) {\n            return node;\n          }\n        }\n        while (node = skipCaretContainers(walker.next.bind(walker), shallow)) {\n          if (predicateFn(node)) {\n            return node;\n          }\n        }\n      }\n      return null;\n    };\n    var getParentBlock = function (node, rootNode) {\n      while (node && node !== rootNode) {\n        if (isBlockLike(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var isInSameBlock = function (caretPosition1, caretPosition2, rootNode) {\n      return getParentBlock(caretPosition1.container(), rootNode) === getParentBlock(caretPosition2.container(), rootNode);\n    };\n    var getChildNodeAtRelativeOffset = function (relativeOffset, caretPosition) {\n      if (!caretPosition) {\n        return null;\n      }\n      var container = caretPosition.container();\n      var offset = caretPosition.offset();\n      if (!isElement$5(container)) {\n        return null;\n      }\n      return container.childNodes[offset + relativeOffset];\n    };\n    var beforeAfter = function (before, node) {\n      var range = node.ownerDocument.createRange();\n      if (before) {\n        range.setStartBefore(node);\n        range.setEndBefore(node);\n      } else {\n        range.setStartAfter(node);\n        range.setEndAfter(node);\n      }\n      return range;\n    };\n    var isNodesInSameBlock = function (root, node1, node2) {\n      return getParentBlock(node1, root) === getParentBlock(node2, root);\n    };\n    var lean = function (left, root, node) {\n      var sibling, siblingName;\n      if (left) {\n        siblingName = 'previousSibling';\n      } else {\n        siblingName = 'nextSibling';\n      }\n      while (node && node !== root) {\n        sibling = node[siblingName];\n        if (isCaretContainer$2(sibling)) {\n          sibling = sibling[siblingName];\n        }\n        if (isContentEditableFalse$4(sibling) || isMedia$2(sibling)) {\n          if (isNodesInSameBlock(root, sibling, node)) {\n            return sibling;\n          }\n          break;\n        }\n        if (isCaretCandidate$2(sibling)) {\n          break;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var before$2 = curry(beforeAfter, true);\n    var after$1 = curry(beforeAfter, false);\n    var normalizeRange = function (direction, root, range) {\n      var node, container, location;\n      var leanLeft = curry(lean, true, root);\n      var leanRight = curry(lean, false, root);\n      container = range.startContainer;\n      var offset = range.startOffset;\n      if (isCaretContainerBlock(container)) {\n        if (!isElement$5(container)) {\n          container = container.parentNode;\n        }\n        location = container.getAttribute('data-mce-caret');\n        if (location === 'before') {\n          node = container.nextSibling;\n          if (isFakeCaretTarget(node)) {\n            return before$2(node);\n          }\n        }\n        if (location === 'after') {\n          node = container.previousSibling;\n          if (isFakeCaretTarget(node)) {\n            return after$1(node);\n          }\n        }\n      }\n      if (!range.collapsed) {\n        return range;\n      }\n      if (isText$1(container)) {\n        if (isCaretContainer$2(container)) {\n          if (direction === 1) {\n            node = leanRight(container);\n            if (node) {\n              return before$2(node);\n            }\n            node = leanLeft(container);\n            if (node) {\n              return after$1(node);\n            }\n          }\n          if (direction === -1) {\n            node = leanLeft(container);\n            if (node) {\n              return after$1(node);\n            }\n            node = leanRight(container);\n            if (node) {\n              return before$2(node);\n            }\n          }\n          return range;\n        }\n        if (endsWithCaretContainer(container) && offset >= container.data.length - 1) {\n          if (direction === 1) {\n            node = leanRight(container);\n            if (node) {\n              return before$2(node);\n            }\n          }\n          return range;\n        }\n        if (startsWithCaretContainer(container) && offset <= 1) {\n          if (direction === -1) {\n            node = leanLeft(container);\n            if (node) {\n              return after$1(node);\n            }\n          }\n          return range;\n        }\n        if (offset === container.data.length) {\n          node = leanRight(container);\n          if (node) {\n            return before$2(node);\n          }\n          return range;\n        }\n        if (offset === 0) {\n          node = leanLeft(container);\n          if (node) {\n            return after$1(node);\n          }\n          return range;\n        }\n      }\n      return range;\n    };\n    var getRelativeCefElm = function (forward, caretPosition) {\n      return Optional.from(getChildNodeAtRelativeOffset(forward ? 0 : -1, caretPosition)).filter(isContentEditableFalse$4);\n    };\n    var getNormalizedRangeEndPoint = function (direction, root, range) {\n      var normalizedRange = normalizeRange(direction, root, range);\n      if (direction === -1) {\n        return CaretPosition.fromRangeStart(normalizedRange);\n      }\n      return CaretPosition.fromRangeEnd(normalizedRange);\n    };\n    var getElementFromPosition = function (pos) {\n      return Optional.from(pos.getNode()).map(SugarElement.fromDom);\n    };\n    var getElementFromPrevPosition = function (pos) {\n      return Optional.from(pos.getNode(true)).map(SugarElement.fromDom);\n    };\n    var getVisualCaretPosition = function (walkFn, caretPosition) {\n      while (caretPosition = walkFn(caretPosition)) {\n        if (caretPosition.isVisible()) {\n          return caretPosition;\n        }\n      }\n      return caretPosition;\n    };\n    var isMoveInsideSameBlock = function (from, to) {\n      var inSameBlock = isInSameBlock(from, to);\n      if (!inSameBlock && isBr(from.getNode())) {\n        return true;\n      }\n      return inSameBlock;\n    };\n\n    var HDirection;\n    (function (HDirection) {\n      HDirection[HDirection['Backwards'] = -1] = 'Backwards';\n      HDirection[HDirection['Forwards'] = 1] = 'Forwards';\n    }(HDirection || (HDirection = {})));\n    var isContentEditableFalse$5 = isContentEditableFalse;\n    var isText$7 = isText$1;\n    var isElement$6 = isElement$1;\n    var isBr$4 = isBr;\n    var isCaretCandidate$3 = isCaretCandidate;\n    var isAtomic$1 = isAtomic;\n    var isEditableCaretCandidate$1 = isEditableCaretCandidate;\n    var getParents = function (node, root) {\n      var parents = [];\n      while (node && node !== root) {\n        parents.push(node);\n        node = node.parentNode;\n      }\n      return parents;\n    };\n    var nodeAtIndex = function (container, offset) {\n      if (container.hasChildNodes() && offset < container.childNodes.length) {\n        return container.childNodes[offset];\n      }\n      return null;\n    };\n    var getCaretCandidatePosition = function (direction, node) {\n      if (isForwards(direction)) {\n        if (isCaretCandidate$3(node.previousSibling) && !isText$7(node.previousSibling)) {\n          return CaretPosition.before(node);\n        }\n        if (isText$7(node)) {\n          return CaretPosition(node, 0);\n        }\n      }\n      if (isBackwards(direction)) {\n        if (isCaretCandidate$3(node.nextSibling) && !isText$7(node.nextSibling)) {\n          return CaretPosition.after(node);\n        }\n        if (isText$7(node)) {\n          return CaretPosition(node, node.data.length);\n        }\n      }\n      if (isBackwards(direction)) {\n        if (isBr$4(node)) {\n          return CaretPosition.before(node);\n        }\n        return CaretPosition.after(node);\n      }\n      return CaretPosition.before(node);\n    };\n    var moveForwardFromBr = function (root, nextNode) {\n      var nextSibling = nextNode.nextSibling;\n      if (nextSibling && isCaretCandidate$3(nextSibling)) {\n        if (isText$7(nextSibling)) {\n          return CaretPosition(nextSibling, 0);\n        } else {\n          return CaretPosition.before(nextSibling);\n        }\n      } else {\n        return findCaretPosition(HDirection.Forwards, CaretPosition.after(nextNode), root);\n      }\n    };\n    var findCaretPosition = function (direction, startPos, root) {\n      var node, nextNode, innerNode;\n      var caretPosition;\n      if (!isElement$6(root) || !startPos) {\n        return null;\n      }\n      if (startPos.isEqual(CaretPosition.after(root)) && root.lastChild) {\n        caretPosition = CaretPosition.after(root.lastChild);\n        if (isBackwards(direction) && isCaretCandidate$3(root.lastChild) && isElement$6(root.lastChild)) {\n          return isBr$4(root.lastChild) ? CaretPosition.before(root.lastChild) : caretPosition;\n        }\n      } else {\n        caretPosition = startPos;\n      }\n      var container = caretPosition.container();\n      var offset = caretPosition.offset();\n      if (isText$7(container)) {\n        if (isBackwards(direction) && offset > 0) {\n          return CaretPosition(container, --offset);\n        }\n        if (isForwards(direction) && offset < container.length) {\n          return CaretPosition(container, ++offset);\n        }\n        node = container;\n      } else {\n        if (isBackwards(direction) && offset > 0) {\n          nextNode = nodeAtIndex(container, offset - 1);\n          if (isCaretCandidate$3(nextNode)) {\n            if (!isAtomic$1(nextNode)) {\n              innerNode = findNode(nextNode, direction, isEditableCaretCandidate$1, nextNode);\n              if (innerNode) {\n                if (isText$7(innerNode)) {\n                  return CaretPosition(innerNode, innerNode.data.length);\n                }\n                return CaretPosition.after(innerNode);\n              }\n            }\n            if (isText$7(nextNode)) {\n              return CaretPosition(nextNode, nextNode.data.length);\n            }\n            return CaretPosition.before(nextNode);\n          }\n        }\n        if (isForwards(direction) && offset < container.childNodes.length) {\n          nextNode = nodeAtIndex(container, offset);\n          if (isCaretCandidate$3(nextNode)) {\n            if (isBr$4(nextNode)) {\n              return moveForwardFromBr(root, nextNode);\n            }\n            if (!isAtomic$1(nextNode)) {\n              innerNode = findNode(nextNode, direction, isEditableCaretCandidate$1, nextNode);\n              if (innerNode) {\n                if (isText$7(innerNode)) {\n                  return CaretPosition(innerNode, 0);\n                }\n                return CaretPosition.before(innerNode);\n              }\n            }\n            if (isText$7(nextNode)) {\n              return CaretPosition(nextNode, 0);\n            }\n            return CaretPosition.after(nextNode);\n          }\n        }\n        node = nextNode ? nextNode : caretPosition.getNode();\n      }\n      if (isForwards(direction) && caretPosition.isAtEnd() || isBackwards(direction) && caretPosition.isAtStart()) {\n        node = findNode(node, direction, always, root, true);\n        if (isEditableCaretCandidate$1(node, root)) {\n          return getCaretCandidatePosition(direction, node);\n        }\n      }\n      nextNode = findNode(node, direction, isEditableCaretCandidate$1, root);\n      var rootContentEditableFalseElm = last$1(filter(getParents(container, root), isContentEditableFalse$5));\n      if (rootContentEditableFalseElm && (!nextNode || !rootContentEditableFalseElm.contains(nextNode))) {\n        if (isForwards(direction)) {\n          caretPosition = CaretPosition.after(rootContentEditableFalseElm);\n        } else {\n          caretPosition = CaretPosition.before(rootContentEditableFalseElm);\n        }\n        return caretPosition;\n      }\n      if (nextNode) {\n        return getCaretCandidatePosition(direction, nextNode);\n      }\n      return null;\n    };\n    var CaretWalker = function (root) {\n      return {\n        next: function (caretPosition) {\n          return findCaretPosition(HDirection.Forwards, caretPosition, root);\n        },\n        prev: function (caretPosition) {\n          return findCaretPosition(HDirection.Backwards, caretPosition, root);\n        }\n      };\n    };\n\n    var walkToPositionIn = function (forward, root, start) {\n      var position = forward ? CaretPosition.before(start) : CaretPosition.after(start);\n      return fromPosition(forward, root, position);\n    };\n    var afterElement = function (node) {\n      return isBr(node) ? CaretPosition.before(node) : CaretPosition.after(node);\n    };\n    var isBeforeOrStart = function (position) {\n      if (CaretPosition.isTextPosition(position)) {\n        return position.offset() === 0;\n      } else {\n        return isCaretCandidate(position.getNode());\n      }\n    };\n    var isAfterOrEnd = function (position) {\n      if (CaretPosition.isTextPosition(position)) {\n        var container = position.container();\n        return position.offset() === container.data.length;\n      } else {\n        return isCaretCandidate(position.getNode(true));\n      }\n    };\n    var isBeforeAfterSameElement = function (from, to) {\n      return !CaretPosition.isTextPosition(from) && !CaretPosition.isTextPosition(to) && from.getNode() === to.getNode(true);\n    };\n    var isAtBr = function (position) {\n      return !CaretPosition.isTextPosition(position) && isBr(position.getNode());\n    };\n    var shouldSkipPosition = function (forward, from, to) {\n      if (forward) {\n        return !isBeforeAfterSameElement(from, to) && !isAtBr(from) && isAfterOrEnd(from) && isBeforeOrStart(to);\n      } else {\n        return !isBeforeAfterSameElement(to, from) && isBeforeOrStart(from) && isAfterOrEnd(to);\n      }\n    };\n    var fromPosition = function (forward, root, pos) {\n      var walker = CaretWalker(root);\n      return Optional.from(forward ? walker.next(pos) : walker.prev(pos));\n    };\n    var navigate = function (forward, root, from) {\n      return fromPosition(forward, root, from).bind(function (to) {\n        if (isInSameBlock(from, to, root) && shouldSkipPosition(forward, from, to)) {\n          return fromPosition(forward, root, to);\n        } else {\n          return Optional.some(to);\n        }\n      });\n    };\n    var navigateIgnore = function (forward, root, from, ignoreFilter) {\n      return navigate(forward, root, from).bind(function (pos) {\n        return ignoreFilter(pos) ? navigateIgnore(forward, root, pos, ignoreFilter) : Optional.some(pos);\n      });\n    };\n    var positionIn = function (forward, element) {\n      var startNode = forward ? element.firstChild : element.lastChild;\n      if (isText$1(startNode)) {\n        return Optional.some(CaretPosition(startNode, forward ? 0 : startNode.data.length));\n      } else if (startNode) {\n        if (isCaretCandidate(startNode)) {\n          return Optional.some(forward ? CaretPosition.before(startNode) : afterElement(startNode));\n        } else {\n          return walkToPositionIn(forward, element, startNode);\n        }\n      } else {\n        return Optional.none();\n      }\n    };\n    var nextPosition = curry(fromPosition, true);\n    var prevPosition = curry(fromPosition, false);\n    var firstPositionIn = curry(positionIn, true);\n    var lastPositionIn = curry(positionIn, false);\n\n    var CARET_ID = '_mce_caret';\n    var isCaretNode = function (node) {\n      return isElement$1(node) && node.id === CARET_ID;\n    };\n    var getParentCaretContainer = function (body, node) {\n      while (node && node !== body) {\n        if (node.id === CARET_ID) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n\n    var isStringPathBookmark = function (bookmark) {\n      return isString(bookmark.start);\n    };\n    var isRangeBookmark = function (bookmark) {\n      return bookmark.hasOwnProperty('rng');\n    };\n    var isIdBookmark = function (bookmark) {\n      return bookmark.hasOwnProperty('id');\n    };\n    var isIndexBookmark = function (bookmark) {\n      return bookmark.hasOwnProperty('name');\n    };\n    var isPathBookmark = function (bookmark) {\n      return Tools.isArray(bookmark.start);\n    };\n\n    var addBogus = function (dom, node) {\n      if (isElement$1(node) && dom.isBlock(node) && !node.innerHTML && !Env.ie) {\n        node.innerHTML = '<br data-mce-bogus=\"1\" />';\n      }\n      return node;\n    };\n    var resolveCaretPositionBookmark = function (dom, bookmark) {\n      var pos;\n      var rng = dom.createRng();\n      pos = resolve$1(dom.getRoot(), bookmark.start);\n      rng.setStart(pos.container(), pos.offset());\n      pos = resolve$1(dom.getRoot(), bookmark.end);\n      rng.setEnd(pos.container(), pos.offset());\n      return rng;\n    };\n    var insertZwsp = function (node, rng) {\n      var textNode = node.ownerDocument.createTextNode(ZWSP);\n      node.appendChild(textNode);\n      rng.setStart(textNode, 0);\n      rng.setEnd(textNode, 0);\n    };\n    var isEmpty$1 = function (node) {\n      return node.hasChildNodes() === false;\n    };\n    var tryFindRangePosition = function (node, rng) {\n      return lastPositionIn(node).fold(never, function (pos) {\n        rng.setStart(pos.container(), pos.offset());\n        rng.setEnd(pos.container(), pos.offset());\n        return true;\n      });\n    };\n    var padEmptyCaretContainer = function (root, node, rng) {\n      if (isEmpty$1(node) && getParentCaretContainer(root, node)) {\n        insertZwsp(node, rng);\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var setEndPoint = function (dom, start, bookmark, rng) {\n      var point = bookmark[start ? 'start' : 'end'];\n      var i, node, offset, children;\n      var root = dom.getRoot();\n      if (point) {\n        offset = point[0];\n        for (node = root, i = point.length - 1; i >= 1; i--) {\n          children = node.childNodes;\n          if (padEmptyCaretContainer(root, node, rng)) {\n            return true;\n          }\n          if (point[i] > children.length - 1) {\n            if (padEmptyCaretContainer(root, node, rng)) {\n              return true;\n            }\n            return tryFindRangePosition(node, rng);\n          }\n          node = children[point[i]];\n        }\n        if (node.nodeType === 3) {\n          offset = Math.min(point[0], node.nodeValue.length);\n        }\n        if (node.nodeType === 1) {\n          offset = Math.min(point[0], node.childNodes.length);\n        }\n        if (start) {\n          rng.setStart(node, offset);\n        } else {\n          rng.setEnd(node, offset);\n        }\n      }\n      return true;\n    };\n    var isValidTextNode = function (node) {\n      return isText$1(node) && node.data.length > 0;\n    };\n    var restoreEndPoint = function (dom, suffix, bookmark) {\n      var marker = dom.get(bookmark.id + '_' + suffix), node, idx, next, prev;\n      var keep = bookmark.keep;\n      var container, offset;\n      if (marker) {\n        node = marker.parentNode;\n        if (suffix === 'start') {\n          if (!keep) {\n            idx = dom.nodeIndex(marker);\n          } else {\n            if (marker.hasChildNodes()) {\n              node = marker.firstChild;\n              idx = 1;\n            } else if (isValidTextNode(marker.nextSibling)) {\n              node = marker.nextSibling;\n              idx = 0;\n            } else if (isValidTextNode(marker.previousSibling)) {\n              node = marker.previousSibling;\n              idx = marker.previousSibling.data.length;\n            } else {\n              node = marker.parentNode;\n              idx = dom.nodeIndex(marker) + 1;\n            }\n          }\n          container = node;\n          offset = idx;\n        } else {\n          if (!keep) {\n            idx = dom.nodeIndex(marker);\n          } else {\n            if (marker.hasChildNodes()) {\n              node = marker.firstChild;\n              idx = 1;\n            } else if (isValidTextNode(marker.previousSibling)) {\n              node = marker.previousSibling;\n              idx = marker.previousSibling.data.length;\n            } else {\n              node = marker.parentNode;\n              idx = dom.nodeIndex(marker);\n            }\n          }\n          container = node;\n          offset = idx;\n        }\n        if (!keep) {\n          prev = marker.previousSibling;\n          next = marker.nextSibling;\n          Tools.each(Tools.grep(marker.childNodes), function (node) {\n            if (isText$1(node)) {\n              node.nodeValue = node.nodeValue.replace(/\\uFEFF/g, '');\n            }\n          });\n          while (marker = dom.get(bookmark.id + '_' + suffix)) {\n            dom.remove(marker, true);\n          }\n          if (prev && next && prev.nodeType === next.nodeType && isText$1(prev) && !Env.opera) {\n            idx = prev.nodeValue.length;\n            prev.appendData(next.nodeValue);\n            dom.remove(next);\n            container = prev;\n            offset = idx;\n          }\n        }\n        return Optional.some(CaretPosition(container, offset));\n      } else {\n        return Optional.none();\n      }\n    };\n    var resolvePaths = function (dom, bookmark) {\n      var rng = dom.createRng();\n      if (setEndPoint(dom, true, bookmark, rng) && setEndPoint(dom, false, bookmark, rng)) {\n        return Optional.some(rng);\n      } else {\n        return Optional.none();\n      }\n    };\n    var resolveId = function (dom, bookmark) {\n      var startPos = restoreEndPoint(dom, 'start', bookmark);\n      var endPos = restoreEndPoint(dom, 'end', bookmark);\n      return lift2(startPos, endPos.or(startPos), function (spos, epos) {\n        var rng = dom.createRng();\n        rng.setStart(addBogus(dom, spos.container()), spos.offset());\n        rng.setEnd(addBogus(dom, epos.container()), epos.offset());\n        return rng;\n      });\n    };\n    var resolveIndex$1 = function (dom, bookmark) {\n      return Optional.from(dom.select(bookmark.name)[bookmark.index]).map(function (elm) {\n        var rng = dom.createRng();\n        rng.selectNode(elm);\n        return rng;\n      });\n    };\n    var resolve$2 = function (selection, bookmark) {\n      var dom = selection.dom;\n      if (bookmark) {\n        if (isPathBookmark(bookmark)) {\n          return resolvePaths(dom, bookmark);\n        } else if (isStringPathBookmark(bookmark)) {\n          return Optional.some(resolveCaretPositionBookmark(dom, bookmark));\n        } else if (isIdBookmark(bookmark)) {\n          return resolveId(dom, bookmark);\n        } else if (isIndexBookmark(bookmark)) {\n          return resolveIndex$1(dom, bookmark);\n        } else if (isRangeBookmark(bookmark)) {\n          return Optional.some(bookmark.rng);\n        }\n      }\n      return Optional.none();\n    };\n\n    var getBookmark$1 = function (selection, type, normalized) {\n      return getBookmark(selection, type, normalized);\n    };\n    var moveToBookmark = function (selection, bookmark) {\n      resolve$2(selection, bookmark).each(function (rng) {\n        selection.setRng(rng);\n      });\n    };\n    var isBookmarkNode$1 = function (node) {\n      return isElement$1(node) && node.tagName === 'SPAN' && node.getAttribute('data-mce-type') === 'bookmark';\n    };\n\n    var is$2 = function (expected) {\n      return function (actual) {\n        return expected === actual;\n      };\n    };\n    var isNbsp = is$2(nbsp);\n    var isWhiteSpace$1 = function (chr) {\n      return chr !== '' && ' \\f\\n\\r\\t\\x0B'.indexOf(chr) !== -1;\n    };\n    var isContent$1 = function (chr) {\n      return !isWhiteSpace$1(chr) && !isNbsp(chr);\n    };\n\n    var isNode = function (node) {\n      return !!node.nodeType;\n    };\n    var isInlineBlock = function (node) {\n      return node && /^(IMG)$/.test(node.nodeName);\n    };\n    var moveStart = function (dom, selection, rng) {\n      var offset = rng.startOffset;\n      var container = rng.startContainer, walker, node, nodes;\n      if (rng.startContainer === rng.endContainer) {\n        if (isInlineBlock(rng.startContainer.childNodes[rng.startOffset])) {\n          return;\n        }\n      }\n      if (container.nodeType === 1) {\n        nodes = container.childNodes;\n        if (offset < nodes.length) {\n          container = nodes[offset];\n          walker = new DomTreeWalker(container, dom.getParent(container, dom.isBlock));\n        } else {\n          container = nodes[nodes.length - 1];\n          walker = new DomTreeWalker(container, dom.getParent(container, dom.isBlock));\n          walker.next(true);\n        }\n        for (node = walker.current(); node; node = walker.next()) {\n          if (node.nodeType === 3 && !isWhiteSpaceNode(node)) {\n            rng.setStart(node, 0);\n            selection.setRng(rng);\n            return;\n          }\n        }\n      }\n    };\n    var getNonWhiteSpaceSibling = function (node, next, inc) {\n      if (node) {\n        var nextName = next ? 'nextSibling' : 'previousSibling';\n        for (node = inc ? node : node[nextName]; node; node = node[nextName]) {\n          if (node.nodeType === 1 || !isWhiteSpaceNode(node)) {\n            return node;\n          }\n        }\n      }\n    };\n    var isTextBlock$1 = function (editor, name) {\n      if (isNode(name)) {\n        name = name.nodeName;\n      }\n      return !!editor.schema.getTextBlockElements()[name.toLowerCase()];\n    };\n    var isValid = function (ed, parent, child) {\n      return ed.schema.isValidChild(parent, child);\n    };\n    var isWhiteSpaceNode = function (node, allowSpaces) {\n      if (allowSpaces === void 0) {\n        allowSpaces = false;\n      }\n      if (isNonNullable(node) && isText$1(node)) {\n        var data = allowSpaces ? node.data.replace(/ /g, '\\xA0') : node.data;\n        return isWhitespaceText(data);\n      } else {\n        return false;\n      }\n    };\n    var isEmptyTextNode = function (node) {\n      return isNonNullable(node) && isText$1(node) && node.length === 0;\n    };\n    var replaceVars = function (value, vars) {\n      if (typeof value !== 'string') {\n        value = value(vars);\n      } else if (vars) {\n        value = value.replace(/%(\\w+)/g, function (str, name) {\n          return vars[name] || str;\n        });\n      }\n      return value;\n    };\n    var isEq = function (str1, str2) {\n      str1 = str1 || '';\n      str2 = str2 || '';\n      str1 = '' + (str1.nodeName || str1);\n      str2 = '' + (str2.nodeName || str2);\n      return str1.toLowerCase() === str2.toLowerCase();\n    };\n    var normalizeStyleValue = function (dom, value, name) {\n      if (name === 'color' || name === 'backgroundColor') {\n        value = dom.toHex(value);\n      }\n      if (name === 'fontWeight' && value === 700) {\n        value = 'bold';\n      }\n      if (name === 'fontFamily') {\n        value = value.replace(/[\\'\\\"]/g, '').replace(/,\\s+/g, ',');\n      }\n      return '' + value;\n    };\n    var getStyle = function (dom, node, name) {\n      return normalizeStyleValue(dom, dom.getStyle(node, name), name);\n    };\n    var getTextDecoration = function (dom, node) {\n      var decoration;\n      dom.getParent(node, function (n) {\n        decoration = dom.getStyle(n, 'text-decoration');\n        return decoration && decoration !== 'none';\n      });\n      return decoration;\n    };\n    var getParents$1 = function (dom, node, selector) {\n      return dom.getParents(node, selector, dom.getRoot());\n    };\n    var isVariableFormatName = function (editor, formatName) {\n      var hasVariableValues = function (format) {\n        var isVariableValue = function (val) {\n          return val.length > 1 && val.charAt(0) === '%';\n        };\n        return exists([\n          'styles',\n          'attributes'\n        ], function (key) {\n          return get$1(format, key).exists(function (field) {\n            var fieldValues = isArray(field) ? field : values(field);\n            return exists(fieldValues, isVariableValue);\n          });\n        });\n      };\n      return exists(editor.formatter.get(formatName), hasVariableValues);\n    };\n    var areSimilarFormats = function (editor, formatName, otherFormatName) {\n      var validKeys = [\n        'inline',\n        'block',\n        'selector',\n        'attributes',\n        'styles',\n        'classes'\n      ];\n      var filterObj = function (format) {\n        return filter$1(format, function (_, key) {\n          return exists(validKeys, function (validKey) {\n            return validKey === key;\n          });\n        });\n      };\n      return exists(editor.formatter.get(formatName), function (fmt1) {\n        var filteredFmt1 = filterObj(fmt1);\n        return exists(editor.formatter.get(otherFormatName), function (fmt2) {\n          var filteredFmt2 = filterObj(fmt2);\n          return equal(filteredFmt1, filteredFmt2);\n        });\n      });\n    };\n    var isBlockFormat = function (format) {\n      return hasNonNullableKey(format, 'block');\n    };\n    var isSelectorFormat = function (format) {\n      return hasNonNullableKey(format, 'selector');\n    };\n    var isInlineFormat = function (format) {\n      return hasNonNullableKey(format, 'inline');\n    };\n    var hasBlockChildren = function (dom, elm) {\n      return exists(elm.childNodes, dom.isBlock);\n    };\n\n    var isBookmarkNode$2 = isBookmarkNode$1;\n    var getParents$2 = getParents$1;\n    var isWhiteSpaceNode$1 = isWhiteSpaceNode;\n    var isTextBlock$2 = isTextBlock$1;\n    var isBogusBr = function (node) {\n      return isBr(node) && node.getAttribute('data-mce-bogus') && !node.nextSibling;\n    };\n    var findParentContentEditable = function (dom, node) {\n      var parent = node;\n      while (parent) {\n        if (isElement$1(parent) && dom.getContentEditable(parent)) {\n          return dom.getContentEditable(parent) === 'false' ? parent : node;\n        }\n        parent = parent.parentNode;\n      }\n      return node;\n    };\n    var walkText = function (start, node, offset, predicate) {\n      var str = node.data;\n      for (var i = offset; start ? i >= 0 : i < str.length; start ? i-- : i++) {\n        if (predicate(str.charAt(i))) {\n          return start ? i + 1 : i;\n        }\n      }\n      return -1;\n    };\n    var findSpace = function (start, node, offset) {\n      return walkText(start, node, offset, function (c) {\n        return isNbsp(c) || isWhiteSpace$1(c);\n      });\n    };\n    var findContent = function (start, node, offset) {\n      return walkText(start, node, offset, isContent$1);\n    };\n    var findWordEndPoint = function (dom, body, container, offset, start, includeTrailingSpaces) {\n      var lastTextNode;\n      var rootNode = dom.getParent(container, dom.isBlock) || body;\n      var walk = function (container, offset, pred) {\n        var textSeeker = TextSeeker(dom);\n        var walker = start ? textSeeker.backwards : textSeeker.forwards;\n        return Optional.from(walker(container, offset, function (text, textOffset) {\n          if (isBookmarkNode$2(text.parentNode)) {\n            return -1;\n          } else {\n            lastTextNode = text;\n            return pred(start, text, textOffset);\n          }\n        }, rootNode));\n      };\n      var spaceResult = walk(container, offset, findSpace);\n      return spaceResult.bind(function (result) {\n        return includeTrailingSpaces ? walk(result.container, result.offset + (start ? -1 : 0), findContent) : Optional.some(result);\n      }).orThunk(function () {\n        return lastTextNode ? Optional.some({\n          container: lastTextNode,\n          offset: start ? 0 : lastTextNode.length\n        }) : Optional.none();\n      });\n    };\n    var findSelectorEndPoint = function (dom, format, rng, container, siblingName) {\n      if (isText$1(container) && container.nodeValue.length === 0 && container[siblingName]) {\n        container = container[siblingName];\n      }\n      var parents = getParents$2(dom, container);\n      for (var i = 0; i < parents.length; i++) {\n        for (var y = 0; y < format.length; y++) {\n          var curFormat = format[y];\n          if ('collapsed' in curFormat && curFormat.collapsed !== rng.collapsed) {\n            continue;\n          }\n          if (dom.is(parents[i], curFormat.selector)) {\n            return parents[i];\n          }\n        }\n      }\n      return container;\n    };\n    var findBlockEndPoint = function (editor, format, container, siblingName) {\n      var node;\n      var dom = editor.dom;\n      var root = dom.getRoot();\n      if (!format[0].wrapper) {\n        node = dom.getParent(container, format[0].block, root);\n      }\n      if (!node) {\n        var scopeRoot = dom.getParent(container, 'LI,TD,TH');\n        node = dom.getParent(isText$1(container) ? container.parentNode : container, function (node) {\n          return node !== root && isTextBlock$2(editor, node);\n        }, scopeRoot);\n      }\n      if (node && format[0].wrapper) {\n        node = getParents$2(dom, node, 'ul,ol').reverse()[0] || node;\n      }\n      if (!node) {\n        node = container;\n        while (node[siblingName] && !dom.isBlock(node[siblingName])) {\n          node = node[siblingName];\n          if (isEq(node, 'br')) {\n            break;\n          }\n        }\n      }\n      return node || container;\n    };\n    var isAtBlockBoundary = function (dom, root, container, siblingName) {\n      var parent = container.parentNode;\n      if (isNonNullable(container[siblingName])) {\n        return false;\n      } else if (parent === root || isNullable(parent) || dom.isBlock(parent)) {\n        return true;\n      } else {\n        return isAtBlockBoundary(dom, root, parent, siblingName);\n      }\n    };\n    var findParentContainer = function (dom, format, container, offset, start) {\n      var parent = container;\n      var sibling;\n      var siblingName = start ? 'previousSibling' : 'nextSibling';\n      var root = dom.getRoot();\n      if (isText$1(container) && !isWhiteSpaceNode$1(container)) {\n        if (start ? offset > 0 : offset < container.data.length) {\n          return container;\n        }\n      }\n      while (true) {\n        if (!format[0].block_expand && dom.isBlock(parent)) {\n          return parent;\n        }\n        for (sibling = parent[siblingName]; sibling; sibling = sibling[siblingName]) {\n          var allowSpaces = isText$1(sibling) && !isAtBlockBoundary(dom, root, sibling, siblingName);\n          if (!isBookmarkNode$2(sibling) && !isBogusBr(sibling) && !isWhiteSpaceNode$1(sibling, allowSpaces)) {\n            return parent;\n          }\n        }\n        if (parent === root || parent.parentNode === root) {\n          container = parent;\n          break;\n        }\n        parent = parent.parentNode;\n      }\n      return container;\n    };\n    var isSelfOrParentBookmark = function (container) {\n      return isBookmarkNode$2(container.parentNode) || isBookmarkNode$2(container);\n    };\n    var expandRng = function (editor, rng, format, includeTrailingSpace) {\n      if (includeTrailingSpace === void 0) {\n        includeTrailingSpace = false;\n      }\n      var startContainer = rng.startContainer, startOffset = rng.startOffset, endContainer = rng.endContainer, endOffset = rng.endOffset;\n      var dom = editor.dom;\n      if (isElement$1(startContainer) && startContainer.hasChildNodes()) {\n        startContainer = getNode(startContainer, startOffset);\n        if (isText$1(startContainer)) {\n          startOffset = 0;\n        }\n      }\n      if (isElement$1(endContainer) && endContainer.hasChildNodes()) {\n        endContainer = getNode(endContainer, rng.collapsed ? endOffset : endOffset - 1);\n        if (isText$1(endContainer)) {\n          endOffset = endContainer.nodeValue.length;\n        }\n      }\n      startContainer = findParentContentEditable(dom, startContainer);\n      endContainer = findParentContentEditable(dom, endContainer);\n      if (isSelfOrParentBookmark(startContainer)) {\n        startContainer = isBookmarkNode$2(startContainer) ? startContainer : startContainer.parentNode;\n        if (rng.collapsed) {\n          startContainer = startContainer.previousSibling || startContainer;\n        } else {\n          startContainer = startContainer.nextSibling || startContainer;\n        }\n        if (isText$1(startContainer)) {\n          startOffset = rng.collapsed ? startContainer.length : 0;\n        }\n      }\n      if (isSelfOrParentBookmark(endContainer)) {\n        endContainer = isBookmarkNode$2(endContainer) ? endContainer : endContainer.parentNode;\n        if (rng.collapsed) {\n          endContainer = endContainer.nextSibling || endContainer;\n        } else {\n          endContainer = endContainer.previousSibling || endContainer;\n        }\n        if (isText$1(endContainer)) {\n          endOffset = rng.collapsed ? 0 : endContainer.length;\n        }\n      }\n      if (rng.collapsed) {\n        var startPoint = findWordEndPoint(dom, editor.getBody(), startContainer, startOffset, true, includeTrailingSpace);\n        startPoint.each(function (_a) {\n          var container = _a.container, offset = _a.offset;\n          startContainer = container;\n          startOffset = offset;\n        });\n        var endPoint = findWordEndPoint(dom, editor.getBody(), endContainer, endOffset, false, includeTrailingSpace);\n        endPoint.each(function (_a) {\n          var container = _a.container, offset = _a.offset;\n          endContainer = container;\n          endOffset = offset;\n        });\n      }\n      if (format[0].inline || format[0].block_expand) {\n        if (!format[0].inline || (!isText$1(startContainer) || startOffset === 0)) {\n          startContainer = findParentContainer(dom, format, startContainer, startOffset, true);\n        }\n        if (!format[0].inline || (!isText$1(endContainer) || endOffset === endContainer.nodeValue.length)) {\n          endContainer = findParentContainer(dom, format, endContainer, endOffset, false);\n        }\n      }\n      if (format[0].selector && format[0].expand !== false && !format[0].inline) {\n        startContainer = findSelectorEndPoint(dom, format, rng, startContainer, 'previousSibling');\n        endContainer = findSelectorEndPoint(dom, format, rng, endContainer, 'nextSibling');\n      }\n      if (format[0].block || format[0].selector) {\n        startContainer = findBlockEndPoint(editor, format, startContainer, 'previousSibling');\n        endContainer = findBlockEndPoint(editor, format, endContainer, 'nextSibling');\n        if (format[0].block) {\n          if (!dom.isBlock(startContainer)) {\n            startContainer = findParentContainer(dom, format, startContainer, startOffset, true);\n          }\n          if (!dom.isBlock(endContainer)) {\n            endContainer = findParentContainer(dom, format, endContainer, endOffset, false);\n          }\n        }\n      }\n      if (isElement$1(startContainer)) {\n        startOffset = dom.nodeIndex(startContainer);\n        startContainer = startContainer.parentNode;\n      }\n      if (isElement$1(endContainer)) {\n        endOffset = dom.nodeIndex(endContainer) + 1;\n        endContainer = endContainer.parentNode;\n      }\n      return {\n        startContainer: startContainer,\n        startOffset: startOffset,\n        endContainer: endContainer,\n        endOffset: endOffset\n      };\n    };\n\n    var clampToExistingChildren = function (container, index) {\n      var childNodes = container.childNodes;\n      if (index >= childNodes.length) {\n        index = childNodes.length - 1;\n      } else if (index < 0) {\n        index = 0;\n      }\n      return childNodes[index] || container;\n    };\n    var getEndChild = function (container, index) {\n      return clampToExistingChildren(container, index - 1);\n    };\n    var walk$1 = function (dom, rng, callback) {\n      var startContainer = rng.startContainer;\n      var startOffset = rng.startOffset;\n      var endContainer = rng.endContainer;\n      var endOffset = rng.endOffset;\n      var exclude = function (nodes) {\n        var node;\n        node = nodes[0];\n        if (node.nodeType === 3 && node === startContainer && startOffset >= node.nodeValue.length) {\n          nodes.splice(0, 1);\n        }\n        node = nodes[nodes.length - 1];\n        if (endOffset === 0 && nodes.length > 0 && node === endContainer && node.nodeType === 3) {\n          nodes.splice(nodes.length - 1, 1);\n        }\n        return nodes;\n      };\n      var collectSiblings = function (node, name, endNode) {\n        var siblings = [];\n        for (; node && node !== endNode; node = node[name]) {\n          siblings.push(node);\n        }\n        return siblings;\n      };\n      var findEndPoint = function (node, root) {\n        do {\n          if (node.parentNode === root) {\n            return node;\n          }\n          node = node.parentNode;\n        } while (node);\n      };\n      var walkBoundary = function (startNode, endNode, next) {\n        var siblingName = next ? 'nextSibling' : 'previousSibling';\n        for (var node = startNode, parent_1 = node.parentNode; node && node !== endNode; node = parent_1) {\n          parent_1 = node.parentNode;\n          var siblings_1 = collectSiblings(node === startNode ? node : node[siblingName], siblingName);\n          if (siblings_1.length) {\n            if (!next) {\n              siblings_1.reverse();\n            }\n            callback(exclude(siblings_1));\n          }\n        }\n      };\n      if (startContainer.nodeType === 1 && startContainer.hasChildNodes()) {\n        startContainer = clampToExistingChildren(startContainer, startOffset);\n      }\n      if (endContainer.nodeType === 1 && endContainer.hasChildNodes()) {\n        endContainer = getEndChild(endContainer, endOffset);\n      }\n      if (startContainer === endContainer) {\n        return callback(exclude([startContainer]));\n      }\n      var ancestor = dom.findCommonAncestor(startContainer, endContainer);\n      for (var node = startContainer; node; node = node.parentNode) {\n        if (node === endContainer) {\n          return walkBoundary(startContainer, ancestor, true);\n        }\n        if (node === ancestor) {\n          break;\n        }\n      }\n      for (var node = endContainer; node; node = node.parentNode) {\n        if (node === startContainer) {\n          return walkBoundary(endContainer, ancestor);\n        }\n        if (node === ancestor) {\n          break;\n        }\n      }\n      var startPoint = findEndPoint(startContainer, ancestor) || startContainer;\n      var endPoint = findEndPoint(endContainer, ancestor) || endContainer;\n      walkBoundary(startContainer, startPoint, true);\n      var siblings = collectSiblings(startPoint === startContainer ? startPoint : startPoint.nextSibling, 'nextSibling', endPoint === endContainer ? endPoint.nextSibling : endPoint);\n      if (siblings.length) {\n        callback(exclude(siblings));\n      }\n      walkBoundary(endContainer, endPoint);\n    };\n\n    var getRanges = function (selection) {\n      var ranges = [];\n      if (selection) {\n        for (var i = 0; i < selection.rangeCount; i++) {\n          ranges.push(selection.getRangeAt(i));\n        }\n      }\n      return ranges;\n    };\n    var getSelectedNodes = function (ranges) {\n      return bind(ranges, function (range) {\n        var node = getSelectedNode(range);\n        return node ? [SugarElement.fromDom(node)] : [];\n      });\n    };\n    var hasMultipleRanges = function (selection) {\n      return getRanges(selection).length > 1;\n    };\n\n    var getCellsFromRanges = function (ranges) {\n      return filter(getSelectedNodes(ranges), isTableCell$1);\n    };\n    var getCellsFromElement = function (elm) {\n      return descendants$1(elm, 'td[data-mce-selected],th[data-mce-selected]');\n    };\n    var getCellsFromElementOrRanges = function (ranges, element) {\n      var selectedCells = getCellsFromElement(element);\n      return selectedCells.length > 0 ? selectedCells : getCellsFromRanges(ranges);\n    };\n    var getCellsFromEditor = function (editor) {\n      return getCellsFromElementOrRanges(getRanges(editor.selection.getSel()), SugarElement.fromDom(editor.getBody()));\n    };\n\n    var getStartNode = function (rng) {\n      var sc = rng.startContainer, so = rng.startOffset;\n      if (isText$1(sc)) {\n        return so === 0 ? Optional.some(SugarElement.fromDom(sc)) : Optional.none();\n      } else {\n        return Optional.from(sc.childNodes[so]).map(SugarElement.fromDom);\n      }\n    };\n    var getEndNode = function (rng) {\n      var ec = rng.endContainer, eo = rng.endOffset;\n      if (isText$1(ec)) {\n        return eo === ec.data.length ? Optional.some(SugarElement.fromDom(ec)) : Optional.none();\n      } else {\n        return Optional.from(ec.childNodes[eo - 1]).map(SugarElement.fromDom);\n      }\n    };\n    var getFirstChildren = function (node) {\n      return firstChild(node).fold(constant([node]), function (child) {\n        return [node].concat(getFirstChildren(child));\n      });\n    };\n    var getLastChildren = function (node) {\n      return lastChild(node).fold(constant([node]), function (child) {\n        if (name(child) === 'br') {\n          return prevSibling(child).map(function (sibling) {\n            return [node].concat(getLastChildren(sibling));\n          }).getOr([]);\n        } else {\n          return [node].concat(getLastChildren(child));\n        }\n      });\n    };\n    var hasAllContentsSelected = function (elm, rng) {\n      return lift2(getStartNode(rng), getEndNode(rng), function (startNode, endNode) {\n        var start = find(getFirstChildren(elm), curry(eq$2, startNode));\n        var end = find(getLastChildren(elm), curry(eq$2, endNode));\n        return start.isSome() && end.isSome();\n      }).getOr(false);\n    };\n    var moveEndPoint$1 = function (dom, rng, node, start) {\n      var root = node, walker = new DomTreeWalker(node, root);\n      var moveCaretBeforeOnEnterElementsMap = filter$1(dom.schema.getMoveCaretBeforeOnEnterElements(), function (_, name) {\n        return !contains([\n          'td',\n          'th',\n          'table'\n        ], name.toLowerCase());\n      });\n      do {\n        if (isText$1(node) && Tools.trim(node.nodeValue).length !== 0) {\n          if (start) {\n            rng.setStart(node, 0);\n          } else {\n            rng.setEnd(node, node.nodeValue.length);\n          }\n          return;\n        }\n        if (moveCaretBeforeOnEnterElementsMap[node.nodeName]) {\n          if (start) {\n            rng.setStartBefore(node);\n          } else {\n            if (node.nodeName === 'BR') {\n              rng.setEndBefore(node);\n            } else {\n              rng.setEndAfter(node);\n            }\n          }\n          return;\n        }\n      } while (node = start ? walker.next() : walker.prev());\n      if (root.nodeName === 'BODY') {\n        if (start) {\n          rng.setStart(root, 0);\n        } else {\n          rng.setEnd(root, root.childNodes.length);\n        }\n      }\n    };\n    var hasAnyRanges = function (editor) {\n      var sel = editor.selection.getSel();\n      return sel && sel.rangeCount > 0;\n    };\n    var runOnRanges = function (editor, executor) {\n      var fakeSelectionNodes = getCellsFromEditor(editor);\n      if (fakeSelectionNodes.length > 0) {\n        each(fakeSelectionNodes, function (elem) {\n          var node = elem.dom;\n          var fakeNodeRng = editor.dom.createRng();\n          fakeNodeRng.setStartBefore(node);\n          fakeNodeRng.setEndAfter(node);\n          executor(fakeNodeRng, true);\n        });\n      } else {\n        executor(editor.selection.getRng(), false);\n      }\n    };\n    var preserve = function (selection, fillBookmark, executor) {\n      var bookmark = getPersistentBookmark(selection, fillBookmark);\n      executor(bookmark);\n      selection.moveToBookmark(bookmark);\n    };\n\n    var NodeValue = function (is, name) {\n      var get = function (element) {\n        if (!is(element)) {\n          throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n        }\n        return getOption(element).getOr('');\n      };\n      var getOption = function (element) {\n        return is(element) ? Optional.from(element.dom.nodeValue) : Optional.none();\n      };\n      var set = function (element, value) {\n        if (!is(element)) {\n          throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n        }\n        element.dom.nodeValue = value;\n      };\n      return {\n        get: get,\n        getOption: getOption,\n        set: set\n      };\n    };\n\n    var api = NodeValue(isText, 'text');\n    var get$8 = function (element) {\n      return api.get(element);\n    };\n\n    var isZeroWidth = function (elem) {\n      return isText(elem) && get$8(elem) === ZWSP;\n    };\n    var context = function (editor, elem, wrapName, nodeName) {\n      return parent(elem).fold(function () {\n        return 'skipping';\n      }, function (parent) {\n        if (nodeName === 'br' || isZeroWidth(elem)) {\n          return 'valid';\n        } else if (isAnnotation(elem)) {\n          return 'existing';\n        } else if (isCaretNode(elem.dom)) {\n          return 'caret';\n        } else if (!isValid(editor, wrapName, nodeName) || !isValid(editor, name(parent), wrapName)) {\n          return 'invalid-child';\n        } else {\n          return 'valid';\n        }\n      });\n    };\n\n    var applyWordGrab = function (editor, rng) {\n      var r = expandRng(editor, rng, [{ inline: true }]);\n      rng.setStart(r.startContainer, r.startOffset);\n      rng.setEnd(r.endContainer, r.endOffset);\n      editor.selection.setRng(rng);\n    };\n    var makeAnnotation = function (eDoc, _a, annotationName, decorate) {\n      var _b = _a.uid, uid = _b === void 0 ? generate$1('mce-annotation') : _b, data = __rest(_a, ['uid']);\n      var master = SugarElement.fromTag('span', eDoc);\n      add$3(master, annotation());\n      set(master, '' + dataAnnotationId(), uid);\n      set(master, '' + dataAnnotation(), annotationName);\n      var _c = decorate(uid, data), _d = _c.attributes, attributes = _d === void 0 ? {} : _d, _e = _c.classes, classes = _e === void 0 ? [] : _e;\n      setAll(master, attributes);\n      add$4(master, classes);\n      return master;\n    };\n    var annotate = function (editor, rng, annotationName, decorate, data) {\n      var newWrappers = [];\n      var master = makeAnnotation(editor.getDoc(), data, annotationName, decorate);\n      var wrapper = Cell(Optional.none());\n      var finishWrapper = function () {\n        wrapper.set(Optional.none());\n      };\n      var getOrOpenWrapper = function () {\n        return wrapper.get().getOrThunk(function () {\n          var nu = shallow(master);\n          newWrappers.push(nu);\n          wrapper.set(Optional.some(nu));\n          return nu;\n        });\n      };\n      var processElements = function (elems) {\n        each(elems, processElement);\n      };\n      var processElement = function (elem) {\n        var ctx = context(editor, elem, 'span', name(elem));\n        switch (ctx) {\n        case 'invalid-child': {\n            finishWrapper();\n            var children$1 = children(elem);\n            processElements(children$1);\n            finishWrapper();\n            break;\n          }\n        case 'valid': {\n            var w = getOrOpenWrapper();\n            wrap(elem, w);\n            break;\n          }\n        }\n      };\n      var processNodes = function (nodes) {\n        var elems = map(nodes, SugarElement.fromDom);\n        processElements(elems);\n      };\n      walk$1(editor.dom, rng, function (nodes) {\n        finishWrapper();\n        processNodes(nodes);\n      });\n      return newWrappers;\n    };\n    var annotateWithBookmark = function (editor, name, settings, data) {\n      editor.undoManager.transact(function () {\n        var selection = editor.selection;\n        var initialRng = selection.getRng();\n        var hasFakeSelection = getCellsFromEditor(editor).length > 0;\n        if (initialRng.collapsed && !hasFakeSelection) {\n          applyWordGrab(editor, initialRng);\n        }\n        if (selection.getRng().collapsed && !hasFakeSelection) {\n          var wrapper = makeAnnotation(editor.getDoc(), data, name, settings.decorate);\n          set$1(wrapper, nbsp);\n          selection.getRng().insertNode(wrapper.dom);\n          selection.select(wrapper.dom);\n        } else {\n          preserve(selection, false, function () {\n            runOnRanges(editor, function (selectionRng) {\n              annotate(editor, selectionRng, name, settings.decorate, data);\n            });\n          });\n        }\n      });\n    };\n\n    var Annotator = function (editor) {\n      var registry = create$2();\n      setup$1(editor, registry);\n      var changes = setup(editor);\n      return {\n        register: function (name, settings) {\n          registry.register(name, settings);\n        },\n        annotate: function (name, data) {\n          registry.lookup(name).each(function (settings) {\n            annotateWithBookmark(editor, name, settings, data);\n          });\n        },\n        annotationChanged: function (name, callback) {\n          changes.addListener(name, callback);\n        },\n        remove: function (name) {\n          identify(editor, Optional.some(name)).each(function (_a) {\n            var elements = _a.elements;\n            each(elements, unwrap);\n          });\n        },\n        getAll: function (name) {\n          var directory = findAll(editor, name);\n          return map$1(directory, function (elems) {\n            return map(elems, function (elem) {\n              return elem.dom;\n            });\n          });\n        }\n      };\n    };\n\n    var BookmarkManager = function (selection) {\n      return {\n        getBookmark: curry(getBookmark$1, selection),\n        moveToBookmark: curry(moveToBookmark, selection)\n      };\n    };\n    BookmarkManager.isBookmarkNode = isBookmarkNode$1;\n\n    var getContentEditableRoot = function (root, node) {\n      while (node && node !== root) {\n        if (isContentEditableTrue(node) || isContentEditableFalse(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n\n    var isXYWithinRange = function (clientX, clientY, range) {\n      if (range.collapsed) {\n        return false;\n      }\n      if (Env.browser.isIE() && range.startOffset === range.endOffset - 1 && range.startContainer === range.endContainer) {\n        var elm = range.startContainer.childNodes[range.startOffset];\n        if (isElement$1(elm)) {\n          return exists(elm.getClientRects(), function (rect) {\n            return containsXY(rect, clientX, clientY);\n          });\n        }\n      }\n      return exists(range.getClientRects(), function (rect) {\n        return containsXY(rect, clientX, clientY);\n      });\n    };\n\n    var firePreProcess = function (editor, args) {\n      return editor.fire('PreProcess', args);\n    };\n    var firePostProcess = function (editor, args) {\n      return editor.fire('PostProcess', args);\n    };\n    var fireRemove = function (editor) {\n      return editor.fire('remove');\n    };\n    var fireDetach = function (editor) {\n      return editor.fire('detach');\n    };\n    var fireSwitchMode = function (editor, mode) {\n      return editor.fire('SwitchMode', { mode: mode });\n    };\n    var fireObjectResizeStart = function (editor, target, width, height, origin) {\n      editor.fire('ObjectResizeStart', {\n        target: target,\n        width: width,\n        height: height,\n        origin: origin\n      });\n    };\n    var fireObjectResized = function (editor, target, width, height, origin) {\n      editor.fire('ObjectResized', {\n        target: target,\n        width: width,\n        height: height,\n        origin: origin\n      });\n    };\n    var firePreInit = function (editor) {\n      return editor.fire('PreInit');\n    };\n    var firePostRender = function (editor) {\n      return editor.fire('PostRender');\n    };\n    var fireInit = function (editor) {\n      return editor.fire('Init');\n    };\n    var firePlaceholderToggle = function (editor, state) {\n      return editor.fire('PlaceholderToggle', { state: state });\n    };\n    var fireError = function (editor, errorType, error) {\n      return editor.fire(errorType, error);\n    };\n\n    var VK = {\n      BACKSPACE: 8,\n      DELETE: 46,\n      DOWN: 40,\n      ENTER: 13,\n      LEFT: 37,\n      RIGHT: 39,\n      SPACEBAR: 32,\n      TAB: 9,\n      UP: 38,\n      PAGE_UP: 33,\n      PAGE_DOWN: 34,\n      END: 35,\n      HOME: 36,\n      modifierPressed: function (e) {\n        return e.shiftKey || e.ctrlKey || e.altKey || VK.metaKeyPressed(e);\n      },\n      metaKeyPressed: function (e) {\n        return Env.mac ? e.metaKey : e.ctrlKey && !e.altKey;\n      }\n    };\n\n    var isContentEditableFalse$6 = isContentEditableFalse;\n    var ControlSelection = function (selection, editor) {\n      var elementSelectionAttr = 'data-mce-selected';\n      var dom = editor.dom, each$2 = Tools.each;\n      var selectedElm, selectedElmGhost, resizeHelper, selectedHandle, resizeBackdrop;\n      var startX, startY, selectedElmX, selectedElmY, startW, startH, ratio, resizeStarted;\n      var width, height;\n      var editableDoc = editor.getDoc(), rootDocument = document;\n      var abs = Math.abs, round = Math.round, rootElement = editor.getBody();\n      var startScrollWidth, startScrollHeight;\n      var resizeHandles = {\n        nw: [\n          0,\n          0,\n          -1,\n          -1\n        ],\n        ne: [\n          1,\n          0,\n          1,\n          -1\n        ],\n        se: [\n          1,\n          1,\n          1,\n          1\n        ],\n        sw: [\n          0,\n          1,\n          -1,\n          1\n        ]\n      };\n      var isImage = function (elm) {\n        return elm && (elm.nodeName === 'IMG' || editor.dom.is(elm, 'figure.image'));\n      };\n      var isMedia$1 = function (elm) {\n        return isMedia(elm) || dom.hasClass(elm, 'mce-preview-object');\n      };\n      var isEventOnImageOutsideRange = function (evt, range) {\n        if (evt.type === 'longpress' || evt.type.indexOf('touch') === 0) {\n          var touch = evt.touches[0];\n          return isImage(evt.target) && !isXYWithinRange(touch.clientX, touch.clientY, range);\n        } else {\n          return isImage(evt.target) && !isXYWithinRange(evt.clientX, evt.clientY, range);\n        }\n      };\n      var contextMenuSelectImage = function (evt) {\n        var target = evt.target;\n        if (isEventOnImageOutsideRange(evt, editor.selection.getRng()) && !evt.isDefaultPrevented()) {\n          editor.selection.select(target);\n        }\n      };\n      var getResizeTargets = function (elm) {\n        if (dom.is(elm, 'figure.image')) {\n          return [elm.querySelector('img')];\n        } else if (dom.hasClass(elm, 'mce-preview-object') && isNonNullable(elm.firstElementChild)) {\n          return [\n            elm,\n            elm.firstElementChild\n          ];\n        } else {\n          return [elm];\n        }\n      };\n      var isResizable = function (elm) {\n        var selector = getObjectResizing(editor);\n        if (!selector) {\n          return false;\n        }\n        if (elm.getAttribute('data-mce-resize') === 'false') {\n          return false;\n        }\n        if (elm === editor.getBody()) {\n          return false;\n        }\n        if (dom.hasClass(elm, 'mce-preview-object')) {\n          return is$1(SugarElement.fromDom(elm.firstElementChild), selector);\n        } else {\n          return is$1(SugarElement.fromDom(elm), selector);\n        }\n      };\n      var createGhostElement = function (elm) {\n        if (isMedia$1(elm)) {\n          return dom.create('img', { src: Env.transparentSrc });\n        } else {\n          return elm.cloneNode(true);\n        }\n      };\n      var setSizeProp = function (element, name, value) {\n        if (isNonNullable(value)) {\n          var targets = getResizeTargets(element);\n          each(targets, function (target) {\n            if (target.style[name] || !editor.schema.isValid(target.nodeName.toLowerCase(), name)) {\n              dom.setStyle(target, name, value);\n            } else {\n              dom.setAttrib(target, name, '' + value);\n            }\n          });\n        }\n      };\n      var setGhostElmSize = function (ghostElm, width, height) {\n        setSizeProp(ghostElm, 'width', width);\n        setSizeProp(ghostElm, 'height', height);\n      };\n      var resizeGhostElement = function (e) {\n        var deltaX, deltaY, proportional;\n        var resizeHelperX, resizeHelperY;\n        deltaX = e.screenX - startX;\n        deltaY = e.screenY - startY;\n        width = deltaX * selectedHandle[2] + startW;\n        height = deltaY * selectedHandle[3] + startH;\n        width = width < 5 ? 5 : width;\n        height = height < 5 ? 5 : height;\n        if ((isImage(selectedElm) || isMedia$1(selectedElm)) && getResizeImgProportional(editor) !== false) {\n          proportional = !VK.modifierPressed(e);\n        } else {\n          proportional = VK.modifierPressed(e);\n        }\n        if (proportional) {\n          if (abs(deltaX) > abs(deltaY)) {\n            height = round(width * ratio);\n            width = round(height / ratio);\n          } else {\n            width = round(height / ratio);\n            height = round(width * ratio);\n          }\n        }\n        setGhostElmSize(selectedElmGhost, width, height);\n        resizeHelperX = selectedHandle.startPos.x + deltaX;\n        resizeHelperY = selectedHandle.startPos.y + deltaY;\n        resizeHelperX = resizeHelperX > 0 ? resizeHelperX : 0;\n        resizeHelperY = resizeHelperY > 0 ? resizeHelperY : 0;\n        dom.setStyles(resizeHelper, {\n          left: resizeHelperX,\n          top: resizeHelperY,\n          display: 'block'\n        });\n        resizeHelper.innerHTML = width + ' &times; ' + height;\n        if (selectedHandle[2] < 0 && selectedElmGhost.clientWidth <= width) {\n          dom.setStyle(selectedElmGhost, 'left', selectedElmX + (startW - width));\n        }\n        if (selectedHandle[3] < 0 && selectedElmGhost.clientHeight <= height) {\n          dom.setStyle(selectedElmGhost, 'top', selectedElmY + (startH - height));\n        }\n        deltaX = rootElement.scrollWidth - startScrollWidth;\n        deltaY = rootElement.scrollHeight - startScrollHeight;\n        if (deltaX + deltaY !== 0) {\n          dom.setStyles(resizeHelper, {\n            left: resizeHelperX - deltaX,\n            top: resizeHelperY - deltaY\n          });\n        }\n        if (!resizeStarted) {\n          fireObjectResizeStart(editor, selectedElm, startW, startH, 'corner-' + selectedHandle.name);\n          resizeStarted = true;\n        }\n      };\n      var endGhostResize = function () {\n        var wasResizeStarted = resizeStarted;\n        resizeStarted = false;\n        if (wasResizeStarted) {\n          setSizeProp(selectedElm, 'width', width);\n          setSizeProp(selectedElm, 'height', height);\n        }\n        dom.unbind(editableDoc, 'mousemove', resizeGhostElement);\n        dom.unbind(editableDoc, 'mouseup', endGhostResize);\n        if (rootDocument !== editableDoc) {\n          dom.unbind(rootDocument, 'mousemove', resizeGhostElement);\n          dom.unbind(rootDocument, 'mouseup', endGhostResize);\n        }\n        dom.remove(selectedElmGhost);\n        dom.remove(resizeHelper);\n        dom.remove(resizeBackdrop);\n        showResizeRect(selectedElm);\n        if (wasResizeStarted) {\n          fireObjectResized(editor, selectedElm, width, height, 'corner-' + selectedHandle.name);\n          dom.setAttrib(selectedElm, 'style', dom.getAttrib(selectedElm, 'style'));\n        }\n        editor.nodeChanged();\n      };\n      var showResizeRect = function (targetElm) {\n        unbindResizeHandleEvents();\n        var position = dom.getPos(targetElm, rootElement);\n        var selectedElmX = position.x;\n        var selectedElmY = position.y;\n        var rect = targetElm.getBoundingClientRect();\n        var targetWidth = rect.width || rect.right - rect.left;\n        var targetHeight = rect.height || rect.bottom - rect.top;\n        if (selectedElm !== targetElm) {\n          hideResizeRect();\n          selectedElm = targetElm;\n          width = height = 0;\n        }\n        var e = editor.fire('ObjectSelected', { target: targetElm });\n        var selectedValue = dom.getAttrib(selectedElm, elementSelectionAttr, '1');\n        if (isResizable(targetElm) && !e.isDefaultPrevented()) {\n          each$2(resizeHandles, function (handle, name) {\n            var handleElm;\n            var startDrag = function (e) {\n              var target = getResizeTargets(selectedElm)[0];\n              startX = e.screenX;\n              startY = e.screenY;\n              startW = target.clientWidth;\n              startH = target.clientHeight;\n              ratio = startH / startW;\n              selectedHandle = handle;\n              selectedHandle.name = name;\n              selectedHandle.startPos = {\n                x: targetWidth * handle[0] + selectedElmX,\n                y: targetHeight * handle[1] + selectedElmY\n              };\n              startScrollWidth = rootElement.scrollWidth;\n              startScrollHeight = rootElement.scrollHeight;\n              resizeBackdrop = dom.add(rootElement, 'div', { class: 'mce-resize-backdrop' });\n              dom.setStyles(resizeBackdrop, {\n                position: 'fixed',\n                left: '0',\n                top: '0',\n                width: '100%',\n                height: '100%'\n              });\n              selectedElmGhost = createGhostElement(selectedElm);\n              dom.addClass(selectedElmGhost, 'mce-clonedresizable');\n              dom.setAttrib(selectedElmGhost, 'data-mce-bogus', 'all');\n              selectedElmGhost.contentEditable = 'false';\n              dom.setStyles(selectedElmGhost, {\n                left: selectedElmX,\n                top: selectedElmY,\n                margin: 0\n              });\n              setGhostElmSize(selectedElmGhost, targetWidth, targetHeight);\n              selectedElmGhost.removeAttribute(elementSelectionAttr);\n              rootElement.appendChild(selectedElmGhost);\n              dom.bind(editableDoc, 'mousemove', resizeGhostElement);\n              dom.bind(editableDoc, 'mouseup', endGhostResize);\n              if (rootDocument !== editableDoc) {\n                dom.bind(rootDocument, 'mousemove', resizeGhostElement);\n                dom.bind(rootDocument, 'mouseup', endGhostResize);\n              }\n              resizeHelper = dom.add(rootElement, 'div', {\n                'class': 'mce-resize-helper',\n                'data-mce-bogus': 'all'\n              }, startW + ' &times; ' + startH);\n            };\n            handleElm = dom.get('mceResizeHandle' + name);\n            if (handleElm) {\n              dom.remove(handleElm);\n            }\n            handleElm = dom.add(rootElement, 'div', {\n              'id': 'mceResizeHandle' + name,\n              'data-mce-bogus': 'all',\n              'class': 'mce-resizehandle',\n              'unselectable': true,\n              'style': 'cursor:' + name + '-resize; margin:0; padding:0'\n            });\n            if (Env.ie === 11) {\n              handleElm.contentEditable = false;\n            }\n            dom.bind(handleElm, 'mousedown', function (e) {\n              e.stopImmediatePropagation();\n              e.preventDefault();\n              startDrag(e);\n            });\n            handle.elm = handleElm;\n            dom.setStyles(handleElm, {\n              left: targetWidth * handle[0] + selectedElmX - handleElm.offsetWidth / 2,\n              top: targetHeight * handle[1] + selectedElmY - handleElm.offsetHeight / 2\n            });\n          });\n        } else {\n          hideResizeRect();\n        }\n        if (!dom.getAttrib(selectedElm, elementSelectionAttr)) {\n          selectedElm.setAttribute(elementSelectionAttr, selectedValue);\n        }\n      };\n      var hideResizeRect = function () {\n        unbindResizeHandleEvents();\n        if (selectedElm) {\n          selectedElm.removeAttribute(elementSelectionAttr);\n        }\n        each$1(resizeHandles, function (value, name) {\n          var handleElm = dom.get('mceResizeHandle' + name);\n          if (handleElm) {\n            dom.unbind(handleElm);\n            dom.remove(handleElm);\n          }\n        });\n      };\n      var updateResizeRect = function (e) {\n        var startElm, controlElm;\n        var isChildOrEqual = function (node, parent) {\n          if (node) {\n            do {\n              if (node === parent) {\n                return true;\n              }\n            } while (node = node.parentNode);\n          }\n        };\n        if (resizeStarted || editor.removed) {\n          return;\n        }\n        each$2(dom.select('img[data-mce-selected],hr[data-mce-selected]'), function (img) {\n          img.removeAttribute(elementSelectionAttr);\n        });\n        controlElm = e.type === 'mousedown' ? e.target : selection.getNode();\n        controlElm = dom.$(controlElm).closest('table,img,figure.image,hr,video,span.mce-preview-object')[0];\n        if (isChildOrEqual(controlElm, rootElement)) {\n          disableGeckoResize();\n          startElm = selection.getStart(true);\n          if (isChildOrEqual(startElm, controlElm) && isChildOrEqual(selection.getEnd(true), controlElm)) {\n            showResizeRect(controlElm);\n            return;\n          }\n        }\n        hideResizeRect();\n      };\n      var isWithinContentEditableFalse = function (elm) {\n        return isContentEditableFalse$6(getContentEditableRoot(editor.getBody(), elm));\n      };\n      var unbindResizeHandleEvents = function () {\n        each$1(resizeHandles, function (handle) {\n          if (handle.elm) {\n            dom.unbind(handle.elm);\n            delete handle.elm;\n          }\n        });\n      };\n      var disableGeckoResize = function () {\n        try {\n          editor.getDoc().execCommand('enableObjectResizing', false, 'false');\n        } catch (ex) {\n        }\n      };\n      editor.on('init', function () {\n        disableGeckoResize();\n        if (Env.browser.isIE() || Env.browser.isEdge()) {\n          editor.on('mousedown click', function (e) {\n            var target = e.target, nodeName = target.nodeName;\n            if (!resizeStarted && /^(TABLE|IMG|HR)$/.test(nodeName) && !isWithinContentEditableFalse(target)) {\n              if (e.button !== 2) {\n                editor.selection.select(target, nodeName === 'TABLE');\n              }\n              if (e.type === 'mousedown') {\n                editor.nodeChanged();\n              }\n            }\n          });\n          var handleMSControlSelect_1 = function (e) {\n            var delayedSelect = function (node) {\n              Delay.setEditorTimeout(editor, function () {\n                return editor.selection.select(node);\n              });\n            };\n            if (isWithinContentEditableFalse(e.target) || isMedia(e.target)) {\n              e.preventDefault();\n              delayedSelect(e.target);\n              return;\n            }\n            if (/^(TABLE|IMG|HR)$/.test(e.target.nodeName)) {\n              e.preventDefault();\n              if (e.target.tagName === 'IMG') {\n                delayedSelect(e.target);\n              }\n            }\n          };\n          dom.bind(rootElement, 'mscontrolselect', handleMSControlSelect_1);\n          editor.on('remove', function () {\n            return dom.unbind(rootElement, 'mscontrolselect', handleMSControlSelect_1);\n          });\n        }\n        var throttledUpdateResizeRect = Delay.throttle(function (e) {\n          if (!editor.composing) {\n            updateResizeRect(e);\n          }\n        });\n        editor.on('nodechange ResizeEditor ResizeWindow ResizeContent drop FullscreenStateChanged', throttledUpdateResizeRect);\n        editor.on('keyup compositionend', function (e) {\n          if (selectedElm && selectedElm.nodeName === 'TABLE') {\n            throttledUpdateResizeRect(e);\n          }\n        });\n        editor.on('hide blur', hideResizeRect);\n        editor.on('contextmenu longpress', contextMenuSelectImage, true);\n      });\n      editor.on('remove', unbindResizeHandleEvents);\n      var destroy = function () {\n        selectedElm = selectedElmGhost = resizeBackdrop = null;\n      };\n      return {\n        isResizable: isResizable,\n        showResizeRect: showResizeRect,\n        hideResizeRect: hideResizeRect,\n        updateResizeRect: updateResizeRect,\n        destroy: destroy\n      };\n    };\n\n    var hasCeProperty = function (node) {\n      return isContentEditableTrue(node) || isContentEditableFalse(node);\n    };\n    var findParent = function (node, rootNode, predicate) {\n      while (node && node !== rootNode) {\n        if (predicate(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var findClosestIeRange = function (clientX, clientY, doc) {\n      var rects;\n      var element = doc.elementFromPoint(clientX, clientY);\n      var rng = doc.body.createTextRange();\n      if (!element || element.tagName === 'HTML') {\n        element = doc.body;\n      }\n      rng.moveToElementText(element);\n      rects = Tools.toArray(rng.getClientRects());\n      rects = rects.sort(function (a, b) {\n        a = Math.abs(Math.max(a.top - clientY, a.bottom - clientY));\n        b = Math.abs(Math.max(b.top - clientY, b.bottom - clientY));\n        return a - b;\n      });\n      if (rects.length > 0) {\n        clientY = (rects[0].bottom + rects[0].top) / 2;\n        try {\n          rng.moveToPoint(clientX, clientY);\n          rng.collapse(true);\n          return rng;\n        } catch (ex) {\n        }\n      }\n      return null;\n    };\n    var moveOutOfContentEditableFalse = function (rng, rootNode) {\n      var parentElement = rng && rng.parentElement ? rng.parentElement() : null;\n      return isContentEditableFalse(findParent(parentElement, rootNode, hasCeProperty)) ? null : rng;\n    };\n    var fromPoint$1 = function (clientX, clientY, doc) {\n      var rng, point;\n      var pointDoc = doc;\n      if (pointDoc.caretPositionFromPoint) {\n        point = pointDoc.caretPositionFromPoint(clientX, clientY);\n        if (point) {\n          rng = doc.createRange();\n          rng.setStart(point.offsetNode, point.offset);\n          rng.collapse(true);\n        }\n      } else if (doc.caretRangeFromPoint) {\n        rng = doc.caretRangeFromPoint(clientX, clientY);\n      } else if (pointDoc.body.createTextRange) {\n        rng = pointDoc.body.createTextRange();\n        try {\n          rng.moveToPoint(clientX, clientY);\n          rng.collapse(true);\n        } catch (ex) {\n          rng = findClosestIeRange(clientX, clientY, doc);\n        }\n        return moveOutOfContentEditableFalse(rng, doc.body);\n      }\n      return rng;\n    };\n\n    var isEq$1 = function (rng1, rng2) {\n      return rng1 && rng2 && (rng1.startContainer === rng2.startContainer && rng1.startOffset === rng2.startOffset) && (rng1.endContainer === rng2.endContainer && rng1.endOffset === rng2.endOffset);\n    };\n\n    var findParent$1 = function (node, rootNode, predicate) {\n      while (node && node !== rootNode) {\n        if (predicate(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var hasParent = function (node, rootNode, predicate) {\n      return findParent$1(node, rootNode, predicate) !== null;\n    };\n    var hasParentWithName = function (node, rootNode, name) {\n      return hasParent(node, rootNode, function (node) {\n        return node.nodeName === name;\n      });\n    };\n    var isTable$3 = function (node) {\n      return node && node.nodeName === 'TABLE';\n    };\n    var isTableCell$3 = function (node) {\n      return node && /^(TD|TH|CAPTION)$/.test(node.nodeName);\n    };\n    var isCeFalseCaretContainer = function (node, rootNode) {\n      return isCaretContainer(node) && hasParent(node, rootNode, isCaretNode) === false;\n    };\n    var hasBrBeforeAfter = function (dom, node, left) {\n      var walker = new DomTreeWalker(node, dom.getParent(node.parentNode, dom.isBlock) || dom.getRoot());\n      while (node = walker[left ? 'prev' : 'next']()) {\n        if (isBr(node)) {\n          return true;\n        }\n      }\n    };\n    var isPrevNode = function (node, name) {\n      return node.previousSibling && node.previousSibling.nodeName === name;\n    };\n    var hasContentEditableFalseParent = function (body, node) {\n      while (node && node !== body) {\n        if (isContentEditableFalse(node)) {\n          return true;\n        }\n        node = node.parentNode;\n      }\n      return false;\n    };\n    var findTextNodeRelative = function (dom, isAfterNode, collapsed, left, startNode) {\n      var lastInlineElement;\n      var body = dom.getRoot();\n      var node;\n      var nonEmptyElementsMap = dom.schema.getNonEmptyElements();\n      var parentBlockContainer = dom.getParent(startNode.parentNode, dom.isBlock) || body;\n      if (left && isBr(startNode) && isAfterNode && dom.isEmpty(parentBlockContainer)) {\n        return Optional.some(CaretPosition(startNode.parentNode, dom.nodeIndex(startNode)));\n      }\n      var walker = new DomTreeWalker(startNode, parentBlockContainer);\n      while (node = walker[left ? 'prev' : 'next']()) {\n        if (dom.getContentEditableParent(node) === 'false' || isCeFalseCaretContainer(node, body)) {\n          return Optional.none();\n        }\n        if (isText$1(node) && node.nodeValue.length > 0) {\n          if (hasParentWithName(node, body, 'A') === false) {\n            return Optional.some(CaretPosition(node, left ? node.nodeValue.length : 0));\n          }\n          return Optional.none();\n        }\n        if (dom.isBlock(node) || nonEmptyElementsMap[node.nodeName.toLowerCase()]) {\n          return Optional.none();\n        }\n        lastInlineElement = node;\n      }\n      if (collapsed && lastInlineElement) {\n        return Optional.some(CaretPosition(lastInlineElement, 0));\n      }\n      return Optional.none();\n    };\n    var normalizeEndPoint = function (dom, collapsed, start, rng) {\n      var container, offset;\n      var body = dom.getRoot();\n      var node;\n      var directionLeft, normalized = false;\n      container = rng[(start ? 'start' : 'end') + 'Container'];\n      offset = rng[(start ? 'start' : 'end') + 'Offset'];\n      var isAfterNode = isElement$1(container) && offset === container.childNodes.length;\n      var nonEmptyElementsMap = dom.schema.getNonEmptyElements();\n      directionLeft = start;\n      if (isCaretContainer(container)) {\n        return Optional.none();\n      }\n      if (isElement$1(container) && offset > container.childNodes.length - 1) {\n        directionLeft = false;\n      }\n      if (isDocument$1(container)) {\n        container = body;\n        offset = 0;\n      }\n      if (container === body) {\n        if (directionLeft) {\n          node = container.childNodes[offset > 0 ? offset - 1 : 0];\n          if (node) {\n            if (isCaretContainer(node)) {\n              return Optional.none();\n            }\n            if (nonEmptyElementsMap[node.nodeName] || isTable$3(node)) {\n              return Optional.none();\n            }\n          }\n        }\n        if (container.hasChildNodes()) {\n          offset = Math.min(!directionLeft && offset > 0 ? offset - 1 : offset, container.childNodes.length - 1);\n          container = container.childNodes[offset];\n          offset = isText$1(container) && isAfterNode ? container.data.length : 0;\n          if (!collapsed && container === body.lastChild && isTable$3(container)) {\n            return Optional.none();\n          }\n          if (hasContentEditableFalseParent(body, container) || isCaretContainer(container)) {\n            return Optional.none();\n          }\n          if (container.hasChildNodes() && isTable$3(container) === false) {\n            node = container;\n            var walker = new DomTreeWalker(container, body);\n            do {\n              if (isContentEditableFalse(node) || isCaretContainer(node)) {\n                normalized = false;\n                break;\n              }\n              if (isText$1(node) && node.nodeValue.length > 0) {\n                offset = directionLeft ? 0 : node.nodeValue.length;\n                container = node;\n                normalized = true;\n                break;\n              }\n              if (nonEmptyElementsMap[node.nodeName.toLowerCase()] && !isTableCell$3(node)) {\n                offset = dom.nodeIndex(node);\n                container = node.parentNode;\n                if (!directionLeft) {\n                  offset++;\n                }\n                normalized = true;\n                break;\n              }\n            } while (node = directionLeft ? walker.next() : walker.prev());\n          }\n        }\n      }\n      if (collapsed) {\n        if (isText$1(container) && offset === 0) {\n          findTextNodeRelative(dom, isAfterNode, collapsed, true, container).each(function (pos) {\n            container = pos.container();\n            offset = pos.offset();\n            normalized = true;\n          });\n        }\n        if (isElement$1(container)) {\n          node = container.childNodes[offset];\n          if (!node) {\n            node = container.childNodes[offset - 1];\n          }\n          if (node && isBr(node) && !isPrevNode(node, 'A') && !hasBrBeforeAfter(dom, node, false) && !hasBrBeforeAfter(dom, node, true)) {\n            findTextNodeRelative(dom, isAfterNode, collapsed, true, node).each(function (pos) {\n              container = pos.container();\n              offset = pos.offset();\n              normalized = true;\n            });\n          }\n        }\n      }\n      if (directionLeft && !collapsed && isText$1(container) && offset === container.nodeValue.length) {\n        findTextNodeRelative(dom, isAfterNode, collapsed, false, container).each(function (pos) {\n          container = pos.container();\n          offset = pos.offset();\n          normalized = true;\n        });\n      }\n      return normalized ? Optional.some(CaretPosition(container, offset)) : Optional.none();\n    };\n    var normalize = function (dom, rng) {\n      var collapsed = rng.collapsed, normRng = rng.cloneRange();\n      var startPos = CaretPosition.fromRangeStart(rng);\n      normalizeEndPoint(dom, collapsed, true, normRng).each(function (pos) {\n        if (!collapsed || !CaretPosition.isAbove(startPos, pos)) {\n          normRng.setStart(pos.container(), pos.offset());\n        }\n      });\n      if (!collapsed) {\n        normalizeEndPoint(dom, collapsed, false, normRng).each(function (pos) {\n          normRng.setEnd(pos.container(), pos.offset());\n        });\n      }\n      if (collapsed) {\n        normRng.collapse(true);\n      }\n      return isEq$1(rng, normRng) ? Optional.none() : Optional.some(normRng);\n    };\n\n    var splitText = function (node, offset) {\n      return node.splitText(offset);\n    };\n    var split$1 = function (rng) {\n      var startContainer = rng.startContainer, startOffset = rng.startOffset, endContainer = rng.endContainer, endOffset = rng.endOffset;\n      if (startContainer === endContainer && isText$1(startContainer)) {\n        if (startOffset > 0 && startOffset < startContainer.nodeValue.length) {\n          endContainer = splitText(startContainer, startOffset);\n          startContainer = endContainer.previousSibling;\n          if (endOffset > startOffset) {\n            endOffset = endOffset - startOffset;\n            startContainer = endContainer = splitText(endContainer, endOffset).previousSibling;\n            endOffset = endContainer.nodeValue.length;\n            startOffset = 0;\n          } else {\n            endOffset = 0;\n          }\n        }\n      } else {\n        if (isText$1(startContainer) && startOffset > 0 && startOffset < startContainer.nodeValue.length) {\n          startContainer = splitText(startContainer, startOffset);\n          startOffset = 0;\n        }\n        if (isText$1(endContainer) && endOffset > 0 && endOffset < endContainer.nodeValue.length) {\n          endContainer = splitText(endContainer, endOffset).previousSibling;\n          endOffset = endContainer.nodeValue.length;\n        }\n      }\n      return {\n        startContainer: startContainer,\n        startOffset: startOffset,\n        endContainer: endContainer,\n        endOffset: endOffset\n      };\n    };\n\n    var RangeUtils = function (dom) {\n      var walk = function (rng, callback) {\n        return walk$1(dom, rng, callback);\n      };\n      var split = split$1;\n      var normalize$1 = function (rng) {\n        return normalize(dom, rng).fold(never, function (normalizedRng) {\n          rng.setStart(normalizedRng.startContainer, normalizedRng.startOffset);\n          rng.setEnd(normalizedRng.endContainer, normalizedRng.endOffset);\n          return true;\n        });\n      };\n      return {\n        walk: walk,\n        split: split,\n        normalize: normalize$1\n      };\n    };\n    RangeUtils.compareRanges = isEq$1;\n    RangeUtils.getCaretRangeFromPoint = fromPoint$1;\n    RangeUtils.getSelectedNode = getSelectedNode;\n    RangeUtils.getNode = getNode;\n\n    var Dimension = function (name, getOffset) {\n      var set = function (element, h) {\n        if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n          throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n        }\n        var dom = element.dom;\n        if (isSupported$1(dom)) {\n          dom.style[name] = h + 'px';\n        }\n      };\n      var get = function (element) {\n        var r = getOffset(element);\n        if (r <= 0 || r === null) {\n          var css = get$5(element, name);\n          return parseFloat(css) || 0;\n        }\n        return r;\n      };\n      var getOuter = get;\n      var aggregate = function (element, properties) {\n        return foldl(properties, function (acc, property) {\n          var val = get$5(element, property);\n          var value = val === undefined ? 0 : parseInt(val, 10);\n          return isNaN(value) ? acc : acc + value;\n        }, 0);\n      };\n      var max = function (element, value, properties) {\n        var cumulativeInclusions = aggregate(element, properties);\n        var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n        return absoluteMax;\n      };\n      return {\n        set: set,\n        get: get,\n        getOuter: getOuter,\n        aggregate: aggregate,\n        max: max\n      };\n    };\n\n    var api$1 = Dimension('height', function (element) {\n      var dom = element.dom;\n      return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n    });\n    var get$9 = function (element) {\n      return api$1.get(element);\n    };\n\n    var walkUp = function (navigation, doc) {\n      var frame = navigation.view(doc);\n      return frame.fold(constant([]), function (f) {\n        var parent = navigation.owner(f);\n        var rest = walkUp(navigation, parent);\n        return [f].concat(rest);\n      });\n    };\n    var pathTo = function (element, navigation) {\n      var d = navigation.owner(element);\n      return walkUp(navigation, d);\n    };\n\n    var view = function (doc) {\n      var _a;\n      var element = doc.dom === document ? Optional.none() : Optional.from((_a = doc.dom.defaultView) === null || _a === void 0 ? void 0 : _a.frameElement);\n      return element.map(SugarElement.fromDom);\n    };\n    var owner$1 = function (element) {\n      return documentOrOwner(element);\n    };\n\n    var Navigation = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        view: view,\n        owner: owner$1\n    });\n\n    var find$2 = function (element) {\n      var doc = SugarElement.fromDom(document);\n      var scroll = get$2(doc);\n      var frames = pathTo(element, Navigation);\n      var offset = viewport(element);\n      var r = foldr(frames, function (b, a) {\n        var loc = viewport(a);\n        return {\n          left: b.left + loc.left,\n          top: b.top + loc.top\n        };\n      }, {\n        left: 0,\n        top: 0\n      });\n      return SugarPosition(r.left + offset.left + scroll.left, r.top + offset.top + scroll.top);\n    };\n\n    var excludeFromDescend = function (element) {\n      return name(element) === 'textarea';\n    };\n    var fireScrollIntoViewEvent = function (editor, data) {\n      var scrollEvent = editor.fire('ScrollIntoView', data);\n      return scrollEvent.isDefaultPrevented();\n    };\n    var fireAfterScrollIntoViewEvent = function (editor, data) {\n      editor.fire('AfterScrollIntoView', data);\n    };\n    var descend = function (element, offset) {\n      var children$1 = children(element);\n      if (children$1.length === 0 || excludeFromDescend(element)) {\n        return {\n          element: element,\n          offset: offset\n        };\n      } else if (offset < children$1.length && !excludeFromDescend(children$1[offset])) {\n        return {\n          element: children$1[offset],\n          offset: 0\n        };\n      } else {\n        var last = children$1[children$1.length - 1];\n        if (excludeFromDescend(last)) {\n          return {\n            element: element,\n            offset: offset\n          };\n        } else {\n          if (name(last) === 'img') {\n            return {\n              element: last,\n              offset: 1\n            };\n          } else if (isText(last)) {\n            return {\n              element: last,\n              offset: get$8(last).length\n            };\n          } else {\n            return {\n              element: last,\n              offset: children(last).length\n            };\n          }\n        }\n      }\n    };\n    var markerInfo = function (element, cleanupFun) {\n      var pos = absolute(element);\n      var height = get$9(element);\n      return {\n        element: element,\n        bottom: pos.top + height,\n        height: height,\n        pos: pos,\n        cleanup: cleanupFun\n      };\n    };\n    var createMarker = function (element, offset) {\n      var startPoint = descend(element, offset);\n      var span = SugarElement.fromHtml('<span data-mce-bogus=\"all\">' + ZWSP + '</span>');\n      before(startPoint.element, span);\n      return markerInfo(span, function () {\n        return remove(span);\n      });\n    };\n    var elementMarker = function (element) {\n      return markerInfo(SugarElement.fromDom(element), noop);\n    };\n    var withMarker = function (editor, f, rng, alignToTop) {\n      preserveWith(editor, function (_s, _e) {\n        return applyWithMarker(editor, f, rng, alignToTop);\n      }, rng);\n    };\n    var withScrollEvents = function (editor, doc, f, marker, alignToTop) {\n      var data = {\n        elm: marker.element.dom,\n        alignToTop: alignToTop\n      };\n      if (fireScrollIntoViewEvent(editor, data)) {\n        return;\n      }\n      var scrollTop = get$2(doc).top;\n      f(doc, scrollTop, marker, alignToTop);\n      fireAfterScrollIntoViewEvent(editor, data);\n    };\n    var applyWithMarker = function (editor, f, rng, alignToTop) {\n      var body = SugarElement.fromDom(editor.getBody());\n      var doc = SugarElement.fromDom(editor.getDoc());\n      reflow(body);\n      var marker = createMarker(SugarElement.fromDom(rng.startContainer), rng.startOffset);\n      withScrollEvents(editor, doc, f, marker, alignToTop);\n      marker.cleanup();\n    };\n    var withElement = function (editor, element, f, alignToTop) {\n      var doc = SugarElement.fromDom(editor.getDoc());\n      withScrollEvents(editor, doc, f, elementMarker(element), alignToTop);\n    };\n    var preserveWith = function (editor, f, rng) {\n      var startElement = rng.startContainer;\n      var startOffset = rng.startOffset;\n      var endElement = rng.endContainer;\n      var endOffset = rng.endOffset;\n      f(SugarElement.fromDom(startElement), SugarElement.fromDom(endElement));\n      var newRng = editor.dom.createRng();\n      newRng.setStart(startElement, startOffset);\n      newRng.setEnd(endElement, endOffset);\n      editor.selection.setRng(rng);\n    };\n    var scrollToMarker = function (marker, viewHeight, alignToTop, doc) {\n      var pos = marker.pos;\n      if (alignToTop) {\n        to(pos.left, pos.top, doc);\n      } else {\n        var y = pos.top - viewHeight + marker.height;\n        to(pos.left, y, doc);\n      }\n    };\n    var intoWindowIfNeeded = function (doc, scrollTop, viewHeight, marker, alignToTop) {\n      var viewportBottom = viewHeight + scrollTop;\n      var markerTop = marker.pos.top;\n      var markerBottom = marker.bottom;\n      var largerThanViewport = markerBottom - markerTop >= viewHeight;\n      if (markerTop < scrollTop) {\n        scrollToMarker(marker, viewHeight, alignToTop !== false, doc);\n      } else if (markerTop > viewportBottom) {\n        var align = largerThanViewport ? alignToTop !== false : alignToTop === true;\n        scrollToMarker(marker, viewHeight, align, doc);\n      } else if (markerBottom > viewportBottom && !largerThanViewport) {\n        scrollToMarker(marker, viewHeight, alignToTop === true, doc);\n      }\n    };\n    var intoWindow = function (doc, scrollTop, marker, alignToTop) {\n      var viewHeight = doc.dom.defaultView.innerHeight;\n      intoWindowIfNeeded(doc, scrollTop, viewHeight, marker, alignToTop);\n    };\n    var intoFrame = function (doc, scrollTop, marker, alignToTop) {\n      var frameViewHeight = doc.dom.defaultView.innerHeight;\n      intoWindowIfNeeded(doc, scrollTop, frameViewHeight, marker, alignToTop);\n      var op = find$2(marker.element);\n      var viewportBounds = getBounds(window);\n      if (op.top < viewportBounds.y) {\n        intoView(marker.element, alignToTop !== false);\n      } else if (op.top > viewportBounds.bottom) {\n        intoView(marker.element, alignToTop === true);\n      }\n    };\n    var rangeIntoWindow = function (editor, rng, alignToTop) {\n      return withMarker(editor, intoWindow, rng, alignToTop);\n    };\n    var elementIntoWindow = function (editor, element, alignToTop) {\n      return withElement(editor, element, intoWindow, alignToTop);\n    };\n    var rangeIntoFrame = function (editor, rng, alignToTop) {\n      return withMarker(editor, intoFrame, rng, alignToTop);\n    };\n    var elementIntoFrame = function (editor, element, alignToTop) {\n      return withElement(editor, element, intoFrame, alignToTop);\n    };\n    var scrollElementIntoView = function (editor, element, alignToTop) {\n      var scroller = editor.inline ? elementIntoWindow : elementIntoFrame;\n      scroller(editor, element, alignToTop);\n    };\n    var scrollRangeIntoView = function (editor, rng, alignToTop) {\n      var scroller = editor.inline ? rangeIntoWindow : rangeIntoFrame;\n      scroller(editor, rng, alignToTop);\n    };\n\n    var getDocument = function () {\n      return SugarElement.fromDom(document);\n    };\n\n    var focus = function (element) {\n      return element.dom.focus();\n    };\n    var hasFocus = function (element) {\n      var root = getRootNode(element).dom;\n      return element.dom === root.activeElement;\n    };\n    var active = function (root) {\n      if (root === void 0) {\n        root = getDocument();\n      }\n      return Optional.from(root.dom.activeElement).map(SugarElement.fromDom);\n    };\n    var search = function (element) {\n      return active(getRootNode(element)).filter(function (e) {\n        return element.dom.contains(e.dom);\n      });\n    };\n\n    var create$4 = function (start, soffset, finish, foffset) {\n      return {\n        start: start,\n        soffset: soffset,\n        finish: finish,\n        foffset: foffset\n      };\n    };\n    var SimRange = { create: create$4 };\n\n    var adt = Adt.generate([\n      { before: ['element'] },\n      {\n        on: [\n          'element',\n          'offset'\n        ]\n      },\n      { after: ['element'] }\n    ]);\n    var cata = function (subject, onBefore, onOn, onAfter) {\n      return subject.fold(onBefore, onOn, onAfter);\n    };\n    var getStart = function (situ) {\n      return situ.fold(identity, identity, identity);\n    };\n    var before$3 = adt.before;\n    var on = adt.on;\n    var after$2 = adt.after;\n    var Situ = {\n      before: before$3,\n      on: on,\n      after: after$2,\n      cata: cata,\n      getStart: getStart\n    };\n\n    var adt$1 = Adt.generate([\n      { domRange: ['rng'] },\n      {\n        relative: [\n          'startSitu',\n          'finishSitu'\n        ]\n      },\n      {\n        exact: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var exactFromRange = function (simRange) {\n      return adt$1.exact(simRange.start, simRange.soffset, simRange.finish, simRange.foffset);\n    };\n    var getStart$1 = function (selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return SugarElement.fromDom(rng.startContainer);\n        },\n        relative: function (startSitu, _finishSitu) {\n          return Situ.getStart(startSitu);\n        },\n        exact: function (start, _soffset, _finish, _foffset) {\n          return start;\n        }\n      });\n    };\n    var domRange = adt$1.domRange;\n    var relative = adt$1.relative;\n    var exact = adt$1.exact;\n    var getWin = function (selection) {\n      var start = getStart$1(selection);\n      return defaultView(start);\n    };\n    var range = SimRange.create;\n    var SimSelection = {\n      domRange: domRange,\n      relative: relative,\n      exact: exact,\n      exactFromRange: exactFromRange,\n      getWin: getWin,\n      range: range\n    };\n\n    var browser$3 = detect$3().browser;\n    var clamp = function (offset, element) {\n      var max = isText(element) ? get$8(element).length : children(element).length + 1;\n      if (offset > max) {\n        return max;\n      } else if (offset < 0) {\n        return 0;\n      }\n      return offset;\n    };\n    var normalizeRng = function (rng) {\n      return SimSelection.range(rng.start, clamp(rng.soffset, rng.start), rng.finish, clamp(rng.foffset, rng.finish));\n    };\n    var isOrContains = function (root, elm) {\n      return !isRestrictedNode(elm.dom) && (contains$2(root, elm) || eq$2(root, elm));\n    };\n    var isRngInRoot = function (root) {\n      return function (rng) {\n        return isOrContains(root, rng.start) && isOrContains(root, rng.finish);\n      };\n    };\n    var shouldStore = function (editor) {\n      return editor.inline === true || browser$3.isIE();\n    };\n    var nativeRangeToSelectionRange = function (r) {\n      return SimSelection.range(SugarElement.fromDom(r.startContainer), r.startOffset, SugarElement.fromDom(r.endContainer), r.endOffset);\n    };\n    var readRange = function (win) {\n      var selection = win.getSelection();\n      var rng = !selection || selection.rangeCount === 0 ? Optional.none() : Optional.from(selection.getRangeAt(0));\n      return rng.map(nativeRangeToSelectionRange);\n    };\n    var getBookmark$2 = function (root) {\n      var win = defaultView(root);\n      return readRange(win.dom).filter(isRngInRoot(root));\n    };\n    var validate = function (root, bookmark) {\n      return Optional.from(bookmark).filter(isRngInRoot(root)).map(normalizeRng);\n    };\n    var bookmarkToNativeRng = function (bookmark) {\n      var rng = document.createRange();\n      try {\n        rng.setStart(bookmark.start.dom, bookmark.soffset);\n        rng.setEnd(bookmark.finish.dom, bookmark.foffset);\n        return Optional.some(rng);\n      } catch (_) {\n        return Optional.none();\n      }\n    };\n    var store = function (editor) {\n      var newBookmark = shouldStore(editor) ? getBookmark$2(SugarElement.fromDom(editor.getBody())) : Optional.none();\n      editor.bookmark = newBookmark.isSome() ? newBookmark : editor.bookmark;\n    };\n    var storeNative = function (editor, rng) {\n      var root = SugarElement.fromDom(editor.getBody());\n      var range = shouldStore(editor) ? Optional.from(rng) : Optional.none();\n      var newBookmark = range.map(nativeRangeToSelectionRange).filter(isRngInRoot(root));\n      editor.bookmark = newBookmark.isSome() ? newBookmark : editor.bookmark;\n    };\n    var getRng = function (editor) {\n      var bookmark = editor.bookmark ? editor.bookmark : Optional.none();\n      return bookmark.bind(function (x) {\n        return validate(SugarElement.fromDom(editor.getBody()), x);\n      }).bind(bookmarkToNativeRng);\n    };\n    var restore = function (editor) {\n      getRng(editor).each(function (rng) {\n        return editor.selection.setRng(rng);\n      });\n    };\n\n    var isEditorUIElement = function (elm) {\n      var className = elm.className.toString();\n      return className.indexOf('tox-') !== -1 || className.indexOf('mce-') !== -1;\n    };\n    var FocusManager = { isEditorUIElement: isEditorUIElement };\n\n    var isManualNodeChange = function (e) {\n      return e.type === 'nodechange' && e.selectionChange;\n    };\n    var registerPageMouseUp = function (editor, throttledStore) {\n      var mouseUpPage = function () {\n        throttledStore.throttle();\n      };\n      DOMUtils.DOM.bind(document, 'mouseup', mouseUpPage);\n      editor.on('remove', function () {\n        DOMUtils.DOM.unbind(document, 'mouseup', mouseUpPage);\n      });\n    };\n    var registerFocusOut = function (editor) {\n      editor.on('focusout', function () {\n        store(editor);\n      });\n    };\n    var registerMouseUp = function (editor, throttledStore) {\n      editor.on('mouseup touchend', function (_e) {\n        throttledStore.throttle();\n      });\n    };\n    var registerEditorEvents = function (editor, throttledStore) {\n      var browser = detect$3().browser;\n      if (browser.isIE()) {\n        registerFocusOut(editor);\n      } else {\n        registerMouseUp(editor, throttledStore);\n      }\n      editor.on('keyup NodeChange', function (e) {\n        if (!isManualNodeChange(e)) {\n          store(editor);\n        }\n      });\n    };\n    var register = function (editor) {\n      var throttledStore = first(function () {\n        store(editor);\n      }, 0);\n      editor.on('init', function () {\n        if (editor.inline) {\n          registerPageMouseUp(editor, throttledStore);\n        }\n        registerEditorEvents(editor, throttledStore);\n      });\n      editor.on('remove', function () {\n        throttledStore.cancel();\n      });\n    };\n\n    var documentFocusInHandler;\n    var DOM$2 = DOMUtils.DOM;\n    var isEditorUIElement$1 = function (elm) {\n      return FocusManager.isEditorUIElement(elm);\n    };\n    var isEditorContentAreaElement = function (elm) {\n      var classList = elm.classList;\n      if (classList !== undefined) {\n        return classList.contains('tox-edit-area') || classList.contains('tox-edit-area__iframe') || classList.contains('mce-content-body');\n      } else {\n        return false;\n      }\n    };\n    var isUIElement = function (editor, elm) {\n      var customSelector = getCustomUiSelector(editor);\n      var parent = DOM$2.getParent(elm, function (elm) {\n        return isEditorUIElement$1(elm) || (customSelector ? editor.dom.is(elm, customSelector) : false);\n      });\n      return parent !== null;\n    };\n    var getActiveElement = function (editor) {\n      try {\n        var root = getRootNode(SugarElement.fromDom(editor.getElement()));\n        return active(root).fold(function () {\n          return document.body;\n        }, function (x) {\n          return x.dom;\n        });\n      } catch (ex) {\n        return document.body;\n      }\n    };\n    var registerEvents = function (editorManager, e) {\n      var editor = e.editor;\n      register(editor);\n      editor.on('focusin', function () {\n        var focusedEditor = editorManager.focusedEditor;\n        if (focusedEditor !== editor) {\n          if (focusedEditor) {\n            focusedEditor.fire('blur', { focusedEditor: editor });\n          }\n          editorManager.setActive(editor);\n          editorManager.focusedEditor = editor;\n          editor.fire('focus', { blurredEditor: focusedEditor });\n          editor.focus(true);\n        }\n      });\n      editor.on('focusout', function () {\n        Delay.setEditorTimeout(editor, function () {\n          var focusedEditor = editorManager.focusedEditor;\n          if (!isUIElement(editor, getActiveElement(editor)) && focusedEditor === editor) {\n            editor.fire('blur', { focusedEditor: null });\n            editorManager.focusedEditor = null;\n          }\n        });\n      });\n      if (!documentFocusInHandler) {\n        documentFocusInHandler = function (e) {\n          var activeEditor = editorManager.activeEditor;\n          if (activeEditor) {\n            getOriginalEventTarget(e).each(function (target) {\n              if (target.ownerDocument === document) {\n                if (target !== document.body && !isUIElement(activeEditor, target) && editorManager.focusedEditor === activeEditor) {\n                  activeEditor.fire('blur', { focusedEditor: null });\n                  editorManager.focusedEditor = null;\n                }\n              }\n            });\n          }\n        };\n        DOM$2.bind(document, 'focusin', documentFocusInHandler);\n      }\n    };\n    var unregisterDocumentEvents = function (editorManager, e) {\n      if (editorManager.focusedEditor === e.editor) {\n        editorManager.focusedEditor = null;\n      }\n      if (!editorManager.activeEditor) {\n        DOM$2.unbind(document, 'focusin', documentFocusInHandler);\n        documentFocusInHandler = null;\n      }\n    };\n    var setup$2 = function (editorManager) {\n      editorManager.on('AddEditor', curry(registerEvents, editorManager));\n      editorManager.on('RemoveEditor', curry(unregisterDocumentEvents, editorManager));\n    };\n\n    var getContentEditableHost = function (editor, node) {\n      return editor.dom.getParent(node, function (node) {\n        return editor.dom.getContentEditable(node) === 'true';\n      });\n    };\n    var getCollapsedNode = function (rng) {\n      return rng.collapsed ? Optional.from(getNode(rng.startContainer, rng.startOffset)).map(SugarElement.fromDom) : Optional.none();\n    };\n    var getFocusInElement = function (root, rng) {\n      return getCollapsedNode(rng).bind(function (node) {\n        if (isTableSection(node)) {\n          return Optional.some(node);\n        } else if (contains$2(root, node) === false) {\n          return Optional.some(root);\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n    var normalizeSelection = function (editor, rng) {\n      getFocusInElement(SugarElement.fromDom(editor.getBody()), rng).bind(function (elm) {\n        return firstPositionIn(elm.dom);\n      }).fold(function () {\n        editor.selection.normalize();\n        return;\n      }, function (caretPos) {\n        return editor.selection.setRng(caretPos.toRange());\n      });\n    };\n    var focusBody = function (body) {\n      if (body.setActive) {\n        try {\n          body.setActive();\n        } catch (ex) {\n          body.focus();\n        }\n      } else {\n        body.focus();\n      }\n    };\n    var hasElementFocus = function (elm) {\n      return hasFocus(elm) || search(elm).isSome();\n    };\n    var hasIframeFocus = function (editor) {\n      return editor.iframeElement && hasFocus(SugarElement.fromDom(editor.iframeElement));\n    };\n    var hasInlineFocus = function (editor) {\n      var rawBody = editor.getBody();\n      return rawBody && hasElementFocus(SugarElement.fromDom(rawBody));\n    };\n    var hasUiFocus = function (editor) {\n      var dos = getRootNode(SugarElement.fromDom(editor.getElement()));\n      return active(dos).filter(function (elem) {\n        return !isEditorContentAreaElement(elem.dom) && isUIElement(editor, elem.dom);\n      }).isSome();\n    };\n    var hasFocus$1 = function (editor) {\n      return editor.inline ? hasInlineFocus(editor) : hasIframeFocus(editor);\n    };\n    var hasEditorOrUiFocus = function (editor) {\n      return hasFocus$1(editor) || hasUiFocus(editor);\n    };\n    var focusEditor = function (editor) {\n      var selection = editor.selection;\n      var body = editor.getBody();\n      var rng = selection.getRng();\n      editor.quirks.refreshContentEditable();\n      if (editor.bookmark !== undefined && hasFocus$1(editor) === false) {\n        getRng(editor).each(function (bookmarkRng) {\n          editor.selection.setRng(bookmarkRng);\n          rng = bookmarkRng;\n        });\n      }\n      var contentEditableHost = getContentEditableHost(editor, selection.getNode());\n      if (editor.$.contains(body, contentEditableHost)) {\n        focusBody(contentEditableHost);\n        normalizeSelection(editor, rng);\n        activateEditor(editor);\n        return;\n      }\n      if (!editor.inline) {\n        if (!Env.opera) {\n          focusBody(body);\n        }\n        editor.getWin().focus();\n      }\n      if (Env.gecko || editor.inline) {\n        focusBody(body);\n        normalizeSelection(editor, rng);\n      }\n      activateEditor(editor);\n    };\n    var activateEditor = function (editor) {\n      return editor.editorManager.setActive(editor);\n    };\n    var focus$1 = function (editor, skipFocus) {\n      if (editor.removed) {\n        return;\n      }\n      skipFocus ? activateEditor(editor) : focusEditor(editor);\n    };\n\n    var getEndpointElement = function (root, rng, start, real, resolve) {\n      var container = start ? rng.startContainer : rng.endContainer;\n      var offset = start ? rng.startOffset : rng.endOffset;\n      return Optional.from(container).map(SugarElement.fromDom).map(function (elm) {\n        return !real || !rng.collapsed ? child(elm, resolve(elm, offset)).getOr(elm) : elm;\n      }).bind(function (elm) {\n        return isElement(elm) ? Optional.some(elm) : parent(elm).filter(isElement);\n      }).map(function (elm) {\n        return elm.dom;\n      }).getOr(root);\n    };\n    var getStart$2 = function (root, rng, real) {\n      return getEndpointElement(root, rng, true, real, function (elm, offset) {\n        return Math.min(childNodesCount(elm), offset);\n      });\n    };\n    var getEnd = function (root, rng, real) {\n      return getEndpointElement(root, rng, false, real, function (elm, offset) {\n        return offset > 0 ? offset - 1 : offset;\n      });\n    };\n    var skipEmptyTextNodes = function (node, forwards) {\n      var orig = node;\n      while (node && isText$1(node) && node.length === 0) {\n        node = forwards ? node.nextSibling : node.previousSibling;\n      }\n      return node || orig;\n    };\n    var getNode$1 = function (root, rng) {\n      var elm, startContainer, endContainer;\n      if (!rng) {\n        return root;\n      }\n      startContainer = rng.startContainer;\n      endContainer = rng.endContainer;\n      var startOffset = rng.startOffset;\n      var endOffset = rng.endOffset;\n      elm = rng.commonAncestorContainer;\n      if (!rng.collapsed) {\n        if (startContainer === endContainer) {\n          if (endOffset - startOffset < 2) {\n            if (startContainer.hasChildNodes()) {\n              elm = startContainer.childNodes[startOffset];\n            }\n          }\n        }\n        if (startContainer.nodeType === 3 && endContainer.nodeType === 3) {\n          if (startContainer.length === startOffset) {\n            startContainer = skipEmptyTextNodes(startContainer.nextSibling, true);\n          } else {\n            startContainer = startContainer.parentNode;\n          }\n          if (endOffset === 0) {\n            endContainer = skipEmptyTextNodes(endContainer.previousSibling, false);\n          } else {\n            endContainer = endContainer.parentNode;\n          }\n          if (startContainer && startContainer === endContainer) {\n            return startContainer;\n          }\n        }\n      }\n      if (elm && elm.nodeType === 3) {\n        return elm.parentNode;\n      }\n      return elm;\n    };\n    var getSelectedBlocks = function (dom, rng, startElm, endElm) {\n      var node;\n      var selectedBlocks = [];\n      var root = dom.getRoot();\n      startElm = dom.getParent(startElm || getStart$2(root, rng, rng.collapsed), dom.isBlock);\n      endElm = dom.getParent(endElm || getEnd(root, rng, rng.collapsed), dom.isBlock);\n      if (startElm && startElm !== root) {\n        selectedBlocks.push(startElm);\n      }\n      if (startElm && endElm && startElm !== endElm) {\n        node = startElm;\n        var walker = new DomTreeWalker(startElm, root);\n        while ((node = walker.next()) && node !== endElm) {\n          if (dom.isBlock(node)) {\n            selectedBlocks.push(node);\n          }\n        }\n      }\n      if (endElm && startElm !== endElm && endElm !== root) {\n        selectedBlocks.push(endElm);\n      }\n      return selectedBlocks;\n    };\n    var select$1 = function (dom, node, content) {\n      return Optional.from(node).map(function (node) {\n        var idx = dom.nodeIndex(node);\n        var rng = dom.createRng();\n        rng.setStart(node.parentNode, idx);\n        rng.setEnd(node.parentNode, idx + 1);\n        if (content) {\n          moveEndPoint$1(dom, rng, node, true);\n          moveEndPoint$1(dom, rng, node, false);\n        }\n        return rng;\n      });\n    };\n\n    var processRanges = function (editor, ranges) {\n      return map(ranges, function (range) {\n        var evt = editor.fire('GetSelectionRange', { range: range });\n        return evt.range !== range ? evt.range : range;\n      });\n    };\n\n    var typeLookup = {\n      '#text': 3,\n      '#comment': 8,\n      '#cdata': 4,\n      '#pi': 7,\n      '#doctype': 10,\n      '#document-fragment': 11\n    };\n    var walk$2 = function (node, root, prev) {\n      var startName = prev ? 'lastChild' : 'firstChild';\n      var siblingName = prev ? 'prev' : 'next';\n      if (node[startName]) {\n        return node[startName];\n      }\n      if (node !== root) {\n        var sibling = node[siblingName];\n        if (sibling) {\n          return sibling;\n        }\n        for (var parent_1 = node.parent; parent_1 && parent_1 !== root; parent_1 = parent_1.parent) {\n          sibling = parent_1[siblingName];\n          if (sibling) {\n            return sibling;\n          }\n        }\n      }\n    };\n    var isEmptyTextNode$1 = function (node) {\n      if (!isWhitespaceText(node.value)) {\n        return false;\n      }\n      var parentNode = node.parent;\n      if (parentNode && (parentNode.name !== 'span' || parentNode.attr('style')) && /^[ ]+$/.test(node.value)) {\n        return false;\n      }\n      return true;\n    };\n    var isNonEmptyElement = function (node) {\n      var isNamedAnchor = node.name === 'a' && !node.attr('href') && node.attr('id');\n      return node.attr('name') || node.attr('id') && !node.firstChild || node.attr('data-mce-bookmark') || isNamedAnchor;\n    };\n    var AstNode = function () {\n      function AstNode(name, type) {\n        this.name = name;\n        this.type = type;\n        if (type === 1) {\n          this.attributes = [];\n          this.attributes.map = {};\n        }\n      }\n      AstNode.create = function (name, attrs) {\n        var node = new AstNode(name, typeLookup[name] || 1);\n        if (attrs) {\n          each$1(attrs, function (value, attrName) {\n            node.attr(attrName, value);\n          });\n        }\n        return node;\n      };\n      AstNode.prototype.replace = function (node) {\n        var self = this;\n        if (node.parent) {\n          node.remove();\n        }\n        self.insert(node, self);\n        self.remove();\n        return self;\n      };\n      AstNode.prototype.attr = function (name, value) {\n        var self = this;\n        var attrs;\n        if (typeof name !== 'string') {\n          if (name !== undefined && name !== null) {\n            each$1(name, function (value, key) {\n              self.attr(key, value);\n            });\n          }\n          return self;\n        }\n        if (attrs = self.attributes) {\n          if (value !== undefined) {\n            if (value === null) {\n              if (name in attrs.map) {\n                delete attrs.map[name];\n                var i = attrs.length;\n                while (i--) {\n                  if (attrs[i].name === name) {\n                    attrs.splice(i, 1);\n                    return self;\n                  }\n                }\n              }\n              return self;\n            }\n            if (name in attrs.map) {\n              var i = attrs.length;\n              while (i--) {\n                if (attrs[i].name === name) {\n                  attrs[i].value = value;\n                  break;\n                }\n              }\n            } else {\n              attrs.push({\n                name: name,\n                value: value\n              });\n            }\n            attrs.map[name] = value;\n            return self;\n          }\n          return attrs.map[name];\n        }\n      };\n      AstNode.prototype.clone = function () {\n        var self = this;\n        var clone = new AstNode(self.name, self.type);\n        var selfAttrs;\n        if (selfAttrs = self.attributes) {\n          var cloneAttrs = [];\n          cloneAttrs.map = {};\n          for (var i = 0, l = selfAttrs.length; i < l; i++) {\n            var selfAttr = selfAttrs[i];\n            if (selfAttr.name !== 'id') {\n              cloneAttrs[cloneAttrs.length] = {\n                name: selfAttr.name,\n                value: selfAttr.value\n              };\n              cloneAttrs.map[selfAttr.name] = selfAttr.value;\n            }\n          }\n          clone.attributes = cloneAttrs;\n        }\n        clone.value = self.value;\n        clone.shortEnded = self.shortEnded;\n        return clone;\n      };\n      AstNode.prototype.wrap = function (wrapper) {\n        var self = this;\n        self.parent.insert(wrapper, self);\n        wrapper.append(self);\n        return self;\n      };\n      AstNode.prototype.unwrap = function () {\n        var self = this;\n        for (var node = self.firstChild; node;) {\n          var next = node.next;\n          self.insert(node, self, true);\n          node = next;\n        }\n        self.remove();\n      };\n      AstNode.prototype.remove = function () {\n        var self = this, parent = self.parent, next = self.next, prev = self.prev;\n        if (parent) {\n          if (parent.firstChild === self) {\n            parent.firstChild = next;\n            if (next) {\n              next.prev = null;\n            }\n          } else {\n            prev.next = next;\n          }\n          if (parent.lastChild === self) {\n            parent.lastChild = prev;\n            if (prev) {\n              prev.next = null;\n            }\n          } else {\n            next.prev = prev;\n          }\n          self.parent = self.next = self.prev = null;\n        }\n        return self;\n      };\n      AstNode.prototype.append = function (node) {\n        var self = this;\n        if (node.parent) {\n          node.remove();\n        }\n        var last = self.lastChild;\n        if (last) {\n          last.next = node;\n          node.prev = last;\n          self.lastChild = node;\n        } else {\n          self.lastChild = self.firstChild = node;\n        }\n        node.parent = self;\n        return node;\n      };\n      AstNode.prototype.insert = function (node, refNode, before) {\n        if (node.parent) {\n          node.remove();\n        }\n        var parent = refNode.parent || this;\n        if (before) {\n          if (refNode === parent.firstChild) {\n            parent.firstChild = node;\n          } else {\n            refNode.prev.next = node;\n          }\n          node.prev = refNode.prev;\n          node.next = refNode;\n          refNode.prev = node;\n        } else {\n          if (refNode === parent.lastChild) {\n            parent.lastChild = node;\n          } else {\n            refNode.next.prev = node;\n          }\n          node.next = refNode.next;\n          node.prev = refNode;\n          refNode.next = node;\n        }\n        node.parent = parent;\n        return node;\n      };\n      AstNode.prototype.getAll = function (name) {\n        var self = this;\n        var collection = [];\n        for (var node = self.firstChild; node; node = walk$2(node, self)) {\n          if (node.name === name) {\n            collection.push(node);\n          }\n        }\n        return collection;\n      };\n      AstNode.prototype.empty = function () {\n        var self = this;\n        if (self.firstChild) {\n          var nodes = [];\n          for (var node = self.firstChild; node; node = walk$2(node, self)) {\n            nodes.push(node);\n          }\n          var i = nodes.length;\n          while (i--) {\n            var node = nodes[i];\n            node.parent = node.firstChild = node.lastChild = node.next = node.prev = null;\n          }\n        }\n        self.firstChild = self.lastChild = null;\n        return self;\n      };\n      AstNode.prototype.isEmpty = function (elements, whitespace, predicate) {\n        if (whitespace === void 0) {\n          whitespace = {};\n        }\n        var self = this;\n        var node = self.firstChild;\n        if (isNonEmptyElement(self)) {\n          return false;\n        }\n        if (node) {\n          do {\n            if (node.type === 1) {\n              if (node.attr('data-mce-bogus')) {\n                continue;\n              }\n              if (elements[node.name]) {\n                return false;\n              }\n              if (isNonEmptyElement(node)) {\n                return false;\n              }\n            }\n            if (node.type === 8) {\n              return false;\n            }\n            if (node.type === 3 && !isEmptyTextNode$1(node)) {\n              return false;\n            }\n            if (node.type === 3 && node.parent && whitespace[node.parent.name] && isWhitespaceText(node.value)) {\n              return false;\n            }\n            if (predicate && predicate(node)) {\n              return false;\n            }\n          } while (node = walk$2(node, self));\n        }\n        return true;\n      };\n      AstNode.prototype.walk = function (prev) {\n        return walk$2(this, null, prev);\n      };\n      return AstNode;\n    }();\n\n    var extractBase64DataUris = function (html) {\n      var dataImageUri = /data:[^;]+;base64,([a-z0-9\\+\\/=]+)/gi;\n      var chunks = [];\n      var uris = {};\n      var prefix = generate$1('img');\n      var matches;\n      var index = 0;\n      var count = 0;\n      while (matches = dataImageUri.exec(html)) {\n        var uri = matches[0];\n        var imageId = prefix + '_' + count++;\n        uris[imageId] = uri;\n        if (index < matches.index) {\n          chunks.push(html.substr(index, matches.index - index));\n        }\n        chunks.push(imageId);\n        index = matches.index + uri.length;\n      }\n      var re = new RegExp(prefix + '_[0-9]+', 'g');\n      if (index === 0) {\n        return {\n          prefix: prefix,\n          uris: uris,\n          html: html,\n          re: re\n        };\n      } else {\n        if (index < html.length) {\n          chunks.push(html.substr(index));\n        }\n        return {\n          prefix: prefix,\n          uris: uris,\n          html: chunks.join(''),\n          re: re\n        };\n      }\n    };\n    var restoreDataUris = function (html, result) {\n      return html.replace(result.re, function (imageId) {\n        return get$1(result.uris, imageId).getOr(imageId);\n      });\n    };\n    var parseDataUri = function (uri) {\n      var matches = /data:([^;]+);base64,([a-z0-9\\+\\/=]+)/i.exec(uri);\n      if (matches) {\n        return Optional.some({\n          type: matches[1],\n          data: decodeURIComponent(matches[2])\n        });\n      } else {\n        return Optional.none();\n      }\n    };\n\n    var safeSvgDataUrlElements = [\n      'img',\n      'video'\n    ];\n    var isValidPrefixAttrName = function (name) {\n      return name.indexOf('data-') === 0 || name.indexOf('aria-') === 0;\n    };\n    var blockSvgDataUris = function (allowSvgDataUrls, tagName) {\n      var allowed = isNullable(allowSvgDataUrls) ? contains(safeSvgDataUrlElements, tagName) : allowSvgDataUrls;\n      return !allowed;\n    };\n    var isInvalidUri = function (settings, uri, tagName) {\n      if (settings.allow_html_data_urls) {\n        return false;\n      } else if (/^data:image\\//i.test(uri)) {\n        return blockSvgDataUris(settings.allow_svg_data_urls, tagName) && /^data:image\\/svg\\+xml/i.test(uri);\n      } else {\n        return /^data:/i.test(uri);\n      }\n    };\n    var findEndTagIndex = function (schema, html, startIndex) {\n      var count = 1, index, matches;\n      var shortEndedElements = schema.getShortEndedElements();\n      var tokenRegExp = /<([!?\\/])?([A-Za-z0-9\\-_:.]+)(\\s(?:[^'\">]+(?:\"[^\"]*\"|'[^']*'))*[^\"'>]*(?:\"[^\">]*|'[^'>]*)?|\\s*|\\/)>/g;\n      tokenRegExp.lastIndex = index = startIndex;\n      while (matches = tokenRegExp.exec(html)) {\n        index = tokenRegExp.lastIndex;\n        if (matches[1] === '/') {\n          count--;\n        } else if (!matches[1]) {\n          if (matches[2] in shortEndedElements) {\n            continue;\n          }\n          count++;\n        }\n        if (count === 0) {\n          break;\n        }\n      }\n      return index;\n    };\n    var isConditionalComment = function (html, startIndex) {\n      return /^\\s*\\[if [\\w\\W]+\\]>.*<!\\[endif\\](--!?)?>/.test(html.substr(startIndex));\n    };\n    var findCommentEndIndex = function (html, isBogus, startIndex) {\n      if (startIndex === void 0) {\n        startIndex = 0;\n      }\n      var lcHtml = html.toLowerCase();\n      if (lcHtml.indexOf('[if ', startIndex) !== -1 && isConditionalComment(lcHtml, startIndex)) {\n        var endIfIndex = lcHtml.indexOf('[endif]', startIndex);\n        return lcHtml.indexOf('>', endIfIndex);\n      } else {\n        if (isBogus) {\n          var endIndex = lcHtml.indexOf('>', startIndex);\n          return endIndex !== -1 ? endIndex : lcHtml.length;\n        } else {\n          var endCommentRegexp = /--!?>/g;\n          endCommentRegexp.lastIndex = startIndex;\n          var match = endCommentRegexp.exec(html);\n          return match ? match.index + match[0].length : lcHtml.length;\n        }\n      }\n    };\n    var checkBogusAttribute = function (regExp, attrString) {\n      var matches = regExp.exec(attrString);\n      if (matches) {\n        var name_1 = matches[1];\n        var value = matches[2];\n        return typeof name_1 === 'string' && name_1.toLowerCase() === 'data-mce-bogus' ? value : null;\n      } else {\n        return null;\n      }\n    };\n    var SaxParser = function (settings, schema) {\n      if (schema === void 0) {\n        schema = Schema();\n      }\n      settings = settings || {};\n      if (settings.fix_self_closing !== false) {\n        settings.fix_self_closing = true;\n      }\n      var comment = settings.comment ? settings.comment : noop;\n      var cdata = settings.cdata ? settings.cdata : noop;\n      var text = settings.text ? settings.text : noop;\n      var start = settings.start ? settings.start : noop;\n      var end = settings.end ? settings.end : noop;\n      var pi = settings.pi ? settings.pi : noop;\n      var doctype = settings.doctype ? settings.doctype : noop;\n      var parseInternal = function (base64Extract, format) {\n        if (format === void 0) {\n          format = 'html';\n        }\n        var html = base64Extract.html;\n        var matches, index = 0, value, endRegExp;\n        var stack = [];\n        var attrList, i, textData, name;\n        var isInternalElement, isShortEnded;\n        var elementRule, isValidElement, attr, attribsValue, validAttributesMap, validAttributePatterns;\n        var attributesRequired, attributesDefault, attributesForced;\n        var anyAttributesRequired, attrValue, idCount = 0;\n        var decode = Entities.decode;\n        var filteredUrlAttrs = Tools.makeMap('src,href,data,background,action,formaction,poster,xlink:href');\n        var scriptUriRegExp = /((java|vb)script|mhtml):/i;\n        var parsingMode = format === 'html' ? 0 : 1;\n        var processEndTag = function (name) {\n          var pos, i;\n          pos = stack.length;\n          while (pos--) {\n            if (stack[pos].name === name) {\n              break;\n            }\n          }\n          if (pos >= 0) {\n            for (i = stack.length - 1; i >= pos; i--) {\n              name = stack[i];\n              if (name.valid) {\n                end(name.name);\n              }\n            }\n            stack.length = pos;\n          }\n        };\n        var processText = function (value, raw) {\n          return text(restoreDataUris(value, base64Extract), raw);\n        };\n        var processComment = function (value) {\n          if (value === '') {\n            return;\n          }\n          if (value.charAt(0) === '>') {\n            value = ' ' + value;\n          }\n          if (!settings.allow_conditional_comments && value.substr(0, 3).toLowerCase() === '[if') {\n            value = ' ' + value;\n          }\n          comment(restoreDataUris(value, base64Extract));\n        };\n        var processAttr = function (value) {\n          return restoreDataUris(value, base64Extract);\n        };\n        var processMalformedComment = function (value, startIndex) {\n          var startTag = value || '';\n          var isBogus = !startsWith(startTag, '--');\n          var endIndex = findCommentEndIndex(html, isBogus, startIndex);\n          value = html.substr(startIndex, endIndex - startIndex);\n          processComment(isBogus ? startTag + value : value);\n          return endIndex + 1;\n        };\n        var parseAttribute = function (tagName, name, value, val2, val3) {\n          var attrRule, i;\n          var trimRegExp = /[\\s\\u0000-\\u001F]+/g;\n          name = name.toLowerCase();\n          value = processAttr(name in fillAttrsMap ? name : decode(value || val2 || val3 || ''));\n          if (validate && !isInternalElement && isValidPrefixAttrName(name) === false) {\n            attrRule = validAttributesMap[name];\n            if (!attrRule && validAttributePatterns) {\n              i = validAttributePatterns.length;\n              while (i--) {\n                attrRule = validAttributePatterns[i];\n                if (attrRule.pattern.test(name)) {\n                  break;\n                }\n              }\n              if (i === -1) {\n                attrRule = null;\n              }\n            }\n            if (!attrRule) {\n              return;\n            }\n            if (attrRule.validValues && !(value in attrRule.validValues)) {\n              return;\n            }\n          }\n          if (filteredUrlAttrs[name] && !settings.allow_script_urls) {\n            var uri = value.replace(trimRegExp, '');\n            try {\n              uri = decodeURIComponent(uri);\n            } catch (ex) {\n              uri = unescape(uri);\n            }\n            if (scriptUriRegExp.test(uri)) {\n              return;\n            }\n            if (isInvalidUri(settings, uri, tagName)) {\n              return;\n            }\n          }\n          if (isInternalElement && (name in filteredUrlAttrs || name.indexOf('on') === 0)) {\n            return;\n          }\n          attrList.map[name] = value;\n          attrList.push({\n            name: name,\n            value: value\n          });\n        };\n        var tokenRegExp = new RegExp('<(?:' + '(?:!--([\\\\w\\\\W]*?)--!?>)|' + '(?:!\\\\[CDATA\\\\[([\\\\w\\\\W]*?)\\\\]\\\\]>)|' + '(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\\\w\\\\W]*?)>)|' + '(?:!(--)?)|' + '(?:\\\\?([^\\\\s\\\\/<>]+) ?([\\\\w\\\\W]*?)[?/]>)|' + '(?:\\\\/([A-Za-z][A-Za-z0-9\\\\-_\\\\:\\\\.]*)>)|' + '(?:([A-Za-z][A-Za-z0-9\\\\-_:.]*)(\\\\s(?:[^\\'\">]+(?:\"[^\"]*\"|\\'[^\\']*\\'))*[^\"\\'>]*(?:\"[^\">]*|\\'[^\\'>]*)?|\\\\s*|\\\\/)>)' + ')', 'g');\n        var attrRegExp = /([\\w:\\-]+)(?:\\s*=\\s*(?:(?:\\\"((?:[^\\\"])*)\\\")|(?:\\'((?:[^\\'])*)\\')|([^>\\s]+)))?/g;\n        var shortEndedElements = schema.getShortEndedElements();\n        var selfClosing = settings.self_closing_elements || schema.getSelfClosingElements();\n        var fillAttrsMap = schema.getBoolAttrs();\n        var validate = settings.validate;\n        var removeInternalElements = settings.remove_internals;\n        var fixSelfClosing = settings.fix_self_closing;\n        var specialElements = schema.getSpecialElements();\n        var processHtml = html + '>';\n        while (matches = tokenRegExp.exec(processHtml)) {\n          var matchText = matches[0];\n          if (index < matches.index) {\n            processText(decode(html.substr(index, matches.index - index)));\n          }\n          if (value = matches[7]) {\n            value = value.toLowerCase();\n            if (value.charAt(0) === ':') {\n              value = value.substr(1);\n            }\n            processEndTag(value);\n          } else if (value = matches[8]) {\n            if (matches.index + matchText.length > html.length) {\n              processText(decode(html.substr(matches.index)));\n              index = matches.index + matchText.length;\n              continue;\n            }\n            value = value.toLowerCase();\n            if (value.charAt(0) === ':') {\n              value = value.substr(1);\n            }\n            isShortEnded = value in shortEndedElements;\n            if (fixSelfClosing && selfClosing[value] && stack.length > 0 && stack[stack.length - 1].name === value) {\n              processEndTag(value);\n            }\n            var bogusValue = checkBogusAttribute(attrRegExp, matches[9]);\n            if (bogusValue !== null) {\n              if (bogusValue === 'all') {\n                index = findEndTagIndex(schema, html, tokenRegExp.lastIndex);\n                tokenRegExp.lastIndex = index;\n                continue;\n              }\n              isValidElement = false;\n            }\n            if (!validate || (elementRule = schema.getElementRule(value))) {\n              isValidElement = true;\n              if (validate) {\n                validAttributesMap = elementRule.attributes;\n                validAttributePatterns = elementRule.attributePatterns;\n              }\n              if (attribsValue = matches[9]) {\n                isInternalElement = attribsValue.indexOf('data-mce-type') !== -1;\n                if (isInternalElement && removeInternalElements) {\n                  isValidElement = false;\n                }\n                attrList = [];\n                attrList.map = {};\n                attribsValue.replace(attrRegExp, function (match, name, val, val2, val3) {\n                  parseAttribute(value, name, val, val2, val3);\n                  return '';\n                });\n              } else {\n                attrList = [];\n                attrList.map = {};\n              }\n              if (validate && !isInternalElement) {\n                attributesRequired = elementRule.attributesRequired;\n                attributesDefault = elementRule.attributesDefault;\n                attributesForced = elementRule.attributesForced;\n                anyAttributesRequired = elementRule.removeEmptyAttrs;\n                if (anyAttributesRequired && !attrList.length) {\n                  isValidElement = false;\n                }\n                if (attributesForced) {\n                  i = attributesForced.length;\n                  while (i--) {\n                    attr = attributesForced[i];\n                    name = attr.name;\n                    attrValue = attr.value;\n                    if (attrValue === '{$uid}') {\n                      attrValue = 'mce_' + idCount++;\n                    }\n                    attrList.map[name] = attrValue;\n                    attrList.push({\n                      name: name,\n                      value: attrValue\n                    });\n                  }\n                }\n                if (attributesDefault) {\n                  i = attributesDefault.length;\n                  while (i--) {\n                    attr = attributesDefault[i];\n                    name = attr.name;\n                    if (!(name in attrList.map)) {\n                      attrValue = attr.value;\n                      if (attrValue === '{$uid}') {\n                        attrValue = 'mce_' + idCount++;\n                      }\n                      attrList.map[name] = attrValue;\n                      attrList.push({\n                        name: name,\n                        value: attrValue\n                      });\n                    }\n                  }\n                }\n                if (attributesRequired) {\n                  i = attributesRequired.length;\n                  while (i--) {\n                    if (attributesRequired[i] in attrList.map) {\n                      break;\n                    }\n                  }\n                  if (i === -1) {\n                    isValidElement = false;\n                  }\n                }\n                if (attr = attrList.map['data-mce-bogus']) {\n                  if (attr === 'all') {\n                    index = findEndTagIndex(schema, html, tokenRegExp.lastIndex);\n                    tokenRegExp.lastIndex = index;\n                    continue;\n                  }\n                  isValidElement = false;\n                }\n              }\n              if (isValidElement) {\n                start(value, attrList, isShortEnded);\n              }\n            } else {\n              isValidElement = false;\n            }\n            if (endRegExp = specialElements[value]) {\n              endRegExp.lastIndex = index = matches.index + matchText.length;\n              if (matches = endRegExp.exec(html)) {\n                if (isValidElement) {\n                  textData = html.substr(index, matches.index - index);\n                }\n                index = matches.index + matches[0].length;\n              } else {\n                textData = html.substr(index);\n                index = html.length;\n              }\n              if (isValidElement) {\n                if (textData.length > 0) {\n                  processText(textData, true);\n                }\n                end(value);\n              }\n              tokenRegExp.lastIndex = index;\n              continue;\n            }\n            if (!isShortEnded) {\n              if (!attribsValue || attribsValue.indexOf('/') !== attribsValue.length - 1) {\n                stack.push({\n                  name: value,\n                  valid: isValidElement\n                });\n              } else if (isValidElement) {\n                end(value);\n              }\n            }\n          } else if (value = matches[1]) {\n            processComment(value);\n          } else if (value = matches[2]) {\n            var isValidCdataSection = parsingMode === 1 || settings.preserve_cdata || stack.length > 0 && schema.isValidChild(stack[stack.length - 1].name, '#cdata');\n            if (isValidCdataSection) {\n              cdata(value);\n            } else {\n              index = processMalformedComment('', matches.index + 2);\n              tokenRegExp.lastIndex = index;\n              continue;\n            }\n          } else if (value = matches[3]) {\n            doctype(value);\n          } else if ((value = matches[4]) || matchText === '<!') {\n            index = processMalformedComment(value, matches.index + matchText.length);\n            tokenRegExp.lastIndex = index;\n            continue;\n          } else if (value = matches[5]) {\n            if (parsingMode === 1) {\n              pi(value, matches[6]);\n            } else {\n              index = processMalformedComment('?', matches.index + 2);\n              tokenRegExp.lastIndex = index;\n              continue;\n            }\n          }\n          index = matches.index + matchText.length;\n        }\n        if (index < html.length) {\n          processText(decode(html.substr(index)));\n        }\n        for (i = stack.length - 1; i >= 0; i--) {\n          value = stack[i];\n          if (value.valid) {\n            end(value.name);\n          }\n        }\n      };\n      var parse = function (html, format) {\n        if (format === void 0) {\n          format = 'html';\n        }\n        parseInternal(extractBase64DataUris(html), format);\n      };\n      return { parse: parse };\n    };\n    SaxParser.findEndTag = findEndTagIndex;\n\n    var trimHtml = function (tempAttrs, html) {\n      var trimContentRegExp = new RegExp(['\\\\s?(' + tempAttrs.join('|') + ')=\"[^\"]+\"'].join('|'), 'gi');\n      return html.replace(trimContentRegExp, '');\n    };\n    var trimInternal = function (serializer, html) {\n      var content = html;\n      var bogusAllRegExp = /<(\\w+) [^>]*data-mce-bogus=\"all\"[^>]*>/g;\n      var endTagIndex, index, matchLength, matches;\n      var schema = serializer.schema;\n      content = trimHtml(serializer.getTempAttrs(), content);\n      var shortEndedElements = schema.getShortEndedElements();\n      while (matches = bogusAllRegExp.exec(content)) {\n        index = bogusAllRegExp.lastIndex;\n        matchLength = matches[0].length;\n        if (shortEndedElements[matches[1]]) {\n          endTagIndex = index;\n        } else {\n          endTagIndex = SaxParser.findEndTag(schema, content, index);\n        }\n        content = content.substring(0, index - matchLength) + content.substring(endTagIndex);\n        bogusAllRegExp.lastIndex = index - matchLength;\n      }\n      return trim$2(content);\n    };\n    var trimExternal = trimInternal;\n\n    var trimEmptyContents = function (editor, html) {\n      var blockName = getForcedRootBlock(editor);\n      var emptyRegExp = new RegExp('^(<' + blockName + '[^>]*>(&nbsp;|&#160;|\\\\s|\\xA0|<br \\\\/>|)<\\\\/' + blockName + '>[\\r\\n]*|<br \\\\/>[\\r\\n]*)$');\n      return html.replace(emptyRegExp, '');\n    };\n    var getContentFromBody = function (editor, args, format, body) {\n      var content;\n      args.format = format;\n      args.get = true;\n      args.getInner = true;\n      if (!args.no_events) {\n        editor.fire('BeforeGetContent', args);\n      }\n      if (args.format === 'raw') {\n        content = Tools.trim(trimExternal(editor.serializer, body.innerHTML));\n      } else if (args.format === 'text') {\n        content = editor.dom.isEmpty(body) ? '' : trim$2(body.innerText || body.textContent);\n      } else if (args.format === 'tree') {\n        content = editor.serializer.serialize(body, args);\n      } else {\n        content = trimEmptyContents(editor, editor.serializer.serialize(body, args));\n      }\n      if (!contains([\n          'text',\n          'tree'\n        ], args.format) && !isWsPreserveElement(SugarElement.fromDom(body))) {\n        args.content = Tools.trim(content);\n      } else {\n        args.content = content;\n      }\n      if (!args.no_events) {\n        editor.fire('GetContent', args);\n      }\n      return args.content;\n    };\n    var getContentInternal = function (editor, args, format) {\n      return Optional.from(editor.getBody()).fold(constant(args.format === 'tree' ? new AstNode('body', 11) : ''), function (body) {\n        return getContentFromBody(editor, args, format, body);\n      });\n    };\n\n    var each$7 = Tools.each;\n    var ElementUtils = function (dom) {\n      var compare = function (node1, node2) {\n        if (node1.nodeName !== node2.nodeName) {\n          return false;\n        }\n        var getAttribs = function (node) {\n          var attribs = {};\n          each$7(dom.getAttribs(node), function (attr) {\n            var name = attr.nodeName.toLowerCase();\n            if (name.indexOf('_') !== 0 && name !== 'style' && name.indexOf('data-') !== 0) {\n              attribs[name] = dom.getAttrib(node, name);\n            }\n          });\n          return attribs;\n        };\n        var compareObjects = function (obj1, obj2) {\n          var value, name;\n          for (name in obj1) {\n            if (obj1.hasOwnProperty(name)) {\n              value = obj2[name];\n              if (typeof value === 'undefined') {\n                return false;\n              }\n              if (obj1[name] !== value) {\n                return false;\n              }\n              delete obj2[name];\n            }\n          }\n          for (name in obj2) {\n            if (obj2.hasOwnProperty(name)) {\n              return false;\n            }\n          }\n          return true;\n        };\n        if (!compareObjects(getAttribs(node1), getAttribs(node2))) {\n          return false;\n        }\n        if (!compareObjects(dom.parseStyle(dom.getAttrib(node1, 'style')), dom.parseStyle(dom.getAttrib(node2, 'style')))) {\n          return false;\n        }\n        return !isBookmarkNode$1(node1) && !isBookmarkNode$1(node2);\n      };\n      return { compare: compare };\n    };\n\n    var makeMap$3 = Tools.makeMap;\n    var Writer = function (settings) {\n      var html = [];\n      settings = settings || {};\n      var indent = settings.indent;\n      var indentBefore = makeMap$3(settings.indent_before || '');\n      var indentAfter = makeMap$3(settings.indent_after || '');\n      var encode = Entities.getEncodeFunc(settings.entity_encoding || 'raw', settings.entities);\n      var htmlOutput = settings.element_format === 'html';\n      return {\n        start: function (name, attrs, empty) {\n          var i, l, attr, value;\n          if (indent && indentBefore[name] && html.length > 0) {\n            value = html[html.length - 1];\n            if (value.length > 0 && value !== '\\n') {\n              html.push('\\n');\n            }\n          }\n          html.push('<', name);\n          if (attrs) {\n            for (i = 0, l = attrs.length; i < l; i++) {\n              attr = attrs[i];\n              html.push(' ', attr.name, '=\"', encode(attr.value, true), '\"');\n            }\n          }\n          if (!empty || htmlOutput) {\n            html[html.length] = '>';\n          } else {\n            html[html.length] = ' />';\n          }\n          if (empty && indent && indentAfter[name] && html.length > 0) {\n            value = html[html.length - 1];\n            if (value.length > 0 && value !== '\\n') {\n              html.push('\\n');\n            }\n          }\n        },\n        end: function (name) {\n          var value;\n          html.push('</', name, '>');\n          if (indent && indentAfter[name] && html.length > 0) {\n            value = html[html.length - 1];\n            if (value.length > 0 && value !== '\\n') {\n              html.push('\\n');\n            }\n          }\n        },\n        text: function (text, raw) {\n          if (text.length > 0) {\n            html[html.length] = raw ? text : encode(text);\n          }\n        },\n        cdata: function (text) {\n          html.push('<![CDATA[', text, ']]>');\n        },\n        comment: function (text) {\n          html.push('<!--', text, '-->');\n        },\n        pi: function (name, text) {\n          if (text) {\n            html.push('<?', name, ' ', encode(text), '?>');\n          } else {\n            html.push('<?', name, '?>');\n          }\n          if (indent) {\n            html.push('\\n');\n          }\n        },\n        doctype: function (text) {\n          html.push('<!DOCTYPE', text, '>', indent ? '\\n' : '');\n        },\n        reset: function () {\n          html.length = 0;\n        },\n        getContent: function () {\n          return html.join('').replace(/\\n$/, '');\n        }\n      };\n    };\n\n    var HtmlSerializer = function (settings, schema) {\n      if (schema === void 0) {\n        schema = Schema();\n      }\n      var writer = Writer(settings);\n      settings = settings || {};\n      settings.validate = 'validate' in settings ? settings.validate : true;\n      var serialize = function (node) {\n        var validate = settings.validate;\n        var handlers = {\n          3: function (node) {\n            writer.text(node.value, node.raw);\n          },\n          8: function (node) {\n            writer.comment(node.value);\n          },\n          7: function (node) {\n            writer.pi(node.name, node.value);\n          },\n          10: function (node) {\n            writer.doctype(node.value);\n          },\n          4: function (node) {\n            writer.cdata(node.value);\n          },\n          11: function (node) {\n            if (node = node.firstChild) {\n              do {\n                walk(node);\n              } while (node = node.next);\n            }\n          }\n        };\n        writer.reset();\n        var walk = function (node) {\n          var handler = handlers[node.type];\n          var name, isEmpty, attrs, attrName, attrValue, sortedAttrs, i, l, elementRule;\n          if (!handler) {\n            name = node.name;\n            isEmpty = node.shortEnded;\n            attrs = node.attributes;\n            if (validate && attrs && attrs.length > 1) {\n              sortedAttrs = [];\n              sortedAttrs.map = {};\n              elementRule = schema.getElementRule(node.name);\n              if (elementRule) {\n                for (i = 0, l = elementRule.attributesOrder.length; i < l; i++) {\n                  attrName = elementRule.attributesOrder[i];\n                  if (attrName in attrs.map) {\n                    attrValue = attrs.map[attrName];\n                    sortedAttrs.map[attrName] = attrValue;\n                    sortedAttrs.push({\n                      name: attrName,\n                      value: attrValue\n                    });\n                  }\n                }\n                for (i = 0, l = attrs.length; i < l; i++) {\n                  attrName = attrs[i].name;\n                  if (!(attrName in sortedAttrs.map)) {\n                    attrValue = attrs.map[attrName];\n                    sortedAttrs.map[attrName] = attrValue;\n                    sortedAttrs.push({\n                      name: attrName,\n                      value: attrValue\n                    });\n                  }\n                }\n                attrs = sortedAttrs;\n              }\n            }\n            writer.start(node.name, attrs, isEmpty);\n            if (!isEmpty) {\n              if (node = node.firstChild) {\n                do {\n                  walk(node);\n                } while (node = node.next);\n              }\n              writer.end(name);\n            }\n          } else {\n            handler(node);\n          }\n        };\n        if (node.type === 1 && !settings.inner) {\n          walk(node);\n        } else {\n          handlers[11](node);\n        }\n        return writer.getContent();\n      };\n      return { serialize: serialize };\n    };\n\n    var nonInheritableStyles = new Set();\n    (function () {\n      var nonInheritableStylesArr = [\n        'margin',\n        'margin-left',\n        'margin-right',\n        'margin-top',\n        'margin-bottom',\n        'padding',\n        'padding-left',\n        'padding-right',\n        'padding-top',\n        'padding-bottom',\n        'border',\n        'border-width',\n        'border-style',\n        'border-color',\n        'background',\n        'background-attachment',\n        'background-clip',\n        'background-color',\n        'background-image',\n        'background-origin',\n        'background-position',\n        'background-repeat',\n        'background-size',\n        'float',\n        'position',\n        'left',\n        'right',\n        'top',\n        'bottom',\n        'z-index',\n        'display',\n        'transform',\n        'width',\n        'max-width',\n        'min-width',\n        'height',\n        'max-height',\n        'min-height',\n        'overflow',\n        'overflow-x',\n        'overflow-y',\n        'text-overflow',\n        'vertical-align',\n        'transition',\n        'transition-delay',\n        'transition-duration',\n        'transition-property',\n        'transition-timing-function'\n      ];\n      each(nonInheritableStylesArr, function (style) {\n        nonInheritableStyles.add(style);\n      });\n    }());\n    var shorthandStyleProps = [\n      'font',\n      'text-decoration',\n      'text-emphasis'\n    ];\n    var getStyleProps = function (dom, node) {\n      return keys(dom.parseStyle(dom.getAttrib(node, 'style')));\n    };\n    var isNonInheritableStyle = function (style) {\n      return nonInheritableStyles.has(style);\n    };\n    var hasInheritableStyles = function (dom, node) {\n      return forall(getStyleProps(dom, node), function (style) {\n        return !isNonInheritableStyle(style);\n      });\n    };\n    var getLonghandStyleProps = function (styles) {\n      return filter(styles, function (style) {\n        return exists(shorthandStyleProps, function (prop) {\n          return startsWith(style, prop);\n        });\n      });\n    };\n    var hasStyleConflict = function (dom, node, parentNode) {\n      var nodeStyleProps = getStyleProps(dom, node);\n      var parentNodeStyleProps = getStyleProps(dom, parentNode);\n      var valueMismatch = function (prop) {\n        var nodeValue = dom.getStyle(node, prop);\n        var parentValue = dom.getStyle(parentNode, prop);\n        return isNotEmpty(nodeValue) && isNotEmpty(parentValue) && nodeValue !== parentValue;\n      };\n      return exists(nodeStyleProps, function (nodeStyleProp) {\n        var propExists = function (props) {\n          return exists(props, function (prop) {\n            return prop === nodeStyleProp;\n          });\n        };\n        if (!propExists(parentNodeStyleProps) && propExists(shorthandStyleProps)) {\n          var longhandProps = getLonghandStyleProps(parentNodeStyleProps);\n          return exists(longhandProps, valueMismatch);\n        } else {\n          return valueMismatch(nodeStyleProp);\n        }\n      });\n    };\n\n    var isChar = function (forward, predicate, pos) {\n      return Optional.from(pos.container()).filter(isText$1).exists(function (text) {\n        var delta = forward ? 0 : -1;\n        return predicate(text.data.charAt(pos.offset() + delta));\n      });\n    };\n    var isBeforeSpace = curry(isChar, true, isWhiteSpace$1);\n    var isAfterSpace = curry(isChar, false, isWhiteSpace$1);\n    var isEmptyText = function (pos) {\n      var container = pos.container();\n      return isText$1(container) && (container.data.length === 0 || isZwsp$1(container.data) && BookmarkManager.isBookmarkNode(container.parentNode));\n    };\n    var matchesElementPosition = function (before, predicate) {\n      return function (pos) {\n        return Optional.from(getChildNodeAtRelativeOffset(before ? 0 : -1, pos)).filter(predicate).isSome();\n      };\n    };\n    var isImageBlock = function (node) {\n      return isImg(node) && get$5(SugarElement.fromDom(node), 'display') === 'block';\n    };\n    var isCefNode = function (node) {\n      return isContentEditableFalse(node) && !isBogusAll(node);\n    };\n    var isBeforeImageBlock = matchesElementPosition(true, isImageBlock);\n    var isAfterImageBlock = matchesElementPosition(false, isImageBlock);\n    var isBeforeMedia = matchesElementPosition(true, isMedia);\n    var isAfterMedia = matchesElementPosition(false, isMedia);\n    var isBeforeTable = matchesElementPosition(true, isTable);\n    var isAfterTable = matchesElementPosition(false, isTable);\n    var isBeforeContentEditableFalse = matchesElementPosition(true, isCefNode);\n    var isAfterContentEditableFalse = matchesElementPosition(false, isCefNode);\n\n    var getLastChildren$1 = function (elm) {\n      var children = [];\n      var rawNode = elm.dom;\n      while (rawNode) {\n        children.push(SugarElement.fromDom(rawNode));\n        rawNode = rawNode.lastChild;\n      }\n      return children;\n    };\n    var removeTrailingBr = function (elm) {\n      var allBrs = descendants$1(elm, 'br');\n      var brs = filter(getLastChildren$1(elm).slice(-1), isBr$1);\n      if (allBrs.length === brs.length) {\n        each(brs, remove);\n      }\n    };\n    var fillWithPaddingBr = function (elm) {\n      empty(elm);\n      append(elm, SugarElement.fromHtml('<br data-mce-bogus=\"1\">'));\n    };\n    var trimBlockTrailingBr = function (elm) {\n      lastChild(elm).each(function (lastChild) {\n        prevSibling(lastChild).each(function (lastChildPrevSibling) {\n          if (isBlock(elm) && isBr$1(lastChild) && isBlock(lastChildPrevSibling)) {\n            remove(lastChild);\n          }\n        });\n      });\n    };\n\n    var dropLast = function (xs) {\n      return xs.slice(0, -1);\n    };\n    var parentsUntil$1 = function (start, root, predicate) {\n      if (contains$2(root, start)) {\n        return dropLast(parents(start, function (elm) {\n          return predicate(elm) || eq$2(elm, root);\n        }));\n      } else {\n        return [];\n      }\n    };\n    var parents$1 = function (start, root) {\n      return parentsUntil$1(start, root, never);\n    };\n    var parentsAndSelf = function (start, root) {\n      return [start].concat(parents$1(start, root));\n    };\n\n    var navigateIgnoreEmptyTextNodes = function (forward, root, from) {\n      return navigateIgnore(forward, root, from, isEmptyText);\n    };\n    var getClosestBlock = function (root, pos) {\n      return find(parentsAndSelf(SugarElement.fromDom(pos.container()), root), isBlock);\n    };\n    var isAtBeforeAfterBlockBoundary = function (forward, root, pos) {\n      return navigateIgnoreEmptyTextNodes(forward, root.dom, pos).forall(function (newPos) {\n        return getClosestBlock(root, pos).fold(function () {\n          return isInSameBlock(newPos, pos, root.dom) === false;\n        }, function (fromBlock) {\n          return isInSameBlock(newPos, pos, root.dom) === false && contains$2(fromBlock, SugarElement.fromDom(newPos.container()));\n        });\n      });\n    };\n    var isAtBlockBoundary$1 = function (forward, root, pos) {\n      return getClosestBlock(root, pos).fold(function () {\n        return navigateIgnoreEmptyTextNodes(forward, root.dom, pos).forall(function (newPos) {\n          return isInSameBlock(newPos, pos, root.dom) === false;\n        });\n      }, function (parent) {\n        return navigateIgnoreEmptyTextNodes(forward, parent.dom, pos).isNone();\n      });\n    };\n    var isAtStartOfBlock = curry(isAtBlockBoundary$1, false);\n    var isAtEndOfBlock = curry(isAtBlockBoundary$1, true);\n    var isBeforeBlock = curry(isAtBeforeAfterBlockBoundary, false);\n    var isAfterBlock = curry(isAtBeforeAfterBlockBoundary, true);\n\n    var isBr$5 = function (pos) {\n      return getElementFromPosition(pos).exists(isBr$1);\n    };\n    var findBr = function (forward, root, pos) {\n      var parentBlocks = filter(parentsAndSelf(SugarElement.fromDom(pos.container()), root), isBlock);\n      var scope = head(parentBlocks).getOr(root);\n      return fromPosition(forward, scope.dom, pos).filter(isBr$5);\n    };\n    var isBeforeBr = function (root, pos) {\n      return getElementFromPosition(pos).exists(isBr$1) || findBr(true, root, pos).isSome();\n    };\n    var isAfterBr = function (root, pos) {\n      return getElementFromPrevPosition(pos).exists(isBr$1) || findBr(false, root, pos).isSome();\n    };\n    var findPreviousBr = curry(findBr, false);\n    var findNextBr = curry(findBr, true);\n\n    var isInMiddleOfText = function (pos) {\n      return CaretPosition.isTextPosition(pos) && !pos.isAtStart() && !pos.isAtEnd();\n    };\n    var getClosestBlock$1 = function (root, pos) {\n      var parentBlocks = filter(parentsAndSelf(SugarElement.fromDom(pos.container()), root), isBlock);\n      return head(parentBlocks).getOr(root);\n    };\n    var hasSpaceBefore = function (root, pos) {\n      if (isInMiddleOfText(pos)) {\n        return isAfterSpace(pos);\n      } else {\n        return isAfterSpace(pos) || prevPosition(getClosestBlock$1(root, pos).dom, pos).exists(isAfterSpace);\n      }\n    };\n    var hasSpaceAfter = function (root, pos) {\n      if (isInMiddleOfText(pos)) {\n        return isBeforeSpace(pos);\n      } else {\n        return isBeforeSpace(pos) || nextPosition(getClosestBlock$1(root, pos).dom, pos).exists(isBeforeSpace);\n      }\n    };\n    var isPreValue = function (value) {\n      return contains([\n        'pre',\n        'pre-wrap'\n      ], value);\n    };\n    var isInPre = function (pos) {\n      return getElementFromPosition(pos).bind(function (elm) {\n        return closest(elm, isElement);\n      }).exists(function (elm) {\n        return isPreValue(get$5(elm, 'white-space'));\n      });\n    };\n    var isAtBeginningOfBody = function (root, pos) {\n      return prevPosition(root.dom, pos).isNone();\n    };\n    var isAtEndOfBody = function (root, pos) {\n      return nextPosition(root.dom, pos).isNone();\n    };\n    var isAtLineBoundary = function (root, pos) {\n      return isAtBeginningOfBody(root, pos) || isAtEndOfBody(root, pos) || isAtStartOfBlock(root, pos) || isAtEndOfBlock(root, pos) || isAfterBr(root, pos) || isBeforeBr(root, pos);\n    };\n    var needsToHaveNbsp = function (root, pos) {\n      if (isInPre(pos)) {\n        return false;\n      } else {\n        return isAtLineBoundary(root, pos) || hasSpaceBefore(root, pos) || hasSpaceAfter(root, pos);\n      }\n    };\n    var needsToBeNbspLeft = function (root, pos) {\n      if (isInPre(pos)) {\n        return false;\n      } else {\n        return isAtStartOfBlock(root, pos) || isBeforeBlock(root, pos) || isAfterBr(root, pos) || hasSpaceBefore(root, pos);\n      }\n    };\n    var leanRight = function (pos) {\n      var container = pos.container();\n      var offset = pos.offset();\n      if (isText$1(container) && offset < container.data.length) {\n        return CaretPosition(container, offset + 1);\n      } else {\n        return pos;\n      }\n    };\n    var needsToBeNbspRight = function (root, pos) {\n      if (isInPre(pos)) {\n        return false;\n      } else {\n        return isAtEndOfBlock(root, pos) || isAfterBlock(root, pos) || isBeforeBr(root, pos) || hasSpaceAfter(root, pos);\n      }\n    };\n    var needsToBeNbsp = function (root, pos) {\n      return needsToBeNbspLeft(root, pos) || needsToBeNbspRight(root, leanRight(pos));\n    };\n    var isNbspAt = function (text, offset) {\n      return isNbsp(text.charAt(offset));\n    };\n    var hasNbsp = function (pos) {\n      var container = pos.container();\n      return isText$1(container) && contains$1(container.data, nbsp);\n    };\n    var normalizeNbspMiddle = function (text) {\n      var chars = text.split('');\n      return map(chars, function (chr, i) {\n        if (isNbsp(chr) && i > 0 && i < chars.length - 1 && isContent$1(chars[i - 1]) && isContent$1(chars[i + 1])) {\n          return ' ';\n        } else {\n          return chr;\n        }\n      }).join('');\n    };\n    var normalizeNbspAtStart = function (root, node) {\n      var text = node.data;\n      var firstPos = CaretPosition(node, 0);\n      if (isNbspAt(text, 0) && !needsToBeNbsp(root, firstPos)) {\n        node.data = ' ' + text.slice(1);\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var normalizeNbspInMiddleOfTextNode = function (node) {\n      var text = node.data;\n      var newText = normalizeNbspMiddle(text);\n      if (newText !== text) {\n        node.data = newText;\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var normalizeNbspAtEnd = function (root, node) {\n      var text = node.data;\n      var lastPos = CaretPosition(node, text.length - 1);\n      if (isNbspAt(text, text.length - 1) && !needsToBeNbsp(root, lastPos)) {\n        node.data = text.slice(0, -1) + ' ';\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var normalizeNbsps = function (root, pos) {\n      return Optional.some(pos).filter(hasNbsp).bind(function (pos) {\n        var container = pos.container();\n        var normalized = normalizeNbspAtStart(root, container) || normalizeNbspInMiddleOfTextNode(container) || normalizeNbspAtEnd(root, container);\n        return normalized ? Optional.some(pos) : Optional.none();\n      });\n    };\n    var normalizeNbspsInEditor = function (editor) {\n      var root = SugarElement.fromDom(editor.getBody());\n      if (editor.selection.isCollapsed()) {\n        normalizeNbsps(root, CaretPosition.fromRangeStart(editor.selection.getRng())).each(function (pos) {\n          editor.selection.setRng(pos.toRange());\n        });\n      }\n    };\n\n    var normalizeContent = function (content, isStartOfContent, isEndOfContent) {\n      var result = foldl(content, function (acc, c) {\n        if (isWhiteSpace$1(c) || isNbsp(c)) {\n          if (acc.previousCharIsSpace || acc.str === '' && isStartOfContent || acc.str.length === content.length - 1 && isEndOfContent) {\n            return {\n              previousCharIsSpace: false,\n              str: acc.str + nbsp\n            };\n          } else {\n            return {\n              previousCharIsSpace: true,\n              str: acc.str + ' '\n            };\n          }\n        } else {\n          return {\n            previousCharIsSpace: false,\n            str: acc.str + c\n          };\n        }\n      }, {\n        previousCharIsSpace: false,\n        str: ''\n      });\n      return result.str;\n    };\n    var normalize$1 = function (node, offset, count) {\n      if (count === 0) {\n        return;\n      }\n      var elm = SugarElement.fromDom(node);\n      var root = ancestor(elm, isBlock).getOr(elm);\n      var whitespace = node.data.slice(offset, offset + count);\n      var isEndOfContent = offset + count >= node.data.length && needsToBeNbspRight(root, CaretPosition(node, node.data.length));\n      var isStartOfContent = offset === 0 && needsToBeNbspLeft(root, CaretPosition(node, 0));\n      node.replaceData(offset, count, normalizeContent(whitespace, isStartOfContent, isEndOfContent));\n    };\n    var normalizeWhitespaceAfter = function (node, offset) {\n      var content = node.data.slice(offset);\n      var whitespaceCount = content.length - lTrim(content).length;\n      return normalize$1(node, offset, whitespaceCount);\n    };\n    var normalizeWhitespaceBefore = function (node, offset) {\n      var content = node.data.slice(0, offset);\n      var whitespaceCount = content.length - rTrim(content).length;\n      return normalize$1(node, offset - whitespaceCount, whitespaceCount);\n    };\n    var mergeTextNodes = function (prevNode, nextNode, normalizeWhitespace, mergeToPrev) {\n      if (mergeToPrev === void 0) {\n        mergeToPrev = true;\n      }\n      var whitespaceOffset = rTrim(prevNode.data).length;\n      var newNode = mergeToPrev ? prevNode : nextNode;\n      var removeNode = mergeToPrev ? nextNode : prevNode;\n      if (mergeToPrev) {\n        newNode.appendData(removeNode.data);\n      } else {\n        newNode.insertData(0, removeNode.data);\n      }\n      remove(SugarElement.fromDom(removeNode));\n      if (normalizeWhitespace) {\n        normalizeWhitespaceAfter(newNode, whitespaceOffset);\n      }\n      return newNode;\n    };\n\n    var needsReposition = function (pos, elm) {\n      var container = pos.container();\n      var offset = pos.offset();\n      return CaretPosition.isTextPosition(pos) === false && container === elm.parentNode && offset > CaretPosition.before(elm).offset();\n    };\n    var reposition = function (elm, pos) {\n      return needsReposition(pos, elm) ? CaretPosition(pos.container(), pos.offset() - 1) : pos;\n    };\n    var beforeOrStartOf = function (node) {\n      return isText$1(node) ? CaretPosition(node, 0) : CaretPosition.before(node);\n    };\n    var afterOrEndOf = function (node) {\n      return isText$1(node) ? CaretPosition(node, node.data.length) : CaretPosition.after(node);\n    };\n    var getPreviousSiblingCaretPosition = function (elm) {\n      if (isCaretCandidate(elm.previousSibling)) {\n        return Optional.some(afterOrEndOf(elm.previousSibling));\n      } else {\n        return elm.previousSibling ? lastPositionIn(elm.previousSibling) : Optional.none();\n      }\n    };\n    var getNextSiblingCaretPosition = function (elm) {\n      if (isCaretCandidate(elm.nextSibling)) {\n        return Optional.some(beforeOrStartOf(elm.nextSibling));\n      } else {\n        return elm.nextSibling ? firstPositionIn(elm.nextSibling) : Optional.none();\n      }\n    };\n    var findCaretPositionBackwardsFromElm = function (rootElement, elm) {\n      var startPosition = CaretPosition.before(elm.previousSibling ? elm.previousSibling : elm.parentNode);\n      return prevPosition(rootElement, startPosition).fold(function () {\n        return nextPosition(rootElement, CaretPosition.after(elm));\n      }, Optional.some);\n    };\n    var findCaretPositionForwardsFromElm = function (rootElement, elm) {\n      return nextPosition(rootElement, CaretPosition.after(elm)).fold(function () {\n        return prevPosition(rootElement, CaretPosition.before(elm));\n      }, Optional.some);\n    };\n    var findCaretPositionBackwards = function (rootElement, elm) {\n      return getPreviousSiblingCaretPosition(elm).orThunk(function () {\n        return getNextSiblingCaretPosition(elm);\n      }).orThunk(function () {\n        return findCaretPositionBackwardsFromElm(rootElement, elm);\n      });\n    };\n    var findCaretPositionForward = function (rootElement, elm) {\n      return getNextSiblingCaretPosition(elm).orThunk(function () {\n        return getPreviousSiblingCaretPosition(elm);\n      }).orThunk(function () {\n        return findCaretPositionForwardsFromElm(rootElement, elm);\n      });\n    };\n    var findCaretPosition$1 = function (forward, rootElement, elm) {\n      return forward ? findCaretPositionForward(rootElement, elm) : findCaretPositionBackwards(rootElement, elm);\n    };\n    var findCaretPosOutsideElmAfterDelete = function (forward, rootElement, elm) {\n      return findCaretPosition$1(forward, rootElement, elm).map(curry(reposition, elm));\n    };\n    var setSelection = function (editor, forward, pos) {\n      pos.fold(function () {\n        editor.focus();\n      }, function (pos) {\n        editor.selection.setRng(pos.toRange(), forward);\n      });\n    };\n    var eqRawNode = function (rawNode) {\n      return function (elm) {\n        return elm.dom === rawNode;\n      };\n    };\n    var isBlock$2 = function (editor, elm) {\n      return elm && has(editor.schema.getBlockElements(), name(elm));\n    };\n    var paddEmptyBlock = function (elm) {\n      if (isEmpty(elm)) {\n        var br = SugarElement.fromHtml('<br data-mce-bogus=\"1\">');\n        empty(elm);\n        append(elm, br);\n        return Optional.some(CaretPosition.before(br.dom));\n      } else {\n        return Optional.none();\n      }\n    };\n    var deleteNormalized = function (elm, afterDeletePosOpt, normalizeWhitespace) {\n      var prevTextOpt = prevSibling(elm).filter(isText);\n      var nextTextOpt = nextSibling(elm).filter(isText);\n      remove(elm);\n      return lift3(prevTextOpt, nextTextOpt, afterDeletePosOpt, function (prev, next, pos) {\n        var prevNode = prev.dom, nextNode = next.dom;\n        var offset = prevNode.data.length;\n        mergeTextNodes(prevNode, nextNode, normalizeWhitespace);\n        return pos.container() === nextNode ? CaretPosition(prevNode, offset) : pos;\n      }).orThunk(function () {\n        if (normalizeWhitespace) {\n          prevTextOpt.each(function (elm) {\n            return normalizeWhitespaceBefore(elm.dom, elm.dom.length);\n          });\n          nextTextOpt.each(function (elm) {\n            return normalizeWhitespaceAfter(elm.dom, 0);\n          });\n        }\n        return afterDeletePosOpt;\n      });\n    };\n    var isInlineElement = function (editor, element) {\n      return has(editor.schema.getTextInlineElements(), name(element));\n    };\n    var deleteElement = function (editor, forward, elm, moveCaret) {\n      if (moveCaret === void 0) {\n        moveCaret = true;\n      }\n      var afterDeletePos = findCaretPosOutsideElmAfterDelete(forward, editor.getBody(), elm.dom);\n      var parentBlock = ancestor(elm, curry(isBlock$2, editor), eqRawNode(editor.getBody()));\n      var normalizedAfterDeletePos = deleteNormalized(elm, afterDeletePos, isInlineElement(editor, elm));\n      if (editor.dom.isEmpty(editor.getBody())) {\n        editor.setContent('');\n        editor.selection.setCursorLocation();\n      } else {\n        parentBlock.bind(paddEmptyBlock).fold(function () {\n          if (moveCaret) {\n            setSelection(editor, forward, normalizedAfterDeletePos);\n          }\n        }, function (paddPos) {\n          if (moveCaret) {\n            setSelection(editor, forward, Optional.some(paddPos));\n          }\n        });\n      }\n    };\n\n    var tableCellRng = function (start, end) {\n      return {\n        start: start,\n        end: end\n      };\n    };\n    var tableSelection = function (rng, table, cells) {\n      return {\n        rng: rng,\n        table: table,\n        cells: cells\n      };\n    };\n    var deleteAction = Adt.generate([\n      { removeTable: ['element'] },\n      { emptyCells: ['cells'] },\n      {\n        deleteCellSelection: [\n          'rng',\n          'cell'\n        ]\n      }\n    ]);\n    var isRootFromElement = function (root) {\n      return function (cur) {\n        return eq$2(root, cur);\n      };\n    };\n    var getClosestCell = function (container, isRoot) {\n      return closest$1(SugarElement.fromDom(container), 'td,th', isRoot);\n    };\n    var getClosestTable = function (cell, isRoot) {\n      return ancestor$1(cell, 'table', isRoot);\n    };\n    var isExpandedCellRng = function (cellRng) {\n      return !eq$2(cellRng.start, cellRng.end);\n    };\n    var getTableFromCellRng = function (cellRng, isRoot) {\n      return getClosestTable(cellRng.start, isRoot).bind(function (startParentTable) {\n        return getClosestTable(cellRng.end, isRoot).bind(function (endParentTable) {\n          return someIf(eq$2(startParentTable, endParentTable), startParentTable);\n        });\n      });\n    };\n    var isSingleCellTable = function (cellRng, isRoot) {\n      return !isExpandedCellRng(cellRng) && getTableFromCellRng(cellRng, isRoot).exists(function (table) {\n        var rows = table.dom.rows;\n        return rows.length === 1 && rows[0].cells.length === 1;\n      });\n    };\n    var getTableCells = function (table) {\n      return descendants$1(table, 'td,th');\n    };\n    var getCellRng = function (rng, isRoot) {\n      var startCell = getClosestCell(rng.startContainer, isRoot);\n      var endCell = getClosestCell(rng.endContainer, isRoot);\n      return lift2(startCell, endCell, tableCellRng);\n    };\n    var getCellRangeFromStartTable = function (cellRng, isRoot) {\n      return getClosestTable(cellRng.start, isRoot).bind(function (table) {\n        return last(getTableCells(table)).map(function (endCell) {\n          return tableCellRng(cellRng.start, endCell);\n        });\n      });\n    };\n    var partialSelection = function (isRoot, rng) {\n      var startCell = getClosestCell(rng.startContainer, isRoot);\n      var endCell = getClosestCell(rng.endContainer, isRoot);\n      return rng.collapsed ? Optional.none() : lift2(startCell, endCell, tableCellRng).fold(function () {\n        return startCell.fold(function () {\n          return endCell.bind(function (endCell) {\n            return getClosestTable(endCell, isRoot).bind(function (table) {\n              return head(getTableCells(table)).map(function (startCell) {\n                return tableCellRng(startCell, endCell);\n              });\n            });\n          });\n        }, function (startCell) {\n          return getClosestTable(startCell, isRoot).bind(function (table) {\n            return last(getTableCells(table)).map(function (endCell) {\n              return tableCellRng(startCell, endCell);\n            });\n          });\n        });\n      }, function (cellRng) {\n        return isWithinSameTable(isRoot, cellRng) ? Optional.none() : getCellRangeFromStartTable(cellRng, isRoot);\n      });\n    };\n    var isWithinSameTable = function (isRoot, cellRng) {\n      return getTableFromCellRng(cellRng, isRoot).isSome();\n    };\n    var getTableSelectionFromCellRng = function (cellRng, isRoot) {\n      return getTableFromCellRng(cellRng, isRoot).map(function (table) {\n        return tableSelection(cellRng, table, getTableCells(table));\n      });\n    };\n    var getTableSelection = function (optCellRng, rng, isRoot) {\n      return optCellRng.filter(function (cellRng) {\n        return isExpandedCellRng(cellRng) && isWithinSameTable(isRoot, cellRng);\n      }).orThunk(function () {\n        return partialSelection(isRoot, rng);\n      }).bind(function (cRng) {\n        return getTableSelectionFromCellRng(cRng, isRoot);\n      });\n    };\n    var getCellIndex = function (cells, cell) {\n      return findIndex(cells, function (x) {\n        return eq$2(x, cell);\n      });\n    };\n    var getSelectedCells = function (tableSelection) {\n      return lift2(getCellIndex(tableSelection.cells, tableSelection.rng.start), getCellIndex(tableSelection.cells, tableSelection.rng.end), function (startIndex, endIndex) {\n        return tableSelection.cells.slice(startIndex, endIndex + 1);\n      });\n    };\n    var isSingleCellTableContentSelected = function (optCellRng, rng, isRoot) {\n      return optCellRng.filter(function (cellRng) {\n        return isSingleCellTable(cellRng, isRoot) && hasAllContentsSelected(cellRng.start, rng);\n      }).map(function (cellRng) {\n        return cellRng.start;\n      });\n    };\n    var getAction = function (tableSelection) {\n      return getSelectedCells(tableSelection).map(function (selected) {\n        var cells = tableSelection.cells;\n        return selected.length === cells.length ? deleteAction.removeTable(tableSelection.table) : deleteAction.emptyCells(selected);\n      });\n    };\n    var getActionFromRange = function (root, rng) {\n      var isRoot = isRootFromElement(root);\n      var optCellRng = getCellRng(rng, isRoot);\n      return isSingleCellTableContentSelected(optCellRng, rng, isRoot).map(function (cell) {\n        return deleteAction.deleteCellSelection(rng, cell);\n      }).orThunk(function () {\n        return getTableSelection(optCellRng, rng, isRoot).bind(getAction);\n      });\n    };\n\n    var freefallRtl = function (root) {\n      var child = isComment(root) ? prevSibling(root) : lastChild(root);\n      return child.bind(freefallRtl).orThunk(function () {\n        return Optional.some(root);\n      });\n    };\n    var emptyCells = function (editor, cells) {\n      each(cells, fillWithPaddingBr);\n      editor.selection.setCursorLocation(cells[0].dom, 0);\n      return true;\n    };\n    var deleteCellContents = function (editor, rng, cell) {\n      rng.deleteContents();\n      var lastNode = freefallRtl(cell).getOr(cell);\n      var lastBlock = SugarElement.fromDom(editor.dom.getParent(lastNode.dom, editor.dom.isBlock));\n      if (isEmpty(lastBlock)) {\n        fillWithPaddingBr(lastBlock);\n        editor.selection.setCursorLocation(lastBlock.dom, 0);\n      }\n      if (!eq$2(cell, lastBlock)) {\n        var additionalCleanupNodes = parent(lastBlock).is(cell) ? [] : siblings(lastBlock);\n        each(additionalCleanupNodes.concat(children(cell)), function (node) {\n          if (!eq$2(node, lastBlock) && !contains$2(node, lastBlock)) {\n            remove(node);\n          }\n        });\n      }\n      return true;\n    };\n    var deleteTableElement = function (editor, table) {\n      deleteElement(editor, false, table);\n      return true;\n    };\n    var deleteCellRange = function (editor, rootElm, rng) {\n      return getActionFromRange(rootElm, rng).map(function (action) {\n        return action.fold(curry(deleteTableElement, editor), curry(emptyCells, editor), curry(deleteCellContents, editor));\n      });\n    };\n    var deleteCaptionRange = function (editor, caption) {\n      return emptyElement(editor, caption);\n    };\n    var deleteTableRange = function (editor, rootElm, rng, startElm) {\n      return getParentCaption(rootElm, startElm).fold(function () {\n        return deleteCellRange(editor, rootElm, rng);\n      }, function (caption) {\n        return deleteCaptionRange(editor, caption);\n      }).getOr(false);\n    };\n    var deleteRange = function (editor, startElm) {\n      var rootNode = SugarElement.fromDom(editor.getBody());\n      var rng = editor.selection.getRng();\n      var selectedCells = getCellsFromEditor(editor);\n      return selectedCells.length !== 0 ? emptyCells(editor, selectedCells) : deleteTableRange(editor, rootNode, rng, startElm);\n    };\n    var getParentCell = function (rootElm, elm) {\n      return find(parentsAndSelf(elm, rootElm), isTableCell$1);\n    };\n    var getParentCaption = function (rootElm, elm) {\n      return find(parentsAndSelf(elm, rootElm), function (elm) {\n        return name(elm) === 'caption';\n      });\n    };\n    var deleteBetweenCells = function (editor, rootElm, forward, fromCell, from) {\n      return navigate(forward, editor.getBody(), from).bind(function (to) {\n        return getParentCell(rootElm, SugarElement.fromDom(to.getNode())).map(function (toCell) {\n          return eq$2(toCell, fromCell) === false;\n        });\n      });\n    };\n    var emptyElement = function (editor, elm) {\n      fillWithPaddingBr(elm);\n      editor.selection.setCursorLocation(elm.dom, 0);\n      return Optional.some(true);\n    };\n    var isDeleteOfLastCharPos = function (fromCaption, forward, from, to) {\n      return firstPositionIn(fromCaption.dom).bind(function (first) {\n        return lastPositionIn(fromCaption.dom).map(function (last) {\n          return forward ? from.isEqual(first) && to.isEqual(last) : from.isEqual(last) && to.isEqual(first);\n        });\n      }).getOr(true);\n    };\n    var emptyCaretCaption = function (editor, elm) {\n      return emptyElement(editor, elm);\n    };\n    var validateCaretCaption = function (rootElm, fromCaption, to) {\n      return getParentCaption(rootElm, SugarElement.fromDom(to.getNode())).map(function (toCaption) {\n        return eq$2(toCaption, fromCaption) === false;\n      });\n    };\n    var deleteCaretInsideCaption = function (editor, rootElm, forward, fromCaption, from) {\n      return navigate(forward, editor.getBody(), from).bind(function (to) {\n        return isDeleteOfLastCharPos(fromCaption, forward, from, to) ? emptyCaretCaption(editor, fromCaption) : validateCaretCaption(rootElm, fromCaption, to);\n      }).or(Optional.some(true));\n    };\n    var deleteCaretCells = function (editor, forward, rootElm, startElm) {\n      var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return getParentCell(rootElm, startElm).bind(function (fromCell) {\n        return isEmpty(fromCell) ? emptyElement(editor, fromCell) : deleteBetweenCells(editor, rootElm, forward, fromCell, from);\n      }).getOr(false);\n    };\n    var deleteCaretCaption = function (editor, forward, rootElm, fromCaption) {\n      var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return isEmpty(fromCaption) ? emptyElement(editor, fromCaption) : deleteCaretInsideCaption(editor, rootElm, forward, fromCaption, from);\n    };\n    var isNearTable = function (forward, pos) {\n      return forward ? isBeforeTable(pos) : isAfterTable(pos);\n    };\n    var isBeforeOrAfterTable = function (editor, forward) {\n      var fromPos = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return isNearTable(forward, fromPos) || fromPosition(forward, editor.getBody(), fromPos).exists(function (pos) {\n        return isNearTable(forward, pos);\n      });\n    };\n    var deleteCaret = function (editor, forward, startElm) {\n      var rootElm = SugarElement.fromDom(editor.getBody());\n      return getParentCaption(rootElm, startElm).fold(function () {\n        return deleteCaretCells(editor, forward, rootElm, startElm) || isBeforeOrAfterTable(editor, forward);\n      }, function (fromCaption) {\n        return deleteCaretCaption(editor, forward, rootElm, fromCaption).getOr(false);\n      });\n    };\n    var backspaceDelete = function (editor, forward) {\n      var startElm = SugarElement.fromDom(editor.selection.getStart(true));\n      var cells = getCellsFromEditor(editor);\n      return editor.selection.isCollapsed() && cells.length === 0 ? deleteCaret(editor, forward, startElm) : deleteRange(editor, startElm);\n    };\n\n    var createRange$1 = function (sc, so, ec, eo) {\n      var rng = document.createRange();\n      rng.setStart(sc, so);\n      rng.setEnd(ec, eo);\n      return rng;\n    };\n    var normalizeBlockSelectionRange = function (rng) {\n      var startPos = CaretPosition.fromRangeStart(rng);\n      var endPos = CaretPosition.fromRangeEnd(rng);\n      var rootNode = rng.commonAncestorContainer;\n      return fromPosition(false, rootNode, endPos).map(function (newEndPos) {\n        if (!isInSameBlock(startPos, endPos, rootNode) && isInSameBlock(startPos, newEndPos, rootNode)) {\n          return createRange$1(startPos.container(), startPos.offset(), newEndPos.container(), newEndPos.offset());\n        } else {\n          return rng;\n        }\n      }).getOr(rng);\n    };\n    var normalize$2 = function (rng) {\n      return rng.collapsed ? rng : normalizeBlockSelectionRange(rng);\n    };\n\n    var hasOnlyOneChild = function (node) {\n      return node.firstChild && node.firstChild === node.lastChild;\n    };\n    var isPaddingNode = function (node) {\n      return node.name === 'br' || node.value === nbsp;\n    };\n    var isPaddedEmptyBlock = function (schema, node) {\n      var blockElements = schema.getBlockElements();\n      return blockElements[node.name] && hasOnlyOneChild(node) && isPaddingNode(node.firstChild);\n    };\n    var isEmptyFragmentElement = function (schema, node) {\n      var nonEmptyElements = schema.getNonEmptyElements();\n      return node && (node.isEmpty(nonEmptyElements) || isPaddedEmptyBlock(schema, node));\n    };\n    var isListFragment = function (schema, fragment) {\n      var firstChild = fragment.firstChild;\n      var lastChild = fragment.lastChild;\n      if (firstChild && firstChild.name === 'meta') {\n        firstChild = firstChild.next;\n      }\n      if (lastChild && lastChild.attr('id') === 'mce_marker') {\n        lastChild = lastChild.prev;\n      }\n      if (isEmptyFragmentElement(schema, lastChild)) {\n        lastChild = lastChild.prev;\n      }\n      if (!firstChild || firstChild !== lastChild) {\n        return false;\n      }\n      return firstChild.name === 'ul' || firstChild.name === 'ol';\n    };\n    var cleanupDomFragment = function (domFragment) {\n      var firstChild = domFragment.firstChild;\n      var lastChild = domFragment.lastChild;\n      if (firstChild && firstChild.nodeName === 'META') {\n        firstChild.parentNode.removeChild(firstChild);\n      }\n      if (lastChild && lastChild.id === 'mce_marker') {\n        lastChild.parentNode.removeChild(lastChild);\n      }\n      return domFragment;\n    };\n    var toDomFragment = function (dom, serializer, fragment) {\n      var html = serializer.serialize(fragment);\n      var domFragment = dom.createFragment(html);\n      return cleanupDomFragment(domFragment);\n    };\n    var listItems$1 = function (elm) {\n      return Tools.grep(elm.childNodes, function (child) {\n        return child.nodeName === 'LI';\n      });\n    };\n    var isPadding = function (node) {\n      return node.data === nbsp || isBr(node);\n    };\n    var isListItemPadded = function (node) {\n      return node && node.firstChild && node.firstChild === node.lastChild && isPadding(node.firstChild);\n    };\n    var isEmptyOrPadded = function (elm) {\n      return !elm.firstChild || isListItemPadded(elm);\n    };\n    var trimListItems = function (elms) {\n      return elms.length > 0 && isEmptyOrPadded(elms[elms.length - 1]) ? elms.slice(0, -1) : elms;\n    };\n    var getParentLi = function (dom, node) {\n      var parentBlock = dom.getParent(node, dom.isBlock);\n      return parentBlock && parentBlock.nodeName === 'LI' ? parentBlock : null;\n    };\n    var isParentBlockLi = function (dom, node) {\n      return !!getParentLi(dom, node);\n    };\n    var getSplit = function (parentNode, rng) {\n      var beforeRng = rng.cloneRange();\n      var afterRng = rng.cloneRange();\n      beforeRng.setStartBefore(parentNode);\n      afterRng.setEndAfter(parentNode);\n      return [\n        beforeRng.cloneContents(),\n        afterRng.cloneContents()\n      ];\n    };\n    var findFirstIn = function (node, rootNode) {\n      var caretPos = CaretPosition.before(node);\n      var caretWalker = CaretWalker(rootNode);\n      var newCaretPos = caretWalker.next(caretPos);\n      return newCaretPos ? newCaretPos.toRange() : null;\n    };\n    var findLastOf = function (node, rootNode) {\n      var caretPos = CaretPosition.after(node);\n      var caretWalker = CaretWalker(rootNode);\n      var newCaretPos = caretWalker.prev(caretPos);\n      return newCaretPos ? newCaretPos.toRange() : null;\n    };\n    var insertMiddle = function (target, elms, rootNode, rng) {\n      var parts = getSplit(target, rng);\n      var parentElm = target.parentNode;\n      parentElm.insertBefore(parts[0], target);\n      Tools.each(elms, function (li) {\n        parentElm.insertBefore(li, target);\n      });\n      parentElm.insertBefore(parts[1], target);\n      parentElm.removeChild(target);\n      return findLastOf(elms[elms.length - 1], rootNode);\n    };\n    var insertBefore = function (target, elms, rootNode) {\n      var parentElm = target.parentNode;\n      Tools.each(elms, function (elm) {\n        parentElm.insertBefore(elm, target);\n      });\n      return findFirstIn(target, rootNode);\n    };\n    var insertAfter = function (target, elms, rootNode, dom) {\n      dom.insertAfter(elms.reverse(), target);\n      return findLastOf(elms[0], rootNode);\n    };\n    var insertAtCaret = function (serializer, dom, rng, fragment) {\n      var domFragment = toDomFragment(dom, serializer, fragment);\n      var liTarget = getParentLi(dom, rng.startContainer);\n      var liElms = trimListItems(listItems$1(domFragment.firstChild));\n      var BEGINNING = 1, END = 2;\n      var rootNode = dom.getRoot();\n      var isAt = function (location) {\n        var caretPos = CaretPosition.fromRangeStart(rng);\n        var caretWalker = CaretWalker(dom.getRoot());\n        var newPos = location === BEGINNING ? caretWalker.prev(caretPos) : caretWalker.next(caretPos);\n        return newPos ? getParentLi(dom, newPos.getNode()) !== liTarget : true;\n      };\n      if (isAt(BEGINNING)) {\n        return insertBefore(liTarget, liElms, rootNode);\n      } else if (isAt(END)) {\n        return insertAfter(liTarget, liElms, rootNode, dom);\n      }\n      return insertMiddle(liTarget, liElms, rootNode, rng);\n    };\n\n    var trimOrPadLeftRight = function (dom, rng, html) {\n      var root = SugarElement.fromDom(dom.getRoot());\n      if (needsToBeNbspLeft(root, CaretPosition.fromRangeStart(rng))) {\n        html = html.replace(/^ /, '&nbsp;');\n      } else {\n        html = html.replace(/^&nbsp;/, ' ');\n      }\n      if (needsToBeNbspRight(root, CaretPosition.fromRangeEnd(rng))) {\n        html = html.replace(/(&nbsp;| )(<br( \\/)>)?$/, '&nbsp;');\n      } else {\n        html = html.replace(/&nbsp;(<br( \\/)?>)?$/, ' ');\n      }\n      return html;\n    };\n\n    var isTableCell$4 = isTableCell;\n    var isTableCellContentSelected = function (dom, rng, cell) {\n      if (cell !== null) {\n        var endCell = dom.getParent(rng.endContainer, isTableCell$4);\n        return cell === endCell && hasAllContentsSelected(SugarElement.fromDom(cell), rng);\n      } else {\n        return false;\n      }\n    };\n    var validInsertion = function (editor, value, parentNode) {\n      if (parentNode.getAttribute('data-mce-bogus') === 'all') {\n        parentNode.parentNode.insertBefore(editor.dom.createFragment(value), parentNode);\n      } else {\n        var node = parentNode.firstChild;\n        var node2 = parentNode.lastChild;\n        if (!node || node === node2 && node.nodeName === 'BR') {\n          editor.dom.setHTML(parentNode, value);\n        } else {\n          editor.selection.setContent(value);\n        }\n      }\n    };\n    var trimBrsFromTableCell = function (dom, elm) {\n      Optional.from(dom.getParent(elm, 'td,th')).map(SugarElement.fromDom).each(trimBlockTrailingBr);\n    };\n    var reduceInlineTextElements = function (editor, merge) {\n      var textInlineElements = editor.schema.getTextInlineElements();\n      var dom = editor.dom;\n      if (merge) {\n        var root_1 = editor.getBody();\n        var elementUtils_1 = ElementUtils(dom);\n        Tools.each(dom.select('*[data-mce-fragment]'), function (node) {\n          var isInline = isNonNullable(textInlineElements[node.nodeName.toLowerCase()]);\n          if (isInline && hasInheritableStyles(dom, node)) {\n            for (var parentNode = node.parentNode; isNonNullable(parentNode) && parentNode !== root_1; parentNode = parentNode.parentNode) {\n              var styleConflict = hasStyleConflict(dom, node, parentNode);\n              if (styleConflict) {\n                break;\n              }\n              if (elementUtils_1.compare(parentNode, node)) {\n                dom.remove(node, true);\n                break;\n              }\n            }\n          }\n        });\n      }\n    };\n    var markFragmentElements = function (fragment) {\n      var node = fragment;\n      while (node = node.walk()) {\n        if (node.type === 1) {\n          node.attr('data-mce-fragment', '1');\n        }\n      }\n    };\n    var unmarkFragmentElements = function (elm) {\n      Tools.each(elm.getElementsByTagName('*'), function (elm) {\n        elm.removeAttribute('data-mce-fragment');\n      });\n    };\n    var isPartOfFragment = function (node) {\n      return !!node.getAttribute('data-mce-fragment');\n    };\n    var canHaveChildren = function (editor, node) {\n      return node && !editor.schema.getShortEndedElements()[node.nodeName];\n    };\n    var moveSelectionToMarker = function (editor, marker) {\n      var nextRng;\n      var dom = editor.dom, selection = editor.selection;\n      var node2;\n      var getContentEditableFalseParent = function (node) {\n        var root = editor.getBody();\n        for (; node && node !== root; node = node.parentNode) {\n          if (dom.getContentEditable(node) === 'false') {\n            return node;\n          }\n        }\n        return null;\n      };\n      if (!marker) {\n        return;\n      }\n      selection.scrollIntoView(marker);\n      var parentEditableFalseElm = getContentEditableFalseParent(marker);\n      if (parentEditableFalseElm) {\n        dom.remove(marker);\n        selection.select(parentEditableFalseElm);\n        return;\n      }\n      var rng = dom.createRng();\n      var node = marker.previousSibling;\n      if (node && node.nodeType === 3) {\n        rng.setStart(node, node.nodeValue.length);\n        if (!Env.ie) {\n          node2 = marker.nextSibling;\n          if (node2 && node2.nodeType === 3) {\n            node.appendData(node2.data);\n            node2.parentNode.removeChild(node2);\n          }\n        }\n      } else {\n        rng.setStartBefore(marker);\n        rng.setEndBefore(marker);\n      }\n      var findNextCaretRng = function (rng) {\n        var caretPos = CaretPosition.fromRangeStart(rng);\n        var caretWalker = CaretWalker(editor.getBody());\n        caretPos = caretWalker.next(caretPos);\n        if (caretPos) {\n          return caretPos.toRange();\n        }\n      };\n      var parentBlock = dom.getParent(marker, dom.isBlock);\n      dom.remove(marker);\n      if (parentBlock && dom.isEmpty(parentBlock)) {\n        editor.$(parentBlock).empty();\n        rng.setStart(parentBlock, 0);\n        rng.setEnd(parentBlock, 0);\n        if (!isTableCell$4(parentBlock) && !isPartOfFragment(parentBlock) && (nextRng = findNextCaretRng(rng))) {\n          rng = nextRng;\n          dom.remove(parentBlock);\n        } else {\n          dom.add(parentBlock, dom.create('br', { 'data-mce-bogus': '1' }));\n        }\n      }\n      selection.setRng(rng);\n    };\n    var deleteSelectedContent = function (editor) {\n      var dom = editor.dom;\n      var rng = normalize$2(editor.selection.getRng());\n      editor.selection.setRng(rng);\n      var startCell = dom.getParent(rng.startContainer, isTableCell$4);\n      if (isTableCellContentSelected(dom, rng, startCell)) {\n        deleteCellContents(editor, rng, SugarElement.fromDom(startCell));\n      } else {\n        editor.getDoc().execCommand('Delete', false, null);\n      }\n    };\n    var insertHtmlAtCaret = function (editor, value, details) {\n      var parentNode, rootNode, args;\n      var marker, rng, node;\n      var selection = editor.selection, dom = editor.dom;\n      if (/^ | $/.test(value)) {\n        value = trimOrPadLeftRight(dom, selection.getRng(), value);\n      }\n      var parser = editor.parser;\n      var merge = details.merge;\n      var serializer = HtmlSerializer({ validate: shouldValidate(editor) }, editor.schema);\n      var bookmarkHtml = '<span id=\"mce_marker\" data-mce-type=\"bookmark\">&#xFEFF;</span>';\n      args = {\n        content: value,\n        format: 'html',\n        selection: true,\n        paste: details.paste\n      };\n      args = editor.fire('BeforeSetContent', args);\n      if (args.isDefaultPrevented()) {\n        editor.fire('SetContent', {\n          content: args.content,\n          format: 'html',\n          selection: true,\n          paste: details.paste\n        });\n        return;\n      }\n      value = args.content;\n      if (value.indexOf('{$caret}') === -1) {\n        value += '{$caret}';\n      }\n      value = value.replace(/\\{\\$caret\\}/, bookmarkHtml);\n      rng = selection.getRng();\n      var caretElement = rng.startContainer || (rng.parentElement ? rng.parentElement() : null);\n      var body = editor.getBody();\n      if (caretElement === body && selection.isCollapsed()) {\n        if (dom.isBlock(body.firstChild) && canHaveChildren(editor, body.firstChild) && dom.isEmpty(body.firstChild)) {\n          rng = dom.createRng();\n          rng.setStart(body.firstChild, 0);\n          rng.setEnd(body.firstChild, 0);\n          selection.setRng(rng);\n        }\n      }\n      if (!selection.isCollapsed()) {\n        deleteSelectedContent(editor);\n      }\n      parentNode = selection.getNode();\n      var parserArgs = {\n        context: parentNode.nodeName.toLowerCase(),\n        data: details.data,\n        insert: true\n      };\n      var fragment = parser.parse(value, parserArgs);\n      if (details.paste === true && isListFragment(editor.schema, fragment) && isParentBlockLi(dom, parentNode)) {\n        rng = insertAtCaret(serializer, dom, selection.getRng(), fragment);\n        selection.setRng(rng);\n        editor.fire('SetContent', args);\n        return;\n      }\n      markFragmentElements(fragment);\n      node = fragment.lastChild;\n      if (node.attr('id') === 'mce_marker') {\n        marker = node;\n        for (node = node.prev; node; node = node.walk(true)) {\n          if (node.type === 3 || !dom.isBlock(node.name)) {\n            if (editor.schema.isValidChild(node.parent.name, 'span')) {\n              node.parent.insert(marker, node, node.name === 'br');\n            }\n            break;\n          }\n        }\n      }\n      editor._selectionOverrides.showBlockCaretContainer(parentNode);\n      if (!parserArgs.invalid) {\n        value = serializer.serialize(fragment);\n        validInsertion(editor, value, parentNode);\n      } else {\n        editor.selection.setContent(bookmarkHtml);\n        parentNode = selection.getNode();\n        rootNode = editor.getBody();\n        if (parentNode.nodeType === 9) {\n          parentNode = node = rootNode;\n        } else {\n          node = parentNode;\n        }\n        while (node !== rootNode) {\n          parentNode = node;\n          node = node.parentNode;\n        }\n        value = parentNode === rootNode ? rootNode.innerHTML : dom.getOuterHTML(parentNode);\n        value = serializer.serialize(parser.parse(value.replace(/<span (id=\"mce_marker\"|id=mce_marker).+?<\\/span>/i, function () {\n          return serializer.serialize(fragment);\n        })));\n        if (parentNode === rootNode) {\n          dom.setHTML(rootNode, value);\n        } else {\n          dom.setOuterHTML(parentNode, value);\n        }\n      }\n      reduceInlineTextElements(editor, merge);\n      moveSelectionToMarker(editor, dom.get('mce_marker'));\n      unmarkFragmentElements(editor.getBody());\n      trimBrsFromTableCell(dom, selection.getStart());\n      editor.fire('SetContent', args);\n      editor.addVisual();\n    };\n\n    var traverse = function (node, fn) {\n      fn(node);\n      if (node.firstChild) {\n        traverse(node.firstChild, fn);\n      }\n      if (node.next) {\n        traverse(node.next, fn);\n      }\n    };\n    var findMatchingNodes = function (nodeFilters, attributeFilters, node) {\n      var nodeMatches = {};\n      var attrMatches = {};\n      var matches = [];\n      if (node.firstChild) {\n        traverse(node.firstChild, function (node) {\n          each(nodeFilters, function (filter) {\n            if (filter.name === node.name) {\n              if (nodeMatches[filter.name]) {\n                nodeMatches[filter.name].nodes.push(node);\n              } else {\n                nodeMatches[filter.name] = {\n                  filter: filter,\n                  nodes: [node]\n                };\n              }\n            }\n          });\n          each(attributeFilters, function (filter) {\n            if (typeof node.attr(filter.name) === 'string') {\n              if (attrMatches[filter.name]) {\n                attrMatches[filter.name].nodes.push(node);\n              } else {\n                attrMatches[filter.name] = {\n                  filter: filter,\n                  nodes: [node]\n                };\n              }\n            }\n          });\n        });\n      }\n      for (var name_1 in nodeMatches) {\n        if (nodeMatches.hasOwnProperty(name_1)) {\n          matches.push(nodeMatches[name_1]);\n        }\n      }\n      for (var name_2 in attrMatches) {\n        if (attrMatches.hasOwnProperty(name_2)) {\n          matches.push(attrMatches[name_2]);\n        }\n      }\n      return matches;\n    };\n    var filter$3 = function (nodeFilters, attributeFilters, node) {\n      var matches = findMatchingNodes(nodeFilters, attributeFilters, node);\n      each(matches, function (match) {\n        each(match.filter.callbacks, function (callback) {\n          callback(match.nodes, match.filter.name, {});\n        });\n      });\n    };\n\n    var defaultFormat = 'html';\n    var isTreeNode = function (content) {\n      return content instanceof AstNode;\n    };\n    var moveSelection = function (editor) {\n      if (hasFocus$1(editor)) {\n        firstPositionIn(editor.getBody()).each(function (pos) {\n          var node = pos.getNode();\n          var caretPos = isTable(node) ? firstPositionIn(node).getOr(pos) : pos;\n          editor.selection.setRng(caretPos.toRange());\n        });\n      }\n    };\n    var setEditorHtml = function (editor, html) {\n      editor.dom.setHTML(editor.getBody(), html);\n      moveSelection(editor);\n    };\n    var setContentString = function (editor, body, content, args) {\n      var forcedRootBlockName, padd;\n      if (content.length === 0 || /^\\s+$/.test(content)) {\n        padd = '<br data-mce-bogus=\"1\">';\n        if (body.nodeName === 'TABLE') {\n          content = '<tr><td>' + padd + '</td></tr>';\n        } else if (/^(UL|OL)$/.test(body.nodeName)) {\n          content = '<li>' + padd + '</li>';\n        }\n        forcedRootBlockName = getForcedRootBlock(editor);\n        if (forcedRootBlockName && editor.schema.isValidChild(body.nodeName.toLowerCase(), forcedRootBlockName.toLowerCase())) {\n          content = padd;\n          content = editor.dom.createHTML(forcedRootBlockName, getForcedRootBlockAttrs(editor), content);\n        } else if (!content) {\n          content = '<br data-mce-bogus=\"1\">';\n        }\n        setEditorHtml(editor, content);\n        editor.fire('SetContent', args);\n      } else {\n        if (args.format !== 'raw') {\n          content = HtmlSerializer({ validate: editor.validate }, editor.schema).serialize(editor.parser.parse(content, {\n            isRootContent: true,\n            insert: true\n          }));\n        }\n        args.content = isWsPreserveElement(SugarElement.fromDom(body)) ? content : Tools.trim(content);\n        setEditorHtml(editor, args.content);\n        if (!args.no_events) {\n          editor.fire('SetContent', args);\n        }\n      }\n      return args.content;\n    };\n    var setContentTree = function (editor, body, content, args) {\n      filter$3(editor.parser.getNodeFilters(), editor.parser.getAttributeFilters(), content);\n      var html = HtmlSerializer({ validate: editor.validate }, editor.schema).serialize(content);\n      args.content = isWsPreserveElement(SugarElement.fromDom(body)) ? html : Tools.trim(html);\n      setEditorHtml(editor, args.content);\n      if (!args.no_events) {\n        editor.fire('SetContent', args);\n      }\n      return content;\n    };\n    var setContentInternal = function (editor, content, args) {\n      args.format = args.format ? args.format : defaultFormat;\n      args.set = true;\n      args.content = isTreeNode(content) ? '' : content;\n      if (!args.no_events) {\n        editor.fire('BeforeSetContent', args);\n      }\n      if (!isTreeNode(content)) {\n        content = args.content;\n      }\n      return Optional.from(editor.getBody()).fold(constant(content), function (body) {\n        return isTreeNode(content) ? setContentTree(editor, body, content, args) : setContentString(editor, body, content, args);\n      });\n    };\n\n    var sibling$2 = function (scope, predicate) {\n      return sibling(scope, predicate).isSome();\n    };\n\n    var ensureIsRoot = function (isRoot) {\n      return isFunction(isRoot) ? isRoot : never;\n    };\n    var ancestor$3 = function (scope, transform, isRoot) {\n      var element = scope.dom;\n      var stop = ensureIsRoot(isRoot);\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = SugarElement.fromDom(element);\n        var transformed = transform(el);\n        if (transformed.isSome()) {\n          return transformed;\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var closest$2 = function (scope, transform, isRoot) {\n      var current = transform(scope);\n      var stop = ensureIsRoot(isRoot);\n      return current.orThunk(function () {\n        return stop(scope) ? Optional.none() : ancestor$3(scope, transform, stop);\n      });\n    };\n\n    var isEq$2 = isEq;\n    var matchesUnInheritedFormatSelector = function (ed, node, name) {\n      var formatList = ed.formatter.get(name);\n      if (formatList) {\n        for (var i = 0; i < formatList.length; i++) {\n          if (formatList[i].inherit === false && ed.dom.is(node, formatList[i].selector)) {\n            return true;\n          }\n        }\n      }\n      return false;\n    };\n    var matchParents = function (editor, node, name, vars) {\n      var root = editor.dom.getRoot();\n      if (node === root) {\n        return false;\n      }\n      node = editor.dom.getParent(node, function (node) {\n        if (matchesUnInheritedFormatSelector(editor, node, name)) {\n          return true;\n        }\n        return node.parentNode === root || !!matchNode(editor, node, name, vars, true);\n      });\n      return matchNode(editor, node, name, vars);\n    };\n    var matchName = function (dom, node, format) {\n      if (isEq$2(node, format.inline)) {\n        return true;\n      }\n      if (isEq$2(node, format.block)) {\n        return true;\n      }\n      if (format.selector) {\n        return node.nodeType === 1 && dom.is(node, format.selector);\n      }\n    };\n    var matchItems = function (dom, node, format, itemName, similar, vars) {\n      var key, value;\n      var items = format[itemName];\n      var i;\n      if (format.onmatch) {\n        return format.onmatch(node, format, itemName);\n      }\n      if (items) {\n        if (typeof items.length === 'undefined') {\n          for (key in items) {\n            if (items.hasOwnProperty(key)) {\n              if (itemName === 'attributes') {\n                value = dom.getAttrib(node, key);\n              } else {\n                value = getStyle(dom, node, key);\n              }\n              if (similar && !value && !format.exact) {\n                return;\n              }\n              if ((!similar || format.exact) && !isEq$2(value, normalizeStyleValue(dom, replaceVars(items[key], vars), key))) {\n                return;\n              }\n            }\n          }\n        } else {\n          for (i = 0; i < items.length; i++) {\n            if (itemName === 'attributes' ? dom.getAttrib(node, items[i]) : getStyle(dom, node, items[i])) {\n              return format;\n            }\n          }\n        }\n      }\n      return format;\n    };\n    var matchNode = function (ed, node, name, vars, similar) {\n      var formatList = ed.formatter.get(name);\n      var format, i, x, classes;\n      var dom = ed.dom;\n      if (formatList && node) {\n        for (i = 0; i < formatList.length; i++) {\n          format = formatList[i];\n          if (matchName(ed.dom, node, format) && matchItems(dom, node, format, 'attributes', similar, vars) && matchItems(dom, node, format, 'styles', similar, vars)) {\n            if (classes = format.classes) {\n              for (x = 0; x < classes.length; x++) {\n                if (!ed.dom.hasClass(node, replaceVars(classes[x], vars))) {\n                  return;\n                }\n              }\n            }\n            return format;\n          }\n        }\n      }\n    };\n    var match = function (editor, name, vars, node) {\n      if (node) {\n        return matchParents(editor, node, name, vars);\n      }\n      node = editor.selection.getNode();\n      if (matchParents(editor, node, name, vars)) {\n        return true;\n      }\n      var startNode = editor.selection.getStart();\n      if (startNode !== node) {\n        if (matchParents(editor, startNode, name, vars)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var matchAll = function (editor, names, vars) {\n      var matchedFormatNames = [];\n      var checkedMap = {};\n      var startElement = editor.selection.getStart();\n      editor.dom.getParent(startElement, function (node) {\n        for (var i = 0; i < names.length; i++) {\n          var name_1 = names[i];\n          if (!checkedMap[name_1] && matchNode(editor, node, name_1, vars)) {\n            checkedMap[name_1] = true;\n            matchedFormatNames.push(name_1);\n          }\n        }\n      }, editor.dom.getRoot());\n      return matchedFormatNames;\n    };\n    var closest$3 = function (editor, names) {\n      var isRoot = function (elm) {\n        return eq$2(elm, SugarElement.fromDom(editor.getBody()));\n      };\n      var match = function (elm, name) {\n        return matchNode(editor, elm.dom, name) ? Optional.some(name) : Optional.none();\n      };\n      return Optional.from(editor.selection.getStart(true)).bind(function (rawElm) {\n        return closest$2(SugarElement.fromDom(rawElm), function (elm) {\n          return findMap(names, function (name) {\n            return match(elm, name);\n          });\n        }, isRoot);\n      }).getOrNull();\n    };\n    var canApply = function (editor, name) {\n      var formatList = editor.formatter.get(name);\n      var startNode, parents, i, x, selector;\n      var dom = editor.dom;\n      if (formatList) {\n        startNode = editor.selection.getStart();\n        parents = getParents$1(dom, startNode);\n        for (x = formatList.length - 1; x >= 0; x--) {\n          selector = formatList[x].selector;\n          if (!selector || formatList[x].defaultBlock) {\n            return true;\n          }\n          for (i = parents.length - 1; i >= 0; i--) {\n            if (dom.is(parents[i], selector)) {\n              return true;\n            }\n          }\n        }\n      }\n      return false;\n    };\n    var matchAllOnNode = function (editor, node, formatNames) {\n      return foldl(formatNames, function (acc, name) {\n        var matchSimilar = isVariableFormatName(editor, name);\n        if (editor.formatter.matchNode(node, name, {}, matchSimilar)) {\n          return acc.concat([name]);\n        } else {\n          return acc;\n        }\n      }, []);\n    };\n\n    var ZWSP$1 = ZWSP, CARET_ID$1 = '_mce_caret';\n    var importNode = function (ownerDocument, node) {\n      return ownerDocument.importNode(node, true);\n    };\n    var getEmptyCaretContainers = function (node) {\n      var nodes = [];\n      while (node) {\n        if (node.nodeType === 3 && node.nodeValue !== ZWSP$1 || node.childNodes.length > 1) {\n          return [];\n        }\n        if (node.nodeType === 1) {\n          nodes.push(node);\n        }\n        node = node.firstChild;\n      }\n      return nodes;\n    };\n    var isCaretContainerEmpty = function (node) {\n      return getEmptyCaretContainers(node).length > 0;\n    };\n    var findFirstTextNode = function (node) {\n      if (node) {\n        var walker = new DomTreeWalker(node, node);\n        for (node = walker.current(); node; node = walker.next()) {\n          if (isText$1(node)) {\n            return node;\n          }\n        }\n      }\n      return null;\n    };\n    var createCaretContainer = function (fill) {\n      var caretContainer = SugarElement.fromTag('span');\n      setAll(caretContainer, {\n        'id': CARET_ID$1,\n        'data-mce-bogus': '1',\n        'data-mce-type': 'format-caret'\n      });\n      if (fill) {\n        append(caretContainer, SugarElement.fromText(ZWSP$1));\n      }\n      return caretContainer;\n    };\n    var trimZwspFromCaretContainer = function (caretContainerNode) {\n      var textNode = findFirstTextNode(caretContainerNode);\n      if (textNode && textNode.nodeValue.charAt(0) === ZWSP$1) {\n        textNode.deleteData(0, 1);\n      }\n      return textNode;\n    };\n    var removeCaretContainerNode = function (editor, node, moveCaret) {\n      if (moveCaret === void 0) {\n        moveCaret = true;\n      }\n      var dom = editor.dom, selection = editor.selection;\n      if (isCaretContainerEmpty(node)) {\n        deleteElement(editor, false, SugarElement.fromDom(node), moveCaret);\n      } else {\n        var rng = selection.getRng();\n        var block = dom.getParent(node, dom.isBlock);\n        var startContainer = rng.startContainer;\n        var startOffset = rng.startOffset;\n        var endContainer = rng.endContainer;\n        var endOffset = rng.endOffset;\n        var textNode = trimZwspFromCaretContainer(node);\n        dom.remove(node, true);\n        if (startContainer === textNode && startOffset > 0) {\n          rng.setStart(textNode, startOffset - 1);\n        }\n        if (endContainer === textNode && endOffset > 0) {\n          rng.setEnd(textNode, endOffset - 1);\n        }\n        if (block && dom.isEmpty(block)) {\n          fillWithPaddingBr(SugarElement.fromDom(block));\n        }\n        selection.setRng(rng);\n      }\n    };\n    var removeCaretContainer = function (editor, node, moveCaret) {\n      if (moveCaret === void 0) {\n        moveCaret = true;\n      }\n      var dom = editor.dom, selection = editor.selection;\n      if (!node) {\n        node = getParentCaretContainer(editor.getBody(), selection.getStart());\n        if (!node) {\n          while (node = dom.get(CARET_ID$1)) {\n            removeCaretContainerNode(editor, node, false);\n          }\n        }\n      } else {\n        removeCaretContainerNode(editor, node, moveCaret);\n      }\n    };\n    var insertCaretContainerNode = function (editor, caretContainer, formatNode) {\n      var dom = editor.dom, block = dom.getParent(formatNode, curry(isTextBlock$1, editor));\n      if (block && dom.isEmpty(block)) {\n        formatNode.parentNode.replaceChild(caretContainer, formatNode);\n      } else {\n        removeTrailingBr(SugarElement.fromDom(formatNode));\n        if (dom.isEmpty(formatNode)) {\n          formatNode.parentNode.replaceChild(caretContainer, formatNode);\n        } else {\n          dom.insertAfter(caretContainer, formatNode);\n        }\n      }\n    };\n    var appendNode = function (parentNode, node) {\n      parentNode.appendChild(node);\n      return node;\n    };\n    var insertFormatNodesIntoCaretContainer = function (formatNodes, caretContainer) {\n      var innerMostFormatNode = foldr(formatNodes, function (parentNode, formatNode) {\n        return appendNode(parentNode, formatNode.cloneNode(false));\n      }, caretContainer);\n      return appendNode(innerMostFormatNode, innerMostFormatNode.ownerDocument.createTextNode(ZWSP$1));\n    };\n    var cleanFormatNode = function (editor, caretContainer, formatNode, name, vars, similar) {\n      var formatter = editor.formatter;\n      var dom = editor.dom;\n      var validFormats = filter(keys(formatter.get()), function (formatName) {\n        return formatName !== name && !contains$1(formatName, 'removeformat');\n      });\n      var matchedFormats = matchAllOnNode(editor, formatNode, validFormats);\n      var uniqueFormats = filter(matchedFormats, function (fmtName) {\n        return !areSimilarFormats(editor, fmtName, name);\n      });\n      if (uniqueFormats.length > 0) {\n        var clonedFormatNode = formatNode.cloneNode(false);\n        dom.add(caretContainer, clonedFormatNode);\n        formatter.remove(name, vars, clonedFormatNode, similar);\n        dom.remove(clonedFormatNode);\n        return Optional.some(clonedFormatNode);\n      } else {\n        return Optional.none();\n      }\n    };\n    var applyCaretFormat = function (editor, name, vars) {\n      var caretContainer, textNode;\n      var selection = editor.selection;\n      var selectionRng = selection.getRng();\n      var offset = selectionRng.startOffset;\n      var container = selectionRng.startContainer;\n      var text = container.nodeValue;\n      caretContainer = getParentCaretContainer(editor.getBody(), selection.getStart());\n      if (caretContainer) {\n        textNode = findFirstTextNode(caretContainer);\n      }\n      var wordcharRegex = /[^\\s\\u00a0\\u00ad\\u200b\\ufeff]/;\n      if (text && offset > 0 && offset < text.length && wordcharRegex.test(text.charAt(offset)) && wordcharRegex.test(text.charAt(offset - 1))) {\n        var bookmark = selection.getBookmark();\n        selectionRng.collapse(true);\n        var rng = expandRng(editor, selectionRng, editor.formatter.get(name));\n        rng = split$1(rng);\n        editor.formatter.apply(name, vars, rng);\n        selection.moveToBookmark(bookmark);\n      } else {\n        if (!caretContainer || textNode.nodeValue !== ZWSP$1) {\n          caretContainer = importNode(editor.getDoc(), createCaretContainer(true).dom);\n          textNode = caretContainer.firstChild;\n          selectionRng.insertNode(caretContainer);\n          offset = 1;\n          editor.formatter.apply(name, vars, caretContainer);\n        } else {\n          editor.formatter.apply(name, vars, caretContainer);\n        }\n        selection.setCursorLocation(textNode, offset);\n      }\n    };\n    var removeCaretFormat = function (editor, name, vars, similar) {\n      var dom = editor.dom;\n      var selection = editor.selection;\n      var hasContentAfter, node, formatNode;\n      var parents = [];\n      var rng = selection.getRng();\n      var container = rng.startContainer;\n      var offset = rng.startOffset;\n      node = container;\n      if (container.nodeType === 3) {\n        if (offset !== container.nodeValue.length) {\n          hasContentAfter = true;\n        }\n        node = node.parentNode;\n      }\n      while (node) {\n        if (matchNode(editor, node, name, vars, similar)) {\n          formatNode = node;\n          break;\n        }\n        if (node.nextSibling) {\n          hasContentAfter = true;\n        }\n        parents.push(node);\n        node = node.parentNode;\n      }\n      if (!formatNode) {\n        return;\n      }\n      if (hasContentAfter) {\n        var bookmark = selection.getBookmark();\n        rng.collapse(true);\n        var expandedRng = expandRng(editor, rng, editor.formatter.get(name), true);\n        expandedRng = split$1(expandedRng);\n        editor.formatter.remove(name, vars, expandedRng, similar);\n        selection.moveToBookmark(bookmark);\n      } else {\n        var caretContainer = getParentCaretContainer(editor.getBody(), formatNode);\n        var newCaretContainer = createCaretContainer(false).dom;\n        insertCaretContainerNode(editor, newCaretContainer, caretContainer !== null ? caretContainer : formatNode);\n        var cleanedFormatNode = cleanFormatNode(editor, newCaretContainer, formatNode, name, vars, similar);\n        var caretTextNode = insertFormatNodesIntoCaretContainer(parents.concat(cleanedFormatNode.toArray()), newCaretContainer);\n        removeCaretContainerNode(editor, caretContainer, false);\n        selection.setCursorLocation(caretTextNode, 1);\n        if (dom.isEmpty(formatNode)) {\n          dom.remove(formatNode);\n        }\n      }\n    };\n    var disableCaretContainer = function (editor, keyCode) {\n      var selection = editor.selection, body = editor.getBody();\n      removeCaretContainer(editor, null, false);\n      if ((keyCode === 8 || keyCode === 46) && selection.isCollapsed() && selection.getStart().innerHTML === ZWSP$1) {\n        removeCaretContainer(editor, getParentCaretContainer(body, selection.getStart()));\n      }\n      if (keyCode === 37 || keyCode === 39) {\n        removeCaretContainer(editor, getParentCaretContainer(body, selection.getStart()));\n      }\n    };\n    var setup$3 = function (editor) {\n      editor.on('mouseup keydown', function (e) {\n        disableCaretContainer(editor, e.keyCode);\n      });\n    };\n    var replaceWithCaretFormat = function (targetNode, formatNodes) {\n      var caretContainer = createCaretContainer(false);\n      var innerMost = insertFormatNodesIntoCaretContainer(formatNodes, caretContainer.dom);\n      before(SugarElement.fromDom(targetNode), caretContainer);\n      remove(SugarElement.fromDom(targetNode));\n      return CaretPosition(innerMost, 0);\n    };\n    var isFormatElement = function (editor, element) {\n      var inlineElements = editor.schema.getTextInlineElements();\n      return inlineElements.hasOwnProperty(name(element)) && !isCaretNode(element.dom) && !isBogus(element.dom);\n    };\n    var isEmptyCaretFormatElement = function (element) {\n      return isCaretNode(element.dom) && isCaretContainerEmpty(element.dom);\n    };\n\n    var postProcessHooks = {};\n    var filter$4 = filter$2;\n    var each$8 = each$2;\n    var addPostProcessHook = function (name, hook) {\n      var hooks = postProcessHooks[name];\n      if (!hooks) {\n        postProcessHooks[name] = [];\n      }\n      postProcessHooks[name].push(hook);\n    };\n    var postProcess = function (name, editor) {\n      each$8(postProcessHooks[name], function (hook) {\n        hook(editor);\n      });\n    };\n    addPostProcessHook('pre', function (editor) {\n      var rng = editor.selection.getRng();\n      var blocks;\n      var hasPreSibling = function (pre) {\n        return isPre(pre.previousSibling) && indexOf$1(blocks, pre.previousSibling) !== -1;\n      };\n      var joinPre = function (pre1, pre2) {\n        DomQuery(pre2).remove();\n        DomQuery(pre1).append('<br><br>').append(pre2.childNodes);\n      };\n      var isPre = matchNodeNames(['pre']);\n      if (!rng.collapsed) {\n        blocks = editor.selection.getSelectedBlocks();\n        each$8(filter$4(filter$4(blocks, isPre), hasPreSibling), function (pre) {\n          joinPre(pre.previousSibling, pre);\n        });\n      }\n    });\n\n    var each$9 = Tools.each;\n    var isElementNode = function (node) {\n      return isElement$1(node) && !isBookmarkNode$1(node) && !isCaretNode(node) && !isBogus(node);\n    };\n    var findElementSibling = function (node, siblingName) {\n      var sibling;\n      for (sibling = node; sibling; sibling = sibling[siblingName]) {\n        if (isText$1(sibling) && sibling.nodeValue.length !== 0) {\n          return node;\n        }\n        if (isElement$1(sibling) && !isBookmarkNode$1(sibling)) {\n          return sibling;\n        }\n      }\n      return node;\n    };\n    var mergeSiblingsNodes = function (dom, prev, next) {\n      var sibling, tmpSibling;\n      var elementUtils = ElementUtils(dom);\n      if (prev && next) {\n        prev = findElementSibling(prev, 'previousSibling');\n        next = findElementSibling(next, 'nextSibling');\n        if (elementUtils.compare(prev, next)) {\n          for (sibling = prev.nextSibling; sibling && sibling !== next;) {\n            tmpSibling = sibling;\n            sibling = sibling.nextSibling;\n            prev.appendChild(tmpSibling);\n          }\n          dom.remove(next);\n          Tools.each(Tools.grep(next.childNodes), function (node) {\n            prev.appendChild(node);\n          });\n          return prev;\n        }\n      }\n      return next;\n    };\n    var mergeSiblings = function (dom, format, vars, node) {\n      if (node && format.merge_siblings !== false) {\n        var newNode = mergeSiblingsNodes(dom, getNonWhiteSpaceSibling(node), node);\n        mergeSiblingsNodes(dom, newNode, getNonWhiteSpaceSibling(newNode, true));\n      }\n    };\n    var clearChildStyles = function (dom, format, node) {\n      if (format.clear_child_styles) {\n        var selector = format.links ? '*:not(a)' : '*';\n        each$9(dom.select(selector, node), function (node) {\n          if (isElementNode(node)) {\n            each$9(format.styles, function (value, name) {\n              dom.setStyle(node, name, '');\n            });\n          }\n        });\n      }\n    };\n    var processChildElements = function (node, filter, process) {\n      each$9(node.childNodes, function (node) {\n        if (isElementNode(node)) {\n          if (filter(node)) {\n            process(node);\n          }\n          if (node.hasChildNodes()) {\n            processChildElements(node, filter, process);\n          }\n        }\n      });\n    };\n    var unwrapEmptySpan = function (dom, node) {\n      if (node.nodeName === 'SPAN' && dom.getAttribs(node).length === 0) {\n        dom.remove(node, true);\n      }\n    };\n    var hasStyle = function (dom, name) {\n      return function (node) {\n        return !!(node && getStyle(dom, node, name));\n      };\n    };\n    var applyStyle = function (dom, name, value) {\n      return function (node) {\n        dom.setStyle(node, name, value);\n        if (node.getAttribute('style') === '') {\n          node.removeAttribute('style');\n        }\n        unwrapEmptySpan(dom, node);\n      };\n    };\n\n    var removeResult = Adt.generate([\n      { keep: [] },\n      { rename: ['name'] },\n      { removed: [] }\n    ]);\n    var MCE_ATTR_RE = /^(src|href|style)$/;\n    var each$a = Tools.each;\n    var isEq$3 = isEq;\n    var isTableCellOrRow = function (node) {\n      return /^(TR|TH|TD)$/.test(node.nodeName);\n    };\n    var isChildOfInlineParent = function (dom, node, parent) {\n      return dom.isChildOf(node, parent) && node !== parent && !dom.isBlock(parent);\n    };\n    var getContainer = function (ed, rng, start) {\n      var container, offset;\n      container = rng[start ? 'startContainer' : 'endContainer'];\n      offset = rng[start ? 'startOffset' : 'endOffset'];\n      if (isElement$1(container)) {\n        var lastIdx = container.childNodes.length - 1;\n        if (!start && offset) {\n          offset--;\n        }\n        container = container.childNodes[offset > lastIdx ? lastIdx : offset];\n      }\n      if (isText$1(container) && start && offset >= container.nodeValue.length) {\n        container = new DomTreeWalker(container, ed.getBody()).next() || container;\n      }\n      if (isText$1(container) && !start && offset === 0) {\n        container = new DomTreeWalker(container, ed.getBody()).prev() || container;\n      }\n      return container;\n    };\n    var normalizeTableSelection = function (node, start) {\n      var prop = start ? 'firstChild' : 'lastChild';\n      if (isTableCellOrRow(node) && node[prop]) {\n        var childNode = node[prop];\n        if (node.nodeName === 'TR') {\n          return childNode[prop] || childNode;\n        } else {\n          return childNode;\n        }\n      }\n      return node;\n    };\n    var wrap$2 = function (dom, node, name, attrs) {\n      var wrapper = dom.create(name, attrs);\n      node.parentNode.insertBefore(wrapper, node);\n      wrapper.appendChild(node);\n      return wrapper;\n    };\n    var wrapWithSiblings = function (dom, node, next, name, attrs) {\n      var start = SugarElement.fromDom(node);\n      var wrapper = SugarElement.fromDom(dom.create(name, attrs));\n      var siblings = next ? nextSiblings(start) : prevSiblings(start);\n      append$1(wrapper, siblings);\n      if (next) {\n        before(start, wrapper);\n        prepend(wrapper, start);\n      } else {\n        after(start, wrapper);\n        append(wrapper, start);\n      }\n      return wrapper.dom;\n    };\n    var matchName$1 = function (dom, node, format) {\n      if (isEq$3(node, format.inline)) {\n        return true;\n      }\n      if (isEq$3(node, format.block)) {\n        return true;\n      }\n      if (format.selector) {\n        return isElement$1(node) && dom.is(node, format.selector);\n      }\n    };\n    var isColorFormatAndAnchor = function (node, format) {\n      return format.links && node.nodeName === 'A';\n    };\n    var find$3 = function (dom, node, next, inc) {\n      node = getNonWhiteSpaceSibling(node, next, inc);\n      return !node || (node.nodeName === 'BR' || dom.isBlock(node));\n    };\n    var removeNode$1 = function (ed, node, format) {\n      var parentNode = node.parentNode;\n      var rootBlockElm;\n      var dom = ed.dom, forcedRootBlock = getForcedRootBlock(ed);\n      if (format.block) {\n        if (!forcedRootBlock) {\n          if (dom.isBlock(node) && !dom.isBlock(parentNode)) {\n            if (!find$3(dom, node, false) && !find$3(dom, node.firstChild, true, true)) {\n              node.insertBefore(dom.create('br'), node.firstChild);\n            }\n            if (!find$3(dom, node, true) && !find$3(dom, node.lastChild, false, true)) {\n              node.appendChild(dom.create('br'));\n            }\n          }\n        } else {\n          if (parentNode === dom.getRoot()) {\n            if (!format.list_block || !isEq$3(node, format.list_block)) {\n              each(from$1(node.childNodes), function (node) {\n                if (isValid(ed, forcedRootBlock, node.nodeName.toLowerCase())) {\n                  if (!rootBlockElm) {\n                    rootBlockElm = wrap$2(dom, node, forcedRootBlock);\n                    dom.setAttribs(rootBlockElm, ed.settings.forced_root_block_attrs);\n                  } else {\n                    rootBlockElm.appendChild(node);\n                  }\n                } else {\n                  rootBlockElm = 0;\n                }\n              });\n            }\n          }\n        }\n      }\n      if (format.selector && format.inline && !isEq$3(format.inline, node)) {\n        return;\n      }\n      dom.remove(node, true);\n    };\n    var removeFormatInternal = function (ed, format, vars, node, compareNode) {\n      var stylesModified;\n      var dom = ed.dom;\n      if (!matchName$1(dom, node, format) && !isColorFormatAndAnchor(node, format)) {\n        return removeResult.keep();\n      }\n      var elm = node;\n      if (format.inline && format.remove === 'all' && isArray(format.preserve_attributes)) {\n        var attrsToPreserve = filter(dom.getAttribs(elm), function (attr) {\n          return contains(format.preserve_attributes, attr.name.toLowerCase());\n        });\n        dom.removeAllAttribs(elm);\n        each(attrsToPreserve, function (attr) {\n          return dom.setAttrib(elm, attr.name, attr.value);\n        });\n        if (attrsToPreserve.length > 0) {\n          return removeResult.rename('span');\n        }\n      }\n      if (format.remove !== 'all') {\n        each$a(format.styles, function (value, name) {\n          value = normalizeStyleValue(dom, replaceVars(value, vars), name + '');\n          if (isNumber(name)) {\n            name = value;\n            compareNode = null;\n          }\n          if (format.remove_similar || (!compareNode || isEq$3(getStyle(dom, compareNode, name), value))) {\n            dom.setStyle(elm, name, '');\n          }\n          stylesModified = true;\n        });\n        if (stylesModified && dom.getAttrib(elm, 'style') === '') {\n          elm.removeAttribute('style');\n          elm.removeAttribute('data-mce-style');\n        }\n        each$a(format.attributes, function (value, name) {\n          var valueOut;\n          value = replaceVars(value, vars);\n          if (isNumber(name)) {\n            name = value;\n            compareNode = null;\n          }\n          if (format.remove_similar || (!compareNode || isEq$3(dom.getAttrib(compareNode, name), value))) {\n            if (name === 'class') {\n              value = dom.getAttrib(elm, name);\n              if (value) {\n                valueOut = '';\n                each(value.split(/\\s+/), function (cls) {\n                  if (/mce\\-\\w+/.test(cls)) {\n                    valueOut += (valueOut ? ' ' : '') + cls;\n                  }\n                });\n                if (valueOut) {\n                  dom.setAttrib(elm, name, valueOut);\n                  return;\n                }\n              }\n            }\n            if (MCE_ATTR_RE.test(name)) {\n              elm.removeAttribute('data-mce-' + name);\n            }\n            if (name === 'style' && matchNodeNames(['li'])(elm) && dom.getStyle(elm, 'list-style-type') === 'none') {\n              elm.removeAttribute(name);\n              dom.setStyle(elm, 'list-style-type', 'none');\n              return;\n            }\n            if (name === 'class') {\n              elm.removeAttribute('className');\n            }\n            elm.removeAttribute(name);\n          }\n        });\n        each$a(format.classes, function (value) {\n          value = replaceVars(value, vars);\n          if (!compareNode || dom.hasClass(compareNode, value)) {\n            dom.removeClass(elm, value);\n          }\n        });\n        var attrs = dom.getAttribs(elm);\n        for (var i = 0; i < attrs.length; i++) {\n          var attrName = attrs[i].nodeName;\n          if (attrName.indexOf('_') !== 0 && attrName.indexOf('data-') !== 0) {\n            return removeResult.keep();\n          }\n        }\n      }\n      if (format.remove !== 'none') {\n        removeNode$1(ed, elm, format);\n        return removeResult.removed();\n      }\n      return removeResult.keep();\n    };\n    var removeFormat = function (ed, format, vars, node, compareNode) {\n      return removeFormatInternal(ed, format, vars, node, compareNode).fold(never, function (newName) {\n        ed.dom.rename(node, newName);\n        return true;\n      }, always);\n    };\n    var findFormatRoot = function (editor, container, name, vars, similar) {\n      var formatRoot;\n      each(getParents$1(editor.dom, container.parentNode).reverse(), function (parent) {\n        if (!formatRoot && parent.id !== '_start' && parent.id !== '_end') {\n          var format = matchNode(editor, parent, name, vars, similar);\n          if (format && format.split !== false) {\n            formatRoot = parent;\n          }\n        }\n      });\n      return formatRoot;\n    };\n    var removeFormatFromClone = function (editor, format, vars, clone) {\n      return removeFormatInternal(editor, format, vars, clone, clone).fold(constant(clone), function (newName) {\n        var fragment = editor.dom.createFragment();\n        fragment.appendChild(clone);\n        return editor.dom.rename(clone, newName);\n      }, constant(null));\n    };\n    var wrapAndSplit = function (editor, formatList, formatRoot, container, target, split, format, vars) {\n      var clone, lastClone, firstClone;\n      var dom = editor.dom;\n      if (formatRoot) {\n        var formatRootParent = formatRoot.parentNode;\n        for (var parent_1 = container.parentNode; parent_1 && parent_1 !== formatRootParent; parent_1 = parent_1.parentNode) {\n          clone = dom.clone(parent_1, false);\n          for (var i = 0; i < formatList.length; i++) {\n            clone = removeFormatFromClone(editor, formatList[i], vars, clone);\n            if (clone === null) {\n              break;\n            }\n          }\n          if (clone) {\n            if (lastClone) {\n              clone.appendChild(lastClone);\n            }\n            if (!firstClone) {\n              firstClone = clone;\n            }\n            lastClone = clone;\n          }\n        }\n        if (split && (!format.mixed || !dom.isBlock(formatRoot))) {\n          container = dom.split(formatRoot, container);\n        }\n        if (lastClone) {\n          target.parentNode.insertBefore(lastClone, target);\n          firstClone.appendChild(target);\n          if (format.inline) {\n            mergeSiblings(dom, format, vars, lastClone);\n          }\n        }\n      }\n      return container;\n    };\n    var remove$6 = function (ed, name, vars, node, similar) {\n      var formatList = ed.formatter.get(name);\n      var format = formatList[0];\n      var contentEditable = true;\n      var dom = ed.dom;\n      var selection = ed.selection;\n      var splitToFormatRoot = function (container) {\n        var formatRoot = findFormatRoot(ed, container, name, vars, similar);\n        return wrapAndSplit(ed, formatList, formatRoot, container, container, true, format, vars);\n      };\n      var isRemoveBookmarkNode = function (node) {\n        return isBookmarkNode$1(node) && isElement$1(node) && (node.id === '_start' || node.id === '_end');\n      };\n      var process = function (node) {\n        var lastContentEditable, hasContentEditableState;\n        var parentNode = node.parentNode;\n        if (isText$1(node) && hasBlockChildren(dom, parentNode)) {\n          removeFormat(ed, format, vars, parentNode, parentNode);\n        }\n        if (isElement$1(node) && dom.getContentEditable(node)) {\n          lastContentEditable = contentEditable;\n          contentEditable = dom.getContentEditable(node) === 'true';\n          hasContentEditableState = true;\n        }\n        var children = from$1(node.childNodes);\n        if (contentEditable && !hasContentEditableState) {\n          for (var i = 0; i < formatList.length; i++) {\n            if (removeFormat(ed, formatList[i], vars, node, node)) {\n              break;\n            }\n          }\n        }\n        if (format.deep) {\n          if (children.length) {\n            for (var i = 0; i < children.length; i++) {\n              process(children[i]);\n            }\n            if (hasContentEditableState) {\n              contentEditable = lastContentEditable;\n            }\n          }\n        }\n      };\n      var unwrap = function (start) {\n        var node = dom.get(start ? '_start' : '_end');\n        var out = node[start ? 'firstChild' : 'lastChild'];\n        if (isRemoveBookmarkNode(out)) {\n          out = out[start ? 'firstChild' : 'lastChild'];\n        }\n        if (isText$1(out) && out.data.length === 0) {\n          out = start ? node.previousSibling || node.nextSibling : node.nextSibling || node.previousSibling;\n        }\n        dom.remove(node, true);\n        return out;\n      };\n      var removeRngStyle = function (rng) {\n        var startContainer, endContainer;\n        var expandedRng = expandRng(ed, rng, formatList, rng.collapsed);\n        if (format.split) {\n          expandedRng = split$1(expandedRng);\n          startContainer = getContainer(ed, expandedRng, true);\n          endContainer = getContainer(ed, expandedRng);\n          if (startContainer !== endContainer) {\n            startContainer = normalizeTableSelection(startContainer, true);\n            endContainer = normalizeTableSelection(endContainer, false);\n            if (isChildOfInlineParent(dom, startContainer, endContainer)) {\n              var marker = Optional.from(startContainer.firstChild).getOr(startContainer);\n              splitToFormatRoot(wrapWithSiblings(dom, marker, true, 'span', {\n                'id': '_start',\n                'data-mce-type': 'bookmark'\n              }));\n              unwrap(true);\n              return;\n            }\n            if (isChildOfInlineParent(dom, endContainer, startContainer)) {\n              var marker = Optional.from(endContainer.lastChild).getOr(endContainer);\n              splitToFormatRoot(wrapWithSiblings(dom, marker, false, 'span', {\n                'id': '_end',\n                'data-mce-type': 'bookmark'\n              }));\n              unwrap(false);\n              return;\n            }\n            startContainer = wrap$2(dom, startContainer, 'span', {\n              'id': '_start',\n              'data-mce-type': 'bookmark'\n            });\n            endContainer = wrap$2(dom, endContainer, 'span', {\n              'id': '_end',\n              'data-mce-type': 'bookmark'\n            });\n            var newRng = dom.createRng();\n            newRng.setStartAfter(startContainer);\n            newRng.setEndBefore(endContainer);\n            walk$1(dom, newRng, function (nodes) {\n              each(nodes, function (n) {\n                if (!isBookmarkNode$1(n) && !isBookmarkNode$1(n.parentNode)) {\n                  splitToFormatRoot(n);\n                }\n              });\n            });\n            splitToFormatRoot(startContainer);\n            splitToFormatRoot(endContainer);\n            startContainer = unwrap(true);\n            endContainer = unwrap();\n          } else {\n            startContainer = endContainer = splitToFormatRoot(startContainer);\n          }\n          expandedRng.startContainer = startContainer.parentNode ? startContainer.parentNode : startContainer;\n          expandedRng.startOffset = dom.nodeIndex(startContainer);\n          expandedRng.endContainer = endContainer.parentNode ? endContainer.parentNode : endContainer;\n          expandedRng.endOffset = dom.nodeIndex(endContainer) + 1;\n        }\n        walk$1(dom, expandedRng, function (nodes) {\n          each(nodes, function (node) {\n            process(node);\n            var textDecorations = [\n              'underline',\n              'line-through',\n              'overline'\n            ];\n            each(textDecorations, function (decoration) {\n              if (isElement$1(node) && ed.dom.getStyle(node, 'text-decoration') === decoration && node.parentNode && getTextDecoration(dom, node.parentNode) === decoration) {\n                removeFormat(ed, {\n                  deep: false,\n                  exact: true,\n                  inline: 'span',\n                  styles: { textDecoration: decoration }\n                }, null, node);\n              }\n            });\n          });\n        });\n      };\n      if (node) {\n        if (isNode(node)) {\n          var rng = dom.createRng();\n          rng.setStartBefore(node);\n          rng.setEndAfter(node);\n          removeRngStyle(rng);\n        } else {\n          removeRngStyle(node);\n        }\n        return;\n      }\n      if (dom.getContentEditable(selection.getNode()) === 'false') {\n        node = selection.getNode();\n        for (var i = 0; i < formatList.length; i++) {\n          if (formatList[i].ceFalseOverride) {\n            if (removeFormat(ed, formatList[i], vars, node, node)) {\n              break;\n            }\n          }\n        }\n        return;\n      }\n      if (!selection.isCollapsed() || !format.inline || getCellsFromEditor(ed).length) {\n        preserve(selection, true, function () {\n          runOnRanges(ed, removeRngStyle);\n        });\n        if (format.inline && match(ed, name, vars, selection.getStart())) {\n          moveStart(dom, selection, selection.getRng());\n        }\n        ed.nodeChanged();\n      } else {\n        removeCaretFormat(ed, name, vars, similar);\n      }\n    };\n\n    var each$b = Tools.each;\n    var mergeTextDecorationsAndColor = function (dom, format, vars, node) {\n      var processTextDecorationsAndColor = function (n) {\n        if (n.nodeType === 1 && n.parentNode && n.parentNode.nodeType === 1) {\n          var textDecoration = getTextDecoration(dom, n.parentNode);\n          if (dom.getStyle(n, 'color') && textDecoration) {\n            dom.setStyle(n, 'text-decoration', textDecoration);\n          } else if (dom.getStyle(n, 'text-decoration') === textDecoration) {\n            dom.setStyle(n, 'text-decoration', null);\n          }\n        }\n      };\n      if (format.styles && (format.styles.color || format.styles.textDecoration)) {\n        Tools.walk(node, processTextDecorationsAndColor, 'childNodes');\n        processTextDecorationsAndColor(node);\n      }\n    };\n    var mergeBackgroundColorAndFontSize = function (dom, format, vars, node) {\n      if (format.styles && format.styles.backgroundColor) {\n        processChildElements(node, hasStyle(dom, 'fontSize'), applyStyle(dom, 'backgroundColor', replaceVars(format.styles.backgroundColor, vars)));\n      }\n    };\n    var mergeSubSup = function (dom, format, vars, node) {\n      if (format.inline === 'sub' || format.inline === 'sup') {\n        processChildElements(node, hasStyle(dom, 'fontSize'), applyStyle(dom, 'fontSize', ''));\n        dom.remove(dom.select(format.inline === 'sup' ? 'sub' : 'sup', node), true);\n      }\n    };\n    var mergeWithChildren = function (editor, formatList, vars, node) {\n      each$b(formatList, function (format) {\n        each$b(editor.dom.select(format.inline, node), function (child) {\n          if (!isElementNode(child)) {\n            return;\n          }\n          removeFormat(editor, format, vars, child, format.exact ? child : null);\n        });\n        clearChildStyles(editor.dom, format, node);\n      });\n    };\n    var mergeWithParents = function (editor, format, name, vars, node) {\n      if (matchNode(editor, node.parentNode, name, vars)) {\n        if (removeFormat(editor, format, vars, node)) {\n          return;\n        }\n      }\n      if (format.merge_with_parents) {\n        editor.dom.getParent(node.parentNode, function (parent) {\n          if (matchNode(editor, parent, name, vars)) {\n            removeFormat(editor, format, vars, node);\n            return true;\n          }\n        });\n      }\n    };\n\n    var each$c = Tools.each;\n    var hasFormatProperty = function (format, prop) {\n      return hasNonNullableKey(format, prop);\n    };\n    var isElementNode$1 = function (node) {\n      return node && node.nodeType === 1 && !isBookmarkNode$1(node) && !isCaretNode(node) && !isBogus(node);\n    };\n    var canFormatBR = function (editor, format, node, parentName) {\n      if (canFormatEmptyLines(editor) && isInlineFormat(format)) {\n        var validBRParentElements = __assign(__assign({}, editor.schema.getTextBlockElements()), {\n          td: {},\n          th: {},\n          li: {},\n          dt: {},\n          dd: {},\n          figcaption: {},\n          caption: {},\n          details: {},\n          summary: {}\n        });\n        var hasCaretNodeSibling = sibling$2(SugarElement.fromDom(node), function (sibling) {\n          return isCaretNode(sibling.dom);\n        });\n        return hasNonNullableKey(validBRParentElements, parentName) && isEmpty(SugarElement.fromDom(node.parentNode), false) && !hasCaretNodeSibling;\n      } else {\n        return false;\n      }\n    };\n    var applyFormat = function (ed, name, vars, node) {\n      var formatList = ed.formatter.get(name);\n      var format = formatList[0];\n      var isCollapsed = !node && ed.selection.isCollapsed();\n      var dom = ed.dom;\n      var selection = ed.selection;\n      var setElementFormat = function (elm, fmt) {\n        fmt = fmt || format;\n        if (elm) {\n          if (fmt.onformat) {\n            fmt.onformat(elm, fmt, vars, node);\n          }\n          each$c(fmt.styles, function (value, name) {\n            dom.setStyle(elm, name, replaceVars(value, vars));\n          });\n          if (fmt.styles) {\n            var styleVal = dom.getAttrib(elm, 'style');\n            if (styleVal) {\n              dom.setAttrib(elm, 'data-mce-style', styleVal);\n            }\n          }\n          each$c(fmt.attributes, function (value, name) {\n            dom.setAttrib(elm, name, replaceVars(value, vars));\n          });\n          each$c(fmt.classes, function (value) {\n            value = replaceVars(value, vars);\n            if (!dom.hasClass(elm, value)) {\n              dom.addClass(elm, value);\n            }\n          });\n        }\n      };\n      var applyNodeStyle = function (formatList, node) {\n        var found = false;\n        if (!isSelectorFormat(format)) {\n          return false;\n        }\n        each$c(formatList, function (format) {\n          if ('collapsed' in format && format.collapsed !== isCollapsed) {\n            return;\n          }\n          if (dom.is(node, format.selector) && !isCaretNode(node)) {\n            setElementFormat(node, format);\n            found = true;\n            return false;\n          }\n        });\n        return found;\n      };\n      var applyRngStyle = function (dom, rng, bookmark, nodeSpecific) {\n        var newWrappers = [];\n        var contentEditable = true;\n        var wrapName = format.inline || format.block;\n        var wrapElm = dom.create(wrapName);\n        setElementFormat(wrapElm);\n        walk$1(dom, rng, function (nodes) {\n          var currentWrapElm;\n          var process = function (node) {\n            var hasContentEditableState = false;\n            var lastContentEditable = contentEditable;\n            var nodeName = node.nodeName.toLowerCase();\n            var parentName = node.parentNode.nodeName.toLowerCase();\n            if (isElement$1(node) && dom.getContentEditable(node)) {\n              lastContentEditable = contentEditable;\n              contentEditable = dom.getContentEditable(node) === 'true';\n              hasContentEditableState = true;\n            }\n            if (isBr(node) && !canFormatBR(ed, format, node, parentName)) {\n              currentWrapElm = null;\n              if (isBlockFormat(format)) {\n                dom.remove(node);\n              }\n              return;\n            }\n            if (format.wrapper && matchNode(ed, node, name, vars)) {\n              currentWrapElm = null;\n              return;\n            }\n            if (contentEditable && !hasContentEditableState && isBlockFormat(format) && !format.wrapper && isTextBlock$1(ed, nodeName) && isValid(ed, parentName, wrapName)) {\n              var elm = dom.rename(node, wrapName);\n              setElementFormat(elm);\n              newWrappers.push(elm);\n              currentWrapElm = null;\n              return;\n            }\n            if (isSelectorFormat(format)) {\n              var found = applyNodeStyle(formatList, node);\n              if (isText$1(node) && hasBlockChildren(dom, node.parentNode)) {\n                applyNodeStyle(formatList, node.parentNode);\n              }\n              if (!hasFormatProperty(format, 'inline') || found) {\n                currentWrapElm = null;\n                return;\n              }\n            }\n            if (contentEditable && !hasContentEditableState && isValid(ed, wrapName, nodeName) && isValid(ed, parentName, wrapName) && !(!nodeSpecific && node.nodeType === 3 && node.nodeValue.length === 1 && node.nodeValue.charCodeAt(0) === 65279) && !isCaretNode(node) && (!hasFormatProperty(format, 'inline') || !dom.isBlock(node))) {\n              if (!currentWrapElm) {\n                currentWrapElm = dom.clone(wrapElm, false);\n                node.parentNode.insertBefore(currentWrapElm, node);\n                newWrappers.push(currentWrapElm);\n              }\n              currentWrapElm.appendChild(node);\n            } else {\n              currentWrapElm = null;\n              each$c(Tools.grep(node.childNodes), process);\n              if (hasContentEditableState) {\n                contentEditable = lastContentEditable;\n              }\n              currentWrapElm = null;\n            }\n          };\n          each$c(nodes, process);\n        });\n        if (format.links === true) {\n          each$c(newWrappers, function (node) {\n            var process = function (node) {\n              if (node.nodeName === 'A') {\n                setElementFormat(node, format);\n              }\n              each$c(Tools.grep(node.childNodes), process);\n            };\n            process(node);\n          });\n        }\n        each$c(newWrappers, function (node) {\n          var getChildCount = function (node) {\n            var count = 0;\n            each$c(node.childNodes, function (node) {\n              if (!isEmptyTextNode(node) && !isBookmarkNode$1(node)) {\n                count++;\n              }\n            });\n            return count;\n          };\n          var getChildElementNode = function (root) {\n            var child = false;\n            each$c(root.childNodes, function (node) {\n              if (isElementNode$1(node)) {\n                child = node;\n                return false;\n              }\n            });\n            return child;\n          };\n          var mergeStyles = function (node) {\n            var clone;\n            var child = getChildElementNode(node);\n            if (child && !isBookmarkNode$1(child) && matchName(dom, child, format)) {\n              clone = dom.clone(child, false);\n              setElementFormat(clone);\n              dom.replace(clone, node, true);\n              dom.remove(child, true);\n            }\n            return clone || node;\n          };\n          var childCount = getChildCount(node);\n          if ((newWrappers.length > 1 || !dom.isBlock(node)) && childCount === 0) {\n            dom.remove(node, true);\n            return;\n          }\n          if (isInlineFormat(format) || format.wrapper) {\n            if (!format.exact && childCount === 1) {\n              node = mergeStyles(node);\n            }\n            mergeWithChildren(ed, formatList, vars, node);\n            mergeWithParents(ed, format, name, vars, node);\n            mergeBackgroundColorAndFontSize(dom, format, vars, node);\n            mergeTextDecorationsAndColor(dom, format, vars, node);\n            mergeSubSup(dom, format, vars, node);\n            mergeSiblings(dom, format, vars, node);\n          }\n        });\n      };\n      if (dom.getContentEditable(selection.getNode()) === 'false') {\n        node = selection.getNode();\n        for (var i = 0, l = formatList.length; i < l; i++) {\n          var formatItem = formatList[i];\n          if (formatItem.ceFalseOverride && isSelectorFormat(formatItem) && dom.is(node, formatItem.selector)) {\n            setElementFormat(node, formatItem);\n            return;\n          }\n        }\n        return;\n      }\n      if (format) {\n        if (node) {\n          if (isNode(node)) {\n            if (!applyNodeStyle(formatList, node)) {\n              var rng = dom.createRng();\n              rng.setStartBefore(node);\n              rng.setEndAfter(node);\n              applyRngStyle(dom, expandRng(ed, rng, formatList), null, true);\n            }\n          } else {\n            applyRngStyle(dom, node, null, true);\n          }\n        } else {\n          if (!isCollapsed || !isInlineFormat(format) || getCellsFromEditor(ed).length) {\n            var curSelNode = selection.getNode();\n            var firstFormat = formatList[0];\n            if (!ed.settings.forced_root_block && firstFormat.defaultBlock && !dom.getParent(curSelNode, dom.isBlock)) {\n              applyFormat(ed, firstFormat.defaultBlock);\n            }\n            selection.setRng(normalize$2(selection.getRng()));\n            preserve(selection, true, function (bookmark) {\n              runOnRanges(ed, function (selectionRng, fake) {\n                var expandedRng = fake ? selectionRng : expandRng(ed, selectionRng, formatList);\n                applyRngStyle(dom, expandedRng);\n              });\n            });\n            moveStart(dom, selection, selection.getRng());\n            ed.nodeChanged();\n          } else {\n            applyCaretFormat(ed, name, vars);\n          }\n        }\n        postProcess(name, ed);\n      }\n    };\n\n    var setup$4 = function (registeredFormatListeners, editor) {\n      var currentFormats = Cell({});\n      registeredFormatListeners.set({});\n      editor.on('NodeChange', function (e) {\n        updateAndFireChangeCallbacks(editor, e.element, currentFormats, registeredFormatListeners.get());\n      });\n    };\n    var updateAndFireChangeCallbacks = function (editor, elm, currentFormats, formatChangeData) {\n      var formatsList = keys(currentFormats.get());\n      var newFormats = {};\n      var matchedFormats = {};\n      var parents = filter(getParents$1(editor.dom, elm), function (node) {\n        return node.nodeType === 1 && !node.getAttribute('data-mce-bogus');\n      });\n      each$1(formatChangeData, function (data, format) {\n        Tools.each(parents, function (node) {\n          if (editor.formatter.matchNode(node, format, {}, data.similar)) {\n            if (formatsList.indexOf(format) === -1) {\n              each(data.callbacks, function (callback) {\n                callback(true, {\n                  node: node,\n                  format: format,\n                  parents: parents\n                });\n              });\n              newFormats[format] = data.callbacks;\n            }\n            matchedFormats[format] = data.callbacks;\n            return false;\n          }\n          if (matchesUnInheritedFormatSelector(editor, node, format)) {\n            return false;\n          }\n        });\n      });\n      var remainingFormats = filterRemainingFormats(currentFormats.get(), matchedFormats, elm, parents);\n      currentFormats.set(__assign(__assign({}, newFormats), remainingFormats));\n    };\n    var filterRemainingFormats = function (currentFormats, matchedFormats, elm, parents) {\n      return bifilter(currentFormats, function (callbacks, format) {\n        if (!has(matchedFormats, format)) {\n          each(callbacks, function (callback) {\n            callback(false, {\n              node: elm,\n              format: format,\n              parents: parents\n            });\n          });\n          return false;\n        } else {\n          return true;\n        }\n      }).t;\n    };\n    var addListeners = function (registeredFormatListeners, formats, callback, similar) {\n      var formatChangeItems = registeredFormatListeners.get();\n      each(formats.split(','), function (format) {\n        if (!formatChangeItems[format]) {\n          formatChangeItems[format] = {\n            similar: similar,\n            callbacks: []\n          };\n        }\n        formatChangeItems[format].callbacks.push(callback);\n      });\n      registeredFormatListeners.set(formatChangeItems);\n    };\n    var removeListeners = function (registeredFormatListeners, formats, callback) {\n      var formatChangeItems = registeredFormatListeners.get();\n      each(formats.split(','), function (format) {\n        formatChangeItems[format].callbacks = filter(formatChangeItems[format].callbacks, function (c) {\n          return c !== callback;\n        });\n        if (formatChangeItems[format].callbacks.length === 0) {\n          delete formatChangeItems[format];\n        }\n      });\n      registeredFormatListeners.set(formatChangeItems);\n    };\n    var formatChangedInternal = function (editor, registeredFormatListeners, formats, callback, similar) {\n      if (registeredFormatListeners.get() === null) {\n        setup$4(registeredFormatListeners, editor);\n      }\n      addListeners(registeredFormatListeners, formats, callback, similar);\n      return {\n        unbind: function () {\n          return removeListeners(registeredFormatListeners, formats, callback);\n        }\n      };\n    };\n\n    var toggle = function (editor, name, vars, node) {\n      var fmt = editor.formatter.get(name);\n      if (match(editor, name, vars, node) && (!('toggle' in fmt[0]) || fmt[0].toggle)) {\n        remove$6(editor, name, vars, node);\n      } else {\n        applyFormat(editor, name, vars, node);\n      }\n    };\n\n    var fromElements = function (elements, scope) {\n      var doc = scope || document;\n      var fragment = doc.createDocumentFragment();\n      each(elements, function (element) {\n        fragment.appendChild(element.dom);\n      });\n      return SugarElement.fromDom(fragment);\n    };\n\n    var tableModel = function (element, width, rows) {\n      return {\n        element: element,\n        width: width,\n        rows: rows\n      };\n    };\n    var tableRow = function (element, cells) {\n      return {\n        element: element,\n        cells: cells\n      };\n    };\n    var cellPosition = function (x, y) {\n      return {\n        x: x,\n        y: y\n      };\n    };\n    var getSpan = function (td, key) {\n      var value = parseInt(get$4(td, key), 10);\n      return isNaN(value) ? 1 : value;\n    };\n    var fillout = function (table, x, y, tr, td) {\n      var rowspan = getSpan(td, 'rowspan');\n      var colspan = getSpan(td, 'colspan');\n      var rows = table.rows;\n      for (var y2 = y; y2 < y + rowspan; y2++) {\n        if (!rows[y2]) {\n          rows[y2] = tableRow(deep(tr), []);\n        }\n        for (var x2 = x; x2 < x + colspan; x2++) {\n          var cells = rows[y2].cells;\n          cells[x2] = y2 === y && x2 === x ? td : shallow(td);\n        }\n      }\n    };\n    var cellExists = function (table, x, y) {\n      var rows = table.rows;\n      var cells = rows[y] ? rows[y].cells : [];\n      return !!cells[x];\n    };\n    var skipCellsX = function (table, x, y) {\n      while (cellExists(table, x, y)) {\n        x++;\n      }\n      return x;\n    };\n    var getWidth = function (rows) {\n      return foldl(rows, function (acc, row) {\n        return row.cells.length > acc ? row.cells.length : acc;\n      }, 0);\n    };\n    var findElementPos = function (table, element) {\n      var rows = table.rows;\n      for (var y = 0; y < rows.length; y++) {\n        var cells = rows[y].cells;\n        for (var x = 0; x < cells.length; x++) {\n          if (eq$2(cells[x], element)) {\n            return Optional.some(cellPosition(x, y));\n          }\n        }\n      }\n      return Optional.none();\n    };\n    var extractRows = function (table, sx, sy, ex, ey) {\n      var newRows = [];\n      var rows = table.rows;\n      for (var y = sy; y <= ey; y++) {\n        var cells = rows[y].cells;\n        var slice = sx < ex ? cells.slice(sx, ex + 1) : cells.slice(ex, sx + 1);\n        newRows.push(tableRow(rows[y].element, slice));\n      }\n      return newRows;\n    };\n    var subTable = function (table, startPos, endPos) {\n      var sx = startPos.x, sy = startPos.y;\n      var ex = endPos.x, ey = endPos.y;\n      var newRows = sy < ey ? extractRows(table, sx, sy, ex, ey) : extractRows(table, sx, ey, ex, sy);\n      return tableModel(table.element, getWidth(newRows), newRows);\n    };\n    var createDomTable = function (table, rows) {\n      var tableElement = shallow(table.element);\n      var tableBody = SugarElement.fromTag('tbody');\n      append$1(tableBody, rows);\n      append(tableElement, tableBody);\n      return tableElement;\n    };\n    var modelRowsToDomRows = function (table) {\n      return map(table.rows, function (row) {\n        var cells = map(row.cells, function (cell) {\n          var td = deep(cell);\n          remove$1(td, 'colspan');\n          remove$1(td, 'rowspan');\n          return td;\n        });\n        var tr = shallow(row.element);\n        append$1(tr, cells);\n        return tr;\n      });\n    };\n    var fromDom$1 = function (tableElm) {\n      var table = tableModel(shallow(tableElm), 0, []);\n      each(descendants$1(tableElm, 'tr'), function (tr, y) {\n        each(descendants$1(tr, 'td,th'), function (td, x) {\n          fillout(table, skipCellsX(table, x, y), y, tr, td);\n        });\n      });\n      return tableModel(table.element, getWidth(table.rows), table.rows);\n    };\n    var toDom = function (table) {\n      return createDomTable(table, modelRowsToDomRows(table));\n    };\n    var subsection = function (table, startElement, endElement) {\n      return findElementPos(table, startElement).bind(function (startPos) {\n        return findElementPos(table, endElement).map(function (endPos) {\n          return subTable(table, startPos, endPos);\n        });\n      });\n    };\n\n    var findParentListContainer = function (parents) {\n      return find(parents, function (elm) {\n        return name(elm) === 'ul' || name(elm) === 'ol';\n      });\n    };\n    var getFullySelectedListWrappers = function (parents, rng) {\n      return find(parents, function (elm) {\n        return name(elm) === 'li' && hasAllContentsSelected(elm, rng);\n      }).fold(constant([]), function (_li) {\n        return findParentListContainer(parents).map(function (listCont) {\n          var listElm = SugarElement.fromTag(name(listCont));\n          var listStyles = filter$1(getAllRaw(listCont), function (_style, name) {\n            return startsWith(name, 'list-style');\n          });\n          setAll$1(listElm, listStyles);\n          return [\n            SugarElement.fromTag('li'),\n            listElm\n          ];\n        }).getOr([]);\n      });\n    };\n    var wrap$3 = function (innerElm, elms) {\n      var wrapped = foldl(elms, function (acc, elm) {\n        append(elm, acc);\n        return elm;\n      }, innerElm);\n      return elms.length > 0 ? fromElements([wrapped]) : wrapped;\n    };\n    var directListWrappers = function (commonAnchorContainer) {\n      if (isListItem(commonAnchorContainer)) {\n        return parent(commonAnchorContainer).filter(isList).fold(constant([]), function (listElm) {\n          return [\n            commonAnchorContainer,\n            listElm\n          ];\n        });\n      } else {\n        return isList(commonAnchorContainer) ? [commonAnchorContainer] : [];\n      }\n    };\n    var getWrapElements = function (rootNode, rng) {\n      var commonAnchorContainer = SugarElement.fromDom(rng.commonAncestorContainer);\n      var parents = parentsAndSelf(commonAnchorContainer, rootNode);\n      var wrapElements = filter(parents, function (elm) {\n        return isInline(elm) || isHeading(elm);\n      });\n      var listWrappers = getFullySelectedListWrappers(parents, rng);\n      var allWrappers = wrapElements.concat(listWrappers.length ? listWrappers : directListWrappers(commonAnchorContainer));\n      return map(allWrappers, shallow);\n    };\n    var emptyFragment = function () {\n      return fromElements([]);\n    };\n    var getFragmentFromRange = function (rootNode, rng) {\n      return wrap$3(SugarElement.fromDom(rng.cloneContents()), getWrapElements(rootNode, rng));\n    };\n    var getParentTable = function (rootElm, cell) {\n      return ancestor$1(cell, 'table', curry(eq$2, rootElm));\n    };\n    var getTableFragment = function (rootNode, selectedTableCells) {\n      return getParentTable(rootNode, selectedTableCells[0]).bind(function (tableElm) {\n        var firstCell = selectedTableCells[0];\n        var lastCell = selectedTableCells[selectedTableCells.length - 1];\n        var fullTableModel = fromDom$1(tableElm);\n        return subsection(fullTableModel, firstCell, lastCell).map(function (sectionedTableModel) {\n          return fromElements([toDom(sectionedTableModel)]);\n        });\n      }).getOrThunk(emptyFragment);\n    };\n    var getSelectionFragment = function (rootNode, ranges) {\n      return ranges.length > 0 && ranges[0].collapsed ? emptyFragment() : getFragmentFromRange(rootNode, ranges[0]);\n    };\n    var read$1 = function (rootNode, ranges) {\n      var selectedCells = getCellsFromElementOrRanges(ranges, rootNode);\n      return selectedCells.length > 0 ? getTableFragment(rootNode, selectedCells) : getSelectionFragment(rootNode, ranges);\n    };\n\n    var trimLeadingCollapsibleText = function (text) {\n      return text.replace(/^[ \\f\\n\\r\\t\\v]+/, '');\n    };\n    var isCollapsibleWhitespace = function (text, index) {\n      return index >= 0 && index < text.length && isWhiteSpace$1(text.charAt(index));\n    };\n    var getInnerText = function (bin, shouldTrim) {\n      var text = trim$2(bin.innerText);\n      return shouldTrim ? trimLeadingCollapsibleText(text) : text;\n    };\n    var getContextNodeName = function (parentBlockOpt) {\n      return parentBlockOpt.map(function (block) {\n        return block.nodeName;\n      }).getOr('div').toLowerCase();\n    };\n    var getTextContent = function (editor) {\n      return Optional.from(editor.selection.getRng()).map(function (rng) {\n        var parentBlockOpt = Optional.from(editor.dom.getParent(rng.commonAncestorContainer, editor.dom.isBlock));\n        var body = editor.getBody();\n        var contextNodeName = getContextNodeName(parentBlockOpt);\n        var shouldTrimSpaces = Env.browser.isIE() && contextNodeName !== 'pre';\n        var bin = editor.dom.add(body, contextNodeName, {\n          'data-mce-bogus': 'all',\n          'style': 'overflow: hidden; opacity: 0;'\n        }, rng.cloneContents());\n        var text = getInnerText(bin, shouldTrimSpaces);\n        var nonRenderedText = trim$2(bin.textContent);\n        editor.dom.remove(bin);\n        if (isCollapsibleWhitespace(nonRenderedText, 0) || isCollapsibleWhitespace(nonRenderedText, nonRenderedText.length - 1)) {\n          var parentBlock = parentBlockOpt.getOr(body);\n          var parentBlockText = getInnerText(parentBlock, shouldTrimSpaces);\n          var textIndex = parentBlockText.indexOf(text);\n          if (textIndex === -1) {\n            return text;\n          } else {\n            var hasProceedingSpace = isCollapsibleWhitespace(parentBlockText, textIndex - 1);\n            var hasTrailingSpace = isCollapsibleWhitespace(parentBlockText, textIndex + text.length);\n            return (hasProceedingSpace ? ' ' : '') + text + (hasTrailingSpace ? ' ' : '');\n          }\n        } else {\n          return text;\n        }\n      }).getOr('');\n    };\n    var getSerializedContent = function (editor, args) {\n      var rng = editor.selection.getRng(), tmpElm = editor.dom.create('body');\n      var sel = editor.selection.getSel();\n      var ranges = processRanges(editor, getRanges(sel));\n      var fragment = args.contextual ? read$1(SugarElement.fromDom(editor.getBody()), ranges).dom : rng.cloneContents();\n      if (fragment) {\n        tmpElm.appendChild(fragment);\n      }\n      return editor.selection.serializer.serialize(tmpElm, args);\n    };\n    var getSelectedContentInternal = function (editor, format, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      args.get = true;\n      args.format = format;\n      args.selection = true;\n      args = editor.fire('BeforeGetContent', args);\n      if (args.isDefaultPrevented()) {\n        editor.fire('GetContent', args);\n        return args.content;\n      }\n      if (args.format === 'text') {\n        return getTextContent(editor);\n      } else {\n        args.getInner = true;\n        var content = getSerializedContent(editor, args);\n        if (args.format === 'tree') {\n          return content;\n        } else {\n          args.content = editor.selection.isCollapsed() ? '' : content;\n          editor.fire('GetContent', args);\n          return args.content;\n        }\n      }\n    };\n\n    var KEEP = 0, INSERT = 1, DELETE = 2;\n    var diff = function (left, right) {\n      var size = left.length + right.length + 2;\n      var vDown = new Array(size);\n      var vUp = new Array(size);\n      var snake = function (start, end, diag) {\n        return {\n          start: start,\n          end: end,\n          diag: diag\n        };\n      };\n      var buildScript = function (start1, end1, start2, end2, script) {\n        var middle = getMiddleSnake(start1, end1, start2, end2);\n        if (middle === null || middle.start === end1 && middle.diag === end1 - end2 || middle.end === start1 && middle.diag === start1 - start2) {\n          var i = start1;\n          var j = start2;\n          while (i < end1 || j < end2) {\n            if (i < end1 && j < end2 && left[i] === right[j]) {\n              script.push([\n                KEEP,\n                left[i]\n              ]);\n              ++i;\n              ++j;\n            } else {\n              if (end1 - start1 > end2 - start2) {\n                script.push([\n                  DELETE,\n                  left[i]\n                ]);\n                ++i;\n              } else {\n                script.push([\n                  INSERT,\n                  right[j]\n                ]);\n                ++j;\n              }\n            }\n          }\n        } else {\n          buildScript(start1, middle.start, start2, middle.start - middle.diag, script);\n          for (var i2 = middle.start; i2 < middle.end; ++i2) {\n            script.push([\n              KEEP,\n              left[i2]\n            ]);\n          }\n          buildScript(middle.end, end1, middle.end - middle.diag, end2, script);\n        }\n      };\n      var buildSnake = function (start, diag, end1, end2) {\n        var end = start;\n        while (end - diag < end2 && end < end1 && left[end] === right[end - diag]) {\n          ++end;\n        }\n        return snake(start, end, diag);\n      };\n      var getMiddleSnake = function (start1, end1, start2, end2) {\n        var m = end1 - start1;\n        var n = end2 - start2;\n        if (m === 0 || n === 0) {\n          return null;\n        }\n        var delta = m - n;\n        var sum = n + m;\n        var offset = (sum % 2 === 0 ? sum : sum + 1) / 2;\n        vDown[1 + offset] = start1;\n        vUp[1 + offset] = end1 + 1;\n        var d, k, i, x, y;\n        for (d = 0; d <= offset; ++d) {\n          for (k = -d; k <= d; k += 2) {\n            i = k + offset;\n            if (k === -d || k !== d && vDown[i - 1] < vDown[i + 1]) {\n              vDown[i] = vDown[i + 1];\n            } else {\n              vDown[i] = vDown[i - 1] + 1;\n            }\n            x = vDown[i];\n            y = x - start1 + start2 - k;\n            while (x < end1 && y < end2 && left[x] === right[y]) {\n              vDown[i] = ++x;\n              ++y;\n            }\n            if (delta % 2 !== 0 && delta - d <= k && k <= delta + d) {\n              if (vUp[i - delta] <= vDown[i]) {\n                return buildSnake(vUp[i - delta], k + start1 - start2, end1, end2);\n              }\n            }\n          }\n          for (k = delta - d; k <= delta + d; k += 2) {\n            i = k + offset - delta;\n            if (k === delta - d || k !== delta + d && vUp[i + 1] <= vUp[i - 1]) {\n              vUp[i] = vUp[i + 1] - 1;\n            } else {\n              vUp[i] = vUp[i - 1];\n            }\n            x = vUp[i] - 1;\n            y = x - start1 + start2 - k;\n            while (x >= start1 && y >= start2 && left[x] === right[y]) {\n              vUp[i] = x--;\n              y--;\n            }\n            if (delta % 2 === 0 && -d <= k && k <= d) {\n              if (vUp[i] <= vDown[i + delta]) {\n                return buildSnake(vUp[i], k + start1 - start2, end1, end2);\n              }\n            }\n          }\n        }\n      };\n      var script = [];\n      buildScript(0, left.length, 0, right.length, script);\n      return script;\n    };\n\n    var getOuterHtml = function (elm) {\n      if (isElement$1(elm)) {\n        return elm.outerHTML;\n      } else if (isText$1(elm)) {\n        return Entities.encodeRaw(elm.data, false);\n      } else if (isComment$1(elm)) {\n        return '<!--' + elm.data + '-->';\n      }\n      return '';\n    };\n    var createFragment$1 = function (html) {\n      var node;\n      var container = document.createElement('div');\n      var frag = document.createDocumentFragment();\n      if (html) {\n        container.innerHTML = html;\n      }\n      while (node = container.firstChild) {\n        frag.appendChild(node);\n      }\n      return frag;\n    };\n    var insertAt = function (elm, html, index) {\n      var fragment = createFragment$1(html);\n      if (elm.hasChildNodes() && index < elm.childNodes.length) {\n        var target = elm.childNodes[index];\n        target.parentNode.insertBefore(fragment, target);\n      } else {\n        elm.appendChild(fragment);\n      }\n    };\n    var removeAt = function (elm, index) {\n      if (elm.hasChildNodes() && index < elm.childNodes.length) {\n        var target = elm.childNodes[index];\n        target.parentNode.removeChild(target);\n      }\n    };\n    var applyDiff = function (diff, elm) {\n      var index = 0;\n      each(diff, function (action) {\n        if (action[0] === KEEP) {\n          index++;\n        } else if (action[0] === INSERT) {\n          insertAt(elm, action[1], index);\n          index++;\n        } else if (action[0] === DELETE) {\n          removeAt(elm, index);\n        }\n      });\n    };\n    var read$2 = function (elm) {\n      return filter(map(from$1(elm.childNodes), getOuterHtml), function (item) {\n        return item.length > 0;\n      });\n    };\n    var write = function (fragments, elm) {\n      var currentFragments = map(from$1(elm.childNodes), getOuterHtml);\n      applyDiff(diff(currentFragments, fragments), elm);\n      return elm;\n    };\n\n    var undoLevelDocument = Cell(Optional.none());\n    var lazyTempDocument = function () {\n      return undoLevelDocument.get().getOrThunk(function () {\n        var doc = document.implementation.createHTMLDocument('undo');\n        undoLevelDocument.set(Optional.some(doc));\n        return doc;\n      });\n    };\n    var hasIframes = function (html) {\n      return html.indexOf('</iframe>') !== -1;\n    };\n    var createFragmentedLevel = function (fragments) {\n      return {\n        type: 'fragmented',\n        fragments: fragments,\n        content: '',\n        bookmark: null,\n        beforeBookmark: null\n      };\n    };\n    var createCompleteLevel = function (content) {\n      return {\n        type: 'complete',\n        fragments: null,\n        content: content,\n        bookmark: null,\n        beforeBookmark: null\n      };\n    };\n    var createFromEditor = function (editor) {\n      var fragments = read$2(editor.getBody());\n      var trimmedFragments = bind(fragments, function (html) {\n        var trimmed = trimInternal(editor.serializer, html);\n        return trimmed.length > 0 ? [trimmed] : [];\n      });\n      var content = trimmedFragments.join('');\n      return hasIframes(content) ? createFragmentedLevel(trimmedFragments) : createCompleteLevel(content);\n    };\n    var applyToEditor = function (editor, level, before) {\n      if (level.type === 'fragmented') {\n        write(level.fragments, editor.getBody());\n      } else {\n        editor.setContent(level.content, { format: 'raw' });\n      }\n      editor.selection.moveToBookmark(before ? level.beforeBookmark : level.bookmark);\n    };\n    var getLevelContent = function (level) {\n      return level.type === 'fragmented' ? level.fragments.join('') : level.content;\n    };\n    var getCleanLevelContent = function (level) {\n      var elm = SugarElement.fromTag('body', lazyTempDocument());\n      set$1(elm, getLevelContent(level));\n      each(descendants$1(elm, '*[data-mce-bogus]'), unwrap);\n      return get$7(elm);\n    };\n    var hasEqualContent = function (level1, level2) {\n      return getLevelContent(level1) === getLevelContent(level2);\n    };\n    var hasEqualCleanedContent = function (level1, level2) {\n      return getCleanLevelContent(level1) === getCleanLevelContent(level2);\n    };\n    var isEq$4 = function (level1, level2) {\n      if (!level1 || !level2) {\n        return false;\n      } else if (hasEqualContent(level1, level2)) {\n        return true;\n      } else {\n        return hasEqualCleanedContent(level1, level2);\n      }\n    };\n\n    var isUnlocked = function (locks) {\n      return locks.get() === 0;\n    };\n\n    var setTyping = function (undoManager, typing, locks) {\n      if (isUnlocked(locks)) {\n        undoManager.typing = typing;\n      }\n    };\n    var endTyping = function (undoManager, locks) {\n      if (undoManager.typing) {\n        setTyping(undoManager, false, locks);\n        undoManager.add();\n      }\n    };\n    var endTypingLevelIgnoreLocks = function (undoManager) {\n      if (undoManager.typing) {\n        undoManager.typing = false;\n        undoManager.add();\n      }\n    };\n\n    var beforeChange = function (editor, locks, beforeBookmark) {\n      if (isUnlocked(locks)) {\n        beforeBookmark.set(Optional.some(getUndoBookmark(editor.selection)));\n      }\n    };\n    var addUndoLevel = function (editor, undoManager, index, locks, beforeBookmark, level, event) {\n      var currentLevel = createFromEditor(editor);\n      level = level || {};\n      level = Tools.extend(level, currentLevel);\n      if (isUnlocked(locks) === false || editor.removed) {\n        return null;\n      }\n      var lastLevel = undoManager.data[index.get()];\n      if (editor.fire('BeforeAddUndo', {\n          level: level,\n          lastLevel: lastLevel,\n          originalEvent: event\n        }).isDefaultPrevented()) {\n        return null;\n      }\n      if (lastLevel && isEq$4(lastLevel, level)) {\n        return null;\n      }\n      if (undoManager.data[index.get()]) {\n        beforeBookmark.get().each(function (bm) {\n          undoManager.data[index.get()].beforeBookmark = bm;\n        });\n      }\n      var customUndoRedoLevels = getCustomUndoRedoLevels(editor);\n      if (customUndoRedoLevels) {\n        if (undoManager.data.length > customUndoRedoLevels) {\n          for (var i = 0; i < undoManager.data.length - 1; i++) {\n            undoManager.data[i] = undoManager.data[i + 1];\n          }\n          undoManager.data.length--;\n          index.set(undoManager.data.length);\n        }\n      }\n      level.bookmark = getUndoBookmark(editor.selection);\n      if (index.get() < undoManager.data.length - 1) {\n        undoManager.data.length = index.get() + 1;\n      }\n      undoManager.data.push(level);\n      index.set(undoManager.data.length - 1);\n      var args = {\n        level: level,\n        lastLevel: lastLevel,\n        originalEvent: event\n      };\n      if (index.get() > 0) {\n        editor.setDirty(true);\n        editor.fire('AddUndo', args);\n        editor.fire('change', args);\n      } else {\n        editor.fire('AddUndo', args);\n      }\n      return level;\n    };\n    var clear = function (editor, undoManager, index) {\n      undoManager.data = [];\n      index.set(0);\n      undoManager.typing = false;\n      editor.fire('ClearUndos');\n    };\n    var extra = function (editor, undoManager, index, callback1, callback2) {\n      if (undoManager.transact(callback1)) {\n        var bookmark = undoManager.data[index.get()].bookmark;\n        var lastLevel = undoManager.data[index.get() - 1];\n        applyToEditor(editor, lastLevel, true);\n        if (undoManager.transact(callback2)) {\n          undoManager.data[index.get() - 1].beforeBookmark = bookmark;\n        }\n      }\n    };\n    var redo = function (editor, index, data) {\n      var level;\n      if (index.get() < data.length - 1) {\n        index.set(index.get() + 1);\n        level = data[index.get()];\n        applyToEditor(editor, level, false);\n        editor.setDirty(true);\n        editor.fire('Redo', { level: level });\n      }\n      return level;\n    };\n    var undo = function (editor, undoManager, locks, index) {\n      var level;\n      if (undoManager.typing) {\n        undoManager.add();\n        undoManager.typing = false;\n        setTyping(undoManager, false, locks);\n      }\n      if (index.get() > 0) {\n        index.set(index.get() - 1);\n        level = undoManager.data[index.get()];\n        applyToEditor(editor, level, true);\n        editor.setDirty(true);\n        editor.fire('Undo', { level: level });\n      }\n      return level;\n    };\n    var reset = function (undoManager) {\n      undoManager.clear();\n      undoManager.add();\n    };\n    var hasUndo = function (editor, undoManager, index) {\n      return index.get() > 0 || undoManager.typing && undoManager.data[0] && !isEq$4(createFromEditor(editor), undoManager.data[0]);\n    };\n    var hasRedo = function (undoManager, index) {\n      return index.get() < undoManager.data.length - 1 && !undoManager.typing;\n    };\n    var transact = function (undoManager, locks, callback) {\n      endTyping(undoManager, locks);\n      undoManager.beforeChange();\n      undoManager.ignore(callback);\n      return undoManager.add();\n    };\n    var ignore = function (locks, callback) {\n      try {\n        locks.set(locks.get() + 1);\n        callback();\n      } finally {\n        locks.set(locks.get() - 1);\n      }\n    };\n\n    var addVisualInternal = function (editor, elm) {\n      var dom = editor.dom;\n      var scope = isNonNullable(elm) ? elm : editor.getBody();\n      if (isUndefined(editor.hasVisual)) {\n        editor.hasVisual = isVisualAidsEnabled(editor);\n      }\n      each(dom.select('table,a', scope), function (matchedElm) {\n        switch (matchedElm.nodeName) {\n        case 'TABLE':\n          var cls = getVisualAidsTableClass(editor);\n          var value = dom.getAttrib(matchedElm, 'border');\n          if ((!value || value === '0') && editor.hasVisual) {\n            dom.addClass(matchedElm, cls);\n          } else {\n            dom.removeClass(matchedElm, cls);\n          }\n          break;\n        case 'A':\n          if (!dom.getAttrib(matchedElm, 'href')) {\n            var value_1 = dom.getAttrib(matchedElm, 'name') || matchedElm.id;\n            var cls_1 = getVisualAidsAnchorClass(editor);\n            if (value_1 && editor.hasVisual) {\n              dom.addClass(matchedElm, cls_1);\n            } else {\n              dom.removeClass(matchedElm, cls_1);\n            }\n          }\n          break;\n        }\n      });\n      editor.fire('VisualAid', {\n        element: elm,\n        hasVisual: editor.hasVisual\n      });\n    };\n\n    var makePlainAdaptor = function (editor) {\n      return {\n        undoManager: {\n          beforeChange: function (locks, beforeBookmark) {\n            return beforeChange(editor, locks, beforeBookmark);\n          },\n          addUndoLevel: function (undoManager, index, locks, beforeBookmark, level, event) {\n            return addUndoLevel(editor, undoManager, index, locks, beforeBookmark, level, event);\n          },\n          undo: function (undoManager, locks, index) {\n            return undo(editor, undoManager, locks, index);\n          },\n          redo: function (index, data) {\n            return redo(editor, index, data);\n          },\n          clear: function (undoManager, index) {\n            return clear(editor, undoManager, index);\n          },\n          reset: function (undoManager) {\n            return reset(undoManager);\n          },\n          hasUndo: function (undoManager, index) {\n            return hasUndo(editor, undoManager, index);\n          },\n          hasRedo: function (undoManager, index) {\n            return hasRedo(undoManager, index);\n          },\n          transact: function (undoManager, locks, callback) {\n            return transact(undoManager, locks, callback);\n          },\n          ignore: function (locks, callback) {\n            return ignore(locks, callback);\n          },\n          extra: function (undoManager, index, callback1, callback2) {\n            return extra(editor, undoManager, index, callback1, callback2);\n          }\n        },\n        formatter: {\n          match: function (name, vars, node) {\n            return match(editor, name, vars, node);\n          },\n          matchAll: function (names, vars) {\n            return matchAll(editor, names, vars);\n          },\n          matchNode: function (node, name, vars, similar) {\n            return matchNode(editor, node, name, vars, similar);\n          },\n          canApply: function (name) {\n            return canApply(editor, name);\n          },\n          closest: function (names) {\n            return closest$3(editor, names);\n          },\n          apply: function (name, vars, node) {\n            return applyFormat(editor, name, vars, node);\n          },\n          remove: function (name, vars, node, similar) {\n            return remove$6(editor, name, vars, node, similar);\n          },\n          toggle: function (name, vars, node) {\n            return toggle(editor, name, vars, node);\n          },\n          formatChanged: function (registeredFormatListeners, formats, callback, similar) {\n            return formatChangedInternal(editor, registeredFormatListeners, formats, callback, similar);\n          }\n        },\n        editor: {\n          getContent: function (args, format) {\n            return getContentInternal(editor, args, format);\n          },\n          setContent: function (content, args) {\n            return setContentInternal(editor, content, args);\n          },\n          insertContent: function (value, details) {\n            return insertHtmlAtCaret(editor, value, details);\n          },\n          addVisual: function (elm) {\n            return addVisualInternal(editor, elm);\n          }\n        },\n        selection: {\n          getContent: function (format, args) {\n            return getSelectedContentInternal(editor, format, args);\n          }\n        },\n        raw: {\n          getModel: function () {\n            return Optional.none();\n          }\n        }\n      };\n    };\n    var makeRtcAdaptor = function (rtcEditor) {\n      var defaultVars = function (vars) {\n        return isObject(vars) ? vars : {};\n      };\n      var unsupported = die('Unimplemented feature for rtc');\n      var undoManager = rtcEditor.undoManager, formatter = rtcEditor.formatter, editor = rtcEditor.editor, selection = rtcEditor.selection, raw = rtcEditor.raw;\n      var ignore = noop;\n      return {\n        undoManager: {\n          beforeChange: ignore,\n          addUndoLevel: unsupported,\n          undo: function () {\n            return undoManager.undo();\n          },\n          redo: function () {\n            return undoManager.redo();\n          },\n          clear: function () {\n            return undoManager.clear();\n          },\n          reset: function () {\n            return undoManager.reset();\n          },\n          hasUndo: function () {\n            return undoManager.hasUndo();\n          },\n          hasRedo: function () {\n            return undoManager.hasRedo();\n          },\n          transact: function (_undoManager, _locks, fn) {\n            return undoManager.transact(fn);\n          },\n          ignore: function (_locks, callback) {\n            return undoManager.ignore(callback);\n          },\n          extra: function (_undoManager, _index, callback1, callback2) {\n            return undoManager.extra(callback1, callback2);\n          }\n        },\n        formatter: {\n          match: function (name, vars, _node) {\n            return formatter.match(name, defaultVars(vars));\n          },\n          matchAll: unsupported,\n          matchNode: unsupported,\n          canApply: function (name) {\n            return formatter.canApply(name);\n          },\n          closest: function (names) {\n            return formatter.closest(names);\n          },\n          apply: function (name, vars, _node) {\n            return formatter.apply(name, defaultVars(vars));\n          },\n          remove: function (name, vars, _node, _similar) {\n            return formatter.remove(name, defaultVars(vars));\n          },\n          toggle: function (name, vars, _node) {\n            return formatter.toggle(name, defaultVars(vars));\n          },\n          formatChanged: function (_rfl, formats, callback, similar) {\n            return formatter.formatChanged(formats, callback, similar);\n          }\n        },\n        editor: {\n          getContent: function (args, _format) {\n            return editor.getContent(args);\n          },\n          setContent: function (content, args) {\n            return editor.setContent(content, args);\n          },\n          insertContent: function (content, _details) {\n            return editor.insertContent(content);\n          },\n          addVisual: ignore\n        },\n        selection: {\n          getContent: function (_format, args) {\n            return selection.getContent(args);\n          }\n        },\n        raw: {\n          getModel: function () {\n            return Optional.some(raw.getRawModel());\n          }\n        }\n      };\n    };\n    var makeNoopAdaptor = function () {\n      var nul = constant(null);\n      var empty = constant('');\n      return {\n        undoManager: {\n          beforeChange: noop,\n          addUndoLevel: nul,\n          undo: nul,\n          redo: nul,\n          clear: noop,\n          reset: noop,\n          hasUndo: never,\n          hasRedo: never,\n          transact: nul,\n          ignore: noop,\n          extra: noop\n        },\n        formatter: {\n          match: never,\n          matchAll: constant([]),\n          matchNode: never,\n          canApply: never,\n          closest: empty,\n          apply: noop,\n          remove: noop,\n          toggle: noop,\n          formatChanged: constant({ unbind: noop })\n        },\n        editor: {\n          getContent: empty,\n          setContent: empty,\n          insertContent: noop,\n          addVisual: noop\n        },\n        selection: { getContent: empty },\n        raw: { getModel: constant(Optional.none()) }\n      };\n    };\n    var isRtc = function (editor) {\n      return has(editor.plugins, 'rtc');\n    };\n    var getRtcSetup = function (editor) {\n      return get$1(editor.plugins, 'rtc').bind(function (rtcPlugin) {\n        return Optional.from(rtcPlugin.setup);\n      });\n    };\n    var setup$5 = function (editor) {\n      var editorCast = editor;\n      return getRtcSetup(editor).fold(function () {\n        editorCast.rtcInstance = makePlainAdaptor(editor);\n        return Optional.none();\n      }, function (setup) {\n        return Optional.some(setup().then(function (rtcEditor) {\n          editorCast.rtcInstance = makeRtcAdaptor(rtcEditor);\n          return rtcEditor.rtc.isRemote;\n        }, function (err) {\n          editorCast.rtcInstance = makeNoopAdaptor();\n          return promiseObj.reject(err);\n        }));\n      });\n    };\n    var getRtcInstanceWithFallback = function (editor) {\n      return editor.rtcInstance ? editor.rtcInstance : makePlainAdaptor(editor);\n    };\n    var getRtcInstanceWithError = function (editor) {\n      var rtcInstance = editor.rtcInstance;\n      if (!rtcInstance) {\n        throw new Error('Failed to get RTC instance not yet initialized.');\n      } else {\n        return rtcInstance;\n      }\n    };\n    var beforeChange$1 = function (editor, locks, beforeBookmark) {\n      getRtcInstanceWithError(editor).undoManager.beforeChange(locks, beforeBookmark);\n    };\n    var addUndoLevel$1 = function (editor, undoManager, index, locks, beforeBookmark, level, event) {\n      return getRtcInstanceWithError(editor).undoManager.addUndoLevel(undoManager, index, locks, beforeBookmark, level, event);\n    };\n    var undo$1 = function (editor, undoManager, locks, index) {\n      return getRtcInstanceWithError(editor).undoManager.undo(undoManager, locks, index);\n    };\n    var redo$1 = function (editor, index, data) {\n      return getRtcInstanceWithError(editor).undoManager.redo(index, data);\n    };\n    var clear$1 = function (editor, undoManager, index) {\n      getRtcInstanceWithError(editor).undoManager.clear(undoManager, index);\n    };\n    var reset$1 = function (editor, undoManager) {\n      getRtcInstanceWithError(editor).undoManager.reset(undoManager);\n    };\n    var hasUndo$1 = function (editor, undoManager, index) {\n      return getRtcInstanceWithError(editor).undoManager.hasUndo(undoManager, index);\n    };\n    var hasRedo$1 = function (editor, undoManager, index) {\n      return getRtcInstanceWithError(editor).undoManager.hasRedo(undoManager, index);\n    };\n    var transact$1 = function (editor, undoManager, locks, callback) {\n      return getRtcInstanceWithError(editor).undoManager.transact(undoManager, locks, callback);\n    };\n    var ignore$1 = function (editor, locks, callback) {\n      getRtcInstanceWithError(editor).undoManager.ignore(locks, callback);\n    };\n    var extra$1 = function (editor, undoManager, index, callback1, callback2) {\n      getRtcInstanceWithError(editor).undoManager.extra(undoManager, index, callback1, callback2);\n    };\n    var matchFormat = function (editor, name, vars, node) {\n      return getRtcInstanceWithError(editor).formatter.match(name, vars, node);\n    };\n    var matchAllFormats = function (editor, names, vars) {\n      return getRtcInstanceWithError(editor).formatter.matchAll(names, vars);\n    };\n    var matchNodeFormat = function (editor, node, name, vars, similar) {\n      return getRtcInstanceWithError(editor).formatter.matchNode(node, name, vars, similar);\n    };\n    var canApplyFormat = function (editor, name) {\n      return getRtcInstanceWithError(editor).formatter.canApply(name);\n    };\n    var closestFormat = function (editor, names) {\n      return getRtcInstanceWithError(editor).formatter.closest(names);\n    };\n    var applyFormat$1 = function (editor, name, vars, node) {\n      getRtcInstanceWithError(editor).formatter.apply(name, vars, node);\n    };\n    var removeFormat$1 = function (editor, name, vars, node, similar) {\n      getRtcInstanceWithError(editor).formatter.remove(name, vars, node, similar);\n    };\n    var toggleFormat = function (editor, name, vars, node) {\n      getRtcInstanceWithError(editor).formatter.toggle(name, vars, node);\n    };\n    var formatChanged = function (editor, registeredFormatListeners, formats, callback, similar) {\n      if (similar === void 0) {\n        similar = false;\n      }\n      return getRtcInstanceWithError(editor).formatter.formatChanged(registeredFormatListeners, formats, callback, similar);\n    };\n    var getContent = function (editor, args, format) {\n      return getRtcInstanceWithFallback(editor).editor.getContent(args, format);\n    };\n    var setContent = function (editor, content, args) {\n      return getRtcInstanceWithFallback(editor).editor.setContent(content, args);\n    };\n    var insertContent = function (editor, value, details) {\n      return getRtcInstanceWithFallback(editor).editor.insertContent(value, details);\n    };\n    var getSelectedContent = function (editor, format, args) {\n      return getRtcInstanceWithError(editor).selection.getContent(format, args);\n    };\n    var addVisual = function (editor, elm) {\n      return getRtcInstanceWithError(editor).editor.addVisual(elm);\n    };\n\n    var getContent$1 = function (editor, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      var format = args.format ? args.format : 'html';\n      return getSelectedContent(editor, format, args);\n    };\n\n    var removeEmpty = function (text) {\n      if (text.dom.length === 0) {\n        remove(text);\n        return Optional.none();\n      } else {\n        return Optional.some(text);\n      }\n    };\n    var walkPastBookmark = function (node, start) {\n      return node.filter(function (elm) {\n        return BookmarkManager.isBookmarkNode(elm.dom);\n      }).bind(start ? nextSibling : prevSibling);\n    };\n    var merge = function (outer, inner, rng, start) {\n      var outerElm = outer.dom;\n      var innerElm = inner.dom;\n      var oldLength = start ? outerElm.length : innerElm.length;\n      if (start) {\n        mergeTextNodes(outerElm, innerElm, false, !start);\n        rng.setStart(innerElm, oldLength);\n      } else {\n        mergeTextNodes(innerElm, outerElm, false, !start);\n        rng.setEnd(innerElm, oldLength);\n      }\n    };\n    var normalizeTextIfRequired = function (inner, start) {\n      parent(inner).each(function (root) {\n        var text = inner.dom;\n        if (start && needsToBeNbspLeft(root, CaretPosition(text, 0))) {\n          normalizeWhitespaceAfter(text, 0);\n        } else if (!start && needsToBeNbspRight(root, CaretPosition(text, text.length))) {\n          normalizeWhitespaceBefore(text, text.length);\n        }\n      });\n    };\n    var mergeAndNormalizeText = function (outerNode, innerNode, rng, start) {\n      outerNode.bind(function (outer) {\n        var normalizer = start ? normalizeWhitespaceBefore : normalizeWhitespaceAfter;\n        normalizer(outer.dom, start ? outer.dom.length : 0);\n        return innerNode.filter(isText).map(function (inner) {\n          return merge(outer, inner, rng, start);\n        });\n      }).orThunk(function () {\n        var innerTextNode = walkPastBookmark(innerNode, start).or(innerNode).filter(isText);\n        return innerTextNode.map(function (inner) {\n          return normalizeTextIfRequired(inner, start);\n        });\n      });\n    };\n    var rngSetContent = function (rng, fragment) {\n      var firstChild = Optional.from(fragment.firstChild).map(SugarElement.fromDom);\n      var lastChild = Optional.from(fragment.lastChild).map(SugarElement.fromDom);\n      rng.deleteContents();\n      rng.insertNode(fragment);\n      var prevText = firstChild.bind(prevSibling).filter(isText).bind(removeEmpty);\n      var nextText = lastChild.bind(nextSibling).filter(isText).bind(removeEmpty);\n      mergeAndNormalizeText(prevText, firstChild, rng, true);\n      mergeAndNormalizeText(nextText, lastChild, rng, false);\n      rng.collapse(false);\n    };\n    var setupArgs = function (args, content) {\n      return __assign(__assign({ format: 'html' }, args), {\n        set: true,\n        selection: true,\n        content: content\n      });\n    };\n    var cleanContent = function (editor, args) {\n      if (args.format !== 'raw') {\n        var rng = editor.selection.getRng();\n        var contextBlock = editor.dom.getParent(rng.commonAncestorContainer, editor.dom.isBlock);\n        var contextArgs = contextBlock ? { context: contextBlock.nodeName.toLowerCase() } : {};\n        var node = editor.parser.parse(args.content, __assign(__assign({\n          isRootContent: true,\n          forced_root_block: false\n        }, contextArgs), args));\n        return HtmlSerializer({ validate: editor.validate }, editor.schema).serialize(node);\n      } else {\n        return args.content;\n      }\n    };\n    var setContent$1 = function (editor, content, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      var contentArgs = setupArgs(args, content);\n      if (!contentArgs.no_events) {\n        contentArgs = editor.fire('BeforeSetContent', contentArgs);\n        if (contentArgs.isDefaultPrevented()) {\n          editor.fire('SetContent', contentArgs);\n          return;\n        }\n      }\n      args.content = cleanContent(editor, contentArgs);\n      var rng = editor.selection.getRng();\n      rngSetContent(rng, rng.createContextualFragment(args.content));\n      editor.selection.setRng(rng);\n      scrollRangeIntoView(editor, rng);\n      if (!contentArgs.no_events) {\n        editor.fire('SetContent', contentArgs);\n      }\n    };\n\n    var deleteFromCallbackMap = function (callbackMap, selector, callback) {\n      if (callbackMap && callbackMap.hasOwnProperty(selector)) {\n        var newCallbacks = filter(callbackMap[selector], function (cb) {\n          return cb !== callback;\n        });\n        if (newCallbacks.length === 0) {\n          delete callbackMap[selector];\n        } else {\n          callbackMap[selector] = newCallbacks;\n        }\n      }\n    };\n    function SelectorChanged (dom, editor) {\n      var selectorChangedData;\n      var currentSelectors;\n      return {\n        selectorChangedWithUnbind: function (selector, callback) {\n          if (!selectorChangedData) {\n            selectorChangedData = {};\n            currentSelectors = {};\n            editor.on('NodeChange', function (e) {\n              var node = e.element, parents = dom.getParents(node, null, dom.getRoot()), matchedSelectors = {};\n              Tools.each(selectorChangedData, function (callbacks, selector) {\n                Tools.each(parents, function (node) {\n                  if (dom.is(node, selector)) {\n                    if (!currentSelectors[selector]) {\n                      Tools.each(callbacks, function (callback) {\n                        callback(true, {\n                          node: node,\n                          selector: selector,\n                          parents: parents\n                        });\n                      });\n                      currentSelectors[selector] = callbacks;\n                    }\n                    matchedSelectors[selector] = callbacks;\n                    return false;\n                  }\n                });\n              });\n              Tools.each(currentSelectors, function (callbacks, selector) {\n                if (!matchedSelectors[selector]) {\n                  delete currentSelectors[selector];\n                  Tools.each(callbacks, function (callback) {\n                    callback(false, {\n                      node: node,\n                      selector: selector,\n                      parents: parents\n                    });\n                  });\n                }\n              });\n            });\n          }\n          if (!selectorChangedData[selector]) {\n            selectorChangedData[selector] = [];\n          }\n          selectorChangedData[selector].push(callback);\n          return {\n            unbind: function () {\n              deleteFromCallbackMap(selectorChangedData, selector, callback);\n              deleteFromCallbackMap(currentSelectors, selector, callback);\n            }\n          };\n        }\n      };\n    }\n\n    var isNativeIeSelection = function (rng) {\n      return !!rng.select;\n    };\n    var isAttachedToDom = function (node) {\n      return !!(node && node.ownerDocument) && contains$2(SugarElement.fromDom(node.ownerDocument), SugarElement.fromDom(node));\n    };\n    var isValidRange = function (rng) {\n      if (!rng) {\n        return false;\n      } else if (isNativeIeSelection(rng)) {\n        return true;\n      } else {\n        return isAttachedToDom(rng.startContainer) && isAttachedToDom(rng.endContainer);\n      }\n    };\n    var EditorSelection = function (dom, win, serializer, editor) {\n      var selectedRange;\n      var explicitRange;\n      var selectorChangedWithUnbind = SelectorChanged(dom, editor).selectorChangedWithUnbind;\n      var setCursorLocation = function (node, offset) {\n        var rng = dom.createRng();\n        if (isNonNullable(node) && isNonNullable(offset)) {\n          rng.setStart(node, offset);\n          rng.setEnd(node, offset);\n          setRng(rng);\n          collapse(false);\n        } else {\n          moveEndPoint$1(dom, rng, editor.getBody(), true);\n          setRng(rng);\n        }\n      };\n      var getContent = function (args) {\n        return getContent$1(editor, args);\n      };\n      var setContent = function (content, args) {\n        return setContent$1(editor, content, args);\n      };\n      var getStart = function (real) {\n        return getStart$2(editor.getBody(), getRng$1(), real);\n      };\n      var getEnd$1 = function (real) {\n        return getEnd(editor.getBody(), getRng$1(), real);\n      };\n      var getBookmark = function (type, normalized) {\n        return bookmarkManager.getBookmark(type, normalized);\n      };\n      var moveToBookmark = function (bookmark) {\n        return bookmarkManager.moveToBookmark(bookmark);\n      };\n      var select = function (node, content) {\n        select$1(dom, node, content).each(setRng);\n        return node;\n      };\n      var isCollapsed = function () {\n        var rng = getRng$1(), sel = getSel();\n        if (!rng || rng.item) {\n          return false;\n        }\n        if (rng.compareEndPoints) {\n          return rng.compareEndPoints('StartToEnd', rng) === 0;\n        }\n        return !sel || rng.collapsed;\n      };\n      var collapse = function (toStart) {\n        var rng = getRng$1();\n        rng.collapse(!!toStart);\n        setRng(rng);\n      };\n      var getSel = function () {\n        return win.getSelection ? win.getSelection() : win.document.selection;\n      };\n      var getRng$1 = function () {\n        var selection, rng, elm;\n        var tryCompareBoundaryPoints = function (how, sourceRange, destinationRange) {\n          try {\n            return sourceRange.compareBoundaryPoints(how, destinationRange);\n          } catch (ex) {\n            return -1;\n          }\n        };\n        var doc = win.document;\n        if (editor.bookmark !== undefined && hasFocus$1(editor) === false) {\n          var bookmark = getRng(editor);\n          if (bookmark.isSome()) {\n            return bookmark.map(function (r) {\n              return processRanges(editor, [r])[0];\n            }).getOr(doc.createRange());\n          }\n        }\n        try {\n          if ((selection = getSel()) && !isRestrictedNode(selection.anchorNode)) {\n            if (selection.rangeCount > 0) {\n              rng = selection.getRangeAt(0);\n            } else {\n              rng = selection.createRange ? selection.createRange() : doc.createRange();\n            }\n            rng = processRanges(editor, [rng])[0];\n          }\n        } catch (ex) {\n        }\n        if (!rng) {\n          rng = doc.createRange ? doc.createRange() : doc.body.createTextRange();\n        }\n        if (rng.setStart && rng.startContainer.nodeType === 9 && rng.collapsed) {\n          elm = dom.getRoot();\n          rng.setStart(elm, 0);\n          rng.setEnd(elm, 0);\n        }\n        if (selectedRange && explicitRange) {\n          if (tryCompareBoundaryPoints(rng.START_TO_START, rng, selectedRange) === 0 && tryCompareBoundaryPoints(rng.END_TO_END, rng, selectedRange) === 0) {\n            rng = explicitRange;\n          } else {\n            selectedRange = null;\n            explicitRange = null;\n          }\n        }\n        return rng;\n      };\n      var setRng = function (rng, forward) {\n        var node;\n        if (!isValidRange(rng)) {\n          return;\n        }\n        var ieRange = isNativeIeSelection(rng) ? rng : null;\n        if (ieRange) {\n          explicitRange = null;\n          try {\n            ieRange.select();\n          } catch (ex) {\n          }\n          return;\n        }\n        var sel = getSel();\n        var evt = editor.fire('SetSelectionRange', {\n          range: rng,\n          forward: forward\n        });\n        rng = evt.range;\n        if (sel) {\n          explicitRange = rng;\n          try {\n            sel.removeAllRanges();\n            sel.addRange(rng);\n          } catch (ex) {\n          }\n          if (forward === false && sel.extend) {\n            sel.collapse(rng.endContainer, rng.endOffset);\n            sel.extend(rng.startContainer, rng.startOffset);\n          }\n          selectedRange = sel.rangeCount > 0 ? sel.getRangeAt(0) : null;\n        }\n        if (!rng.collapsed && rng.startContainer === rng.endContainer && sel.setBaseAndExtent && !Env.ie) {\n          if (rng.endOffset - rng.startOffset < 2) {\n            if (rng.startContainer.hasChildNodes()) {\n              node = rng.startContainer.childNodes[rng.startOffset];\n              if (node && node.tagName === 'IMG') {\n                sel.setBaseAndExtent(rng.startContainer, rng.startOffset, rng.endContainer, rng.endOffset);\n                if (sel.anchorNode !== rng.startContainer || sel.focusNode !== rng.endContainer) {\n                  sel.setBaseAndExtent(node, 0, node, 1);\n                }\n              }\n            }\n          }\n        }\n        editor.fire('AfterSetSelectionRange', {\n          range: rng,\n          forward: forward\n        });\n      };\n      var setNode = function (elm) {\n        setContent(dom.getOuterHTML(elm));\n        return elm;\n      };\n      var getNode = function () {\n        return getNode$1(editor.getBody(), getRng$1());\n      };\n      var getSelectedBlocks$1 = function (startElm, endElm) {\n        return getSelectedBlocks(dom, getRng$1(), startElm, endElm);\n      };\n      var isForward = function () {\n        var sel = getSel();\n        var anchorNode = sel === null || sel === void 0 ? void 0 : sel.anchorNode;\n        var focusNode = sel === null || sel === void 0 ? void 0 : sel.focusNode;\n        if (!sel || !anchorNode || !focusNode || isRestrictedNode(anchorNode) || isRestrictedNode(focusNode)) {\n          return true;\n        }\n        var anchorRange = dom.createRng();\n        anchorRange.setStart(anchorNode, sel.anchorOffset);\n        anchorRange.collapse(true);\n        var focusRange = dom.createRng();\n        focusRange.setStart(focusNode, sel.focusOffset);\n        focusRange.collapse(true);\n        return anchorRange.compareBoundaryPoints(anchorRange.START_TO_START, focusRange) <= 0;\n      };\n      var normalize$1 = function () {\n        var rng = getRng$1();\n        var sel = getSel();\n        if (!hasMultipleRanges(sel) && hasAnyRanges(editor)) {\n          var normRng = normalize(dom, rng);\n          normRng.each(function (normRng) {\n            setRng(normRng, isForward());\n          });\n          return normRng.getOr(rng);\n        }\n        return rng;\n      };\n      var selectorChanged = function (selector, callback) {\n        selectorChangedWithUnbind(selector, callback);\n        return exports;\n      };\n      var getScrollContainer = function () {\n        var scrollContainer;\n        var node = dom.getRoot();\n        while (node && node.nodeName !== 'BODY') {\n          if (node.scrollHeight > node.clientHeight) {\n            scrollContainer = node;\n            break;\n          }\n          node = node.parentNode;\n        }\n        return scrollContainer;\n      };\n      var scrollIntoView = function (elm, alignToTop) {\n        return scrollElementIntoView(editor, elm, alignToTop);\n      };\n      var placeCaretAt = function (clientX, clientY) {\n        return setRng(fromPoint$1(clientX, clientY, editor.getDoc()));\n      };\n      var getBoundingClientRect = function () {\n        var rng = getRng$1();\n        return rng.collapsed ? CaretPosition.fromRangeStart(rng).getClientRects()[0] : rng.getBoundingClientRect();\n      };\n      var destroy = function () {\n        win = selectedRange = explicitRange = null;\n        controlSelection.destroy();\n      };\n      var exports = {\n        bookmarkManager: null,\n        controlSelection: null,\n        dom: dom,\n        win: win,\n        serializer: serializer,\n        editor: editor,\n        collapse: collapse,\n        setCursorLocation: setCursorLocation,\n        getContent: getContent,\n        setContent: setContent,\n        getBookmark: getBookmark,\n        moveToBookmark: moveToBookmark,\n        select: select,\n        isCollapsed: isCollapsed,\n        isForward: isForward,\n        setNode: setNode,\n        getNode: getNode,\n        getSel: getSel,\n        setRng: setRng,\n        getRng: getRng$1,\n        getStart: getStart,\n        getEnd: getEnd$1,\n        getSelectedBlocks: getSelectedBlocks$1,\n        normalize: normalize$1,\n        selectorChanged: selectorChanged,\n        selectorChangedWithUnbind: selectorChangedWithUnbind,\n        getScrollContainer: getScrollContainer,\n        scrollIntoView: scrollIntoView,\n        placeCaretAt: placeCaretAt,\n        getBoundingClientRect: getBoundingClientRect,\n        destroy: destroy\n      };\n      var bookmarkManager = BookmarkManager(exports);\n      var controlSelection = ControlSelection(exports, editor);\n      exports.bookmarkManager = bookmarkManager;\n      exports.controlSelection = controlSelection;\n      return exports;\n    };\n\n    var removeAttrs = function (node, names) {\n      each(names, function (name) {\n        node.attr(name, null);\n      });\n    };\n    var addFontToSpansFilter = function (domParser, styles, fontSizes) {\n      domParser.addNodeFilter('font', function (nodes) {\n        each(nodes, function (node) {\n          var props = styles.parse(node.attr('style'));\n          var color = node.attr('color');\n          var face = node.attr('face');\n          var size = node.attr('size');\n          if (color) {\n            props.color = color;\n          }\n          if (face) {\n            props['font-family'] = face;\n          }\n          if (size) {\n            props['font-size'] = fontSizes[parseInt(node.attr('size'), 10) - 1];\n          }\n          node.name = 'span';\n          node.attr('style', styles.serialize(props));\n          removeAttrs(node, [\n            'color',\n            'face',\n            'size'\n          ]);\n        });\n      });\n    };\n    var addStrikeToSpanFilter = function (domParser, styles) {\n      domParser.addNodeFilter('strike', function (nodes) {\n        each(nodes, function (node) {\n          var props = styles.parse(node.attr('style'));\n          props['text-decoration'] = 'line-through';\n          node.name = 'span';\n          node.attr('style', styles.serialize(props));\n        });\n      });\n    };\n    var addFilters = function (domParser, settings) {\n      var styles = Styles();\n      if (settings.convert_fonts_to_spans) {\n        addFontToSpansFilter(domParser, styles, Tools.explode(settings.font_size_legacy_values));\n      }\n      addStrikeToSpanFilter(domParser, styles);\n    };\n    var register$1 = function (domParser, settings) {\n      if (settings.inline_styles) {\n        addFilters(domParser, settings);\n      }\n    };\n\n    var blobUriToBlob = function (url) {\n      return new promiseObj(function (resolve, reject) {\n        var rejectWithError = function () {\n          reject('Cannot convert ' + url + ' to Blob. Resource might not exist or is inaccessible.');\n        };\n        try {\n          var xhr_1 = new XMLHttpRequest();\n          xhr_1.open('GET', url, true);\n          xhr_1.responseType = 'blob';\n          xhr_1.onload = function () {\n            if (xhr_1.status === 200) {\n              resolve(xhr_1.response);\n            } else {\n              rejectWithError();\n            }\n          };\n          xhr_1.onerror = rejectWithError;\n          xhr_1.send();\n        } catch (ex) {\n          rejectWithError();\n        }\n      });\n    };\n    var parseDataUri$1 = function (uri) {\n      var type;\n      var uriParts = decodeURIComponent(uri).split(',');\n      var matches = /data:([^;]+)/.exec(uriParts[0]);\n      if (matches) {\n        type = matches[1];\n      }\n      return {\n        type: type,\n        data: uriParts[1]\n      };\n    };\n    var buildBlob = function (type, data) {\n      var str;\n      try {\n        str = atob(data);\n      } catch (e) {\n        return Optional.none();\n      }\n      var arr = new Uint8Array(str.length);\n      for (var i = 0; i < arr.length; i++) {\n        arr[i] = str.charCodeAt(i);\n      }\n      return Optional.some(new Blob([arr], { type: type }));\n    };\n    var dataUriToBlob = function (uri) {\n      return new promiseObj(function (resolve) {\n        var _a = parseDataUri$1(uri), type = _a.type, data = _a.data;\n        buildBlob(type, data).fold(function () {\n          return resolve(new Blob([]));\n        }, resolve);\n      });\n    };\n    var uriToBlob = function (url) {\n      if (url.indexOf('blob:') === 0) {\n        return blobUriToBlob(url);\n      }\n      if (url.indexOf('data:') === 0) {\n        return dataUriToBlob(url);\n      }\n      return null;\n    };\n    var blobToDataUri = function (blob) {\n      return new promiseObj(function (resolve) {\n        var reader = new FileReader();\n        reader.onloadend = function () {\n          resolve(reader.result);\n        };\n        reader.readAsDataURL(blob);\n      });\n    };\n\n    var count = 0;\n    var uniqueId = function (prefix) {\n      return (prefix || 'blobid') + count++;\n    };\n    var imageToBlobInfo = function (blobCache, img, resolve, reject) {\n      var base64, blobInfo;\n      if (img.src.indexOf('blob:') === 0) {\n        blobInfo = blobCache.getByUri(img.src);\n        if (blobInfo) {\n          resolve({\n            image: img,\n            blobInfo: blobInfo\n          });\n        } else {\n          uriToBlob(img.src).then(function (blob) {\n            blobToDataUri(blob).then(function (dataUri) {\n              base64 = parseDataUri$1(dataUri).data;\n              blobInfo = blobCache.create(uniqueId(), blob, base64);\n              blobCache.add(blobInfo);\n              resolve({\n                image: img,\n                blobInfo: blobInfo\n              });\n            });\n          }, function (err) {\n            reject(err);\n          });\n        }\n        return;\n      }\n      var _a = parseDataUri$1(img.src), data = _a.data, type = _a.type;\n      base64 = data;\n      blobInfo = blobCache.getByData(base64, type);\n      if (blobInfo) {\n        resolve({\n          image: img,\n          blobInfo: blobInfo\n        });\n      } else {\n        uriToBlob(img.src).then(function (blob) {\n          blobInfo = blobCache.create(uniqueId(), blob, base64);\n          blobCache.add(blobInfo);\n          resolve({\n            image: img,\n            blobInfo: blobInfo\n          });\n        }, function (err) {\n          reject(err);\n        });\n      }\n    };\n    var getAllImages = function (elm) {\n      return elm ? from$1(elm.getElementsByTagName('img')) : [];\n    };\n    var ImageScanner = function (uploadStatus, blobCache) {\n      var cachedPromises = {};\n      var findAll = function (elm, predicate) {\n        if (!predicate) {\n          predicate = always;\n        }\n        var images = filter(getAllImages(elm), function (img) {\n          var src = img.src;\n          if (!Env.fileApi) {\n            return false;\n          }\n          if (img.hasAttribute('data-mce-bogus')) {\n            return false;\n          }\n          if (img.hasAttribute('data-mce-placeholder')) {\n            return false;\n          }\n          if (!src || src === Env.transparentSrc) {\n            return false;\n          }\n          if (src.indexOf('blob:') === 0) {\n            return !uploadStatus.isUploaded(src) && predicate(img);\n          }\n          if (src.indexOf('data:') === 0) {\n            return predicate(img);\n          }\n          return false;\n        });\n        var promises = map(images, function (img) {\n          if (cachedPromises[img.src] !== undefined) {\n            return new promiseObj(function (resolve) {\n              cachedPromises[img.src].then(function (imageInfo) {\n                if (typeof imageInfo === 'string') {\n                  return imageInfo;\n                }\n                resolve({\n                  image: img,\n                  blobInfo: imageInfo.blobInfo\n                });\n              });\n            });\n          }\n          var newPromise = new promiseObj(function (resolve, reject) {\n            imageToBlobInfo(blobCache, img, resolve, reject);\n          }).then(function (result) {\n            delete cachedPromises[result.image.src];\n            return result;\n          }).catch(function (error) {\n            delete cachedPromises[img.src];\n            return error;\n          });\n          cachedPromises[img.src] = newPromise;\n          return newPromise;\n        });\n        return promiseObj.all(promises);\n      };\n      return { findAll: findAll };\n    };\n\n    var paddEmptyNode = function (settings, args, blockElements, node) {\n      var brPreferred = settings.padd_empty_with_br || args.insert;\n      if (brPreferred && blockElements[node.name]) {\n        node.empty().append(new AstNode('br', 1)).shortEnded = true;\n      } else {\n        node.empty().append(new AstNode('#text', 3)).value = nbsp;\n      }\n    };\n    var isPaddedWithNbsp = function (node) {\n      return hasOnlyChild(node, '#text') && node.firstChild.value === nbsp;\n    };\n    var hasOnlyChild = function (node, name) {\n      return node && node.firstChild && node.firstChild === node.lastChild && node.firstChild.name === name;\n    };\n    var isPadded = function (schema, node) {\n      var rule = schema.getElementRule(node.name);\n      return rule && rule.paddEmpty;\n    };\n    var isEmpty$2 = function (schema, nonEmptyElements, whitespaceElements, node) {\n      return node.isEmpty(nonEmptyElements, whitespaceElements, function (node) {\n        return isPadded(schema, node);\n      });\n    };\n    var isLineBreakNode = function (node, blockElements) {\n      return node && (blockElements[node.name] || node.name === 'br');\n    };\n\n    var isBogusImage = function (img) {\n      return img.attr('data-mce-bogus');\n    };\n    var isInternalImageSource = function (img) {\n      return img.attr('src') === Env.transparentSrc || img.attr('data-mce-placeholder');\n    };\n    var isValidDataImg = function (img, settings) {\n      if (settings.images_dataimg_filter) {\n        var imgElem_1 = new Image();\n        imgElem_1.src = img.attr('src');\n        each$1(img.attributes.map, function (value, key) {\n          imgElem_1.setAttribute(key, value);\n        });\n        return settings.images_dataimg_filter(imgElem_1);\n      } else {\n        return true;\n      }\n    };\n    var registerBase64ImageFilter = function (parser, settings) {\n      var blobCache = settings.blob_cache;\n      var processImage = function (img) {\n        var inputSrc = img.attr('src');\n        if (isInternalImageSource(img) || isBogusImage(img)) {\n          return;\n        }\n        parseDataUri(inputSrc).filter(function () {\n          return isValidDataImg(img, settings);\n        }).bind(function (_a) {\n          var type = _a.type, data = _a.data;\n          return Optional.from(blobCache.getByData(data, type)).orThunk(function () {\n            return buildBlob(type, data).map(function (blob) {\n              var blobInfo = blobCache.create(uniqueId(), blob, data);\n              blobCache.add(blobInfo);\n              return blobInfo;\n            });\n          });\n        }).each(function (blobInfo) {\n          img.attr('src', blobInfo.blobUri());\n        });\n      };\n      if (blobCache) {\n        parser.addAttributeFilter('src', function (nodes) {\n          return each(nodes, processImage);\n        });\n      }\n    };\n    var register$2 = function (parser, settings) {\n      var schema = parser.schema;\n      if (settings.remove_trailing_brs) {\n        parser.addNodeFilter('br', function (nodes, _, args) {\n          var i;\n          var l = nodes.length;\n          var node;\n          var blockElements = Tools.extend({}, schema.getBlockElements());\n          var nonEmptyElements = schema.getNonEmptyElements();\n          var parent, lastParent, prev, prevName;\n          var whiteSpaceElements = schema.getWhiteSpaceElements();\n          var elementRule, textNode;\n          blockElements.body = 1;\n          for (i = 0; i < l; i++) {\n            node = nodes[i];\n            parent = node.parent;\n            if (blockElements[node.parent.name] && node === parent.lastChild) {\n              prev = node.prev;\n              while (prev) {\n                prevName = prev.name;\n                if (prevName !== 'span' || prev.attr('data-mce-type') !== 'bookmark') {\n                  if (prevName === 'br') {\n                    node = null;\n                  }\n                  break;\n                }\n                prev = prev.prev;\n              }\n              if (node) {\n                node.remove();\n                if (isEmpty$2(schema, nonEmptyElements, whiteSpaceElements, parent)) {\n                  elementRule = schema.getElementRule(parent.name);\n                  if (elementRule) {\n                    if (elementRule.removeEmpty) {\n                      parent.remove();\n                    } else if (elementRule.paddEmpty) {\n                      paddEmptyNode(settings, args, blockElements, parent);\n                    }\n                  }\n                }\n              }\n            } else {\n              lastParent = node;\n              while (parent && parent.firstChild === lastParent && parent.lastChild === lastParent) {\n                lastParent = parent;\n                if (blockElements[parent.name]) {\n                  break;\n                }\n                parent = parent.parent;\n              }\n              if (lastParent === parent && settings.padd_empty_with_br !== true) {\n                textNode = new AstNode('#text', 3);\n                textNode.value = nbsp;\n                node.replace(textNode);\n              }\n            }\n          }\n        });\n      }\n      parser.addAttributeFilter('href', function (nodes) {\n        var i = nodes.length;\n        var appendRel = function (rel) {\n          var parts = rel.split(' ').filter(function (p) {\n            return p.length > 0;\n          });\n          return parts.concat(['noopener']).sort().join(' ');\n        };\n        var addNoOpener = function (rel) {\n          var newRel = rel ? Tools.trim(rel) : '';\n          if (!/\\b(noopener)\\b/g.test(newRel)) {\n            return appendRel(newRel);\n          } else {\n            return newRel;\n          }\n        };\n        if (!settings.allow_unsafe_link_target) {\n          while (i--) {\n            var node = nodes[i];\n            if (node.name === 'a' && node.attr('target') === '_blank') {\n              node.attr('rel', addNoOpener(node.attr('rel')));\n            }\n          }\n        }\n      });\n      if (!settings.allow_html_in_named_anchor) {\n        parser.addAttributeFilter('id,name', function (nodes) {\n          var i = nodes.length, sibling, prevSibling, parent, node;\n          while (i--) {\n            node = nodes[i];\n            if (node.name === 'a' && node.firstChild && !node.attr('href')) {\n              parent = node.parent;\n              sibling = node.lastChild;\n              do {\n                prevSibling = sibling.prev;\n                parent.insert(sibling, node);\n                sibling = prevSibling;\n              } while (sibling);\n            }\n          }\n        });\n      }\n      if (settings.fix_list_elements) {\n        parser.addNodeFilter('ul,ol', function (nodes) {\n          var i = nodes.length, node, parentNode;\n          while (i--) {\n            node = nodes[i];\n            parentNode = node.parent;\n            if (parentNode.name === 'ul' || parentNode.name === 'ol') {\n              if (node.prev && node.prev.name === 'li') {\n                node.prev.append(node);\n              } else {\n                var li = new AstNode('li', 1);\n                li.attr('style', 'list-style-type: none');\n                node.wrap(li);\n              }\n            }\n          }\n        });\n      }\n      if (settings.validate && schema.getValidClasses()) {\n        parser.addAttributeFilter('class', function (nodes) {\n          var i = nodes.length, node, classList, ci, className, classValue;\n          var validClasses = schema.getValidClasses();\n          var validClassesMap, valid;\n          while (i--) {\n            node = nodes[i];\n            classList = node.attr('class').split(' ');\n            classValue = '';\n            for (ci = 0; ci < classList.length; ci++) {\n              className = classList[ci];\n              valid = false;\n              validClassesMap = validClasses['*'];\n              if (validClassesMap && validClassesMap[className]) {\n                valid = true;\n              }\n              validClassesMap = validClasses[node.name];\n              if (!valid && validClassesMap && validClassesMap[className]) {\n                valid = true;\n              }\n              if (valid) {\n                if (classValue) {\n                  classValue += ' ';\n                }\n                classValue += className;\n              }\n            }\n            if (!classValue.length) {\n              classValue = null;\n            }\n            node.attr('class', classValue);\n          }\n        });\n      }\n      registerBase64ImageFilter(parser, settings);\n    };\n\n    var makeMap$4 = Tools.makeMap, each$d = Tools.each, explode$2 = Tools.explode, extend$2 = Tools.extend;\n    var DomParser = function (settings, schema) {\n      if (schema === void 0) {\n        schema = Schema();\n      }\n      var nodeFilters = {};\n      var attributeFilters = [];\n      var matchedNodes = {};\n      var matchedAttributes = {};\n      settings = settings || {};\n      settings.validate = 'validate' in settings ? settings.validate : true;\n      settings.root_name = settings.root_name || 'body';\n      var fixInvalidChildren = function (nodes) {\n        var ni, node, parent, parents, newParent, currentNode, tempNode, childNode, i;\n        var sibling, nextNode;\n        var nonSplitableElements = makeMap$4('tr,td,th,tbody,thead,tfoot,table');\n        var nonEmptyElements = schema.getNonEmptyElements();\n        var whitespaceElements = schema.getWhiteSpaceElements();\n        var textBlockElements = schema.getTextBlockElements();\n        var specialElements = schema.getSpecialElements();\n        for (ni = 0; ni < nodes.length; ni++) {\n          node = nodes[ni];\n          if (!node.parent || node.fixed) {\n            continue;\n          }\n          if (textBlockElements[node.name] && node.parent.name === 'li') {\n            sibling = node.next;\n            while (sibling) {\n              if (textBlockElements[sibling.name]) {\n                sibling.name = 'li';\n                sibling.fixed = true;\n                node.parent.insert(sibling, node.parent);\n              } else {\n                break;\n              }\n              sibling = sibling.next;\n            }\n            node.unwrap(node);\n            continue;\n          }\n          parents = [node];\n          for (parent = node.parent; parent && !schema.isValidChild(parent.name, node.name) && !nonSplitableElements[parent.name]; parent = parent.parent) {\n            parents.push(parent);\n          }\n          if (parent && parents.length > 1) {\n            parents.reverse();\n            newParent = currentNode = filterNode(parents[0].clone());\n            for (i = 0; i < parents.length - 1; i++) {\n              if (schema.isValidChild(currentNode.name, parents[i].name)) {\n                tempNode = filterNode(parents[i].clone());\n                currentNode.append(tempNode);\n              } else {\n                tempNode = currentNode;\n              }\n              for (childNode = parents[i].firstChild; childNode && childNode !== parents[i + 1];) {\n                nextNode = childNode.next;\n                tempNode.append(childNode);\n                childNode = nextNode;\n              }\n              currentNode = tempNode;\n            }\n            if (!isEmpty$2(schema, nonEmptyElements, whitespaceElements, newParent)) {\n              parent.insert(newParent, parents[0], true);\n              parent.insert(node, newParent);\n            } else {\n              parent.insert(node, parents[0], true);\n            }\n            parent = parents[0];\n            if (isEmpty$2(schema, nonEmptyElements, whitespaceElements, parent) || hasOnlyChild(parent, 'br')) {\n              parent.empty().remove();\n            }\n          } else if (node.parent) {\n            if (node.name === 'li') {\n              sibling = node.prev;\n              if (sibling && (sibling.name === 'ul' || sibling.name === 'ol')) {\n                sibling.append(node);\n                continue;\n              }\n              sibling = node.next;\n              if (sibling && (sibling.name === 'ul' || sibling.name === 'ol')) {\n                sibling.insert(node, sibling.firstChild, true);\n                continue;\n              }\n              node.wrap(filterNode(new AstNode('ul', 1)));\n              continue;\n            }\n            if (schema.isValidChild(node.parent.name, 'div') && schema.isValidChild('div', node.name)) {\n              node.wrap(filterNode(new AstNode('div', 1)));\n            } else {\n              if (specialElements[node.name]) {\n                node.empty().remove();\n              } else {\n                node.unwrap();\n              }\n            }\n          }\n        }\n      };\n      var filterNode = function (node) {\n        var i, name, list;\n        name = node.name;\n        if (name in nodeFilters) {\n          list = matchedNodes[name];\n          if (list) {\n            list.push(node);\n          } else {\n            matchedNodes[name] = [node];\n          }\n        }\n        i = attributeFilters.length;\n        while (i--) {\n          name = attributeFilters[i].name;\n          if (name in node.attributes.map) {\n            list = matchedAttributes[name];\n            if (list) {\n              list.push(node);\n            } else {\n              matchedAttributes[name] = [node];\n            }\n          }\n        }\n        return node;\n      };\n      var addNodeFilter = function (name, callback) {\n        each$d(explode$2(name), function (name) {\n          var list = nodeFilters[name];\n          if (!list) {\n            nodeFilters[name] = list = [];\n          }\n          list.push(callback);\n        });\n      };\n      var getNodeFilters = function () {\n        var out = [];\n        for (var name_1 in nodeFilters) {\n          if (nodeFilters.hasOwnProperty(name_1)) {\n            out.push({\n              name: name_1,\n              callbacks: nodeFilters[name_1]\n            });\n          }\n        }\n        return out;\n      };\n      var addAttributeFilter = function (name, callback) {\n        each$d(explode$2(name), function (name) {\n          var i;\n          for (i = 0; i < attributeFilters.length; i++) {\n            if (attributeFilters[i].name === name) {\n              attributeFilters[i].callbacks.push(callback);\n              return;\n            }\n          }\n          attributeFilters.push({\n            name: name,\n            callbacks: [callback]\n          });\n        });\n      };\n      var getAttributeFilters = function () {\n        return [].concat(attributeFilters);\n      };\n      var parse = function (html, args) {\n        var nodes, i, l, fi, fl, list, name;\n        var invalidChildren = [];\n        var isInWhiteSpacePreservedElement;\n        var node;\n        var getRootBlockName = function (name) {\n          if (name === false) {\n            return '';\n          } else if (name === true) {\n            return 'p';\n          } else {\n            return name;\n          }\n        };\n        args = args || {};\n        matchedNodes = {};\n        matchedAttributes = {};\n        var blockElements = extend$2(makeMap$4('script,style,head,html,body,title,meta,param'), schema.getBlockElements());\n        var nonEmptyElements = schema.getNonEmptyElements();\n        var children = schema.children;\n        var validate = settings.validate;\n        var forcedRootBlockName = 'forced_root_block' in args ? args.forced_root_block : settings.forced_root_block;\n        var rootBlockName = getRootBlockName(forcedRootBlockName);\n        var whiteSpaceElements = schema.getWhiteSpaceElements();\n        var startWhiteSpaceRegExp = /^[ \\t\\r\\n]+/;\n        var endWhiteSpaceRegExp = /[ \\t\\r\\n]+$/;\n        var allWhiteSpaceRegExp = /[ \\t\\r\\n]+/g;\n        var isAllWhiteSpaceRegExp = /^[ \\t\\r\\n]+$/;\n        isInWhiteSpacePreservedElement = whiteSpaceElements.hasOwnProperty(args.context) || whiteSpaceElements.hasOwnProperty(settings.root_name);\n        var addRootBlocks = function () {\n          var node = rootNode.firstChild, next, rootBlockNode;\n          var trim = function (rootBlockNode) {\n            if (rootBlockNode) {\n              node = rootBlockNode.firstChild;\n              if (node && node.type === 3) {\n                node.value = node.value.replace(startWhiteSpaceRegExp, '');\n              }\n              node = rootBlockNode.lastChild;\n              if (node && node.type === 3) {\n                node.value = node.value.replace(endWhiteSpaceRegExp, '');\n              }\n            }\n          };\n          if (!schema.isValidChild(rootNode.name, rootBlockName.toLowerCase())) {\n            return;\n          }\n          while (node) {\n            next = node.next;\n            if (node.type === 3 || node.type === 1 && node.name !== 'p' && !blockElements[node.name] && !node.attr('data-mce-type')) {\n              if (!rootBlockNode) {\n                rootBlockNode = createNode(rootBlockName, 1);\n                rootBlockNode.attr(settings.forced_root_block_attrs);\n                rootNode.insert(rootBlockNode, node);\n                rootBlockNode.append(node);\n              } else {\n                rootBlockNode.append(node);\n              }\n            } else {\n              trim(rootBlockNode);\n              rootBlockNode = null;\n            }\n            node = next;\n          }\n          trim(rootBlockNode);\n        };\n        var createNode = function (name, type) {\n          var node = new AstNode(name, type);\n          var list;\n          if (name in nodeFilters) {\n            list = matchedNodes[name];\n            if (list) {\n              list.push(node);\n            } else {\n              matchedNodes[name] = [node];\n            }\n          }\n          return node;\n        };\n        var removeWhitespaceBefore = function (node) {\n          var textNode, textNodeNext, textVal, sibling;\n          var blockElements = schema.getBlockElements();\n          for (textNode = node.prev; textNode && textNode.type === 3;) {\n            textVal = textNode.value.replace(endWhiteSpaceRegExp, '');\n            if (textVal.length > 0) {\n              textNode.value = textVal;\n              return;\n            }\n            textNodeNext = textNode.next;\n            if (textNodeNext) {\n              if (textNodeNext.type === 3 && textNodeNext.value.length) {\n                textNode = textNode.prev;\n                continue;\n              }\n              if (!blockElements[textNodeNext.name] && textNodeNext.name !== 'script' && textNodeNext.name !== 'style') {\n                textNode = textNode.prev;\n                continue;\n              }\n            }\n            sibling = textNode.prev;\n            textNode.remove();\n            textNode = sibling;\n          }\n        };\n        var cloneAndExcludeBlocks = function (input) {\n          var name;\n          var output = {};\n          for (name in input) {\n            if (name !== 'li' && name !== 'p') {\n              output[name] = input[name];\n            }\n          }\n          return output;\n        };\n        var parser = SaxParser({\n          validate: validate,\n          allow_html_data_urls: settings.allow_html_data_urls,\n          allow_svg_data_urls: settings.allow_svg_data_urls,\n          allow_script_urls: settings.allow_script_urls,\n          allow_conditional_comments: settings.allow_conditional_comments,\n          preserve_cdata: settings.preserve_cdata,\n          self_closing_elements: cloneAndExcludeBlocks(schema.getSelfClosingElements()),\n          cdata: function (text) {\n            node.append(createNode('#cdata', 4)).value = text;\n          },\n          text: function (text, raw) {\n            var textNode;\n            if (!isInWhiteSpacePreservedElement) {\n              text = text.replace(allWhiteSpaceRegExp, ' ');\n              if (isLineBreakNode(node.lastChild, blockElements)) {\n                text = text.replace(startWhiteSpaceRegExp, '');\n              }\n            }\n            if (text.length !== 0) {\n              textNode = createNode('#text', 3);\n              textNode.raw = !!raw;\n              node.append(textNode).value = text;\n            }\n          },\n          comment: function (text) {\n            node.append(createNode('#comment', 8)).value = text;\n          },\n          pi: function (name, text) {\n            node.append(createNode(name, 7)).value = text;\n            removeWhitespaceBefore(node);\n          },\n          doctype: function (text) {\n            var newNode = node.append(createNode('#doctype', 10));\n            newNode.value = text;\n            removeWhitespaceBefore(node);\n          },\n          start: function (name, attrs, empty) {\n            var newNode, attrFiltersLen, attrName, parent;\n            var elementRule = validate ? schema.getElementRule(name) : {};\n            if (elementRule) {\n              newNode = createNode(elementRule.outputName || name, 1);\n              newNode.attributes = attrs;\n              newNode.shortEnded = empty;\n              node.append(newNode);\n              parent = children[node.name];\n              if (parent && children[newNode.name] && !parent[newNode.name]) {\n                invalidChildren.push(newNode);\n              }\n              attrFiltersLen = attributeFilters.length;\n              while (attrFiltersLen--) {\n                attrName = attributeFilters[attrFiltersLen].name;\n                if (attrName in attrs.map) {\n                  list = matchedAttributes[attrName];\n                  if (list) {\n                    list.push(newNode);\n                  } else {\n                    matchedAttributes[attrName] = [newNode];\n                  }\n                }\n              }\n              if (blockElements[name]) {\n                removeWhitespaceBefore(newNode);\n              }\n              if (!empty) {\n                node = newNode;\n              }\n              if (!isInWhiteSpacePreservedElement && whiteSpaceElements[name]) {\n                isInWhiteSpacePreservedElement = true;\n              }\n            }\n          },\n          end: function (name) {\n            var textNode, text, sibling, tempNode;\n            var elementRule = validate ? schema.getElementRule(name) : {};\n            if (elementRule) {\n              if (blockElements[name]) {\n                if (!isInWhiteSpacePreservedElement) {\n                  textNode = node.firstChild;\n                  if (textNode && textNode.type === 3) {\n                    text = textNode.value.replace(startWhiteSpaceRegExp, '');\n                    if (text.length > 0) {\n                      textNode.value = text;\n                      textNode = textNode.next;\n                    } else {\n                      sibling = textNode.next;\n                      textNode.remove();\n                      textNode = sibling;\n                      while (textNode && textNode.type === 3) {\n                        text = textNode.value;\n                        sibling = textNode.next;\n                        if (text.length === 0 || isAllWhiteSpaceRegExp.test(text)) {\n                          textNode.remove();\n                          textNode = sibling;\n                        }\n                        textNode = sibling;\n                      }\n                    }\n                  }\n                  textNode = node.lastChild;\n                  if (textNode && textNode.type === 3) {\n                    text = textNode.value.replace(endWhiteSpaceRegExp, '');\n                    if (text.length > 0) {\n                      textNode.value = text;\n                      textNode = textNode.prev;\n                    } else {\n                      sibling = textNode.prev;\n                      textNode.remove();\n                      textNode = sibling;\n                      while (textNode && textNode.type === 3) {\n                        text = textNode.value;\n                        sibling = textNode.prev;\n                        if (text.length === 0 || isAllWhiteSpaceRegExp.test(text)) {\n                          textNode.remove();\n                          textNode = sibling;\n                        }\n                        textNode = sibling;\n                      }\n                    }\n                  }\n                }\n              }\n              if (isInWhiteSpacePreservedElement && whiteSpaceElements[name]) {\n                isInWhiteSpacePreservedElement = false;\n              }\n              if (elementRule.removeEmpty && isEmpty$2(schema, nonEmptyElements, whiteSpaceElements, node)) {\n                tempNode = node.parent;\n                if (blockElements[node.name]) {\n                  node.empty().remove();\n                } else {\n                  node.unwrap();\n                }\n                node = tempNode;\n                return;\n              }\n              if (elementRule.paddEmpty && (isPaddedWithNbsp(node) || isEmpty$2(schema, nonEmptyElements, whiteSpaceElements, node))) {\n                paddEmptyNode(settings, args, blockElements, node);\n              }\n              node = node.parent;\n            }\n          }\n        }, schema);\n        var rootNode = node = new AstNode(args.context || settings.root_name, 11);\n        parser.parse(html, args.format);\n        if (validate && invalidChildren.length) {\n          if (!args.context) {\n            fixInvalidChildren(invalidChildren);\n          } else {\n            args.invalid = true;\n          }\n        }\n        if (rootBlockName && (rootNode.name === 'body' || args.isRootContent)) {\n          addRootBlocks();\n        }\n        if (!args.invalid) {\n          for (name in matchedNodes) {\n            if (!matchedNodes.hasOwnProperty(name)) {\n              continue;\n            }\n            list = nodeFilters[name];\n            nodes = matchedNodes[name];\n            fi = nodes.length;\n            while (fi--) {\n              if (!nodes[fi].parent) {\n                nodes.splice(fi, 1);\n              }\n            }\n            for (i = 0, l = list.length; i < l; i++) {\n              list[i](nodes, name, args);\n            }\n          }\n          for (i = 0, l = attributeFilters.length; i < l; i++) {\n            list = attributeFilters[i];\n            if (list.name in matchedAttributes) {\n              nodes = matchedAttributes[list.name];\n              fi = nodes.length;\n              while (fi--) {\n                if (!nodes[fi].parent) {\n                  nodes.splice(fi, 1);\n                }\n              }\n              for (fi = 0, fl = list.callbacks.length; fi < fl; fi++) {\n                list.callbacks[fi](nodes, list.name, args);\n              }\n            }\n          }\n        }\n        return rootNode;\n      };\n      var exports = {\n        schema: schema,\n        addAttributeFilter: addAttributeFilter,\n        getAttributeFilters: getAttributeFilters,\n        addNodeFilter: addNodeFilter,\n        getNodeFilters: getNodeFilters,\n        filterNode: filterNode,\n        parse: parse\n      };\n      register$2(exports, settings);\n      register$1(exports, settings);\n      return exports;\n    };\n\n    var register$3 = function (htmlParser, settings, dom) {\n      htmlParser.addAttributeFilter('data-mce-tabindex', function (nodes, name) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i];\n          node.attr('tabindex', node.attr('data-mce-tabindex'));\n          node.attr(name, null);\n        }\n      });\n      htmlParser.addAttributeFilter('src,href,style', function (nodes, name) {\n        var i = nodes.length, node, value;\n        var internalName = 'data-mce-' + name;\n        var urlConverter = settings.url_converter;\n        var urlConverterScope = settings.url_converter_scope;\n        while (i--) {\n          node = nodes[i];\n          value = node.attr(internalName);\n          if (value !== undefined) {\n            node.attr(name, value.length > 0 ? value : null);\n            node.attr(internalName, null);\n          } else {\n            value = node.attr(name);\n            if (name === 'style') {\n              value = dom.serializeStyle(dom.parseStyle(value), node.name);\n            } else if (urlConverter) {\n              value = urlConverter.call(urlConverterScope, value, name, node.name);\n            }\n            node.attr(name, value.length > 0 ? value : null);\n          }\n        }\n      });\n      htmlParser.addAttributeFilter('class', function (nodes) {\n        var i = nodes.length, node, value;\n        while (i--) {\n          node = nodes[i];\n          value = node.attr('class');\n          if (value) {\n            value = node.attr('class').replace(/(?:^|\\s)mce-item-\\w+(?!\\S)/g, '');\n            node.attr('class', value.length > 0 ? value : null);\n          }\n        }\n      });\n      htmlParser.addAttributeFilter('data-mce-type', function (nodes, name, args) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i];\n          if (node.attr('data-mce-type') === 'bookmark' && !args.cleanup) {\n            var hasChildren = Optional.from(node.firstChild).exists(function (firstChild) {\n              return !isZwsp$1(firstChild.value);\n            });\n            if (hasChildren) {\n              node.unwrap();\n            } else {\n              node.remove();\n            }\n          }\n        }\n      });\n      htmlParser.addNodeFilter('noscript', function (nodes) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i].firstChild;\n          if (node) {\n            node.value = Entities.decode(node.value);\n          }\n        }\n      });\n      htmlParser.addNodeFilter('script,style', function (nodes, name) {\n        var i = nodes.length, node, value, type;\n        var trim = function (value) {\n          return value.replace(/(<!--\\[CDATA\\[|\\]\\]-->)/g, '\\n').replace(/^[\\r\\n]*|[\\r\\n]*$/g, '').replace(/^\\s*((<!--)?(\\s*\\/\\/)?\\s*<!\\[CDATA\\[|(<!--\\s*)?\\/\\*\\s*<!\\[CDATA\\[\\s*\\*\\/|(\\/\\/)?\\s*<!--|\\/\\*\\s*<!--\\s*\\*\\/)\\s*[\\r\\n]*/gi, '').replace(/\\s*(\\/\\*\\s*\\]\\]>\\s*\\*\\/(-->)?|\\s*\\/\\/\\s*\\]\\]>(-->)?|\\/\\/\\s*(-->)?|\\]\\]>|\\/\\*\\s*-->\\s*\\*\\/|\\s*-->\\s*)\\s*$/g, '');\n        };\n        while (i--) {\n          node = nodes[i];\n          value = node.firstChild ? node.firstChild.value : '';\n          if (name === 'script') {\n            type = node.attr('type');\n            if (type) {\n              node.attr('type', type === 'mce-no/type' ? null : type.replace(/^mce\\-/, ''));\n            }\n            if (settings.element_format === 'xhtml' && value.length > 0) {\n              node.firstChild.value = '// <![CDATA[\\n' + trim(value) + '\\n// ]]>';\n            }\n          } else {\n            if (settings.element_format === 'xhtml' && value.length > 0) {\n              node.firstChild.value = '<!--\\n' + trim(value) + '\\n-->';\n            }\n          }\n        }\n      });\n      htmlParser.addNodeFilter('#comment', function (nodes) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i];\n          if (settings.preserve_cdata && node.value.indexOf('[CDATA[') === 0) {\n            node.name = '#cdata';\n            node.type = 4;\n            node.value = dom.decode(node.value.replace(/^\\[CDATA\\[|\\]\\]$/g, ''));\n          } else if (node.value.indexOf('mce:protected ') === 0) {\n            node.name = '#text';\n            node.type = 3;\n            node.raw = true;\n            node.value = unescape(node.value).substr(14);\n          }\n        }\n      });\n      htmlParser.addNodeFilter('xml:namespace,input', function (nodes, name) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i];\n          if (node.type === 7) {\n            node.remove();\n          } else if (node.type === 1) {\n            if (name === 'input' && !node.attr('type')) {\n              node.attr('type', 'text');\n            }\n          }\n        }\n      });\n      htmlParser.addAttributeFilter('data-mce-type', function (nodes) {\n        each(nodes, function (node) {\n          if (node.attr('data-mce-type') === 'format-caret') {\n            if (node.isEmpty(htmlParser.schema.getNonEmptyElements())) {\n              node.remove();\n            } else {\n              node.unwrap();\n            }\n          }\n        });\n      });\n      htmlParser.addAttributeFilter('data-mce-src,data-mce-href,data-mce-style,' + 'data-mce-selected,data-mce-expando,' + 'data-mce-type,data-mce-resize,data-mce-placeholder', function (nodes, name) {\n        var i = nodes.length;\n        while (i--) {\n          nodes[i].attr(name, null);\n        }\n      });\n    };\n    var trimTrailingBr = function (rootNode) {\n      var isBr = function (node) {\n        return node && node.name === 'br';\n      };\n      var brNode1 = rootNode.lastChild;\n      if (isBr(brNode1)) {\n        var brNode2 = brNode1.prev;\n        if (isBr(brNode2)) {\n          brNode1.remove();\n          brNode2.remove();\n        }\n      }\n    };\n\n    var preProcess = function (editor, node, args) {\n      var doc, oldDoc;\n      var dom = editor.dom;\n      node = node.cloneNode(true);\n      var impl = document.implementation;\n      if (impl.createHTMLDocument) {\n        doc = impl.createHTMLDocument('');\n        Tools.each(node.nodeName === 'BODY' ? node.childNodes : [node], function (node) {\n          doc.body.appendChild(doc.importNode(node, true));\n        });\n        if (node.nodeName !== 'BODY') {\n          node = doc.body.firstChild;\n        } else {\n          node = doc.body;\n        }\n        oldDoc = dom.doc;\n        dom.doc = doc;\n      }\n      firePreProcess(editor, __assign(__assign({}, args), { node: node }));\n      if (oldDoc) {\n        dom.doc = oldDoc;\n      }\n      return node;\n    };\n    var shouldFireEvent = function (editor, args) {\n      return editor && editor.hasEventListeners('PreProcess') && !args.no_events;\n    };\n    var process = function (editor, node, args) {\n      return shouldFireEvent(editor, args) ? preProcess(editor, node, args) : node;\n    };\n\n    var addTempAttr = function (htmlParser, tempAttrs, name) {\n      if (Tools.inArray(tempAttrs, name) === -1) {\n        htmlParser.addAttributeFilter(name, function (nodes, name) {\n          var i = nodes.length;\n          while (i--) {\n            nodes[i].attr(name, null);\n          }\n        });\n        tempAttrs.push(name);\n      }\n    };\n    var postProcess$1 = function (editor, args, content) {\n      if (!args.no_events && editor) {\n        var outArgs = firePostProcess(editor, __assign(__assign({}, args), { content: content }));\n        return outArgs.content;\n      } else {\n        return content;\n      }\n    };\n    var getHtmlFromNode = function (dom, node, args) {\n      var html = trim$2(args.getInner ? node.innerHTML : dom.getOuterHTML(node));\n      return args.selection || isWsPreserveElement(SugarElement.fromDom(node)) ? html : Tools.trim(html);\n    };\n    var parseHtml = function (htmlParser, html, args) {\n      var parserArgs = args.selection ? __assign({ forced_root_block: false }, args) : args;\n      var rootNode = htmlParser.parse(html, parserArgs);\n      trimTrailingBr(rootNode);\n      return rootNode;\n    };\n    var serializeNode = function (settings, schema, node) {\n      var htmlSerializer = HtmlSerializer(settings, schema);\n      return htmlSerializer.serialize(node);\n    };\n    var toHtml = function (editor, settings, schema, rootNode, args) {\n      var content = serializeNode(settings, schema, rootNode);\n      return postProcess$1(editor, args, content);\n    };\n    var DomSerializerImpl = function (settings, editor) {\n      var tempAttrs = ['data-mce-selected'];\n      var dom = editor && editor.dom ? editor.dom : DOMUtils.DOM;\n      var schema = editor && editor.schema ? editor.schema : Schema(settings);\n      settings.entity_encoding = settings.entity_encoding || 'named';\n      settings.remove_trailing_brs = 'remove_trailing_brs' in settings ? settings.remove_trailing_brs : true;\n      var htmlParser = DomParser(settings, schema);\n      register$3(htmlParser, settings, dom);\n      var serialize = function (node, parserArgs) {\n        if (parserArgs === void 0) {\n          parserArgs = {};\n        }\n        var args = __assign({ format: 'html' }, parserArgs);\n        var targetNode = process(editor, node, args);\n        var html = getHtmlFromNode(dom, targetNode, args);\n        var rootNode = parseHtml(htmlParser, html, args);\n        return args.format === 'tree' ? rootNode : toHtml(editor, settings, schema, rootNode, args);\n      };\n      return {\n        schema: schema,\n        addNodeFilter: htmlParser.addNodeFilter,\n        addAttributeFilter: htmlParser.addAttributeFilter,\n        serialize: serialize,\n        addRules: function (rules) {\n          schema.addValidElements(rules);\n        },\n        setRules: function (rules) {\n          schema.setValidElements(rules);\n        },\n        addTempAttr: curry(addTempAttr, htmlParser, tempAttrs),\n        getTempAttrs: constant(tempAttrs),\n        getNodeFilters: htmlParser.getNodeFilters,\n        getAttributeFilters: htmlParser.getAttributeFilters\n      };\n    };\n\n    var DomSerializer = function (settings, editor) {\n      var domSerializer = DomSerializerImpl(settings, editor);\n      return {\n        schema: domSerializer.schema,\n        addNodeFilter: domSerializer.addNodeFilter,\n        addAttributeFilter: domSerializer.addAttributeFilter,\n        serialize: domSerializer.serialize,\n        addRules: domSerializer.addRules,\n        setRules: domSerializer.setRules,\n        addTempAttr: domSerializer.addTempAttr,\n        getTempAttrs: domSerializer.getTempAttrs,\n        getNodeFilters: domSerializer.getNodeFilters,\n        getAttributeFilters: domSerializer.getAttributeFilters\n      };\n    };\n\n    var defaultFormat$1 = 'html';\n    var getContent$2 = function (editor, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      var format = args.format ? args.format : defaultFormat$1;\n      return getContent(editor, args, format);\n    };\n\n    var setContent$2 = function (editor, content, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      return setContent(editor, content, args);\n    };\n\n    var DOM$3 = DOMUtils.DOM;\n    var restoreOriginalStyles = function (editor) {\n      DOM$3.setStyle(editor.id, 'display', editor.orgDisplay);\n    };\n    var safeDestroy = function (x) {\n      return Optional.from(x).each(function (x) {\n        return x.destroy();\n      });\n    };\n    var clearDomReferences = function (editor) {\n      editor.contentAreaContainer = editor.formElement = editor.container = editor.editorContainer = null;\n      editor.bodyElement = editor.contentDocument = editor.contentWindow = null;\n      editor.iframeElement = editor.targetElm = null;\n      if (editor.selection) {\n        editor.selection = editor.selection.win = editor.selection.dom = editor.selection.dom.doc = null;\n      }\n    };\n    var restoreForm = function (editor) {\n      var form = editor.formElement;\n      if (form) {\n        if (form._mceOldSubmit) {\n          form.submit = form._mceOldSubmit;\n          form._mceOldSubmit = null;\n        }\n        DOM$3.unbind(form, 'submit reset', editor.formEventDelegate);\n      }\n    };\n    var remove$7 = function (editor) {\n      if (!editor.removed) {\n        var _selectionOverrides = editor._selectionOverrides, editorUpload = editor.editorUpload;\n        var body = editor.getBody();\n        var element = editor.getElement();\n        if (body) {\n          editor.save({ is_removing: true });\n        }\n        editor.removed = true;\n        editor.unbindAllNativeEvents();\n        if (editor.hasHiddenInput && element) {\n          DOM$3.remove(element.nextSibling);\n        }\n        fireRemove(editor);\n        editor.editorManager.remove(editor);\n        if (!editor.inline && body) {\n          restoreOriginalStyles(editor);\n        }\n        fireDetach(editor);\n        DOM$3.remove(editor.getContainer());\n        safeDestroy(_selectionOverrides);\n        safeDestroy(editorUpload);\n        editor.destroy();\n      }\n    };\n    var destroy = function (editor, automatic) {\n      var selection = editor.selection, dom = editor.dom;\n      if (editor.destroyed) {\n        return;\n      }\n      if (!automatic && !editor.removed) {\n        editor.remove();\n        return;\n      }\n      if (!automatic) {\n        editor.editorManager.off('beforeunload', editor._beforeUnload);\n        if (editor.theme && editor.theme.destroy) {\n          editor.theme.destroy();\n        }\n        safeDestroy(selection);\n        safeDestroy(dom);\n      }\n      restoreForm(editor);\n      clearDomReferences(editor);\n      editor.destroyed = true;\n    };\n\n    var hasOwnProperty$2 = Object.prototype.hasOwnProperty;\n    var deep$1 = function (old, nu) {\n      var bothObjects = isObject(old) && isObject(nu);\n      return bothObjects ? deepMerge(old, nu) : nu;\n    };\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          objects[_i] = arguments[_i];\n        }\n        if (objects.length === 0) {\n          throw new Error('Can\\'t merge zero objects');\n        }\n        var ret = {};\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n          for (var key in curObject) {\n            if (hasOwnProperty$2.call(curObject, key)) {\n              ret[key] = merger(ret[key], curObject[key]);\n            }\n          }\n        }\n        return ret;\n      };\n    };\n    var deepMerge = baseMerge(deep$1);\n\n    var sectionResult = function (sections, settings) {\n      return {\n        sections: constant(sections),\n        settings: constant(settings)\n      };\n    };\n    var deviceDetection = detect$3().deviceType;\n    var isTouch = deviceDetection.isTouch();\n    var isPhone = deviceDetection.isPhone();\n    var isTablet = deviceDetection.isTablet();\n    var legacyMobilePlugins = [\n      'lists',\n      'autolink',\n      'autosave'\n    ];\n    var defaultTouchSettings = {\n      table_grid: false,\n      object_resizing: false,\n      resize: false\n    };\n    var normalizePlugins = function (plugins) {\n      var pluginNames = isArray(plugins) ? plugins.join(' ') : plugins;\n      var trimmedPlugins = map(isString(pluginNames) ? pluginNames.split(' ') : [], trim);\n      return filter(trimmedPlugins, function (item) {\n        return item.length > 0;\n      });\n    };\n    var filterLegacyMobilePlugins = function (plugins) {\n      return filter(plugins, curry(contains, legacyMobilePlugins));\n    };\n    var extractSections = function (keys, settings) {\n      var result = bifilter(settings, function (value, key) {\n        return contains(keys, key);\n      });\n      return sectionResult(result.t, result.f);\n    };\n    var getSection = function (sectionResult, name, defaults) {\n      if (defaults === void 0) {\n        defaults = {};\n      }\n      var sections = sectionResult.sections();\n      var sectionSettings = sections.hasOwnProperty(name) ? sections[name] : {};\n      return Tools.extend({}, defaults, sectionSettings);\n    };\n    var hasSection = function (sectionResult, name) {\n      return sectionResult.sections().hasOwnProperty(name);\n    };\n    var isSectionTheme = function (sectionResult, name, theme) {\n      var section = sectionResult.sections();\n      return hasSection(sectionResult, name) && section[name].theme === theme;\n    };\n    var getSectionConfig = function (sectionResult, name) {\n      return hasSection(sectionResult, name) ? sectionResult.sections()[name] : {};\n    };\n    var getToolbarMode = function (settings, defaultVal) {\n      return get$1(settings, 'toolbar_mode').orThunk(function () {\n        return get$1(settings, 'toolbar_drawer').map(function (val) {\n          return val === false ? 'wrap' : val;\n        });\n      }).getOr(defaultVal);\n    };\n    var getDefaultSettings = function (settings, id, documentBaseUrl, isTouch, editor) {\n      var baseDefaults = {\n        id: id,\n        theme: 'silver',\n        toolbar_mode: getToolbarMode(settings, 'floating'),\n        plugins: '',\n        document_base_url: documentBaseUrl,\n        add_form_submit_trigger: true,\n        submit_patch: true,\n        add_unload_trigger: true,\n        convert_urls: true,\n        relative_urls: true,\n        remove_script_host: true,\n        object_resizing: true,\n        doctype: '<!DOCTYPE html>',\n        visual: true,\n        font_size_legacy_values: 'xx-small,small,medium,large,x-large,xx-large,300%',\n        forced_root_block: 'p',\n        hidden_input: true,\n        inline_styles: true,\n        convert_fonts_to_spans: true,\n        indent: true,\n        indent_before: 'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,' + 'tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist',\n        indent_after: 'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,' + 'tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist',\n        entity_encoding: 'named',\n        url_converter: editor.convertURL,\n        url_converter_scope: editor\n      };\n      return __assign(__assign({}, baseDefaults), isTouch ? defaultTouchSettings : {});\n    };\n    var getDefaultMobileSettings = function (mobileSettings, isPhone) {\n      var defaultMobileSettings = {\n        resize: false,\n        toolbar_mode: getToolbarMode(mobileSettings, 'scrolling'),\n        toolbar_sticky: false\n      };\n      var defaultPhoneSettings = { menubar: false };\n      return __assign(__assign(__assign({}, defaultTouchSettings), defaultMobileSettings), isPhone ? defaultPhoneSettings : {});\n    };\n    var getExternalPlugins$1 = function (overrideSettings, settings) {\n      var userDefinedExternalPlugins = settings.external_plugins ? settings.external_plugins : {};\n      if (overrideSettings && overrideSettings.external_plugins) {\n        return Tools.extend({}, overrideSettings.external_plugins, userDefinedExternalPlugins);\n      } else {\n        return userDefinedExternalPlugins;\n      }\n    };\n    var combinePlugins = function (forcedPlugins, plugins) {\n      return [].concat(normalizePlugins(forcedPlugins)).concat(normalizePlugins(plugins));\n    };\n    var getPlatformPlugins = function (isMobileDevice, sectionResult, desktopPlugins, mobilePlugins) {\n      if (isMobileDevice && isSectionTheme(sectionResult, 'mobile', 'mobile')) {\n        return filterLegacyMobilePlugins(mobilePlugins);\n      } else if (isMobileDevice && hasSection(sectionResult, 'mobile')) {\n        return mobilePlugins;\n      } else {\n        return desktopPlugins;\n      }\n    };\n    var processPlugins = function (isMobileDevice, sectionResult, defaultOverrideSettings, settings) {\n      var forcedPlugins = normalizePlugins(defaultOverrideSettings.forced_plugins);\n      var desktopPlugins = normalizePlugins(settings.plugins);\n      var mobileConfig = getSectionConfig(sectionResult, 'mobile');\n      var mobilePlugins = mobileConfig.plugins ? normalizePlugins(mobileConfig.plugins) : desktopPlugins;\n      var platformPlugins = getPlatformPlugins(isMobileDevice, sectionResult, desktopPlugins, mobilePlugins);\n      var combinedPlugins = combinePlugins(forcedPlugins, platformPlugins);\n      if (Env.browser.isIE() && contains(combinedPlugins, 'rtc')) {\n        throw new Error('RTC plugin is not supported on IE 11.');\n      }\n      return Tools.extend(settings, { plugins: combinedPlugins.join(' ') });\n    };\n    var isOnMobile = function (isMobileDevice, sectionResult) {\n      return isMobileDevice && hasSection(sectionResult, 'mobile');\n    };\n    var combineSettings = function (isMobileDevice, isPhone, defaultSettings, defaultOverrideSettings, settings) {\n      var defaultDeviceSettings = isMobileDevice ? { mobile: getDefaultMobileSettings(settings.mobile || {}, isPhone) } : {};\n      var sectionResult = extractSections(['mobile'], deepMerge(defaultDeviceSettings, settings));\n      var extendedSettings = Tools.extend(defaultSettings, defaultOverrideSettings, sectionResult.settings(), isOnMobile(isMobileDevice, sectionResult) ? getSection(sectionResult, 'mobile') : {}, {\n        validate: true,\n        external_plugins: getExternalPlugins$1(defaultOverrideSettings, sectionResult.settings())\n      });\n      return processPlugins(isMobileDevice, sectionResult, defaultOverrideSettings, extendedSettings);\n    };\n    var getEditorSettings = function (editor, id, documentBaseUrl, defaultOverrideSettings, settings) {\n      var defaultSettings = getDefaultSettings(settings, id, documentBaseUrl, isTouch, editor);\n      return combineSettings(isPhone || isTablet, isPhone, defaultSettings, defaultOverrideSettings, settings);\n    };\n    var getFiltered = function (predicate, editor, name) {\n      return Optional.from(editor.settings[name]).filter(predicate);\n    };\n    var getParamObject = function (value) {\n      var output = {};\n      if (typeof value === 'string') {\n        each(value.indexOf('=') > 0 ? value.split(/[;,](?![^=;,]*(?:[;,]|$))/) : value.split(','), function (val) {\n          var arr = val.split('=');\n          if (arr.length > 1) {\n            output[Tools.trim(arr[0])] = Tools.trim(arr[1]);\n          } else {\n            output[Tools.trim(arr[0])] = Tools.trim(arr[0]);\n          }\n        });\n      } else {\n        output = value;\n      }\n      return output;\n    };\n    var isArrayOf = function (p) {\n      return function (a) {\n        return isArray(a) && forall(a, p);\n      };\n    };\n    var getParam = function (editor, name, defaultVal, type) {\n      var value = name in editor.settings ? editor.settings[name] : defaultVal;\n      if (type === 'hash') {\n        return getParamObject(value);\n      } else if (type === 'string') {\n        return getFiltered(isString, editor, name).getOr(defaultVal);\n      } else if (type === 'number') {\n        return getFiltered(isNumber, editor, name).getOr(defaultVal);\n      } else if (type === 'boolean') {\n        return getFiltered(isBoolean, editor, name).getOr(defaultVal);\n      } else if (type === 'object') {\n        return getFiltered(isObject, editor, name).getOr(defaultVal);\n      } else if (type === 'array') {\n        return getFiltered(isArray, editor, name).getOr(defaultVal);\n      } else if (type === 'string[]') {\n        return getFiltered(isArrayOf(isString), editor, name).getOr(defaultVal);\n      } else if (type === 'function') {\n        return getFiltered(isFunction, editor, name).getOr(defaultVal);\n      } else {\n        return value;\n      }\n    };\n\n    var CreateIconManager = function () {\n      var lookup = {};\n      var add = function (id, iconPack) {\n        lookup[id] = iconPack;\n      };\n      var get = function (id) {\n        if (lookup[id]) {\n          return lookup[id];\n        }\n        return { icons: {} };\n      };\n      var has$1 = function (id) {\n        return has(lookup, id);\n      };\n      return {\n        add: add,\n        get: get,\n        has: has$1\n      };\n    };\n    var IconManager = CreateIconManager();\n\n    var getProp = function (propName, elm) {\n      var rawElm = elm.dom;\n      return rawElm[propName];\n    };\n    var getComputedSizeProp = function (propName, elm) {\n      return parseInt(get$5(elm, propName), 10);\n    };\n    var getClientWidth = curry(getProp, 'clientWidth');\n    var getClientHeight = curry(getProp, 'clientHeight');\n    var getMarginTop = curry(getComputedSizeProp, 'margin-top');\n    var getMarginLeft = curry(getComputedSizeProp, 'margin-left');\n    var getBoundingClientRect$1 = function (elm) {\n      return elm.dom.getBoundingClientRect();\n    };\n    var isInsideElementContentArea = function (bodyElm, clientX, clientY) {\n      var clientWidth = getClientWidth(bodyElm);\n      var clientHeight = getClientHeight(bodyElm);\n      return clientX >= 0 && clientY >= 0 && clientX <= clientWidth && clientY <= clientHeight;\n    };\n    var transpose = function (inline, elm, clientX, clientY) {\n      var clientRect = getBoundingClientRect$1(elm);\n      var deltaX = inline ? clientRect.left + elm.dom.clientLeft + getMarginLeft(elm) : 0;\n      var deltaY = inline ? clientRect.top + elm.dom.clientTop + getMarginTop(elm) : 0;\n      var x = clientX - deltaX;\n      var y = clientY - deltaY;\n      return {\n        x: x,\n        y: y\n      };\n    };\n    var isXYInContentArea = function (editor, clientX, clientY) {\n      var bodyElm = SugarElement.fromDom(editor.getBody());\n      var targetElm = editor.inline ? bodyElm : documentElement(bodyElm);\n      var transposedPoint = transpose(editor.inline, targetElm, clientX, clientY);\n      return isInsideElementContentArea(targetElm, transposedPoint.x, transposedPoint.y);\n    };\n    var fromDomSafe = function (node) {\n      return Optional.from(node).map(SugarElement.fromDom);\n    };\n    var isEditorAttachedToDom = function (editor) {\n      var rawContainer = editor.inline ? editor.getBody() : editor.getContentAreaContainer();\n      return fromDomSafe(rawContainer).map(inBody).getOr(false);\n    };\n\n    var NotificationManagerImpl = function () {\n      var unimplemented = function () {\n        throw new Error('Theme did not provide a NotificationManager implementation.');\n      };\n      return {\n        open: unimplemented,\n        close: unimplemented,\n        reposition: unimplemented,\n        getArgs: unimplemented\n      };\n    };\n\n    var NotificationManager = function (editor) {\n      var notifications = [];\n      var getImplementation = function () {\n        var theme = editor.theme;\n        return theme && theme.getNotificationManagerImpl ? theme.getNotificationManagerImpl() : NotificationManagerImpl();\n      };\n      var getTopNotification = function () {\n        return Optional.from(notifications[0]);\n      };\n      var isEqual = function (a, b) {\n        return a.type === b.type && a.text === b.text && !a.progressBar && !a.timeout && !b.progressBar && !b.timeout;\n      };\n      var reposition = function () {\n        if (notifications.length > 0) {\n          getImplementation().reposition(notifications);\n        }\n      };\n      var addNotification = function (notification) {\n        notifications.push(notification);\n      };\n      var closeNotification = function (notification) {\n        findIndex(notifications, function (otherNotification) {\n          return otherNotification === notification;\n        }).each(function (index) {\n          notifications.splice(index, 1);\n        });\n      };\n      var open = function (spec, fireEvent) {\n        if (fireEvent === void 0) {\n          fireEvent = true;\n        }\n        if (editor.removed || !isEditorAttachedToDom(editor)) {\n          return;\n        }\n        if (fireEvent) {\n          editor.fire('BeforeOpenNotification', { notification: spec });\n        }\n        return find(notifications, function (notification) {\n          return isEqual(getImplementation().getArgs(notification), spec);\n        }).getOrThunk(function () {\n          editor.editorManager.setActive(editor);\n          var notification = getImplementation().open(spec, function () {\n            closeNotification(notification);\n            reposition();\n            getTopNotification().fold(function () {\n              return editor.focus();\n            }, function (top) {\n              return focus(SugarElement.fromDom(top.getEl()));\n            });\n          });\n          addNotification(notification);\n          reposition();\n          editor.fire('OpenNotification', { notification: __assign({}, notification) });\n          return notification;\n        });\n      };\n      var close = function () {\n        getTopNotification().each(function (notification) {\n          getImplementation().close(notification);\n          closeNotification(notification);\n          reposition();\n        });\n      };\n      var getNotifications = function () {\n        return notifications;\n      };\n      var registerEvents = function (editor) {\n        editor.on('SkinLoaded', function () {\n          var serviceMessage = getServiceMessage(editor);\n          if (serviceMessage) {\n            open({\n              text: serviceMessage,\n              type: 'warning',\n              timeout: 0\n            }, false);\n          }\n        });\n        editor.on('ResizeEditor ResizeWindow NodeChange', function () {\n          Delay.requestAnimationFrame(reposition);\n        });\n        editor.on('remove', function () {\n          each(notifications.slice(), function (notification) {\n            getImplementation().close(notification);\n          });\n        });\n      };\n      registerEvents(editor);\n      return {\n        open: open,\n        close: close,\n        getNotifications: getNotifications\n      };\n    };\n\n    var PluginManager = AddOnManager.PluginManager;\n\n    var ThemeManager = AddOnManager.ThemeManager;\n\n    function WindowManagerImpl () {\n      var unimplemented = function () {\n        throw new Error('Theme did not provide a WindowManager implementation.');\n      };\n      return {\n        open: unimplemented,\n        openUrl: unimplemented,\n        alert: unimplemented,\n        confirm: unimplemented,\n        close: unimplemented,\n        getParams: unimplemented,\n        setParams: unimplemented\n      };\n    }\n\n    var WindowManager = function (editor) {\n      var dialogs = [];\n      var getImplementation = function () {\n        var theme = editor.theme;\n        return theme && theme.getWindowManagerImpl ? theme.getWindowManagerImpl() : WindowManagerImpl();\n      };\n      var funcBind = function (scope, f) {\n        return function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          return f ? f.apply(scope, args) : undefined;\n        };\n      };\n      var fireOpenEvent = function (dialog) {\n        editor.fire('OpenWindow', { dialog: dialog });\n      };\n      var fireCloseEvent = function (dialog) {\n        editor.fire('CloseWindow', { dialog: dialog });\n      };\n      var addDialog = function (dialog) {\n        dialogs.push(dialog);\n        fireOpenEvent(dialog);\n      };\n      var closeDialog = function (dialog) {\n        fireCloseEvent(dialog);\n        dialogs = filter(dialogs, function (otherDialog) {\n          return otherDialog !== dialog;\n        });\n        if (dialogs.length === 0) {\n          editor.focus();\n        }\n      };\n      var getTopDialog = function () {\n        return Optional.from(dialogs[dialogs.length - 1]);\n      };\n      var storeSelectionAndOpenDialog = function (openDialog) {\n        editor.editorManager.setActive(editor);\n        store(editor);\n        var dialog = openDialog();\n        addDialog(dialog);\n        return dialog;\n      };\n      var open = function (args, params) {\n        return storeSelectionAndOpenDialog(function () {\n          return getImplementation().open(args, params, closeDialog);\n        });\n      };\n      var openUrl = function (args) {\n        return storeSelectionAndOpenDialog(function () {\n          return getImplementation().openUrl(args, closeDialog);\n        });\n      };\n      var alert = function (message, callback, scope) {\n        var windowManagerImpl = getImplementation();\n        windowManagerImpl.alert(message, funcBind(scope ? scope : windowManagerImpl, callback));\n      };\n      var confirm = function (message, callback, scope) {\n        var windowManagerImpl = getImplementation();\n        windowManagerImpl.confirm(message, funcBind(scope ? scope : windowManagerImpl, callback));\n      };\n      var close = function () {\n        getTopDialog().each(function (dialog) {\n          getImplementation().close(dialog);\n          closeDialog(dialog);\n        });\n      };\n      editor.on('remove', function () {\n        each(dialogs, function (dialog) {\n          getImplementation().close(dialog);\n        });\n      });\n      return {\n        open: open,\n        openUrl: openUrl,\n        alert: alert,\n        confirm: confirm,\n        close: close\n      };\n    };\n\n    var displayNotification = function (editor, message) {\n      editor.notificationManager.open({\n        type: 'error',\n        text: message\n      });\n    };\n    var displayError = function (editor, message) {\n      if (editor._skinLoaded) {\n        displayNotification(editor, message);\n      } else {\n        editor.on('SkinLoaded', function () {\n          displayNotification(editor, message);\n        });\n      }\n    };\n    var uploadError = function (editor, message) {\n      displayError(editor, I18n.translate([\n        'Failed to upload image: {0}',\n        message\n      ]));\n    };\n    var logError = function (editor, errorType, msg) {\n      fireError(editor, errorType, { message: msg });\n      console.error(msg);\n    };\n    var createLoadError = function (type, url, name) {\n      return name ? 'Failed to load ' + type + ': ' + name + ' from url ' + url : 'Failed to load ' + type + ' url: ' + url;\n    };\n    var pluginLoadError = function (editor, url, name) {\n      logError(editor, 'PluginLoadError', createLoadError('plugin', url, name));\n    };\n    var iconsLoadError = function (editor, url, name) {\n      logError(editor, 'IconsLoadError', createLoadError('icons', url, name));\n    };\n    var languageLoadError = function (editor, url, name) {\n      logError(editor, 'LanguageLoadError', createLoadError('language', url, name));\n    };\n    var pluginInitError = function (editor, name, err) {\n      var message = I18n.translate([\n        'Failed to initialize plugin: {0}',\n        name\n      ]);\n      fireError(editor, 'PluginLoadError', { message: message });\n      initError(message, err);\n      displayError(editor, message);\n    };\n    var initError = function (message) {\n      var x = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        x[_i - 1] = arguments[_i];\n      }\n      var console = window.console;\n      if (console) {\n        if (console.error) {\n          console.error.apply(console, __spreadArrays([message], x));\n        } else {\n          console.log.apply(console, __spreadArrays([message], x));\n        }\n      }\n    };\n\n    var isContentCssSkinName = function (url) {\n      return /^[a-z0-9\\-]+$/i.test(url);\n    };\n    var getContentCssUrls = function (editor) {\n      return transformToUrls(editor, getContentCss(editor));\n    };\n    var getFontCssUrls = function (editor) {\n      return transformToUrls(editor, getFontCss(editor));\n    };\n    var transformToUrls = function (editor, cssLinks) {\n      var skinUrl = editor.editorManager.baseURL + '/skins/content';\n      var suffix = editor.editorManager.suffix;\n      var contentCssFile = 'content' + suffix + '.css';\n      var inline = editor.inline === true;\n      return map(cssLinks, function (url) {\n        if (isContentCssSkinName(url) && !inline) {\n          return skinUrl + '/' + url + '/' + contentCssFile;\n        } else {\n          return editor.documentBaseURI.toAbsolute(url);\n        }\n      });\n    };\n    var appendContentCssFromSettings = function (editor) {\n      editor.contentCSS = editor.contentCSS.concat(getContentCssUrls(editor), getFontCssUrls(editor));\n    };\n\n    var UploadStatus = function () {\n      var PENDING = 1, UPLOADED = 2;\n      var blobUriStatuses = {};\n      var createStatus = function (status, resultUri) {\n        return {\n          status: status,\n          resultUri: resultUri\n        };\n      };\n      var hasBlobUri = function (blobUri) {\n        return blobUri in blobUriStatuses;\n      };\n      var getResultUri = function (blobUri) {\n        var result = blobUriStatuses[blobUri];\n        return result ? result.resultUri : null;\n      };\n      var isPending = function (blobUri) {\n        return hasBlobUri(blobUri) ? blobUriStatuses[blobUri].status === PENDING : false;\n      };\n      var isUploaded = function (blobUri) {\n        return hasBlobUri(blobUri) ? blobUriStatuses[blobUri].status === UPLOADED : false;\n      };\n      var markPending = function (blobUri) {\n        blobUriStatuses[blobUri] = createStatus(PENDING, null);\n      };\n      var markUploaded = function (blobUri, resultUri) {\n        blobUriStatuses[blobUri] = createStatus(UPLOADED, resultUri);\n      };\n      var removeFailed = function (blobUri) {\n        delete blobUriStatuses[blobUri];\n      };\n      var destroy = function () {\n        blobUriStatuses = {};\n      };\n      return {\n        hasBlobUri: hasBlobUri,\n        getResultUri: getResultUri,\n        isPending: isPending,\n        isUploaded: isUploaded,\n        markPending: markPending,\n        markUploaded: markUploaded,\n        removeFailed: removeFailed,\n        destroy: destroy\n      };\n    };\n\n    var count$1 = 0;\n    var seed = function () {\n      var rnd = function () {\n        return Math.round(Math.random() * 4294967295).toString(36);\n      };\n      var now = new Date().getTime();\n      return 's' + now.toString(36) + rnd() + rnd() + rnd();\n    };\n    var uuid = function (prefix) {\n      return prefix + count$1++ + seed();\n    };\n\n    var BlobCache = function () {\n      var cache = [];\n      var mimeToExt = function (mime) {\n        var mimes = {\n          'image/jpeg': 'jpg',\n          'image/jpg': 'jpg',\n          'image/gif': 'gif',\n          'image/png': 'png',\n          'image/apng': 'apng',\n          'image/avif': 'avif',\n          'image/svg+xml': 'svg',\n          'image/webp': 'webp',\n          'image/bmp': 'bmp',\n          'image/tiff': 'tiff'\n        };\n        return mimes[mime.toLowerCase()] || 'dat';\n      };\n      var create = function (o, blob, base64, name, filename) {\n        if (isString(o)) {\n          var id = o;\n          return toBlobInfo({\n            id: id,\n            name: name,\n            filename: filename,\n            blob: blob,\n            base64: base64\n          });\n        } else if (isObject(o)) {\n          return toBlobInfo(o);\n        } else {\n          throw new Error('Unknown input type');\n        }\n      };\n      var toBlobInfo = function (o) {\n        if (!o.blob || !o.base64) {\n          throw new Error('blob and base64 representations of the image are required for BlobInfo to be created');\n        }\n        var id = o.id || uuid('blobid');\n        var name = o.name || id;\n        var blob = o.blob;\n        return {\n          id: constant(id),\n          name: constant(name),\n          filename: constant(o.filename || name + '.' + mimeToExt(blob.type)),\n          blob: constant(blob),\n          base64: constant(o.base64),\n          blobUri: constant(o.blobUri || URL.createObjectURL(blob)),\n          uri: constant(o.uri)\n        };\n      };\n      var add = function (blobInfo) {\n        if (!get(blobInfo.id())) {\n          cache.push(blobInfo);\n        }\n      };\n      var findFirst = function (predicate) {\n        return find(cache, predicate).getOrUndefined();\n      };\n      var get = function (id) {\n        return findFirst(function (cachedBlobInfo) {\n          return cachedBlobInfo.id() === id;\n        });\n      };\n      var getByUri = function (blobUri) {\n        return findFirst(function (blobInfo) {\n          return blobInfo.blobUri() === blobUri;\n        });\n      };\n      var getByData = function (base64, type) {\n        return findFirst(function (blobInfo) {\n          return blobInfo.base64() === base64 && blobInfo.blob().type === type;\n        });\n      };\n      var removeByUri = function (blobUri) {\n        cache = filter(cache, function (blobInfo) {\n          if (blobInfo.blobUri() === blobUri) {\n            URL.revokeObjectURL(blobInfo.blobUri());\n            return false;\n          }\n          return true;\n        });\n      };\n      var destroy = function () {\n        each(cache, function (cachedBlobInfo) {\n          URL.revokeObjectURL(cachedBlobInfo.blobUri());\n        });\n        cache = [];\n      };\n      return {\n        create: create,\n        add: add,\n        get: get,\n        getByUri: getByUri,\n        getByData: getByData,\n        findFirst: findFirst,\n        removeByUri: removeByUri,\n        destroy: destroy\n      };\n    };\n\n    var Uploader = function (uploadStatus, settings) {\n      var pendingPromises = {};\n      var pathJoin = function (path1, path2) {\n        if (path1) {\n          return path1.replace(/\\/$/, '') + '/' + path2.replace(/^\\//, '');\n        }\n        return path2;\n      };\n      var defaultHandler = function (blobInfo, success, failure, progress) {\n        var xhr = new XMLHttpRequest();\n        xhr.open('POST', settings.url);\n        xhr.withCredentials = settings.credentials;\n        xhr.upload.onprogress = function (e) {\n          progress(e.loaded / e.total * 100);\n        };\n        xhr.onerror = function () {\n          failure('Image upload failed due to a XHR Transport error. Code: ' + xhr.status);\n        };\n        xhr.onload = function () {\n          if (xhr.status < 200 || xhr.status >= 300) {\n            failure('HTTP Error: ' + xhr.status);\n            return;\n          }\n          var json = JSON.parse(xhr.responseText);\n          if (!json || typeof json.location !== 'string') {\n            failure('Invalid JSON: ' + xhr.responseText);\n            return;\n          }\n          success(pathJoin(settings.basePath, json.location));\n        };\n        var formData = new FormData();\n        formData.append('file', blobInfo.blob(), blobInfo.filename());\n        xhr.send(formData);\n      };\n      var noUpload = function () {\n        return new promiseObj(function (resolve) {\n          resolve([]);\n        });\n      };\n      var handlerSuccess = function (blobInfo, url) {\n        return {\n          url: url,\n          blobInfo: blobInfo,\n          status: true\n        };\n      };\n      var handlerFailure = function (blobInfo, message, options) {\n        return {\n          url: '',\n          blobInfo: blobInfo,\n          status: false,\n          error: {\n            message: message,\n            options: options\n          }\n        };\n      };\n      var resolvePending = function (blobUri, result) {\n        Tools.each(pendingPromises[blobUri], function (resolve) {\n          resolve(result);\n        });\n        delete pendingPromises[blobUri];\n      };\n      var uploadBlobInfo = function (blobInfo, handler, openNotification) {\n        uploadStatus.markPending(blobInfo.blobUri());\n        return new promiseObj(function (resolve) {\n          var notification, progress;\n          try {\n            var closeNotification_1 = function () {\n              if (notification) {\n                notification.close();\n                progress = noop;\n              }\n            };\n            var success = function (url) {\n              closeNotification_1();\n              uploadStatus.markUploaded(blobInfo.blobUri(), url);\n              resolvePending(blobInfo.blobUri(), handlerSuccess(blobInfo, url));\n              resolve(handlerSuccess(blobInfo, url));\n            };\n            var failure = function (error, options) {\n              var failureOptions = options ? options : {};\n              closeNotification_1();\n              uploadStatus.removeFailed(blobInfo.blobUri());\n              resolvePending(blobInfo.blobUri(), handlerFailure(blobInfo, error, failureOptions));\n              resolve(handlerFailure(blobInfo, error, failureOptions));\n            };\n            progress = function (percent) {\n              if (percent < 0 || percent > 100) {\n                return;\n              }\n              Optional.from(notification).orThunk(function () {\n                return Optional.from(openNotification).map(apply);\n              }).each(function (n) {\n                notification = n;\n                n.progressBar.value(percent);\n              });\n            };\n            handler(blobInfo, success, failure, progress);\n          } catch (ex) {\n            resolve(handlerFailure(blobInfo, ex.message, {}));\n          }\n        });\n      };\n      var isDefaultHandler = function (handler) {\n        return handler === defaultHandler;\n      };\n      var pendingUploadBlobInfo = function (blobInfo) {\n        var blobUri = blobInfo.blobUri();\n        return new promiseObj(function (resolve) {\n          pendingPromises[blobUri] = pendingPromises[blobUri] || [];\n          pendingPromises[blobUri].push(resolve);\n        });\n      };\n      var uploadBlobs = function (blobInfos, openNotification) {\n        blobInfos = Tools.grep(blobInfos, function (blobInfo) {\n          return !uploadStatus.isUploaded(blobInfo.blobUri());\n        });\n        return promiseObj.all(Tools.map(blobInfos, function (blobInfo) {\n          return uploadStatus.isPending(blobInfo.blobUri()) ? pendingUploadBlobInfo(blobInfo) : uploadBlobInfo(blobInfo, settings.handler, openNotification);\n        }));\n      };\n      var upload = function (blobInfos, openNotification) {\n        return !settings.url && isDefaultHandler(settings.handler) ? noUpload() : uploadBlobs(blobInfos, openNotification);\n      };\n      if (isFunction(settings.handler) === false) {\n        settings.handler = defaultHandler;\n      }\n      return { upload: upload };\n    };\n\n    var openNotification = function (editor) {\n      return function () {\n        return editor.notificationManager.open({\n          text: editor.translate('Image uploading...'),\n          type: 'info',\n          timeout: -1,\n          progressBar: true\n        });\n      };\n    };\n    var createUploader = function (editor, uploadStatus) {\n      return Uploader(uploadStatus, {\n        url: getImageUploadUrl(editor),\n        basePath: getImageUploadBasePath(editor),\n        credentials: getImagesUploadCredentials(editor),\n        handler: getImagesUploadHandler(editor)\n      });\n    };\n    var ImageUploader = function (editor) {\n      var uploadStatus = UploadStatus();\n      var uploader = createUploader(editor, uploadStatus);\n      return {\n        upload: function (blobInfos, showNotification) {\n          if (showNotification === void 0) {\n            showNotification = true;\n          }\n          return uploader.upload(blobInfos, showNotification ? openNotification(editor) : undefined);\n        }\n      };\n    };\n\n    var UploadChangeHandler = function (editor) {\n      var lastChangedLevel = Cell(null);\n      editor.on('change AddUndo', function (e) {\n        lastChangedLevel.set(__assign({}, e.level));\n      });\n      var fireIfChanged = function () {\n        var data = editor.undoManager.data;\n        last(data).filter(function (level) {\n          return !isEq$4(lastChangedLevel.get(), level);\n        }).each(function (level) {\n          editor.setDirty(true);\n          editor.fire('change', {\n            level: level,\n            lastLevel: get(data, data.length - 2).getOrNull()\n          });\n        });\n      };\n      return { fireIfChanged: fireIfChanged };\n    };\n    var EditorUpload = function (editor) {\n      var blobCache = BlobCache();\n      var uploader, imageScanner;\n      var uploadStatus = UploadStatus();\n      var urlFilters = [];\n      var changeHandler = UploadChangeHandler(editor);\n      var aliveGuard = function (callback) {\n        return function (result) {\n          if (editor.selection) {\n            return callback(result);\n          }\n          return [];\n        };\n      };\n      var cacheInvalidator = function (url) {\n        return url + (url.indexOf('?') === -1 ? '?' : '&') + new Date().getTime();\n      };\n      var replaceString = function (content, search, replace) {\n        var index = 0;\n        do {\n          index = content.indexOf(search, index);\n          if (index !== -1) {\n            content = content.substring(0, index) + replace + content.substr(index + search.length);\n            index += replace.length - search.length + 1;\n          }\n        } while (index !== -1);\n        return content;\n      };\n      var replaceImageUrl = function (content, targetUrl, replacementUrl) {\n        var replacementString = 'src=\"' + replacementUrl + '\"' + (replacementUrl === Env.transparentSrc ? ' data-mce-placeholder=\"1\"' : '');\n        content = replaceString(content, 'src=\"' + targetUrl + '\"', replacementString);\n        content = replaceString(content, 'data-mce-src=\"' + targetUrl + '\"', 'data-mce-src=\"' + replacementUrl + '\"');\n        return content;\n      };\n      var replaceUrlInUndoStack = function (targetUrl, replacementUrl) {\n        each(editor.undoManager.data, function (level) {\n          if (level.type === 'fragmented') {\n            level.fragments = map(level.fragments, function (fragment) {\n              return replaceImageUrl(fragment, targetUrl, replacementUrl);\n            });\n          } else {\n            level.content = replaceImageUrl(level.content, targetUrl, replacementUrl);\n          }\n        });\n      };\n      var replaceImageUriInView = function (image, resultUri) {\n        var src = editor.convertURL(resultUri, 'src');\n        replaceUrlInUndoStack(image.src, resultUri);\n        editor.$(image).attr({\n          'src': shouldReuseFileName(editor) ? cacheInvalidator(resultUri) : resultUri,\n          'data-mce-src': src\n        });\n      };\n      var uploadImages = function (callback) {\n        if (!uploader) {\n          uploader = createUploader(editor, uploadStatus);\n        }\n        return scanForImages().then(aliveGuard(function (imageInfos) {\n          var blobInfos = map(imageInfos, function (imageInfo) {\n            return imageInfo.blobInfo;\n          });\n          return uploader.upload(blobInfos, openNotification(editor)).then(aliveGuard(function (result) {\n            var imagesToRemove = [];\n            var filteredResult = map(result, function (uploadInfo, index) {\n              var blobInfo = imageInfos[index].blobInfo;\n              var image = imageInfos[index].image;\n              if (uploadInfo.status && shouldReplaceBlobUris(editor)) {\n                blobCache.removeByUri(image.src);\n                replaceImageUriInView(image, uploadInfo.url);\n              } else if (uploadInfo.error) {\n                if (uploadInfo.error.options.remove) {\n                  replaceUrlInUndoStack(image.getAttribute('src'), Env.transparentSrc);\n                  imagesToRemove.push(image);\n                }\n                uploadError(editor, uploadInfo.error.message);\n              }\n              return {\n                element: image,\n                status: uploadInfo.status,\n                uploadUri: uploadInfo.url,\n                blobInfo: blobInfo\n              };\n            });\n            if (filteredResult.length > 0) {\n              changeHandler.fireIfChanged();\n            }\n            if (imagesToRemove.length > 0) {\n              if (isRtc(editor)) {\n                console.error('Removing images on failed uploads is currently unsupported for RTC');\n              } else {\n                editor.undoManager.transact(function () {\n                  each(imagesToRemove, function (element) {\n                    editor.dom.remove(element);\n                    blobCache.removeByUri(element.src);\n                  });\n                });\n              }\n            }\n            if (callback) {\n              callback(filteredResult);\n            }\n            return filteredResult;\n          }));\n        }));\n      };\n      var uploadImagesAuto = function (callback) {\n        if (isAutomaticUploadsEnabled(editor)) {\n          return uploadImages(callback);\n        }\n      };\n      var isValidDataUriImage = function (imgElm) {\n        if (forall(urlFilters, function (filter) {\n            return filter(imgElm);\n          }) === false) {\n          return false;\n        }\n        if (imgElm.getAttribute('src').indexOf('data:') === 0) {\n          var dataImgFilter = getImagesDataImgFilter(editor);\n          return dataImgFilter(imgElm);\n        }\n        return true;\n      };\n      var addFilter = function (filter) {\n        urlFilters.push(filter);\n      };\n      var scanForImages = function () {\n        if (!imageScanner) {\n          imageScanner = ImageScanner(uploadStatus, blobCache);\n        }\n        return imageScanner.findAll(editor.getBody(), isValidDataUriImage).then(aliveGuard(function (result) {\n          result = filter(result, function (resultItem) {\n            if (typeof resultItem === 'string') {\n              displayError(editor, resultItem);\n              return false;\n            }\n            return true;\n          });\n          each(result, function (resultItem) {\n            replaceUrlInUndoStack(resultItem.image.src, resultItem.blobInfo.blobUri());\n            resultItem.image.src = resultItem.blobInfo.blobUri();\n            resultItem.image.removeAttribute('data-mce-src');\n          });\n          return result;\n        }));\n      };\n      var destroy = function () {\n        blobCache.destroy();\n        uploadStatus.destroy();\n        imageScanner = uploader = null;\n      };\n      var replaceBlobUris = function (content) {\n        return content.replace(/src=\"(blob:[^\"]+)\"/g, function (match, blobUri) {\n          var resultUri = uploadStatus.getResultUri(blobUri);\n          if (resultUri) {\n            return 'src=\"' + resultUri + '\"';\n          }\n          var blobInfo = blobCache.getByUri(blobUri);\n          if (!blobInfo) {\n            blobInfo = foldl(editor.editorManager.get(), function (result, editor) {\n              return result || editor.editorUpload && editor.editorUpload.blobCache.getByUri(blobUri);\n            }, null);\n          }\n          if (blobInfo) {\n            var blob = blobInfo.blob();\n            return 'src=\"data:' + blob.type + ';base64,' + blobInfo.base64() + '\"';\n          }\n          return match;\n        });\n      };\n      editor.on('SetContent', function () {\n        if (isAutomaticUploadsEnabled(editor)) {\n          uploadImagesAuto();\n        } else {\n          scanForImages();\n        }\n      });\n      editor.on('RawSaveContent', function (e) {\n        e.content = replaceBlobUris(e.content);\n      });\n      editor.on('GetContent', function (e) {\n        if (e.source_view || e.format === 'raw' || e.format === 'tree') {\n          return;\n        }\n        e.content = replaceBlobUris(e.content);\n      });\n      editor.on('PostRender', function () {\n        editor.parser.addNodeFilter('img', function (images) {\n          each(images, function (img) {\n            var src = img.attr('src');\n            if (blobCache.getByUri(src)) {\n              return;\n            }\n            var resultUri = uploadStatus.getResultUri(src);\n            if (resultUri) {\n              img.attr('src', resultUri);\n            }\n          });\n        });\n      });\n      return {\n        blobCache: blobCache,\n        addFilter: addFilter,\n        uploadImages: uploadImages,\n        uploadImagesAuto: uploadImagesAuto,\n        scanForImages: scanForImages,\n        destroy: destroy\n      };\n    };\n\n    var get$a = function (dom) {\n      var formats = {\n        valigntop: [{\n            selector: 'td,th',\n            styles: { verticalAlign: 'top' }\n          }],\n        valignmiddle: [{\n            selector: 'td,th',\n            styles: { verticalAlign: 'middle' }\n          }],\n        valignbottom: [{\n            selector: 'td,th',\n            styles: { verticalAlign: 'bottom' }\n          }],\n        alignleft: [\n          {\n            selector: 'figure.image',\n            collapsed: false,\n            classes: 'align-left',\n            ceFalseOverride: true,\n            preview: 'font-family font-size'\n          },\n          {\n            selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n            styles: { textAlign: 'left' },\n            inherit: false,\n            preview: false,\n            defaultBlock: 'div'\n          },\n          {\n            selector: 'img,table,audio,video',\n            collapsed: false,\n            styles: { float: 'left' },\n            preview: 'font-family font-size'\n          }\n        ],\n        aligncenter: [\n          {\n            selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n            styles: { textAlign: 'center' },\n            inherit: false,\n            preview: 'font-family font-size',\n            defaultBlock: 'div'\n          },\n          {\n            selector: 'figure.image',\n            collapsed: false,\n            classes: 'align-center',\n            ceFalseOverride: true,\n            preview: 'font-family font-size'\n          },\n          {\n            selector: 'img,audio,video',\n            collapsed: false,\n            styles: {\n              display: 'block',\n              marginLeft: 'auto',\n              marginRight: 'auto'\n            },\n            preview: false\n          },\n          {\n            selector: 'table',\n            collapsed: false,\n            styles: {\n              marginLeft: 'auto',\n              marginRight: 'auto'\n            },\n            preview: 'font-family font-size'\n          }\n        ],\n        alignright: [\n          {\n            selector: 'figure.image',\n            collapsed: false,\n            classes: 'align-right',\n            ceFalseOverride: true,\n            preview: 'font-family font-size'\n          },\n          {\n            selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n            styles: { textAlign: 'right' },\n            inherit: false,\n            preview: 'font-family font-size',\n            defaultBlock: 'div'\n          },\n          {\n            selector: 'img,table,audio,video',\n            collapsed: false,\n            styles: { float: 'right' },\n            preview: 'font-family font-size'\n          }\n        ],\n        alignjustify: [{\n            selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n            styles: { textAlign: 'justify' },\n            inherit: false,\n            defaultBlock: 'div',\n            preview: 'font-family font-size'\n          }],\n        bold: [\n          {\n            inline: 'strong',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          },\n          {\n            inline: 'span',\n            styles: { fontWeight: 'bold' }\n          },\n          {\n            inline: 'b',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          }\n        ],\n        italic: [\n          {\n            inline: 'em',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          },\n          {\n            inline: 'span',\n            styles: { fontStyle: 'italic' }\n          },\n          {\n            inline: 'i',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          }\n        ],\n        underline: [\n          {\n            inline: 'span',\n            styles: { textDecoration: 'underline' },\n            exact: true\n          },\n          {\n            inline: 'u',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          }\n        ],\n        strikethrough: [\n          {\n            inline: 'span',\n            styles: { textDecoration: 'line-through' },\n            exact: true\n          },\n          {\n            inline: 'strike',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          },\n          {\n            inline: 's',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          }\n        ],\n        forecolor: {\n          inline: 'span',\n          styles: { color: '%value' },\n          links: true,\n          remove_similar: true,\n          clear_child_styles: true\n        },\n        hilitecolor: {\n          inline: 'span',\n          styles: { backgroundColor: '%value' },\n          links: true,\n          remove_similar: true,\n          clear_child_styles: true\n        },\n        fontname: {\n          inline: 'span',\n          toggle: false,\n          styles: { fontFamily: '%value' },\n          clear_child_styles: true\n        },\n        fontsize: {\n          inline: 'span',\n          toggle: false,\n          styles: { fontSize: '%value' },\n          clear_child_styles: true\n        },\n        lineheight: {\n          selector: 'h1,h2,h3,h4,h5,h6,p,li,td,th,div',\n          defaultBlock: 'p',\n          styles: { lineHeight: '%value' }\n        },\n        fontsize_class: {\n          inline: 'span',\n          attributes: { class: '%value' }\n        },\n        blockquote: {\n          block: 'blockquote',\n          wrapper: true,\n          remove: 'all'\n        },\n        subscript: { inline: 'sub' },\n        superscript: { inline: 'sup' },\n        code: { inline: 'code' },\n        link: {\n          inline: 'a',\n          selector: 'a',\n          remove: 'all',\n          split: true,\n          deep: true,\n          onmatch: function (node, _fmt, _itemName) {\n            return isElement$1(node) && node.hasAttribute('href');\n          },\n          onformat: function (elm, _fmt, vars) {\n            Tools.each(vars, function (value, key) {\n              dom.setAttrib(elm, key, value);\n            });\n          }\n        },\n        removeformat: [\n          {\n            selector: 'b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small',\n            remove: 'all',\n            split: true,\n            expand: false,\n            block_expand: true,\n            deep: true\n          },\n          {\n            selector: 'span',\n            attributes: [\n              'style',\n              'class'\n            ],\n            remove: 'empty',\n            split: true,\n            expand: false,\n            deep: true\n          },\n          {\n            selector: '*',\n            attributes: [\n              'style',\n              'class'\n            ],\n            split: false,\n            expand: false,\n            deep: true\n          }\n        ]\n      };\n      Tools.each('p h1 h2 h3 h4 h5 h6 div address pre dt dd samp'.split(/\\s/), function (name) {\n        formats[name] = {\n          block: name,\n          remove: 'all'\n        };\n      });\n      return formats;\n    };\n\n    var FormatRegistry = function (editor) {\n      var formats = {};\n      var get = function (name) {\n        return name ? formats[name] : formats;\n      };\n      var has$1 = function (name) {\n        return has(formats, name);\n      };\n      var register = function (name, format) {\n        if (name) {\n          if (typeof name !== 'string') {\n            Tools.each(name, function (format, name) {\n              register(name, format);\n            });\n          } else {\n            if (!isArray(format)) {\n              format = [format];\n            }\n            Tools.each(format, function (format) {\n              if (typeof format.deep === 'undefined') {\n                format.deep = !format.selector;\n              }\n              if (typeof format.split === 'undefined') {\n                format.split = !format.selector || format.inline;\n              }\n              if (typeof format.remove === 'undefined' && format.selector && !format.inline) {\n                format.remove = 'none';\n              }\n              if (format.selector && format.inline) {\n                format.mixed = true;\n                format.block_expand = true;\n              }\n              if (typeof format.classes === 'string') {\n                format.classes = format.classes.split(/\\s+/);\n              }\n            });\n            formats[name] = format;\n          }\n        }\n      };\n      var unregister = function (name) {\n        if (name && formats[name]) {\n          delete formats[name];\n        }\n        return formats;\n      };\n      register(get$a(editor.dom));\n      register(getFormats(editor));\n      return {\n        get: get,\n        has: has$1,\n        register: register,\n        unregister: unregister\n      };\n    };\n\n    var each$e = Tools.each;\n    var dom = DOMUtils.DOM;\n    var parsedSelectorToHtml = function (ancestry, editor) {\n      var elm, item, fragment;\n      var schema = editor && editor.schema || Schema({});\n      var decorate = function (elm, item) {\n        if (item.classes.length) {\n          dom.addClass(elm, item.classes.join(' '));\n        }\n        dom.setAttribs(elm, item.attrs);\n      };\n      var createElement = function (sItem) {\n        item = typeof sItem === 'string' ? {\n          name: sItem,\n          classes: [],\n          attrs: {}\n        } : sItem;\n        var elm = dom.create(item.name);\n        decorate(elm, item);\n        return elm;\n      };\n      var getRequiredParent = function (elm, candidate) {\n        var name = typeof elm !== 'string' ? elm.nodeName.toLowerCase() : elm;\n        var elmRule = schema.getElementRule(name);\n        var parentsRequired = elmRule && elmRule.parentsRequired;\n        if (parentsRequired && parentsRequired.length) {\n          return candidate && Tools.inArray(parentsRequired, candidate) !== -1 ? candidate : parentsRequired[0];\n        } else {\n          return false;\n        }\n      };\n      var wrapInHtml = function (elm, ancestry, siblings) {\n        var parent, parentCandidate;\n        var ancestor = ancestry.length > 0 && ancestry[0];\n        var ancestorName = ancestor && ancestor.name;\n        var parentRequired = getRequiredParent(elm, ancestorName);\n        if (parentRequired) {\n          if (ancestorName === parentRequired) {\n            parentCandidate = ancestry[0];\n            ancestry = ancestry.slice(1);\n          } else {\n            parentCandidate = parentRequired;\n          }\n        } else if (ancestor) {\n          parentCandidate = ancestry[0];\n          ancestry = ancestry.slice(1);\n        } else if (!siblings) {\n          return elm;\n        }\n        if (parentCandidate) {\n          parent = createElement(parentCandidate);\n          parent.appendChild(elm);\n        }\n        if (siblings) {\n          if (!parent) {\n            parent = dom.create('div');\n            parent.appendChild(elm);\n          }\n          Tools.each(siblings, function (sibling) {\n            var siblingElm = createElement(sibling);\n            parent.insertBefore(siblingElm, elm);\n          });\n        }\n        return wrapInHtml(parent, ancestry, parentCandidate && parentCandidate.siblings);\n      };\n      if (ancestry && ancestry.length) {\n        item = ancestry[0];\n        elm = createElement(item);\n        fragment = dom.create('div');\n        fragment.appendChild(wrapInHtml(elm, ancestry.slice(1), item.siblings));\n        return fragment;\n      } else {\n        return '';\n      }\n    };\n    var parseSelectorItem = function (item) {\n      var tagName;\n      var obj = {\n        classes: [],\n        attrs: {}\n      };\n      item = obj.selector = Tools.trim(item);\n      if (item !== '*') {\n        tagName = item.replace(/(?:([#\\.]|::?)([\\w\\-]+)|(\\[)([^\\]]+)\\]?)/g, function ($0, $1, $2, $3, $4) {\n          switch ($1) {\n          case '#':\n            obj.attrs.id = $2;\n            break;\n          case '.':\n            obj.classes.push($2);\n            break;\n          case ':':\n            if (Tools.inArray('checked disabled enabled read-only required'.split(' '), $2) !== -1) {\n              obj.attrs[$2] = $2;\n            }\n            break;\n          }\n          if ($3 === '[') {\n            var m = $4.match(/([\\w\\-]+)(?:\\=\\\"([^\\\"]+))?/);\n            if (m) {\n              obj.attrs[m[1]] = m[2];\n            }\n          }\n          return '';\n        });\n      }\n      obj.name = tagName || 'div';\n      return obj;\n    };\n    var parseSelector = function (selector) {\n      if (!selector || typeof selector !== 'string') {\n        return [];\n      }\n      selector = selector.split(/\\s*,\\s*/)[0];\n      selector = selector.replace(/\\s*(~\\+|~|\\+|>)\\s*/g, '$1');\n      return Tools.map(selector.split(/(?:>|\\s+(?![^\\[\\]]+\\]))/), function (item) {\n        var siblings = Tools.map(item.split(/(?:~\\+|~|\\+)/), parseSelectorItem);\n        var obj = siblings.pop();\n        if (siblings.length) {\n          obj.siblings = siblings;\n        }\n        return obj;\n      }).reverse();\n    };\n    var getCssText = function (editor, format) {\n      var name, previewFrag;\n      var previewCss = '', parentFontSize;\n      var previewStyles = getPreviewStyles(editor);\n      if (previewStyles === '') {\n        return '';\n      }\n      var removeVars = function (val) {\n        return val.replace(/%(\\w+)/g, '');\n      };\n      if (typeof format === 'string') {\n        format = editor.formatter.get(format);\n        if (!format) {\n          return;\n        }\n        format = format[0];\n      }\n      if ('preview' in format) {\n        var previewOpt = get$1(format, 'preview');\n        if (previewOpt.is(false)) {\n          return '';\n        } else {\n          previewStyles = previewOpt.getOr(previewStyles);\n        }\n      }\n      name = format.block || format.inline || 'span';\n      var items = parseSelector(format.selector);\n      if (items.length) {\n        if (!items[0].name) {\n          items[0].name = name;\n        }\n        name = format.selector;\n        previewFrag = parsedSelectorToHtml(items, editor);\n      } else {\n        previewFrag = parsedSelectorToHtml([name], editor);\n      }\n      var previewElm = dom.select(name, previewFrag)[0] || previewFrag.firstChild;\n      each$e(format.styles, function (value, name) {\n        var newValue = removeVars(value);\n        if (newValue) {\n          dom.setStyle(previewElm, name, newValue);\n        }\n      });\n      each$e(format.attributes, function (value, name) {\n        var newValue = removeVars(value);\n        if (newValue) {\n          dom.setAttrib(previewElm, name, newValue);\n        }\n      });\n      each$e(format.classes, function (value) {\n        var newValue = removeVars(value);\n        if (!dom.hasClass(previewElm, newValue)) {\n          dom.addClass(previewElm, newValue);\n        }\n      });\n      editor.fire('PreviewFormats');\n      dom.setStyles(previewFrag, {\n        position: 'absolute',\n        left: -65535\n      });\n      editor.getBody().appendChild(previewFrag);\n      parentFontSize = dom.getStyle(editor.getBody(), 'fontSize', true);\n      parentFontSize = /px$/.test(parentFontSize) ? parseInt(parentFontSize, 10) : 0;\n      each$e(previewStyles.split(' '), function (name) {\n        var value = dom.getStyle(previewElm, name, true);\n        if (name === 'background-color' && /transparent|rgba\\s*\\([^)]+,\\s*0\\)/.test(value)) {\n          value = dom.getStyle(editor.getBody(), name, true);\n          if (dom.toHex(value).toLowerCase() === '#ffffff') {\n            return;\n          }\n        }\n        if (name === 'color') {\n          if (dom.toHex(value).toLowerCase() === '#000000') {\n            return;\n          }\n        }\n        if (name === 'font-size') {\n          if (/em|%$/.test(value)) {\n            if (parentFontSize === 0) {\n              return;\n            }\n            var numValue = parseFloat(value) / (/%$/.test(value) ? 100 : 1);\n            value = numValue * parentFontSize + 'px';\n          }\n        }\n        if (name === 'border' && value) {\n          previewCss += 'padding:0 2px;';\n        }\n        previewCss += name + ':' + value + ';';\n      });\n      editor.fire('AfterPreviewFormats');\n      dom.remove(previewFrag);\n      return previewCss;\n    };\n\n    var setup$6 = function (editor) {\n      editor.addShortcut('meta+b', '', 'Bold');\n      editor.addShortcut('meta+i', '', 'Italic');\n      editor.addShortcut('meta+u', '', 'Underline');\n      for (var i = 1; i <= 6; i++) {\n        editor.addShortcut('access+' + i, '', [\n          'FormatBlock',\n          false,\n          'h' + i\n        ]);\n      }\n      editor.addShortcut('access+7', '', [\n        'FormatBlock',\n        false,\n        'p'\n      ]);\n      editor.addShortcut('access+8', '', [\n        'FormatBlock',\n        false,\n        'div'\n      ]);\n      editor.addShortcut('access+9', '', [\n        'FormatBlock',\n        false,\n        'address'\n      ]);\n    };\n\n    var Formatter = function (editor) {\n      var formats = FormatRegistry(editor);\n      var formatChangeState = Cell(null);\n      setup$6(editor);\n      setup$3(editor);\n      return {\n        get: formats.get,\n        has: formats.has,\n        register: formats.register,\n        unregister: formats.unregister,\n        apply: function (name, vars, node) {\n          applyFormat$1(editor, name, vars, node);\n        },\n        remove: function (name, vars, node, similar) {\n          removeFormat$1(editor, name, vars, node, similar);\n        },\n        toggle: function (name, vars, node) {\n          toggleFormat(editor, name, vars, node);\n        },\n        match: function (name, vars, node) {\n          return matchFormat(editor, name, vars, node);\n        },\n        closest: function (names) {\n          return closestFormat(editor, names);\n        },\n        matchAll: function (names, vars) {\n          return matchAllFormats(editor, names, vars);\n        },\n        matchNode: function (node, names, vars, similar) {\n          return matchNodeFormat(editor, node, names, vars, similar);\n        },\n        canApply: function (name) {\n          return canApplyFormat(editor, name);\n        },\n        formatChanged: function (formats, callback, similar) {\n          return formatChanged(editor, formatChangeState, formats, callback, similar);\n        },\n        getCssText: curry(getCssText, editor)\n      };\n    };\n\n    var registerEvents$1 = function (editor, undoManager, locks) {\n      var isFirstTypedCharacter = Cell(false);\n      var addNonTypingUndoLevel = function (e) {\n        setTyping(undoManager, false, locks);\n        undoManager.add({}, e);\n      };\n      editor.on('init', function () {\n        undoManager.add();\n      });\n      editor.on('BeforeExecCommand', function (e) {\n        var cmd = e.command.toLowerCase();\n        if (cmd !== 'undo' && cmd !== 'redo' && cmd !== 'mcerepaint') {\n          endTyping(undoManager, locks);\n          undoManager.beforeChange();\n        }\n      });\n      editor.on('ExecCommand', function (e) {\n        var cmd = e.command.toLowerCase();\n        if (cmd !== 'undo' && cmd !== 'redo' && cmd !== 'mcerepaint') {\n          addNonTypingUndoLevel(e);\n        }\n      });\n      editor.on('ObjectResizeStart cut', function () {\n        undoManager.beforeChange();\n      });\n      editor.on('SaveContent ObjectResized blur', addNonTypingUndoLevel);\n      editor.on('dragend', addNonTypingUndoLevel);\n      editor.on('keyup', function (e) {\n        var keyCode = e.keyCode;\n        if (e.isDefaultPrevented()) {\n          return;\n        }\n        if (keyCode >= 33 && keyCode <= 36 || keyCode >= 37 && keyCode <= 40 || keyCode === 45 || e.ctrlKey) {\n          addNonTypingUndoLevel();\n          editor.nodeChanged();\n        }\n        if (keyCode === 46 || keyCode === 8) {\n          editor.nodeChanged();\n        }\n        if (isFirstTypedCharacter.get() && undoManager.typing && isEq$4(createFromEditor(editor), undoManager.data[0]) === false) {\n          if (editor.isDirty() === false) {\n            editor.setDirty(true);\n            editor.fire('change', {\n              level: undoManager.data[0],\n              lastLevel: null\n            });\n          }\n          editor.fire('TypingUndo');\n          isFirstTypedCharacter.set(false);\n          editor.nodeChanged();\n        }\n      });\n      editor.on('keydown', function (e) {\n        var keyCode = e.keyCode;\n        if (e.isDefaultPrevented()) {\n          return;\n        }\n        if (keyCode >= 33 && keyCode <= 36 || keyCode >= 37 && keyCode <= 40 || keyCode === 45) {\n          if (undoManager.typing) {\n            addNonTypingUndoLevel(e);\n          }\n          return;\n        }\n        var modKey = e.ctrlKey && !e.altKey || e.metaKey;\n        if ((keyCode < 16 || keyCode > 20) && keyCode !== 224 && keyCode !== 91 && !undoManager.typing && !modKey) {\n          undoManager.beforeChange();\n          setTyping(undoManager, true, locks);\n          undoManager.add({}, e);\n          isFirstTypedCharacter.set(true);\n        }\n      });\n      editor.on('mousedown', function (e) {\n        if (undoManager.typing) {\n          addNonTypingUndoLevel(e);\n        }\n      });\n      var isInsertReplacementText = function (event) {\n        return event.inputType === 'insertReplacementText';\n      };\n      var isInsertTextDataNull = function (event) {\n        return event.inputType === 'insertText' && event.data === null;\n      };\n      var isInsertFromPasteOrDrop = function (event) {\n        return event.inputType === 'insertFromPaste' || event.inputType === 'insertFromDrop';\n      };\n      editor.on('input', function (e) {\n        if (e.inputType && (isInsertReplacementText(e) || isInsertTextDataNull(e) || isInsertFromPasteOrDrop(e))) {\n          addNonTypingUndoLevel(e);\n        }\n      });\n      editor.on('AddUndo Undo Redo ClearUndos', function (e) {\n        if (!e.isDefaultPrevented()) {\n          editor.nodeChanged();\n        }\n      });\n    };\n    var addKeyboardShortcuts = function (editor) {\n      editor.addShortcut('meta+z', '', 'Undo');\n      editor.addShortcut('meta+y,meta+shift+z', '', 'Redo');\n    };\n\n    var UndoManager = function (editor) {\n      var beforeBookmark = Cell(Optional.none());\n      var locks = Cell(0);\n      var index = Cell(0);\n      var undoManager = {\n        data: [],\n        typing: false,\n        beforeChange: function () {\n          beforeChange$1(editor, locks, beforeBookmark);\n        },\n        add: function (level, event) {\n          return addUndoLevel$1(editor, undoManager, index, locks, beforeBookmark, level, event);\n        },\n        undo: function () {\n          return undo$1(editor, undoManager, locks, index);\n        },\n        redo: function () {\n          return redo$1(editor, index, undoManager.data);\n        },\n        clear: function () {\n          clear$1(editor, undoManager, index);\n        },\n        reset: function () {\n          reset$1(editor, undoManager);\n        },\n        hasUndo: function () {\n          return hasUndo$1(editor, undoManager, index);\n        },\n        hasRedo: function () {\n          return hasRedo$1(editor, undoManager, index);\n        },\n        transact: function (callback) {\n          return transact$1(editor, undoManager, locks, callback);\n        },\n        ignore: function (callback) {\n          ignore$1(editor, locks, callback);\n        },\n        extra: function (callback1, callback2) {\n          extra$1(editor, undoManager, index, callback1, callback2);\n        }\n      };\n      if (!isRtc(editor)) {\n        registerEvents$1(editor, undoManager, locks);\n      }\n      addKeyboardShortcuts(editor);\n      return undoManager;\n    };\n\n    var nonTypingKeycodes = [\n      9,\n      27,\n      VK.HOME,\n      VK.END,\n      19,\n      20,\n      44,\n      144,\n      145,\n      33,\n      34,\n      45,\n      16,\n      17,\n      18,\n      91,\n      92,\n      93,\n      VK.DOWN,\n      VK.UP,\n      VK.LEFT,\n      VK.RIGHT\n    ].concat(Env.browser.isFirefox() ? [224] : []);\n    var placeholderAttr = 'data-mce-placeholder';\n    var isKeyboardEvent = function (e) {\n      return e.type === 'keydown' || e.type === 'keyup';\n    };\n    var isDeleteEvent = function (e) {\n      var keyCode = e.keyCode;\n      return keyCode === VK.BACKSPACE || keyCode === VK.DELETE;\n    };\n    var isNonTypingKeyboardEvent = function (e) {\n      if (isKeyboardEvent(e)) {\n        var keyCode = e.keyCode;\n        return !isDeleteEvent(e) && (VK.metaKeyPressed(e) || e.altKey || keyCode >= 112 && keyCode <= 123 || contains(nonTypingKeycodes, keyCode));\n      } else {\n        return false;\n      }\n    };\n    var isTypingKeyboardEvent = function (e) {\n      return isKeyboardEvent(e) && !(isDeleteEvent(e) || e.type === 'keyup' && e.keyCode === 229);\n    };\n    var isVisuallyEmpty = function (dom, rootElm, forcedRootBlock) {\n      if (isEmpty(SugarElement.fromDom(rootElm), false)) {\n        var isForcedRootBlockFalse = forcedRootBlock === '';\n        var firstElement = rootElm.firstElementChild;\n        if (!firstElement) {\n          return true;\n        } else if (dom.getStyle(rootElm.firstElementChild, 'padding-left') || dom.getStyle(rootElm.firstElementChild, 'padding-right')) {\n          return false;\n        } else {\n          return isForcedRootBlockFalse ? !dom.isBlock(firstElement) : forcedRootBlock === firstElement.nodeName.toLowerCase();\n        }\n      } else {\n        return false;\n      }\n    };\n    var setup$7 = function (editor) {\n      var dom = editor.dom;\n      var rootBlock = getForcedRootBlock(editor);\n      var placeholder = getPlaceholder(editor);\n      var updatePlaceholder = function (e, initial) {\n        if (isNonTypingKeyboardEvent(e)) {\n          return;\n        }\n        var body = editor.getBody();\n        var showPlaceholder = isTypingKeyboardEvent(e) ? false : isVisuallyEmpty(dom, body, rootBlock);\n        var isPlaceholderShown = dom.getAttrib(body, placeholderAttr) !== '';\n        if (isPlaceholderShown !== showPlaceholder || initial) {\n          dom.setAttrib(body, placeholderAttr, showPlaceholder ? placeholder : null);\n          dom.setAttrib(body, 'aria-placeholder', showPlaceholder ? placeholder : null);\n          firePlaceholderToggle(editor, showPlaceholder);\n          editor.on(showPlaceholder ? 'keydown' : 'keyup', updatePlaceholder);\n          editor.off(showPlaceholder ? 'keyup' : 'keydown', updatePlaceholder);\n        }\n      };\n      if (placeholder) {\n        editor.on('init', function (e) {\n          updatePlaceholder(e, true);\n          editor.on('change SetContent ExecCommand', updatePlaceholder);\n          editor.on('paste', function (e) {\n            return Delay.setEditorTimeout(editor, function () {\n              return updatePlaceholder(e);\n            });\n          });\n        });\n      }\n    };\n\n    var strongRtl = /[\\u0591-\\u07FF\\uFB1D-\\uFDFF\\uFE70-\\uFEFC]/;\n    var hasStrongRtl = function (text) {\n      return strongRtl.test(text);\n    };\n\n    var isInlineTarget = function (editor, elm) {\n      return is$1(SugarElement.fromDom(elm), getInlineBoundarySelector(editor));\n    };\n    var isRtl$1 = function (element) {\n      return DOMUtils.DOM.getStyle(element, 'direction', true) === 'rtl' || hasStrongRtl(element.textContent);\n    };\n    var findInlineParents = function (isInlineTarget, rootNode, pos) {\n      return filter(DOMUtils.DOM.getParents(pos.container(), '*', rootNode), isInlineTarget);\n    };\n    var findRootInline = function (isInlineTarget, rootNode, pos) {\n      var parents = findInlineParents(isInlineTarget, rootNode, pos);\n      return Optional.from(parents[parents.length - 1]);\n    };\n    var hasSameParentBlock = function (rootNode, node1, node2) {\n      var block1 = getParentBlock(node1, rootNode);\n      var block2 = getParentBlock(node2, rootNode);\n      return block1 && block1 === block2;\n    };\n    var isAtZwsp = function (pos) {\n      return isBeforeInline(pos) || isAfterInline(pos);\n    };\n    var normalizePosition = function (forward, pos) {\n      if (!pos) {\n        return pos;\n      }\n      var container = pos.container(), offset = pos.offset();\n      if (forward) {\n        if (isCaretContainerInline(container)) {\n          if (isText$1(container.nextSibling)) {\n            return CaretPosition(container.nextSibling, 0);\n          } else {\n            return CaretPosition.after(container);\n          }\n        } else {\n          return isBeforeInline(pos) ? CaretPosition(container, offset + 1) : pos;\n        }\n      } else {\n        if (isCaretContainerInline(container)) {\n          if (isText$1(container.previousSibling)) {\n            return CaretPosition(container.previousSibling, container.previousSibling.data.length);\n          } else {\n            return CaretPosition.before(container);\n          }\n        } else {\n          return isAfterInline(pos) ? CaretPosition(container, offset - 1) : pos;\n        }\n      }\n    };\n    var normalizeForwards = curry(normalizePosition, true);\n    var normalizeBackwards = curry(normalizePosition, false);\n\n    var isBeforeRoot = function (rootNode) {\n      return function (elm) {\n        return eq$2(rootNode, SugarElement.fromDom(elm.dom.parentNode));\n      };\n    };\n    var getParentBlock$1 = function (rootNode, elm) {\n      return contains$2(rootNode, elm) ? closest(elm, function (element) {\n        return isTextBlock(element) || isListItem(element);\n      }, isBeforeRoot(rootNode)) : Optional.none();\n    };\n    var placeCaretInEmptyBody = function (editor) {\n      var body = editor.getBody();\n      var node = body.firstChild && editor.dom.isBlock(body.firstChild) ? body.firstChild : body;\n      editor.selection.setCursorLocation(node, 0);\n    };\n    var paddEmptyBody = function (editor) {\n      if (editor.dom.isEmpty(editor.getBody())) {\n        editor.setContent('');\n        placeCaretInEmptyBody(editor);\n      }\n    };\n    var willDeleteLastPositionInElement = function (forward, fromPos, elm) {\n      return lift2(firstPositionIn(elm), lastPositionIn(elm), function (firstPos, lastPos) {\n        var normalizedFirstPos = normalizePosition(true, firstPos);\n        var normalizedLastPos = normalizePosition(false, lastPos);\n        var normalizedFromPos = normalizePosition(false, fromPos);\n        if (forward) {\n          return nextPosition(elm, normalizedFromPos).exists(function (nextPos) {\n            return nextPos.isEqual(normalizedLastPos) && fromPos.isEqual(normalizedFirstPos);\n          });\n        } else {\n          return prevPosition(elm, normalizedFromPos).exists(function (prevPos) {\n            return prevPos.isEqual(normalizedFirstPos) && fromPos.isEqual(normalizedLastPos);\n          });\n        }\n      }).getOr(true);\n    };\n\n    var blockPosition = function (block, position) {\n      return {\n        block: block,\n        position: position\n      };\n    };\n    var blockBoundary = function (from, to) {\n      return {\n        from: from,\n        to: to\n      };\n    };\n    var getBlockPosition = function (rootNode, pos) {\n      var rootElm = SugarElement.fromDom(rootNode);\n      var containerElm = SugarElement.fromDom(pos.container());\n      return getParentBlock$1(rootElm, containerElm).map(function (block) {\n        return blockPosition(block, pos);\n      });\n    };\n    var isDifferentBlocks = function (blockBoundary) {\n      return eq$2(blockBoundary.from.block, blockBoundary.to.block) === false;\n    };\n    var hasSameParent = function (blockBoundary) {\n      return parent(blockBoundary.from.block).bind(function (parent1) {\n        return parent(blockBoundary.to.block).filter(function (parent2) {\n          return eq$2(parent1, parent2);\n        });\n      }).isSome();\n    };\n    var isEditable = function (blockBoundary) {\n      return isContentEditableFalse(blockBoundary.from.block.dom) === false && isContentEditableFalse(blockBoundary.to.block.dom) === false;\n    };\n    var skipLastBr = function (rootNode, forward, blockPosition) {\n      if (isBr(blockPosition.position.getNode()) && isEmpty(blockPosition.block) === false) {\n        return positionIn(false, blockPosition.block.dom).bind(function (lastPositionInBlock) {\n          if (lastPositionInBlock.isEqual(blockPosition.position)) {\n            return fromPosition(forward, rootNode, lastPositionInBlock).bind(function (to) {\n              return getBlockPosition(rootNode, to);\n            });\n          } else {\n            return Optional.some(blockPosition);\n          }\n        }).getOr(blockPosition);\n      } else {\n        return blockPosition;\n      }\n    };\n    var readFromRange = function (rootNode, forward, rng) {\n      var fromBlockPos = getBlockPosition(rootNode, CaretPosition.fromRangeStart(rng));\n      var toBlockPos = fromBlockPos.bind(function (blockPos) {\n        return fromPosition(forward, rootNode, blockPos.position).bind(function (to) {\n          return getBlockPosition(rootNode, to).map(function (blockPos) {\n            return skipLastBr(rootNode, forward, blockPos);\n          });\n        });\n      });\n      return lift2(fromBlockPos, toBlockPos, blockBoundary).filter(function (blockBoundary) {\n        return isDifferentBlocks(blockBoundary) && hasSameParent(blockBoundary) && isEditable(blockBoundary);\n      });\n    };\n    var read$3 = function (rootNode, forward, rng) {\n      return rng.collapsed ? readFromRange(rootNode, forward, rng) : Optional.none();\n    };\n\n    var getChildrenUntilBlockBoundary = function (block) {\n      var children$1 = children(block);\n      return findIndex(children$1, isBlock).fold(function () {\n        return children$1;\n      }, function (index) {\n        return children$1.slice(0, index);\n      });\n    };\n    var extractChildren = function (block) {\n      var children = getChildrenUntilBlockBoundary(block);\n      each(children, remove);\n      return children;\n    };\n    var removeEmptyRoot = function (rootNode, block) {\n      var parents = parentsAndSelf(block, rootNode);\n      return find(parents.reverse(), function (element) {\n        return isEmpty(element);\n      }).each(remove);\n    };\n    var isEmptyBefore = function (el) {\n      return filter(prevSiblings(el), function (el) {\n        return !isEmpty(el);\n      }).length === 0;\n    };\n    var nestedBlockMerge = function (rootNode, fromBlock, toBlock, insertionPoint) {\n      if (isEmpty(toBlock)) {\n        fillWithPaddingBr(toBlock);\n        return firstPositionIn(toBlock.dom);\n      }\n      if (isEmptyBefore(insertionPoint) && isEmpty(fromBlock)) {\n        before(insertionPoint, SugarElement.fromTag('br'));\n      }\n      var position = prevPosition(toBlock.dom, CaretPosition.before(insertionPoint.dom));\n      each(extractChildren(fromBlock), function (child) {\n        before(insertionPoint, child);\n      });\n      removeEmptyRoot(rootNode, fromBlock);\n      return position;\n    };\n    var sidelongBlockMerge = function (rootNode, fromBlock, toBlock) {\n      if (isEmpty(toBlock)) {\n        remove(toBlock);\n        if (isEmpty(fromBlock)) {\n          fillWithPaddingBr(fromBlock);\n        }\n        return firstPositionIn(fromBlock.dom);\n      }\n      var position = lastPositionIn(toBlock.dom);\n      each(extractChildren(fromBlock), function (child) {\n        append(toBlock, child);\n      });\n      removeEmptyRoot(rootNode, fromBlock);\n      return position;\n    };\n    var findInsertionPoint = function (toBlock, block) {\n      var parentsAndSelf$1 = parentsAndSelf(block, toBlock);\n      return Optional.from(parentsAndSelf$1[parentsAndSelf$1.length - 1]);\n    };\n    var getInsertionPoint = function (fromBlock, toBlock) {\n      return contains$2(toBlock, fromBlock) ? findInsertionPoint(toBlock, fromBlock) : Optional.none();\n    };\n    var trimBr = function (first, block) {\n      positionIn(first, block.dom).map(function (position) {\n        return position.getNode();\n      }).map(SugarElement.fromDom).filter(isBr$1).each(remove);\n    };\n    var mergeBlockInto = function (rootNode, fromBlock, toBlock) {\n      trimBr(true, fromBlock);\n      trimBr(false, toBlock);\n      return getInsertionPoint(fromBlock, toBlock).fold(curry(sidelongBlockMerge, rootNode, fromBlock, toBlock), curry(nestedBlockMerge, rootNode, fromBlock, toBlock));\n    };\n    var mergeBlocks = function (rootNode, forward, block1, block2) {\n      return forward ? mergeBlockInto(rootNode, block2, block1) : mergeBlockInto(rootNode, block1, block2);\n    };\n\n    var backspaceDelete$1 = function (editor, forward) {\n      var rootNode = SugarElement.fromDom(editor.getBody());\n      var position = read$3(rootNode.dom, forward, editor.selection.getRng()).bind(function (blockBoundary) {\n        return mergeBlocks(rootNode, forward, blockBoundary.from.block, blockBoundary.to.block);\n      });\n      position.each(function (pos) {\n        editor.selection.setRng(pos.toRange());\n      });\n      return position.isSome();\n    };\n\n    var deleteRangeMergeBlocks = function (rootNode, selection) {\n      var rng = selection.getRng();\n      return lift2(getParentBlock$1(rootNode, SugarElement.fromDom(rng.startContainer)), getParentBlock$1(rootNode, SugarElement.fromDom(rng.endContainer)), function (block1, block2) {\n        if (eq$2(block1, block2) === false) {\n          rng.deleteContents();\n          mergeBlocks(rootNode, true, block1, block2).each(function (pos) {\n            selection.setRng(pos.toRange());\n          });\n          return true;\n        } else {\n          return false;\n        }\n      }).getOr(false);\n    };\n    var isRawNodeInTable = function (root, rawNode) {\n      var node = SugarElement.fromDom(rawNode);\n      var isRoot = curry(eq$2, root);\n      return ancestor(node, isTableCell$1, isRoot).isSome();\n    };\n    var isSelectionInTable = function (root, rng) {\n      return isRawNodeInTable(root, rng.startContainer) || isRawNodeInTable(root, rng.endContainer);\n    };\n    var isEverythingSelected = function (root, rng) {\n      var noPrevious = prevPosition(root.dom, CaretPosition.fromRangeStart(rng)).isNone();\n      var noNext = nextPosition(root.dom, CaretPosition.fromRangeEnd(rng)).isNone();\n      return !isSelectionInTable(root, rng) && noPrevious && noNext;\n    };\n    var emptyEditor = function (editor) {\n      editor.setContent('');\n      editor.selection.setCursorLocation();\n      return true;\n    };\n    var deleteRange$1 = function (editor) {\n      var rootNode = SugarElement.fromDom(editor.getBody());\n      var rng = editor.selection.getRng();\n      return isEverythingSelected(rootNode, rng) ? emptyEditor(editor) : deleteRangeMergeBlocks(rootNode, editor.selection);\n    };\n    var backspaceDelete$2 = function (editor, _forward) {\n      return editor.selection.isCollapsed() ? false : deleteRange$1(editor);\n    };\n\n    var isContentEditableTrue$2 = isContentEditableTrue;\n    var isContentEditableFalse$7 = isContentEditableFalse;\n    var showCaret = function (direction, editor, node, before, scrollIntoView) {\n      return Optional.from(editor._selectionOverrides.showCaret(direction, node, before, scrollIntoView));\n    };\n    var getNodeRange = function (node) {\n      var rng = node.ownerDocument.createRange();\n      rng.selectNode(node);\n      return rng;\n    };\n    var selectNode = function (editor, node) {\n      var e = editor.fire('BeforeObjectSelected', { target: node });\n      if (e.isDefaultPrevented()) {\n        return Optional.none();\n      }\n      return Optional.some(getNodeRange(node));\n    };\n    var renderCaretAtRange = function (editor, range, scrollIntoView) {\n      var normalizedRange = normalizeRange(1, editor.getBody(), range);\n      var caretPosition = CaretPosition.fromRangeStart(normalizedRange);\n      var caretPositionNode = caretPosition.getNode();\n      if (isInlineFakeCaretTarget(caretPositionNode)) {\n        return showCaret(1, editor, caretPositionNode, !caretPosition.isAtEnd(), false);\n      }\n      var caretPositionBeforeNode = caretPosition.getNode(true);\n      if (isInlineFakeCaretTarget(caretPositionBeforeNode)) {\n        return showCaret(1, editor, caretPositionBeforeNode, false, false);\n      }\n      var ceRoot = editor.dom.getParent(caretPosition.getNode(), function (node) {\n        return isContentEditableFalse$7(node) || isContentEditableTrue$2(node);\n      });\n      if (isInlineFakeCaretTarget(ceRoot)) {\n        return showCaret(1, editor, ceRoot, false, scrollIntoView);\n      }\n      return Optional.none();\n    };\n    var renderRangeCaret = function (editor, range, scrollIntoView) {\n      return range.collapsed ? renderCaretAtRange(editor, range, scrollIntoView).getOr(range) : range;\n    };\n\n    var isBeforeBoundary = function (pos) {\n      return isBeforeContentEditableFalse(pos) || isBeforeMedia(pos);\n    };\n    var isAfterBoundary = function (pos) {\n      return isAfterContentEditableFalse(pos) || isAfterMedia(pos);\n    };\n    var trimEmptyTextNode$1 = function (dom, node) {\n      if (isText$1(node) && node.data.length === 0) {\n        dom.remove(node);\n      }\n    };\n    var deleteContentAndShowCaret = function (editor, range, node, direction, forward, peekCaretPosition) {\n      showCaret(direction, editor, peekCaretPosition.getNode(!forward), forward, true).each(function (caretRange) {\n        if (range.collapsed) {\n          var deleteRange = range.cloneRange();\n          if (forward) {\n            deleteRange.setEnd(caretRange.startContainer, caretRange.startOffset);\n          } else {\n            deleteRange.setStart(caretRange.endContainer, caretRange.endOffset);\n          }\n          deleteRange.deleteContents();\n        } else {\n          range.deleteContents();\n        }\n        editor.selection.setRng(caretRange);\n      });\n      trimEmptyTextNode$1(editor.dom, node);\n      return true;\n    };\n    var deleteBoundaryText = function (editor, forward) {\n      var range = editor.selection.getRng();\n      if (!isText$1(range.commonAncestorContainer)) {\n        return false;\n      }\n      var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n      var caretWalker = CaretWalker(editor.getBody());\n      var getNextPosFn = curry(getVisualCaretPosition, forward ? caretWalker.next : caretWalker.prev);\n      var isBeforeFn = forward ? isBeforeBoundary : isAfterBoundary;\n      var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n      var nextCaretPosition = normalizePosition(forward, getNextPosFn(caretPosition));\n      if (!nextCaretPosition || !isMoveInsideSameBlock(caretPosition, nextCaretPosition)) {\n        return false;\n      } else if (isBeforeFn(nextCaretPosition)) {\n        return deleteContentAndShowCaret(editor, range, caretPosition.getNode(), direction, forward, nextCaretPosition);\n      }\n      var peekCaretPosition = getNextPosFn(nextCaretPosition);\n      if (peekCaretPosition && isBeforeFn(peekCaretPosition)) {\n        if (isMoveInsideSameBlock(nextCaretPosition, peekCaretPosition)) {\n          return deleteContentAndShowCaret(editor, range, caretPosition.getNode(), direction, forward, peekCaretPosition);\n        }\n      }\n      return false;\n    };\n    var backspaceDelete$3 = function (editor, forward) {\n      return deleteBoundaryText(editor, forward);\n    };\n\n    var isCompoundElement = function (node) {\n      return isTableCell$1(SugarElement.fromDom(node)) || isListItem(SugarElement.fromDom(node));\n    };\n    var DeleteAction = Adt.generate([\n      { remove: ['element'] },\n      { moveToElement: ['element'] },\n      { moveToPosition: ['position'] }\n    ]);\n    var isAtContentEditableBlockCaret = function (forward, from) {\n      var elm = from.getNode(forward === false);\n      var caretLocation = forward ? 'after' : 'before';\n      return isElement$1(elm) && elm.getAttribute('data-mce-caret') === caretLocation;\n    };\n    var isDeleteFromCefDifferentBlocks = function (root, forward, from, to) {\n      var inSameBlock = function (elm) {\n        return isInline(SugarElement.fromDom(elm)) && !isInSameBlock(from, to, root);\n      };\n      return getRelativeCefElm(!forward, from).fold(function () {\n        return getRelativeCefElm(forward, to).fold(never, inSameBlock);\n      }, inSameBlock);\n    };\n    var deleteEmptyBlockOrMoveToCef = function (root, forward, from, to) {\n      var toCefElm = to.getNode(forward === false);\n      return getParentBlock$1(SugarElement.fromDom(root), SugarElement.fromDom(from.getNode())).map(function (blockElm) {\n        return isEmpty(blockElm) ? DeleteAction.remove(blockElm.dom) : DeleteAction.moveToElement(toCefElm);\n      }).orThunk(function () {\n        return Optional.some(DeleteAction.moveToElement(toCefElm));\n      });\n    };\n    var findCefPosition = function (root, forward, from) {\n      return fromPosition(forward, root, from).bind(function (to) {\n        if (isCompoundElement(to.getNode())) {\n          return Optional.none();\n        } else if (isDeleteFromCefDifferentBlocks(root, forward, from, to)) {\n          return Optional.none();\n        } else if (forward && isContentEditableFalse(to.getNode())) {\n          return deleteEmptyBlockOrMoveToCef(root, forward, from, to);\n        } else if (forward === false && isContentEditableFalse(to.getNode(true))) {\n          return deleteEmptyBlockOrMoveToCef(root, forward, from, to);\n        } else if (forward && isAfterContentEditableFalse(from)) {\n          return Optional.some(DeleteAction.moveToPosition(to));\n        } else if (forward === false && isBeforeContentEditableFalse(from)) {\n          return Optional.some(DeleteAction.moveToPosition(to));\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n    var getContentEditableBlockAction = function (forward, elm) {\n      if (forward && isContentEditableFalse(elm.nextSibling)) {\n        return Optional.some(DeleteAction.moveToElement(elm.nextSibling));\n      } else if (forward === false && isContentEditableFalse(elm.previousSibling)) {\n        return Optional.some(DeleteAction.moveToElement(elm.previousSibling));\n      } else {\n        return Optional.none();\n      }\n    };\n    var skipMoveToActionFromInlineCefToContent = function (root, from, deleteAction) {\n      return deleteAction.fold(function (elm) {\n        return Optional.some(DeleteAction.remove(elm));\n      }, function (elm) {\n        return Optional.some(DeleteAction.moveToElement(elm));\n      }, function (to) {\n        if (isInSameBlock(from, to, root)) {\n          return Optional.none();\n        } else {\n          return Optional.some(DeleteAction.moveToPosition(to));\n        }\n      });\n    };\n    var getContentEditableAction = function (root, forward, from) {\n      if (isAtContentEditableBlockCaret(forward, from)) {\n        return getContentEditableBlockAction(forward, from.getNode(forward === false)).fold(function () {\n          return findCefPosition(root, forward, from);\n        }, Optional.some);\n      } else {\n        return findCefPosition(root, forward, from).bind(function (deleteAction) {\n          return skipMoveToActionFromInlineCefToContent(root, from, deleteAction);\n        });\n      }\n    };\n    var read$4 = function (root, forward, rng) {\n      var normalizedRange = normalizeRange(forward ? 1 : -1, root, rng);\n      var from = CaretPosition.fromRangeStart(normalizedRange);\n      var rootElement = SugarElement.fromDom(root);\n      if (forward === false && isAfterContentEditableFalse(from)) {\n        return Optional.some(DeleteAction.remove(from.getNode(true)));\n      } else if (forward && isBeforeContentEditableFalse(from)) {\n        return Optional.some(DeleteAction.remove(from.getNode()));\n      } else if (forward === false && isBeforeContentEditableFalse(from) && isAfterBr(rootElement, from)) {\n        return findPreviousBr(rootElement, from).map(function (br) {\n          return DeleteAction.remove(br.getNode());\n        });\n      } else if (forward && isAfterContentEditableFalse(from) && isBeforeBr(rootElement, from)) {\n        return findNextBr(rootElement, from).map(function (br) {\n          return DeleteAction.remove(br.getNode());\n        });\n      } else {\n        return getContentEditableAction(root, forward, from);\n      }\n    };\n\n    var deleteElement$1 = function (editor, forward) {\n      return function (element) {\n        editor._selectionOverrides.hideFakeCaret();\n        deleteElement(editor, forward, SugarElement.fromDom(element));\n        return true;\n      };\n    };\n    var moveToElement = function (editor, forward) {\n      return function (element) {\n        var pos = forward ? CaretPosition.before(element) : CaretPosition.after(element);\n        editor.selection.setRng(pos.toRange());\n        return true;\n      };\n    };\n    var moveToPosition = function (editor) {\n      return function (pos) {\n        editor.selection.setRng(pos.toRange());\n        return true;\n      };\n    };\n    var getAncestorCe = function (editor, node) {\n      return Optional.from(getContentEditableRoot(editor.getBody(), node));\n    };\n    var backspaceDeleteCaret = function (editor, forward) {\n      var selectedNode = editor.selection.getNode();\n      return getAncestorCe(editor, selectedNode).filter(isContentEditableFalse).fold(function () {\n        return read$4(editor.getBody(), forward, editor.selection.getRng()).exists(function (deleteAction) {\n          return deleteAction.fold(deleteElement$1(editor, forward), moveToElement(editor, forward), moveToPosition(editor));\n        });\n      }, always);\n    };\n    var deleteOffscreenSelection = function (rootElement) {\n      each(descendants$1(rootElement, '.mce-offscreen-selection'), remove);\n    };\n    var backspaceDeleteRange = function (editor, forward) {\n      var selectedNode = editor.selection.getNode();\n      if (isContentEditableFalse(selectedNode)) {\n        var hasCefAncestor = getAncestorCe(editor, selectedNode.parentNode).filter(isContentEditableFalse);\n        return hasCefAncestor.fold(function () {\n          deleteOffscreenSelection(SugarElement.fromDom(editor.getBody()));\n          deleteElement(editor, forward, SugarElement.fromDom(editor.selection.getNode()));\n          paddEmptyBody(editor);\n          return true;\n        }, always);\n      }\n      return false;\n    };\n    var paddEmptyElement = function (editor) {\n      var dom = editor.dom, selection = editor.selection;\n      var ceRoot = getContentEditableRoot(editor.getBody(), selection.getNode());\n      if (isContentEditableTrue(ceRoot) && dom.isBlock(ceRoot) && dom.isEmpty(ceRoot)) {\n        var br = dom.create('br', { 'data-mce-bogus': '1' });\n        dom.setHTML(ceRoot, '');\n        ceRoot.appendChild(br);\n        selection.setRng(CaretPosition.before(br).toRange());\n      }\n      return true;\n    };\n    var backspaceDelete$4 = function (editor, forward) {\n      if (editor.selection.isCollapsed()) {\n        return backspaceDeleteCaret(editor, forward);\n      } else {\n        return backspaceDeleteRange(editor, forward);\n      }\n    };\n\n    var deleteCaret$1 = function (editor, forward) {\n      var fromPos = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return fromPosition(forward, editor.getBody(), fromPos).filter(function (pos) {\n        return forward ? isBeforeImageBlock(pos) : isAfterImageBlock(pos);\n      }).bind(function (pos) {\n        return Optional.from(getChildNodeAtRelativeOffset(forward ? 0 : -1, pos));\n      }).exists(function (elm) {\n        editor.selection.select(elm);\n        return true;\n      });\n    };\n    var backspaceDelete$5 = function (editor, forward) {\n      return editor.selection.isCollapsed() ? deleteCaret$1(editor, forward) : false;\n    };\n\n    var isText$8 = isText$1;\n    var startsWithCaretContainer$1 = function (node) {\n      return isText$8(node) && node.data[0] === ZWSP;\n    };\n    var endsWithCaretContainer$1 = function (node) {\n      return isText$8(node) && node.data[node.data.length - 1] === ZWSP;\n    };\n    var createZwsp = function (node) {\n      return node.ownerDocument.createTextNode(ZWSP);\n    };\n    var insertBefore$1 = function (node) {\n      if (isText$8(node.previousSibling)) {\n        if (endsWithCaretContainer$1(node.previousSibling)) {\n          return node.previousSibling;\n        } else {\n          node.previousSibling.appendData(ZWSP);\n          return node.previousSibling;\n        }\n      } else if (isText$8(node)) {\n        if (startsWithCaretContainer$1(node)) {\n          return node;\n        } else {\n          node.insertData(0, ZWSP);\n          return node;\n        }\n      } else {\n        var newNode = createZwsp(node);\n        node.parentNode.insertBefore(newNode, node);\n        return newNode;\n      }\n    };\n    var insertAfter$1 = function (node) {\n      if (isText$8(node.nextSibling)) {\n        if (startsWithCaretContainer$1(node.nextSibling)) {\n          return node.nextSibling;\n        } else {\n          node.nextSibling.insertData(0, ZWSP);\n          return node.nextSibling;\n        }\n      } else if (isText$8(node)) {\n        if (endsWithCaretContainer$1(node)) {\n          return node;\n        } else {\n          node.appendData(ZWSP);\n          return node;\n        }\n      } else {\n        var newNode = createZwsp(node);\n        if (node.nextSibling) {\n          node.parentNode.insertBefore(newNode, node.nextSibling);\n        } else {\n          node.parentNode.appendChild(newNode);\n        }\n        return newNode;\n      }\n    };\n    var insertInline$1 = function (before, node) {\n      return before ? insertBefore$1(node) : insertAfter$1(node);\n    };\n    var insertInlineBefore = curry(insertInline$1, true);\n    var insertInlineAfter = curry(insertInline$1, false);\n\n    var insertInlinePos = function (pos, before) {\n      if (isText$1(pos.container())) {\n        return insertInline$1(before, pos.container());\n      } else {\n        return insertInline$1(before, pos.getNode());\n      }\n    };\n    var isPosCaretContainer = function (pos, caret) {\n      var caretNode = caret.get();\n      return caretNode && pos.container() === caretNode && isCaretContainerInline(caretNode);\n    };\n    var renderCaret = function (caret, location) {\n      return location.fold(function (element) {\n        remove$5(caret.get());\n        var text = insertInlineBefore(element);\n        caret.set(text);\n        return Optional.some(CaretPosition(text, text.length - 1));\n      }, function (element) {\n        return firstPositionIn(element).map(function (pos) {\n          if (!isPosCaretContainer(pos, caret)) {\n            remove$5(caret.get());\n            var text = insertInlinePos(pos, true);\n            caret.set(text);\n            return CaretPosition(text, 1);\n          } else {\n            return CaretPosition(caret.get(), 1);\n          }\n        });\n      }, function (element) {\n        return lastPositionIn(element).map(function (pos) {\n          if (!isPosCaretContainer(pos, caret)) {\n            remove$5(caret.get());\n            var text = insertInlinePos(pos, false);\n            caret.set(text);\n            return CaretPosition(text, text.length - 1);\n          } else {\n            return CaretPosition(caret.get(), caret.get().length - 1);\n          }\n        });\n      }, function (element) {\n        remove$5(caret.get());\n        var text = insertInlineAfter(element);\n        caret.set(text);\n        return Optional.some(CaretPosition(text, 1));\n      });\n    };\n\n    var evaluateUntil = function (fns, args) {\n      for (var i = 0; i < fns.length; i++) {\n        var result = fns[i].apply(null, args);\n        if (result.isSome()) {\n          return result;\n        }\n      }\n      return Optional.none();\n    };\n\n    var Location = Adt.generate([\n      { before: ['element'] },\n      { start: ['element'] },\n      { end: ['element'] },\n      { after: ['element'] }\n    ]);\n    var rescope = function (rootNode, node) {\n      var parentBlock = getParentBlock(node, rootNode);\n      return parentBlock ? parentBlock : rootNode;\n    };\n    var before$4 = function (isInlineTarget, rootNode, pos) {\n      var nPos = normalizeForwards(pos);\n      var scope = rescope(rootNode, nPos.container());\n      return findRootInline(isInlineTarget, scope, nPos).fold(function () {\n        return nextPosition(scope, nPos).bind(curry(findRootInline, isInlineTarget, scope)).map(function (inline) {\n          return Location.before(inline);\n        });\n      }, Optional.none);\n    };\n    var isNotInsideFormatCaretContainer = function (rootNode, elm) {\n      return getParentCaretContainer(rootNode, elm) === null;\n    };\n    var findInsideRootInline = function (isInlineTarget, rootNode, pos) {\n      return findRootInline(isInlineTarget, rootNode, pos).filter(curry(isNotInsideFormatCaretContainer, rootNode));\n    };\n    var start = function (isInlineTarget, rootNode, pos) {\n      var nPos = normalizeBackwards(pos);\n      return findInsideRootInline(isInlineTarget, rootNode, nPos).bind(function (inline) {\n        var prevPos = prevPosition(inline, nPos);\n        return prevPos.isNone() ? Optional.some(Location.start(inline)) : Optional.none();\n      });\n    };\n    var end = function (isInlineTarget, rootNode, pos) {\n      var nPos = normalizeForwards(pos);\n      return findInsideRootInline(isInlineTarget, rootNode, nPos).bind(function (inline) {\n        var nextPos = nextPosition(inline, nPos);\n        return nextPos.isNone() ? Optional.some(Location.end(inline)) : Optional.none();\n      });\n    };\n    var after$3 = function (isInlineTarget, rootNode, pos) {\n      var nPos = normalizeBackwards(pos);\n      var scope = rescope(rootNode, nPos.container());\n      return findRootInline(isInlineTarget, scope, nPos).fold(function () {\n        return prevPosition(scope, nPos).bind(curry(findRootInline, isInlineTarget, scope)).map(function (inline) {\n          return Location.after(inline);\n        });\n      }, Optional.none);\n    };\n    var isValidLocation = function (location) {\n      return isRtl$1(getElement(location)) === false;\n    };\n    var readLocation = function (isInlineTarget, rootNode, pos) {\n      var location = evaluateUntil([\n        before$4,\n        start,\n        end,\n        after$3\n      ], [\n        isInlineTarget,\n        rootNode,\n        pos\n      ]);\n      return location.filter(isValidLocation);\n    };\n    var getElement = function (location) {\n      return location.fold(identity, identity, identity, identity);\n    };\n    var getName = function (location) {\n      return location.fold(constant('before'), constant('start'), constant('end'), constant('after'));\n    };\n    var outside = function (location) {\n      return location.fold(Location.before, Location.before, Location.after, Location.after);\n    };\n    var inside = function (location) {\n      return location.fold(Location.start, Location.start, Location.end, Location.end);\n    };\n    var isEq$5 = function (location1, location2) {\n      return getName(location1) === getName(location2) && getElement(location1) === getElement(location2);\n    };\n    var betweenInlines = function (forward, isInlineTarget, rootNode, from, to, location) {\n      return lift2(findRootInline(isInlineTarget, rootNode, from), findRootInline(isInlineTarget, rootNode, to), function (fromInline, toInline) {\n        if (fromInline !== toInline && hasSameParentBlock(rootNode, fromInline, toInline)) {\n          return Location.after(forward ? fromInline : toInline);\n        } else {\n          return location;\n        }\n      }).getOr(location);\n    };\n    var skipNoMovement = function (fromLocation, toLocation) {\n      return fromLocation.fold(always, function (fromLocation) {\n        return !isEq$5(fromLocation, toLocation);\n      });\n    };\n    var findLocationTraverse = function (forward, isInlineTarget, rootNode, fromLocation, pos) {\n      var from = normalizePosition(forward, pos);\n      var to = fromPosition(forward, rootNode, from).map(curry(normalizePosition, forward));\n      var location = to.fold(function () {\n        return fromLocation.map(outside);\n      }, function (to) {\n        return readLocation(isInlineTarget, rootNode, to).map(curry(betweenInlines, forward, isInlineTarget, rootNode, from, to)).filter(curry(skipNoMovement, fromLocation));\n      });\n      return location.filter(isValidLocation);\n    };\n    var findLocationSimple = function (forward, location) {\n      if (forward) {\n        return location.fold(compose(Optional.some, Location.start), Optional.none, compose(Optional.some, Location.after), Optional.none);\n      } else {\n        return location.fold(Optional.none, compose(Optional.some, Location.before), Optional.none, compose(Optional.some, Location.end));\n      }\n    };\n    var findLocation = function (forward, isInlineTarget, rootNode, pos) {\n      var from = normalizePosition(forward, pos);\n      var fromLocation = readLocation(isInlineTarget, rootNode, from);\n      return readLocation(isInlineTarget, rootNode, from).bind(curry(findLocationSimple, forward)).orThunk(function () {\n        return findLocationTraverse(forward, isInlineTarget, rootNode, fromLocation, pos);\n      });\n    };\n    var prevLocation = curry(findLocation, false);\n    var nextLocation = curry(findLocation, true);\n\n    var hasSelectionModifyApi = function (editor) {\n      return isFunction(editor.selection.getSel().modify);\n    };\n    var moveRel = function (forward, selection, pos) {\n      var delta = forward ? 1 : -1;\n      selection.setRng(CaretPosition(pos.container(), pos.offset() + delta).toRange());\n      selection.getSel().modify('move', forward ? 'forward' : 'backward', 'word');\n      return true;\n    };\n    var moveByWord = function (forward, editor) {\n      var rng = editor.selection.getRng();\n      var pos = forward ? CaretPosition.fromRangeEnd(rng) : CaretPosition.fromRangeStart(rng);\n      if (!hasSelectionModifyApi(editor)) {\n        return false;\n      } else if (forward && isBeforeInline(pos)) {\n        return moveRel(true, editor.selection, pos);\n      } else if (!forward && isAfterInline(pos)) {\n        return moveRel(false, editor.selection, pos);\n      } else {\n        return false;\n      }\n    };\n\n    var BreakType;\n    (function (BreakType) {\n      BreakType[BreakType['Br'] = 0] = 'Br';\n      BreakType[BreakType['Block'] = 1] = 'Block';\n      BreakType[BreakType['Wrap'] = 2] = 'Wrap';\n      BreakType[BreakType['Eol'] = 3] = 'Eol';\n    }(BreakType || (BreakType = {})));\n    var flip = function (direction, positions) {\n      return direction === HDirection.Backwards ? reverse(positions) : positions;\n    };\n    var walk$3 = function (direction, caretWalker, pos) {\n      return direction === HDirection.Forwards ? caretWalker.next(pos) : caretWalker.prev(pos);\n    };\n    var getBreakType = function (scope, direction, currentPos, nextPos) {\n      if (isBr(nextPos.getNode(direction === HDirection.Forwards))) {\n        return BreakType.Br;\n      } else if (isInSameBlock(currentPos, nextPos) === false) {\n        return BreakType.Block;\n      } else {\n        return BreakType.Wrap;\n      }\n    };\n    var getPositionsUntil = function (predicate, direction, scope, start) {\n      var caretWalker = CaretWalker(scope);\n      var currentPos = start, nextPos;\n      var positions = [];\n      while (currentPos) {\n        nextPos = walk$3(direction, caretWalker, currentPos);\n        if (!nextPos) {\n          break;\n        }\n        if (isBr(nextPos.getNode(false))) {\n          if (direction === HDirection.Forwards) {\n            return {\n              positions: flip(direction, positions).concat([nextPos]),\n              breakType: BreakType.Br,\n              breakAt: Optional.some(nextPos)\n            };\n          } else {\n            return {\n              positions: flip(direction, positions),\n              breakType: BreakType.Br,\n              breakAt: Optional.some(nextPos)\n            };\n          }\n        }\n        if (!nextPos.isVisible()) {\n          currentPos = nextPos;\n          continue;\n        }\n        if (predicate(currentPos, nextPos)) {\n          var breakType = getBreakType(scope, direction, currentPos, nextPos);\n          return {\n            positions: flip(direction, positions),\n            breakType: breakType,\n            breakAt: Optional.some(nextPos)\n          };\n        }\n        positions.push(nextPos);\n        currentPos = nextPos;\n      }\n      return {\n        positions: flip(direction, positions),\n        breakType: BreakType.Eol,\n        breakAt: Optional.none()\n      };\n    };\n    var getAdjacentLinePositions = function (direction, getPositionsUntilBreak, scope, start) {\n      return getPositionsUntilBreak(scope, start).breakAt.map(function (pos) {\n        var positions = getPositionsUntilBreak(scope, pos).positions;\n        return direction === HDirection.Backwards ? positions.concat(pos) : [pos].concat(positions);\n      }).getOr([]);\n    };\n    var findClosestHorizontalPositionFromPoint = function (positions, x) {\n      return foldl(positions, function (acc, newPos) {\n        return acc.fold(function () {\n          return Optional.some(newPos);\n        }, function (lastPos) {\n          return lift2(head(lastPos.getClientRects()), head(newPos.getClientRects()), function (lastRect, newRect) {\n            var lastDist = Math.abs(x - lastRect.left);\n            var newDist = Math.abs(x - newRect.left);\n            return newDist <= lastDist ? newPos : lastPos;\n          }).or(acc);\n        });\n      }, Optional.none());\n    };\n    var findClosestHorizontalPosition = function (positions, pos) {\n      return head(pos.getClientRects()).bind(function (targetRect) {\n        return findClosestHorizontalPositionFromPoint(positions, targetRect.left);\n      });\n    };\n    var getPositionsUntilPreviousLine = curry(getPositionsUntil, CaretPosition.isAbove, -1);\n    var getPositionsUntilNextLine = curry(getPositionsUntil, CaretPosition.isBelow, 1);\n    var isAtFirstLine = function (scope, pos) {\n      return getPositionsUntilPreviousLine(scope, pos).breakAt.isNone();\n    };\n    var isAtLastLine = function (scope, pos) {\n      return getPositionsUntilNextLine(scope, pos).breakAt.isNone();\n    };\n    var getPositionsAbove = curry(getAdjacentLinePositions, -1, getPositionsUntilPreviousLine);\n    var getPositionsBelow = curry(getAdjacentLinePositions, 1, getPositionsUntilNextLine);\n    var getFirstLinePositions = function (scope) {\n      return firstPositionIn(scope).map(function (pos) {\n        return [pos].concat(getPositionsUntilNextLine(scope, pos).positions);\n      }).getOr([]);\n    };\n    var getLastLinePositions = function (scope) {\n      return lastPositionIn(scope).map(function (pos) {\n        return getPositionsUntilPreviousLine(scope, pos).positions.concat(pos);\n      }).getOr([]);\n    };\n\n    var getNodeClientRects = function (node) {\n      var toArrayWithNode = function (clientRects) {\n        return map(clientRects, function (clientRect) {\n          clientRect = clone$2(clientRect);\n          clientRect.node = node;\n          return clientRect;\n        });\n      };\n      if (isElement$1(node)) {\n        return toArrayWithNode(node.getClientRects());\n      }\n      if (isText$1(node)) {\n        var rng = node.ownerDocument.createRange();\n        rng.setStart(node, 0);\n        rng.setEnd(node, node.data.length);\n        return toArrayWithNode(rng.getClientRects());\n      }\n    };\n    var getClientRects = function (nodes) {\n      return bind(nodes, getNodeClientRects);\n    };\n\n    var VDirection;\n    (function (VDirection) {\n      VDirection[VDirection['Up'] = -1] = 'Up';\n      VDirection[VDirection['Down'] = 1] = 'Down';\n    }(VDirection || (VDirection = {})));\n    var findUntil$1 = function (direction, root, predicateFn, node) {\n      while (node = findNode(node, direction, isEditableCaretCandidate, root)) {\n        if (predicateFn(node)) {\n          return;\n        }\n      }\n    };\n    var walkUntil = function (direction, isAboveFn, isBeflowFn, root, predicateFn, caretPosition) {\n      var line = 0;\n      var result = [];\n      var add = function (node) {\n        var i, clientRect, clientRects;\n        clientRects = getClientRects([node]);\n        if (direction === -1) {\n          clientRects = clientRects.reverse();\n        }\n        for (i = 0; i < clientRects.length; i++) {\n          clientRect = clientRects[i];\n          if (isBeflowFn(clientRect, targetClientRect)) {\n            continue;\n          }\n          if (result.length > 0 && isAboveFn(clientRect, last$1(result))) {\n            line++;\n          }\n          clientRect.line = line;\n          if (predicateFn(clientRect)) {\n            return true;\n          }\n          result.push(clientRect);\n        }\n      };\n      var targetClientRect = last$1(caretPosition.getClientRects());\n      if (!targetClientRect) {\n        return result;\n      }\n      var node = caretPosition.getNode();\n      add(node);\n      findUntil$1(direction, root, add, node);\n      return result;\n    };\n    var aboveLineNumber = function (lineNumber, clientRect) {\n      return clientRect.line > lineNumber;\n    };\n    var isLineNumber = function (lineNumber, clientRect) {\n      return clientRect.line === lineNumber;\n    };\n    var upUntil = curry(walkUntil, VDirection.Up, isAbove, isBelow);\n    var downUntil = curry(walkUntil, VDirection.Down, isBelow, isAbove);\n    var positionsUntil = function (direction, root, predicateFn, node) {\n      var caretWalker = CaretWalker(root);\n      var walkFn, isBelowFn, isAboveFn, caretPosition;\n      var result = [];\n      var line = 0, clientRect;\n      var getClientRect = function (caretPosition) {\n        if (direction === 1) {\n          return last$1(caretPosition.getClientRects());\n        }\n        return last$1(caretPosition.getClientRects());\n      };\n      if (direction === 1) {\n        walkFn = caretWalker.next;\n        isBelowFn = isBelow;\n        isAboveFn = isAbove;\n        caretPosition = CaretPosition.after(node);\n      } else {\n        walkFn = caretWalker.prev;\n        isBelowFn = isAbove;\n        isAboveFn = isBelow;\n        caretPosition = CaretPosition.before(node);\n      }\n      var targetClientRect = getClientRect(caretPosition);\n      do {\n        if (!caretPosition.isVisible()) {\n          continue;\n        }\n        clientRect = getClientRect(caretPosition);\n        if (isAboveFn(clientRect, targetClientRect)) {\n          continue;\n        }\n        if (result.length > 0 && isBelowFn(clientRect, last$1(result))) {\n          line++;\n        }\n        clientRect = clone$2(clientRect);\n        clientRect.position = caretPosition;\n        clientRect.line = line;\n        if (predicateFn(clientRect)) {\n          return result;\n        }\n        result.push(clientRect);\n      } while (caretPosition = walkFn(caretPosition));\n      return result;\n    };\n    var isAboveLine = function (lineNumber) {\n      return function (clientRect) {\n        return aboveLineNumber(lineNumber, clientRect);\n      };\n    };\n    var isLine = function (lineNumber) {\n      return function (clientRect) {\n        return isLineNumber(lineNumber, clientRect);\n      };\n    };\n\n    var isContentEditableFalse$8 = isContentEditableFalse;\n    var findNode$1 = findNode;\n    var distanceToRectLeft = function (clientRect, clientX) {\n      return Math.abs(clientRect.left - clientX);\n    };\n    var distanceToRectRight = function (clientRect, clientX) {\n      return Math.abs(clientRect.right - clientX);\n    };\n    var isInsideX = function (clientX, clientRect) {\n      return clientX >= clientRect.left && clientX <= clientRect.right;\n    };\n    var isInsideY = function (clientY, clientRect) {\n      return clientY >= clientRect.top && clientY <= clientRect.bottom;\n    };\n    var findClosestClientRect = function (clientRects, clientX) {\n      return reduce(clientRects, function (oldClientRect, clientRect) {\n        var oldDistance = Math.min(distanceToRectLeft(oldClientRect, clientX), distanceToRectRight(oldClientRect, clientX));\n        var newDistance = Math.min(distanceToRectLeft(clientRect, clientX), distanceToRectRight(clientRect, clientX));\n        if (isInsideX(clientX, clientRect)) {\n          return clientRect;\n        }\n        if (isInsideX(clientX, oldClientRect)) {\n          return oldClientRect;\n        }\n        if (newDistance === oldDistance && isContentEditableFalse$8(clientRect.node)) {\n          return clientRect;\n        }\n        if (newDistance < oldDistance) {\n          return clientRect;\n        }\n        return oldClientRect;\n      });\n    };\n    var walkUntil$1 = function (direction, root, predicateFn, startNode, includeChildren) {\n      var node = findNode$1(startNode, direction, isEditableCaretCandidate, root, !includeChildren);\n      do {\n        if (!node || predicateFn(node)) {\n          return;\n        }\n      } while (node = findNode$1(node, direction, isEditableCaretCandidate, root));\n    };\n    var findLineNodeRects = function (root, targetNodeRect, includeChildren) {\n      if (includeChildren === void 0) {\n        includeChildren = true;\n      }\n      var clientRects = [];\n      var collect = function (checkPosFn, node) {\n        var lineRects = filter(getClientRects([node]), function (clientRect) {\n          return !checkPosFn(clientRect, targetNodeRect);\n        });\n        clientRects = clientRects.concat(lineRects);\n        return lineRects.length === 0;\n      };\n      clientRects.push(targetNodeRect);\n      walkUntil$1(VDirection.Up, root, curry(collect, isAbove), targetNodeRect.node, includeChildren);\n      walkUntil$1(VDirection.Down, root, curry(collect, isBelow), targetNodeRect.node, includeChildren);\n      return clientRects;\n    };\n    var getFakeCaretTargets = function (root) {\n      return filter(from$1(root.getElementsByTagName('*')), isFakeCaretTarget);\n    };\n    var caretInfo = function (clientRect, clientX) {\n      return {\n        node: clientRect.node,\n        before: distanceToRectLeft(clientRect, clientX) < distanceToRectRight(clientRect, clientX)\n      };\n    };\n    var closestFakeCaret = function (root, clientX, clientY) {\n      var fakeTargetNodeRects = getClientRects(getFakeCaretTargets(root));\n      var targetNodeRects = filter(fakeTargetNodeRects, curry(isInsideY, clientY));\n      var closestNodeRect = findClosestClientRect(targetNodeRects, clientX);\n      if (closestNodeRect) {\n        var includeChildren = !isTable(closestNodeRect.node) && !isMedia(closestNodeRect.node);\n        closestNodeRect = findClosestClientRect(findLineNodeRects(root, closestNodeRect, includeChildren), clientX);\n        if (closestNodeRect && isFakeCaretTarget(closestNodeRect.node)) {\n          return caretInfo(closestNodeRect, clientX);\n        }\n      }\n      return null;\n    };\n\n    var moveToRange = function (editor, rng) {\n      editor.selection.setRng(rng);\n      scrollRangeIntoView(editor, editor.selection.getRng());\n    };\n    var renderRangeCaretOpt = function (editor, range, scrollIntoView) {\n      return Optional.some(renderRangeCaret(editor, range, scrollIntoView));\n    };\n    var moveHorizontally = function (editor, direction, range, isBefore, isAfter, isElement) {\n      var forwards = direction === HDirection.Forwards;\n      var caretWalker = CaretWalker(editor.getBody());\n      var getNextPosFn = curry(getVisualCaretPosition, forwards ? caretWalker.next : caretWalker.prev);\n      var isBeforeFn = forwards ? isBefore : isAfter;\n      if (!range.collapsed) {\n        var node = getSelectedNode(range);\n        if (isElement(node)) {\n          return showCaret(direction, editor, node, direction === HDirection.Backwards, false);\n        }\n      }\n      var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n      if (isBeforeFn(caretPosition)) {\n        return selectNode(editor, caretPosition.getNode(!forwards));\n      }\n      var nextCaretPosition = normalizePosition(forwards, getNextPosFn(caretPosition));\n      var rangeIsInContainerBlock = isRangeInCaretContainerBlock(range);\n      if (!nextCaretPosition) {\n        return rangeIsInContainerBlock ? Optional.some(range) : Optional.none();\n      }\n      if (isBeforeFn(nextCaretPosition)) {\n        return showCaret(direction, editor, nextCaretPosition.getNode(!forwards), forwards, false);\n      }\n      var peekCaretPosition = getNextPosFn(nextCaretPosition);\n      if (peekCaretPosition && isBeforeFn(peekCaretPosition)) {\n        if (isMoveInsideSameBlock(nextCaretPosition, peekCaretPosition)) {\n          return showCaret(direction, editor, peekCaretPosition.getNode(!forwards), forwards, false);\n        }\n      }\n      if (rangeIsInContainerBlock) {\n        return renderRangeCaretOpt(editor, nextCaretPosition.toRange(), false);\n      }\n      return Optional.none();\n    };\n    var moveVertically = function (editor, direction, range, isBefore, isAfter, isElement) {\n      var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n      var caretClientRect = last$1(caretPosition.getClientRects());\n      var forwards = direction === VDirection.Down;\n      if (!caretClientRect) {\n        return Optional.none();\n      }\n      var walkerFn = forwards ? downUntil : upUntil;\n      var linePositions = walkerFn(editor.getBody(), isAboveLine(1), caretPosition);\n      var nextLinePositions = filter(linePositions, isLine(1));\n      var clientX = caretClientRect.left;\n      var nextLineRect = findClosestClientRect(nextLinePositions, clientX);\n      if (nextLineRect && isElement(nextLineRect.node)) {\n        var dist1 = Math.abs(clientX - nextLineRect.left);\n        var dist2 = Math.abs(clientX - nextLineRect.right);\n        return showCaret(direction, editor, nextLineRect.node, dist1 < dist2, false);\n      }\n      var currentNode;\n      if (isBefore(caretPosition)) {\n        currentNode = caretPosition.getNode();\n      } else if (isAfter(caretPosition)) {\n        currentNode = caretPosition.getNode(true);\n      } else {\n        currentNode = getSelectedNode(range);\n      }\n      if (currentNode) {\n        var caretPositions = positionsUntil(direction, editor.getBody(), isAboveLine(1), currentNode);\n        var closestNextLineRect = findClosestClientRect(filter(caretPositions, isLine(1)), clientX);\n        if (closestNextLineRect) {\n          return renderRangeCaretOpt(editor, closestNextLineRect.position.toRange(), false);\n        }\n        closestNextLineRect = last$1(filter(caretPositions, isLine(0)));\n        if (closestNextLineRect) {\n          return renderRangeCaretOpt(editor, closestNextLineRect.position.toRange(), false);\n        }\n      }\n      if (nextLinePositions.length === 0) {\n        return getLineEndPoint(editor, forwards).filter(forwards ? isAfter : isBefore).map(function (pos) {\n          return renderRangeCaret(editor, pos.toRange(), false);\n        });\n      }\n      return Optional.none();\n    };\n    var getLineEndPoint = function (editor, forward) {\n      var rng = editor.selection.getRng();\n      var body = editor.getBody();\n      if (forward) {\n        var from = CaretPosition.fromRangeEnd(rng);\n        var result = getPositionsUntilNextLine(body, from);\n        return last(result.positions);\n      } else {\n        var from = CaretPosition.fromRangeStart(rng);\n        var result = getPositionsUntilPreviousLine(body, from);\n        return head(result.positions);\n      }\n    };\n    var moveToLineEndPoint = function (editor, forward, isElementPosition) {\n      return getLineEndPoint(editor, forward).filter(isElementPosition).exists(function (pos) {\n        editor.selection.setRng(pos.toRange());\n        return true;\n      });\n    };\n\n    var setCaretPosition = function (editor, pos) {\n      var rng = editor.dom.createRng();\n      rng.setStart(pos.container(), pos.offset());\n      rng.setEnd(pos.container(), pos.offset());\n      editor.selection.setRng(rng);\n    };\n    var setSelected = function (state, elm) {\n      if (state) {\n        elm.setAttribute('data-mce-selected', 'inline-boundary');\n      } else {\n        elm.removeAttribute('data-mce-selected');\n      }\n    };\n    var renderCaretLocation = function (editor, caret, location) {\n      return renderCaret(caret, location).map(function (pos) {\n        setCaretPosition(editor, pos);\n        return location;\n      });\n    };\n    var findLocation$1 = function (editor, caret, forward) {\n      var rootNode = editor.getBody();\n      var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n      var isInlineTarget$1 = curry(isInlineTarget, editor);\n      var location = findLocation(forward, isInlineTarget$1, rootNode, from);\n      return location.bind(function (location) {\n        return renderCaretLocation(editor, caret, location);\n      });\n    };\n    var toggleInlines = function (isInlineTarget, dom, elms) {\n      var inlineBoundaries = map(descendants$1(SugarElement.fromDom(dom.getRoot()), '*[data-mce-selected=\"inline-boundary\"]'), function (e) {\n        return e.dom;\n      });\n      var selectedInlines = filter(inlineBoundaries, isInlineTarget);\n      var targetInlines = filter(elms, isInlineTarget);\n      each(difference(selectedInlines, targetInlines), curry(setSelected, false));\n      each(difference(targetInlines, selectedInlines), curry(setSelected, true));\n    };\n    var safeRemoveCaretContainer = function (editor, caret) {\n      if (editor.selection.isCollapsed() && editor.composing !== true && caret.get()) {\n        var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n        if (CaretPosition.isTextPosition(pos) && isAtZwsp(pos) === false) {\n          setCaretPosition(editor, removeAndReposition(caret.get(), pos));\n          caret.set(null);\n        }\n      }\n    };\n    var renderInsideInlineCaret = function (isInlineTarget, editor, caret, elms) {\n      if (editor.selection.isCollapsed()) {\n        var inlines = filter(elms, isInlineTarget);\n        each(inlines, function (_inline) {\n          var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n          readLocation(isInlineTarget, editor.getBody(), pos).bind(function (location) {\n            return renderCaretLocation(editor, caret, location);\n          });\n        });\n      }\n    };\n    var move = function (editor, caret, forward) {\n      return isInlineBoundariesEnabled(editor) ? findLocation$1(editor, caret, forward).isSome() : false;\n    };\n    var moveWord = function (forward, editor, _caret) {\n      return isInlineBoundariesEnabled(editor) ? moveByWord(forward, editor) : false;\n    };\n    var setupSelectedState = function (editor) {\n      var caret = Cell(null);\n      var isInlineTarget$1 = curry(isInlineTarget, editor);\n      editor.on('NodeChange', function (e) {\n        if (isInlineBoundariesEnabled(editor) && !(Env.browser.isIE() && e.initial)) {\n          toggleInlines(isInlineTarget$1, editor.dom, e.parents);\n          safeRemoveCaretContainer(editor, caret);\n          renderInsideInlineCaret(isInlineTarget$1, editor, caret, e.parents);\n        }\n      });\n      return caret;\n    };\n    var moveNextWord = curry(moveWord, true);\n    var movePrevWord = curry(moveWord, false);\n    var moveToLineEndPoint$1 = function (editor, forward, caret) {\n      if (isInlineBoundariesEnabled(editor)) {\n        var linePoint = getLineEndPoint(editor, forward).getOrThunk(function () {\n          var rng = editor.selection.getRng();\n          return forward ? CaretPosition.fromRangeEnd(rng) : CaretPosition.fromRangeStart(rng);\n        });\n        return readLocation(curry(isInlineTarget, editor), editor.getBody(), linePoint).exists(function (loc) {\n          var outsideLoc = outside(loc);\n          return renderCaret(caret, outsideLoc).exists(function (pos) {\n            setCaretPosition(editor, pos);\n            return true;\n          });\n        });\n      } else {\n        return false;\n      }\n    };\n\n    var rangeFromPositions = function (from, to) {\n      var range = document.createRange();\n      range.setStart(from.container(), from.offset());\n      range.setEnd(to.container(), to.offset());\n      return range;\n    };\n    var hasOnlyTwoOrLessPositionsLeft = function (elm) {\n      return lift2(firstPositionIn(elm), lastPositionIn(elm), function (firstPos, lastPos) {\n        var normalizedFirstPos = normalizePosition(true, firstPos);\n        var normalizedLastPos = normalizePosition(false, lastPos);\n        return nextPosition(elm, normalizedFirstPos).forall(function (pos) {\n          return pos.isEqual(normalizedLastPos);\n        });\n      }).getOr(true);\n    };\n    var setCaretLocation = function (editor, caret) {\n      return function (location) {\n        return renderCaret(caret, location).exists(function (pos) {\n          setCaretPosition(editor, pos);\n          return true;\n        });\n      };\n    };\n    var deleteFromTo = function (editor, caret, from, to) {\n      var rootNode = editor.getBody();\n      var isInlineTarget$1 = curry(isInlineTarget, editor);\n      editor.undoManager.ignore(function () {\n        editor.selection.setRng(rangeFromPositions(from, to));\n        editor.execCommand('Delete');\n        readLocation(isInlineTarget$1, rootNode, CaretPosition.fromRangeStart(editor.selection.getRng())).map(inside).map(setCaretLocation(editor, caret));\n      });\n      editor.nodeChanged();\n    };\n    var rescope$1 = function (rootNode, node) {\n      var parentBlock = getParentBlock(node, rootNode);\n      return parentBlock ? parentBlock : rootNode;\n    };\n    var backspaceDeleteCollapsed = function (editor, caret, forward, from) {\n      var rootNode = rescope$1(editor.getBody(), from.container());\n      var isInlineTarget$1 = curry(isInlineTarget, editor);\n      var fromLocation = readLocation(isInlineTarget$1, rootNode, from);\n      return fromLocation.bind(function (location) {\n        if (forward) {\n          return location.fold(constant(Optional.some(inside(location))), Optional.none, constant(Optional.some(outside(location))), Optional.none);\n        } else {\n          return location.fold(Optional.none, constant(Optional.some(outside(location))), Optional.none, constant(Optional.some(inside(location))));\n        }\n      }).map(setCaretLocation(editor, caret)).getOrThunk(function () {\n        var toPosition = navigate(forward, rootNode, from);\n        var toLocation = toPosition.bind(function (pos) {\n          return readLocation(isInlineTarget$1, rootNode, pos);\n        });\n        return lift2(fromLocation, toLocation, function () {\n          return findRootInline(isInlineTarget$1, rootNode, from).exists(function (elm) {\n            if (hasOnlyTwoOrLessPositionsLeft(elm)) {\n              deleteElement(editor, forward, SugarElement.fromDom(elm));\n              return true;\n            } else {\n              return false;\n            }\n          });\n        }).orThunk(function () {\n          return toLocation.bind(function (_) {\n            return toPosition.map(function (to) {\n              if (forward) {\n                deleteFromTo(editor, caret, from, to);\n              } else {\n                deleteFromTo(editor, caret, to, from);\n              }\n              return true;\n            });\n          });\n        }).getOr(false);\n      });\n    };\n    var backspaceDelete$6 = function (editor, caret, forward) {\n      if (editor.selection.isCollapsed() && isInlineBoundariesEnabled(editor)) {\n        var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n        return backspaceDeleteCollapsed(editor, caret, forward, from);\n      }\n      return false;\n    };\n\n    var getParentInlines = function (rootElm, startElm) {\n      var parents = parentsAndSelf(startElm, rootElm);\n      return findIndex(parents, isBlock).fold(constant(parents), function (index) {\n        return parents.slice(0, index);\n      });\n    };\n    var hasOnlyOneChild$1 = function (elm) {\n      return children(elm).length === 1;\n    };\n    var deleteLastPosition = function (forward, editor, target, parentInlines) {\n      var isFormatElement$1 = curry(isFormatElement, editor);\n      var formatNodes = map(filter(parentInlines, isFormatElement$1), function (elm) {\n        return elm.dom;\n      });\n      if (formatNodes.length === 0) {\n        deleteElement(editor, forward, target);\n      } else {\n        var pos = replaceWithCaretFormat(target.dom, formatNodes);\n        editor.selection.setRng(pos.toRange());\n      }\n    };\n    var deleteCaret$2 = function (editor, forward) {\n      var rootElm = SugarElement.fromDom(editor.getBody());\n      var startElm = SugarElement.fromDom(editor.selection.getStart());\n      var parentInlines = filter(getParentInlines(rootElm, startElm), hasOnlyOneChild$1);\n      return last(parentInlines).exists(function (target) {\n        var fromPos = CaretPosition.fromRangeStart(editor.selection.getRng());\n        if (willDeleteLastPositionInElement(forward, fromPos, target.dom) && !isEmptyCaretFormatElement(target)) {\n          deleteLastPosition(forward, editor, target, parentInlines);\n          return true;\n        } else {\n          return false;\n        }\n      });\n    };\n    var backspaceDelete$7 = function (editor, forward) {\n      return editor.selection.isCollapsed() ? deleteCaret$2(editor, forward) : false;\n    };\n\n    var deleteElement$2 = function (editor, forward, element) {\n      editor._selectionOverrides.hideFakeCaret();\n      deleteElement(editor, forward, SugarElement.fromDom(element));\n      return true;\n    };\n    var deleteCaret$3 = function (editor, forward) {\n      var isNearMedia = forward ? isBeforeMedia : isAfterMedia;\n      var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n      var fromPos = getNormalizedRangeEndPoint(direction, editor.getBody(), editor.selection.getRng());\n      if (isNearMedia(fromPos)) {\n        return deleteElement$2(editor, forward, fromPos.getNode(!forward));\n      } else {\n        return Optional.from(normalizePosition(forward, fromPos)).filter(function (pos) {\n          return isNearMedia(pos) && isMoveInsideSameBlock(fromPos, pos);\n        }).exists(function (pos) {\n          return deleteElement$2(editor, forward, pos.getNode(!forward));\n        });\n      }\n    };\n    var deleteRange$2 = function (editor, forward) {\n      var selectedNode = editor.selection.getNode();\n      return isMedia(selectedNode) ? deleteElement$2(editor, forward, selectedNode) : false;\n    };\n    var backspaceDelete$8 = function (editor, forward) {\n      return editor.selection.isCollapsed() ? deleteCaret$3(editor, forward) : deleteRange$2(editor, forward);\n    };\n\n    var isEditable$1 = function (target) {\n      return closest(target, function (elm) {\n        return isContentEditableTrue(elm.dom) || isContentEditableFalse(elm.dom);\n      }).exists(function (elm) {\n        return isContentEditableTrue(elm.dom);\n      });\n    };\n    var parseIndentValue = function (value) {\n      var number = parseInt(value, 10);\n      return isNaN(number) ? 0 : number;\n    };\n    var getIndentStyleName = function (useMargin, element) {\n      var indentStyleName = useMargin || isTable$1(element) ? 'margin' : 'padding';\n      var suffix = get$5(element, 'direction') === 'rtl' ? '-right' : '-left';\n      return indentStyleName + suffix;\n    };\n    var indentElement = function (dom, command, useMargin, value, unit, element) {\n      var indentStyleName = getIndentStyleName(useMargin, SugarElement.fromDom(element));\n      if (command === 'outdent') {\n        var styleValue = Math.max(0, parseIndentValue(element.style[indentStyleName]) - value);\n        dom.setStyle(element, indentStyleName, styleValue ? styleValue + unit : '');\n      } else {\n        var styleValue = parseIndentValue(element.style[indentStyleName]) + value + unit;\n        dom.setStyle(element, indentStyleName, styleValue);\n      }\n    };\n    var validateBlocks = function (editor, blocks) {\n      return forall(blocks, function (block) {\n        var indentStyleName = getIndentStyleName(shouldIndentUseMargin(editor), block);\n        var intentValue = getRaw(block, indentStyleName).map(parseIndentValue).getOr(0);\n        var contentEditable = editor.dom.getContentEditable(block.dom);\n        return contentEditable !== 'false' && intentValue > 0;\n      });\n    };\n    var canOutdent = function (editor) {\n      var blocks = getBlocksToIndent(editor);\n      return !editor.mode.isReadOnly() && (blocks.length > 1 || validateBlocks(editor, blocks));\n    };\n    var isListComponent = function (el) {\n      return isList(el) || isListItem(el);\n    };\n    var parentIsListComponent = function (el) {\n      return parent(el).map(isListComponent).getOr(false);\n    };\n    var getBlocksToIndent = function (editor) {\n      return filter(map(editor.selection.getSelectedBlocks(), SugarElement.fromDom), function (el) {\n        return !isListComponent(el) && !parentIsListComponent(el) && isEditable$1(el);\n      });\n    };\n    var handle = function (editor, command) {\n      var dom = editor.dom, selection = editor.selection, formatter = editor.formatter;\n      var indentation = getIndentation(editor);\n      var indentUnit = /[a-z%]+$/i.exec(indentation)[0];\n      var indentValue = parseInt(indentation, 10);\n      var useMargin = shouldIndentUseMargin(editor);\n      var forcedRootBlock = getForcedRootBlock(editor);\n      if (!editor.queryCommandState('InsertUnorderedList') && !editor.queryCommandState('InsertOrderedList')) {\n        if (forcedRootBlock === '' && !dom.getParent(selection.getNode(), dom.isBlock)) {\n          formatter.apply('div');\n        }\n      }\n      each(getBlocksToIndent(editor), function (block) {\n        indentElement(dom, command, useMargin, indentValue, indentUnit, block.dom);\n      });\n    };\n\n    var backspaceDelete$9 = function (editor, _forward) {\n      if (editor.selection.isCollapsed() && canOutdent(editor)) {\n        var dom = editor.dom;\n        var rng = editor.selection.getRng();\n        var pos = CaretPosition.fromRangeStart(rng);\n        var block = dom.getParent(rng.startContainer, dom.isBlock);\n        if (block !== null && isAtStartOfBlock(SugarElement.fromDom(block), pos)) {\n          handle(editor, 'outdent');\n          return true;\n        }\n      }\n      return false;\n    };\n\n    var nativeCommand = function (editor, command) {\n      editor.getDoc().execCommand(command, false, null);\n    };\n    var deleteCommand = function (editor, caret) {\n      if (backspaceDelete$9(editor)) {\n        return;\n      } else if (backspaceDelete$4(editor, false)) {\n        return;\n      } else if (backspaceDelete$3(editor, false)) {\n        return;\n      } else if (backspaceDelete$6(editor, caret, false)) {\n        return;\n      } else if (backspaceDelete$1(editor, false)) {\n        return;\n      } else if (backspaceDelete(editor)) {\n        return;\n      } else if (backspaceDelete$5(editor, false)) {\n        return;\n      } else if (backspaceDelete$8(editor, false)) {\n        return;\n      } else if (backspaceDelete$2(editor)) {\n        return;\n      } else if (backspaceDelete$7(editor, false)) {\n        return;\n      } else {\n        nativeCommand(editor, 'Delete');\n        paddEmptyBody(editor);\n      }\n    };\n    var forwardDeleteCommand = function (editor, caret) {\n      if (backspaceDelete$4(editor, true)) {\n        return;\n      } else if (backspaceDelete$3(editor, true)) {\n        return;\n      } else if (backspaceDelete$6(editor, caret, true)) {\n        return;\n      } else if (backspaceDelete$1(editor, true)) {\n        return;\n      } else if (backspaceDelete(editor)) {\n        return;\n      } else if (backspaceDelete$5(editor, true)) {\n        return;\n      } else if (backspaceDelete$8(editor, true)) {\n        return;\n      } else if (backspaceDelete$2(editor)) {\n        return;\n      } else if (backspaceDelete$7(editor, true)) {\n        return;\n      } else {\n        nativeCommand(editor, 'ForwardDelete');\n      }\n    };\n    var setup$8 = function (editor, caret) {\n      editor.addCommand('delete', function () {\n        deleteCommand(editor, caret);\n      });\n      editor.addCommand('forwardDelete', function () {\n        forwardDeleteCommand(editor, caret);\n      });\n    };\n\n    var SIGNIFICANT_MOVE = 5;\n    var LONGPRESS_DELAY = 400;\n    var getTouch = function (event) {\n      if (event.touches === undefined || event.touches.length !== 1) {\n        return Optional.none();\n      }\n      return Optional.some(event.touches[0]);\n    };\n    var isFarEnough = function (touch, data) {\n      var distX = Math.abs(touch.clientX - data.x);\n      var distY = Math.abs(touch.clientY - data.y);\n      return distX > SIGNIFICANT_MOVE || distY > SIGNIFICANT_MOVE;\n    };\n    var setup$9 = function (editor) {\n      var startData = Cell(Optional.none());\n      var longpressFired = Cell(false);\n      var debounceLongpress = last$2(function (e) {\n        editor.fire('longpress', __assign(__assign({}, e), { type: 'longpress' }));\n        longpressFired.set(true);\n      }, LONGPRESS_DELAY);\n      editor.on('touchstart', function (e) {\n        getTouch(e).each(function (touch) {\n          debounceLongpress.cancel();\n          var data = {\n            x: touch.clientX,\n            y: touch.clientY,\n            target: e.target\n          };\n          debounceLongpress.throttle(e);\n          longpressFired.set(false);\n          startData.set(Optional.some(data));\n        });\n      }, true);\n      editor.on('touchmove', function (e) {\n        debounceLongpress.cancel();\n        getTouch(e).each(function (touch) {\n          startData.get().each(function (data) {\n            if (isFarEnough(touch, data)) {\n              startData.set(Optional.none());\n              longpressFired.set(false);\n              editor.fire('longpresscancel');\n            }\n          });\n        });\n      }, true);\n      editor.on('touchend touchcancel', function (e) {\n        debounceLongpress.cancel();\n        if (e.type === 'touchcancel') {\n          return;\n        }\n        startData.get().filter(function (data) {\n          return data.target.isEqualNode(e.target);\n        }).each(function () {\n          if (longpressFired.get()) {\n            e.preventDefault();\n          } else {\n            editor.fire('tap', __assign(__assign({}, e), { type: 'tap' }));\n          }\n        });\n      }, true);\n    };\n\n    var isBlockElement = function (blockElements, node) {\n      return blockElements.hasOwnProperty(node.nodeName);\n    };\n    var isValidTarget = function (blockElements, node) {\n      if (isText$1(node)) {\n        return true;\n      } else if (isElement$1(node)) {\n        return !isBlockElement(blockElements, node) && !isBookmarkNode$1(node);\n      } else {\n        return false;\n      }\n    };\n    var hasBlockParent = function (blockElements, root, node) {\n      return exists(parents$1(SugarElement.fromDom(node), SugarElement.fromDom(root)), function (elm) {\n        return isBlockElement(blockElements, elm.dom);\n      });\n    };\n    var shouldRemoveTextNode = function (blockElements, node) {\n      if (isText$1(node)) {\n        if (node.nodeValue.length === 0) {\n          return true;\n        } else if (/^\\s+$/.test(node.nodeValue) && (!node.nextSibling || isBlockElement(blockElements, node.nextSibling))) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var addRootBlocks = function (editor) {\n      var dom = editor.dom, selection = editor.selection;\n      var schema = editor.schema, blockElements = schema.getBlockElements();\n      var node = selection.getStart();\n      var rootNode = editor.getBody();\n      var rootBlockNode, tempNode, wrapped;\n      var forcedRootBlock = getForcedRootBlock(editor);\n      if (!node || !isElement$1(node) || !forcedRootBlock) {\n        return;\n      }\n      var rootNodeName = rootNode.nodeName.toLowerCase();\n      if (!schema.isValidChild(rootNodeName, forcedRootBlock.toLowerCase()) || hasBlockParent(blockElements, rootNode, node)) {\n        return;\n      }\n      var rng = selection.getRng();\n      var startContainer = rng.startContainer;\n      var startOffset = rng.startOffset;\n      var endContainer = rng.endContainer;\n      var endOffset = rng.endOffset;\n      var restoreSelection = hasFocus$1(editor);\n      node = rootNode.firstChild;\n      while (node) {\n        if (isValidTarget(blockElements, node)) {\n          if (shouldRemoveTextNode(blockElements, node)) {\n            tempNode = node;\n            node = node.nextSibling;\n            dom.remove(tempNode);\n            continue;\n          }\n          if (!rootBlockNode) {\n            rootBlockNode = dom.create(forcedRootBlock, getForcedRootBlockAttrs(editor));\n            node.parentNode.insertBefore(rootBlockNode, node);\n            wrapped = true;\n          }\n          tempNode = node;\n          node = node.nextSibling;\n          rootBlockNode.appendChild(tempNode);\n        } else {\n          rootBlockNode = null;\n          node = node.nextSibling;\n        }\n      }\n      if (wrapped && restoreSelection) {\n        rng.setStart(startContainer, startOffset);\n        rng.setEnd(endContainer, endOffset);\n        selection.setRng(rng);\n        editor.nodeChanged();\n      }\n    };\n    var setup$a = function (editor) {\n      if (getForcedRootBlock(editor)) {\n        editor.on('NodeChange', curry(addRootBlocks, editor));\n      }\n    };\n\n    var findBlockCaretContainer = function (editor) {\n      return descendant(SugarElement.fromDom(editor.getBody()), '*[data-mce-caret]').fold(constant(null), function (elm) {\n        return elm.dom;\n      });\n    };\n    var removeIeControlRect = function (editor) {\n      editor.selection.setRng(editor.selection.getRng());\n    };\n    var showBlockCaretContainer = function (editor, blockCaretContainer) {\n      if (blockCaretContainer.hasAttribute('data-mce-caret')) {\n        showCaretContainerBlock(blockCaretContainer);\n        removeIeControlRect(editor);\n        editor.selection.scrollIntoView(blockCaretContainer);\n      }\n    };\n    var handleBlockContainer = function (editor, e) {\n      var blockCaretContainer = findBlockCaretContainer(editor);\n      if (!blockCaretContainer) {\n        return;\n      }\n      if (e.type === 'compositionstart') {\n        e.preventDefault();\n        e.stopPropagation();\n        showBlockCaretContainer(editor, blockCaretContainer);\n        return;\n      }\n      if (hasContent(blockCaretContainer)) {\n        showBlockCaretContainer(editor, blockCaretContainer);\n        editor.undoManager.add();\n      }\n    };\n    var setup$b = function (editor) {\n      editor.on('keyup compositionstart', curry(handleBlockContainer, editor));\n    };\n\n    var isContentEditableFalse$9 = isContentEditableFalse;\n    var moveToCeFalseHorizontally = function (direction, editor, range) {\n      return moveHorizontally(editor, direction, range, isBeforeContentEditableFalse, isAfterContentEditableFalse, isContentEditableFalse$9);\n    };\n    var moveToCeFalseVertically = function (direction, editor, range) {\n      var isBefore = function (caretPosition) {\n        return isBeforeContentEditableFalse(caretPosition) || isBeforeTable(caretPosition);\n      };\n      var isAfter = function (caretPosition) {\n        return isAfterContentEditableFalse(caretPosition) || isAfterTable(caretPosition);\n      };\n      return moveVertically(editor, direction, range, isBefore, isAfter, isContentEditableFalse$9);\n    };\n    var createTextBlock = function (editor) {\n      var textBlock = editor.dom.create(getForcedRootBlock(editor));\n      if (!Env.ie || Env.ie >= 11) {\n        textBlock.innerHTML = '<br data-mce-bogus=\"1\">';\n      }\n      return textBlock;\n    };\n    var exitPreBlock = function (editor, direction, range) {\n      var caretWalker = CaretWalker(editor.getBody());\n      var getVisualCaretPosition$1 = curry(getVisualCaretPosition, direction === 1 ? caretWalker.next : caretWalker.prev);\n      if (range.collapsed && hasForcedRootBlock(editor)) {\n        var pre = editor.dom.getParent(range.startContainer, 'PRE');\n        if (!pre) {\n          return;\n        }\n        var caretPos = getVisualCaretPosition$1(CaretPosition.fromRangeStart(range));\n        if (!caretPos) {\n          var newBlock = createTextBlock(editor);\n          if (direction === 1) {\n            editor.$(pre).after(newBlock);\n          } else {\n            editor.$(pre).before(newBlock);\n          }\n          editor.selection.select(newBlock, true);\n          editor.selection.collapse();\n        }\n      }\n    };\n    var getHorizontalRange = function (editor, forward) {\n      var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n      var range = editor.selection.getRng();\n      return moveToCeFalseHorizontally(direction, editor, range).orThunk(function () {\n        exitPreBlock(editor, direction, range);\n        return Optional.none();\n      });\n    };\n    var getVerticalRange = function (editor, down) {\n      var direction = down ? 1 : -1;\n      var range = editor.selection.getRng();\n      return moveToCeFalseVertically(direction, editor, range).orThunk(function () {\n        exitPreBlock(editor, direction, range);\n        return Optional.none();\n      });\n    };\n    var moveH = function (editor, forward) {\n      return getHorizontalRange(editor, forward).exists(function (newRange) {\n        moveToRange(editor, newRange);\n        return true;\n      });\n    };\n    var moveV = function (editor, down) {\n      return getVerticalRange(editor, down).exists(function (newRange) {\n        moveToRange(editor, newRange);\n        return true;\n      });\n    };\n    var moveToLineEndPoint$2 = function (editor, forward) {\n      var isCefPosition = forward ? isAfterContentEditableFalse : isBeforeContentEditableFalse;\n      return moveToLineEndPoint(editor, forward, isCefPosition);\n    };\n\n    var isTarget = function (node) {\n      return contains(['figcaption'], name(node));\n    };\n    var rangeBefore = function (target) {\n      var rng = document.createRange();\n      rng.setStartBefore(target.dom);\n      rng.setEndBefore(target.dom);\n      return rng;\n    };\n    var insertElement = function (root, elm, forward) {\n      if (forward) {\n        append(root, elm);\n      } else {\n        prepend(root, elm);\n      }\n    };\n    var insertBr = function (root, forward) {\n      var br = SugarElement.fromTag('br');\n      insertElement(root, br, forward);\n      return rangeBefore(br);\n    };\n    var insertBlock$1 = function (root, forward, blockName, attrs) {\n      var block = SugarElement.fromTag(blockName);\n      var br = SugarElement.fromTag('br');\n      setAll(block, attrs);\n      append(block, br);\n      insertElement(root, block, forward);\n      return rangeBefore(br);\n    };\n    var insertEmptyLine = function (root, rootBlockName, attrs, forward) {\n      if (rootBlockName === '') {\n        return insertBr(root, forward);\n      } else {\n        return insertBlock$1(root, forward, rootBlockName, attrs);\n      }\n    };\n    var getClosestTargetBlock = function (pos, root) {\n      var isRoot = curry(eq$2, root);\n      return closest(SugarElement.fromDom(pos.container()), isBlock, isRoot).filter(isTarget);\n    };\n    var isAtFirstOrLastLine = function (root, forward, pos) {\n      return forward ? isAtLastLine(root.dom, pos) : isAtFirstLine(root.dom, pos);\n    };\n    var moveCaretToNewEmptyLine = function (editor, forward) {\n      var root = SugarElement.fromDom(editor.getBody());\n      var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n      var rootBlock = getForcedRootBlock(editor);\n      var rootBlockAttrs = getForcedRootBlockAttrs(editor);\n      return getClosestTargetBlock(pos, root).exists(function () {\n        if (isAtFirstOrLastLine(root, forward, pos)) {\n          var rng = insertEmptyLine(root, rootBlock, rootBlockAttrs, forward);\n          editor.selection.setRng(rng);\n          return true;\n        } else {\n          return false;\n        }\n      });\n    };\n    var moveV$1 = function (editor, forward) {\n      if (editor.selection.isCollapsed()) {\n        return moveCaretToNewEmptyLine(editor, forward);\n      } else {\n        return false;\n      }\n    };\n\n    var defaultPatterns = function (patterns) {\n      return map(patterns, function (pattern) {\n        return __assign({\n          shiftKey: false,\n          altKey: false,\n          ctrlKey: false,\n          metaKey: false,\n          keyCode: 0,\n          action: noop\n        }, pattern);\n      });\n    };\n    var matchesEvent = function (pattern, evt) {\n      return evt.keyCode === pattern.keyCode && evt.shiftKey === pattern.shiftKey && evt.altKey === pattern.altKey && evt.ctrlKey === pattern.ctrlKey && evt.metaKey === pattern.metaKey;\n    };\n    var match$1 = function (patterns, evt) {\n      return bind(defaultPatterns(patterns), function (pattern) {\n        return matchesEvent(pattern, evt) ? [pattern] : [];\n      });\n    };\n    var action = function (f) {\n      var x = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        x[_i - 1] = arguments[_i];\n      }\n      return function () {\n        return f.apply(null, x);\n      };\n    };\n    var execute = function (patterns, evt) {\n      return find(match$1(patterns, evt), function (pattern) {\n        return pattern.action();\n      });\n    };\n\n    var moveH$1 = function (editor, forward) {\n      var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n      var range = editor.selection.getRng();\n      return moveHorizontally(editor, direction, range, isBeforeMedia, isAfterMedia, isMedia).exists(function (newRange) {\n        moveToRange(editor, newRange);\n        return true;\n      });\n    };\n    var moveV$2 = function (editor, down) {\n      var direction = down ? 1 : -1;\n      var range = editor.selection.getRng();\n      return moveVertically(editor, direction, range, isBeforeMedia, isAfterMedia, isMedia).exists(function (newRange) {\n        moveToRange(editor, newRange);\n        return true;\n      });\n    };\n    var moveToLineEndPoint$3 = function (editor, forward) {\n      var isNearMedia = forward ? isAfterMedia : isBeforeMedia;\n      return moveToLineEndPoint(editor, forward, isNearMedia);\n    };\n\n    var deflate = function (rect, delta) {\n      return {\n        left: rect.left - delta,\n        top: rect.top - delta,\n        right: rect.right + delta * 2,\n        bottom: rect.bottom + delta * 2,\n        width: rect.width + delta,\n        height: rect.height + delta\n      };\n    };\n    var getCorners = function (getYAxisValue, tds) {\n      return bind(tds, function (td) {\n        var rect = deflate(clone$2(td.getBoundingClientRect()), -1);\n        return [\n          {\n            x: rect.left,\n            y: getYAxisValue(rect),\n            cell: td\n          },\n          {\n            x: rect.right,\n            y: getYAxisValue(rect),\n            cell: td\n          }\n        ];\n      });\n    };\n    var findClosestCorner = function (corners, x, y) {\n      return foldl(corners, function (acc, newCorner) {\n        return acc.fold(function () {\n          return Optional.some(newCorner);\n        }, function (oldCorner) {\n          var oldDist = Math.sqrt(Math.abs(oldCorner.x - x) + Math.abs(oldCorner.y - y));\n          var newDist = Math.sqrt(Math.abs(newCorner.x - x) + Math.abs(newCorner.y - y));\n          return Optional.some(newDist < oldDist ? newCorner : oldCorner);\n        });\n      }, Optional.none());\n    };\n    var getClosestCell$1 = function (getYAxisValue, isTargetCorner, table, x, y) {\n      var cells = descendants$1(SugarElement.fromDom(table), 'td,th,caption').map(function (e) {\n        return e.dom;\n      });\n      var corners = filter(getCorners(getYAxisValue, cells), function (corner) {\n        return isTargetCorner(corner, y);\n      });\n      return findClosestCorner(corners, x, y).map(function (corner) {\n        return corner.cell;\n      });\n    };\n    var getBottomValue = function (rect) {\n      return rect.bottom;\n    };\n    var getTopValue = function (rect) {\n      return rect.top;\n    };\n    var isAbove$1 = function (corner, y) {\n      return corner.y < y;\n    };\n    var isBelow$1 = function (corner, y) {\n      return corner.y > y;\n    };\n    var getClosestCellAbove = curry(getClosestCell$1, getBottomValue, isAbove$1);\n    var getClosestCellBelow = curry(getClosestCell$1, getTopValue, isBelow$1);\n    var findClosestPositionInAboveCell = function (table, pos) {\n      return head(pos.getClientRects()).bind(function (rect) {\n        return getClosestCellAbove(table, rect.left, rect.top);\n      }).bind(function (cell) {\n        return findClosestHorizontalPosition(getLastLinePositions(cell), pos);\n      });\n    };\n    var findClosestPositionInBelowCell = function (table, pos) {\n      return last(pos.getClientRects()).bind(function (rect) {\n        return getClosestCellBelow(table, rect.left, rect.top);\n      }).bind(function (cell) {\n        return findClosestHorizontalPosition(getFirstLinePositions(cell), pos);\n      });\n    };\n\n    var hasNextBreak = function (getPositionsUntil, scope, lineInfo) {\n      return lineInfo.breakAt.exists(function (breakPos) {\n        return getPositionsUntil(scope, breakPos).breakAt.isSome();\n      });\n    };\n    var startsWithWrapBreak = function (lineInfo) {\n      return lineInfo.breakType === BreakType.Wrap && lineInfo.positions.length === 0;\n    };\n    var startsWithBrBreak = function (lineInfo) {\n      return lineInfo.breakType === BreakType.Br && lineInfo.positions.length === 1;\n    };\n    var isAtTableCellLine = function (getPositionsUntil, scope, pos) {\n      var lineInfo = getPositionsUntil(scope, pos);\n      if (startsWithWrapBreak(lineInfo) || !isBr(pos.getNode()) && startsWithBrBreak(lineInfo)) {\n        return !hasNextBreak(getPositionsUntil, scope, lineInfo);\n      } else {\n        return lineInfo.breakAt.isNone();\n      }\n    };\n    var isAtFirstTableCellLine = curry(isAtTableCellLine, getPositionsUntilPreviousLine);\n    var isAtLastTableCellLine = curry(isAtTableCellLine, getPositionsUntilNextLine);\n    var isCaretAtStartOrEndOfTable = function (forward, rng, table) {\n      var caretPos = CaretPosition.fromRangeStart(rng);\n      return positionIn(!forward, table).exists(function (pos) {\n        return pos.isEqual(caretPos);\n      });\n    };\n    var navigateHorizontally = function (editor, forward, table, _td) {\n      var rng = editor.selection.getRng();\n      var direction = forward ? 1 : -1;\n      if (isFakeCaretTableBrowser() && isCaretAtStartOrEndOfTable(forward, rng, table)) {\n        showCaret(direction, editor, table, !forward, false).each(function (newRng) {\n          moveToRange(editor, newRng);\n        });\n        return true;\n      }\n      return false;\n    };\n    var getClosestAbovePosition = function (root, table, start) {\n      return findClosestPositionInAboveCell(table, start).orThunk(function () {\n        return head(start.getClientRects()).bind(function (rect) {\n          return findClosestHorizontalPositionFromPoint(getPositionsAbove(root, CaretPosition.before(table)), rect.left);\n        });\n      }).getOr(CaretPosition.before(table));\n    };\n    var getClosestBelowPosition = function (root, table, start) {\n      return findClosestPositionInBelowCell(table, start).orThunk(function () {\n        return head(start.getClientRects()).bind(function (rect) {\n          return findClosestHorizontalPositionFromPoint(getPositionsBelow(root, CaretPosition.after(table)), rect.left);\n        });\n      }).getOr(CaretPosition.after(table));\n    };\n    var getTable = function (previous, pos) {\n      var node = pos.getNode(previous);\n      return isElement$1(node) && node.nodeName === 'TABLE' ? Optional.some(node) : Optional.none();\n    };\n    var renderBlock = function (down, editor, table, pos) {\n      var forcedRootBlock = getForcedRootBlock(editor);\n      if (forcedRootBlock) {\n        editor.undoManager.transact(function () {\n          var element = SugarElement.fromTag(forcedRootBlock);\n          setAll(element, getForcedRootBlockAttrs(editor));\n          append(element, SugarElement.fromTag('br'));\n          if (down) {\n            after(SugarElement.fromDom(table), element);\n          } else {\n            before(SugarElement.fromDom(table), element);\n          }\n          var rng = editor.dom.createRng();\n          rng.setStart(element.dom, 0);\n          rng.setEnd(element.dom, 0);\n          moveToRange(editor, rng);\n        });\n      } else {\n        moveToRange(editor, pos.toRange());\n      }\n    };\n    var moveCaret = function (editor, down, pos) {\n      var table = down ? getTable(true, pos) : getTable(false, pos);\n      var last = down === false;\n      table.fold(function () {\n        return moveToRange(editor, pos.toRange());\n      }, function (table) {\n        return positionIn(last, editor.getBody()).filter(function (lastPos) {\n          return lastPos.isEqual(pos);\n        }).fold(function () {\n          return moveToRange(editor, pos.toRange());\n        }, function (_) {\n          return renderBlock(down, editor, table, pos);\n        });\n      });\n    };\n    var navigateVertically = function (editor, down, table, td) {\n      var rng = editor.selection.getRng();\n      var pos = CaretPosition.fromRangeStart(rng);\n      var root = editor.getBody();\n      if (!down && isAtFirstTableCellLine(td, pos)) {\n        var newPos = getClosestAbovePosition(root, table, pos);\n        moveCaret(editor, down, newPos);\n        return true;\n      } else if (down && isAtLastTableCellLine(td, pos)) {\n        var newPos = getClosestBelowPosition(root, table, pos);\n        moveCaret(editor, down, newPos);\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var move$1 = function (editor, forward, mover) {\n      return Optional.from(editor.dom.getParent(editor.selection.getNode(), 'td,th')).bind(function (td) {\n        return Optional.from(editor.dom.getParent(td, 'table')).map(function (table) {\n          return mover(editor, forward, table, td);\n        });\n      }).getOr(false);\n    };\n    var moveH$2 = function (editor, forward) {\n      return move$1(editor, forward, navigateHorizontally);\n    };\n    var moveV$3 = function (editor, forward) {\n      return move$1(editor, forward, navigateVertically);\n    };\n\n    var executeKeydownOverride = function (editor, caret, evt) {\n      var os = detect$3().os;\n      execute([\n        {\n          keyCode: VK.RIGHT,\n          action: action(moveH, editor, true)\n        },\n        {\n          keyCode: VK.LEFT,\n          action: action(moveH, editor, false)\n        },\n        {\n          keyCode: VK.UP,\n          action: action(moveV, editor, false)\n        },\n        {\n          keyCode: VK.DOWN,\n          action: action(moveV, editor, true)\n        },\n        {\n          keyCode: VK.RIGHT,\n          action: action(moveH$2, editor, true)\n        },\n        {\n          keyCode: VK.LEFT,\n          action: action(moveH$2, editor, false)\n        },\n        {\n          keyCode: VK.UP,\n          action: action(moveV$3, editor, false)\n        },\n        {\n          keyCode: VK.DOWN,\n          action: action(moveV$3, editor, true)\n        },\n        {\n          keyCode: VK.RIGHT,\n          action: action(moveH$1, editor, true)\n        },\n        {\n          keyCode: VK.LEFT,\n          action: action(moveH$1, editor, false)\n        },\n        {\n          keyCode: VK.UP,\n          action: action(moveV$2, editor, false)\n        },\n        {\n          keyCode: VK.DOWN,\n          action: action(moveV$2, editor, true)\n        },\n        {\n          keyCode: VK.RIGHT,\n          action: action(move, editor, caret, true)\n        },\n        {\n          keyCode: VK.LEFT,\n          action: action(move, editor, caret, false)\n        },\n        {\n          keyCode: VK.RIGHT,\n          ctrlKey: !os.isOSX(),\n          altKey: os.isOSX(),\n          action: action(moveNextWord, editor, caret)\n        },\n        {\n          keyCode: VK.LEFT,\n          ctrlKey: !os.isOSX(),\n          altKey: os.isOSX(),\n          action: action(movePrevWord, editor, caret)\n        },\n        {\n          keyCode: VK.UP,\n          action: action(moveV$1, editor, false)\n        },\n        {\n          keyCode: VK.DOWN,\n          action: action(moveV$1, editor, true)\n        }\n      ], evt).each(function (_) {\n        evt.preventDefault();\n      });\n    };\n    var setup$c = function (editor, caret) {\n      editor.on('keydown', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeydownOverride(editor, caret, evt);\n        }\n      });\n    };\n\n    var executeKeydownOverride$1 = function (editor, caret, evt) {\n      execute([\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$9, editor, false)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$4, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$4, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$3, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$3, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$6, editor, caret, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$6, editor, caret, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$5, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$5, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$8, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$8, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$2, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$2, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$1, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$1, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$7, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$7, editor, true)\n        }\n      ], evt).each(function (_) {\n        evt.preventDefault();\n      });\n    };\n    var executeKeyupOverride = function (editor, evt) {\n      execute([\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(paddEmptyElement, editor)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(paddEmptyElement, editor)\n        }\n      ], evt);\n    };\n    var setup$d = function (editor, caret) {\n      editor.on('keydown', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeydownOverride$1(editor, caret, evt);\n        }\n      });\n      editor.on('keyup', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeyupOverride(editor, evt);\n        }\n      });\n    };\n\n    var firstNonWhiteSpaceNodeSibling = function (node) {\n      while (node) {\n        if (node.nodeType === 1 || node.nodeType === 3 && node.data && /[\\r\\n\\s]/.test(node.data)) {\n          return node;\n        }\n        node = node.nextSibling;\n      }\n    };\n    var moveToCaretPosition = function (editor, root) {\n      var node, lastNode = root;\n      var dom = editor.dom;\n      var moveCaretBeforeOnEnterElementsMap = editor.schema.getMoveCaretBeforeOnEnterElements();\n      if (!root) {\n        return;\n      }\n      if (/^(LI|DT|DD)$/.test(root.nodeName)) {\n        var firstChild = firstNonWhiteSpaceNodeSibling(root.firstChild);\n        if (firstChild && /^(UL|OL|DL)$/.test(firstChild.nodeName)) {\n          root.insertBefore(dom.doc.createTextNode(nbsp), root.firstChild);\n        }\n      }\n      var rng = dom.createRng();\n      root.normalize();\n      if (root.hasChildNodes()) {\n        var walker = new DomTreeWalker(root, root);\n        while (node = walker.current()) {\n          if (isText$1(node)) {\n            rng.setStart(node, 0);\n            rng.setEnd(node, 0);\n            break;\n          }\n          if (moveCaretBeforeOnEnterElementsMap[node.nodeName.toLowerCase()]) {\n            rng.setStartBefore(node);\n            rng.setEndBefore(node);\n            break;\n          }\n          lastNode = node;\n          node = walker.next();\n        }\n        if (!node) {\n          rng.setStart(lastNode, 0);\n          rng.setEnd(lastNode, 0);\n        }\n      } else {\n        if (isBr(root)) {\n          if (root.nextSibling && dom.isBlock(root.nextSibling)) {\n            rng.setStartBefore(root);\n            rng.setEndBefore(root);\n          } else {\n            rng.setStartAfter(root);\n            rng.setEndAfter(root);\n          }\n        } else {\n          rng.setStart(root, 0);\n          rng.setEnd(root, 0);\n        }\n      }\n      editor.selection.setRng(rng);\n      scrollRangeIntoView(editor, rng);\n    };\n    var getEditableRoot = function (dom, node) {\n      var root = dom.getRoot();\n      var parent, editableRoot;\n      parent = node;\n      while (parent !== root && dom.getContentEditable(parent) !== 'false') {\n        if (dom.getContentEditable(parent) === 'true') {\n          editableRoot = parent;\n        }\n        parent = parent.parentNode;\n      }\n      return parent !== root ? editableRoot : root;\n    };\n    var getParentBlock$2 = function (editor) {\n      return Optional.from(editor.dom.getParent(editor.selection.getStart(true), editor.dom.isBlock));\n    };\n    var getParentBlockName = function (editor) {\n      return getParentBlock$2(editor).fold(constant(''), function (parentBlock) {\n        return parentBlock.nodeName.toUpperCase();\n      });\n    };\n    var isListItemParentBlock = function (editor) {\n      return getParentBlock$2(editor).filter(function (elm) {\n        return isListItem(SugarElement.fromDom(elm));\n      }).isSome();\n    };\n\n    var hasFirstChild = function (elm, name) {\n      return elm.firstChild && elm.firstChild.nodeName === name;\n    };\n    var isFirstChild = function (elm) {\n      var _a;\n      return ((_a = elm.parentNode) === null || _a === void 0 ? void 0 : _a.firstChild) === elm;\n    };\n    var hasParent$1 = function (elm, parentName) {\n      return elm && elm.parentNode && elm.parentNode.nodeName === parentName;\n    };\n    var isListBlock = function (elm) {\n      return elm && /^(OL|UL|LI)$/.test(elm.nodeName);\n    };\n    var isNestedList = function (elm) {\n      return isListBlock(elm) && isListBlock(elm.parentNode);\n    };\n    var getContainerBlock = function (containerBlock) {\n      var containerBlockParent = containerBlock.parentNode;\n      if (/^(LI|DT|DD)$/.test(containerBlockParent.nodeName)) {\n        return containerBlockParent;\n      }\n      return containerBlock;\n    };\n    var isFirstOrLastLi = function (containerBlock, parentBlock, first) {\n      var node = containerBlock[first ? 'firstChild' : 'lastChild'];\n      while (node) {\n        if (isElement$1(node)) {\n          break;\n        }\n        node = node[first ? 'nextSibling' : 'previousSibling'];\n      }\n      return node === parentBlock;\n    };\n    var insert = function (editor, createNewBlock, containerBlock, parentBlock, newBlockName) {\n      var dom = editor.dom;\n      var rng = editor.selection.getRng();\n      if (containerBlock === editor.getBody()) {\n        return;\n      }\n      if (isNestedList(containerBlock)) {\n        newBlockName = 'LI';\n      }\n      var newBlock = newBlockName ? createNewBlock(newBlockName) : dom.create('BR');\n      if (isFirstOrLastLi(containerBlock, parentBlock, true) && isFirstOrLastLi(containerBlock, parentBlock, false)) {\n        if (hasParent$1(containerBlock, 'LI')) {\n          var containerBlockParent = getContainerBlock(containerBlock);\n          dom.insertAfter(newBlock, containerBlockParent);\n          if (isFirstChild(containerBlock)) {\n            dom.remove(containerBlockParent);\n          } else {\n            dom.remove(containerBlock);\n          }\n        } else {\n          dom.replace(newBlock, containerBlock);\n        }\n      } else if (isFirstOrLastLi(containerBlock, parentBlock, true)) {\n        if (hasParent$1(containerBlock, 'LI')) {\n          dom.insertAfter(newBlock, getContainerBlock(containerBlock));\n          newBlock.appendChild(dom.doc.createTextNode(' '));\n          newBlock.appendChild(containerBlock);\n        } else {\n          containerBlock.parentNode.insertBefore(newBlock, containerBlock);\n        }\n        dom.remove(parentBlock);\n      } else if (isFirstOrLastLi(containerBlock, parentBlock, false)) {\n        dom.insertAfter(newBlock, getContainerBlock(containerBlock));\n        dom.remove(parentBlock);\n      } else {\n        containerBlock = getContainerBlock(containerBlock);\n        var tmpRng = rng.cloneRange();\n        tmpRng.setStartAfter(parentBlock);\n        tmpRng.setEndAfter(containerBlock);\n        var fragment = tmpRng.extractContents();\n        if (newBlockName === 'LI' && hasFirstChild(fragment, 'LI')) {\n          newBlock = fragment.firstChild;\n          dom.insertAfter(fragment, containerBlock);\n        } else {\n          dom.insertAfter(fragment, containerBlock);\n          dom.insertAfter(newBlock, containerBlock);\n        }\n        dom.remove(parentBlock);\n      }\n      moveToCaretPosition(editor, newBlock);\n    };\n\n    var trimZwsp = function (fragment) {\n      each(descendants(SugarElement.fromDom(fragment), isText), function (text) {\n        var rawNode = text.dom;\n        rawNode.nodeValue = trim$2(rawNode.nodeValue);\n      });\n    };\n    var isEmptyAnchor = function (dom, elm) {\n      return elm && elm.nodeName === 'A' && dom.isEmpty(elm);\n    };\n    var isTableCell$5 = function (node) {\n      return node && /^(TD|TH|CAPTION)$/.test(node.nodeName);\n    };\n    var emptyBlock = function (elm) {\n      elm.innerHTML = '<br data-mce-bogus=\"1\">';\n    };\n    var containerAndSiblingName = function (container, nodeName) {\n      return container.nodeName === nodeName || container.previousSibling && container.previousSibling.nodeName === nodeName;\n    };\n    var canSplitBlock = function (dom, node) {\n      return node && dom.isBlock(node) && !/^(TD|TH|CAPTION|FORM)$/.test(node.nodeName) && !/^(fixed|absolute)/i.test(node.style.position) && dom.getContentEditable(node) !== 'true';\n    };\n    var trimInlineElementsOnLeftSideOfBlock = function (dom, nonEmptyElementsMap, block) {\n      var node = block;\n      var firstChilds = [];\n      var i;\n      if (!node) {\n        return;\n      }\n      while (node = node.firstChild) {\n        if (dom.isBlock(node)) {\n          return;\n        }\n        if (isElement$1(node) && !nonEmptyElementsMap[node.nodeName.toLowerCase()]) {\n          firstChilds.push(node);\n        }\n      }\n      i = firstChilds.length;\n      while (i--) {\n        node = firstChilds[i];\n        if (!node.hasChildNodes() || node.firstChild === node.lastChild && node.firstChild.nodeValue === '') {\n          dom.remove(node);\n        } else {\n          if (isEmptyAnchor(dom, node)) {\n            dom.remove(node);\n          }\n        }\n      }\n    };\n    var normalizeZwspOffset = function (start, container, offset) {\n      if (isText$1(container) === false) {\n        return offset;\n      } else if (start) {\n        return offset === 1 && container.data.charAt(offset - 1) === ZWSP ? 0 : offset;\n      } else {\n        return offset === container.data.length - 1 && container.data.charAt(offset) === ZWSP ? container.data.length : offset;\n      }\n    };\n    var includeZwspInRange = function (rng) {\n      var newRng = rng.cloneRange();\n      newRng.setStart(rng.startContainer, normalizeZwspOffset(true, rng.startContainer, rng.startOffset));\n      newRng.setEnd(rng.endContainer, normalizeZwspOffset(false, rng.endContainer, rng.endOffset));\n      return newRng;\n    };\n    var trimLeadingLineBreaks = function (node) {\n      do {\n        if (isText$1(node)) {\n          node.nodeValue = node.nodeValue.replace(/^[\\r\\n]+/, '');\n        }\n        node = node.firstChild;\n      } while (node);\n    };\n    var getEditableRoot$1 = function (dom, node) {\n      var root = dom.getRoot();\n      var parent, editableRoot;\n      parent = node;\n      while (parent !== root && dom.getContentEditable(parent) !== 'false') {\n        if (dom.getContentEditable(parent) === 'true') {\n          editableRoot = parent;\n        }\n        parent = parent.parentNode;\n      }\n      return parent !== root ? editableRoot : root;\n    };\n    var applyAttributes = function (editor, node, forcedRootBlockAttrs) {\n      var dom = editor.dom;\n      Optional.from(forcedRootBlockAttrs.style).map(dom.parseStyle).each(function (attrStyles) {\n        var currentStyles = getAllRaw(SugarElement.fromDom(node));\n        var newStyles = __assign(__assign({}, currentStyles), attrStyles);\n        dom.setStyles(node, newStyles);\n      });\n      var attrClassesOpt = Optional.from(forcedRootBlockAttrs.class).map(function (attrClasses) {\n        return attrClasses.split(/\\s+/);\n      });\n      var currentClassesOpt = Optional.from(node.className).map(function (currentClasses) {\n        return filter(currentClasses.split(/\\s+/), function (clazz) {\n          return clazz !== '';\n        });\n      });\n      lift2(attrClassesOpt, currentClassesOpt, function (attrClasses, currentClasses) {\n        var filteredClasses = filter(currentClasses, function (clazz) {\n          return !contains(attrClasses, clazz);\n        });\n        var newClasses = __spreadArrays(attrClasses, filteredClasses);\n        dom.setAttrib(node, 'class', newClasses.join(' '));\n      });\n      var appliedAttrs = [\n        'style',\n        'class'\n      ];\n      var remainingAttrs = filter$1(forcedRootBlockAttrs, function (_, attrs) {\n        return !contains(appliedAttrs, attrs);\n      });\n      dom.setAttribs(node, remainingAttrs);\n    };\n    var setForcedBlockAttrs = function (editor, node) {\n      var forcedRootBlockName = getForcedRootBlock(editor);\n      if (forcedRootBlockName && forcedRootBlockName.toLowerCase() === node.tagName.toLowerCase()) {\n        var forcedRootBlockAttrs = getForcedRootBlockAttrs(editor);\n        applyAttributes(editor, node, forcedRootBlockAttrs);\n      }\n    };\n    var wrapSelfAndSiblingsInDefaultBlock = function (editor, newBlockName, rng, container, offset) {\n      var newBlock, parentBlock, startNode, node, next, rootBlockName;\n      var blockName = newBlockName || 'P';\n      var dom = editor.dom, editableRoot = getEditableRoot$1(dom, container);\n      parentBlock = dom.getParent(container, dom.isBlock);\n      if (!parentBlock || !canSplitBlock(dom, parentBlock)) {\n        parentBlock = parentBlock || editableRoot;\n        if (parentBlock === editor.getBody() || isTableCell$5(parentBlock)) {\n          rootBlockName = parentBlock.nodeName.toLowerCase();\n        } else {\n          rootBlockName = parentBlock.parentNode.nodeName.toLowerCase();\n        }\n        if (!parentBlock.hasChildNodes()) {\n          newBlock = dom.create(blockName);\n          setForcedBlockAttrs(editor, newBlock);\n          parentBlock.appendChild(newBlock);\n          rng.setStart(newBlock, 0);\n          rng.setEnd(newBlock, 0);\n          return newBlock;\n        }\n        node = container;\n        while (node.parentNode !== parentBlock) {\n          node = node.parentNode;\n        }\n        while (node && !dom.isBlock(node)) {\n          startNode = node;\n          node = node.previousSibling;\n        }\n        if (startNode && editor.schema.isValidChild(rootBlockName, blockName.toLowerCase())) {\n          newBlock = dom.create(blockName);\n          setForcedBlockAttrs(editor, newBlock);\n          startNode.parentNode.insertBefore(newBlock, startNode);\n          node = startNode;\n          while (node && !dom.isBlock(node)) {\n            next = node.nextSibling;\n            newBlock.appendChild(node);\n            node = next;\n          }\n          rng.setStart(container, offset);\n          rng.setEnd(container, offset);\n        }\n      }\n      return container;\n    };\n    var addBrToBlockIfNeeded = function (dom, block) {\n      block.normalize();\n      var lastChild = block.lastChild;\n      if (!lastChild || /^(left|right)$/gi.test(dom.getStyle(lastChild, 'float', true))) {\n        dom.add(block, 'br');\n      }\n    };\n    var insert$1 = function (editor, evt) {\n      var tmpRng, container, offset, parentBlock;\n      var newBlock, fragment, containerBlock, parentBlockName, newBlockName, isAfterLastNodeInContainer;\n      var dom = editor.dom;\n      var schema = editor.schema, nonEmptyElementsMap = schema.getNonEmptyElements();\n      var rng = editor.selection.getRng();\n      var createNewBlock = function (name) {\n        var node = container, block, clonedNode, caretNode;\n        var textInlineElements = schema.getTextInlineElements();\n        if (name || parentBlockName === 'TABLE' || parentBlockName === 'HR') {\n          block = dom.create(name || newBlockName);\n        } else {\n          block = parentBlock.cloneNode(false);\n        }\n        caretNode = block;\n        if (shouldKeepStyles(editor) === false) {\n          dom.setAttrib(block, 'style', null);\n          dom.setAttrib(block, 'class', null);\n        } else {\n          do {\n            if (textInlineElements[node.nodeName]) {\n              if (isCaretNode(node) || isBookmarkNode$1(node)) {\n                continue;\n              }\n              clonedNode = node.cloneNode(false);\n              dom.setAttrib(clonedNode, 'id', '');\n              if (block.hasChildNodes()) {\n                clonedNode.appendChild(block.firstChild);\n                block.appendChild(clonedNode);\n              } else {\n                caretNode = clonedNode;\n                block.appendChild(clonedNode);\n              }\n            }\n          } while ((node = node.parentNode) && node !== editableRoot);\n        }\n        setForcedBlockAttrs(editor, block);\n        emptyBlock(caretNode);\n        return block;\n      };\n      var isCaretAtStartOrEndOfBlock = function (start) {\n        var node, name;\n        var normalizedOffset = normalizeZwspOffset(start, container, offset);\n        if (isText$1(container) && (start ? normalizedOffset > 0 : normalizedOffset < container.nodeValue.length)) {\n          return false;\n        }\n        if (container.parentNode === parentBlock && isAfterLastNodeInContainer && !start) {\n          return true;\n        }\n        if (start && isElement$1(container) && container === parentBlock.firstChild) {\n          return true;\n        }\n        if (containerAndSiblingName(container, 'TABLE') || containerAndSiblingName(container, 'HR')) {\n          return isAfterLastNodeInContainer && !start || !isAfterLastNodeInContainer && start;\n        }\n        var walker = new DomTreeWalker(container, parentBlock);\n        if (isText$1(container)) {\n          if (start && normalizedOffset === 0) {\n            walker.prev();\n          } else if (!start && normalizedOffset === container.nodeValue.length) {\n            walker.next();\n          }\n        }\n        while (node = walker.current()) {\n          if (isElement$1(node)) {\n            if (!node.getAttribute('data-mce-bogus')) {\n              name = node.nodeName.toLowerCase();\n              if (nonEmptyElementsMap[name] && name !== 'br') {\n                return false;\n              }\n            }\n          } else if (isText$1(node) && !isWhitespaceText(node.nodeValue)) {\n            return false;\n          }\n          if (start) {\n            walker.prev();\n          } else {\n            walker.next();\n          }\n        }\n        return true;\n      };\n      var insertNewBlockAfter = function () {\n        if (/^(H[1-6]|PRE|FIGURE)$/.test(parentBlockName) && containerBlockName !== 'HGROUP') {\n          newBlock = createNewBlock(newBlockName);\n        } else {\n          newBlock = createNewBlock();\n        }\n        if (shouldEndContainerOnEmptyBlock(editor) && canSplitBlock(dom, containerBlock) && dom.isEmpty(parentBlock)) {\n          newBlock = dom.split(containerBlock, parentBlock);\n        } else {\n          dom.insertAfter(newBlock, parentBlock);\n        }\n        moveToCaretPosition(editor, newBlock);\n      };\n      normalize(dom, rng).each(function (normRng) {\n        rng.setStart(normRng.startContainer, normRng.startOffset);\n        rng.setEnd(normRng.endContainer, normRng.endOffset);\n      });\n      container = rng.startContainer;\n      offset = rng.startOffset;\n      newBlockName = getForcedRootBlock(editor);\n      var shiftKey = !!(evt && evt.shiftKey);\n      var ctrlKey = !!(evt && evt.ctrlKey);\n      if (isElement$1(container) && container.hasChildNodes()) {\n        isAfterLastNodeInContainer = offset > container.childNodes.length - 1;\n        container = container.childNodes[Math.min(offset, container.childNodes.length - 1)] || container;\n        if (isAfterLastNodeInContainer && isText$1(container)) {\n          offset = container.nodeValue.length;\n        } else {\n          offset = 0;\n        }\n      }\n      var editableRoot = getEditableRoot$1(dom, container);\n      if (!editableRoot) {\n        return;\n      }\n      if (newBlockName && !shiftKey || !newBlockName && shiftKey) {\n        container = wrapSelfAndSiblingsInDefaultBlock(editor, newBlockName, rng, container, offset);\n      }\n      parentBlock = dom.getParent(container, dom.isBlock);\n      containerBlock = parentBlock ? dom.getParent(parentBlock.parentNode, dom.isBlock) : null;\n      parentBlockName = parentBlock ? parentBlock.nodeName.toUpperCase() : '';\n      var containerBlockName = containerBlock ? containerBlock.nodeName.toUpperCase() : '';\n      if (containerBlockName === 'LI' && !ctrlKey) {\n        parentBlock = containerBlock;\n        containerBlock = containerBlock.parentNode;\n        parentBlockName = containerBlockName;\n      }\n      if (/^(LI|DT|DD)$/.test(parentBlockName)) {\n        if (dom.isEmpty(parentBlock)) {\n          insert(editor, createNewBlock, containerBlock, parentBlock, newBlockName);\n          return;\n        }\n      }\n      if (newBlockName && parentBlock === editor.getBody()) {\n        return;\n      }\n      newBlockName = newBlockName || 'P';\n      if (isCaretContainerBlock(parentBlock)) {\n        newBlock = showCaretContainerBlock(parentBlock);\n        if (dom.isEmpty(parentBlock)) {\n          emptyBlock(parentBlock);\n        }\n        setForcedBlockAttrs(editor, newBlock);\n        moveToCaretPosition(editor, newBlock);\n      } else if (isCaretAtStartOrEndOfBlock()) {\n        insertNewBlockAfter();\n      } else if (isCaretAtStartOrEndOfBlock(true)) {\n        newBlock = parentBlock.parentNode.insertBefore(createNewBlock(), parentBlock);\n        moveToCaretPosition(editor, containerAndSiblingName(parentBlock, 'HR') ? newBlock : parentBlock);\n      } else {\n        tmpRng = includeZwspInRange(rng).cloneRange();\n        tmpRng.setEndAfter(parentBlock);\n        fragment = tmpRng.extractContents();\n        trimZwsp(fragment);\n        trimLeadingLineBreaks(fragment);\n        newBlock = fragment.firstChild;\n        dom.insertAfter(fragment, parentBlock);\n        trimInlineElementsOnLeftSideOfBlock(dom, nonEmptyElementsMap, newBlock);\n        addBrToBlockIfNeeded(dom, parentBlock);\n        if (dom.isEmpty(parentBlock)) {\n          emptyBlock(parentBlock);\n        }\n        newBlock.normalize();\n        if (dom.isEmpty(newBlock)) {\n          dom.remove(newBlock);\n          insertNewBlockAfter();\n        } else {\n          setForcedBlockAttrs(editor, newBlock);\n          moveToCaretPosition(editor, newBlock);\n        }\n      }\n      dom.setAttrib(newBlock, 'id', '');\n      editor.fire('NewBlock', { newBlock: newBlock });\n    };\n\n    var hasRightSideContent = function (schema, container, parentBlock) {\n      var walker = new DomTreeWalker(container, parentBlock);\n      var node;\n      var nonEmptyElementsMap = schema.getNonEmptyElements();\n      while (node = walker.next()) {\n        if (nonEmptyElementsMap[node.nodeName.toLowerCase()] || node.length > 0) {\n          return true;\n        }\n      }\n    };\n    var moveSelectionToBr = function (editor, brElm, extraBr) {\n      var rng = editor.dom.createRng();\n      if (!extraBr) {\n        rng.setStartAfter(brElm);\n        rng.setEndAfter(brElm);\n      } else {\n        rng.setStartBefore(brElm);\n        rng.setEndBefore(brElm);\n      }\n      editor.selection.setRng(rng);\n      scrollRangeIntoView(editor, rng);\n    };\n    var insertBrAtCaret = function (editor, evt) {\n      var selection = editor.selection;\n      var dom = editor.dom;\n      var rng = selection.getRng();\n      var brElm;\n      var extraBr;\n      normalize(dom, rng).each(function (normRng) {\n        rng.setStart(normRng.startContainer, normRng.startOffset);\n        rng.setEnd(normRng.endContainer, normRng.endOffset);\n      });\n      var offset = rng.startOffset;\n      var container = rng.startContainer;\n      if (container.nodeType === 1 && container.hasChildNodes()) {\n        var isAfterLastNodeInContainer = offset > container.childNodes.length - 1;\n        container = container.childNodes[Math.min(offset, container.childNodes.length - 1)] || container;\n        if (isAfterLastNodeInContainer && container.nodeType === 3) {\n          offset = container.nodeValue.length;\n        } else {\n          offset = 0;\n        }\n      }\n      var parentBlock = dom.getParent(container, dom.isBlock);\n      var containerBlock = parentBlock ? dom.getParent(parentBlock.parentNode, dom.isBlock) : null;\n      var containerBlockName = containerBlock ? containerBlock.nodeName.toUpperCase() : '';\n      var isControlKey = !!(evt && evt.ctrlKey);\n      if (containerBlockName === 'LI' && !isControlKey) {\n        parentBlock = containerBlock;\n      }\n      if (container && container.nodeType === 3 && offset >= container.nodeValue.length) {\n        if (!hasRightSideContent(editor.schema, container, parentBlock)) {\n          brElm = dom.create('br');\n          rng.insertNode(brElm);\n          rng.setStartAfter(brElm);\n          rng.setEndAfter(brElm);\n          extraBr = true;\n        }\n      }\n      brElm = dom.create('br');\n      rangeInsertNode(dom, rng, brElm);\n      moveSelectionToBr(editor, brElm, extraBr);\n      editor.undoManager.add();\n    };\n    var insertBrBefore = function (editor, inline) {\n      var br = SugarElement.fromTag('br');\n      before(SugarElement.fromDom(inline), br);\n      editor.undoManager.add();\n    };\n    var insertBrAfter = function (editor, inline) {\n      if (!hasBrAfter(editor.getBody(), inline)) {\n        after(SugarElement.fromDom(inline), SugarElement.fromTag('br'));\n      }\n      var br = SugarElement.fromTag('br');\n      after(SugarElement.fromDom(inline), br);\n      moveSelectionToBr(editor, br.dom, false);\n      editor.undoManager.add();\n    };\n    var isBeforeBr$1 = function (pos) {\n      return isBr(pos.getNode());\n    };\n    var hasBrAfter = function (rootNode, startNode) {\n      if (isBeforeBr$1(CaretPosition.after(startNode))) {\n        return true;\n      } else {\n        return nextPosition(rootNode, CaretPosition.after(startNode)).map(function (pos) {\n          return isBr(pos.getNode());\n        }).getOr(false);\n      }\n    };\n    var isAnchorLink = function (elm) {\n      return elm && elm.nodeName === 'A' && 'href' in elm;\n    };\n    var isInsideAnchor = function (location) {\n      return location.fold(never, isAnchorLink, isAnchorLink, never);\n    };\n    var readInlineAnchorLocation = function (editor) {\n      var isInlineTarget$1 = curry(isInlineTarget, editor);\n      var position = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return readLocation(isInlineTarget$1, editor.getBody(), position).filter(isInsideAnchor);\n    };\n    var insertBrOutsideAnchor = function (editor, location) {\n      location.fold(noop, curry(insertBrBefore, editor), curry(insertBrAfter, editor), noop);\n    };\n    var insert$2 = function (editor, evt) {\n      var anchorLocation = readInlineAnchorLocation(editor);\n      if (anchorLocation.isSome()) {\n        anchorLocation.each(curry(insertBrOutsideAnchor, editor));\n      } else {\n        insertBrAtCaret(editor, evt);\n      }\n    };\n\n    var matchesSelector = function (editor, selector) {\n      return getParentBlock$2(editor).filter(function (parentBlock) {\n        return selector.length > 0 && is$1(SugarElement.fromDom(parentBlock), selector);\n      }).isSome();\n    };\n    var shouldInsertBr = function (editor) {\n      return matchesSelector(editor, getBrNewLineSelector(editor));\n    };\n    var shouldBlockNewLine = function (editor) {\n      return matchesSelector(editor, getNoNewLineSelector(editor));\n    };\n\n    var newLineAction = Adt.generate([\n      { br: [] },\n      { block: [] },\n      { none: [] }\n    ]);\n    var shouldBlockNewLine$1 = function (editor, _shiftKey) {\n      return shouldBlockNewLine(editor);\n    };\n    var isBrMode = function (requiredState) {\n      return function (editor, _shiftKey) {\n        var brMode = getForcedRootBlock(editor) === '';\n        return brMode === requiredState;\n      };\n    };\n    var inListBlock = function (requiredState) {\n      return function (editor, _shiftKey) {\n        return isListItemParentBlock(editor) === requiredState;\n      };\n    };\n    var inBlock = function (blockName, requiredState) {\n      return function (editor, _shiftKey) {\n        var state = getParentBlockName(editor) === blockName.toUpperCase();\n        return state === requiredState;\n      };\n    };\n    var inPreBlock = function (requiredState) {\n      return inBlock('pre', requiredState);\n    };\n    var inSummaryBlock = function () {\n      return inBlock('summary', true);\n    };\n    var shouldPutBrInPre$1 = function (requiredState) {\n      return function (editor, _shiftKey) {\n        return shouldPutBrInPre(editor) === requiredState;\n      };\n    };\n    var inBrContext = function (editor, _shiftKey) {\n      return shouldInsertBr(editor);\n    };\n    var hasShiftKey = function (_editor, shiftKey) {\n      return shiftKey;\n    };\n    var canInsertIntoEditableRoot = function (editor) {\n      var forcedRootBlock = getForcedRootBlock(editor);\n      var rootEditable = getEditableRoot(editor.dom, editor.selection.getStart());\n      return rootEditable && editor.schema.isValidChild(rootEditable.nodeName, forcedRootBlock ? forcedRootBlock : 'P');\n    };\n    var match$2 = function (predicates, action) {\n      return function (editor, shiftKey) {\n        var isMatch = foldl(predicates, function (res, p) {\n          return res && p(editor, shiftKey);\n        }, true);\n        return isMatch ? Optional.some(action) : Optional.none();\n      };\n    };\n    var getAction$1 = function (editor, evt) {\n      return evaluateUntil([\n        match$2([shouldBlockNewLine$1], newLineAction.none()),\n        match$2([inSummaryBlock()], newLineAction.br()),\n        match$2([\n          inPreBlock(true),\n          shouldPutBrInPre$1(false),\n          hasShiftKey\n        ], newLineAction.br()),\n        match$2([\n          inPreBlock(true),\n          shouldPutBrInPre$1(false)\n        ], newLineAction.block()),\n        match$2([\n          inPreBlock(true),\n          shouldPutBrInPre$1(true),\n          hasShiftKey\n        ], newLineAction.block()),\n        match$2([\n          inPreBlock(true),\n          shouldPutBrInPre$1(true)\n        ], newLineAction.br()),\n        match$2([\n          inListBlock(true),\n          hasShiftKey\n        ], newLineAction.br()),\n        match$2([inListBlock(true)], newLineAction.block()),\n        match$2([\n          isBrMode(true),\n          hasShiftKey,\n          canInsertIntoEditableRoot\n        ], newLineAction.block()),\n        match$2([isBrMode(true)], newLineAction.br()),\n        match$2([inBrContext], newLineAction.br()),\n        match$2([\n          isBrMode(false),\n          hasShiftKey\n        ], newLineAction.br()),\n        match$2([canInsertIntoEditableRoot], newLineAction.block())\n      ], [\n        editor,\n        !!(evt && evt.shiftKey)\n      ]).getOr(newLineAction.none());\n    };\n\n    var insert$3 = function (editor, evt) {\n      getAction$1(editor, evt).fold(function () {\n        insert$2(editor, evt);\n      }, function () {\n        insert$1(editor, evt);\n      }, noop);\n    };\n\n    var handleEnterKeyEvent = function (editor, event) {\n      if (event.isDefaultPrevented()) {\n        return;\n      }\n      event.preventDefault();\n      endTypingLevelIgnoreLocks(editor.undoManager);\n      editor.undoManager.transact(function () {\n        if (editor.selection.isCollapsed() === false) {\n          editor.execCommand('Delete');\n        }\n        insert$3(editor, event);\n      });\n    };\n    var setup$e = function (editor) {\n      editor.on('keydown', function (event) {\n        if (event.keyCode === VK.ENTER) {\n          handleEnterKeyEvent(editor, event);\n        }\n      });\n    };\n\n    var executeKeydownOverride$2 = function (editor, caret, evt) {\n      execute([\n        {\n          keyCode: VK.END,\n          action: action(moveToLineEndPoint$2, editor, true)\n        },\n        {\n          keyCode: VK.HOME,\n          action: action(moveToLineEndPoint$2, editor, false)\n        },\n        {\n          keyCode: VK.END,\n          action: action(moveToLineEndPoint$3, editor, true)\n        },\n        {\n          keyCode: VK.HOME,\n          action: action(moveToLineEndPoint$3, editor, false)\n        },\n        {\n          keyCode: VK.END,\n          action: action(moveToLineEndPoint$1, editor, true, caret)\n        },\n        {\n          keyCode: VK.HOME,\n          action: action(moveToLineEndPoint$1, editor, false, caret)\n        }\n      ], evt).each(function (_) {\n        evt.preventDefault();\n      });\n    };\n    var setup$f = function (editor, caret) {\n      editor.on('keydown', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeydownOverride$2(editor, caret, evt);\n        }\n      });\n    };\n\n    var browser$4 = detect$3().browser;\n    var setupIeInput = function (editor) {\n      var keypressThrotter = first(function () {\n        if (!editor.composing) {\n          normalizeNbspsInEditor(editor);\n        }\n      }, 0);\n      if (browser$4.isIE()) {\n        editor.on('keypress', function (_e) {\n          keypressThrotter.throttle();\n        });\n        editor.on('remove', function (_e) {\n          keypressThrotter.cancel();\n        });\n      }\n    };\n    var setup$g = function (editor) {\n      setupIeInput(editor);\n      editor.on('input', function (e) {\n        if (e.isComposing === false) {\n          normalizeNbspsInEditor(editor);\n        }\n      });\n    };\n\n    var platform$2 = detect$3();\n    var executeKeyupAction = function (editor, caret, evt) {\n      execute([\n        {\n          keyCode: VK.PAGE_UP,\n          action: action(moveToLineEndPoint$1, editor, false, caret)\n        },\n        {\n          keyCode: VK.PAGE_DOWN,\n          action: action(moveToLineEndPoint$1, editor, true, caret)\n        }\n      ], evt);\n    };\n    var stopImmediatePropagation = function (e) {\n      return e.stopImmediatePropagation();\n    };\n    var isPageUpDown = function (evt) {\n      return evt.keyCode === VK.PAGE_UP || evt.keyCode === VK.PAGE_DOWN;\n    };\n    var setNodeChangeBlocker = function (blocked, editor, block) {\n      if (block && !blocked.get()) {\n        editor.on('NodeChange', stopImmediatePropagation, true);\n      } else if (!block && blocked.get()) {\n        editor.off('NodeChange', stopImmediatePropagation);\n      }\n      blocked.set(block);\n    };\n    var setup$h = function (editor, caret) {\n      if (platform$2.os.isOSX()) {\n        return;\n      }\n      var blocked = Cell(false);\n      editor.on('keydown', function (evt) {\n        if (isPageUpDown(evt)) {\n          setNodeChangeBlocker(blocked, editor, true);\n        }\n      });\n      editor.on('keyup', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeyupAction(editor, caret, evt);\n        }\n        if (isPageUpDown(evt) && blocked.get()) {\n          setNodeChangeBlocker(blocked, editor, false);\n          editor.nodeChanged();\n        }\n      });\n    };\n\n    var insertTextAtPosition = function (text, pos) {\n      var container = pos.container();\n      var offset = pos.offset();\n      if (isText$1(container)) {\n        container.insertData(offset, text);\n        return Optional.some(CaretPosition(container, offset + text.length));\n      } else {\n        return getElementFromPosition(pos).map(function (elm) {\n          var textNode = SugarElement.fromText(text);\n          if (pos.isAtEnd()) {\n            after(elm, textNode);\n          } else {\n            before(elm, textNode);\n          }\n          return CaretPosition(textNode.dom, text.length);\n        });\n      }\n    };\n    var insertNbspAtPosition = curry(insertTextAtPosition, nbsp);\n    var insertSpaceAtPosition = curry(insertTextAtPosition, ' ');\n\n    var locationToCaretPosition = function (root) {\n      return function (location) {\n        return location.fold(function (element) {\n          return prevPosition(root.dom, CaretPosition.before(element));\n        }, function (element) {\n          return firstPositionIn(element);\n        }, function (element) {\n          return lastPositionIn(element);\n        }, function (element) {\n          return nextPosition(root.dom, CaretPosition.after(element));\n        });\n      };\n    };\n    var insertInlineBoundarySpaceOrNbsp = function (root, pos) {\n      return function (checkPos) {\n        return needsToHaveNbsp(root, checkPos) ? insertNbspAtPosition(pos) : insertSpaceAtPosition(pos);\n      };\n    };\n    var setSelection$1 = function (editor) {\n      return function (pos) {\n        editor.selection.setRng(pos.toRange());\n        editor.nodeChanged();\n        return true;\n      };\n    };\n    var insertSpaceOrNbspAtSelection = function (editor) {\n      var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n      var root = SugarElement.fromDom(editor.getBody());\n      if (editor.selection.isCollapsed()) {\n        var isInlineTarget$1 = curry(isInlineTarget, editor);\n        var caretPosition = CaretPosition.fromRangeStart(editor.selection.getRng());\n        return readLocation(isInlineTarget$1, editor.getBody(), caretPosition).bind(locationToCaretPosition(root)).bind(insertInlineBoundarySpaceOrNbsp(root, pos)).exists(setSelection$1(editor));\n      } else {\n        return false;\n      }\n    };\n\n    var executeKeydownOverride$3 = function (editor, evt) {\n      execute([{\n          keyCode: VK.SPACEBAR,\n          action: action(insertSpaceOrNbspAtSelection, editor)\n        }], evt).each(function (_) {\n        evt.preventDefault();\n      });\n    };\n    var setup$i = function (editor) {\n      editor.on('keydown', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeydownOverride$3(editor, evt);\n        }\n      });\n    };\n\n    var registerKeyboardOverrides = function (editor) {\n      var caret = setupSelectedState(editor);\n      setup$b(editor);\n      setup$c(editor, caret);\n      setup$d(editor, caret);\n      setup$e(editor);\n      setup$i(editor);\n      setup$g(editor);\n      setup$f(editor, caret);\n      setup$h(editor, caret);\n      return caret;\n    };\n    var setup$j = function (editor) {\n      if (!isRtc(editor)) {\n        return registerKeyboardOverrides(editor);\n      } else {\n        return Cell(null);\n      }\n    };\n\n    var NodeChange = function () {\n      function NodeChange(editor) {\n        this.lastPath = [];\n        this.editor = editor;\n        var lastRng;\n        var self = this;\n        if (!('onselectionchange' in editor.getDoc())) {\n          editor.on('NodeChange click mouseup keyup focus', function (e) {\n            var nativeRng = editor.selection.getRng();\n            var fakeRng = {\n              startContainer: nativeRng.startContainer,\n              startOffset: nativeRng.startOffset,\n              endContainer: nativeRng.endContainer,\n              endOffset: nativeRng.endOffset\n            };\n            if (e.type === 'nodechange' || !isEq$1(fakeRng, lastRng)) {\n              editor.fire('SelectionChange');\n            }\n            lastRng = fakeRng;\n          });\n        }\n        editor.on('contextmenu', function () {\n          editor.fire('SelectionChange');\n        });\n        editor.on('SelectionChange', function () {\n          var startElm = editor.selection.getStart(true);\n          if (!startElm || !Env.range && editor.selection.isCollapsed()) {\n            return;\n          }\n          if (hasAnyRanges(editor) && !self.isSameElementPath(startElm) && editor.dom.isChildOf(startElm, editor.getBody())) {\n            editor.nodeChanged({ selectionChange: true });\n          }\n        });\n        editor.on('mouseup', function (e) {\n          if (!e.isDefaultPrevented() && hasAnyRanges(editor)) {\n            if (editor.selection.getNode().nodeName === 'IMG') {\n              Delay.setEditorTimeout(editor, function () {\n                editor.nodeChanged();\n              });\n            } else {\n              editor.nodeChanged();\n            }\n          }\n        });\n      }\n      NodeChange.prototype.nodeChanged = function (args) {\n        var selection = this.editor.selection;\n        var node, parents, root;\n        if (this.editor.initialized && selection && !shouldDisableNodeChange(this.editor) && !this.editor.mode.isReadOnly()) {\n          root = this.editor.getBody();\n          node = selection.getStart(true) || root;\n          if (node.ownerDocument !== this.editor.getDoc() || !this.editor.dom.isChildOf(node, root)) {\n            node = root;\n          }\n          parents = [];\n          this.editor.dom.getParent(node, function (node) {\n            if (node === root) {\n              return true;\n            }\n            parents.push(node);\n          });\n          args = args || {};\n          args.element = node;\n          args.parents = parents;\n          this.editor.fire('NodeChange', args);\n        }\n      };\n      NodeChange.prototype.isSameElementPath = function (startElm) {\n        var i;\n        var currentPath = this.editor.$(startElm).parentsUntil(this.editor.getBody()).add(startElm);\n        if (currentPath.length === this.lastPath.length) {\n          for (i = currentPath.length; i >= 0; i--) {\n            if (currentPath[i] !== this.lastPath[i]) {\n              break;\n            }\n          }\n          if (i === -1) {\n            this.lastPath = currentPath;\n            return true;\n          }\n        }\n        this.lastPath = currentPath;\n        return false;\n      };\n      return NodeChange;\n    }();\n\n    var preventSummaryToggle = function (editor) {\n      editor.on('click', function (e) {\n        if (editor.dom.getParent(e.target, 'details')) {\n          e.preventDefault();\n        }\n      });\n    };\n    var filterDetails = function (editor) {\n      editor.parser.addNodeFilter('details', function (elms) {\n        each(elms, function (details) {\n          details.attr('data-mce-open', details.attr('open'));\n          details.attr('open', 'open');\n        });\n      });\n      editor.serializer.addNodeFilter('details', function (elms) {\n        each(elms, function (details) {\n          var open = details.attr('data-mce-open');\n          details.attr('open', isString(open) ? open : null);\n          details.attr('data-mce-open', null);\n        });\n      });\n    };\n    var setup$k = function (editor) {\n      preventSummaryToggle(editor);\n      filterDetails(editor);\n    };\n\n    var isTextBlockNode = function (node) {\n      return isElement$1(node) && isTextBlock(SugarElement.fromDom(node));\n    };\n    var normalizeSelection$1 = function (editor) {\n      var rng = editor.selection.getRng();\n      var startPos = CaretPosition.fromRangeStart(rng);\n      var endPos = CaretPosition.fromRangeEnd(rng);\n      if (CaretPosition.isElementPosition(startPos)) {\n        var container = startPos.container();\n        if (isTextBlockNode(container)) {\n          firstPositionIn(container).each(function (pos) {\n            return rng.setStart(pos.container(), pos.offset());\n          });\n        }\n      }\n      if (CaretPosition.isElementPosition(endPos)) {\n        var container = startPos.container();\n        if (isTextBlockNode(container)) {\n          lastPositionIn(container).each(function (pos) {\n            return rng.setEnd(pos.container(), pos.offset());\n          });\n        }\n      }\n      editor.selection.setRng(normalize$2(rng));\n    };\n    var setup$l = function (editor) {\n      editor.on('click', function (e) {\n        if (e.detail >= 3) {\n          normalizeSelection$1(editor);\n        }\n      });\n    };\n\n    var value$1 = function () {\n      var subject = Cell(Optional.none());\n      var clear = function () {\n        return subject.set(Optional.none());\n      };\n      var set = function (s) {\n        return subject.set(Optional.some(s));\n      };\n      var isSet = function () {\n        return subject.get().isSome();\n      };\n      var on = function (f) {\n        return subject.get().each(f);\n      };\n      return {\n        clear: clear,\n        set: set,\n        isSet: isSet,\n        on: on\n      };\n    };\n\n    var getAbsolutePosition = function (elm) {\n      var clientRect = elm.getBoundingClientRect();\n      var doc = elm.ownerDocument;\n      var docElem = doc.documentElement;\n      var win = doc.defaultView;\n      return {\n        top: clientRect.top + win.pageYOffset - docElem.clientTop,\n        left: clientRect.left + win.pageXOffset - docElem.clientLeft\n      };\n    };\n    var getBodyPosition = function (editor) {\n      return editor.inline ? getAbsolutePosition(editor.getBody()) : {\n        left: 0,\n        top: 0\n      };\n    };\n    var getScrollPosition = function (editor) {\n      var body = editor.getBody();\n      return editor.inline ? {\n        left: body.scrollLeft,\n        top: body.scrollTop\n      } : {\n        left: 0,\n        top: 0\n      };\n    };\n    var getBodyScroll = function (editor) {\n      var body = editor.getBody(), docElm = editor.getDoc().documentElement;\n      var inlineScroll = {\n        left: body.scrollLeft,\n        top: body.scrollTop\n      };\n      var iframeScroll = {\n        left: body.scrollLeft || docElm.scrollLeft,\n        top: body.scrollTop || docElm.scrollTop\n      };\n      return editor.inline ? inlineScroll : iframeScroll;\n    };\n    var getMousePosition = function (editor, event) {\n      if (event.target.ownerDocument !== editor.getDoc()) {\n        var iframePosition = getAbsolutePosition(editor.getContentAreaContainer());\n        var scrollPosition = getBodyScroll(editor);\n        return {\n          left: event.pageX - iframePosition.left + scrollPosition.left,\n          top: event.pageY - iframePosition.top + scrollPosition.top\n        };\n      }\n      return {\n        left: event.pageX,\n        top: event.pageY\n      };\n    };\n    var calculatePosition = function (bodyPosition, scrollPosition, mousePosition) {\n      return {\n        pageX: mousePosition.left - bodyPosition.left + scrollPosition.left,\n        pageY: mousePosition.top - bodyPosition.top + scrollPosition.top\n      };\n    };\n    var calc = function (editor, event) {\n      return calculatePosition(getBodyPosition(editor), getScrollPosition(editor), getMousePosition(editor, event));\n    };\n\n    var isContentEditableFalse$a = isContentEditableFalse, isContentEditableTrue$3 = isContentEditableTrue;\n    var isDraggable = function (rootElm, elm) {\n      return isContentEditableFalse$a(elm) && elm !== rootElm;\n    };\n    var isValidDropTarget = function (editor, targetElement, dragElement) {\n      if (targetElement === dragElement || editor.dom.isChildOf(targetElement, dragElement)) {\n        return false;\n      }\n      return !isContentEditableFalse$a(targetElement);\n    };\n    var cloneElement = function (elm) {\n      var cloneElm = elm.cloneNode(true);\n      cloneElm.removeAttribute('data-mce-selected');\n      return cloneElm;\n    };\n    var createGhost = function (editor, elm, width, height) {\n      var dom = editor.dom;\n      var clonedElm = elm.cloneNode(true);\n      dom.setStyles(clonedElm, {\n        width: width,\n        height: height\n      });\n      dom.setAttrib(clonedElm, 'data-mce-selected', null);\n      var ghostElm = dom.create('div', {\n        'class': 'mce-drag-container',\n        'data-mce-bogus': 'all',\n        'unselectable': 'on',\n        'contenteditable': 'false'\n      });\n      dom.setStyles(ghostElm, {\n        position: 'absolute',\n        opacity: 0.5,\n        overflow: 'hidden',\n        border: 0,\n        padding: 0,\n        margin: 0,\n        width: width,\n        height: height\n      });\n      dom.setStyles(clonedElm, {\n        margin: 0,\n        boxSizing: 'border-box'\n      });\n      ghostElm.appendChild(clonedElm);\n      return ghostElm;\n    };\n    var appendGhostToBody = function (ghostElm, bodyElm) {\n      if (ghostElm.parentNode !== bodyElm) {\n        bodyElm.appendChild(ghostElm);\n      }\n    };\n    var moveGhost = function (ghostElm, position, width, height, maxX, maxY) {\n      var overflowX = 0, overflowY = 0;\n      ghostElm.style.left = position.pageX + 'px';\n      ghostElm.style.top = position.pageY + 'px';\n      if (position.pageX + width > maxX) {\n        overflowX = position.pageX + width - maxX;\n      }\n      if (position.pageY + height > maxY) {\n        overflowY = position.pageY + height - maxY;\n      }\n      ghostElm.style.width = width - overflowX + 'px';\n      ghostElm.style.height = height - overflowY + 'px';\n    };\n    var removeElement = function (elm) {\n      if (elm && elm.parentNode) {\n        elm.parentNode.removeChild(elm);\n      }\n    };\n    var isLeftMouseButtonPressed = function (e) {\n      return e.button === 0;\n    };\n    var applyRelPos = function (state, position) {\n      return {\n        pageX: position.pageX - state.relX,\n        pageY: position.pageY + 5\n      };\n    };\n    var start$1 = function (state, editor) {\n      return function (e) {\n        if (isLeftMouseButtonPressed(e)) {\n          var ceElm = find(editor.dom.getParents(e.target), or(isContentEditableFalse$a, isContentEditableTrue$3)).getOr(null);\n          if (isDraggable(editor.getBody(), ceElm)) {\n            var elmPos = editor.dom.getPos(ceElm);\n            var bodyElm = editor.getBody();\n            var docElm = editor.getDoc().documentElement;\n            state.set({\n              element: ceElm,\n              dragging: false,\n              screenX: e.screenX,\n              screenY: e.screenY,\n              maxX: (editor.inline ? bodyElm.scrollWidth : docElm.offsetWidth) - 2,\n              maxY: (editor.inline ? bodyElm.scrollHeight : docElm.offsetHeight) - 2,\n              relX: e.pageX - elmPos.x,\n              relY: e.pageY - elmPos.y,\n              width: ceElm.offsetWidth,\n              height: ceElm.offsetHeight,\n              ghost: createGhost(editor, ceElm, ceElm.offsetWidth, ceElm.offsetHeight)\n            });\n          }\n        }\n      };\n    };\n    var move$2 = function (state, editor) {\n      var throttledPlaceCaretAt = Delay.throttle(function (clientX, clientY) {\n        editor._selectionOverrides.hideFakeCaret();\n        editor.selection.placeCaretAt(clientX, clientY);\n      }, 0);\n      editor.on('remove', throttledPlaceCaretAt.stop);\n      return function (e) {\n        return state.on(function (state) {\n          var movement = Math.max(Math.abs(e.screenX - state.screenX), Math.abs(e.screenY - state.screenY));\n          if (!state.dragging && movement > 10) {\n            var args = editor.fire('dragstart', { target: state.element });\n            if (args.isDefaultPrevented()) {\n              return;\n            }\n            state.dragging = true;\n            editor.focus();\n          }\n          if (state.dragging) {\n            var targetPos = applyRelPos(state, calc(editor, e));\n            appendGhostToBody(state.ghost, editor.getBody());\n            moveGhost(state.ghost, targetPos, state.width, state.height, state.maxX, state.maxY);\n            throttledPlaceCaretAt(e.clientX, e.clientY);\n          }\n        });\n      };\n    };\n    var getRawTarget = function (selection) {\n      var rng = selection.getSel().getRangeAt(0);\n      var startContainer = rng.startContainer;\n      return startContainer.nodeType === 3 ? startContainer.parentNode : startContainer;\n    };\n    var drop = function (state, editor) {\n      return function (e) {\n        state.on(function (state) {\n          if (state.dragging) {\n            if (isValidDropTarget(editor, getRawTarget(editor.selection), state.element)) {\n              var targetClone_1 = cloneElement(state.element);\n              var args = editor.fire('drop', {\n                clientX: e.clientX,\n                clientY: e.clientY\n              });\n              if (!args.isDefaultPrevented()) {\n                editor.undoManager.transact(function () {\n                  removeElement(state.element);\n                  editor.insertContent(editor.dom.getOuterHTML(targetClone_1));\n                  editor._selectionOverrides.hideFakeCaret();\n                });\n              }\n            }\n          }\n        });\n        removeDragState(state);\n      };\n    };\n    var stop = function (state, editor) {\n      return function () {\n        state.on(function (state) {\n          if (state.dragging) {\n            editor.fire('dragend');\n          }\n        });\n        removeDragState(state);\n      };\n    };\n    var removeDragState = function (state) {\n      state.on(function (state) {\n        removeElement(state.ghost);\n      });\n      state.clear();\n    };\n    var bindFakeDragEvents = function (editor) {\n      var state = value$1();\n      var pageDom = DOMUtils.DOM;\n      var rootDocument = document;\n      var dragStartHandler = start$1(state, editor);\n      var dragHandler = move$2(state, editor);\n      var dropHandler = drop(state, editor);\n      var dragEndHandler = stop(state, editor);\n      editor.on('mousedown', dragStartHandler);\n      editor.on('mousemove', dragHandler);\n      editor.on('mouseup', dropHandler);\n      pageDom.bind(rootDocument, 'mousemove', dragHandler);\n      pageDom.bind(rootDocument, 'mouseup', dragEndHandler);\n      editor.on('remove', function () {\n        pageDom.unbind(rootDocument, 'mousemove', dragHandler);\n        pageDom.unbind(rootDocument, 'mouseup', dragEndHandler);\n      });\n    };\n    var blockIeDrop = function (editor) {\n      editor.on('drop', function (e) {\n        var realTarget = typeof e.clientX !== 'undefined' ? editor.getDoc().elementFromPoint(e.clientX, e.clientY) : null;\n        if (isContentEditableFalse$a(realTarget) || editor.dom.getContentEditableParent(realTarget) === 'false') {\n          e.preventDefault();\n        }\n      });\n    };\n    var blockUnsupportedFileDrop = function (editor) {\n      var preventFileDrop = function (e) {\n        if (!e.isDefaultPrevented()) {\n          var dataTransfer = e.dataTransfer;\n          if (dataTransfer && (contains(dataTransfer.types, 'Files') || dataTransfer.files.length > 0)) {\n            e.preventDefault();\n            if (e.type === 'drop') {\n              displayError(editor, 'Dropped file type is not supported');\n            }\n          }\n        }\n      };\n      var preventFileDropIfUIElement = function (e) {\n        if (isUIElement(editor, e.target)) {\n          preventFileDrop(e);\n        }\n      };\n      var setup = function () {\n        var pageDom = DOMUtils.DOM;\n        var dom = editor.dom;\n        var doc = document;\n        var editorRoot = editor.inline ? editor.getBody() : editor.getDoc();\n        var eventNames = [\n          'drop',\n          'dragover'\n        ];\n        each(eventNames, function (name) {\n          pageDom.bind(doc, name, preventFileDropIfUIElement);\n          dom.bind(editorRoot, name, preventFileDrop);\n        });\n        editor.on('remove', function () {\n          each(eventNames, function (name) {\n            pageDom.unbind(doc, name, preventFileDropIfUIElement);\n            dom.unbind(editorRoot, name, preventFileDrop);\n          });\n        });\n      };\n      editor.on('init', function () {\n        Delay.setEditorTimeout(editor, setup, 0);\n      });\n    };\n    var init = function (editor) {\n      bindFakeDragEvents(editor);\n      blockIeDrop(editor);\n      if (shouldBlockUnsupportedDrop(editor)) {\n        blockUnsupportedFileDrop(editor);\n      }\n    };\n\n    var setup$m = function (editor) {\n      var renderFocusCaret = first(function () {\n        if (!editor.removed && editor.getBody().contains(document.activeElement)) {\n          var rng = editor.selection.getRng();\n          if (rng.collapsed) {\n            var caretRange = renderRangeCaret(editor, rng, false);\n            editor.selection.setRng(caretRange);\n          }\n        }\n      }, 0);\n      editor.on('focus', function () {\n        renderFocusCaret.throttle();\n      });\n      editor.on('blur', function () {\n        renderFocusCaret.cancel();\n      });\n    };\n\n    var setup$n = function (editor) {\n      editor.on('init', function () {\n        editor.on('focusin', function (e) {\n          var target = e.target;\n          if (isMedia(target)) {\n            var ceRoot = getContentEditableRoot(editor.getBody(), target);\n            var node = isContentEditableFalse(ceRoot) ? ceRoot : target;\n            if (editor.selection.getNode() !== node) {\n              selectNode(editor, node).each(function (rng) {\n                return editor.selection.setRng(rng);\n              });\n            }\n          }\n        });\n      });\n    };\n\n    var isContentEditableTrue$4 = isContentEditableTrue;\n    var isContentEditableFalse$b = isContentEditableFalse;\n    var getContentEditableRoot$1 = function (editor, node) {\n      return getContentEditableRoot(editor.getBody(), node);\n    };\n    var SelectionOverrides = function (editor) {\n      var selection = editor.selection, dom = editor.dom;\n      var isBlock = dom.isBlock;\n      var rootNode = editor.getBody();\n      var fakeCaret = FakeCaret(editor, rootNode, isBlock, function () {\n        return hasFocus$1(editor);\n      });\n      var realSelectionId = 'sel-' + dom.uniqueId();\n      var elementSelectionAttr = 'data-mce-selected';\n      var selectedElement;\n      var isFakeSelectionElement = function (node) {\n        return dom.hasClass(node, 'mce-offscreen-selection');\n      };\n      var isFakeSelectionTargetElement = function (node) {\n        return node !== rootNode && (isContentEditableFalse$b(node) || isMedia(node)) && dom.isChildOf(node, rootNode);\n      };\n      var isNearFakeSelectionElement = function (pos) {\n        return isBeforeContentEditableFalse(pos) || isAfterContentEditableFalse(pos) || isBeforeMedia(pos) || isAfterMedia(pos);\n      };\n      var getRealSelectionElement = function () {\n        var container = dom.get(realSelectionId);\n        return container ? container.getElementsByTagName('*')[0] : container;\n      };\n      var setRange = function (range) {\n        if (range) {\n          selection.setRng(range);\n        }\n      };\n      var getRange = selection.getRng;\n      var showCaret = function (direction, node, before, scrollIntoView) {\n        if (scrollIntoView === void 0) {\n          scrollIntoView = true;\n        }\n        var e = editor.fire('ShowCaret', {\n          target: node,\n          direction: direction,\n          before: before\n        });\n        if (e.isDefaultPrevented()) {\n          return null;\n        }\n        if (scrollIntoView) {\n          selection.scrollIntoView(node, direction === -1);\n        }\n        return fakeCaret.show(before, node);\n      };\n      var showBlockCaretContainer = function (blockCaretContainer) {\n        if (blockCaretContainer.hasAttribute('data-mce-caret')) {\n          showCaretContainerBlock(blockCaretContainer);\n          setRange(getRange());\n          selection.scrollIntoView(blockCaretContainer);\n        }\n      };\n      var registerEvents = function () {\n        editor.on('mouseup', function (e) {\n          var range = getRange();\n          if (range.collapsed && isXYInContentArea(editor, e.clientX, e.clientY)) {\n            renderCaretAtRange(editor, range, false).each(setRange);\n          }\n        });\n        editor.on('click', function (e) {\n          var contentEditableRoot = getContentEditableRoot$1(editor, e.target);\n          if (contentEditableRoot) {\n            if (isContentEditableFalse$b(contentEditableRoot)) {\n              e.preventDefault();\n              editor.focus();\n            }\n            if (isContentEditableTrue$4(contentEditableRoot)) {\n              if (dom.isChildOf(contentEditableRoot, selection.getNode())) {\n                removeElementSelection();\n              }\n            }\n          }\n        });\n        editor.on('blur NewBlock', removeElementSelection);\n        editor.on('ResizeWindow FullscreenStateChanged', fakeCaret.reposition);\n        var hasNormalCaretPosition = function (elm) {\n          var caretWalker = CaretWalker(elm);\n          if (!elm.firstChild) {\n            return false;\n          }\n          var startPos = CaretPosition.before(elm.firstChild);\n          var newPos = caretWalker.next(startPos);\n          return newPos && !isNearFakeSelectionElement(newPos);\n        };\n        var isInSameBlock = function (node1, node2) {\n          var block1 = dom.getParent(node1, isBlock);\n          var block2 = dom.getParent(node2, isBlock);\n          return block1 === block2;\n        };\n        var hasBetterMouseTarget = function (targetNode, caretNode) {\n          var targetBlock = dom.getParent(targetNode, isBlock);\n          var caretBlock = dom.getParent(caretNode, isBlock);\n          if (targetBlock && targetNode !== caretBlock && dom.isChildOf(targetBlock, caretBlock) && isContentEditableFalse$b(getContentEditableRoot$1(editor, targetBlock)) === false) {\n            return true;\n          }\n          return targetBlock && !isInSameBlock(targetBlock, caretBlock) && hasNormalCaretPosition(targetBlock);\n        };\n        editor.on('tap', function (e) {\n          var targetElm = e.target;\n          var contentEditableRoot = getContentEditableRoot$1(editor, targetElm);\n          if (isContentEditableFalse$b(contentEditableRoot)) {\n            e.preventDefault();\n            selectNode(editor, contentEditableRoot).each(setElementSelection);\n          } else if (isFakeSelectionTargetElement(targetElm)) {\n            selectNode(editor, targetElm).each(setElementSelection);\n          }\n        }, true);\n        editor.on('mousedown', function (e) {\n          var targetElm = e.target;\n          if (targetElm !== rootNode && targetElm.nodeName !== 'HTML' && !dom.isChildOf(targetElm, rootNode)) {\n            return;\n          }\n          if (isXYInContentArea(editor, e.clientX, e.clientY) === false) {\n            return;\n          }\n          var contentEditableRoot = getContentEditableRoot$1(editor, targetElm);\n          if (contentEditableRoot) {\n            if (isContentEditableFalse$b(contentEditableRoot)) {\n              e.preventDefault();\n              selectNode(editor, contentEditableRoot).each(setElementSelection);\n            } else {\n              removeElementSelection();\n              if (!(isContentEditableTrue$4(contentEditableRoot) && e.shiftKey) && !isXYWithinRange(e.clientX, e.clientY, selection.getRng())) {\n                hideFakeCaret();\n                selection.placeCaretAt(e.clientX, e.clientY);\n              }\n            }\n          } else if (isFakeSelectionTargetElement(targetElm)) {\n            selectNode(editor, targetElm).each(setElementSelection);\n          } else if (isFakeCaretTarget(targetElm) === false) {\n            removeElementSelection();\n            hideFakeCaret();\n            var fakeCaretInfo = closestFakeCaret(rootNode, e.clientX, e.clientY);\n            if (fakeCaretInfo) {\n              if (!hasBetterMouseTarget(targetElm, fakeCaretInfo.node)) {\n                e.preventDefault();\n                var range = showCaret(1, fakeCaretInfo.node, fakeCaretInfo.before, false);\n                editor.getBody().focus();\n                setRange(range);\n              }\n            }\n          }\n        });\n        editor.on('keypress', function (e) {\n          if (VK.modifierPressed(e)) {\n            return;\n          }\n          if (isContentEditableFalse$b(selection.getNode())) {\n            e.preventDefault();\n          }\n        });\n        editor.on('GetSelectionRange', function (e) {\n          var rng = e.range;\n          if (selectedElement) {\n            if (!selectedElement.parentNode) {\n              selectedElement = null;\n              return;\n            }\n            rng = rng.cloneRange();\n            rng.selectNode(selectedElement);\n            e.range = rng;\n          }\n        });\n        editor.on('SetSelectionRange', function (e) {\n          e.range = normalizeShortEndedElementSelection(e.range);\n          var rng = setElementSelection(e.range, e.forward);\n          if (rng) {\n            e.range = rng;\n          }\n        });\n        var isPasteBin = function (node) {\n          return node.id === 'mcepastebin';\n        };\n        editor.on('AfterSetSelectionRange', function (e) {\n          var rng = e.range;\n          var parentNode = rng.startContainer.parentNode;\n          if (!isRangeInCaretContainer(rng) && !isPasteBin(parentNode)) {\n            hideFakeCaret();\n          }\n          if (!isFakeSelectionElement(parentNode)) {\n            removeElementSelection();\n          }\n        });\n        editor.on('copy', function (e) {\n          var clipboardData = e.clipboardData;\n          if (!e.isDefaultPrevented() && e.clipboardData && !Env.ie) {\n            var realSelectionElement = getRealSelectionElement();\n            if (realSelectionElement) {\n              e.preventDefault();\n              clipboardData.clearData();\n              clipboardData.setData('text/html', realSelectionElement.outerHTML);\n              clipboardData.setData('text/plain', realSelectionElement.outerText || realSelectionElement.innerText);\n            }\n          }\n        });\n        init(editor);\n        setup$m(editor);\n        setup$n(editor);\n      };\n      var isWithinCaretContainer = function (node) {\n        return isCaretContainer(node) || startsWithCaretContainer(node) || endsWithCaretContainer(node);\n      };\n      var isRangeInCaretContainer = function (rng) {\n        return isWithinCaretContainer(rng.startContainer) || isWithinCaretContainer(rng.endContainer);\n      };\n      var normalizeShortEndedElementSelection = function (rng) {\n        var shortEndedElements = editor.schema.getShortEndedElements();\n        var newRng = dom.createRng();\n        var startContainer = rng.startContainer;\n        var startOffset = rng.startOffset;\n        var endContainer = rng.endContainer;\n        var endOffset = rng.endOffset;\n        if (has(shortEndedElements, startContainer.nodeName.toLowerCase())) {\n          if (startOffset === 0) {\n            newRng.setStartBefore(startContainer);\n          } else {\n            newRng.setStartAfter(startContainer);\n          }\n        } else {\n          newRng.setStart(startContainer, startOffset);\n        }\n        if (has(shortEndedElements, endContainer.nodeName.toLowerCase())) {\n          if (endOffset === 0) {\n            newRng.setEndBefore(endContainer);\n          } else {\n            newRng.setEndAfter(endContainer);\n          }\n        } else {\n          newRng.setEnd(endContainer, endOffset);\n        }\n        return newRng;\n      };\n      var setupOffscreenSelection = function (node, targetClone, origTargetClone) {\n        var $ = editor.$;\n        var $realSelectionContainer = descendant(SugarElement.fromDom(editor.getBody()), '#' + realSelectionId).fold(function () {\n          return $([]);\n        }, function (elm) {\n          return $([elm.dom]);\n        });\n        if ($realSelectionContainer.length === 0) {\n          $realSelectionContainer = $('<div data-mce-bogus=\"all\" class=\"mce-offscreen-selection\"></div>').attr('id', realSelectionId);\n          $realSelectionContainer.appendTo(editor.getBody());\n        }\n        var newRange = dom.createRng();\n        if (targetClone === origTargetClone && Env.ie) {\n          $realSelectionContainer.empty().append('<p style=\"font-size: 0\" data-mce-bogus=\"all\">\\xA0</p>').append(targetClone);\n          newRange.setStartAfter($realSelectionContainer[0].firstChild.firstChild);\n          newRange.setEndAfter(targetClone);\n        } else {\n          $realSelectionContainer.empty().append(nbsp).append(targetClone).append(nbsp);\n          newRange.setStart($realSelectionContainer[0].firstChild, 1);\n          newRange.setEnd($realSelectionContainer[0].lastChild, 0);\n        }\n        $realSelectionContainer.css({ top: dom.getPos(node, editor.getBody()).y });\n        $realSelectionContainer[0].focus();\n        var sel = selection.getSel();\n        sel.removeAllRanges();\n        sel.addRange(newRange);\n        return newRange;\n      };\n      var selectElement = function (elm) {\n        var targetClone = elm.cloneNode(true);\n        var e = editor.fire('ObjectSelected', {\n          target: elm,\n          targetClone: targetClone\n        });\n        if (e.isDefaultPrevented()) {\n          return null;\n        }\n        var range = setupOffscreenSelection(elm, e.targetClone, targetClone);\n        var nodeElm = SugarElement.fromDom(elm);\n        each(descendants$1(SugarElement.fromDom(editor.getBody()), '*[data-mce-selected]'), function (elm) {\n          if (!eq$2(nodeElm, elm)) {\n            remove$1(elm, elementSelectionAttr);\n          }\n        });\n        if (!dom.getAttrib(elm, elementSelectionAttr)) {\n          elm.setAttribute(elementSelectionAttr, '1');\n        }\n        selectedElement = elm;\n        hideFakeCaret();\n        return range;\n      };\n      var setElementSelection = function (range, forward) {\n        if (!range) {\n          return null;\n        }\n        if (range.collapsed) {\n          if (!isRangeInCaretContainer(range)) {\n            var dir = forward ? 1 : -1;\n            var caretPosition = getNormalizedRangeEndPoint(dir, rootNode, range);\n            var beforeNode = caretPosition.getNode(!forward);\n            if (isFakeCaretTarget(beforeNode)) {\n              return showCaret(dir, beforeNode, forward ? !caretPosition.isAtEnd() : false, false);\n            }\n            var afterNode = caretPosition.getNode(forward);\n            if (isFakeCaretTarget(afterNode)) {\n              return showCaret(dir, afterNode, forward ? false : !caretPosition.isAtEnd(), false);\n            }\n          }\n          return null;\n        }\n        var startContainer = range.startContainer;\n        var startOffset = range.startOffset;\n        var endOffset = range.endOffset;\n        if (startContainer.nodeType === 3 && startOffset === 0 && isContentEditableFalse$b(startContainer.parentNode)) {\n          startContainer = startContainer.parentNode;\n          startOffset = dom.nodeIndex(startContainer);\n          startContainer = startContainer.parentNode;\n        }\n        if (startContainer.nodeType !== 1) {\n          return null;\n        }\n        if (endOffset === startOffset + 1 && startContainer === range.endContainer) {\n          var node = startContainer.childNodes[startOffset];\n          if (isFakeSelectionTargetElement(node)) {\n            return selectElement(node);\n          }\n        }\n        return null;\n      };\n      var removeElementSelection = function () {\n        if (selectedElement) {\n          selectedElement.removeAttribute(elementSelectionAttr);\n        }\n        descendant(SugarElement.fromDom(editor.getBody()), '#' + realSelectionId).each(remove);\n        selectedElement = null;\n      };\n      var destroy = function () {\n        fakeCaret.destroy();\n        selectedElement = null;\n      };\n      var hideFakeCaret = function () {\n        fakeCaret.hide();\n      };\n      if (Env.ceFalse && !isRtc(editor)) {\n        registerEvents();\n      }\n      return {\n        showCaret: showCaret,\n        showBlockCaretContainer: showBlockCaretContainer,\n        hideFakeCaret: hideFakeCaret,\n        destroy: destroy\n      };\n    };\n\n    var Quirks = function (editor) {\n      var each = Tools.each;\n      var BACKSPACE = VK.BACKSPACE, DELETE = VK.DELETE, dom = editor.dom, selection = editor.selection, parser = editor.parser;\n      var isGecko = Env.gecko, isIE = Env.ie, isWebKit = Env.webkit;\n      var mceInternalUrlPrefix = 'data:text/mce-internal,';\n      var mceInternalDataType = isIE ? 'Text' : 'URL';\n      var setEditorCommandState = function (cmd, state) {\n        try {\n          editor.getDoc().execCommand(cmd, false, state);\n        } catch (ex) {\n        }\n      };\n      var isDefaultPrevented = function (e) {\n        return e.isDefaultPrevented();\n      };\n      var setMceInternalContent = function (e) {\n        var selectionHtml, internalContent;\n        if (e.dataTransfer) {\n          if (editor.selection.isCollapsed() && e.target.tagName === 'IMG') {\n            selection.select(e.target);\n          }\n          selectionHtml = editor.selection.getContent();\n          if (selectionHtml.length > 0) {\n            internalContent = mceInternalUrlPrefix + escape(editor.id) + ',' + escape(selectionHtml);\n            e.dataTransfer.setData(mceInternalDataType, internalContent);\n          }\n        }\n      };\n      var getMceInternalContent = function (e) {\n        var internalContent;\n        if (e.dataTransfer) {\n          internalContent = e.dataTransfer.getData(mceInternalDataType);\n          if (internalContent && internalContent.indexOf(mceInternalUrlPrefix) >= 0) {\n            internalContent = internalContent.substr(mceInternalUrlPrefix.length).split(',');\n            return {\n              id: unescape(internalContent[0]),\n              html: unescape(internalContent[1])\n            };\n          }\n        }\n        return null;\n      };\n      var insertClipboardContents = function (content, internal) {\n        if (editor.queryCommandSupported('mceInsertClipboardContent')) {\n          editor.execCommand('mceInsertClipboardContent', false, {\n            content: content,\n            internal: internal\n          });\n        } else {\n          editor.execCommand('mceInsertContent', false, content);\n        }\n      };\n      var emptyEditorWhenDeleting = function () {\n        var serializeRng = function (rng) {\n          var body = dom.create('body');\n          var contents = rng.cloneContents();\n          body.appendChild(contents);\n          return selection.serializer.serialize(body, { format: 'html' });\n        };\n        var allContentsSelected = function (rng) {\n          var selection = serializeRng(rng);\n          var allRng = dom.createRng();\n          allRng.selectNode(editor.getBody());\n          var allSelection = serializeRng(allRng);\n          return selection === allSelection;\n        };\n        editor.on('keydown', function (e) {\n          var keyCode = e.keyCode;\n          var isCollapsed, body;\n          if (!isDefaultPrevented(e) && (keyCode === DELETE || keyCode === BACKSPACE)) {\n            isCollapsed = editor.selection.isCollapsed();\n            body = editor.getBody();\n            if (isCollapsed && !dom.isEmpty(body)) {\n              return;\n            }\n            if (!isCollapsed && !allContentsSelected(editor.selection.getRng())) {\n              return;\n            }\n            e.preventDefault();\n            editor.setContent('');\n            if (body.firstChild && dom.isBlock(body.firstChild)) {\n              editor.selection.setCursorLocation(body.firstChild, 0);\n            } else {\n              editor.selection.setCursorLocation(body, 0);\n            }\n            editor.nodeChanged();\n          }\n        });\n      };\n      var selectAll = function () {\n        editor.shortcuts.add('meta+a', null, 'SelectAll');\n      };\n      var inputMethodFocus = function () {\n        if (!editor.inline) {\n          dom.bind(editor.getDoc(), 'mousedown mouseup', function (e) {\n            var rng;\n            if (e.target === editor.getDoc().documentElement) {\n              rng = selection.getRng();\n              editor.getBody().focus();\n              if (e.type === 'mousedown') {\n                if (isCaretContainer(rng.startContainer)) {\n                  return;\n                }\n                selection.placeCaretAt(e.clientX, e.clientY);\n              } else {\n                selection.setRng(rng);\n              }\n            }\n          });\n        }\n      };\n      var removeHrOnBackspace = function () {\n        editor.on('keydown', function (e) {\n          if (!isDefaultPrevented(e) && e.keyCode === BACKSPACE) {\n            if (!editor.getBody().getElementsByTagName('hr').length) {\n              return;\n            }\n            if (selection.isCollapsed() && selection.getRng().startOffset === 0) {\n              var node = selection.getNode();\n              var previousSibling = node.previousSibling;\n              if (node.nodeName === 'HR') {\n                dom.remove(node);\n                e.preventDefault();\n                return;\n              }\n              if (previousSibling && previousSibling.nodeName && previousSibling.nodeName.toLowerCase() === 'hr') {\n                dom.remove(previousSibling);\n                e.preventDefault();\n              }\n            }\n          }\n        });\n      };\n      var focusBody = function () {\n        if (!Range.prototype.getClientRects) {\n          editor.on('mousedown', function (e) {\n            if (!isDefaultPrevented(e) && e.target.nodeName === 'HTML') {\n              var body_1 = editor.getBody();\n              body_1.blur();\n              Delay.setEditorTimeout(editor, function () {\n                body_1.focus();\n              });\n            }\n          });\n        }\n      };\n      var selectControlElements = function () {\n        editor.on('click', function (e) {\n          var target = e.target;\n          if (/^(IMG|HR)$/.test(target.nodeName) && dom.getContentEditableParent(target) !== 'false') {\n            e.preventDefault();\n            editor.selection.select(target);\n            editor.nodeChanged();\n          }\n          if (target.nodeName === 'A' && dom.hasClass(target, 'mce-item-anchor')) {\n            e.preventDefault();\n            selection.select(target);\n          }\n        });\n      };\n      var removeStylesWhenDeletingAcrossBlockElements = function () {\n        var getAttributeApplyFunction = function () {\n          var template = dom.getAttribs(selection.getStart().cloneNode(false));\n          return function () {\n            var target = selection.getStart();\n            if (target !== editor.getBody()) {\n              dom.setAttrib(target, 'style', null);\n              each(template, function (attr) {\n                target.setAttributeNode(attr.cloneNode(true));\n              });\n            }\n          };\n        };\n        var isSelectionAcrossElements = function () {\n          return !selection.isCollapsed() && dom.getParent(selection.getStart(), dom.isBlock) !== dom.getParent(selection.getEnd(), dom.isBlock);\n        };\n        editor.on('keypress', function (e) {\n          var applyAttributes;\n          if (!isDefaultPrevented(e) && (e.keyCode === 8 || e.keyCode === 46) && isSelectionAcrossElements()) {\n            applyAttributes = getAttributeApplyFunction();\n            editor.getDoc().execCommand('delete', false, null);\n            applyAttributes();\n            e.preventDefault();\n            return false;\n          }\n        });\n        dom.bind(editor.getDoc(), 'cut', function (e) {\n          var applyAttributes;\n          if (!isDefaultPrevented(e) && isSelectionAcrossElements()) {\n            applyAttributes = getAttributeApplyFunction();\n            Delay.setEditorTimeout(editor, function () {\n              applyAttributes();\n            });\n          }\n        });\n      };\n      var disableBackspaceIntoATable = function () {\n        editor.on('keydown', function (e) {\n          if (!isDefaultPrevented(e) && e.keyCode === BACKSPACE) {\n            if (selection.isCollapsed() && selection.getRng().startOffset === 0) {\n              var previousSibling = selection.getNode().previousSibling;\n              if (previousSibling && previousSibling.nodeName && previousSibling.nodeName.toLowerCase() === 'table') {\n                e.preventDefault();\n                return false;\n              }\n            }\n          }\n        });\n      };\n      var removeBlockQuoteOnBackSpace = function () {\n        editor.on('keydown', function (e) {\n          var rng, parent;\n          if (isDefaultPrevented(e) || e.keyCode !== VK.BACKSPACE) {\n            return;\n          }\n          rng = selection.getRng();\n          var container = rng.startContainer;\n          var offset = rng.startOffset;\n          var root = dom.getRoot();\n          parent = container;\n          if (!rng.collapsed || offset !== 0) {\n            return;\n          }\n          while (parent && parent.parentNode && parent.parentNode.firstChild === parent && parent.parentNode !== root) {\n            parent = parent.parentNode;\n          }\n          if (parent.tagName === 'BLOCKQUOTE') {\n            editor.formatter.toggle('blockquote', null, parent);\n            rng = dom.createRng();\n            rng.setStart(container, 0);\n            rng.setEnd(container, 0);\n            selection.setRng(rng);\n          }\n        });\n      };\n      var setGeckoEditingOptions = function () {\n        var setOpts = function () {\n          setEditorCommandState('StyleWithCSS', false);\n          setEditorCommandState('enableInlineTableEditing', false);\n          if (!getObjectResizing(editor)) {\n            setEditorCommandState('enableObjectResizing', false);\n          }\n        };\n        if (!isReadOnly(editor)) {\n          editor.on('BeforeExecCommand mousedown', setOpts);\n        }\n      };\n      var addBrAfterLastLinks = function () {\n        var fixLinks = function () {\n          each(dom.select('a'), function (node) {\n            var parentNode = node.parentNode;\n            var root = dom.getRoot();\n            if (parentNode.lastChild === node) {\n              while (parentNode && !dom.isBlock(parentNode)) {\n                if (parentNode.parentNode.lastChild !== parentNode || parentNode === root) {\n                  return;\n                }\n                parentNode = parentNode.parentNode;\n              }\n              dom.add(parentNode, 'br', { 'data-mce-bogus': 1 });\n            }\n          });\n        };\n        editor.on('SetContent ExecCommand', function (e) {\n          if (e.type === 'setcontent' || e.command === 'mceInsertLink') {\n            fixLinks();\n          }\n        });\n      };\n      var setDefaultBlockType = function () {\n        if (getForcedRootBlock(editor)) {\n          editor.on('init', function () {\n            setEditorCommandState('DefaultParagraphSeparator', getForcedRootBlock(editor));\n          });\n        }\n      };\n      var normalizeSelection = function () {\n        editor.on('keyup focusin mouseup', function (e) {\n          if (!VK.modifierPressed(e)) {\n            selection.normalize();\n          }\n        }, true);\n      };\n      var showBrokenImageIcon = function () {\n        editor.contentStyles.push('img:-moz-broken {' + '-moz-force-broken-image-icon:1;' + 'min-width:24px;' + 'min-height:24px' + '}');\n      };\n      var restoreFocusOnKeyDown = function () {\n        if (!editor.inline) {\n          editor.on('keydown', function () {\n            if (document.activeElement === document.body) {\n              editor.getWin().focus();\n            }\n          });\n        }\n      };\n      var bodyHeight = function () {\n        if (!editor.inline) {\n          editor.contentStyles.push('body {min-height: 150px}');\n          editor.on('click', function (e) {\n            var rng;\n            if (e.target.nodeName === 'HTML') {\n              if (Env.ie > 11) {\n                editor.getBody().focus();\n                return;\n              }\n              rng = editor.selection.getRng();\n              editor.getBody().focus();\n              editor.selection.setRng(rng);\n              editor.selection.normalize();\n              editor.nodeChanged();\n            }\n          });\n        }\n      };\n      var blockCmdArrowNavigation = function () {\n        if (Env.mac) {\n          editor.on('keydown', function (e) {\n            if (VK.metaKeyPressed(e) && !e.shiftKey && (e.keyCode === 37 || e.keyCode === 39)) {\n              e.preventDefault();\n              var selection_1 = editor.selection.getSel();\n              selection_1.modify('move', e.keyCode === 37 ? 'backward' : 'forward', 'lineboundary');\n            }\n          });\n        }\n      };\n      var disableAutoUrlDetect = function () {\n        setEditorCommandState('AutoUrlDetect', false);\n      };\n      var tapLinksAndImages = function () {\n        editor.on('click', function (e) {\n          var elm = e.target;\n          do {\n            if (elm.tagName === 'A') {\n              e.preventDefault();\n              return;\n            }\n          } while (elm = elm.parentNode);\n        });\n        editor.contentStyles.push('.mce-content-body {-webkit-touch-callout: none}');\n      };\n      var blockFormSubmitInsideEditor = function () {\n        editor.on('init', function () {\n          editor.dom.bind(editor.getBody(), 'submit', function (e) {\n            e.preventDefault();\n          });\n        });\n      };\n      var removeAppleInterchangeBrs = function () {\n        parser.addNodeFilter('br', function (nodes) {\n          var i = nodes.length;\n          while (i--) {\n            if (nodes[i].attr('class') === 'Apple-interchange-newline') {\n              nodes[i].remove();\n            }\n          }\n        });\n      };\n      var ieInternalDragAndDrop = function () {\n        editor.on('dragstart', function (e) {\n          setMceInternalContent(e);\n        });\n        editor.on('drop', function (e) {\n          if (!isDefaultPrevented(e)) {\n            var internalContent = getMceInternalContent(e);\n            if (internalContent && internalContent.id !== editor.id) {\n              e.preventDefault();\n              var rng = fromPoint$1(e.x, e.y, editor.getDoc());\n              selection.setRng(rng);\n              insertClipboardContents(internalContent.html, true);\n            }\n          }\n        });\n      };\n      var refreshContentEditable = noop;\n      var isHidden = function () {\n        if (!isGecko || editor.removed) {\n          return false;\n        }\n        var sel = editor.selection.getSel();\n        return !sel || !sel.rangeCount || sel.rangeCount === 0;\n      };\n      var setupRtc = function () {\n        if (isWebKit) {\n          selectControlElements();\n          blockFormSubmitInsideEditor();\n          selectAll();\n          if (Env.iOS) {\n            restoreFocusOnKeyDown();\n            bodyHeight();\n            tapLinksAndImages();\n          }\n        }\n        if (isGecko) {\n          focusBody();\n          setGeckoEditingOptions();\n          showBrokenImageIcon();\n          blockCmdArrowNavigation();\n        }\n      };\n      var setup = function () {\n        removeBlockQuoteOnBackSpace();\n        emptyEditorWhenDeleting();\n        if (!Env.windowsPhone) {\n          normalizeSelection();\n        }\n        if (isWebKit) {\n          inputMethodFocus();\n          selectControlElements();\n          setDefaultBlockType();\n          blockFormSubmitInsideEditor();\n          disableBackspaceIntoATable();\n          removeAppleInterchangeBrs();\n          if (Env.iOS) {\n            restoreFocusOnKeyDown();\n            bodyHeight();\n            tapLinksAndImages();\n          } else {\n            selectAll();\n          }\n        }\n        if (Env.ie >= 11) {\n          bodyHeight();\n          disableBackspaceIntoATable();\n        }\n        if (Env.ie) {\n          selectAll();\n          disableAutoUrlDetect();\n          ieInternalDragAndDrop();\n        }\n        if (isGecko) {\n          removeHrOnBackspace();\n          focusBody();\n          removeStylesWhenDeletingAcrossBlockElements();\n          setGeckoEditingOptions();\n          addBrAfterLastLinks();\n          showBrokenImageIcon();\n          blockCmdArrowNavigation();\n          disableBackspaceIntoATable();\n        }\n      };\n      if (isRtc(editor)) {\n        setupRtc();\n      } else {\n        setup();\n      }\n      return {\n        refreshContentEditable: refreshContentEditable,\n        isHidden: isHidden\n      };\n    };\n\n    var DOM$4 = DOMUtils.DOM;\n    var appendStyle = function (editor, text) {\n      var body = SugarElement.fromDom(editor.getBody());\n      var container = getStyleContainer(getRootNode(body));\n      var style = SugarElement.fromTag('style');\n      set(style, 'type', 'text/css');\n      append(style, SugarElement.fromText(text));\n      append(container, style);\n      editor.on('remove', function () {\n        remove(style);\n      });\n    };\n    var getRootName = function (editor) {\n      return editor.inline ? editor.getElement().nodeName.toLowerCase() : undefined;\n    };\n    var removeUndefined = function (obj) {\n      return filter$1(obj, function (v) {\n        return isUndefined(v) === false;\n      });\n    };\n    var mkParserSettings = function (editor) {\n      var settings = editor.settings;\n      var blobCache = editor.editorUpload.blobCache;\n      return removeUndefined({\n        allow_conditional_comments: settings.allow_conditional_comments,\n        allow_html_data_urls: settings.allow_html_data_urls,\n        allow_svg_data_urls: settings.allow_svg_data_urls,\n        allow_html_in_named_anchor: settings.allow_html_in_named_anchor,\n        allow_script_urls: settings.allow_script_urls,\n        allow_unsafe_link_target: settings.allow_unsafe_link_target,\n        convert_fonts_to_spans: settings.convert_fonts_to_spans,\n        fix_list_elements: settings.fix_list_elements,\n        font_size_legacy_values: settings.font_size_legacy_values,\n        forced_root_block: settings.forced_root_block,\n        forced_root_block_attrs: settings.forced_root_block_attrs,\n        padd_empty_with_br: settings.padd_empty_with_br,\n        preserve_cdata: settings.preserve_cdata,\n        remove_trailing_brs: settings.remove_trailing_brs,\n        inline_styles: settings.inline_styles,\n        root_name: getRootName(editor),\n        validate: true,\n        blob_cache: blobCache,\n        images_dataimg_filter: settings.images_dataimg_filter\n      });\n    };\n    var mkSerializerSettings = function (editor) {\n      var settings = editor.settings;\n      return __assign(__assign({}, mkParserSettings(editor)), removeUndefined({\n        url_converter: settings.url_converter,\n        url_converter_scope: settings.url_converter_scope,\n        element_format: settings.element_format,\n        entities: settings.entities,\n        entity_encoding: settings.entity_encoding,\n        indent: settings.indent,\n        indent_after: settings.indent_after,\n        indent_before: settings.indent_before,\n        block_elements: settings.block_elements,\n        boolean_attributes: settings.boolean_attributes,\n        custom_elements: settings.custom_elements,\n        extended_valid_elements: settings.extended_valid_elements,\n        invalid_elements: settings.invalid_elements,\n        invalid_styles: settings.invalid_styles,\n        move_caret_before_on_enter_elements: settings.move_caret_before_on_enter_elements,\n        non_empty_elements: settings.non_empty_elements,\n        schema: settings.schema,\n        self_closing_elements: settings.self_closing_elements,\n        short_ended_elements: settings.short_ended_elements,\n        special: settings.special,\n        text_block_elements: settings.text_block_elements,\n        text_inline_elements: settings.text_inline_elements,\n        valid_children: settings.valid_children,\n        valid_classes: settings.valid_classes,\n        valid_elements: settings.valid_elements,\n        valid_styles: settings.valid_styles,\n        verify_html: settings.verify_html,\n        whitespace_elements: settings.whitespace_elements\n      }));\n    };\n    var createParser = function (editor) {\n      var parser = DomParser(mkParserSettings(editor), editor.schema);\n      parser.addAttributeFilter('src,href,style,tabindex', function (nodes, name) {\n        var i = nodes.length, node, value;\n        var dom = editor.dom;\n        var internalName = 'data-mce-' + name;\n        while (i--) {\n          node = nodes[i];\n          value = node.attr(name);\n          if (value && !node.attr(internalName)) {\n            if (value.indexOf('data:') === 0 || value.indexOf('blob:') === 0) {\n              continue;\n            }\n            if (name === 'style') {\n              value = dom.serializeStyle(dom.parseStyle(value), node.name);\n              if (!value.length) {\n                value = null;\n              }\n              node.attr(internalName, value);\n              node.attr(name, value);\n            } else if (name === 'tabindex') {\n              node.attr(internalName, value);\n              node.attr(name, null);\n            } else {\n              node.attr(internalName, editor.convertURL(value, name, node.name));\n            }\n          }\n        }\n      });\n      parser.addNodeFilter('script', function (nodes) {\n        var i = nodes.length;\n        while (i--) {\n          var node = nodes[i];\n          var type = node.attr('type') || 'no/type';\n          if (type.indexOf('mce-') !== 0) {\n            node.attr('type', 'mce-' + type);\n          }\n        }\n      });\n      if (editor.settings.preserve_cdata) {\n        parser.addNodeFilter('#cdata', function (nodes) {\n          var i = nodes.length;\n          while (i--) {\n            var node = nodes[i];\n            node.type = 8;\n            node.name = '#comment';\n            node.value = '[CDATA[' + editor.dom.encode(node.value) + ']]';\n          }\n        });\n      }\n      parser.addNodeFilter('p,h1,h2,h3,h4,h5,h6,div', function (nodes) {\n        var i = nodes.length;\n        var nonEmptyElements = editor.schema.getNonEmptyElements();\n        while (i--) {\n          var node = nodes[i];\n          if (node.isEmpty(nonEmptyElements) && node.getAll('br').length === 0) {\n            node.append(new AstNode('br', 1)).shortEnded = true;\n          }\n        }\n      });\n      return parser;\n    };\n    var autoFocus = function (editor) {\n      if (editor.settings.auto_focus) {\n        Delay.setEditorTimeout(editor, function () {\n          var focusEditor;\n          if (editor.settings.auto_focus === true) {\n            focusEditor = editor;\n          } else {\n            focusEditor = editor.editorManager.get(editor.settings.auto_focus);\n          }\n          if (!focusEditor.destroyed) {\n            focusEditor.focus();\n          }\n        }, 100);\n      }\n    };\n    var moveSelectionToFirstCaretPosition = function (editor) {\n      var root = editor.dom.getRoot();\n      if (!editor.inline && (!hasAnyRanges(editor) || editor.selection.getStart(true) === root)) {\n        firstPositionIn(root).each(function (pos) {\n          var node = pos.getNode();\n          var caretPos = isTable(node) ? firstPositionIn(node).getOr(pos) : pos;\n          if (Env.browser.isIE()) {\n            storeNative(editor, caretPos.toRange());\n          } else {\n            editor.selection.setRng(caretPos.toRange());\n          }\n        });\n      }\n    };\n    var initEditor = function (editor) {\n      editor.bindPendingEventDelegates();\n      editor.initialized = true;\n      fireInit(editor);\n      editor.focus(true);\n      moveSelectionToFirstCaretPosition(editor);\n      editor.nodeChanged({ initial: true });\n      editor.execCallback('init_instance_callback', editor);\n      autoFocus(editor);\n    };\n    var getStyleSheetLoader = function (editor) {\n      return editor.inline ? editor.ui.styleSheetLoader : editor.dom.styleSheetLoader;\n    };\n    var makeStylesheetLoadingPromises = function (editor, css, framedFonts) {\n      var promises = [new promiseObj(function (resolve, reject) {\n          return getStyleSheetLoader(editor).loadAll(css, resolve, reject);\n        })];\n      if (editor.inline) {\n        return promises;\n      } else {\n        return promises.concat([new promiseObj(function (resolve, reject) {\n            return editor.ui.styleSheetLoader.loadAll(framedFonts, resolve, reject);\n          })]);\n      }\n    };\n    var loadContentCss = function (editor, css) {\n      var styleSheetLoader = getStyleSheetLoader(editor);\n      var fontCss = getFontCss(editor);\n      var removeCss = function () {\n        styleSheetLoader.unloadAll(css);\n        if (!editor.inline) {\n          editor.ui.styleSheetLoader.unloadAll(fontCss);\n        }\n      };\n      var loaded = function () {\n        if (editor.removed) {\n          removeCss();\n        } else {\n          editor.on('remove', removeCss);\n          initEditor(editor);\n        }\n      };\n      promiseObj.all(makeStylesheetLoadingPromises(editor, css, fontCss)).then(loaded).catch(loaded);\n    };\n    var preInit = function (editor) {\n      var settings = editor.settings, doc = editor.getDoc(), body = editor.getBody();\n      if (!settings.browser_spellcheck && !settings.gecko_spellcheck) {\n        doc.body.spellcheck = false;\n        DOM$4.setAttrib(body, 'spellcheck', 'false');\n      }\n      editor.quirks = Quirks(editor);\n      firePostRender(editor);\n      var directionality = getDirectionality(editor);\n      if (directionality !== undefined) {\n        body.dir = directionality;\n      }\n      if (settings.protect) {\n        editor.on('BeforeSetContent', function (e) {\n          Tools.each(settings.protect, function (pattern) {\n            e.content = e.content.replace(pattern, function (str) {\n              return '<!--mce:protected ' + escape(str) + '-->';\n            });\n          });\n        });\n      }\n      editor.on('SetContent', function () {\n        editor.addVisual(editor.getBody());\n      });\n      if (!isRtc(editor)) {\n        editor.load({\n          initial: true,\n          format: 'html'\n        });\n      }\n      editor.startContent = editor.getContent({ format: 'raw' });\n      editor.on('compositionstart compositionend', function (e) {\n        editor.composing = e.type === 'compositionstart';\n      });\n      if (editor.contentStyles.length > 0) {\n        var contentCssText_1 = '';\n        Tools.each(editor.contentStyles, function (style) {\n          contentCssText_1 += style + '\\r\\n';\n        });\n        editor.dom.addStyle(contentCssText_1);\n      }\n      loadContentCss(editor, editor.contentCSS);\n      if (settings.content_style) {\n        appendStyle(editor, settings.content_style);\n      }\n    };\n    var initContentBody = function (editor, skipWrite) {\n      var settings = editor.settings;\n      var targetElm = editor.getElement();\n      var doc = editor.getDoc();\n      if (!settings.inline) {\n        editor.getElement().style.visibility = editor.orgVisibility;\n      }\n      if (!skipWrite && !editor.inline) {\n        doc.open();\n        doc.write(editor.iframeHTML);\n        doc.close();\n      }\n      if (editor.inline) {\n        DOM$4.addClass(targetElm, 'mce-content-body');\n        editor.contentDocument = doc = document;\n        editor.contentWindow = window;\n        editor.bodyElement = targetElm;\n        editor.contentAreaContainer = targetElm;\n      }\n      var body = editor.getBody();\n      body.disabled = true;\n      editor.readonly = !!settings.readonly;\n      if (!editor.readonly) {\n        if (editor.inline && DOM$4.getStyle(body, 'position', true) === 'static') {\n          body.style.position = 'relative';\n        }\n        body.contentEditable = editor.getParam('content_editable_state', true);\n      }\n      body.disabled = false;\n      editor.editorUpload = EditorUpload(editor);\n      editor.schema = Schema(settings);\n      editor.dom = DOMUtils(doc, {\n        keep_values: true,\n        url_converter: editor.convertURL,\n        url_converter_scope: editor,\n        hex_colors: settings.force_hex_style_colors,\n        update_styles: true,\n        root_element: editor.inline ? editor.getBody() : null,\n        collect: function () {\n          return editor.inline;\n        },\n        schema: editor.schema,\n        contentCssCors: shouldUseContentCssCors(editor),\n        referrerPolicy: getReferrerPolicy(editor),\n        onSetAttrib: function (e) {\n          editor.fire('SetAttrib', e);\n        }\n      });\n      editor.parser = createParser(editor);\n      editor.serializer = DomSerializer(mkSerializerSettings(editor), editor);\n      editor.selection = EditorSelection(editor.dom, editor.getWin(), editor.serializer, editor);\n      editor.annotator = Annotator(editor);\n      editor.formatter = Formatter(editor);\n      editor.undoManager = UndoManager(editor);\n      editor._nodeChangeDispatcher = new NodeChange(editor);\n      editor._selectionOverrides = SelectionOverrides(editor);\n      setup$9(editor);\n      setup$k(editor);\n      if (!isRtc(editor)) {\n        setup$l(editor);\n      }\n      var caret = setup$j(editor);\n      setup$8(editor, caret);\n      setup$a(editor);\n      setup$7(editor);\n      firePreInit(editor);\n      setup$5(editor).fold(function () {\n        preInit(editor);\n      }, function (loadingRtc) {\n        editor.setProgressState(true);\n        loadingRtc.then(function (_rtcMode) {\n          editor.setProgressState(false);\n          preInit(editor);\n        }, function (err) {\n          editor.notificationManager.open({\n            type: 'error',\n            text: String(err)\n          });\n          preInit(editor);\n        });\n      });\n    };\n\n    var DOM$5 = DOMUtils.DOM;\n    var relaxDomain = function (editor, ifr) {\n      if (document.domain !== window.location.hostname && Env.browser.isIE()) {\n        var bodyUuid = uuid('mce');\n        editor[bodyUuid] = function () {\n          initContentBody(editor);\n        };\n        var domainRelaxUrl = 'javascript:(function(){' + 'document.open();document.domain=\"' + document.domain + '\";' + 'var ed = window.parent.tinymce.get(\"' + editor.id + '\");document.write(ed.iframeHTML);' + 'document.close();ed.' + bodyUuid + '(true);})()';\n        DOM$5.setAttrib(ifr, 'src', domainRelaxUrl);\n        return true;\n      }\n      return false;\n    };\n    var createIframeElement = function (id, title, height, customAttrs) {\n      var iframe = SugarElement.fromTag('iframe');\n      setAll(iframe, customAttrs);\n      setAll(iframe, {\n        id: id + '_ifr',\n        frameBorder: '0',\n        allowTransparency: 'true',\n        title: title\n      });\n      add$3(iframe, 'tox-edit-area__iframe');\n      return iframe;\n    };\n    var getIframeHtml = function (editor) {\n      var iframeHTML = getDocType(editor) + '<html><head>';\n      if (getDocumentBaseUrl(editor) !== editor.documentBaseUrl) {\n        iframeHTML += '<base href=\"' + editor.documentBaseURI.getURI() + '\" />';\n      }\n      iframeHTML += '<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />';\n      var bodyId = getBodyId(editor);\n      var bodyClass = getBodyClass(editor);\n      if (getContentSecurityPolicy(editor)) {\n        iframeHTML += '<meta http-equiv=\"Content-Security-Policy\" content=\"' + getContentSecurityPolicy(editor) + '\" />';\n      }\n      iframeHTML += '</head><body id=\"' + bodyId + '\" class=\"mce-content-body ' + bodyClass + '\" data-id=\"' + editor.id + '\"><br></body></html>';\n      return iframeHTML;\n    };\n    var createIframe = function (editor, o) {\n      var title = editor.editorManager.translate('Rich Text Area. Press ALT-0 for help.');\n      var ifr = createIframeElement(editor.id, title, o.height, getIframeAttrs(editor)).dom;\n      ifr.onload = function () {\n        ifr.onload = null;\n        editor.fire('load');\n      };\n      var isDomainRelaxed = relaxDomain(editor, ifr);\n      editor.contentAreaContainer = o.iframeContainer;\n      editor.iframeElement = ifr;\n      editor.iframeHTML = getIframeHtml(editor);\n      DOM$5.add(o.iframeContainer, ifr);\n      return isDomainRelaxed;\n    };\n    var init$1 = function (editor, boxInfo) {\n      var isDomainRelaxed = createIframe(editor, boxInfo);\n      if (boxInfo.editorContainer) {\n        DOM$5.get(boxInfo.editorContainer).style.display = editor.orgDisplay;\n        editor.hidden = DOM$5.isHidden(boxInfo.editorContainer);\n      }\n      editor.getElement().style.display = 'none';\n      DOM$5.setAttrib(editor.id, 'aria-hidden', 'true');\n      if (!isDomainRelaxed) {\n        initContentBody(editor);\n      }\n    };\n\n    var DOM$6 = DOMUtils.DOM;\n    var initPlugin = function (editor, initializedPlugins, plugin) {\n      var Plugin = PluginManager.get(plugin);\n      var pluginUrl = PluginManager.urls[plugin] || editor.documentBaseUrl.replace(/\\/$/, '');\n      plugin = Tools.trim(plugin);\n      if (Plugin && Tools.inArray(initializedPlugins, plugin) === -1) {\n        Tools.each(PluginManager.dependencies(plugin), function (dep) {\n          initPlugin(editor, initializedPlugins, dep);\n        });\n        if (editor.plugins[plugin]) {\n          return;\n        }\n        try {\n          var pluginInstance = new Plugin(editor, pluginUrl, editor.$);\n          editor.plugins[plugin] = pluginInstance;\n          if (pluginInstance.init) {\n            pluginInstance.init(editor, pluginUrl);\n            initializedPlugins.push(plugin);\n          }\n        } catch (e) {\n          pluginInitError(editor, plugin, e);\n        }\n      }\n    };\n    var trimLegacyPrefix = function (name) {\n      return name.replace(/^\\-/, '');\n    };\n    var initPlugins = function (editor) {\n      var initializedPlugins = [];\n      Tools.each(getPlugins(editor).split(/[ ,]/), function (name) {\n        initPlugin(editor, initializedPlugins, trimLegacyPrefix(name));\n      });\n    };\n    var initIcons = function (editor) {\n      var iconPackName = Tools.trim(getIconPackName(editor));\n      var currentIcons = editor.ui.registry.getAll().icons;\n      var loadIcons = __assign(__assign({}, IconManager.get('default').icons), IconManager.get(iconPackName).icons);\n      each$1(loadIcons, function (svgData, icon) {\n        if (!has(currentIcons, icon)) {\n          editor.ui.registry.addIcon(icon, svgData);\n        }\n      });\n    };\n    var initTheme = function (editor) {\n      var theme = getTheme(editor);\n      if (isString(theme)) {\n        editor.settings.theme = trimLegacyPrefix(theme);\n        var Theme = ThemeManager.get(theme);\n        editor.theme = new Theme(editor, ThemeManager.urls[theme]);\n        if (editor.theme.init) {\n          editor.theme.init(editor, ThemeManager.urls[theme] || editor.documentBaseUrl.replace(/\\/$/, ''), editor.$);\n        }\n      } else {\n        editor.theme = {};\n      }\n    };\n    var renderFromLoadedTheme = function (editor) {\n      return editor.theme.renderUI();\n    };\n    var renderFromThemeFunc = function (editor) {\n      var elm = editor.getElement();\n      var theme = getTheme(editor);\n      var info = theme(editor, elm);\n      if (info.editorContainer.nodeType) {\n        info.editorContainer.id = info.editorContainer.id || editor.id + '_parent';\n      }\n      if (info.iframeContainer && info.iframeContainer.nodeType) {\n        info.iframeContainer.id = info.iframeContainer.id || editor.id + '_iframecontainer';\n      }\n      info.height = info.iframeHeight ? info.iframeHeight : elm.offsetHeight;\n      return info;\n    };\n    var createThemeFalseResult = function (element) {\n      return {\n        editorContainer: element,\n        iframeContainer: element,\n        api: {}\n      };\n    };\n    var renderThemeFalseIframe = function (targetElement) {\n      var iframeContainer = DOM$6.create('div');\n      DOM$6.insertAfter(iframeContainer, targetElement);\n      return createThemeFalseResult(iframeContainer);\n    };\n    var renderThemeFalse = function (editor) {\n      var targetElement = editor.getElement();\n      return editor.inline ? createThemeFalseResult(null) : renderThemeFalseIframe(targetElement);\n    };\n    var renderThemeUi = function (editor) {\n      var elm = editor.getElement();\n      editor.orgDisplay = elm.style.display;\n      if (isString(getTheme(editor))) {\n        return renderFromLoadedTheme(editor);\n      } else if (isFunction(getTheme(editor))) {\n        return renderFromThemeFunc(editor);\n      } else {\n        return renderThemeFalse(editor);\n      }\n    };\n    var augmentEditorUiApi = function (editor, api) {\n      var uiApiFacade = {\n        show: Optional.from(api.show).getOr(noop),\n        hide: Optional.from(api.hide).getOr(noop),\n        disable: Optional.from(api.disable).getOr(noop),\n        isDisabled: Optional.from(api.isDisabled).getOr(never),\n        enable: function () {\n          if (!editor.mode.isReadOnly()) {\n            Optional.from(api.enable).map(call);\n          }\n        }\n      };\n      editor.ui = __assign(__assign({}, editor.ui), uiApiFacade);\n    };\n    var init$2 = function (editor) {\n      editor.fire('ScriptsLoaded');\n      initIcons(editor);\n      initTheme(editor);\n      initPlugins(editor);\n      var renderInfo = renderThemeUi(editor);\n      augmentEditorUiApi(editor, Optional.from(renderInfo.api).getOr({}));\n      var boxInfo = {\n        editorContainer: renderInfo.editorContainer,\n        iframeContainer: renderInfo.iframeContainer\n      };\n      editor.editorContainer = boxInfo.editorContainer ? boxInfo.editorContainer : null;\n      appendContentCssFromSettings(editor);\n      if (editor.inline) {\n        return initContentBody(editor);\n      } else {\n        return init$1(editor, boxInfo);\n      }\n    };\n\n    var DOM$7 = DOMUtils.DOM;\n    var hasSkipLoadPrefix = function (name) {\n      return name.charAt(0) === '-';\n    };\n    var loadLanguage = function (scriptLoader, editor) {\n      var languageCode = getLanguageCode(editor);\n      var languageUrl = getLanguageUrl(editor);\n      if (I18n.hasCode(languageCode) === false && languageCode !== 'en') {\n        var url_1 = languageUrl !== '' ? languageUrl : editor.editorManager.baseURL + '/langs/' + languageCode + '.js';\n        scriptLoader.add(url_1, noop, undefined, function () {\n          languageLoadError(editor, url_1, languageCode);\n        });\n      }\n    };\n    var loadTheme = function (scriptLoader, editor, suffix, callback) {\n      var theme = getTheme(editor);\n      if (isString(theme)) {\n        if (!hasSkipLoadPrefix(theme) && !ThemeManager.urls.hasOwnProperty(theme)) {\n          var themeUrl = getThemeUrl(editor);\n          if (themeUrl) {\n            ThemeManager.load(theme, editor.documentBaseURI.toAbsolute(themeUrl));\n          } else {\n            ThemeManager.load(theme, 'themes/' + theme + '/theme' + suffix + '.js');\n          }\n        }\n        scriptLoader.loadQueue(function () {\n          ThemeManager.waitFor(theme, callback);\n        });\n      } else {\n        callback();\n      }\n    };\n    var getIconsUrlMetaFromUrl = function (editor) {\n      return Optional.from(getIconsUrl(editor)).filter(function (url) {\n        return url.length > 0;\n      }).map(function (url) {\n        return {\n          url: url,\n          name: Optional.none()\n        };\n      });\n    };\n    var getIconsUrlMetaFromName = function (editor, name, suffix) {\n      return Optional.from(name).filter(function (name) {\n        return name.length > 0 && !IconManager.has(name);\n      }).map(function (name) {\n        return {\n          url: editor.editorManager.baseURL + '/icons/' + name + '/icons' + suffix + '.js',\n          name: Optional.some(name)\n        };\n      });\n    };\n    var loadIcons = function (scriptLoader, editor, suffix) {\n      var defaultIconsUrl = getIconsUrlMetaFromName(editor, 'default', suffix);\n      var customIconsUrl = getIconsUrlMetaFromUrl(editor).orThunk(function () {\n        return getIconsUrlMetaFromName(editor, getIconPackName(editor), '');\n      });\n      each(cat([\n        defaultIconsUrl,\n        customIconsUrl\n      ]), function (urlMeta) {\n        scriptLoader.add(urlMeta.url, noop, undefined, function () {\n          iconsLoadError(editor, urlMeta.url, urlMeta.name.getOrUndefined());\n        });\n      });\n    };\n    var loadPlugins = function (editor, suffix) {\n      Tools.each(getExternalPlugins(editor), function (url, name) {\n        PluginManager.load(name, url, noop, undefined, function () {\n          pluginLoadError(editor, url, name);\n        });\n        editor.settings.plugins += ' ' + name;\n      });\n      Tools.each(getPlugins(editor).split(/[ ,]/), function (plugin) {\n        plugin = Tools.trim(plugin);\n        if (plugin && !PluginManager.urls[plugin]) {\n          if (hasSkipLoadPrefix(plugin)) {\n            plugin = plugin.substr(1, plugin.length);\n            var dependencies = PluginManager.dependencies(plugin);\n            Tools.each(dependencies, function (depPlugin) {\n              var defaultSettings = {\n                prefix: 'plugins/',\n                resource: depPlugin,\n                suffix: '/plugin' + suffix + '.js'\n              };\n              var dep = PluginManager.createUrl(defaultSettings, depPlugin);\n              PluginManager.load(dep.resource, dep, noop, undefined, function () {\n                pluginLoadError(editor, dep.prefix + dep.resource + dep.suffix, dep.resource);\n              });\n            });\n          } else {\n            var url_2 = {\n              prefix: 'plugins/',\n              resource: plugin,\n              suffix: '/plugin' + suffix + '.js'\n            };\n            PluginManager.load(plugin, url_2, noop, undefined, function () {\n              pluginLoadError(editor, url_2.prefix + url_2.resource + url_2.suffix, plugin);\n            });\n          }\n        }\n      });\n    };\n    var loadScripts = function (editor, suffix) {\n      var scriptLoader = ScriptLoader.ScriptLoader;\n      loadTheme(scriptLoader, editor, suffix, function () {\n        loadLanguage(scriptLoader, editor);\n        loadIcons(scriptLoader, editor, suffix);\n        loadPlugins(editor, suffix);\n        scriptLoader.loadQueue(function () {\n          if (!editor.removed) {\n            init$2(editor);\n          }\n        }, editor, function () {\n          if (!editor.removed) {\n            init$2(editor);\n          }\n        });\n      });\n    };\n    var getStyleSheetLoader$1 = function (element, editor) {\n      return instance.forElement(element, {\n        contentCssCors: hasContentCssCors(editor),\n        referrerPolicy: getReferrerPolicy(editor)\n      });\n    };\n    var render = function (editor) {\n      var id = editor.id;\n      I18n.setCode(getLanguageCode(editor));\n      var readyHandler = function () {\n        DOM$7.unbind(window, 'ready', readyHandler);\n        editor.render();\n      };\n      if (!EventUtils.Event.domLoaded) {\n        DOM$7.bind(window, 'ready', readyHandler);\n        return;\n      }\n      if (!editor.getElement()) {\n        return;\n      }\n      if (!Env.contentEditable) {\n        return;\n      }\n      var element = SugarElement.fromDom(editor.getElement());\n      var snapshot = clone(element);\n      editor.on('remove', function () {\n        eachr(element.dom.attributes, function (attr) {\n          return remove$1(element, attr.name);\n        });\n        setAll(element, snapshot);\n      });\n      editor.ui.styleSheetLoader = getStyleSheetLoader$1(element, editor);\n      if (!isInline$1(editor)) {\n        editor.orgVisibility = editor.getElement().style.visibility;\n        editor.getElement().style.visibility = 'hidden';\n      } else {\n        editor.inline = true;\n      }\n      var form = editor.getElement().form || DOM$7.getParent(id, 'form');\n      if (form) {\n        editor.formElement = form;\n        if (hasHiddenInput(editor) && !isTextareaOrInput(editor.getElement())) {\n          DOM$7.insertAfter(DOM$7.create('input', {\n            type: 'hidden',\n            name: id\n          }), id);\n          editor.hasHiddenInput = true;\n        }\n        editor.formEventDelegate = function (e) {\n          editor.fire(e.type, e);\n        };\n        DOM$7.bind(form, 'submit reset', editor.formEventDelegate);\n        editor.on('reset', function () {\n          editor.resetContent();\n        });\n        if (shouldPatchSubmit(editor) && !form.submit.nodeType && !form.submit.length && !form._mceOldSubmit) {\n          form._mceOldSubmit = form.submit;\n          form.submit = function () {\n            editor.editorManager.triggerSave();\n            editor.setDirty(false);\n            return form._mceOldSubmit(form);\n          };\n        }\n      }\n      editor.windowManager = WindowManager(editor);\n      editor.notificationManager = NotificationManager(editor);\n      if (isEncodingXml(editor)) {\n        editor.on('GetContent', function (e) {\n          if (e.save) {\n            e.content = DOM$7.encode(e.content);\n          }\n        });\n      }\n      if (shouldAddFormSubmitTrigger(editor)) {\n        editor.on('submit', function () {\n          if (editor.initialized) {\n            editor.save();\n          }\n        });\n      }\n      if (shouldAddUnloadTrigger(editor)) {\n        editor._beforeUnload = function () {\n          if (editor.initialized && !editor.destroyed && !editor.isHidden()) {\n            editor.save({\n              format: 'raw',\n              no_events: true,\n              set_dirty: false\n            });\n          }\n        };\n        editor.editorManager.on('BeforeUnload', editor._beforeUnload);\n      }\n      editor.editorManager.add(editor);\n      loadScripts(editor, editor.suffix);\n    };\n\n    var addVisual$1 = function (editor, elm) {\n      return addVisual(editor, elm);\n    };\n\n    var legacyPropNames = {\n      'font-size': 'size',\n      'font-family': 'face'\n    };\n    var getSpecifiedFontProp = function (propName, rootElm, elm) {\n      var getProperty = function (elm) {\n        return getRaw(elm, propName).orThunk(function () {\n          if (name(elm) === 'font') {\n            return get$1(legacyPropNames, propName).bind(function (legacyPropName) {\n              return getOpt(elm, legacyPropName);\n            });\n          } else {\n            return Optional.none();\n          }\n        });\n      };\n      var isRoot = function (elm) {\n        return eq$2(SugarElement.fromDom(rootElm), elm);\n      };\n      return closest$2(SugarElement.fromDom(elm), function (elm) {\n        return getProperty(elm);\n      }, isRoot);\n    };\n    var normalizeFontFamily = function (fontFamily) {\n      return fontFamily.replace(/[\\'\\\"\\\\]/g, '').replace(/,\\s+/g, ',');\n    };\n    var getComputedFontProp = function (propName, elm) {\n      return Optional.from(DOMUtils.DOM.getStyle(elm, propName, true));\n    };\n    var getFontProp = function (propName) {\n      return function (rootElm, elm) {\n        return Optional.from(elm).map(SugarElement.fromDom).filter(isElement).bind(function (element) {\n          return getSpecifiedFontProp(propName, rootElm, element.dom).or(getComputedFontProp(propName, element.dom));\n        }).getOr('');\n      };\n    };\n    var getFontSize = getFontProp('font-size');\n    var getFontFamily = compose(normalizeFontFamily, getFontProp('font-family'));\n\n    var findFirstCaretElement = function (editor) {\n      return firstPositionIn(editor.getBody()).map(function (caret) {\n        var container = caret.container();\n        return isText$1(container) ? container.parentNode : container;\n      });\n    };\n    var getCaretElement = function (editor) {\n      return Optional.from(editor.selection.getRng()).bind(function (rng) {\n        var root = editor.getBody();\n        var atStartOfNode = rng.startContainer === root && rng.startOffset === 0;\n        return atStartOfNode ? Optional.none() : Optional.from(editor.selection.getStart(true));\n      });\n    };\n    var mapRange = function (editor, mapper) {\n      return getCaretElement(editor).orThunk(curry(findFirstCaretElement, editor)).map(SugarElement.fromDom).filter(isElement).map(mapper);\n    };\n\n    var fromFontSizeNumber = function (editor, value) {\n      if (/^[0-9.]+$/.test(value)) {\n        var fontSizeNumber = parseInt(value, 10);\n        if (fontSizeNumber >= 1 && fontSizeNumber <= 7) {\n          var fontSizes = getFontStyleValues(editor);\n          var fontClasses = getFontSizeClasses(editor);\n          if (fontClasses) {\n            return fontClasses[fontSizeNumber - 1] || value;\n          } else {\n            return fontSizes[fontSizeNumber - 1] || value;\n          }\n        } else {\n          return value;\n        }\n      } else {\n        return value;\n      }\n    };\n    var normalizeFontNames = function (font) {\n      var fonts = font.split(/\\s*,\\s*/);\n      return map(fonts, function (font) {\n        if (font.indexOf(' ') !== -1 && !(startsWith(font, '\"') || startsWith(font, '\\''))) {\n          return '\\'' + font + '\\'';\n        } else {\n          return font;\n        }\n      }).join(',');\n    };\n    var fontNameAction = function (editor, value) {\n      var font = fromFontSizeNumber(editor, value);\n      editor.formatter.toggle('fontname', { value: normalizeFontNames(font) });\n      editor.nodeChanged();\n    };\n    var fontNameQuery = function (editor) {\n      return mapRange(editor, function (elm) {\n        return getFontFamily(editor.getBody(), elm.dom);\n      }).getOr('');\n    };\n    var fontSizeAction = function (editor, value) {\n      editor.formatter.toggle('fontsize', { value: fromFontSizeNumber(editor, value) });\n      editor.nodeChanged();\n    };\n    var fontSizeQuery = function (editor) {\n      return mapRange(editor, function (elm) {\n        return getFontSize(editor.getBody(), elm.dom);\n      }).getOr('');\n    };\n\n    var lineHeightQuery = function (editor) {\n      return mapRange(editor, function (elm) {\n        var root = SugarElement.fromDom(editor.getBody());\n        var specifiedStyle = closest$2(elm, function (elm) {\n          return getRaw(elm, 'line-height');\n        }, curry(eq$2, root));\n        var computedStyle = function () {\n          var lineHeight = parseFloat(get$5(elm, 'line-height'));\n          var fontSize = parseFloat(get$5(elm, 'font-size'));\n          return String(lineHeight / fontSize);\n        };\n        return specifiedStyle.getOrThunk(computedStyle);\n      }).getOr('');\n    };\n    var lineHeightAction = function (editor, lineHeight) {\n      editor.formatter.toggle('lineheight', { value: String(lineHeight) });\n      editor.nodeChanged();\n    };\n\n    var processValue = function (value) {\n      var details;\n      if (typeof value !== 'string') {\n        details = Tools.extend({\n          paste: value.paste,\n          data: { paste: value.paste }\n        }, value);\n        return {\n          content: value.content,\n          details: details\n        };\n      }\n      return {\n        content: value,\n        details: {}\n      };\n    };\n    var insertAtCaret$1 = function (editor, value) {\n      var result = processValue(value);\n      insertContent(editor, result.content, result.details);\n    };\n\n    var each$f = Tools.each;\n    var map$3 = Tools.map, inArray$2 = Tools.inArray;\n    var EditorCommands = function () {\n      function EditorCommands(editor) {\n        this.commands = {\n          state: {},\n          exec: {},\n          value: {}\n        };\n        this.editor = editor;\n        this.setupCommands(editor);\n      }\n      EditorCommands.prototype.execCommand = function (command, ui, value, args) {\n        var func, state = false;\n        var self = this;\n        if (self.editor.removed) {\n          return;\n        }\n        if (!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(command) && (!args || !args.skip_focus)) {\n          self.editor.focus();\n        } else {\n          restore(self.editor);\n        }\n        args = self.editor.fire('BeforeExecCommand', {\n          command: command,\n          ui: ui,\n          value: value\n        });\n        if (args.isDefaultPrevented()) {\n          return false;\n        }\n        var customCommand = command.toLowerCase();\n        if (func = self.commands.exec[customCommand]) {\n          func(customCommand, ui, value);\n          self.editor.fire('ExecCommand', {\n            command: command,\n            ui: ui,\n            value: value\n          });\n          return true;\n        }\n        each$f(this.editor.plugins, function (p) {\n          if (p.execCommand && p.execCommand(command, ui, value)) {\n            self.editor.fire('ExecCommand', {\n              command: command,\n              ui: ui,\n              value: value\n            });\n            state = true;\n            return false;\n          }\n        });\n        if (state) {\n          return state;\n        }\n        if (self.editor.theme && self.editor.theme.execCommand && self.editor.theme.execCommand(command, ui, value)) {\n          self.editor.fire('ExecCommand', {\n            command: command,\n            ui: ui,\n            value: value\n          });\n          return true;\n        }\n        try {\n          state = self.editor.getDoc().execCommand(command, ui, value);\n        } catch (ex) {\n        }\n        if (state) {\n          self.editor.fire('ExecCommand', {\n            command: command,\n            ui: ui,\n            value: value\n          });\n          return true;\n        }\n        return false;\n      };\n      EditorCommands.prototype.queryCommandState = function (command) {\n        var func;\n        if (this.editor.quirks.isHidden() || this.editor.removed) {\n          return;\n        }\n        command = command.toLowerCase();\n        if (func = this.commands.state[command]) {\n          return func(command);\n        }\n        try {\n          return this.editor.getDoc().queryCommandState(command);\n        } catch (ex) {\n        }\n        return false;\n      };\n      EditorCommands.prototype.queryCommandValue = function (command) {\n        var func;\n        if (this.editor.quirks.isHidden() || this.editor.removed) {\n          return;\n        }\n        command = command.toLowerCase();\n        if (func = this.commands.value[command]) {\n          return func(command);\n        }\n        try {\n          return this.editor.getDoc().queryCommandValue(command);\n        } catch (ex) {\n        }\n      };\n      EditorCommands.prototype.addCommands = function (commandList, type) {\n        if (type === void 0) {\n          type = 'exec';\n        }\n        var self = this;\n        each$f(commandList, function (callback, command) {\n          each$f(command.toLowerCase().split(','), function (command) {\n            self.commands[type][command] = callback;\n          });\n        });\n      };\n      EditorCommands.prototype.addCommand = function (command, callback, scope) {\n        var _this = this;\n        command = command.toLowerCase();\n        this.commands.exec[command] = function (command, ui, value, args) {\n          return callback.call(scope || _this.editor, ui, value, args);\n        };\n      };\n      EditorCommands.prototype.queryCommandSupported = function (command) {\n        command = command.toLowerCase();\n        if (this.commands.exec[command]) {\n          return true;\n        }\n        try {\n          return this.editor.getDoc().queryCommandSupported(command);\n        } catch (ex) {\n        }\n        return false;\n      };\n      EditorCommands.prototype.addQueryStateHandler = function (command, callback, scope) {\n        var _this = this;\n        command = command.toLowerCase();\n        this.commands.state[command] = function () {\n          return callback.call(scope || _this.editor);\n        };\n      };\n      EditorCommands.prototype.addQueryValueHandler = function (command, callback, scope) {\n        var _this = this;\n        command = command.toLowerCase();\n        this.commands.value[command] = function () {\n          return callback.call(scope || _this.editor);\n        };\n      };\n      EditorCommands.prototype.hasCustomCommand = function (command) {\n        command = command.toLowerCase();\n        return !!this.commands.exec[command];\n      };\n      EditorCommands.prototype.execNativeCommand = function (command, ui, value) {\n        if (ui === undefined) {\n          ui = false;\n        }\n        if (value === undefined) {\n          value = null;\n        }\n        return this.editor.getDoc().execCommand(command, ui, value);\n      };\n      EditorCommands.prototype.isFormatMatch = function (name) {\n        return this.editor.formatter.match(name);\n      };\n      EditorCommands.prototype.toggleFormat = function (name, value) {\n        this.editor.formatter.toggle(name, value ? { value: value } : undefined);\n        this.editor.nodeChanged();\n      };\n      EditorCommands.prototype.storeSelection = function (type) {\n        this.selectionBookmark = this.editor.selection.getBookmark(type);\n      };\n      EditorCommands.prototype.restoreSelection = function () {\n        this.editor.selection.moveToBookmark(this.selectionBookmark);\n      };\n      EditorCommands.prototype.setupCommands = function (editor) {\n        var self = this;\n        this.addCommands({\n          'mceResetDesignMode,mceBeginUndoLevel': noop,\n          'mceEndUndoLevel,mceAddUndoLevel': function () {\n            editor.undoManager.add();\n          },\n          'Cut,Copy,Paste': function (command) {\n            var doc = editor.getDoc();\n            var failed;\n            try {\n              self.execNativeCommand(command);\n            } catch (ex) {\n              failed = true;\n            }\n            if (command === 'paste' && !doc.queryCommandEnabled(command)) {\n              failed = true;\n            }\n            if (failed || !doc.queryCommandSupported(command)) {\n              var msg = editor.translate('Your browser doesn\\'t support direct access to the clipboard. ' + 'Please use the Ctrl+X/C/V keyboard shortcuts instead.');\n              if (Env.mac) {\n                msg = msg.replace(/Ctrl\\+/g, '\\u2318+');\n              }\n              editor.notificationManager.open({\n                text: msg,\n                type: 'error'\n              });\n            }\n          },\n          'unlink': function () {\n            if (editor.selection.isCollapsed()) {\n              var elm = editor.dom.getParent(editor.selection.getStart(), 'a');\n              if (elm) {\n                editor.dom.remove(elm, true);\n              }\n              return;\n            }\n            editor.formatter.remove('link');\n          },\n          'JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone': function (command) {\n            var align = command.substring(7);\n            if (align === 'full') {\n              align = 'justify';\n            }\n            each$f('left,center,right,justify'.split(','), function (name) {\n              if (align !== name) {\n                editor.formatter.remove('align' + name);\n              }\n            });\n            if (align !== 'none') {\n              self.toggleFormat('align' + align);\n            }\n          },\n          'InsertUnorderedList,InsertOrderedList': function (command) {\n            var listParent;\n            self.execNativeCommand(command);\n            var listElm = editor.dom.getParent(editor.selection.getNode(), 'ol,ul');\n            if (listElm) {\n              listParent = listElm.parentNode;\n              if (/^(H[1-6]|P|ADDRESS|PRE)$/.test(listParent.nodeName)) {\n                self.storeSelection();\n                editor.dom.split(listParent, listElm);\n                self.restoreSelection();\n              }\n            }\n          },\n          'Bold,Italic,Underline,Strikethrough,Superscript,Subscript': function (command) {\n            self.toggleFormat(command);\n          },\n          'ForeColor,HiliteColor': function (command, ui, value) {\n            self.toggleFormat(command, value);\n          },\n          'FontName': function (command, ui, value) {\n            fontNameAction(editor, value);\n          },\n          'FontSize': function (command, ui, value) {\n            fontSizeAction(editor, value);\n          },\n          'LineHeight': function (command, ui, value) {\n            lineHeightAction(editor, value);\n          },\n          'RemoveFormat': function (command) {\n            editor.formatter.remove(command);\n          },\n          'mceBlockQuote': function () {\n            self.toggleFormat('blockquote');\n          },\n          'FormatBlock': function (command, ui, value) {\n            return self.toggleFormat(value || 'p');\n          },\n          'mceCleanup': function () {\n            var bookmark = editor.selection.getBookmark();\n            editor.setContent(editor.getContent());\n            editor.selection.moveToBookmark(bookmark);\n          },\n          'mceRemoveNode': function (command, ui, value) {\n            var node = value || editor.selection.getNode();\n            if (node !== editor.getBody()) {\n              self.storeSelection();\n              editor.dom.remove(node, true);\n              self.restoreSelection();\n            }\n          },\n          'mceSelectNodeDepth': function (command, ui, value) {\n            var counter = 0;\n            editor.dom.getParent(editor.selection.getNode(), function (node) {\n              if (node.nodeType === 1 && counter++ === value) {\n                editor.selection.select(node);\n                return false;\n              }\n            }, editor.getBody());\n          },\n          'mceSelectNode': function (command, ui, value) {\n            editor.selection.select(value);\n          },\n          'mceInsertContent': function (command, ui, value) {\n            insertAtCaret$1(editor, value);\n          },\n          'mceInsertRawHTML': function (command, ui, value) {\n            editor.selection.setContent('tiny_mce_marker');\n            var content = editor.getContent();\n            editor.setContent(content.replace(/tiny_mce_marker/g, function () {\n              return value;\n            }));\n          },\n          'mceInsertNewLine': function (command, ui, value) {\n            insert$3(editor, value);\n          },\n          'mceToggleFormat': function (command, ui, value) {\n            self.toggleFormat(value);\n          },\n          'mceSetContent': function (command, ui, value) {\n            editor.setContent(value);\n          },\n          'Indent,Outdent': function (command) {\n            handle(editor, command);\n          },\n          'mceRepaint': noop,\n          'InsertHorizontalRule': function () {\n            editor.execCommand('mceInsertContent', false, '<hr />');\n          },\n          'mceToggleVisualAid': function () {\n            editor.hasVisual = !editor.hasVisual;\n            editor.addVisual();\n          },\n          'mceReplaceContent': function (command, ui, value) {\n            editor.execCommand('mceInsertContent', false, value.replace(/\\{\\$selection\\}/g, editor.selection.getContent({ format: 'text' })));\n          },\n          'mceInsertLink': function (command, ui, value) {\n            if (typeof value === 'string') {\n              value = { href: value };\n            }\n            var anchor = editor.dom.getParent(editor.selection.getNode(), 'a');\n            value.href = value.href.replace(/ /g, '%20');\n            if (!anchor || !value.href) {\n              editor.formatter.remove('link');\n            }\n            if (value.href) {\n              editor.formatter.apply('link', value, anchor);\n            }\n          },\n          'selectAll': function () {\n            var editingHost = editor.dom.getParent(editor.selection.getStart(), isContentEditableTrue);\n            if (editingHost) {\n              var rng = editor.dom.createRng();\n              rng.selectNodeContents(editingHost);\n              editor.selection.setRng(rng);\n            }\n          },\n          'mceNewDocument': function () {\n            editor.setContent('');\n          },\n          'InsertLineBreak': function (command, ui, value) {\n            insert$2(editor, value);\n            return true;\n          }\n        });\n        var alignStates = function (name) {\n          return function () {\n            var selection = editor.selection;\n            var nodes = selection.isCollapsed() ? [editor.dom.getParent(selection.getNode(), editor.dom.isBlock)] : selection.getSelectedBlocks();\n            var matches = map$3(nodes, function (node) {\n              return !!editor.formatter.matchNode(node, name);\n            });\n            return inArray$2(matches, true) !== -1;\n          };\n        };\n        self.addCommands({\n          'JustifyLeft': alignStates('alignleft'),\n          'JustifyCenter': alignStates('aligncenter'),\n          'JustifyRight': alignStates('alignright'),\n          'JustifyFull': alignStates('alignjustify'),\n          'Bold,Italic,Underline,Strikethrough,Superscript,Subscript': function (command) {\n            return self.isFormatMatch(command);\n          },\n          'mceBlockQuote': function () {\n            return self.isFormatMatch('blockquote');\n          },\n          'Outdent': function () {\n            return canOutdent(editor);\n          },\n          'InsertUnorderedList,InsertOrderedList': function (command) {\n            var list = editor.dom.getParent(editor.selection.getNode(), 'ul,ol');\n            return list && (command === 'insertunorderedlist' && list.tagName === 'UL' || command === 'insertorderedlist' && list.tagName === 'OL');\n          }\n        }, 'state');\n        self.addCommands({\n          Undo: function () {\n            editor.undoManager.undo();\n          },\n          Redo: function () {\n            editor.undoManager.redo();\n          }\n        });\n        self.addQueryValueHandler('FontName', function () {\n          return fontNameQuery(editor);\n        }, this);\n        self.addQueryValueHandler('FontSize', function () {\n          return fontSizeQuery(editor);\n        }, this);\n        self.addQueryValueHandler('LineHeight', function () {\n          return lineHeightQuery(editor);\n        }, this);\n      };\n      return EditorCommands;\n    }();\n\n    var internalContentEditableAttr = 'data-mce-contenteditable';\n    var toggleClass = function (elm, cls, state) {\n      if (has$2(elm, cls) && state === false) {\n        remove$4(elm, cls);\n      } else if (state) {\n        add$3(elm, cls);\n      }\n    };\n    var setEditorCommandState = function (editor, cmd, state) {\n      try {\n        editor.getDoc().execCommand(cmd, false, String(state));\n      } catch (ex) {\n      }\n    };\n    var setContentEditable = function (elm, state) {\n      elm.dom.contentEditable = state ? 'true' : 'false';\n    };\n    var switchOffContentEditableTrue = function (elm) {\n      each(descendants$1(elm, '*[contenteditable=\"true\"]'), function (elm) {\n        set(elm, internalContentEditableAttr, 'true');\n        setContentEditable(elm, false);\n      });\n    };\n    var switchOnContentEditableTrue = function (elm) {\n      each(descendants$1(elm, '*[' + internalContentEditableAttr + '=\"true\"]'), function (elm) {\n        remove$1(elm, internalContentEditableAttr);\n        setContentEditable(elm, true);\n      });\n    };\n    var removeFakeSelection = function (editor) {\n      Optional.from(editor.selection.getNode()).each(function (elm) {\n        elm.removeAttribute('data-mce-selected');\n      });\n    };\n    var restoreFakeSelection = function (editor) {\n      editor.selection.setRng(editor.selection.getRng());\n    };\n    var toggleReadOnly = function (editor, state) {\n      var body = SugarElement.fromDom(editor.getBody());\n      toggleClass(body, 'mce-content-readonly', state);\n      if (state) {\n        editor.selection.controlSelection.hideResizeRect();\n        editor._selectionOverrides.hideFakeCaret();\n        removeFakeSelection(editor);\n        editor.readonly = true;\n        setContentEditable(body, false);\n        switchOffContentEditableTrue(body);\n      } else {\n        editor.readonly = false;\n        setContentEditable(body, true);\n        switchOnContentEditableTrue(body);\n        setEditorCommandState(editor, 'StyleWithCSS', false);\n        setEditorCommandState(editor, 'enableInlineTableEditing', false);\n        setEditorCommandState(editor, 'enableObjectResizing', false);\n        if (hasEditorOrUiFocus(editor)) {\n          editor.focus();\n        }\n        restoreFakeSelection(editor);\n        editor.nodeChanged();\n      }\n    };\n    var isReadOnly$1 = function (editor) {\n      return editor.readonly;\n    };\n    var registerFilters = function (editor) {\n      editor.parser.addAttributeFilter('contenteditable', function (nodes) {\n        if (isReadOnly$1(editor)) {\n          each(nodes, function (node) {\n            node.attr(internalContentEditableAttr, node.attr('contenteditable'));\n            node.attr('contenteditable', 'false');\n          });\n        }\n      });\n      editor.serializer.addAttributeFilter(internalContentEditableAttr, function (nodes) {\n        if (isReadOnly$1(editor)) {\n          each(nodes, function (node) {\n            node.attr('contenteditable', node.attr(internalContentEditableAttr));\n          });\n        }\n      });\n      editor.serializer.addTempAttr(internalContentEditableAttr);\n    };\n    var registerReadOnlyContentFilters = function (editor) {\n      if (editor.serializer) {\n        registerFilters(editor);\n      } else {\n        editor.on('PreInit', function () {\n          registerFilters(editor);\n        });\n      }\n    };\n    var isClickEvent = function (e) {\n      return e.type === 'click';\n    };\n    var getAnchorHrefOpt = function (editor, elm) {\n      var isRoot = function (elm) {\n        return eq$2(elm, SugarElement.fromDom(editor.getBody()));\n      };\n      return closest$1(elm, 'a', isRoot).bind(function (a) {\n        return getOpt(a, 'href');\n      });\n    };\n    var processReadonlyEvents = function (editor, e) {\n      if (isClickEvent(e) && !VK.metaKeyPressed(e)) {\n        var elm = SugarElement.fromDom(e.target);\n        getAnchorHrefOpt(editor, elm).each(function (href) {\n          e.preventDefault();\n          if (/^#/.test(href)) {\n            var targetEl = editor.dom.select(href + ',[name=\"' + removeLeading(href, '#') + '\"]');\n            if (targetEl.length) {\n              editor.selection.scrollIntoView(targetEl[0], true);\n            }\n          } else {\n            window.open(href, '_blank', 'rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes');\n          }\n        });\n      }\n    };\n    var registerReadOnlySelectionBlockers = function (editor) {\n      editor.on('ShowCaret', function (e) {\n        if (isReadOnly$1(editor)) {\n          e.preventDefault();\n        }\n      });\n      editor.on('ObjectSelected', function (e) {\n        if (isReadOnly$1(editor)) {\n          e.preventDefault();\n        }\n      });\n    };\n\n    var nativeEvents = Tools.makeMap('focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange ' + 'mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover ' + 'draggesture dragdrop drop drag submit ' + 'compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel', ' ');\n    var EventDispatcher = function () {\n      function EventDispatcher(settings) {\n        this.bindings = {};\n        this.settings = settings || {};\n        this.scope = this.settings.scope || this;\n        this.toggleEvent = this.settings.toggleEvent || never;\n      }\n      EventDispatcher.isNative = function (name) {\n        return !!nativeEvents[name.toLowerCase()];\n      };\n      EventDispatcher.prototype.fire = function (nameIn, argsIn) {\n        var name = nameIn.toLowerCase();\n        var args = argsIn || {};\n        args.type = name;\n        if (!args.target) {\n          args.target = this.scope;\n        }\n        if (!args.preventDefault) {\n          args.preventDefault = function () {\n            args.isDefaultPrevented = always;\n          };\n          args.stopPropagation = function () {\n            args.isPropagationStopped = always;\n          };\n          args.stopImmediatePropagation = function () {\n            args.isImmediatePropagationStopped = always;\n          };\n          args.isDefaultPrevented = never;\n          args.isPropagationStopped = never;\n          args.isImmediatePropagationStopped = never;\n        }\n        if (this.settings.beforeFire) {\n          this.settings.beforeFire(args);\n        }\n        var handlers = this.bindings[name];\n        if (handlers) {\n          for (var i = 0, l = handlers.length; i < l; i++) {\n            var callback = handlers[i];\n            if (callback.once) {\n              this.off(name, callback.func);\n            }\n            if (args.isImmediatePropagationStopped()) {\n              args.stopPropagation();\n              return args;\n            }\n            if (callback.func.call(this.scope, args) === false) {\n              args.preventDefault();\n              return args;\n            }\n          }\n        }\n        return args;\n      };\n      EventDispatcher.prototype.on = function (name, callback, prepend, extra) {\n        if (callback === false) {\n          callback = never;\n        }\n        if (callback) {\n          var wrappedCallback = { func: callback };\n          if (extra) {\n            Tools.extend(wrappedCallback, extra);\n          }\n          var names = name.toLowerCase().split(' ');\n          var i = names.length;\n          while (i--) {\n            var currentName = names[i];\n            var handlers = this.bindings[currentName];\n            if (!handlers) {\n              handlers = this.bindings[currentName] = [];\n              this.toggleEvent(currentName, true);\n            }\n            if (prepend) {\n              handlers.unshift(wrappedCallback);\n            } else {\n              handlers.push(wrappedCallback);\n            }\n          }\n        }\n        return this;\n      };\n      EventDispatcher.prototype.off = function (name, callback) {\n        var _this = this;\n        if (name) {\n          var names = name.toLowerCase().split(' ');\n          var i = names.length;\n          while (i--) {\n            var currentName = names[i];\n            var handlers = this.bindings[currentName];\n            if (!currentName) {\n              each$1(this.bindings, function (_value, bindingName) {\n                _this.toggleEvent(bindingName, false);\n                delete _this.bindings[bindingName];\n              });\n              return this;\n            }\n            if (handlers) {\n              if (!callback) {\n                handlers.length = 0;\n              } else {\n                var hi = handlers.length;\n                while (hi--) {\n                  if (handlers[hi].func === callback) {\n                    handlers = handlers.slice(0, hi).concat(handlers.slice(hi + 1));\n                    this.bindings[currentName] = handlers;\n                  }\n                }\n              }\n              if (!handlers.length) {\n                this.toggleEvent(name, false);\n                delete this.bindings[currentName];\n              }\n            }\n          }\n        } else {\n          each$1(this.bindings, function (_value, name) {\n            _this.toggleEvent(name, false);\n          });\n          this.bindings = {};\n        }\n        return this;\n      };\n      EventDispatcher.prototype.once = function (name, callback, prepend) {\n        return this.on(name, callback, prepend, { once: true });\n      };\n      EventDispatcher.prototype.has = function (name) {\n        name = name.toLowerCase();\n        return !(!this.bindings[name] || this.bindings[name].length === 0);\n      };\n      return EventDispatcher;\n    }();\n\n    var getEventDispatcher = function (obj) {\n      if (!obj._eventDispatcher) {\n        obj._eventDispatcher = new EventDispatcher({\n          scope: obj,\n          toggleEvent: function (name, state) {\n            if (EventDispatcher.isNative(name) && obj.toggleNativeEvent) {\n              obj.toggleNativeEvent(name, state);\n            }\n          }\n        });\n      }\n      return obj._eventDispatcher;\n    };\n    var Observable = {\n      fire: function (name, args, bubble) {\n        var self = this;\n        if (self.removed && name !== 'remove' && name !== 'detach') {\n          return args;\n        }\n        var dispatcherArgs = getEventDispatcher(self).fire(name, args);\n        if (bubble !== false && self.parent) {\n          var parent_1 = self.parent();\n          while (parent_1 && !dispatcherArgs.isPropagationStopped()) {\n            parent_1.fire(name, dispatcherArgs, false);\n            parent_1 = parent_1.parent();\n          }\n        }\n        return dispatcherArgs;\n      },\n      on: function (name, callback, prepend) {\n        return getEventDispatcher(this).on(name, callback, prepend);\n      },\n      off: function (name, callback) {\n        return getEventDispatcher(this).off(name, callback);\n      },\n      once: function (name, callback) {\n        return getEventDispatcher(this).once(name, callback);\n      },\n      hasEventListeners: function (name) {\n        return getEventDispatcher(this).has(name);\n      }\n    };\n\n    var DOM$8 = DOMUtils.DOM;\n    var customEventRootDelegates;\n    var getEventTarget = function (editor, eventName) {\n      if (eventName === 'selectionchange') {\n        return editor.getDoc();\n      }\n      if (!editor.inline && /^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(eventName)) {\n        return editor.getDoc().documentElement;\n      }\n      var eventRoot = getEventRoot(editor);\n      if (eventRoot) {\n        if (!editor.eventRoot) {\n          editor.eventRoot = DOM$8.select(eventRoot)[0];\n        }\n        return editor.eventRoot;\n      }\n      return editor.getBody();\n    };\n    var isListening = function (editor) {\n      return !editor.hidden && !isReadOnly$1(editor);\n    };\n    var fireEvent = function (editor, eventName, e) {\n      if (isListening(editor)) {\n        editor.fire(eventName, e);\n      } else if (isReadOnly$1(editor)) {\n        processReadonlyEvents(editor, e);\n      }\n    };\n    var bindEventDelegate = function (editor, eventName) {\n      var delegate;\n      if (!editor.delegates) {\n        editor.delegates = {};\n      }\n      if (editor.delegates[eventName] || editor.removed) {\n        return;\n      }\n      var eventRootElm = getEventTarget(editor, eventName);\n      if (getEventRoot(editor)) {\n        if (!customEventRootDelegates) {\n          customEventRootDelegates = {};\n          editor.editorManager.on('removeEditor', function () {\n            if (!editor.editorManager.activeEditor) {\n              if (customEventRootDelegates) {\n                each$1(customEventRootDelegates, function (_value, name) {\n                  editor.dom.unbind(getEventTarget(editor, name));\n                });\n                customEventRootDelegates = null;\n              }\n            }\n          });\n        }\n        if (customEventRootDelegates[eventName]) {\n          return;\n        }\n        delegate = function (e) {\n          var target = e.target;\n          var editors = editor.editorManager.get();\n          var i = editors.length;\n          while (i--) {\n            var body = editors[i].getBody();\n            if (body === target || DOM$8.isChildOf(target, body)) {\n              fireEvent(editors[i], eventName, e);\n            }\n          }\n        };\n        customEventRootDelegates[eventName] = delegate;\n        DOM$8.bind(eventRootElm, eventName, delegate);\n      } else {\n        delegate = function (e) {\n          fireEvent(editor, eventName, e);\n        };\n        DOM$8.bind(eventRootElm, eventName, delegate);\n        editor.delegates[eventName] = delegate;\n      }\n    };\n    var EditorObservable = __assign(__assign({}, Observable), {\n      bindPendingEventDelegates: function () {\n        var self = this;\n        Tools.each(self._pendingNativeEvents, function (name) {\n          bindEventDelegate(self, name);\n        });\n      },\n      toggleNativeEvent: function (name, state) {\n        var self = this;\n        if (name === 'focus' || name === 'blur') {\n          return;\n        }\n        if (state) {\n          if (self.initialized) {\n            bindEventDelegate(self, name);\n          } else {\n            if (!self._pendingNativeEvents) {\n              self._pendingNativeEvents = [name];\n            } else {\n              self._pendingNativeEvents.push(name);\n            }\n          }\n        } else if (self.initialized) {\n          self.dom.unbind(getEventTarget(self, name), name, self.delegates[name]);\n          delete self.delegates[name];\n        }\n      },\n      unbindAllNativeEvents: function () {\n        var self = this;\n        var body = self.getBody();\n        var dom = self.dom;\n        if (self.delegates) {\n          each$1(self.delegates, function (value, name) {\n            self.dom.unbind(getEventTarget(self, name), name, value);\n          });\n          delete self.delegates;\n        }\n        if (!self.inline && body && dom) {\n          body.onload = null;\n          dom.unbind(self.getWin());\n          dom.unbind(self.getDoc());\n        }\n        if (dom) {\n          dom.unbind(body);\n          dom.unbind(self.getContainer());\n        }\n      }\n    });\n\n    var defaultModes = [\n      'design',\n      'readonly'\n    ];\n    var switchToMode = function (editor, activeMode, availableModes, mode) {\n      var oldMode = availableModes[activeMode.get()];\n      var newMode = availableModes[mode];\n      try {\n        newMode.activate();\n      } catch (e) {\n        console.error('problem while activating editor mode ' + mode + ':', e);\n        return;\n      }\n      oldMode.deactivate();\n      if (oldMode.editorReadOnly !== newMode.editorReadOnly) {\n        toggleReadOnly(editor, newMode.editorReadOnly);\n      }\n      activeMode.set(mode);\n      fireSwitchMode(editor, mode);\n    };\n    var setMode = function (editor, availableModes, activeMode, mode) {\n      if (mode === activeMode.get()) {\n        return;\n      } else if (!has(availableModes, mode)) {\n        throw new Error('Editor mode \\'' + mode + '\\' is invalid');\n      }\n      if (editor.initialized) {\n        switchToMode(editor, activeMode, availableModes, mode);\n      } else {\n        editor.on('init', function () {\n          return switchToMode(editor, activeMode, availableModes, mode);\n        });\n      }\n    };\n    var registerMode = function (availableModes, mode, api) {\n      var _a;\n      if (contains(defaultModes, mode)) {\n        throw new Error('Cannot override default mode ' + mode);\n      }\n      return __assign(__assign({}, availableModes), (_a = {}, _a[mode] = __assign(__assign({}, api), {\n        deactivate: function () {\n          try {\n            api.deactivate();\n          } catch (e) {\n            console.error('problem while deactivating editor mode ' + mode + ':', e);\n          }\n        }\n      }), _a));\n    };\n\n    var create$5 = function (editor) {\n      var activeMode = Cell('design');\n      var availableModes = Cell({\n        design: {\n          activate: noop,\n          deactivate: noop,\n          editorReadOnly: false\n        },\n        readonly: {\n          activate: noop,\n          deactivate: noop,\n          editorReadOnly: true\n        }\n      });\n      registerReadOnlyContentFilters(editor);\n      registerReadOnlySelectionBlockers(editor);\n      return {\n        isReadOnly: function () {\n          return isReadOnly$1(editor);\n        },\n        set: function (mode) {\n          return setMode(editor, availableModes.get(), activeMode, mode);\n        },\n        get: function () {\n          return activeMode.get();\n        },\n        register: function (mode, api) {\n          availableModes.set(registerMode(availableModes.get(), mode, api));\n        }\n      };\n    };\n\n    var each$g = Tools.each, explode$3 = Tools.explode;\n    var keyCodeLookup = {\n      f1: 112,\n      f2: 113,\n      f3: 114,\n      f4: 115,\n      f5: 116,\n      f6: 117,\n      f7: 118,\n      f8: 119,\n      f9: 120,\n      f10: 121,\n      f11: 122,\n      f12: 123\n    };\n    var modifierNames = Tools.makeMap('alt,ctrl,shift,meta,access');\n    var parseShortcut = function (pattern) {\n      var key;\n      var shortcut = {};\n      each$g(explode$3(pattern.toLowerCase(), '+'), function (value) {\n        if (value in modifierNames) {\n          shortcut[value] = true;\n        } else {\n          if (/^[0-9]{2,}$/.test(value)) {\n            shortcut.keyCode = parseInt(value, 10);\n          } else {\n            shortcut.charCode = value.charCodeAt(0);\n            shortcut.keyCode = keyCodeLookup[value] || value.toUpperCase().charCodeAt(0);\n          }\n        }\n      });\n      var id = [shortcut.keyCode];\n      for (key in modifierNames) {\n        if (shortcut[key]) {\n          id.push(key);\n        } else {\n          shortcut[key] = false;\n        }\n      }\n      shortcut.id = id.join(',');\n      if (shortcut.access) {\n        shortcut.alt = true;\n        if (Env.mac) {\n          shortcut.ctrl = true;\n        } else {\n          shortcut.shift = true;\n        }\n      }\n      if (shortcut.meta) {\n        if (Env.mac) {\n          shortcut.meta = true;\n        } else {\n          shortcut.ctrl = true;\n          shortcut.meta = false;\n        }\n      }\n      return shortcut;\n    };\n    var Shortcuts = function () {\n      function Shortcuts(editor) {\n        this.shortcuts = {};\n        this.pendingPatterns = [];\n        this.editor = editor;\n        var self = this;\n        editor.on('keyup keypress keydown', function (e) {\n          if ((self.hasModifier(e) || self.isFunctionKey(e)) && !e.isDefaultPrevented()) {\n            each$g(self.shortcuts, function (shortcut) {\n              if (self.matchShortcut(e, shortcut)) {\n                self.pendingPatterns = shortcut.subpatterns.slice(0);\n                if (e.type === 'keydown') {\n                  self.executeShortcutAction(shortcut);\n                }\n                return true;\n              }\n            });\n            if (self.matchShortcut(e, self.pendingPatterns[0])) {\n              if (self.pendingPatterns.length === 1) {\n                if (e.type === 'keydown') {\n                  self.executeShortcutAction(self.pendingPatterns[0]);\n                }\n              }\n              self.pendingPatterns.shift();\n            }\n          }\n        });\n      }\n      Shortcuts.prototype.add = function (pattern, desc, cmdFunc, scope) {\n        var self = this;\n        var func = self.normalizeCommandFunc(cmdFunc);\n        each$g(explode$3(Tools.trim(pattern)), function (pattern) {\n          var shortcut = self.createShortcut(pattern, desc, func, scope);\n          self.shortcuts[shortcut.id] = shortcut;\n        });\n        return true;\n      };\n      Shortcuts.prototype.remove = function (pattern) {\n        var shortcut = this.createShortcut(pattern);\n        if (this.shortcuts[shortcut.id]) {\n          delete this.shortcuts[shortcut.id];\n          return true;\n        }\n        return false;\n      };\n      Shortcuts.prototype.normalizeCommandFunc = function (cmdFunc) {\n        var self = this;\n        var cmd = cmdFunc;\n        if (typeof cmd === 'string') {\n          return function () {\n            self.editor.execCommand(cmd, false, null);\n          };\n        } else if (Tools.isArray(cmd)) {\n          return function () {\n            self.editor.execCommand(cmd[0], cmd[1], cmd[2]);\n          };\n        } else {\n          return cmd;\n        }\n      };\n      Shortcuts.prototype.createShortcut = function (pattern, desc, cmdFunc, scope) {\n        var shortcuts = Tools.map(explode$3(pattern, '>'), parseShortcut);\n        shortcuts[shortcuts.length - 1] = Tools.extend(shortcuts[shortcuts.length - 1], {\n          func: cmdFunc,\n          scope: scope || this.editor\n        });\n        return Tools.extend(shortcuts[0], {\n          desc: this.editor.translate(desc),\n          subpatterns: shortcuts.slice(1)\n        });\n      };\n      Shortcuts.prototype.hasModifier = function (e) {\n        return e.altKey || e.ctrlKey || e.metaKey;\n      };\n      Shortcuts.prototype.isFunctionKey = function (e) {\n        return e.type === 'keydown' && e.keyCode >= 112 && e.keyCode <= 123;\n      };\n      Shortcuts.prototype.matchShortcut = function (e, shortcut) {\n        if (!shortcut) {\n          return false;\n        }\n        if (shortcut.ctrl !== e.ctrlKey || shortcut.meta !== e.metaKey) {\n          return false;\n        }\n        if (shortcut.alt !== e.altKey || shortcut.shift !== e.shiftKey) {\n          return false;\n        }\n        if (e.keyCode === shortcut.keyCode || e.charCode && e.charCode === shortcut.charCode) {\n          e.preventDefault();\n          return true;\n        }\n        return false;\n      };\n      Shortcuts.prototype.executeShortcutAction = function (shortcut) {\n        return shortcut.func ? shortcut.func.call(shortcut.scope) : null;\n      };\n      return Shortcuts;\n    }();\n\n    var create$6 = function () {\n      var buttons = {};\n      var menuItems = {};\n      var popups = {};\n      var icons = {};\n      var contextMenus = {};\n      var contextToolbars = {};\n      var sidebars = {};\n      var add = function (collection, type) {\n        return function (name, spec) {\n          return collection[name.toLowerCase()] = __assign(__assign({}, spec), { type: type });\n        };\n      };\n      var addIcon = function (name, svgData) {\n        return icons[name.toLowerCase()] = svgData;\n      };\n      return {\n        addButton: add(buttons, 'button'),\n        addGroupToolbarButton: add(buttons, 'grouptoolbarbutton'),\n        addToggleButton: add(buttons, 'togglebutton'),\n        addMenuButton: add(buttons, 'menubutton'),\n        addSplitButton: add(buttons, 'splitbutton'),\n        addMenuItem: add(menuItems, 'menuitem'),\n        addNestedMenuItem: add(menuItems, 'nestedmenuitem'),\n        addToggleMenuItem: add(menuItems, 'togglemenuitem'),\n        addAutocompleter: add(popups, 'autocompleter'),\n        addContextMenu: add(contextMenus, 'contextmenu'),\n        addContextToolbar: add(contextToolbars, 'contexttoolbar'),\n        addContextForm: add(contextToolbars, 'contextform'),\n        addSidebar: add(sidebars, 'sidebar'),\n        addIcon: addIcon,\n        getAll: function () {\n          return {\n            buttons: buttons,\n            menuItems: menuItems,\n            icons: icons,\n            popups: popups,\n            contextMenus: contextMenus,\n            contextToolbars: contextToolbars,\n            sidebars: sidebars\n          };\n        }\n      };\n    };\n\n    var registry = function () {\n      var bridge = create$6();\n      return {\n        addAutocompleter: bridge.addAutocompleter,\n        addButton: bridge.addButton,\n        addContextForm: bridge.addContextForm,\n        addContextMenu: bridge.addContextMenu,\n        addContextToolbar: bridge.addContextToolbar,\n        addIcon: bridge.addIcon,\n        addMenuButton: bridge.addMenuButton,\n        addMenuItem: bridge.addMenuItem,\n        addNestedMenuItem: bridge.addNestedMenuItem,\n        addSidebar: bridge.addSidebar,\n        addSplitButton: bridge.addSplitButton,\n        addToggleButton: bridge.addToggleButton,\n        addGroupToolbarButton: bridge.addGroupToolbarButton,\n        addToggleMenuItem: bridge.addToggleMenuItem,\n        getAll: bridge.getAll\n      };\n    };\n\n    var each$h = Tools.each, trim$4 = Tools.trim;\n    var queryParts = 'source protocol authority userInfo user password host port relative path directory file query anchor'.split(' ');\n    var DEFAULT_PORTS = {\n      ftp: 21,\n      http: 80,\n      https: 443,\n      mailto: 25\n    };\n    var URI = function () {\n      function URI(url, settings) {\n        url = trim$4(url);\n        this.settings = settings || {};\n        var baseUri = this.settings.base_uri;\n        var self = this;\n        if (/^([\\w\\-]+):([^\\/]{2})/i.test(url) || /^\\s*#/.test(url)) {\n          self.source = url;\n          return;\n        }\n        var isProtocolRelative = url.indexOf('//') === 0;\n        if (url.indexOf('/') === 0 && !isProtocolRelative) {\n          url = (baseUri ? baseUri.protocol || 'http' : 'http') + '://mce_host' + url;\n        }\n        if (!/^[\\w\\-]*:?\\/\\//.test(url)) {\n          var baseUrl = this.settings.base_uri ? this.settings.base_uri.path : new URI(document.location.href).directory;\n          if (this.settings.base_uri && this.settings.base_uri.protocol == '') {\n            url = '//mce_host' + self.toAbsPath(baseUrl, url);\n          } else {\n            var match = /([^#?]*)([#?]?.*)/.exec(url);\n            url = (baseUri && baseUri.protocol || 'http') + '://mce_host' + self.toAbsPath(baseUrl, match[1]) + match[2];\n          }\n        }\n        url = url.replace(/@@/g, '(mce_at)');\n        var urlMatch = /^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@\\/]*):?([^:@\\/]*))?@)?(\\[[a-zA-Z0-9:.%]+\\]|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(url);\n        each$h(queryParts, function (v, i) {\n          var part = urlMatch[i];\n          if (part) {\n            part = part.replace(/\\(mce_at\\)/g, '@@');\n          }\n          self[v] = part;\n        });\n        if (baseUri) {\n          if (!self.protocol) {\n            self.protocol = baseUri.protocol;\n          }\n          if (!self.userInfo) {\n            self.userInfo = baseUri.userInfo;\n          }\n          if (!self.port && self.host === 'mce_host') {\n            self.port = baseUri.port;\n          }\n          if (!self.host || self.host === 'mce_host') {\n            self.host = baseUri.host;\n          }\n          self.source = '';\n        }\n        if (isProtocolRelative) {\n          self.protocol = '';\n        }\n      }\n      URI.parseDataUri = function (uri) {\n        var type;\n        var uriComponents = decodeURIComponent(uri).split(',');\n        var matches = /data:([^;]+)/.exec(uriComponents[0]);\n        if (matches) {\n          type = matches[1];\n        }\n        return {\n          type: type,\n          data: uriComponents[1]\n        };\n      };\n      URI.getDocumentBaseUrl = function (loc) {\n        var baseUrl;\n        if (loc.protocol.indexOf('http') !== 0 && loc.protocol !== 'file:') {\n          baseUrl = loc.href;\n        } else {\n          baseUrl = loc.protocol + '//' + loc.host + loc.pathname;\n        }\n        if (/^[^:]+:\\/\\/\\/?[^\\/]+\\//.test(baseUrl)) {\n          baseUrl = baseUrl.replace(/[\\?#].*$/, '').replace(/[\\/\\\\][^\\/]+$/, '');\n          if (!/[\\/\\\\]$/.test(baseUrl)) {\n            baseUrl += '/';\n          }\n        }\n        return baseUrl;\n      };\n      URI.prototype.setPath = function (path) {\n        var pathMatch = /^(.*?)\\/?(\\w+)?$/.exec(path);\n        this.path = pathMatch[0];\n        this.directory = pathMatch[1];\n        this.file = pathMatch[2];\n        this.source = '';\n        this.getURI();\n      };\n      URI.prototype.toRelative = function (uri) {\n        var output;\n        if (uri === './') {\n          return uri;\n        }\n        var relativeUri = new URI(uri, { base_uri: this });\n        if (relativeUri.host !== 'mce_host' && this.host !== relativeUri.host && relativeUri.host || this.port !== relativeUri.port || this.protocol !== relativeUri.protocol && relativeUri.protocol !== '') {\n          return relativeUri.getURI();\n        }\n        var tu = this.getURI(), uu = relativeUri.getURI();\n        if (tu === uu || tu.charAt(tu.length - 1) === '/' && tu.substr(0, tu.length - 1) === uu) {\n          return tu;\n        }\n        output = this.toRelPath(this.path, relativeUri.path);\n        if (relativeUri.query) {\n          output += '?' + relativeUri.query;\n        }\n        if (relativeUri.anchor) {\n          output += '#' + relativeUri.anchor;\n        }\n        return output;\n      };\n      URI.prototype.toAbsolute = function (uri, noHost) {\n        var absoluteUri = new URI(uri, { base_uri: this });\n        return absoluteUri.getURI(noHost && this.isSameOrigin(absoluteUri));\n      };\n      URI.prototype.isSameOrigin = function (uri) {\n        if (this.host == uri.host && this.protocol == uri.protocol) {\n          if (this.port == uri.port) {\n            return true;\n          }\n          var defaultPort = DEFAULT_PORTS[this.protocol];\n          if (defaultPort && (this.port || defaultPort) == (uri.port || defaultPort)) {\n            return true;\n          }\n        }\n        return false;\n      };\n      URI.prototype.toRelPath = function (base, path) {\n        var breakPoint = 0, out = '', i, l;\n        var normalizedBase = base.substring(0, base.lastIndexOf('/')).split('/');\n        var items = path.split('/');\n        if (normalizedBase.length >= items.length) {\n          for (i = 0, l = normalizedBase.length; i < l; i++) {\n            if (i >= items.length || normalizedBase[i] !== items[i]) {\n              breakPoint = i + 1;\n              break;\n            }\n          }\n        }\n        if (normalizedBase.length < items.length) {\n          for (i = 0, l = items.length; i < l; i++) {\n            if (i >= normalizedBase.length || normalizedBase[i] !== items[i]) {\n              breakPoint = i + 1;\n              break;\n            }\n          }\n        }\n        if (breakPoint === 1) {\n          return path;\n        }\n        for (i = 0, l = normalizedBase.length - (breakPoint - 1); i < l; i++) {\n          out += '../';\n        }\n        for (i = breakPoint - 1, l = items.length; i < l; i++) {\n          if (i !== breakPoint - 1) {\n            out += '/' + items[i];\n          } else {\n            out += items[i];\n          }\n        }\n        return out;\n      };\n      URI.prototype.toAbsPath = function (base, path) {\n        var i, nb = 0, o = [], outPath;\n        var tr = /\\/$/.test(path) ? '/' : '';\n        var normalizedBase = base.split('/');\n        var normalizedPath = path.split('/');\n        each$h(normalizedBase, function (k) {\n          if (k) {\n            o.push(k);\n          }\n        });\n        normalizedBase = o;\n        for (i = normalizedPath.length - 1, o = []; i >= 0; i--) {\n          if (normalizedPath[i].length === 0 || normalizedPath[i] === '.') {\n            continue;\n          }\n          if (normalizedPath[i] === '..') {\n            nb++;\n            continue;\n          }\n          if (nb > 0) {\n            nb--;\n            continue;\n          }\n          o.push(normalizedPath[i]);\n        }\n        i = normalizedBase.length - nb;\n        if (i <= 0) {\n          outPath = reverse(o).join('/');\n        } else {\n          outPath = normalizedBase.slice(0, i).join('/') + '/' + reverse(o).join('/');\n        }\n        if (outPath.indexOf('/') !== 0) {\n          outPath = '/' + outPath;\n        }\n        if (tr && outPath.lastIndexOf('/') !== outPath.length - 1) {\n          outPath += tr;\n        }\n        return outPath;\n      };\n      URI.prototype.getURI = function (noProtoHost) {\n        if (noProtoHost === void 0) {\n          noProtoHost = false;\n        }\n        var s;\n        if (!this.source || noProtoHost) {\n          s = '';\n          if (!noProtoHost) {\n            if (this.protocol) {\n              s += this.protocol + '://';\n            } else {\n              s += '//';\n            }\n            if (this.userInfo) {\n              s += this.userInfo + '@';\n            }\n            if (this.host) {\n              s += this.host;\n            }\n            if (this.port) {\n              s += ':' + this.port;\n            }\n          }\n          if (this.path) {\n            s += this.path;\n          }\n          if (this.query) {\n            s += '?' + this.query;\n          }\n          if (this.anchor) {\n            s += '#' + this.anchor;\n          }\n          this.source = s;\n        }\n        return this.source;\n      };\n      return URI;\n    }();\n\n    var DOM$9 = DOMUtils.DOM;\n    var extend$3 = Tools.extend, each$i = Tools.each;\n    var resolve$3 = Tools.resolve;\n    var ie$1 = Env.ie;\n    var Editor = function () {\n      function Editor(id, settings, editorManager) {\n        var _this = this;\n        this.plugins = {};\n        this.contentCSS = [];\n        this.contentStyles = [];\n        this.loadedCSS = {};\n        this.isNotDirty = false;\n        this.editorManager = editorManager;\n        this.documentBaseUrl = editorManager.documentBaseURL;\n        extend$3(this, EditorObservable);\n        this.settings = getEditorSettings(this, id, this.documentBaseUrl, editorManager.defaultSettings, settings);\n        if (this.settings.suffix) {\n          editorManager.suffix = this.settings.suffix;\n        }\n        this.suffix = editorManager.suffix;\n        if (this.settings.base_url) {\n          editorManager._setBaseUrl(this.settings.base_url);\n        }\n        this.baseUri = editorManager.baseURI;\n        if (this.settings.referrer_policy) {\n          ScriptLoader.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy);\n          DOMUtils.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy);\n        }\n        AddOnManager.languageLoad = this.settings.language_load;\n        AddOnManager.baseURL = editorManager.baseURL;\n        this.id = id;\n        this.setDirty(false);\n        this.documentBaseURI = new URI(this.settings.document_base_url, { base_uri: this.baseUri });\n        this.baseURI = this.baseUri;\n        this.inline = !!this.settings.inline;\n        this.shortcuts = new Shortcuts(this);\n        this.editorCommands = new EditorCommands(this);\n        if (this.settings.cache_suffix) {\n          Env.cacheSuffix = this.settings.cache_suffix.replace(/^[\\?\\&]+/, '');\n        }\n        this.ui = {\n          registry: registry(),\n          styleSheetLoader: undefined,\n          show: noop,\n          hide: noop,\n          enable: noop,\n          disable: noop,\n          isDisabled: never\n        };\n        var self = this;\n        var modeInstance = create$5(self);\n        this.mode = modeInstance;\n        this.setMode = modeInstance.set;\n        editorManager.fire('SetupEditor', { editor: this });\n        this.execCallback('setup', this);\n        this.$ = DomQuery.overrideDefaults(function () {\n          return {\n            context: _this.inline ? _this.getBody() : _this.getDoc(),\n            element: _this.getBody()\n          };\n        });\n      }\n      Editor.prototype.render = function () {\n        render(this);\n      };\n      Editor.prototype.focus = function (skipFocus) {\n        focus$1(this, skipFocus);\n      };\n      Editor.prototype.hasFocus = function () {\n        return hasFocus$1(this);\n      };\n      Editor.prototype.execCallback = function (name) {\n        var x = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n          x[_i - 1] = arguments[_i];\n        }\n        var self = this;\n        var callback = self.settings[name], scope;\n        if (!callback) {\n          return;\n        }\n        if (self.callbackLookup && (scope = self.callbackLookup[name])) {\n          callback = scope.func;\n          scope = scope.scope;\n        }\n        if (typeof callback === 'string') {\n          scope = callback.replace(/\\.\\w+$/, '');\n          scope = scope ? resolve$3(scope) : 0;\n          callback = resolve$3(callback);\n          self.callbackLookup = self.callbackLookup || {};\n          self.callbackLookup[name] = {\n            func: callback,\n            scope: scope\n          };\n        }\n        return callback.apply(scope || self, x);\n      };\n      Editor.prototype.translate = function (text) {\n        return I18n.translate(text);\n      };\n      Editor.prototype.getParam = function (name, defaultVal, type) {\n        return getParam(this, name, defaultVal, type);\n      };\n      Editor.prototype.hasPlugin = function (name, loaded) {\n        var hasPlugin = contains(getPlugins(this).split(/[ ,]/), name);\n        if (hasPlugin) {\n          return loaded ? PluginManager.get(name) !== undefined : true;\n        } else {\n          return false;\n        }\n      };\n      Editor.prototype.nodeChanged = function (args) {\n        this._nodeChangeDispatcher.nodeChanged(args);\n      };\n      Editor.prototype.addCommand = function (name, callback, scope) {\n        this.editorCommands.addCommand(name, callback, scope);\n      };\n      Editor.prototype.addQueryStateHandler = function (name, callback, scope) {\n        this.editorCommands.addQueryStateHandler(name, callback, scope);\n      };\n      Editor.prototype.addQueryValueHandler = function (name, callback, scope) {\n        this.editorCommands.addQueryValueHandler(name, callback, scope);\n      };\n      Editor.prototype.addShortcut = function (pattern, desc, cmdFunc, scope) {\n        this.shortcuts.add(pattern, desc, cmdFunc, scope);\n      };\n      Editor.prototype.execCommand = function (cmd, ui, value, args) {\n        return this.editorCommands.execCommand(cmd, ui, value, args);\n      };\n      Editor.prototype.queryCommandState = function (cmd) {\n        return this.editorCommands.queryCommandState(cmd);\n      };\n      Editor.prototype.queryCommandValue = function (cmd) {\n        return this.editorCommands.queryCommandValue(cmd);\n      };\n      Editor.prototype.queryCommandSupported = function (cmd) {\n        return this.editorCommands.queryCommandSupported(cmd);\n      };\n      Editor.prototype.show = function () {\n        var self = this;\n        if (self.hidden) {\n          self.hidden = false;\n          if (self.inline) {\n            self.getBody().contentEditable = 'true';\n          } else {\n            DOM$9.show(self.getContainer());\n            DOM$9.hide(self.id);\n          }\n          self.load();\n          self.fire('show');\n        }\n      };\n      Editor.prototype.hide = function () {\n        var self = this, doc = self.getDoc();\n        if (!self.hidden) {\n          if (ie$1 && doc && !self.inline) {\n            doc.execCommand('SelectAll');\n          }\n          self.save();\n          if (self.inline) {\n            self.getBody().contentEditable = 'false';\n            if (self === self.editorManager.focusedEditor) {\n              self.editorManager.focusedEditor = null;\n            }\n          } else {\n            DOM$9.hide(self.getContainer());\n            DOM$9.setStyle(self.id, 'display', self.orgDisplay);\n          }\n          self.hidden = true;\n          self.fire('hide');\n        }\n      };\n      Editor.prototype.isHidden = function () {\n        return !!this.hidden;\n      };\n      Editor.prototype.setProgressState = function (state, time) {\n        this.fire('ProgressState', {\n          state: state,\n          time: time\n        });\n      };\n      Editor.prototype.load = function (args) {\n        var self = this;\n        var elm = self.getElement(), html;\n        if (self.removed) {\n          return '';\n        }\n        if (elm) {\n          args = args || {};\n          args.load = true;\n          var value = isTextareaOrInput(elm) ? elm.value : elm.innerHTML;\n          html = self.setContent(value, args);\n          args.element = elm;\n          if (!args.no_events) {\n            self.fire('LoadContent', args);\n          }\n          args.element = elm = null;\n          return html;\n        }\n      };\n      Editor.prototype.save = function (args) {\n        var self = this;\n        var elm = self.getElement(), html, form;\n        if (!elm || !self.initialized || self.removed) {\n          return;\n        }\n        args = args || {};\n        args.save = true;\n        args.element = elm;\n        html = args.content = self.getContent(args);\n        if (!args.no_events) {\n          self.fire('SaveContent', args);\n        }\n        if (args.format === 'raw') {\n          self.fire('RawSaveContent', args);\n        }\n        html = args.content;\n        if (!isTextareaOrInput(elm)) {\n          if (args.is_removing || !self.inline) {\n            elm.innerHTML = html;\n          }\n          if (form = DOM$9.getParent(self.id, 'form')) {\n            each$i(form.elements, function (elm) {\n              if (elm.name === self.id) {\n                elm.value = html;\n                return false;\n              }\n            });\n          }\n        } else {\n          elm.value = html;\n        }\n        args.element = elm = null;\n        if (args.set_dirty !== false) {\n          self.setDirty(false);\n        }\n        return html;\n      };\n      Editor.prototype.setContent = function (content, args) {\n        return setContent$2(this, content, args);\n      };\n      Editor.prototype.getContent = function (args) {\n        return getContent$2(this, args);\n      };\n      Editor.prototype.insertContent = function (content, args) {\n        if (args) {\n          content = extend$3({ content: content }, args);\n        }\n        this.execCommand('mceInsertContent', false, content);\n      };\n      Editor.prototype.resetContent = function (initialContent) {\n        if (initialContent === undefined) {\n          setContent$2(this, this.startContent, { format: 'raw' });\n        } else {\n          setContent$2(this, initialContent);\n        }\n        this.undoManager.reset();\n        this.setDirty(false);\n        this.nodeChanged();\n      };\n      Editor.prototype.isDirty = function () {\n        return !this.isNotDirty;\n      };\n      Editor.prototype.setDirty = function (state) {\n        var oldState = !this.isNotDirty;\n        this.isNotDirty = !state;\n        if (state && state !== oldState) {\n          this.fire('dirty');\n        }\n      };\n      Editor.prototype.getContainer = function () {\n        var self = this;\n        if (!self.container) {\n          self.container = DOM$9.get(self.editorContainer || self.id + '_parent');\n        }\n        return self.container;\n      };\n      Editor.prototype.getContentAreaContainer = function () {\n        return this.contentAreaContainer;\n      };\n      Editor.prototype.getElement = function () {\n        if (!this.targetElm) {\n          this.targetElm = DOM$9.get(this.id);\n        }\n        return this.targetElm;\n      };\n      Editor.prototype.getWin = function () {\n        var self = this;\n        var elm;\n        if (!self.contentWindow) {\n          elm = self.iframeElement;\n          if (elm) {\n            self.contentWindow = elm.contentWindow;\n          }\n        }\n        return self.contentWindow;\n      };\n      Editor.prototype.getDoc = function () {\n        var self = this;\n        var win;\n        if (!self.contentDocument) {\n          win = self.getWin();\n          if (win) {\n            self.contentDocument = win.document;\n          }\n        }\n        return self.contentDocument;\n      };\n      Editor.prototype.getBody = function () {\n        var doc = this.getDoc();\n        return this.bodyElement || (doc ? doc.body : null);\n      };\n      Editor.prototype.convertURL = function (url, name, elm) {\n        var self = this, settings = self.settings;\n        if (settings.urlconverter_callback) {\n          return self.execCallback('urlconverter_callback', url, elm, true, name);\n        }\n        if (!settings.convert_urls || elm && elm.nodeName === 'LINK' || url.indexOf('file:') === 0 || url.length === 0) {\n          return url;\n        }\n        if (settings.relative_urls) {\n          return self.documentBaseURI.toRelative(url);\n        }\n        url = self.documentBaseURI.toAbsolute(url, settings.remove_script_host);\n        return url;\n      };\n      Editor.prototype.addVisual = function (elm) {\n        addVisual$1(this, elm);\n      };\n      Editor.prototype.remove = function () {\n        remove$7(this);\n      };\n      Editor.prototype.destroy = function (automatic) {\n        destroy(this, automatic);\n      };\n      Editor.prototype.uploadImages = function (callback) {\n        return this.editorUpload.uploadImages(callback);\n      };\n      Editor.prototype._scanForImages = function () {\n        return this.editorUpload.scanForImages();\n      };\n      Editor.prototype.addButton = function () {\n        throw new Error('editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead');\n      };\n      Editor.prototype.addSidebar = function () {\n        throw new Error('editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead');\n      };\n      Editor.prototype.addMenuItem = function () {\n        throw new Error('editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead');\n      };\n      Editor.prototype.addContextToolbar = function () {\n        throw new Error('editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead');\n      };\n      return Editor;\n    }();\n\n    var DOM$a = DOMUtils.DOM;\n    var explode$4 = Tools.explode, each$j = Tools.each, extend$4 = Tools.extend;\n    var instanceCounter = 0, boundGlobalEvents = false;\n    var beforeUnloadDelegate;\n    var legacyEditors = [];\n    var editors = [];\n    var isValidLegacyKey = function (id) {\n      return id !== 'length';\n    };\n    var globalEventDelegate = function (e) {\n      var type = e.type;\n      each$j(EditorManager.get(), function (editor) {\n        switch (type) {\n        case 'scroll':\n          editor.fire('ScrollWindow', e);\n          break;\n        case 'resize':\n          editor.fire('ResizeWindow', e);\n          break;\n        }\n      });\n    };\n    var toggleGlobalEvents = function (state) {\n      if (state !== boundGlobalEvents) {\n        if (state) {\n          DomQuery(window).on('resize scroll', globalEventDelegate);\n        } else {\n          DomQuery(window).off('resize scroll', globalEventDelegate);\n        }\n        boundGlobalEvents = state;\n      }\n    };\n    var removeEditorFromList = function (targetEditor) {\n      var oldEditors = editors;\n      delete legacyEditors[targetEditor.id];\n      for (var i = 0; i < legacyEditors.length; i++) {\n        if (legacyEditors[i] === targetEditor) {\n          legacyEditors.splice(i, 1);\n          break;\n        }\n      }\n      editors = filter(editors, function (editor) {\n        return targetEditor !== editor;\n      });\n      if (EditorManager.activeEditor === targetEditor) {\n        EditorManager.activeEditor = editors.length > 0 ? editors[0] : null;\n      }\n      if (EditorManager.focusedEditor === targetEditor) {\n        EditorManager.focusedEditor = null;\n      }\n      return oldEditors.length !== editors.length;\n    };\n    var purgeDestroyedEditor = function (editor) {\n      if (editor && editor.initialized && !(editor.getContainer() || editor.getBody()).parentNode) {\n        removeEditorFromList(editor);\n        editor.unbindAllNativeEvents();\n        editor.destroy(true);\n        editor.removed = true;\n        editor = null;\n      }\n      return editor;\n    };\n    var isQuirksMode = document.compatMode !== 'CSS1Compat';\n    var EditorManager = __assign(__assign({}, Observable), {\n      baseURI: null,\n      baseURL: null,\n      defaultSettings: {},\n      documentBaseURL: null,\n      suffix: null,\n      $: DomQuery,\n      majorVersion: '5',\n      minorVersion: '8.2',\n      releaseDate: '2021-06-23',\n      editors: legacyEditors,\n      i18n: I18n,\n      activeEditor: null,\n      focusedEditor: null,\n      settings: {},\n      setup: function () {\n        var self = this;\n        var baseURL, documentBaseURL, suffix = '';\n        documentBaseURL = URI.getDocumentBaseUrl(document.location);\n        if (/^[^:]+:\\/\\/\\/?[^\\/]+\\//.test(documentBaseURL)) {\n          documentBaseURL = documentBaseURL.replace(/[\\?#].*$/, '').replace(/[\\/\\\\][^\\/]+$/, '');\n          if (!/[\\/\\\\]$/.test(documentBaseURL)) {\n            documentBaseURL += '/';\n          }\n        }\n        var preInit = window.tinymce || window.tinyMCEPreInit;\n        if (preInit) {\n          baseURL = preInit.base || preInit.baseURL;\n          suffix = preInit.suffix;\n        } else {\n          var scripts = document.getElementsByTagName('script');\n          for (var i = 0; i < scripts.length; i++) {\n            var src = scripts[i].src || '';\n            if (src === '') {\n              continue;\n            }\n            var srcScript = src.substring(src.lastIndexOf('/'));\n            if (/tinymce(\\.full|\\.jquery|)(\\.min|\\.dev|)\\.js/.test(src)) {\n              if (srcScript.indexOf('.min') !== -1) {\n                suffix = '.min';\n              }\n              baseURL = src.substring(0, src.lastIndexOf('/'));\n              break;\n            }\n          }\n          if (!baseURL && document.currentScript) {\n            var src = document.currentScript.src;\n            if (src.indexOf('.min') !== -1) {\n              suffix = '.min';\n            }\n            baseURL = src.substring(0, src.lastIndexOf('/'));\n          }\n        }\n        self.baseURL = new URI(documentBaseURL).toAbsolute(baseURL);\n        self.documentBaseURL = documentBaseURL;\n        self.baseURI = new URI(self.baseURL);\n        self.suffix = suffix;\n        setup$2(self);\n      },\n      overrideDefaults: function (defaultSettings) {\n        var baseUrl = defaultSettings.base_url;\n        if (baseUrl) {\n          this._setBaseUrl(baseUrl);\n        }\n        var suffix = defaultSettings.suffix;\n        if (defaultSettings.suffix) {\n          this.suffix = suffix;\n        }\n        this.defaultSettings = defaultSettings;\n        var pluginBaseUrls = defaultSettings.plugin_base_urls;\n        if (pluginBaseUrls !== undefined) {\n          each$1(pluginBaseUrls, function (pluginBaseUrl, pluginName) {\n            AddOnManager.PluginManager.urls[pluginName] = pluginBaseUrl;\n          });\n        }\n      },\n      init: function (settings) {\n        var self = this;\n        var result;\n        var invalidInlineTargets = Tools.makeMap('area base basefont br col frame hr img input isindex link meta param embed source wbr track ' + 'colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu', ' ');\n        var isInvalidInlineTarget = function (settings, elm) {\n          return settings.inline && elm.tagName.toLowerCase() in invalidInlineTargets;\n        };\n        var createId = function (elm) {\n          var id = elm.id;\n          if (!id) {\n            id = get$1(elm, 'name').filter(function (name) {\n              return !DOM$a.get(name);\n            }).getOrThunk(DOM$a.uniqueId);\n            elm.setAttribute('id', id);\n          }\n          return id;\n        };\n        var execCallback = function (name) {\n          var callback = settings[name];\n          if (!callback) {\n            return;\n          }\n          return callback.apply(self, []);\n        };\n        var hasClass = function (elm, className) {\n          return className.constructor === RegExp ? className.test(elm.className) : DOM$a.hasClass(elm, className);\n        };\n        var findTargets = function (settings) {\n          var targets = [];\n          if (Env.browser.isIE() && Env.browser.version.major < 11) {\n            initError('TinyMCE does not support the browser you are using. For a list of supported' + ' browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/');\n            return [];\n          } else if (isQuirksMode) {\n            initError('Failed to initialize the editor as the document is not in standards mode. ' + 'TinyMCE requires standards mode.');\n            return [];\n          }\n          if (settings.types) {\n            each$j(settings.types, function (type) {\n              targets = targets.concat(DOM$a.select(type.selector));\n            });\n            return targets;\n          } else if (settings.selector) {\n            return DOM$a.select(settings.selector);\n          } else if (settings.target) {\n            return [settings.target];\n          }\n          switch (settings.mode) {\n          case 'exact':\n            var l = settings.elements || '';\n            if (l.length > 0) {\n              each$j(explode$4(l), function (id) {\n                var elm = DOM$a.get(id);\n                if (elm) {\n                  targets.push(elm);\n                } else {\n                  each$j(document.forms, function (f) {\n                    each$j(f.elements, function (e) {\n                      if (e.name === id) {\n                        id = 'mce_editor_' + instanceCounter++;\n                        DOM$a.setAttrib(e, 'id', id);\n                        targets.push(e);\n                      }\n                    });\n                  });\n                }\n              });\n            }\n            break;\n          case 'textareas':\n          case 'specific_textareas':\n            each$j(DOM$a.select('textarea'), function (elm) {\n              if (settings.editor_deselector && hasClass(elm, settings.editor_deselector)) {\n                return;\n              }\n              if (!settings.editor_selector || hasClass(elm, settings.editor_selector)) {\n                targets.push(elm);\n              }\n            });\n            break;\n          }\n          return targets;\n        };\n        var provideResults = function (editors) {\n          result = editors;\n        };\n        var initEditors = function () {\n          var initCount = 0;\n          var editors = [];\n          var targets;\n          var createEditor = function (id, settings, targetElm) {\n            var editor = new Editor(id, settings, self);\n            editors.push(editor);\n            editor.on('init', function () {\n              if (++initCount === targets.length) {\n                provideResults(editors);\n              }\n            });\n            editor.targetElm = editor.targetElm || targetElm;\n            editor.render();\n          };\n          DOM$a.unbind(window, 'ready', initEditors);\n          execCallback('onpageload');\n          targets = DomQuery.unique(findTargets(settings));\n          if (settings.types) {\n            each$j(settings.types, function (type) {\n              Tools.each(targets, function (elm) {\n                if (DOM$a.is(elm, type.selector)) {\n                  createEditor(createId(elm), extend$4({}, settings, type), elm);\n                  return false;\n                }\n                return true;\n              });\n            });\n            return;\n          }\n          Tools.each(targets, function (elm) {\n            purgeDestroyedEditor(self.get(elm.id));\n          });\n          targets = Tools.grep(targets, function (elm) {\n            return !self.get(elm.id);\n          });\n          if (targets.length === 0) {\n            provideResults([]);\n          } else {\n            each$j(targets, function (elm) {\n              if (isInvalidInlineTarget(settings, elm)) {\n                initError('Could not initialize inline editor on invalid inline target element', elm);\n              } else {\n                createEditor(createId(elm), settings, elm);\n              }\n            });\n          }\n        };\n        self.settings = settings;\n        DOM$a.bind(window, 'ready', initEditors);\n        return new promiseObj(function (resolve) {\n          if (result) {\n            resolve(result);\n          } else {\n            provideResults = function (editors) {\n              resolve(editors);\n            };\n          }\n        });\n      },\n      get: function (id) {\n        if (arguments.length === 0) {\n          return editors.slice(0);\n        } else if (isString(id)) {\n          return find(editors, function (editor) {\n            return editor.id === id;\n          }).getOr(null);\n        } else if (isNumber(id)) {\n          return editors[id] ? editors[id] : null;\n        } else {\n          return null;\n        }\n      },\n      add: function (editor) {\n        var self = this;\n        var existingEditor = legacyEditors[editor.id];\n        if (existingEditor === editor) {\n          return editor;\n        }\n        if (self.get(editor.id) === null) {\n          if (isValidLegacyKey(editor.id)) {\n            legacyEditors[editor.id] = editor;\n          }\n          legacyEditors.push(editor);\n          editors.push(editor);\n        }\n        toggleGlobalEvents(true);\n        self.activeEditor = editor;\n        self.fire('AddEditor', { editor: editor });\n        if (!beforeUnloadDelegate) {\n          beforeUnloadDelegate = function (e) {\n            var event = self.fire('BeforeUnload');\n            if (event.returnValue) {\n              e.preventDefault();\n              e.returnValue = event.returnValue;\n              return event.returnValue;\n            }\n          };\n          window.addEventListener('beforeunload', beforeUnloadDelegate);\n        }\n        return editor;\n      },\n      createEditor: function (id, settings) {\n        return this.add(new Editor(id, settings, this));\n      },\n      remove: function (selector) {\n        var self = this;\n        var i, editor;\n        if (!selector) {\n          for (i = editors.length - 1; i >= 0; i--) {\n            self.remove(editors[i]);\n          }\n          return;\n        }\n        if (isString(selector)) {\n          each$j(DOM$a.select(selector), function (elm) {\n            editor = self.get(elm.id);\n            if (editor) {\n              self.remove(editor);\n            }\n          });\n          return;\n        }\n        editor = selector;\n        if (isNull(self.get(editor.id))) {\n          return null;\n        }\n        if (removeEditorFromList(editor)) {\n          self.fire('RemoveEditor', { editor: editor });\n        }\n        if (editors.length === 0) {\n          window.removeEventListener('beforeunload', beforeUnloadDelegate);\n        }\n        editor.remove();\n        toggleGlobalEvents(editors.length > 0);\n        return editor;\n      },\n      execCommand: function (cmd, ui, value) {\n        var self = this, editor = self.get(value);\n        switch (cmd) {\n        case 'mceAddEditor':\n          if (!self.get(value)) {\n            new Editor(value, self.settings, self).render();\n          }\n          return true;\n        case 'mceRemoveEditor':\n          if (editor) {\n            editor.remove();\n          }\n          return true;\n        case 'mceToggleEditor':\n          if (!editor) {\n            self.execCommand('mceAddEditor', false, value);\n            return true;\n          }\n          if (editor.isHidden()) {\n            editor.show();\n          } else {\n            editor.hide();\n          }\n          return true;\n        }\n        if (self.activeEditor) {\n          return self.activeEditor.execCommand(cmd, ui, value);\n        }\n        return false;\n      },\n      triggerSave: function () {\n        each$j(editors, function (editor) {\n          editor.save();\n        });\n      },\n      addI18n: function (code, items) {\n        I18n.add(code, items);\n      },\n      translate: function (text) {\n        return I18n.translate(text);\n      },\n      setActive: function (editor) {\n        var activeEditor = this.activeEditor;\n        if (this.activeEditor !== editor) {\n          if (activeEditor) {\n            activeEditor.fire('deactivate', { relatedTarget: editor });\n          }\n          editor.fire('activate', { relatedTarget: activeEditor });\n        }\n        this.activeEditor = editor;\n      },\n      _setBaseUrl: function (baseUrl) {\n        this.baseURL = new URI(this.documentBaseURL).toAbsolute(baseUrl.replace(/\\/+$/, ''));\n        this.baseURI = new URI(this.baseURL);\n      }\n    });\n    EditorManager.setup();\n\n    var min = Math.min, max = Math.max, round$1 = Math.round;\n    var relativePosition = function (rect, targetRect, rel) {\n      var x = targetRect.x;\n      var y = targetRect.y;\n      var w = rect.w;\n      var h = rect.h;\n      var targetW = targetRect.w;\n      var targetH = targetRect.h;\n      var relChars = (rel || '').split('');\n      if (relChars[0] === 'b') {\n        y += targetH;\n      }\n      if (relChars[1] === 'r') {\n        x += targetW;\n      }\n      if (relChars[0] === 'c') {\n        y += round$1(targetH / 2);\n      }\n      if (relChars[1] === 'c') {\n        x += round$1(targetW / 2);\n      }\n      if (relChars[3] === 'b') {\n        y -= h;\n      }\n      if (relChars[4] === 'r') {\n        x -= w;\n      }\n      if (relChars[3] === 'c') {\n        y -= round$1(h / 2);\n      }\n      if (relChars[4] === 'c') {\n        x -= round$1(w / 2);\n      }\n      return create$7(x, y, w, h);\n    };\n    var findBestRelativePosition = function (rect, targetRect, constrainRect, rels) {\n      var pos, i;\n      for (i = 0; i < rels.length; i++) {\n        pos = relativePosition(rect, targetRect, rels[i]);\n        if (pos.x >= constrainRect.x && pos.x + pos.w <= constrainRect.w + constrainRect.x && pos.y >= constrainRect.y && pos.y + pos.h <= constrainRect.h + constrainRect.y) {\n          return rels[i];\n        }\n      }\n      return null;\n    };\n    var inflate = function (rect, w, h) {\n      return create$7(rect.x - w, rect.y - h, rect.w + w * 2, rect.h + h * 2);\n    };\n    var intersect = function (rect, cropRect) {\n      var x1 = max(rect.x, cropRect.x);\n      var y1 = max(rect.y, cropRect.y);\n      var x2 = min(rect.x + rect.w, cropRect.x + cropRect.w);\n      var y2 = min(rect.y + rect.h, cropRect.y + cropRect.h);\n      if (x2 - x1 < 0 || y2 - y1 < 0) {\n        return null;\n      }\n      return create$7(x1, y1, x2 - x1, y2 - y1);\n    };\n    var clamp$1 = function (rect, clampRect, fixedSize) {\n      var x1 = rect.x;\n      var y1 = rect.y;\n      var x2 = rect.x + rect.w;\n      var y2 = rect.y + rect.h;\n      var cx2 = clampRect.x + clampRect.w;\n      var cy2 = clampRect.y + clampRect.h;\n      var underflowX1 = max(0, clampRect.x - x1);\n      var underflowY1 = max(0, clampRect.y - y1);\n      var overflowX2 = max(0, x2 - cx2);\n      var overflowY2 = max(0, y2 - cy2);\n      x1 += underflowX1;\n      y1 += underflowY1;\n      if (fixedSize) {\n        x2 += underflowX1;\n        y2 += underflowY1;\n        x1 -= overflowX2;\n        y1 -= overflowY2;\n      }\n      x2 -= overflowX2;\n      y2 -= overflowY2;\n      return create$7(x1, y1, x2 - x1, y2 - y1);\n    };\n    var create$7 = function (x, y, w, h) {\n      return {\n        x: x,\n        y: y,\n        w: w,\n        h: h\n      };\n    };\n    var fromClientRect = function (clientRect) {\n      return create$7(clientRect.left, clientRect.top, clientRect.width, clientRect.height);\n    };\n    var Rect = {\n      inflate: inflate,\n      relativePosition: relativePosition,\n      findBestRelativePosition: findBestRelativePosition,\n      intersect: intersect,\n      clamp: clamp$1,\n      create: create$7,\n      fromClientRect: fromClientRect\n    };\n\n    var awaiter = function (resolveCb, rejectCb, timeout) {\n      if (timeout === void 0) {\n        timeout = 1000;\n      }\n      var done = false;\n      var timer = null;\n      var complete = function (completer) {\n        return function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          if (!done) {\n            done = true;\n            if (timer !== null) {\n              clearTimeout(timer);\n              timer = null;\n            }\n            completer.apply(null, args);\n          }\n        };\n      };\n      var resolve = complete(resolveCb);\n      var reject = complete(rejectCb);\n      var start = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (!done && timer === null) {\n          timer = setTimeout(function () {\n            return reject.apply(null, args);\n          }, timeout);\n        }\n      };\n      return {\n        start: start,\n        resolve: resolve,\n        reject: reject\n      };\n    };\n    var create$8 = function () {\n      var tasks = {};\n      var resultFns = {};\n      var load = function (id, url) {\n        var loadErrMsg = 'Script at URL \"' + url + '\" failed to load';\n        var runErrMsg = 'Script at URL \"' + url + '\" did not call `tinymce.Resource.add(\\'' + id + '\\', data)` within 1 second';\n        if (tasks[id] !== undefined) {\n          return tasks[id];\n        } else {\n          var task = new promiseObj(function (resolve, reject) {\n            var waiter = awaiter(resolve, reject);\n            resultFns[id] = waiter.resolve;\n            ScriptLoader.ScriptLoader.loadScript(url, function () {\n              return waiter.start(runErrMsg);\n            }, function () {\n              return waiter.reject(loadErrMsg);\n            });\n          });\n          tasks[id] = task;\n          return task;\n        }\n      };\n      var add = function (id, data) {\n        if (resultFns[id] !== undefined) {\n          resultFns[id](data);\n          delete resultFns[id];\n        }\n        tasks[id] = promiseObj.resolve(data);\n      };\n      return {\n        load: load,\n        add: add\n      };\n    };\n    var Resource = create$8();\n\n    var each$k = Tools.each, extend$5 = Tools.extend;\n    var extendClass, initializing;\n    var Class = function () {\n    };\n    Class.extend = extendClass = function (props) {\n      var self = this;\n      var _super = self.prototype;\n      var Class = function () {\n        var i, mixins, mixin;\n        var self = this;\n        if (!initializing) {\n          if (self.init) {\n            self.init.apply(self, arguments);\n          }\n          mixins = self.Mixins;\n          if (mixins) {\n            i = mixins.length;\n            while (i--) {\n              mixin = mixins[i];\n              if (mixin.init) {\n                mixin.init.apply(self, arguments);\n              }\n            }\n          }\n        }\n      };\n      var dummy = function () {\n        return this;\n      };\n      var createMethod = function (name, fn) {\n        return function () {\n          var self = this;\n          var tmp = self._super;\n          self._super = _super[name];\n          var ret = fn.apply(self, arguments);\n          self._super = tmp;\n          return ret;\n        };\n      };\n      initializing = true;\n      var prototype = new self();\n      initializing = false;\n      if (props.Mixins) {\n        each$k(props.Mixins, function (mixin) {\n          for (var name_1 in mixin) {\n            if (name_1 !== 'init') {\n              props[name_1] = mixin[name_1];\n            }\n          }\n        });\n        if (_super.Mixins) {\n          props.Mixins = _super.Mixins.concat(props.Mixins);\n        }\n      }\n      if (props.Methods) {\n        each$k(props.Methods.split(','), function (name) {\n          props[name] = dummy;\n        });\n      }\n      if (props.Properties) {\n        each$k(props.Properties.split(','), function (name) {\n          var fieldName = '_' + name;\n          props[name] = function (value) {\n            var self = this;\n            if (value !== undefined) {\n              self[fieldName] = value;\n              return self;\n            }\n            return self[fieldName];\n          };\n        });\n      }\n      if (props.Statics) {\n        each$k(props.Statics, function (func, name) {\n          Class[name] = func;\n        });\n      }\n      if (props.Defaults && _super.Defaults) {\n        props.Defaults = extend$5({}, _super.Defaults, props.Defaults);\n      }\n      each$1(props, function (member, name) {\n        if (typeof member === 'function' && _super[name]) {\n          prototype[name] = createMethod(name, member);\n        } else {\n          prototype[name] = member;\n        }\n      });\n      Class.prototype = prototype;\n      Class.constructor = Class;\n      Class.extend = extendClass;\n      return Class;\n    };\n\n    var min$1 = Math.min, max$1 = Math.max, round$2 = Math.round;\n    var Color = function (value) {\n      var self = {};\n      var r = 0, g = 0, b = 0;\n      var rgb2hsv = function (r, g, b) {\n        var h, s, v;\n        h = 0;\n        s = 0;\n        v = 0;\n        r = r / 255;\n        g = g / 255;\n        b = b / 255;\n        var minRGB = min$1(r, min$1(g, b));\n        var maxRGB = max$1(r, max$1(g, b));\n        if (minRGB === maxRGB) {\n          v = minRGB;\n          return {\n            h: 0,\n            s: 0,\n            v: v * 100\n          };\n        }\n        var d = r === minRGB ? g - b : b === minRGB ? r - g : b - r;\n        h = r === minRGB ? 3 : b === minRGB ? 1 : 5;\n        h = 60 * (h - d / (maxRGB - minRGB));\n        s = (maxRGB - minRGB) / maxRGB;\n        v = maxRGB;\n        return {\n          h: round$2(h),\n          s: round$2(s * 100),\n          v: round$2(v * 100)\n        };\n      };\n      var hsvToRgb = function (hue, saturation, brightness) {\n        hue = (parseInt(hue, 10) || 0) % 360;\n        saturation = parseInt(saturation, 10) / 100;\n        brightness = parseInt(brightness, 10) / 100;\n        saturation = max$1(0, min$1(saturation, 1));\n        brightness = max$1(0, min$1(brightness, 1));\n        if (saturation === 0) {\n          r = g = b = round$2(255 * brightness);\n          return;\n        }\n        var side = hue / 60;\n        var chroma = brightness * saturation;\n        var x = chroma * (1 - Math.abs(side % 2 - 1));\n        var match = brightness - chroma;\n        switch (Math.floor(side)) {\n        case 0:\n          r = chroma;\n          g = x;\n          b = 0;\n          break;\n        case 1:\n          r = x;\n          g = chroma;\n          b = 0;\n          break;\n        case 2:\n          r = 0;\n          g = chroma;\n          b = x;\n          break;\n        case 3:\n          r = 0;\n          g = x;\n          b = chroma;\n          break;\n        case 4:\n          r = x;\n          g = 0;\n          b = chroma;\n          break;\n        case 5:\n          r = chroma;\n          g = 0;\n          b = x;\n          break;\n        default:\n          r = g = b = 0;\n        }\n        r = round$2(255 * (r + match));\n        g = round$2(255 * (g + match));\n        b = round$2(255 * (b + match));\n      };\n      var toHex = function () {\n        var hex = function (val) {\n          val = parseInt(val, 10).toString(16);\n          return val.length > 1 ? val : '0' + val;\n        };\n        return '#' + hex(r) + hex(g) + hex(b);\n      };\n      var toRgb = function () {\n        return {\n          r: r,\n          g: g,\n          b: b\n        };\n      };\n      var toHsv = function () {\n        return rgb2hsv(r, g, b);\n      };\n      var parse = function (value) {\n        var matches;\n        if (typeof value === 'object') {\n          if ('r' in value) {\n            r = value.r;\n            g = value.g;\n            b = value.b;\n          } else if ('v' in value) {\n            hsvToRgb(value.h, value.s, value.v);\n          }\n        } else {\n          if (matches = /rgb\\s*\\(\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*,\\s*([0-9]+)[^\\)]*\\)/gi.exec(value)) {\n            r = parseInt(matches[1], 10);\n            g = parseInt(matches[2], 10);\n            b = parseInt(matches[3], 10);\n          } else if (matches = /#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(value)) {\n            r = parseInt(matches[1], 16);\n            g = parseInt(matches[2], 16);\n            b = parseInt(matches[3], 16);\n          } else if (matches = /#([0-F])([0-F])([0-F])/gi.exec(value)) {\n            r = parseInt(matches[1] + matches[1], 16);\n            g = parseInt(matches[2] + matches[2], 16);\n            b = parseInt(matches[3] + matches[3], 16);\n          }\n        }\n        r = r < 0 ? 0 : r > 255 ? 255 : r;\n        g = g < 0 ? 0 : g > 255 ? 255 : g;\n        b = b < 0 ? 0 : b > 255 ? 255 : b;\n        return self;\n      };\n      if (value) {\n        parse(value);\n      }\n      self.toRgb = toRgb;\n      self.toHsv = toHsv;\n      self.toHex = toHex;\n      self.parse = parse;\n      return self;\n    };\n\n    var serialize = function (obj) {\n      var data = JSON.stringify(obj);\n      if (!isString(data)) {\n        return data;\n      }\n      return data.replace(/[\\u0080-\\uFFFF]/g, function (match) {\n        var hexCode = match.charCodeAt(0).toString(16);\n        return '\\\\u' + '0000'.substring(hexCode.length) + hexCode;\n      });\n    };\n    var JSONUtils = {\n      serialize: serialize,\n      parse: function (text) {\n        try {\n          return JSON.parse(text);\n        } catch (ex) {\n        }\n      }\n    };\n\n    var JSONP = {\n      callbacks: {},\n      count: 0,\n      send: function (settings) {\n        var self = this, dom = DOMUtils.DOM, count = settings.count !== undefined ? settings.count : self.count;\n        var id = 'tinymce_jsonp_' + count;\n        self.callbacks[count] = function (json) {\n          dom.remove(id);\n          delete self.callbacks[count];\n          settings.callback(json);\n        };\n        dom.add(dom.doc.body, 'script', {\n          id: id,\n          src: settings.url,\n          type: 'text/javascript'\n        });\n        self.count++;\n      }\n    };\n\n    var XHR = __assign(__assign({}, Observable), {\n      send: function (settings) {\n        var xhr, count = 0;\n        var ready = function () {\n          if (!settings.async || xhr.readyState === 4 || count++ > 10000) {\n            if (settings.success && count < 10000 && xhr.status === 200) {\n              settings.success.call(settings.success_scope, '' + xhr.responseText, xhr, settings);\n            } else if (settings.error) {\n              settings.error.call(settings.error_scope, count > 10000 ? 'TIMED_OUT' : 'GENERAL', xhr, settings);\n            }\n            xhr = null;\n          } else {\n            Delay.setTimeout(ready, 10);\n          }\n        };\n        settings.scope = settings.scope || this;\n        settings.success_scope = settings.success_scope || settings.scope;\n        settings.error_scope = settings.error_scope || settings.scope;\n        settings.async = settings.async !== false;\n        settings.data = settings.data || '';\n        XHR.fire('beforeInitialize', { settings: settings });\n        xhr = new XMLHttpRequest();\n        if (xhr.overrideMimeType) {\n          xhr.overrideMimeType(settings.content_type);\n        }\n        xhr.open(settings.type || (settings.data ? 'POST' : 'GET'), settings.url, settings.async);\n        if (settings.crossDomain) {\n          xhr.withCredentials = true;\n        }\n        if (settings.content_type) {\n          xhr.setRequestHeader('Content-Type', settings.content_type);\n        }\n        if (settings.requestheaders) {\n          Tools.each(settings.requestheaders, function (header) {\n            xhr.setRequestHeader(header.key, header.value);\n          });\n        }\n        xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n        xhr = XHR.fire('beforeSend', {\n          xhr: xhr,\n          settings: settings\n        }).xhr;\n        xhr.send(settings.data);\n        if (!settings.async) {\n          return ready();\n        }\n        Delay.setTimeout(ready, 10);\n      }\n    });\n\n    var extend$6 = Tools.extend;\n    var JSONRequest = function () {\n      function JSONRequest(settings) {\n        this.settings = extend$6({}, settings);\n        this.count = 0;\n      }\n      JSONRequest.sendRPC = function (o) {\n        return new JSONRequest().send(o);\n      };\n      JSONRequest.prototype.send = function (args) {\n        var ecb = args.error, scb = args.success;\n        var xhrArgs = extend$6(this.settings, args);\n        xhrArgs.success = function (c, x) {\n          c = JSONUtils.parse(c);\n          if (typeof c === 'undefined') {\n            c = { error: 'JSON Parse error.' };\n          }\n          if (c.error) {\n            ecb.call(xhrArgs.error_scope || xhrArgs.scope, c.error, x);\n          } else {\n            scb.call(xhrArgs.success_scope || xhrArgs.scope, c.result);\n          }\n        };\n        xhrArgs.error = function (ty, x) {\n          if (ecb) {\n            ecb.call(xhrArgs.error_scope || xhrArgs.scope, ty, x);\n          }\n        };\n        xhrArgs.data = JSONUtils.serialize({\n          id: args.id || 'c' + this.count++,\n          method: args.method,\n          params: args.params\n        });\n        xhrArgs.content_type = 'application/json';\n        XHR.send(xhrArgs);\n      };\n      return JSONRequest;\n    }();\n\n    var create$9 = function () {\n      return function () {\n        var data = {};\n        var keys = [];\n        var storage = {\n          getItem: function (key) {\n            var item = data[key];\n            return item ? item : null;\n          },\n          setItem: function (key, value) {\n            keys.push(key);\n            data[key] = String(value);\n          },\n          key: function (index) {\n            return keys[index];\n          },\n          removeItem: function (key) {\n            keys = keys.filter(function (k) {\n              return k === key;\n            });\n            delete data[key];\n          },\n          clear: function () {\n            keys = [];\n            data = {};\n          },\n          length: 0\n        };\n        Object.defineProperty(storage, 'length', {\n          get: function () {\n            return keys.length;\n          },\n          configurable: false,\n          enumerable: false\n        });\n        return storage;\n      }();\n    };\n\n    var localStorage;\n    try {\n      var test = '__storage_test__';\n      localStorage = window.localStorage;\n      localStorage.setItem(test, test);\n      localStorage.removeItem(test);\n    } catch (e) {\n      localStorage = create$9();\n    }\n    var LocalStorage = localStorage;\n\n    var publicApi = {\n      geom: { Rect: Rect },\n      util: {\n        Promise: promiseObj,\n        Delay: Delay,\n        Tools: Tools,\n        VK: VK,\n        URI: URI,\n        Class: Class,\n        EventDispatcher: EventDispatcher,\n        Observable: Observable,\n        I18n: I18n,\n        XHR: XHR,\n        JSON: JSONUtils,\n        JSONRequest: JSONRequest,\n        JSONP: JSONP,\n        LocalStorage: LocalStorage,\n        Color: Color,\n        ImageUploader: ImageUploader\n      },\n      dom: {\n        EventUtils: EventUtils,\n        Sizzle: Sizzle,\n        DomQuery: DomQuery,\n        TreeWalker: DomTreeWalker,\n        TextSeeker: TextSeeker,\n        DOMUtils: DOMUtils,\n        ScriptLoader: ScriptLoader,\n        RangeUtils: RangeUtils,\n        Serializer: DomSerializer,\n        StyleSheetLoader: StyleSheetLoader,\n        ControlSelection: ControlSelection,\n        BookmarkManager: BookmarkManager,\n        Selection: EditorSelection,\n        Event: EventUtils.Event\n      },\n      html: {\n        Styles: Styles,\n        Entities: Entities,\n        Node: AstNode,\n        Schema: Schema,\n        SaxParser: SaxParser,\n        DomParser: DomParser,\n        Writer: Writer,\n        Serializer: HtmlSerializer\n      },\n      Env: Env,\n      AddOnManager: AddOnManager,\n      Annotator: Annotator,\n      Formatter: Formatter,\n      UndoManager: UndoManager,\n      EditorCommands: EditorCommands,\n      WindowManager: WindowManager,\n      NotificationManager: NotificationManager,\n      EditorObservable: EditorObservable,\n      Shortcuts: Shortcuts,\n      Editor: Editor,\n      FocusManager: FocusManager,\n      EditorManager: EditorManager,\n      DOM: DOMUtils.DOM,\n      ScriptLoader: ScriptLoader.ScriptLoader,\n      PluginManager: PluginManager,\n      ThemeManager: ThemeManager,\n      IconManager: IconManager,\n      Resource: Resource,\n      trim: Tools.trim,\n      isArray: Tools.isArray,\n      is: Tools.is,\n      toArray: Tools.toArray,\n      makeMap: Tools.makeMap,\n      each: Tools.each,\n      map: Tools.map,\n      grep: Tools.grep,\n      inArray: Tools.inArray,\n      extend: Tools.extend,\n      create: Tools.create,\n      walk: Tools.walk,\n      createNS: Tools.createNS,\n      resolve: Tools.resolve,\n      explode: Tools.explode,\n      _addCacheSuffix: Tools._addCacheSuffix,\n      isOpera: Env.opera,\n      isWebKit: Env.webkit,\n      isIE: Env.ie,\n      isGecko: Env.gecko,\n      isMac: Env.mac\n    };\n    var tinymce = Tools.extend(EditorManager, publicApi);\n\n    var exportToModuleLoaders = function (tinymce) {\n      if (typeof module === 'object') {\n        try {\n          module.exports = tinymce;\n        } catch (_) {\n        }\n      }\n    };\n    var exportToWindowGlobal = function (tinymce) {\n      window.tinymce = tinymce;\n      window.tinyMCE = tinymce;\n    };\n    exportToWindowGlobal(tinymce);\n    exportToModuleLoaders(tinymce);\n\n}());\n"]},"metadata":{},"sourceType":"script"}